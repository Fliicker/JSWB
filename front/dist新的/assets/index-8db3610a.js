var uZ=(t,n)=>()=>(n||t((n={exports:{}}).exports,n),n.exports);var xMe=uZ((al,ol)=>{(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const c of document.querySelectorAll('link[rel="modulepreload"]'))s(c);new MutationObserver(c=>{for(const f of c)if(f.type==="childList")for(const d of f.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&s(d)}).observe(document,{childList:!0,subtree:!0});function a(c){const f={};return c.integrity&&(f.integrity=c.integrity),c.referrerPolicy&&(f.referrerPolicy=c.referrerPolicy),c.crossOrigin==="use-credentials"?f.credentials="include":c.crossOrigin==="anonymous"?f.credentials="omit":f.credentials="same-origin",f}function s(c){if(c.ep)return;c.ep=!0;const f=a(c);fetch(c.href,f)}})();function KC(t,n){const a=Object.create(null),s=t.split(",");for(let c=0;c<s.length;c++)a[s[c]]=!0;return n?c=>!!a[c.toLowerCase()]:c=>!!a[c]}const Ea={},k0=[],Si=()=>{},fZ=()=>!1,gb=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&(t.charCodeAt(2)>122||t.charCodeAt(2)<97),YC=t=>t.startsWith("onUpdate:"),Qa=Object.assign,JC=(t,n)=>{const a=t.indexOf(n);a>-1&&t.splice(a,1)},hZ=Object.prototype.hasOwnProperty,Kn=(t,n)=>hZ.call(t,n),Wr=Array.isArray,I0=t=>lv(t)==="[object Map]",_b=t=>lv(t)==="[object Set]",AR=t=>lv(t)==="[object Date]",Yr=t=>typeof t=="function",Mn=t=>typeof t=="string",z0=t=>typeof t=="symbol",$n=t=>t!==null&&typeof t=="object",Ox=t=>($n(t)||Yr(t))&&Yr(t.then)&&Yr(t.catch),sB=Object.prototype.toString,lv=t=>sB.call(t),gx=t=>lv(t).slice(8,-1),Rx=t=>lv(t)==="[object Object]",QC=t=>Mn(t)&&t!=="NaN"&&t[0]!=="-"&&""+parseInt(t,10)===t,_x=KC(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),vb=t=>{const n=Object.create(null);return a=>n[a]||(n[a]=t(a))},dZ=/-(\w)/g,hc=vb(t=>t.replace(dZ,(n,a)=>a?a.toUpperCase():"")),pZ=/\B([A-Z])/g,Fh=vb(t=>t.replace(pZ,"-$1").toLowerCase()),cv=vb(t=>t.charAt(0).toUpperCase()+t.slice(1)),vx=vb(t=>t?`on${cv(t)}`:""),Wd=(t,n)=>!Object.is(t,n),yx=(t,n)=>{for(let a=0;a<t.length;a++)t[a](n)},Lx=(t,n,a)=>{Object.defineProperty(t,n,{configurable:!0,enumerable:!1,value:a})},PS=t=>{const n=parseFloat(t);return isNaN(n)?t:n},mZ=t=>{const n=Mn(t)?Number(t):NaN;return isNaN(n)?t:n};let kR;const OS=()=>kR||(kR=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function xn(t){if(Wr(t)){const n={};for(let a=0;a<t.length;a++){const s=t[a],c=Mn(s)?yZ(s):xn(s);if(c)for(const f in c)n[f]=c[f]}return n}else if(Mn(t)||$n(t))return t}const gZ=/;(?![^(]*\))/g,_Z=/:([^]+)/,vZ=/\/\*[^]*?\*\//g;function yZ(t){const n={};return t.replace(vZ,"").split(gZ).forEach(a=>{if(a){const s=a.split(_Z);s.length>1&&(n[s[0].trim()]=s[1].trim())}}),n}function ht(t){let n="";if(Mn(t))n=t;else if(Wr(t))for(let a=0;a<t.length;a++){const s=ht(t[a]);s&&(n+=s+" ")}else if($n(t))for(const a in t)t[a]&&(n+=a+" ");return n.trim()}const xZ="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",bZ=KC(xZ);function lB(t){return!!t||t===""}function wZ(t,n){if(t.length!==n.length)return!1;let a=!0;for(let s=0;a&&s<t.length;s++)a=N0(t[s],n[s]);return a}function N0(t,n){if(t===n)return!0;let a=AR(t),s=AR(n);if(a||s)return a&&s?t.getTime()===n.getTime():!1;if(a=z0(t),s=z0(n),a||s)return t===n;if(a=Wr(t),s=Wr(n),a||s)return a&&s?wZ(t,n):!1;if(a=$n(t),s=$n(n),a||s){if(!a||!s)return!1;const c=Object.keys(t).length,f=Object.keys(n).length;if(c!==f)return!1;for(const d in t){const p=t.hasOwnProperty(d),g=n.hasOwnProperty(d);if(p&&!g||!p&&g||!N0(t[d],n[d]))return!1}}return String(t)===String(n)}function cB(t,n){return t.findIndex(a=>N0(a,n))}const Lr=t=>Mn(t)?t:t==null?"":Wr(t)||$n(t)&&(t.toString===sB||!Yr(t.toString))?JSON.stringify(t,uB,2):String(t),uB=(t,n)=>n&&n.__v_isRef?uB(t,n.value):I0(n)?{[`Map(${n.size})`]:[...n.entries()].reduce((a,[s,c])=>(a[`${s} =>`]=c,a),{})}:_b(n)?{[`Set(${n.size})`]:[...n.values()]}:$n(n)&&!Wr(n)&&!Rx(n)?String(n):n;let tl;class fB{constructor(n=!1){this.detached=n,this._active=!0,this.effects=[],this.cleanups=[],this.parent=tl,!n&&tl&&(this.index=(tl.scopes||(tl.scopes=[])).push(this)-1)}get active(){return this._active}run(n){if(this._active){const a=tl;try{return tl=this,n()}finally{tl=a}}}on(){tl=this}off(){tl=this.parent}stop(n){if(this._active){let a,s;for(a=0,s=this.effects.length;a<s;a++)this.effects[a].stop();for(a=0,s=this.cleanups.length;a<s;a++)this.cleanups[a]();if(this.scopes)for(a=0,s=this.scopes.length;a<s;a++)this.scopes[a].stop(!0);if(!this.detached&&this.parent&&!n){const c=this.parent.scopes.pop();c&&c!==this&&(this.parent.scopes[this.index]=c,c.index=this.index)}this.parent=void 0,this._active=!1}}}function hB(t){return new fB(t)}function EZ(t,n=tl){n&&n.active&&n.effects.push(t)}function eA(){return tl}function tA(t){tl&&tl.cleanups.push(t)}const rA=t=>{const n=new Set(t);return n.w=0,n.n=0,n},dB=t=>(t.w&Th)>0,pB=t=>(t.n&Th)>0,TZ=({deps:t})=>{if(t.length)for(let n=0;n<t.length;n++)t[n].w|=Th},SZ=t=>{const{deps:n}=t;if(n.length){let a=0;for(let s=0;s<n.length;s++){const c=n[s];dB(c)&&!pB(c)?c.delete(t):n[a++]=c,c.w&=~Th,c.n&=~Th}n.length=a}},Dx=new WeakMap;let jg=0,Th=1;const RS=30;let ic;const Dd=Symbol(""),LS=Symbol("");class nA{constructor(n,a=null,s){this.fn=n,this.scheduler=a,this.active=!0,this.deps=[],this.parent=void 0,EZ(this,s)}run(){if(!this.active)return this.fn();let n=ic,a=yh;for(;n;){if(n===this)return;n=n.parent}try{return this.parent=ic,ic=this,yh=!0,Th=1<<++jg,jg<=RS?TZ(this):IR(this),this.fn()}finally{jg<=RS&&SZ(this),Th=1<<--jg,ic=this.parent,yh=a,this.parent=void 0,this.deferStop&&this.stop()}}stop(){ic===this?this.deferStop=!0:this.active&&(IR(this),this.onStop&&this.onStop(),this.active=!1)}}function IR(t){const{deps:n}=t;if(n.length){for(let a=0;a<n.length;a++)n[a].delete(t);n.length=0}}let yh=!0;const mB=[];function um(){mB.push(yh),yh=!1}function fm(){const t=mB.pop();yh=t===void 0?!0:t}function Us(t,n,a){if(yh&&ic){let s=Dx.get(t);s||Dx.set(t,s=new Map);let c=s.get(a);c||s.set(a,c=rA()),gB(c)}}function gB(t,n){let a=!1;jg<=RS?pB(t)||(t.n|=Th,a=!dB(t)):a=!t.has(ic),a&&(t.add(ic),ic.deps.push(t))}function Gu(t,n,a,s,c,f){const d=Dx.get(t);if(!d)return;let p=[];if(n==="clear")p=[...d.values()];else if(a==="length"&&Wr(t)){const g=Number(s);d.forEach((y,b)=>{(b==="length"||!z0(b)&&b>=g)&&p.push(y)})}else switch(a!==void 0&&p.push(d.get(a)),n){case"add":Wr(t)?QC(a)&&p.push(d.get("length")):(p.push(d.get(Dd)),I0(t)&&p.push(d.get(LS)));break;case"delete":Wr(t)||(p.push(d.get(Dd)),I0(t)&&p.push(d.get(LS)));break;case"set":I0(t)&&p.push(d.get(Dd));break}if(p.length===1)p[0]&&DS(p[0]);else{const g=[];for(const y of p)y&&g.push(...y);DS(rA(g))}}function DS(t,n){const a=Wr(t)?t:[...t];for(const s of a)s.computed&&MR(s);for(const s of a)s.computed||MR(s)}function MR(t,n){(t!==ic||t.allowRecurse)&&(t.scheduler?t.scheduler():t.run())}function CZ(t,n){var a;return(a=Dx.get(t))==null?void 0:a.get(n)}const AZ=KC("__proto__,__v_isRef,__isVue"),_B=new Set(Object.getOwnPropertyNames(Symbol).filter(t=>t!=="arguments"&&t!=="caller").map(t=>Symbol[t]).filter(z0)),FR=kZ();function kZ(){const t={};return["includes","indexOf","lastIndexOf"].forEach(n=>{t[n]=function(...a){const s=ti(this);for(let f=0,d=this.length;f<d;f++)Us(s,"get",f+"");const c=s[n](...a);return c===-1||c===!1?s[n](...a.map(ti)):c}}),["push","pop","shift","unshift","splice"].forEach(n=>{t[n]=function(...a){um();const s=ti(this)[n].apply(this,a);return fm(),s}}),t}function IZ(t){const n=ti(this);return Us(n,"has",t),n.hasOwnProperty(t)}class vB{constructor(n=!1,a=!1){this._isReadonly=n,this._shallow=a}get(n,a,s){const c=this._isReadonly,f=this._shallow;if(a==="__v_isReactive")return!c;if(a==="__v_isReadonly")return c;if(a==="__v_isShallow")return f;if(a==="__v_raw"&&s===(c?f?VZ:wB:f?bB:xB).get(n))return n;const d=Wr(n);if(!c){if(d&&Kn(FR,a))return Reflect.get(FR,a,s);if(a==="hasOwnProperty")return IZ}const p=Reflect.get(n,a,s);return(z0(a)?_B.has(a):AZ(a))||(c||Us(n,"get",a),f)?p:ai(p)?d&&QC(a)?p:p.value:$n(p)?c?uv(p):bo(p):p}}class yB extends vB{constructor(n=!1){super(!1,n)}set(n,a,s,c){let f=n[a];if(U0(f)&&ai(f)&&!ai(s))return!1;if(!this._shallow&&(!Bx(s)&&!U0(s)&&(f=ti(f),s=ti(s)),!Wr(n)&&ai(f)&&!ai(s)))return f.value=s,!0;const d=Wr(n)&&QC(a)?Number(a)<n.length:Kn(n,a),p=Reflect.set(n,a,s,c);return n===ti(c)&&(d?Wd(s,f)&&Gu(n,"set",a,s):Gu(n,"add",a,s)),p}deleteProperty(n,a){const s=Kn(n,a);n[a];const c=Reflect.deleteProperty(n,a);return c&&s&&Gu(n,"delete",a,void 0),c}has(n,a){const s=Reflect.has(n,a);return(!z0(a)||!_B.has(a))&&Us(n,"has",a),s}ownKeys(n){return Us(n,"iterate",Wr(n)?"length":Dd),Reflect.ownKeys(n)}}class MZ extends vB{constructor(n=!1){super(!0,n)}set(n,a){return!0}deleteProperty(n,a){return!0}}const FZ=new yB,PZ=new MZ,OZ=new yB(!0),iA=t=>t,yb=t=>Reflect.getPrototypeOf(t);function Dy(t,n,a=!1,s=!1){t=t.__v_raw;const c=ti(t),f=ti(n);a||(Wd(n,f)&&Us(c,"get",n),Us(c,"get",f));const{has:d}=yb(c),p=s?iA:a?lA:y_;if(d.call(c,n))return p(t.get(n));if(d.call(c,f))return p(t.get(f));t!==c&&t.get(n)}function By(t,n=!1){const a=this.__v_raw,s=ti(a),c=ti(t);return n||(Wd(t,c)&&Us(s,"has",t),Us(s,"has",c)),t===c?a.has(t):a.has(t)||a.has(c)}function zy(t,n=!1){return t=t.__v_raw,!n&&Us(ti(t),"iterate",Dd),Reflect.get(t,"size",t)}function PR(t){t=ti(t);const n=ti(this);return yb(n).has.call(n,t)||(n.add(t),Gu(n,"add",t,t)),this}function OR(t,n){n=ti(n);const a=ti(this),{has:s,get:c}=yb(a);let f=s.call(a,t);f||(t=ti(t),f=s.call(a,t));const d=c.call(a,t);return a.set(t,n),f?Wd(n,d)&&Gu(a,"set",t,n):Gu(a,"add",t,n),this}function RR(t){const n=ti(this),{has:a,get:s}=yb(n);let c=a.call(n,t);c||(t=ti(t),c=a.call(n,t)),s&&s.call(n,t);const f=n.delete(t);return c&&Gu(n,"delete",t,void 0),f}function LR(){const t=ti(this),n=t.size!==0,a=t.clear();return n&&Gu(t,"clear",void 0,void 0),a}function Ny(t,n){return function(s,c){const f=this,d=f.__v_raw,p=ti(d),g=n?iA:t?lA:y_;return!t&&Us(p,"iterate",Dd),d.forEach((y,b)=>s.call(c,g(y),g(b),f))}}function Uy(t,n,a){return function(...s){const c=this.__v_raw,f=ti(c),d=I0(f),p=t==="entries"||t===Symbol.iterator&&d,g=t==="keys"&&d,y=c[t](...s),b=a?iA:n?lA:y_;return!n&&Us(f,"iterate",g?LS:Dd),{next(){const{value:E,done:T}=y.next();return T?{value:E,done:T}:{value:p?[b(E[0]),b(E[1])]:b(E),done:T}},[Symbol.iterator](){return this}}}}function eh(t){return function(...n){return t==="delete"?!1:t==="clear"?void 0:this}}function RZ(){const t={get(f){return Dy(this,f)},get size(){return zy(this)},has:By,add:PR,set:OR,delete:RR,clear:LR,forEach:Ny(!1,!1)},n={get(f){return Dy(this,f,!1,!0)},get size(){return zy(this)},has:By,add:PR,set:OR,delete:RR,clear:LR,forEach:Ny(!1,!0)},a={get(f){return Dy(this,f,!0)},get size(){return zy(this,!0)},has(f){return By.call(this,f,!0)},add:eh("add"),set:eh("set"),delete:eh("delete"),clear:eh("clear"),forEach:Ny(!0,!1)},s={get(f){return Dy(this,f,!0,!0)},get size(){return zy(this,!0)},has(f){return By.call(this,f,!0)},add:eh("add"),set:eh("set"),delete:eh("delete"),clear:eh("clear"),forEach:Ny(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(f=>{t[f]=Uy(f,!1,!1),a[f]=Uy(f,!0,!1),n[f]=Uy(f,!1,!0),s[f]=Uy(f,!0,!0)}),[t,a,n,s]}const[LZ,DZ,BZ,zZ]=RZ();function aA(t,n){const a=n?t?zZ:BZ:t?DZ:LZ;return(s,c,f)=>c==="__v_isReactive"?!t:c==="__v_isReadonly"?t:c==="__v_raw"?s:Reflect.get(Kn(a,c)&&c in s?a:s,c,f)}const NZ={get:aA(!1,!1)},UZ={get:aA(!1,!0)},$Z={get:aA(!0,!1)},xB=new WeakMap,bB=new WeakMap,wB=new WeakMap,VZ=new WeakMap;function jZ(t){switch(t){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function WZ(t){return t.__v_skip||!Object.isExtensible(t)?0:jZ(gx(t))}function bo(t){return U0(t)?t:sA(t,!1,FZ,NZ,xB)}function oA(t){return sA(t,!1,OZ,UZ,bB)}function uv(t){return sA(t,!0,PZ,$Z,wB)}function sA(t,n,a,s,c){if(!$n(t)||t.__v_raw&&!(n&&t.__v_isReactive))return t;const f=c.get(t);if(f)return f;const d=WZ(t);if(d===0)return t;const p=new Proxy(t,d===2?s:a);return c.set(t,p),p}function xh(t){return U0(t)?xh(t.__v_raw):!!(t&&t.__v_isReactive)}function U0(t){return!!(t&&t.__v_isReadonly)}function Bx(t){return!!(t&&t.__v_isShallow)}function EB(t){return xh(t)||U0(t)}function ti(t){const n=t&&t.__v_raw;return n?ti(n):t}function xb(t){return Lx(t,"__v_skip",!0),t}const y_=t=>$n(t)?bo(t):t,lA=t=>$n(t)?uv(t):t;function TB(t){yh&&ic&&(t=ti(t),gB(t.dep||(t.dep=rA())))}function cA(t,n){t=ti(t);const a=t.dep;a&&DS(a)}function ai(t){return!!(t&&t.__v_isRef===!0)}function Ze(t){return SB(t,!1)}function Rs(t){return SB(t,!0)}function SB(t,n){return ai(t)?t:new HZ(t,n)}class HZ{constructor(n,a){this.__v_isShallow=a,this.dep=void 0,this.__v_isRef=!0,this._rawValue=a?n:ti(n),this._value=a?n:y_(n)}get value(){return TB(this),this._value}set value(n){const a=this.__v_isShallow||Bx(n)||U0(n);n=a?n:ti(n),Wd(n,this._rawValue)&&(this._rawValue=n,this._value=a?n:y_(n),cA(this))}}function Rg(t){cA(t)}function W(t){return ai(t)?t.value:t}const GZ={get:(t,n,a)=>W(Reflect.get(t,n,a)),set:(t,n,a,s)=>{const c=t[n];return ai(c)&&!ai(a)?(c.value=a,!0):Reflect.set(t,n,a,s)}};function CB(t){return xh(t)?t:new Proxy(t,GZ)}function yc(t){const n=Wr(t)?new Array(t.length):{};for(const a in t)n[a]=AB(t,a);return n}class qZ{constructor(n,a,s){this._object=n,this._key=a,this._defaultValue=s,this.__v_isRef=!0}get value(){const n=this._object[this._key];return n===void 0?this._defaultValue:n}set value(n){this._object[this._key]=n}get dep(){return CZ(ti(this._object),this._key)}}class XZ{constructor(n){this._getter=n,this.__v_isRef=!0,this.__v_isReadonly=!0}get value(){return this._getter()}}function Cl(t,n,a){return ai(t)?t:Yr(t)?new XZ(t):$n(t)&&arguments.length>1?AB(t,n,a):Ze(t)}function AB(t,n,a){const s=t[n];return ai(s)?s:new qZ(t,n,a)}class ZZ{constructor(n,a,s,c){this._setter=a,this.dep=void 0,this.__v_isRef=!0,this.__v_isReadonly=!1,this._dirty=!0,this.effect=new nA(n,()=>{this._dirty||(this._dirty=!0,cA(this))}),this.effect.computed=this,this.effect.active=this._cacheable=!c,this.__v_isReadonly=s}get value(){const n=ti(this);return TB(n),(n._dirty||!n._cacheable)&&(n._dirty=!1,n._value=n.effect.run()),n._value}set value(n){this._setter(n)}}function kB(t,n,a=!1){let s,c;const f=Yr(t);return f?(s=t,c=Si):(s=t.get,c=t.set),new ZZ(s,c,f||!c,a)}function KZ(t,...n){}function bh(t,n,a,s){let c;try{c=s?t(...s):t()}catch(f){bb(f,n,a)}return c}function kl(t,n,a,s){if(Yr(t)){const f=bh(t,n,a,s);return f&&Ox(f)&&f.catch(d=>{bb(d,n,a)}),f}const c=[];for(let f=0;f<t.length;f++)c.push(kl(t[f],n,a,s));return c}function bb(t,n,a,s=!0){const c=n?n.vnode:null;if(n){let f=n.parent;const d=n.proxy,p=a;for(;f;){const y=f.ec;if(y){for(let b=0;b<y.length;b++)if(y[b](t,d,p)===!1)return}f=f.parent}const g=n.appContext.config.errorHandler;if(g){bh(g,null,10,[t,d,p]);return}}YZ(t,a,c,s)}function YZ(t,n,a,s=!0){console.error(t)}let x_=!1,BS=!1;const Uo=[];let eu=0;const M0=[];let Uu=null,Cd=0;const IB=Promise.resolve();let uA=null;function Fn(t){const n=uA||IB;return t?n.then(this?t.bind(this):t):n}function JZ(t){let n=eu+1,a=Uo.length;for(;n<a;){const s=n+a>>>1,c=Uo[s],f=b_(c);f<t||f===t&&c.pre?n=s+1:a=s}return n}function fA(t){(!Uo.length||!Uo.includes(t,x_&&t.allowRecurse?eu+1:eu))&&(t.id==null?Uo.push(t):Uo.splice(JZ(t.id),0,t),MB())}function MB(){!x_&&!BS&&(BS=!0,uA=IB.then(PB))}function QZ(t){const n=Uo.indexOf(t);n>eu&&Uo.splice(n,1)}function eK(t){Wr(t)?M0.push(...t):(!Uu||!Uu.includes(t,t.allowRecurse?Cd+1:Cd))&&M0.push(t),MB()}function DR(t,n=x_?eu+1:0){for(;n<Uo.length;n++){const a=Uo[n];a&&a.pre&&(Uo.splice(n,1),n--,a())}}function FB(t){if(M0.length){const n=[...new Set(M0)];if(M0.length=0,Uu){Uu.push(...n);return}for(Uu=n,Uu.sort((a,s)=>b_(a)-b_(s)),Cd=0;Cd<Uu.length;Cd++)Uu[Cd]();Uu=null,Cd=0}}const b_=t=>t.id==null?1/0:t.id,tK=(t,n)=>{const a=b_(t)-b_(n);if(a===0){if(t.pre&&!n.pre)return-1;if(n.pre&&!t.pre)return 1}return a};function PB(t){BS=!1,x_=!0,Uo.sort(tK);const n=Si;try{for(eu=0;eu<Uo.length;eu++){const a=Uo[eu];a&&a.active!==!1&&bh(a,null,14)}}finally{eu=0,Uo.length=0,FB(),x_=!1,uA=null,(Uo.length||M0.length)&&PB()}}function rK(t,n,...a){if(t.isUnmounted)return;const s=t.vnode.props||Ea;let c=a;const f=n.startsWith("update:"),d=f&&n.slice(7);if(d&&d in s){const b=`${d==="modelValue"?"model":d}Modifiers`,{number:E,trim:T}=s[b]||Ea;T&&(c=a.map(S=>Mn(S)?S.trim():S)),E&&(c=a.map(PS))}let p,g=s[p=vx(n)]||s[p=vx(hc(n))];!g&&f&&(g=s[p=vx(Fh(n))]),g&&kl(g,t,6,c);const y=s[p+"Once"];if(y){if(!t.emitted)t.emitted={};else if(t.emitted[p])return;t.emitted[p]=!0,kl(y,t,6,c)}}function OB(t,n,a=!1){const s=n.emitsCache,c=s.get(t);if(c!==void 0)return c;const f=t.emits;let d={},p=!1;if(!Yr(t)){const g=y=>{const b=OB(y,n,!0);b&&(p=!0,Qa(d,b))};!a&&n.mixins.length&&n.mixins.forEach(g),t.extends&&g(t.extends),t.mixins&&t.mixins.forEach(g)}return!f&&!p?($n(t)&&s.set(t,null),null):(Wr(f)?f.forEach(g=>d[g]=null):Qa(d,f),$n(t)&&s.set(t,d),d)}function wb(t,n){return!t||!gb(n)?!1:(n=n.slice(2).replace(/Once$/,""),Kn(t,n[0].toLowerCase()+n.slice(1))||Kn(t,Fh(n))||Kn(t,n))}let yo=null,Eb=null;function zx(t){const n=yo;return yo=t,Eb=t&&t.type.__scopeId||null,n}function rf(t){Eb=t}function nf(){Eb=null}function we(t,n=yo,a){if(!n||t._n)return t;const s=(...c)=>{s._d&&ZR(-1);const f=zx(n);let d;try{d=t(...c)}finally{zx(f),s._d&&ZR(1)}return d};return s._n=!0,s._c=!0,s._d=!0,s}function UT(t){const{type:n,vnode:a,proxy:s,withProxy:c,props:f,propsOptions:[d],slots:p,attrs:g,emit:y,render:b,renderCache:E,data:T,setupState:S,ctx:I,inheritAttrs:A}=t;let M,F;const L=zx(t);try{if(a.shapeFlag&4){const N=c||s,Q=N;M=Yc(b.call(Q,N,E,f,S,T,I)),F=g}else{const N=n;M=Yc(N.length>1?N(f,{attrs:g,slots:p,emit:y}):N(f,null)),F=n.props?g:nK(g)}}catch(N){Yg.length=0,bb(N,t,1),M=me(Ls)}let O=M;if(F&&A!==!1){const N=Object.keys(F),{shapeFlag:Q}=O;N.length&&Q&7&&(d&&N.some(YC)&&(F=iK(F,d)),O=Ju(O,F))}return a.dirs&&(O=Ju(O),O.dirs=O.dirs?O.dirs.concat(a.dirs):a.dirs),a.transition&&(O.transition=a.transition),M=O,zx(L),M}const nK=t=>{let n;for(const a in t)(a==="class"||a==="style"||gb(a))&&((n||(n={}))[a]=t[a]);return n},iK=(t,n)=>{const a={};for(const s in t)(!YC(s)||!(s.slice(9)in n))&&(a[s]=t[s]);return a};function aK(t,n,a){const{props:s,children:c,component:f}=t,{props:d,children:p,patchFlag:g}=n,y=f.emitsOptions;if(n.dirs||n.transition)return!0;if(a&&g>=0){if(g&1024)return!0;if(g&16)return s?BR(s,d,y):!!d;if(g&8){const b=n.dynamicProps;for(let E=0;E<b.length;E++){const T=b[E];if(d[T]!==s[T]&&!wb(y,T))return!0}}}else return(c||p)&&(!p||!p.$stable)?!0:s===d?!1:s?d?BR(s,d,y):!0:!!d;return!1}function BR(t,n,a){const s=Object.keys(n);if(s.length!==Object.keys(t).length)return!0;for(let c=0;c<s.length;c++){const f=s[c];if(n[f]!==t[f]&&!wb(a,f))return!0}return!1}function oK({vnode:t,parent:n},a){for(;n&&n.subTree===t;)(t=n.vnode).el=a,n=n.parent}const hA="components",sK="directives";function Vi(t,n){return pA(hA,t,!0,n)||t}const RB=Symbol.for("v-ndc");function Zi(t){return Mn(t)?pA(hA,t,!1)||t:t||RB}function dA(t){return pA(sK,t)}function pA(t,n,a=!0,s=!1){const c=yo||lo;if(c){const f=c.type;if(t===hA){const p=JK(f,!1);if(p&&(p===n||p===hc(n)||p===cv(hc(n))))return f}const d=zR(c[t]||f[t],n)||zR(c.appContext[t],n);return!d&&s?f:d}}function zR(t,n){return t&&(t[n]||t[hc(n)]||t[cv(hc(n))])}const lK=t=>t.__isSuspense;function cK(t,n){n&&n.pendingBranch?Wr(t)?n.effects.push(...t):n.effects.push(t):eK(t)}function wh(t,n){return mA(t,null,n)}const $y={};function gr(t,n,a){return mA(t,n,a)}function mA(t,n,{immediate:a,deep:s,flush:c,onTrack:f,onTrigger:d}=Ea){var p;const g=eA()===((p=lo)==null?void 0:p.scope)?lo:null;let y,b=!1,E=!1;if(ai(t)?(y=()=>t.value,b=Bx(t)):xh(t)?(y=()=>t,s=!0):Wr(t)?(E=!0,b=t.some(N=>xh(N)||Bx(N)),y=()=>t.map(N=>{if(ai(N))return N.value;if(xh(N))return Fd(N);if(Yr(N))return bh(N,g,2)})):Yr(t)?n?y=()=>bh(t,g,2):y=()=>{if(!(g&&g.isUnmounted))return T&&T(),kl(t,g,3,[S])}:y=Si,n&&s){const N=y;y=()=>Fd(N())}let T,S=N=>{T=L.onStop=()=>{bh(N,g,4),T=L.onStop=void 0}},I;if(A_)if(S=Si,n?a&&kl(n,g,3,[y(),E?[]:void 0,S]):y(),c==="sync"){const N=tY();I=N.__watcherHandles||(N.__watcherHandles=[])}else return Si;let A=E?new Array(t.length).fill($y):$y;const M=()=>{if(L.active)if(n){const N=L.run();(s||b||(E?N.some((Q,ie)=>Wd(Q,A[ie])):Wd(N,A)))&&(T&&T(),kl(n,g,3,[N,A===$y?void 0:E&&A[0]===$y?[]:A,S]),A=N)}else L.run()};M.allowRecurse=!!n;let F;c==="sync"?F=M:c==="post"?F=()=>Fs(M,g&&g.suspense):(M.pre=!0,g&&(M.id=g.uid),F=()=>fA(M));const L=new nA(y,F);n?a?M():A=L.run():c==="post"?Fs(L.run.bind(L),g&&g.suspense):L.run();const O=()=>{L.stop(),g&&g.scope&&JC(g.scope.effects,L)};return I&&I.push(O),O}function uK(t,n,a){const s=this.proxy,c=Mn(t)?t.includes(".")?LB(s,t):()=>s[t]:t.bind(s,s);let f;Yr(n)?f=n:(f=n.handler,a=n);const d=lo;$0(this);const p=mA(c,f.bind(s),a);return d?$0(d):Bd(),p}function LB(t,n){const a=n.split(".");return()=>{let s=t;for(let c=0;c<a.length&&s;c++)s=s[a[c]];return s}}function Fd(t,n){if(!$n(t)||t.__v_skip||(n=n||new Set,n.has(t)))return t;if(n.add(t),ai(t))Fd(t.value,n);else if(Wr(t))for(let a=0;a<t.length;a++)Fd(t[a],n);else if(_b(t)||I0(t))t.forEach(a=>{Fd(a,n)});else if(Rx(t))for(const a in t)Fd(t[a],n);return t}function ci(t,n){const a=yo;if(a===null)return t;const s=kb(a)||a.proxy,c=t.dirs||(t.dirs=[]);for(let f=0;f<n.length;f++){let[d,p,g,y=Ea]=n[f];d&&(Yr(d)&&(d={mounted:d,updated:d}),d.deep&&Fd(p),c.push({dir:d,instance:s,value:p,oldValue:void 0,arg:g,modifiers:y}))}return t}function yd(t,n,a,s){const c=t.dirs,f=n&&n.dirs;for(let d=0;d<c.length;d++){const p=c[d];f&&(p.oldValue=f[d].value);let g=p.dir[s];g&&(um(),kl(g,a,8,[t.el,p,t,n]),fm())}}const fh=Symbol("_leaveCb"),Vy=Symbol("_enterCb");function DB(){const t={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return di(()=>{t.isMounted=!0}),to(()=>{t.isUnmounting=!0}),t}const xl=[Function,Array],BB={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:xl,onEnter:xl,onAfterEnter:xl,onEnterCancelled:xl,onBeforeLeave:xl,onLeave:xl,onAfterLeave:xl,onLeaveCancelled:xl,onBeforeAppear:xl,onAppear:xl,onAfterAppear:xl,onAppearCancelled:xl},fK={name:"BaseTransition",props:BB,setup(t,{slots:n}){const a=Tn(),s=DB();let c;return()=>{const f=n.default&&gA(n.default(),!0);if(!f||!f.length)return;let d=f[0];if(f.length>1){for(const A of f)if(A.type!==Ls){d=A;break}}const p=ti(t),{mode:g}=p;if(s.isLeaving)return $T(d);const y=NR(d);if(!y)return $T(d);const b=w_(y,p,s,a);E_(y,b);const E=a.subTree,T=E&&NR(E);let S=!1;const{getTransitionKey:I}=y.type;if(I){const A=I();c===void 0?c=A:A!==c&&(c=A,S=!0)}if(T&&T.type!==Ls&&(!Ad(y,T)||S)){const A=w_(T,p,s,a);if(E_(T,A),g==="out-in")return s.isLeaving=!0,A.afterLeave=()=>{s.isLeaving=!1,a.update.active!==!1&&a.update()},$T(d);g==="in-out"&&y.type!==Ls&&(A.delayLeave=(M,F,L)=>{const O=zB(s,T);O[String(T.key)]=T,M[fh]=()=>{F(),M[fh]=void 0,delete b.delayedLeave},b.delayedLeave=L})}return d}}},hK=fK;function zB(t,n){const{leavingVNodes:a}=t;let s=a.get(n.type);return s||(s=Object.create(null),a.set(n.type,s)),s}function w_(t,n,a,s){const{appear:c,mode:f,persisted:d=!1,onBeforeEnter:p,onEnter:g,onAfterEnter:y,onEnterCancelled:b,onBeforeLeave:E,onLeave:T,onAfterLeave:S,onLeaveCancelled:I,onBeforeAppear:A,onAppear:M,onAfterAppear:F,onAppearCancelled:L}=n,O=String(t.key),N=zB(a,t),Q=(V,D)=>{V&&kl(V,s,9,D)},ie=(V,D)=>{const te=D[1];Q(V,D),Wr(V)?V.every(ue=>ue.length<=1)&&te():V.length<=1&&te()},j={mode:f,persisted:d,beforeEnter(V){let D=p;if(!a.isMounted)if(c)D=A||p;else return;V[fh]&&V[fh](!0);const te=N[O];te&&Ad(t,te)&&te.el[fh]&&te.el[fh](),Q(D,[V])},enter(V){let D=g,te=y,ue=b;if(!a.isMounted)if(c)D=M||g,te=F||y,ue=L||b;else return;let J=!1;const le=V[Vy]=re=>{J||(J=!0,re?Q(ue,[V]):Q(te,[V]),j.delayedLeave&&j.delayedLeave(),V[Vy]=void 0)};D?ie(D,[V,le]):le()},leave(V,D){const te=String(t.key);if(V[Vy]&&V[Vy](!0),a.isUnmounting)return D();Q(E,[V]);let ue=!1;const J=V[fh]=le=>{ue||(ue=!0,D(),le?Q(I,[V]):Q(S,[V]),V[fh]=void 0,N[te]===t&&delete N[te])};N[te]=t,T?ie(T,[V,J]):J()},clone(V){return w_(V,n,a,s)}};return j}function $T(t){if(Tb(t))return t=Ju(t),t.children=null,t}function NR(t){return Tb(t)?t.children?t.children[0]:void 0:t}function E_(t,n){t.shapeFlag&6&&t.component?E_(t.component.subTree,n):t.shapeFlag&128?(t.ssContent.transition=n.clone(t.ssContent),t.ssFallback.transition=n.clone(t.ssFallback)):t.transition=n}function gA(t,n=!1,a){let s=[],c=0;for(let f=0;f<t.length;f++){let d=t[f];const p=a==null?d.key:String(a)+String(d.key!=null?d.key:f);d.type===mn?(d.patchFlag&128&&c++,s=s.concat(gA(d.children,n,p))):(n||d.type!==Ls)&&s.push(p!=null?Ju(d,{key:p}):d)}if(c>1)for(let f=0;f<s.length;f++)s[f].patchFlag=-2;return s}/*! #__NO_SIDE_EFFECTS__ */function Ft(t,n){return Yr(t)?(()=>Qa({name:t.name},n,{setup:t}))():t}const Xg=t=>!!t.type.__asyncLoader,Tb=t=>t.type.__isKeepAlive;function dK(t,n){UB(t,"a",n)}function NB(t,n){UB(t,"da",n)}function UB(t,n,a=lo){const s=t.__wdc||(t.__wdc=()=>{let c=a;for(;c;){if(c.isDeactivated)return;c=c.parent}return t()});if(Sb(n,s,a),a){let c=a.parent;for(;c&&c.parent;)Tb(c.parent.vnode)&&pK(s,n,a,c),c=c.parent}}function pK(t,n,a,s){const c=Sb(n,t,s,!0);of(()=>{JC(s[n],c)},a)}function Sb(t,n,a=lo,s=!1){if(a){const c=a[t]||(a[t]=[]),f=n.__weh||(n.__weh=(...d)=>{if(a.isUnmounted)return;um(),$0(a);const p=kl(n,a,t,d);return Bd(),fm(),p});return s?c.unshift(f):c.push(f),f}}const af=t=>(n,a=lo)=>(!A_||t==="sp")&&Sb(t,(...s)=>n(...s),a),Cb=af("bm"),di=af("m"),mK=af("bu"),hm=af("u"),to=af("bum"),of=af("um"),gK=af("sp"),_K=af("rtg"),vK=af("rtc");function yK(t,n=lo){Sb("ec",t,n)}function pa(t,n,a,s){let c;const f=a&&a[s];if(Wr(t)||Mn(t)){c=new Array(t.length);for(let d=0,p=t.length;d<p;d++)c[d]=n(t[d],d,void 0,f&&f[d])}else if(typeof t=="number"){c=new Array(t);for(let d=0;d<t;d++)c[d]=n(d+1,d,void 0,f&&f[d])}else if($n(t))if(t[Symbol.iterator])c=Array.from(t,(d,p)=>n(d,p,void 0,f&&f[p]));else{const d=Object.keys(t);c=new Array(d.length);for(let p=0,g=d.length;p<g;p++){const y=d[p];c[p]=n(t[y],y,p,f&&f[p])}}else c=[];return a&&(a[s]=c),c}function T_(t,n){for(let a=0;a<n.length;a++){const s=n[a];if(Wr(s))for(let c=0;c<s.length;c++)t[s[c].name]=s[c].fn;else s&&(t[s.name]=s.key?(...c)=>{const f=s.fn(...c);return f&&(f.key=s.key),f}:s.fn)}return t}function vr(t,n,a={},s,c){if(yo.isCE||yo.parent&&Xg(yo.parent)&&yo.parent.isCE)return n!=="default"&&(a.name=n),me("slot",a,s&&s());let f=t[n];f&&f._c&&(f._d=!1),De();const d=f&&$B(f(a)),p=Ht(mn,{key:a.key||d&&d.key||`_${n}`},d||(s?s():[]),d&&t._===1?64:-2);return!c&&p.scopeId&&(p.slotScopeIds=[p.scopeId+"-s"]),f&&f._c&&(f._d=!0),p}function $B(t){return t.some(n=>ps(n)?!(n.type===Ls||n.type===mn&&!$B(n.children)):!0)?t:null}function xK(t,n){const a={};for(const s in t)a[n&&/[A-Z]/.test(s)?`on:${s}`:vx(s)]=t[s];return a}const zS=t=>t?e8(t)?kb(t)||t.proxy:zS(t.parent):null,Zg=Qa(Object.create(null),{$:t=>t,$el:t=>t.vnode.el,$data:t=>t.data,$props:t=>t.props,$attrs:t=>t.attrs,$slots:t=>t.slots,$refs:t=>t.refs,$parent:t=>zS(t.parent),$root:t=>zS(t.root),$emit:t=>t.emit,$options:t=>_A(t),$forceUpdate:t=>t.f||(t.f=()=>fA(t.update)),$nextTick:t=>t.n||(t.n=Fn.bind(t.proxy)),$watch:t=>uK.bind(t)}),VT=(t,n)=>t!==Ea&&!t.__isScriptSetup&&Kn(t,n),bK={get({_:t},n){const{ctx:a,setupState:s,data:c,props:f,accessCache:d,type:p,appContext:g}=t;let y;if(n[0]!=="$"){const S=d[n];if(S!==void 0)switch(S){case 1:return s[n];case 2:return c[n];case 4:return a[n];case 3:return f[n]}else{if(VT(s,n))return d[n]=1,s[n];if(c!==Ea&&Kn(c,n))return d[n]=2,c[n];if((y=t.propsOptions[0])&&Kn(y,n))return d[n]=3,f[n];if(a!==Ea&&Kn(a,n))return d[n]=4,a[n];NS&&(d[n]=0)}}const b=Zg[n];let E,T;if(b)return n==="$attrs"&&Us(t,"get",n),b(t);if((E=p.__cssModules)&&(E=E[n]))return E;if(a!==Ea&&Kn(a,n))return d[n]=4,a[n];if(T=g.config.globalProperties,Kn(T,n))return T[n]},set({_:t},n,a){const{data:s,setupState:c,ctx:f}=t;return VT(c,n)?(c[n]=a,!0):s!==Ea&&Kn(s,n)?(s[n]=a,!0):Kn(t.props,n)||n[0]==="$"&&n.slice(1)in t?!1:(f[n]=a,!0)},has({_:{data:t,setupState:n,accessCache:a,ctx:s,appContext:c,propsOptions:f}},d){let p;return!!a[d]||t!==Ea&&Kn(t,d)||VT(n,d)||(p=f[0])&&Kn(p,d)||Kn(s,d)||Kn(Zg,d)||Kn(c.config.globalProperties,d)},defineProperty(t,n,a){return a.get!=null?t._.accessCache[n]=0:Kn(a,"value")&&this.set(t,n,a.value,null),Reflect.defineProperty(t,n,a)}};function sf(){return VB().slots}function wK(){return VB().attrs}function VB(){const t=Tn();return t.setupContext||(t.setupContext=r8(t))}function UR(t){return Wr(t)?t.reduce((n,a)=>(n[a]=null,n),{}):t}let NS=!0;function EK(t){const n=_A(t),a=t.proxy,s=t.ctx;NS=!1,n.beforeCreate&&$R(n.beforeCreate,t,"bc");const{data:c,computed:f,methods:d,watch:p,provide:g,inject:y,created:b,beforeMount:E,mounted:T,beforeUpdate:S,updated:I,activated:A,deactivated:M,beforeDestroy:F,beforeUnmount:L,destroyed:O,unmounted:N,render:Q,renderTracked:ie,renderTriggered:j,errorCaptured:V,serverPrefetch:D,expose:te,inheritAttrs:ue,components:J,directives:le,filters:re}=n;if(y&&TK(y,s,null),d)for(const Ee in d){const ut=d[Ee];Yr(ut)&&(s[Ee]=ut.bind(a))}if(c){const Ee=c.call(a,a);$n(Ee)&&(t.data=bo(Ee))}if(NS=!0,f)for(const Ee in f){const ut=f[Ee],Ne=Yr(ut)?ut.bind(a,a):Yr(ut.get)?ut.get.bind(a,a):Si,He=!Yr(ut)&&Yr(ut.set)?ut.set.bind(a):Si,Oe=Ve({get:Ne,set:He});Object.defineProperty(s,Ee,{enumerable:!0,configurable:!0,get:()=>Oe.value,set:Pe=>Oe.value=Pe})}if(p)for(const Ee in p)jB(p[Ee],s,a,Ee);if(g){const Ee=Yr(g)?g.call(a):g;Reflect.ownKeys(Ee).forEach(ut=>{Ji(ut,Ee[ut])})}b&&$R(b,t,"c");function Ye(Ee,ut){Wr(ut)?ut.forEach(Ne=>Ee(Ne.bind(a))):ut&&Ee(ut.bind(a))}if(Ye(Cb,E),Ye(di,T),Ye(mK,S),Ye(hm,I),Ye(dK,A),Ye(NB,M),Ye(yK,V),Ye(vK,ie),Ye(_K,j),Ye(to,L),Ye(of,N),Ye(gK,D),Wr(te))if(te.length){const Ee=t.exposed||(t.exposed={});te.forEach(ut=>{Object.defineProperty(Ee,ut,{get:()=>a[ut],set:Ne=>a[ut]=Ne})})}else t.exposed||(t.exposed={});Q&&t.render===Si&&(t.render=Q),ue!=null&&(t.inheritAttrs=ue),J&&(t.components=J),le&&(t.directives=le)}function TK(t,n,a=Si){Wr(t)&&(t=US(t));for(const s in t){const c=t[s];let f;$n(c)?"default"in c?f=Gr(c.from||s,c.default,!0):f=Gr(c.from||s):f=Gr(c),ai(f)?Object.defineProperty(n,s,{enumerable:!0,configurable:!0,get:()=>f.value,set:d=>f.value=d}):n[s]=f}}function $R(t,n,a){kl(Wr(t)?t.map(s=>s.bind(n.proxy)):t.bind(n.proxy),n,a)}function jB(t,n,a,s){const c=s.includes(".")?LB(a,s):()=>a[s];if(Mn(t)){const f=n[t];Yr(f)&&gr(c,f)}else if(Yr(t))gr(c,t.bind(a));else if($n(t))if(Wr(t))t.forEach(f=>jB(f,n,a,s));else{const f=Yr(t.handler)?t.handler.bind(a):n[t.handler];Yr(f)&&gr(c,f,t)}}function _A(t){const n=t.type,{mixins:a,extends:s}=n,{mixins:c,optionsCache:f,config:{optionMergeStrategies:d}}=t.appContext,p=f.get(n);let g;return p?g=p:!c.length&&!a&&!s?g=n:(g={},c.length&&c.forEach(y=>Nx(g,y,d,!0)),Nx(g,n,d)),$n(n)&&f.set(n,g),g}function Nx(t,n,a,s=!1){const{mixins:c,extends:f}=n;f&&Nx(t,f,a,!0),c&&c.forEach(d=>Nx(t,d,a,!0));for(const d in n)if(!(s&&d==="expose")){const p=SK[d]||a&&a[d];t[d]=p?p(t[d],n[d]):n[d]}return t}const SK={data:VR,props:jR,emits:jR,methods:Wg,computed:Wg,beforeCreate:os,created:os,beforeMount:os,mounted:os,beforeUpdate:os,updated:os,beforeDestroy:os,beforeUnmount:os,destroyed:os,unmounted:os,activated:os,deactivated:os,errorCaptured:os,serverPrefetch:os,components:Wg,directives:Wg,watch:AK,provide:VR,inject:CK};function VR(t,n){return n?t?function(){return Qa(Yr(t)?t.call(this,this):t,Yr(n)?n.call(this,this):n)}:n:t}function CK(t,n){return Wg(US(t),US(n))}function US(t){if(Wr(t)){const n={};for(let a=0;a<t.length;a++)n[t[a]]=t[a];return n}return t}function os(t,n){return t?[...new Set([].concat(t,n))]:n}function Wg(t,n){return t?Qa(Object.create(null),t,n):n}function jR(t,n){return t?Wr(t)&&Wr(n)?[...new Set([...t,...n])]:Qa(Object.create(null),UR(t),UR(n??{})):n}function AK(t,n){if(!t)return n;if(!n)return t;const a=Qa(Object.create(null),t);for(const s in n)a[s]=os(t[s],n[s]);return a}function WB(){return{app:null,config:{isNativeTag:fZ,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let kK=0;function IK(t,n){return function(s,c=null){Yr(s)||(s=Qa({},s)),c!=null&&!$n(c)&&(c=null);const f=WB(),d=new WeakSet;let p=!1;const g=f.app={_uid:kK++,_component:s,_props:c,_container:null,_context:f,_instance:null,version:rY,get config(){return f.config},set config(y){},use(y,...b){return d.has(y)||(y&&Yr(y.install)?(d.add(y),y.install(g,...b)):Yr(y)&&(d.add(y),y(g,...b))),g},mixin(y){return f.mixins.includes(y)||f.mixins.push(y),g},component(y,b){return b?(f.components[y]=b,g):f.components[y]},directive(y,b){return b?(f.directives[y]=b,g):f.directives[y]},mount(y,b,E){if(!p){const T=me(s,c);return T.appContext=f,b&&n?n(T,y):t(T,y,E),p=!0,g._container=y,y.__vue_app__=g,kb(T.component)||T.component.proxy}},unmount(){p&&(t(null,g._container),delete g._container.__vue_app__)},provide(y,b){return f.provides[y]=b,g},runWithContext(y){S_=g;try{return y()}finally{S_=null}}};return g}}let S_=null;function Ji(t,n){if(lo){let a=lo.provides;const s=lo.parent&&lo.parent.provides;s===a&&(a=lo.provides=Object.create(s)),a[t]=n}}function Gr(t,n,a=!1){const s=lo||yo;if(s||S_){const c=s?s.parent==null?s.vnode.appContext&&s.vnode.appContext.provides:s.parent.provides:S_._context.provides;if(c&&t in c)return c[t];if(arguments.length>1)return a&&Yr(n)?n.call(s&&s.proxy):n}}function MK(){return!!(lo||yo||S_)}function FK(t,n,a,s=!1){const c={},f={};Lx(f,Ab,1),t.propsDefaults=Object.create(null),HB(t,n,c,f);for(const d in t.propsOptions[0])d in c||(c[d]=void 0);a?t.props=s?c:oA(c):t.type.props?t.props=c:t.props=f,t.attrs=f}function PK(t,n,a,s){const{props:c,attrs:f,vnode:{patchFlag:d}}=t,p=ti(c),[g]=t.propsOptions;let y=!1;if((s||d>0)&&!(d&16)){if(d&8){const b=t.vnode.dynamicProps;for(let E=0;E<b.length;E++){let T=b[E];if(wb(t.emitsOptions,T))continue;const S=n[T];if(g)if(Kn(f,T))S!==f[T]&&(f[T]=S,y=!0);else{const I=hc(T);c[I]=$S(g,p,I,S,t,!1)}else S!==f[T]&&(f[T]=S,y=!0)}}}else{HB(t,n,c,f)&&(y=!0);let b;for(const E in p)(!n||!Kn(n,E)&&((b=Fh(E))===E||!Kn(n,b)))&&(g?a&&(a[E]!==void 0||a[b]!==void 0)&&(c[E]=$S(g,p,E,void 0,t,!0)):delete c[E]);if(f!==p)for(const E in f)(!n||!Kn(n,E))&&(delete f[E],y=!0)}y&&Gu(t,"set","$attrs")}function HB(t,n,a,s){const[c,f]=t.propsOptions;let d=!1,p;if(n)for(let g in n){if(_x(g))continue;const y=n[g];let b;c&&Kn(c,b=hc(g))?!f||!f.includes(b)?a[b]=y:(p||(p={}))[b]=y:wb(t.emitsOptions,g)||(!(g in s)||y!==s[g])&&(s[g]=y,d=!0)}if(f){const g=ti(a),y=p||Ea;for(let b=0;b<f.length;b++){const E=f[b];a[E]=$S(c,g,E,y[E],t,!Kn(y,E))}}return d}function $S(t,n,a,s,c,f){const d=t[a];if(d!=null){const p=Kn(d,"default");if(p&&s===void 0){const g=d.default;if(d.type!==Function&&!d.skipFactory&&Yr(g)){const{propsDefaults:y}=c;a in y?s=y[a]:($0(c),s=y[a]=g.call(null,n),Bd())}else s=g}d[0]&&(f&&!p?s=!1:d[1]&&(s===""||s===Fh(a))&&(s=!0))}return s}function GB(t,n,a=!1){const s=n.propsCache,c=s.get(t);if(c)return c;const f=t.props,d={},p=[];let g=!1;if(!Yr(t)){const b=E=>{g=!0;const[T,S]=GB(E,n,!0);Qa(d,T),S&&p.push(...S)};!a&&n.mixins.length&&n.mixins.forEach(b),t.extends&&b(t.extends),t.mixins&&t.mixins.forEach(b)}if(!f&&!g)return $n(t)&&s.set(t,k0),k0;if(Wr(f))for(let b=0;b<f.length;b++){const E=hc(f[b]);WR(E)&&(d[E]=Ea)}else if(f)for(const b in f){const E=hc(b);if(WR(E)){const T=f[b],S=d[E]=Wr(T)||Yr(T)?{type:T}:Qa({},T);if(S){const I=qR(Boolean,S.type),A=qR(String,S.type);S[0]=I>-1,S[1]=A<0||I<A,(I>-1||Kn(S,"default"))&&p.push(E)}}}const y=[d,p];return $n(t)&&s.set(t,y),y}function WR(t){return t[0]!=="$"}function HR(t){const n=t&&t.toString().match(/^\s*(function|class) (\w+)/);return n?n[2]:t===null?"null":""}function GR(t,n){return HR(t)===HR(n)}function qR(t,n){return Wr(n)?n.findIndex(a=>GR(a,t)):Yr(n)&&GR(n,t)?0:-1}const qB=t=>t[0]==="_"||t==="$stable",vA=t=>Wr(t)?t.map(Yc):[Yc(t)],OK=(t,n,a)=>{if(n._n)return n;const s=we((...c)=>vA(n(...c)),a);return s._c=!1,s},XB=(t,n,a)=>{const s=t._ctx;for(const c in t){if(qB(c))continue;const f=t[c];if(Yr(f))n[c]=OK(c,f,s);else if(f!=null){const d=vA(f);n[c]=()=>d}}},ZB=(t,n)=>{const a=vA(n);t.slots.default=()=>a},RK=(t,n)=>{if(t.vnode.shapeFlag&32){const a=n._;a?(t.slots=ti(n),Lx(n,"_",a)):XB(n,t.slots={})}else t.slots={},n&&ZB(t,n);Lx(t.slots,Ab,1)},LK=(t,n,a)=>{const{vnode:s,slots:c}=t;let f=!0,d=Ea;if(s.shapeFlag&32){const p=n._;p?a&&p===1?f=!1:(Qa(c,n),!a&&p===1&&delete c._):(f=!n.$stable,XB(n,c)),d=n}else n&&(ZB(t,n),d={default:1});if(f)for(const p in c)!qB(p)&&d[p]==null&&delete c[p]};function VS(t,n,a,s,c=!1){if(Wr(t)){t.forEach((T,S)=>VS(T,n&&(Wr(n)?n[S]:n),a,s,c));return}if(Xg(s)&&!c)return;const f=s.shapeFlag&4?kb(s.component)||s.component.proxy:s.el,d=c?null:f,{i:p,r:g}=t,y=n&&n.r,b=p.refs===Ea?p.refs={}:p.refs,E=p.setupState;if(y!=null&&y!==g&&(Mn(y)?(b[y]=null,Kn(E,y)&&(E[y]=null)):ai(y)&&(y.value=null)),Yr(g))bh(g,p,12,[d,b]);else{const T=Mn(g),S=ai(g);if(T||S){const I=()=>{if(t.f){const A=T?Kn(E,g)?E[g]:b[g]:g.value;c?Wr(A)&&JC(A,f):Wr(A)?A.includes(f)||A.push(f):T?(b[g]=[f],Kn(E,g)&&(E[g]=b[g])):(g.value=[f],t.k&&(b[t.k]=g.value))}else T?(b[g]=d,Kn(E,g)&&(E[g]=d)):S&&(g.value=d,t.k&&(b[t.k]=d))};d?(I.id=-1,Fs(I,a)):I()}}}const Fs=cK;function DK(t){return BK(t)}function BK(t,n){const a=OS();a.__VUE__=!0;const{insert:s,remove:c,patchProp:f,createElement:d,createText:p,createComment:g,setText:y,setElementText:b,parentNode:E,nextSibling:T,setScopeId:S=Si,insertStaticContent:I}=t,A=(xe,ae,X,Ce=null,he=null,G=null,K=!1,se=null,Ae=!!ae.dynamicChildren)=>{if(xe===ae)return;xe&&!Ad(xe,ae)&&(Ce=oe(xe),Pe(xe,he,G,!0),xe=null),ae.patchFlag===-2&&(Ae=!1,ae.dynamicChildren=null);const{type:Se,ref:ye,shapeFlag:Xe}=ae;switch(Se){case dm:M(xe,ae,X,Ce);break;case Ls:F(xe,ae,X,Ce);break;case jT:xe==null&&L(ae,X,Ce,K);break;case mn:J(xe,ae,X,Ce,he,G,K,se,Ae);break;default:Xe&1?Q(xe,ae,X,Ce,he,G,K,se,Ae):Xe&6?le(xe,ae,X,Ce,he,G,K,se,Ae):(Xe&64||Xe&128)&&Se.process(xe,ae,X,Ce,he,G,K,se,Ae,fe)}ye!=null&&he&&VS(ye,xe&&xe.ref,G,ae||xe,!ae)},M=(xe,ae,X,Ce)=>{if(xe==null)s(ae.el=p(ae.children),X,Ce);else{const he=ae.el=xe.el;ae.children!==xe.children&&y(he,ae.children)}},F=(xe,ae,X,Ce)=>{xe==null?s(ae.el=g(ae.children||""),X,Ce):ae.el=xe.el},L=(xe,ae,X,Ce)=>{[xe.el,xe.anchor]=I(xe.children,ae,X,Ce,xe.el,xe.anchor)},O=({el:xe,anchor:ae},X,Ce)=>{let he;for(;xe&&xe!==ae;)he=T(xe),s(xe,X,Ce),xe=he;s(ae,X,Ce)},N=({el:xe,anchor:ae})=>{let X;for(;xe&&xe!==ae;)X=T(xe),c(xe),xe=X;c(ae)},Q=(xe,ae,X,Ce,he,G,K,se,Ae)=>{K=K||ae.type==="svg",xe==null?ie(ae,X,Ce,he,G,K,se,Ae):D(xe,ae,he,G,K,se,Ae)},ie=(xe,ae,X,Ce,he,G,K,se)=>{let Ae,Se;const{type:ye,props:Xe,shapeFlag:be,transition:Be,dirs:ct}=xe;if(Ae=xe.el=d(xe.type,G,Xe&&Xe.is,Xe),be&8?b(Ae,xe.children):be&16&&V(xe.children,Ae,null,Ce,he,G&&ye!=="foreignObject",K,se),ct&&yd(xe,null,Ce,"created"),j(Ae,xe,xe.scopeId,K,Ce),Xe){for(const $t in Xe)$t!=="value"&&!_x($t)&&f(Ae,$t,null,Xe[$t],G,xe.children,Ce,he,ze);"value"in Xe&&f(Ae,"value",null,Xe.value),(Se=Xe.onVnodeBeforeMount)&&qc(Se,Ce,xe)}ct&&yd(xe,null,Ce,"beforeMount");const At=zK(he,Be);At&&Be.beforeEnter(Ae),s(Ae,ae,X),((Se=Xe&&Xe.onVnodeMounted)||At||ct)&&Fs(()=>{Se&&qc(Se,Ce,xe),At&&Be.enter(Ae),ct&&yd(xe,null,Ce,"mounted")},he)},j=(xe,ae,X,Ce,he)=>{if(X&&S(xe,X),Ce)for(let G=0;G<Ce.length;G++)S(xe,Ce[G]);if(he){let G=he.subTree;if(ae===G){const K=he.vnode;j(xe,K,K.scopeId,K.slotScopeIds,he.parent)}}},V=(xe,ae,X,Ce,he,G,K,se,Ae=0)=>{for(let Se=Ae;Se<xe.length;Se++){const ye=xe[Se]=se?hh(xe[Se]):Yc(xe[Se]);A(null,ye,ae,X,Ce,he,G,K,se)}},D=(xe,ae,X,Ce,he,G,K)=>{const se=ae.el=xe.el;let{patchFlag:Ae,dynamicChildren:Se,dirs:ye}=ae;Ae|=xe.patchFlag&16;const Xe=xe.props||Ea,be=ae.props||Ea;let Be;X&&xd(X,!1),(Be=be.onVnodeBeforeUpdate)&&qc(Be,X,ae,xe),ye&&yd(ae,xe,X,"beforeUpdate"),X&&xd(X,!0);const ct=he&&ae.type!=="foreignObject";if(Se?te(xe.dynamicChildren,Se,se,X,Ce,ct,G):K||ut(xe,ae,se,null,X,Ce,ct,G,!1),Ae>0){if(Ae&16)ue(se,ae,Xe,be,X,Ce,he);else if(Ae&2&&Xe.class!==be.class&&f(se,"class",null,be.class,he),Ae&4&&f(se,"style",Xe.style,be.style,he),Ae&8){const At=ae.dynamicProps;for(let $t=0;$t<At.length;$t++){const mr=At[$t],Nt=Xe[mr],Lt=be[mr];(Lt!==Nt||mr==="value")&&f(se,mr,Nt,Lt,he,xe.children,X,Ce,ze)}}Ae&1&&xe.children!==ae.children&&b(se,ae.children)}else!K&&Se==null&&ue(se,ae,Xe,be,X,Ce,he);((Be=be.onVnodeUpdated)||ye)&&Fs(()=>{Be&&qc(Be,X,ae,xe),ye&&yd(ae,xe,X,"updated")},Ce)},te=(xe,ae,X,Ce,he,G,K)=>{for(let se=0;se<ae.length;se++){const Ae=xe[se],Se=ae[se],ye=Ae.el&&(Ae.type===mn||!Ad(Ae,Se)||Ae.shapeFlag&70)?E(Ae.el):X;A(Ae,Se,ye,null,Ce,he,G,K,!0)}},ue=(xe,ae,X,Ce,he,G,K)=>{if(X!==Ce){if(X!==Ea)for(const se in X)!_x(se)&&!(se in Ce)&&f(xe,se,X[se],null,K,ae.children,he,G,ze);for(const se in Ce){if(_x(se))continue;const Ae=Ce[se],Se=X[se];Ae!==Se&&se!=="value"&&f(xe,se,Se,Ae,K,ae.children,he,G,ze)}"value"in Ce&&f(xe,"value",X.value,Ce.value)}},J=(xe,ae,X,Ce,he,G,K,se,Ae)=>{const Se=ae.el=xe?xe.el:p(""),ye=ae.anchor=xe?xe.anchor:p("");let{patchFlag:Xe,dynamicChildren:be,slotScopeIds:Be}=ae;Be&&(se=se?se.concat(Be):Be),xe==null?(s(Se,X,Ce),s(ye,X,Ce),V(ae.children,X,ye,he,G,K,se,Ae)):Xe>0&&Xe&64&&be&&xe.dynamicChildren?(te(xe.dynamicChildren,be,X,he,G,K,se),(ae.key!=null||he&&ae===he.subTree)&&yA(xe,ae,!0)):ut(xe,ae,X,ye,he,G,K,se,Ae)},le=(xe,ae,X,Ce,he,G,K,se,Ae)=>{ae.slotScopeIds=se,xe==null?ae.shapeFlag&512?he.ctx.activate(ae,X,Ce,K,Ae):re(ae,X,Ce,he,G,K,Ae):Fe(xe,ae,Ae)},re=(xe,ae,X,Ce,he,G,K)=>{const se=xe.component=XK(xe,Ce,he);if(Tb(xe)&&(se.ctx.renderer=fe),ZK(se),se.asyncDep){if(he&&he.registerDep(se,Ye),!xe.el){const Ae=se.subTree=me(Ls);F(null,Ae,ae,X)}return}Ye(se,xe,ae,X,he,G,K)},Fe=(xe,ae,X)=>{const Ce=ae.component=xe.component;if(aK(xe,ae,X))if(Ce.asyncDep&&!Ce.asyncResolved){Ee(Ce,ae,X);return}else Ce.next=ae,QZ(Ce.update),Ce.update();else ae.el=xe.el,Ce.vnode=ae},Ye=(xe,ae,X,Ce,he,G,K)=>{const se=()=>{if(xe.isMounted){let{next:ye,bu:Xe,u:be,parent:Be,vnode:ct}=xe,At=ye,$t;xd(xe,!1),ye?(ye.el=ct.el,Ee(xe,ye,K)):ye=ct,Xe&&yx(Xe),($t=ye.props&&ye.props.onVnodeBeforeUpdate)&&qc($t,Be,ye,ct),xd(xe,!0);const mr=UT(xe),Nt=xe.subTree;xe.subTree=mr,A(Nt,mr,E(Nt.el),oe(Nt),xe,he,G),ye.el=mr.el,At===null&&oK(xe,mr.el),be&&Fs(be,he),($t=ye.props&&ye.props.onVnodeUpdated)&&Fs(()=>qc($t,Be,ye,ct),he)}else{let ye;const{el:Xe,props:be}=ae,{bm:Be,m:ct,parent:At}=xe,$t=Xg(ae);if(xd(xe,!1),Be&&yx(Be),!$t&&(ye=be&&be.onVnodeBeforeMount)&&qc(ye,At,ae),xd(xe,!0),Xe&&ot){const mr=()=>{xe.subTree=UT(xe),ot(Xe,xe.subTree,xe,he,null)};$t?ae.type.__asyncLoader().then(()=>!xe.isUnmounted&&mr()):mr()}else{const mr=xe.subTree=UT(xe);A(null,mr,X,Ce,xe,he,G),ae.el=mr.el}if(ct&&Fs(ct,he),!$t&&(ye=be&&be.onVnodeMounted)){const mr=ae;Fs(()=>qc(ye,At,mr),he)}(ae.shapeFlag&256||At&&Xg(At.vnode)&&At.vnode.shapeFlag&256)&&xe.a&&Fs(xe.a,he),xe.isMounted=!0,ae=X=Ce=null}},Ae=xe.effect=new nA(se,()=>fA(Se),xe.scope),Se=xe.update=()=>Ae.run();Se.id=xe.uid,xd(xe,!0),Se()},Ee=(xe,ae,X)=>{ae.component=xe;const Ce=xe.vnode.props;xe.vnode=ae,xe.next=null,PK(xe,ae.props,Ce,X),LK(xe,ae.children,X),um(),DR(),fm()},ut=(xe,ae,X,Ce,he,G,K,se,Ae=!1)=>{const Se=xe&&xe.children,ye=xe?xe.shapeFlag:0,Xe=ae.children,{patchFlag:be,shapeFlag:Be}=ae;if(be>0){if(be&128){He(Se,Xe,X,Ce,he,G,K,se,Ae);return}else if(be&256){Ne(Se,Xe,X,Ce,he,G,K,se,Ae);return}}Be&8?(ye&16&&ze(Se,he,G),Xe!==Se&&b(X,Xe)):ye&16?Be&16?He(Se,Xe,X,Ce,he,G,K,se,Ae):ze(Se,he,G,!0):(ye&8&&b(X,""),Be&16&&V(Xe,X,Ce,he,G,K,se,Ae))},Ne=(xe,ae,X,Ce,he,G,K,se,Ae)=>{xe=xe||k0,ae=ae||k0;const Se=xe.length,ye=ae.length,Xe=Math.min(Se,ye);let be;for(be=0;be<Xe;be++){const Be=ae[be]=Ae?hh(ae[be]):Yc(ae[be]);A(xe[be],Be,X,null,he,G,K,se,Ae)}Se>ye?ze(xe,he,G,!0,!1,Xe):V(ae,X,Ce,he,G,K,se,Ae,Xe)},He=(xe,ae,X,Ce,he,G,K,se,Ae)=>{let Se=0;const ye=ae.length;let Xe=xe.length-1,be=ye-1;for(;Se<=Xe&&Se<=be;){const Be=xe[Se],ct=ae[Se]=Ae?hh(ae[Se]):Yc(ae[Se]);if(Ad(Be,ct))A(Be,ct,X,null,he,G,K,se,Ae);else break;Se++}for(;Se<=Xe&&Se<=be;){const Be=xe[Xe],ct=ae[be]=Ae?hh(ae[be]):Yc(ae[be]);if(Ad(Be,ct))A(Be,ct,X,null,he,G,K,se,Ae);else break;Xe--,be--}if(Se>Xe){if(Se<=be){const Be=be+1,ct=Be<ye?ae[Be].el:Ce;for(;Se<=be;)A(null,ae[Se]=Ae?hh(ae[Se]):Yc(ae[Se]),X,ct,he,G,K,se,Ae),Se++}}else if(Se>be)for(;Se<=Xe;)Pe(xe[Se],he,G,!0),Se++;else{const Be=Se,ct=Se,At=new Map;for(Se=ct;Se<=be;Se++){const Br=ae[Se]=Ae?hh(ae[Se]):Yc(ae[Se]);Br.key!=null&&At.set(Br.key,Se)}let $t,mr=0;const Nt=be-ct+1;let Lt=!1,Qt=0;const Gt=new Array(Nt);for(Se=0;Se<Nt;Se++)Gt[Se]=0;for(Se=Be;Se<=Xe;Se++){const Br=xe[Se];if(mr>=Nt){Pe(Br,he,G,!0);continue}let qr;if(Br.key!=null)qr=At.get(Br.key);else for($t=ct;$t<=be;$t++)if(Gt[$t-ct]===0&&Ad(Br,ae[$t])){qr=$t;break}qr===void 0?Pe(Br,he,G,!0):(Gt[qr-ct]=Se+1,qr>=Qt?Qt=qr:Lt=!0,A(Br,ae[qr],X,null,he,G,K,se,Ae),mr++)}const dr=Lt?NK(Gt):k0;for($t=dr.length-1,Se=Nt-1;Se>=0;Se--){const Br=ct+Se,qr=ae[Br],Ci=Br+1<ye?ae[Br+1].el:Ce;Gt[Se]===0?A(null,qr,X,Ci,he,G,K,se,Ae):Lt&&($t<0||Se!==dr[$t]?Oe(qr,X,Ci,2):$t--)}}},Oe=(xe,ae,X,Ce,he=null)=>{const{el:G,type:K,transition:se,children:Ae,shapeFlag:Se}=xe;if(Se&6){Oe(xe.component.subTree,ae,X,Ce);return}if(Se&128){xe.suspense.move(ae,X,Ce);return}if(Se&64){K.move(xe,ae,X,fe);return}if(K===mn){s(G,ae,X);for(let Xe=0;Xe<Ae.length;Xe++)Oe(Ae[Xe],ae,X,Ce);s(xe.anchor,ae,X);return}if(K===jT){O(xe,ae,X);return}if(Ce!==2&&Se&1&&se)if(Ce===0)se.beforeEnter(G),s(G,ae,X),Fs(()=>se.enter(G),he);else{const{leave:Xe,delayLeave:be,afterLeave:Be}=se,ct=()=>s(G,ae,X),At=()=>{Xe(G,()=>{ct(),Be&&Be()})};be?be(G,ct,At):At()}else s(G,ae,X)},Pe=(xe,ae,X,Ce=!1,he=!1)=>{const{type:G,props:K,ref:se,children:Ae,dynamicChildren:Se,shapeFlag:ye,patchFlag:Xe,dirs:be}=xe;if(se!=null&&VS(se,null,X,xe,!0),ye&256){ae.ctx.deactivate(xe);return}const Be=ye&1&&be,ct=!Xg(xe);let At;if(ct&&(At=K&&K.onVnodeBeforeUnmount)&&qc(At,ae,xe),ye&6)Ge(xe.component,X,Ce);else{if(ye&128){xe.suspense.unmount(X,Ce);return}Be&&yd(xe,null,ae,"beforeUnmount"),ye&64?xe.type.remove(xe,ae,X,he,fe,Ce):Se&&(G!==mn||Xe>0&&Xe&64)?ze(Se,ae,X,!1,!0):(G===mn&&Xe&384||!he&&ye&16)&&ze(Ae,ae,X),Ce&&rt(xe)}(ct&&(At=K&&K.onVnodeUnmounted)||Be)&&Fs(()=>{At&&qc(At,ae,xe),Be&&yd(xe,null,ae,"unmounted")},X)},rt=xe=>{const{type:ae,el:X,anchor:Ce,transition:he}=xe;if(ae===mn){et(X,Ce);return}if(ae===jT){N(xe);return}const G=()=>{c(X),he&&!he.persisted&&he.afterLeave&&he.afterLeave()};if(xe.shapeFlag&1&&he&&!he.persisted){const{leave:K,delayLeave:se}=he,Ae=()=>K(X,G);se?se(xe.el,G,Ae):Ae()}else G()},et=(xe,ae)=>{let X;for(;xe!==ae;)X=T(xe),c(xe),xe=X;c(ae)},Ge=(xe,ae,X)=>{const{bum:Ce,scope:he,update:G,subTree:K,um:se}=xe;Ce&&yx(Ce),he.stop(),G&&(G.active=!1,Pe(K,xe,ae,X)),se&&Fs(se,ae),Fs(()=>{xe.isUnmounted=!0},ae),ae&&ae.pendingBranch&&!ae.isUnmounted&&xe.asyncDep&&!xe.asyncResolved&&xe.suspenseId===ae.pendingId&&(ae.deps--,ae.deps===0&&ae.resolve())},ze=(xe,ae,X,Ce=!1,he=!1,G=0)=>{for(let K=G;K<xe.length;K++)Pe(xe[K],ae,X,Ce,he)},oe=xe=>xe.shapeFlag&6?oe(xe.component.subTree):xe.shapeFlag&128?xe.suspense.next():T(xe.anchor||xe.el),Me=(xe,ae,X)=>{xe==null?ae._vnode&&Pe(ae._vnode,null,null,!0):A(ae._vnode||null,xe,ae,null,null,null,X),DR(),FB(),ae._vnode=xe},fe={p:A,um:Pe,m:Oe,r:rt,mt:re,mc:V,pc:ut,pbc:te,n:oe,o:t};let pe,ot;return n&&([pe,ot]=n(fe)),{render:Me,hydrate:pe,createApp:IK(Me,pe)}}function xd({effect:t,update:n},a){t.allowRecurse=n.allowRecurse=a}function zK(t,n){return(!t||t&&!t.pendingBranch)&&n&&!n.persisted}function yA(t,n,a=!1){const s=t.children,c=n.children;if(Wr(s)&&Wr(c))for(let f=0;f<s.length;f++){const d=s[f];let p=c[f];p.shapeFlag&1&&!p.dynamicChildren&&((p.patchFlag<=0||p.patchFlag===32)&&(p=c[f]=hh(c[f]),p.el=d.el),a||yA(d,p)),p.type===dm&&(p.el=d.el)}}function NK(t){const n=t.slice(),a=[0];let s,c,f,d,p;const g=t.length;for(s=0;s<g;s++){const y=t[s];if(y!==0){if(c=a[a.length-1],t[c]<y){n[s]=c,a.push(s);continue}for(f=0,d=a.length-1;f<d;)p=f+d>>1,t[a[p]]<y?f=p+1:d=p;y<t[a[f]]&&(f>0&&(n[s]=a[f-1]),a[f]=s)}}for(f=a.length,d=a[f-1];f-- >0;)a[f]=d,d=n[d];return a}const UK=t=>t.__isTeleport,Kg=t=>t&&(t.disabled||t.disabled===""),XR=t=>typeof SVGElement<"u"&&t instanceof SVGElement,jS=(t,n)=>{const a=t&&t.to;return Mn(a)?n?n(a):null:a},$K={name:"Teleport",__isTeleport:!0,process(t,n,a,s,c,f,d,p,g,y){const{mc:b,pc:E,pbc:T,o:{insert:S,querySelector:I,createText:A,createComment:M}}=y,F=Kg(n.props);let{shapeFlag:L,children:O,dynamicChildren:N}=n;if(t==null){const Q=n.el=A(""),ie=n.anchor=A("");S(Q,a,s),S(ie,a,s);const j=n.target=jS(n.props,I),V=n.targetAnchor=A("");j&&(S(V,j),d=d||XR(j));const D=(te,ue)=>{L&16&&b(O,te,ue,c,f,d,p,g)};F?D(a,ie):j&&D(j,V)}else{n.el=t.el;const Q=n.anchor=t.anchor,ie=n.target=t.target,j=n.targetAnchor=t.targetAnchor,V=Kg(t.props),D=V?a:ie,te=V?Q:j;if(d=d||XR(ie),N?(T(t.dynamicChildren,N,D,c,f,d,p),yA(t,n,!0)):g||E(t,n,D,te,c,f,d,p,!1),F)V?n.props&&t.props&&n.props.to!==t.props.to&&(n.props.to=t.props.to):jy(n,a,Q,y,1);else if((n.props&&n.props.to)!==(t.props&&t.props.to)){const ue=n.target=jS(n.props,I);ue&&jy(n,ue,null,y,0)}else V&&jy(n,ie,j,y,1)}YB(n)},remove(t,n,a,s,{um:c,o:{remove:f}},d){const{shapeFlag:p,children:g,anchor:y,targetAnchor:b,target:E,props:T}=t;if(E&&f(b),d&&f(y),p&16){const S=d||!Kg(T);for(let I=0;I<g.length;I++){const A=g[I];c(A,n,a,S,!!A.dynamicChildren)}}},move:jy,hydrate:VK};function jy(t,n,a,{o:{insert:s},m:c},f=2){f===0&&s(t.targetAnchor,n,a);const{el:d,anchor:p,shapeFlag:g,children:y,props:b}=t,E=f===2;if(E&&s(d,n,a),(!E||Kg(b))&&g&16)for(let T=0;T<y.length;T++)c(y[T],n,a,2);E&&s(p,n,a)}function VK(t,n,a,s,c,f,{o:{nextSibling:d,parentNode:p,querySelector:g}},y){const b=n.target=jS(n.props,g);if(b){const E=b._lpa||b.firstChild;if(n.shapeFlag&16)if(Kg(n.props))n.anchor=y(d(t),n,p(t),a,s,c,f),n.targetAnchor=E;else{n.anchor=d(t);let T=E;for(;T;)if(T=d(T),T&&T.nodeType===8&&T.data==="teleport anchor"){n.targetAnchor=T,b._lpa=n.targetAnchor&&d(n.targetAnchor);break}y(E,n,b,a,s,c,f)}YB(n)}return n.anchor&&d(n.anchor)}const KB=$K;function YB(t){const n=t.ctx;if(n&&n.ut){let a=t.children[0].el;for(;a&&a!==t.targetAnchor;)a.nodeType===1&&a.setAttribute("data-v-owner",n.uid),a=a.nextSibling;n.ut()}}const mn=Symbol.for("v-fgt"),dm=Symbol.for("v-txt"),Ls=Symbol.for("v-cmt"),jT=Symbol.for("v-stc"),Yg=[];let ac=null;function De(t=!1){Yg.push(ac=t?null:[])}function jK(){Yg.pop(),ac=Yg[Yg.length-1]||null}let C_=1;function ZR(t){C_+=t}function JB(t){return t.dynamicChildren=C_>0?ac||k0:null,jK(),C_>0&&ac&&ac.push(t),t}function yt(t,n,a,s,c,f){return JB(gt(t,n,a,s,c,f,!0))}function Ht(t,n,a,s,c){return JB(me(t,n,a,s,c,!0))}function ps(t){return t?t.__v_isVNode===!0:!1}function Ad(t,n){return t.type===n.type&&t.key===n.key}const Ab="__vInternal",QB=({key:t})=>t??null,xx=({ref:t,ref_key:n,ref_for:a})=>(typeof t=="number"&&(t=""+t),t!=null?Mn(t)||ai(t)||Yr(t)?{i:yo,r:t,k:n,f:!!a}:t:null);function gt(t,n=null,a=null,s=0,c=null,f=t===mn?0:1,d=!1,p=!1){const g={__v_isVNode:!0,__v_skip:!0,type:t,props:n,key:n&&QB(n),ref:n&&xx(n),scopeId:Eb,slotScopeIds:null,children:a,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:f,patchFlag:s,dynamicProps:c,dynamicChildren:null,appContext:null,ctx:yo};return p?(xA(g,a),f&128&&t.normalize(g)):a&&(g.shapeFlag|=Mn(a)?8:16),C_>0&&!d&&ac&&(g.patchFlag>0||f&6)&&g.patchFlag!==32&&ac.push(g),g}const me=WK;function WK(t,n=null,a=null,s=0,c=null,f=!1){if((!t||t===RB)&&(t=Ls),ps(t)){const p=Ju(t,n,!0);return a&&xA(p,a),C_>0&&!f&&ac&&(p.shapeFlag&6?ac[ac.indexOf(t)]=p:ac.push(p)),p.patchFlag|=-2,p}if(QK(t)&&(t=t.__vccOpts),n){n=HK(n);let{class:p,style:g}=n;p&&!Mn(p)&&(n.class=ht(p)),$n(g)&&(EB(g)&&!Wr(g)&&(g=Qa({},g)),n.style=xn(g))}const d=Mn(t)?1:lK(t)?128:UK(t)?64:$n(t)?4:Yr(t)?2:0;return gt(t,n,a,s,c,d,f,!0)}function HK(t){return t?EB(t)||Ab in t?Qa({},t):t:null}function Ju(t,n,a=!1){const{props:s,ref:c,patchFlag:f,children:d}=t,p=n?Ds(s||{},n):s;return{__v_isVNode:!0,__v_skip:!0,type:t.type,props:p,key:p&&QB(p),ref:n&&n.ref?a&&c?Wr(c)?c.concat(xx(n)):[c,xx(n)]:xx(n):c,scopeId:t.scopeId,slotScopeIds:t.slotScopeIds,children:d,target:t.target,targetAnchor:t.targetAnchor,staticCount:t.staticCount,shapeFlag:t.shapeFlag,patchFlag:n&&t.type!==mn?f===-1?16:f|16:f,dynamicProps:t.dynamicProps,dynamicChildren:t.dynamicChildren,appContext:t.appContext,dirs:t.dirs,transition:t.transition,component:t.component,suspense:t.suspense,ssContent:t.ssContent&&Ju(t.ssContent),ssFallback:t.ssFallback&&Ju(t.ssFallback),el:t.el,anchor:t.anchor,ctx:t.ctx,ce:t.ce}}function Sr(t=" ",n=0){return me(dm,null,t,n)}function Wt(t="",n=!1){return n?(De(),Ht(Ls,null,t)):me(Ls,null,t)}function Yc(t){return t==null||typeof t=="boolean"?me(Ls):Wr(t)?me(mn,null,t.slice()):typeof t=="object"?hh(t):me(dm,null,String(t))}function hh(t){return t.el===null&&t.patchFlag!==-1||t.memo?t:Ju(t)}function xA(t,n){let a=0;const{shapeFlag:s}=t;if(n==null)n=null;else if(Wr(n))a=16;else if(typeof n=="object")if(s&65){const c=n.default;c&&(c._c&&(c._d=!1),xA(t,c()),c._c&&(c._d=!0));return}else{a=32;const c=n._;!c&&!(Ab in n)?n._ctx=yo:c===3&&yo&&(yo.slots._===1?n._=1:(n._=2,t.patchFlag|=1024))}else Yr(n)?(n={default:n,_ctx:yo},a=32):(n=String(n),s&64?(a=16,n=[Sr(n)]):a=8);t.children=n,t.shapeFlag|=a}function Ds(...t){const n={};for(let a=0;a<t.length;a++){const s=t[a];for(const c in s)if(c==="class")n.class!==s.class&&(n.class=ht([n.class,s.class]));else if(c==="style")n.style=xn([n.style,s.style]);else if(gb(c)){const f=n[c],d=s[c];d&&f!==d&&!(Wr(f)&&f.includes(d))&&(n[c]=f?[].concat(f,d):d)}else c!==""&&(n[c]=s[c])}return n}function qc(t,n,a,s=null){kl(t,n,7,[a,s])}const GK=WB();let qK=0;function XK(t,n,a){const s=t.type,c=(n?n.appContext:t.appContext)||GK,f={uid:qK++,vnode:t,type:s,parent:n,appContext:c,root:null,next:null,subTree:null,effect:null,update:null,scope:new fB(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:n?n.provides:Object.create(c.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:GB(s,c),emitsOptions:OB(s,c),emit:null,emitted:null,propsDefaults:Ea,inheritAttrs:s.inheritAttrs,ctx:Ea,data:Ea,props:Ea,attrs:Ea,slots:Ea,refs:Ea,setupState:Ea,setupContext:null,attrsProxy:null,slotsProxy:null,suspense:a,suspenseId:a?a.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return f.ctx={_:f},f.root=n?n.root:f,f.emit=rK.bind(null,f),t.ce&&t.ce(f),f}let lo=null;const Tn=()=>lo||yo;let bA,p0,KR="__VUE_INSTANCE_SETTERS__";(p0=OS()[KR])||(p0=OS()[KR]=[]),p0.push(t=>lo=t),bA=t=>{p0.length>1?p0.forEach(n=>n(t)):p0[0](t)};const $0=t=>{bA(t),t.scope.on()},Bd=()=>{lo&&lo.scope.off(),bA(null)};function e8(t){return t.vnode.shapeFlag&4}let A_=!1;function ZK(t,n=!1){A_=n;const{props:a,children:s}=t.vnode,c=e8(t);FK(t,a,c,n),RK(t,s);const f=c?KK(t,n):void 0;return A_=!1,f}function KK(t,n){const a=t.type;t.accessCache=Object.create(null),t.proxy=xb(new Proxy(t.ctx,bK));const{setup:s}=a;if(s){const c=t.setupContext=s.length>1?r8(t):null;$0(t),um();const f=bh(s,t,0,[t.props,c]);if(fm(),Bd(),Ox(f)){if(f.then(Bd,Bd),n)return f.then(d=>{YR(t,d,n)}).catch(d=>{bb(d,t,0)});t.asyncDep=f}else YR(t,f,n)}else t8(t,n)}function YR(t,n,a){Yr(n)?t.type.__ssrInlineRender?t.ssrRender=n:t.render=n:$n(n)&&(t.setupState=CB(n)),t8(t,a)}let JR;function t8(t,n,a){const s=t.type;if(!t.render){if(!n&&JR&&!s.render){const c=s.template||_A(t).template;if(c){const{isCustomElement:f,compilerOptions:d}=t.appContext.config,{delimiters:p,compilerOptions:g}=s,y=Qa(Qa({isCustomElement:f,delimiters:p},d),g);s.render=JR(c,y)}}t.render=s.render||Si}{$0(t),um();try{EK(t)}finally{fm(),Bd()}}}function YK(t){return t.attrsProxy||(t.attrsProxy=new Proxy(t.attrs,{get(n,a){return Us(t,"get","$attrs"),n[a]}}))}function r8(t){const n=a=>{t.exposed=a||{}};return{get attrs(){return YK(t)},slots:t.slots,emit:t.emit,expose:n}}function kb(t){if(t.exposed)return t.exposeProxy||(t.exposeProxy=new Proxy(CB(xb(t.exposed)),{get(n,a){if(a in n)return n[a];if(a in Zg)return Zg[a](t)},has(n,a){return a in n||a in Zg}}))}function JK(t,n=!0){return Yr(t)?t.displayName||t.name:t.name||n&&t.__name}function QK(t){return Yr(t)&&"__vccOpts"in t}const Ve=(t,n)=>kB(t,n,A_);function En(t,n,a){const s=arguments.length;return s===2?$n(n)&&!Wr(n)?ps(n)?me(t,null,[n]):me(t,n):me(t,null,n):(s>3?a=Array.prototype.slice.call(arguments,2):s===3&&ps(a)&&(a=[a]),me(t,n,a))}const eY=Symbol.for("v-scx"),tY=()=>Gr(eY),rY="3.3.10",nY="http://www.w3.org/2000/svg",kd=typeof document<"u"?document:null,QR=kd&&kd.createElement("template"),iY={insert:(t,n,a)=>{n.insertBefore(t,a||null)},remove:t=>{const n=t.parentNode;n&&n.removeChild(t)},createElement:(t,n,a,s)=>{const c=n?kd.createElementNS(nY,t):kd.createElement(t,a?{is:a}:void 0);return t==="select"&&s&&s.multiple!=null&&c.setAttribute("multiple",s.multiple),c},createText:t=>kd.createTextNode(t),createComment:t=>kd.createComment(t),setText:(t,n)=>{t.nodeValue=n},setElementText:(t,n)=>{t.textContent=n},parentNode:t=>t.parentNode,nextSibling:t=>t.nextSibling,querySelector:t=>kd.querySelector(t),setScopeId(t,n){t.setAttribute(n,"")},insertStaticContent(t,n,a,s,c,f){const d=a?a.previousSibling:n.lastChild;if(c&&(c===f||c.nextSibling))for(;n.insertBefore(c.cloneNode(!0),a),!(c===f||!(c=c.nextSibling)););else{QR.innerHTML=s?`<svg>${t}</svg>`:t;const p=QR.content;if(s){const g=p.firstChild;for(;g.firstChild;)p.appendChild(g.firstChild);p.removeChild(g)}n.insertBefore(p,a)}return[d?d.nextSibling:n.firstChild,a?a.previousSibling:n.lastChild]}},th="transition",Lg="animation",V0=Symbol("_vtc"),Xo=(t,{slots:n})=>En(hK,i8(t),n);Xo.displayName="Transition";const n8={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},aY=Xo.props=Qa({},BB,n8),bd=(t,n=[])=>{Wr(t)?t.forEach(a=>a(...n)):t&&t(...n)},eL=t=>t?Wr(t)?t.some(n=>n.length>1):t.length>1:!1;function i8(t){const n={};for(const J in t)J in n8||(n[J]=t[J]);if(t.css===!1)return n;const{name:a="v",type:s,duration:c,enterFromClass:f=`${a}-enter-from`,enterActiveClass:d=`${a}-enter-active`,enterToClass:p=`${a}-enter-to`,appearFromClass:g=f,appearActiveClass:y=d,appearToClass:b=p,leaveFromClass:E=`${a}-leave-from`,leaveActiveClass:T=`${a}-leave-active`,leaveToClass:S=`${a}-leave-to`}=t,I=oY(c),A=I&&I[0],M=I&&I[1],{onBeforeEnter:F,onEnter:L,onEnterCancelled:O,onLeave:N,onLeaveCancelled:Q,onBeforeAppear:ie=F,onAppear:j=L,onAppearCancelled:V=O}=n,D=(J,le,re)=>{oh(J,le?b:p),oh(J,le?y:d),re&&re()},te=(J,le)=>{J._isLeaving=!1,oh(J,E),oh(J,S),oh(J,T),le&&le()},ue=J=>(le,re)=>{const Fe=J?j:L,Ye=()=>D(le,J,re);bd(Fe,[le,Ye]),tL(()=>{oh(le,J?g:f),Bu(le,J?b:p),eL(Fe)||rL(le,s,A,Ye)})};return Qa(n,{onBeforeEnter(J){bd(F,[J]),Bu(J,f),Bu(J,d)},onBeforeAppear(J){bd(ie,[J]),Bu(J,g),Bu(J,y)},onEnter:ue(!1),onAppear:ue(!0),onLeave(J,le){J._isLeaving=!0;const re=()=>te(J,le);Bu(J,E),o8(),Bu(J,T),tL(()=>{J._isLeaving&&(oh(J,E),Bu(J,S),eL(N)||rL(J,s,M,re))}),bd(N,[J,re])},onEnterCancelled(J){D(J,!1),bd(O,[J])},onAppearCancelled(J){D(J,!0),bd(V,[J])},onLeaveCancelled(J){te(J),bd(Q,[J])}})}function oY(t){if(t==null)return null;if($n(t))return[WT(t.enter),WT(t.leave)];{const n=WT(t);return[n,n]}}function WT(t){return mZ(t)}function Bu(t,n){n.split(/\s+/).forEach(a=>a&&t.classList.add(a)),(t[V0]||(t[V0]=new Set)).add(n)}function oh(t,n){n.split(/\s+/).forEach(s=>s&&t.classList.remove(s));const a=t[V0];a&&(a.delete(n),a.size||(t[V0]=void 0))}function tL(t){requestAnimationFrame(()=>{requestAnimationFrame(t)})}let sY=0;function rL(t,n,a,s){const c=t._endId=++sY,f=()=>{c===t._endId&&s()};if(a)return setTimeout(f,a);const{type:d,timeout:p,propCount:g}=a8(t,n);if(!d)return s();const y=d+"end";let b=0;const E=()=>{t.removeEventListener(y,T),f()},T=S=>{S.target===t&&++b>=g&&E()};setTimeout(()=>{b<g&&E()},p+1),t.addEventListener(y,T)}function a8(t,n){const a=window.getComputedStyle(t),s=I=>(a[I]||"").split(", "),c=s(`${th}Delay`),f=s(`${th}Duration`),d=nL(c,f),p=s(`${Lg}Delay`),g=s(`${Lg}Duration`),y=nL(p,g);let b=null,E=0,T=0;n===th?d>0&&(b=th,E=d,T=f.length):n===Lg?y>0&&(b=Lg,E=y,T=g.length):(E=Math.max(d,y),b=E>0?d>y?th:Lg:null,T=b?b===th?f.length:g.length:0);const S=b===th&&/\b(transform|all)(,|$)/.test(s(`${th}Property`).toString());return{type:b,timeout:E,propCount:T,hasTransform:S}}function nL(t,n){for(;t.length<n.length;)t=t.concat(t);return Math.max(...n.map((a,s)=>iL(a)+iL(t[s])))}function iL(t){return t==="auto"?0:Number(t.slice(0,-1).replace(",","."))*1e3}function o8(){return document.body.offsetHeight}function lY(t,n,a){const s=t[V0];s&&(n=(n?[n,...s]:[...s]).join(" ")),n==null?t.removeAttribute("class"):a?t.setAttribute("class",n):t.className=n}const wA=Symbol("_vod"),la={beforeMount(t,{value:n},{transition:a}){t[wA]=t.style.display==="none"?"":t.style.display,a&&n?a.beforeEnter(t):Dg(t,n)},mounted(t,{value:n},{transition:a}){a&&n&&a.enter(t)},updated(t,{value:n,oldValue:a},{transition:s}){!n!=!a&&(s?n?(s.beforeEnter(t),Dg(t,!0),s.enter(t)):s.leave(t,()=>{Dg(t,!1)}):Dg(t,n))},beforeUnmount(t,{value:n}){Dg(t,n)}};function Dg(t,n){t.style.display=n?t[wA]:"none"}function cY(t,n,a){const s=t.style,c=Mn(a);if(a&&!c){if(n&&!Mn(n))for(const f in n)a[f]==null&&WS(s,f,"");for(const f in a)WS(s,f,a[f])}else{const f=s.display;c?n!==a&&(s.cssText=a):n&&t.removeAttribute("style"),wA in t&&(s.display=f)}}const aL=/\s*!important$/;function WS(t,n,a){if(Wr(a))a.forEach(s=>WS(t,n,s));else if(a==null&&(a=""),n.startsWith("--"))t.setProperty(n,a);else{const s=uY(t,n);aL.test(a)?t.setProperty(Fh(s),a.replace(aL,""),"important"):t[s]=a}}const oL=["Webkit","Moz","ms"],HT={};function uY(t,n){const a=HT[n];if(a)return a;let s=hc(n);if(s!=="filter"&&s in t)return HT[n]=s;s=cv(s);for(let c=0;c<oL.length;c++){const f=oL[c]+s;if(f in t)return HT[n]=f}return n}const sL="http://www.w3.org/1999/xlink";function fY(t,n,a,s,c){if(s&&n.startsWith("xlink:"))a==null?t.removeAttributeNS(sL,n.slice(6,n.length)):t.setAttributeNS(sL,n,a);else{const f=bZ(n);a==null||f&&!lB(a)?t.removeAttribute(n):t.setAttribute(n,f?"":a)}}function hY(t,n,a,s,c,f,d){if(n==="innerHTML"||n==="textContent"){s&&d(s,c,f),t[n]=a??"";return}const p=t.tagName;if(n==="value"&&p!=="PROGRESS"&&!p.includes("-")){t._value=a;const y=p==="OPTION"?t.getAttribute("value"):t.value,b=a??"";y!==b&&(t.value=b),a==null&&t.removeAttribute(n);return}let g=!1;if(a===""||a==null){const y=typeof t[n];y==="boolean"?a=lB(a):a==null&&y==="string"?(a="",g=!0):y==="number"&&(a=0,g=!0)}try{t[n]=a}catch{}g&&t.removeAttribute(n)}function ph(t,n,a,s){t.addEventListener(n,a,s)}function dY(t,n,a,s){t.removeEventListener(n,a,s)}const lL=Symbol("_vei");function pY(t,n,a,s,c=null){const f=t[lL]||(t[lL]={}),d=f[n];if(s&&d)d.value=s;else{const[p,g]=mY(n);if(s){const y=f[n]=vY(s,c);ph(t,p,y,g)}else d&&(dY(t,p,d,g),f[n]=void 0)}}const cL=/(?:Once|Passive|Capture)$/;function mY(t){let n;if(cL.test(t)){n={};let s;for(;s=t.match(cL);)t=t.slice(0,t.length-s[0].length),n[s[0].toLowerCase()]=!0}return[t[2]===":"?t.slice(3):Fh(t.slice(2)),n]}let GT=0;const gY=Promise.resolve(),_Y=()=>GT||(gY.then(()=>GT=0),GT=Date.now());function vY(t,n){const a=s=>{if(!s._vts)s._vts=Date.now();else if(s._vts<=a.attached)return;kl(yY(s,a.value),n,5,[s])};return a.value=t,a.attached=_Y(),a}function yY(t,n){if(Wr(n)){const a=t.stopImmediatePropagation;return t.stopImmediatePropagation=()=>{a.call(t),t._stopped=!0},n.map(s=>c=>!c._stopped&&s&&s(c))}else return n}const uL=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&t.charCodeAt(2)>96&&t.charCodeAt(2)<123,xY=(t,n,a,s,c=!1,f,d,p,g)=>{n==="class"?lY(t,s,c):n==="style"?cY(t,a,s):gb(n)?YC(n)||pY(t,n,a,s,d):(n[0]==="."?(n=n.slice(1),!0):n[0]==="^"?(n=n.slice(1),!1):bY(t,n,s,c))?hY(t,n,s,f,d,p,g):(n==="true-value"?t._trueValue=s:n==="false-value"&&(t._falseValue=s),fY(t,n,s,c))};function bY(t,n,a,s){if(s)return!!(n==="innerHTML"||n==="textContent"||n in t&&uL(n)&&Yr(a));if(n==="spellcheck"||n==="draggable"||n==="translate"||n==="form"||n==="list"&&t.tagName==="INPUT"||n==="type"&&t.tagName==="TEXTAREA")return!1;if(n==="width"||n==="height"){const c=t.tagName;return!(c==="IMG"||c==="VIDEO"||c==="CANVAS"||c==="SOURCE")}return uL(n)&&Mn(a)?!1:n in t}const s8=new WeakMap,l8=new WeakMap,Ux=Symbol("_moveCb"),fL=Symbol("_enterCb"),c8={name:"TransitionGroup",props:Qa({},aY,{tag:String,moveClass:String}),setup(t,{slots:n}){const a=Tn(),s=DB();let c,f;return hm(()=>{if(!c.length)return;const d=t.moveClass||`${t.name||"v"}-move`;if(!CY(c[0].el,a.vnode.el,d))return;c.forEach(EY),c.forEach(TY);const p=c.filter(SY);o8(),p.forEach(g=>{const y=g.el,b=y.style;Bu(y,d),b.transform=b.webkitTransform=b.transitionDuration="";const E=y[Ux]=T=>{T&&T.target!==y||(!T||/transform$/.test(T.propertyName))&&(y.removeEventListener("transitionend",E),y[Ux]=null,oh(y,d))};y.addEventListener("transitionend",E)})}),()=>{const d=ti(t),p=i8(d);let g=d.tag||mn;c=f,f=n.default?gA(n.default()):[];for(let y=0;y<f.length;y++){const b=f[y];b.key!=null&&E_(b,w_(b,p,s,a))}if(c)for(let y=0;y<c.length;y++){const b=c[y];E_(b,w_(b,p,s,a)),s8.set(b,b.el.getBoundingClientRect())}return me(g,null,f)}}},wY=t=>delete t.mode;c8.props;const u8=c8;function EY(t){const n=t.el;n[Ux]&&n[Ux](),n[fL]&&n[fL]()}function TY(t){l8.set(t,t.el.getBoundingClientRect())}function SY(t){const n=s8.get(t),a=l8.get(t),s=n.left-a.left,c=n.top-a.top;if(s||c){const f=t.el.style;return f.transform=f.webkitTransform=`translate(${s}px,${c}px)`,f.transitionDuration="0s",t}}function CY(t,n,a){const s=t.cloneNode(),c=t[V0];c&&c.forEach(p=>{p.split(/\s+/).forEach(g=>g&&s.classList.remove(g))}),a.split(/\s+/).forEach(p=>p&&s.classList.add(p)),s.style.display="none";const f=n.nodeType===1?n:n.parentNode;f.appendChild(s);const{hasTransform:d}=a8(s);return f.removeChild(s),d}const j0=t=>{const n=t.props["onUpdate:modelValue"]||!1;return Wr(n)?a=>yx(n,a):n};function AY(t){t.target.composing=!0}function hL(t){const n=t.target;n.composing&&(n.composing=!1,n.dispatchEvent(new Event("input")))}const qu=Symbol("_assign"),kY={created(t,{modifiers:{lazy:n,trim:a,number:s}},c){t[qu]=j0(c);const f=s||c.props&&c.props.type==="number";ph(t,n?"change":"input",d=>{if(d.target.composing)return;let p=t.value;a&&(p=p.trim()),f&&(p=PS(p)),t[qu](p)}),a&&ph(t,"change",()=>{t.value=t.value.trim()}),n||(ph(t,"compositionstart",AY),ph(t,"compositionend",hL),ph(t,"change",hL))},mounted(t,{value:n}){t.value=n??""},beforeUpdate(t,{value:n,modifiers:{lazy:a,trim:s,number:c}},f){if(t[qu]=j0(f),t.composing)return;const d=c||t.type==="number"?PS(t.value):t.value,p=n??"";d!==p&&(document.activeElement===t&&t.type!=="range"&&(a||s&&t.value.trim()===p)||(t.value=p))}},$x={deep:!0,created(t,n,a){t[qu]=j0(a),ph(t,"change",()=>{const s=t._modelValue,c=h8(t),f=t.checked,d=t[qu];if(Wr(s)){const p=cB(s,c),g=p!==-1;if(f&&!g)d(s.concat(c));else if(!f&&g){const y=[...s];y.splice(p,1),d(y)}}else if(_b(s)){const p=new Set(s);f?p.add(c):p.delete(c),d(p)}else d(d8(t,f))})},mounted:dL,beforeUpdate(t,n,a){t[qu]=j0(a),dL(t,n,a)}};function dL(t,{value:n,oldValue:a},s){t._modelValue=n,Wr(n)?t.checked=cB(n,s.props.value)>-1:_b(n)?t.checked=n.has(s.props.value):n!==a&&(t.checked=N0(n,d8(t,!0)))}const f8={created(t,{value:n},a){t.checked=N0(n,a.props.value),t[qu]=j0(a),ph(t,"change",()=>{t[qu](h8(t))})},beforeUpdate(t,{value:n,oldValue:a},s){t[qu]=j0(s),n!==a&&(t.checked=N0(n,s.props.value))}};function h8(t){return"_value"in t?t._value:t.value}function d8(t,n){const a=n?"_trueValue":"_falseValue";return a in t?t[a]:n}const IY=["ctrl","shift","alt","meta"],MY={stop:t=>t.stopPropagation(),prevent:t=>t.preventDefault(),self:t=>t.target!==t.currentTarget,ctrl:t=>!t.ctrlKey,shift:t=>!t.shiftKey,alt:t=>!t.altKey,meta:t=>!t.metaKey,left:t=>"button"in t&&t.button!==0,middle:t=>"button"in t&&t.button!==1,right:t=>"button"in t&&t.button!==2,exact:(t,n)=>IY.some(a=>t[`${a}Key`]&&!n.includes(a))},si=(t,n)=>t._withMods||(t._withMods=(a,...s)=>{for(let c=0;c<n.length;c++){const f=MY[n[c]];if(f&&f(a,n))return}return t(a,...s)}),FY={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},Ya=(t,n)=>t._withKeys||(t._withKeys=a=>{if(!("key"in a))return;const s=Fh(a.key);if(n.some(c=>c===s||FY[c]===s))return t(a)}),PY=Qa({patchProp:xY},iY);let pL;function p8(){return pL||(pL=DK(PY))}const W0=(...t)=>{p8().render(...t)},EA=(...t)=>{const n=p8().createApp(...t),{mount:a}=n;return n.mount=s=>{const c=OY(s);if(!c)return;const f=n._component;!Yr(f)&&!f.render&&!f.template&&(f.template=c.innerHTML),c.innerHTML="";const d=a(c,!1,c instanceof SVGElement);return c instanceof Element&&(c.removeAttribute("v-cloak"),c.setAttribute("data-v-app","")),d},n};function OY(t){return Mn(t)?document.querySelector(t):t}var RY=!1;/*!
 * pinia v2.1.7
 * (c) 2023 Eduardo San Martin Morote
 * @license MIT
 */let m8;const Ib=t=>m8=t,g8=Symbol();function HS(t){return t&&typeof t=="object"&&Object.prototype.toString.call(t)==="[object Object]"&&typeof t.toJSON!="function"}var Jg;(function(t){t.direct="direct",t.patchObject="patch object",t.patchFunction="patch function"})(Jg||(Jg={}));function LY(){const t=hB(!0),n=t.run(()=>Ze({}));let a=[],s=[];const c=xb({install(f){Ib(c),c._a=f,f.provide(g8,c),f.config.globalProperties.$pinia=c,s.forEach(d=>a.push(d)),s=[]},use(f){return!this._a&&!RY?s.push(f):a.push(f),this},_p:a,_a:null,_e:t,_s:new Map,state:n});return c}const _8=()=>{};function mL(t,n,a,s=_8){t.push(n);const c=()=>{const f=t.indexOf(n);f>-1&&(t.splice(f,1),s())};return!a&&eA()&&tA(c),c}function m0(t,...n){t.slice().forEach(a=>{a(...n)})}const DY=t=>t();function GS(t,n){t instanceof Map&&n instanceof Map&&n.forEach((a,s)=>t.set(s,a)),t instanceof Set&&n instanceof Set&&n.forEach(t.add,t);for(const a in n){if(!n.hasOwnProperty(a))continue;const s=n[a],c=t[a];HS(c)&&HS(s)&&t.hasOwnProperty(a)&&!ai(s)&&!xh(s)?t[a]=GS(c,s):t[a]=s}return t}const BY=Symbol();function zY(t){return!HS(t)||!t.hasOwnProperty(BY)}const{assign:sh}=Object;function NY(t){return!!(ai(t)&&t.effect)}function UY(t,n,a,s){const{state:c,actions:f,getters:d}=n,p=a.state.value[t];let g;function y(){p||(a.state.value[t]=c?c():{});const b=yc(a.state.value[t]);return sh(b,f,Object.keys(d||{}).reduce((E,T)=>(E[T]=xb(Ve(()=>{Ib(a);const S=a._s.get(t);return d[T].call(S,S)})),E),{}))}return g=v8(t,y,n,a,s,!0),g}function v8(t,n,a={},s,c,f){let d;const p=sh({actions:{}},a),g={deep:!0};let y,b,E=[],T=[],S;const I=s.state.value[t];!f&&!I&&(s.state.value[t]={}),Ze({});let A;function M(V){let D;y=b=!1,typeof V=="function"?(V(s.state.value[t]),D={type:Jg.patchFunction,storeId:t,events:S}):(GS(s.state.value[t],V),D={type:Jg.patchObject,payload:V,storeId:t,events:S});const te=A=Symbol();Fn().then(()=>{A===te&&(y=!0)}),b=!0,m0(E,D,s.state.value[t])}const F=f?function(){const{state:D}=a,te=D?D():{};this.$patch(ue=>{sh(ue,te)})}:_8;function L(){d.stop(),E=[],T=[],s._s.delete(t)}function O(V,D){return function(){Ib(s);const te=Array.from(arguments),ue=[],J=[];function le(Ye){ue.push(Ye)}function re(Ye){J.push(Ye)}m0(T,{args:te,name:V,store:Q,after:le,onError:re});let Fe;try{Fe=D.apply(this&&this.$id===t?this:Q,te)}catch(Ye){throw m0(J,Ye),Ye}return Fe instanceof Promise?Fe.then(Ye=>(m0(ue,Ye),Ye)).catch(Ye=>(m0(J,Ye),Promise.reject(Ye))):(m0(ue,Fe),Fe)}}const N={_p:s,$id:t,$onAction:mL.bind(null,T),$patch:M,$reset:F,$subscribe(V,D={}){const te=mL(E,V,D.detached,()=>ue()),ue=d.run(()=>gr(()=>s.state.value[t],J=>{(D.flush==="sync"?b:y)&&V({storeId:t,type:Jg.direct,events:S},J)},sh({},g,D)));return te},$dispose:L},Q=bo(N);s._s.set(t,Q);const j=(s._a&&s._a.runWithContext||DY)(()=>s._e.run(()=>(d=hB()).run(n)));for(const V in j){const D=j[V];if(ai(D)&&!NY(D)||xh(D))f||(I&&zY(D)&&(ai(D)?D.value=I[V]:GS(D,I[V])),s.state.value[t][V]=D);else if(typeof D=="function"){const te=O(V,D);j[V]=te,p.actions[V]=D}}return sh(Q,j),sh(ti(Q),j),Object.defineProperty(Q,"$state",{get:()=>s.state.value[t],set:V=>{M(D=>{sh(D,V)})}}),s._p.forEach(V=>{sh(Q,d.run(()=>V({store:Q,app:s._a,pinia:s,options:p})))}),I&&f&&a.hydrate&&a.hydrate(Q.$state,I),y=!0,b=!0,Q}function $Y(t,n,a){let s,c;const f=typeof n=="function";typeof t=="string"?(s=t,c=f?a:n):(c=t,s=t.id);function d(p,g){const y=MK();return p=p||(y?Gr(g8,null):null),p&&Ib(p),p=m8,p._s.has(s)||(f?v8(s,n,c,p):UY(s,c,p)),p._s.get(s)}return d.$id=s,d}const Ph=$Y("user",()=>{const t=Ze(!1),n=Ze(null),a=Ze(null),s=Ze(null);function c(d,p,g,y){t.value=!0,n.value=d,a.value=p,s.value=g,window.sessionStorage.setItem("token",y)}function f(){n.value=null,t.value=!1,a.value=null,s.value=null,window.sessionStorage.setItem("token",null)}return{isLoggedIn:t,id:n,username:a,role:s,login:c,logout:f}}),VY='a[href],button:not([disabled]),button:not([hidden]),:not([tabindex="-1"]),input:not([disabled]),input:not([type="hidden"]),select:not([disabled]),textarea:not([disabled])',jY=t=>getComputedStyle(t).position==="fixed"?!1:t.offsetParent!==null,gL=t=>Array.from(t.querySelectorAll(VY)).filter(n=>WY(n)&&jY(n)),WY=t=>{if(t.tabIndex>0||t.tabIndex===0&&t.getAttribute("tabIndex")!==null)return!0;if(t.disabled)return!1;switch(t.nodeName){case"A":return!!t.href&&t.rel!=="ignore";case"INPUT":return!(t.type==="hidden"||t.type==="file");case"BUTTON":case"SELECT":case"TEXTAREA":return!0;default:return!1}},$u=(t,n,{checkForDefaultPrevented:a=!0}={})=>c=>{const f=t==null?void 0:t(c);if(a===!1||!f)return n==null?void 0:n(c)};var HY=Object.defineProperty,GY=Object.defineProperties,qY=Object.getOwnPropertyDescriptors,_L=Object.getOwnPropertySymbols,XY=Object.prototype.hasOwnProperty,ZY=Object.prototype.propertyIsEnumerable,vL=(t,n,a)=>n in t?HY(t,n,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[n]=a,KY=(t,n)=>{for(var a in n||(n={}))XY.call(n,a)&&vL(t,a,n[a]);if(_L)for(var a of _L(n))ZY.call(n,a)&&vL(t,a,n[a]);return t},YY=(t,n)=>GY(t,qY(n));function yL(t,n){var a;const s=Rs();return wh(()=>{s.value=t()},YY(KY({},n),{flush:(a=n==null?void 0:n.flush)!=null?a:"sync"})),uv(s)}var xL;const Li=typeof window<"u",JY=t=>typeof t<"u",QY=t=>typeof t=="function",eJ=t=>typeof t=="string",Vx=()=>{},y8=Li&&((xL=window==null?void 0:window.navigator)==null?void 0:xL.userAgent)&&/iP(ad|hone|od)/.test(window.navigator.userAgent);function k_(t){return typeof t=="function"?t():W(t)}function tJ(t,n){function a(...s){return new Promise((c,f)=>{Promise.resolve(t(()=>n.apply(this,s),{fn:n,thisArg:this,args:s})).then(c).catch(f)})}return a}function rJ(t,n={}){let a,s,c=Vx;const f=p=>{clearTimeout(p),c(),c=Vx};return p=>{const g=k_(t),y=k_(n.maxWait);return a&&f(a),g<=0||y!==void 0&&y<=0?(s&&(f(s),s=null),Promise.resolve(p())):new Promise((b,E)=>{c=n.rejectOnCancel?E:b,y&&!s&&(s=setTimeout(()=>{a&&f(a),s=null,b(p())},y)),a=setTimeout(()=>{s&&f(s),s=null,b(p())},g)})}}function nJ(t){return t}function Mb(t){return eA()?(tA(t),!0):!1}function iJ(t,n=200,a={}){return tJ(rJ(n,a),t)}function aJ(t,n=200,a={}){const s=Ze(t.value),c=iJ(()=>{s.value=t.value},n,a);return gr(t,()=>c()),s}function oJ(t,n=!0){Tn()?di(t):n?t():Fn(t)}function jx(t,n,a={}){const{immediate:s=!0}=a,c=Ze(!1);let f=null;function d(){f&&(clearTimeout(f),f=null)}function p(){c.value=!1,d()}function g(...y){d(),c.value=!0,f=setTimeout(()=>{c.value=!1,f=null,t(...y)},k_(n))}return s&&(c.value=!0,Li&&g()),Mb(p),{isPending:uv(c),start:g,stop:p}}function gh(t){var n;const a=k_(t);return(n=a==null?void 0:a.$el)!=null?n:a}const Fb=Li?window:void 0,sJ=Li?window.document:void 0;function Bs(...t){let n,a,s,c;if(eJ(t[0])||Array.isArray(t[0])?([a,s,c]=t,n=Fb):[n,a,s,c]=t,!n)return Vx;Array.isArray(a)||(a=[a]),Array.isArray(s)||(s=[s]);const f=[],d=()=>{f.forEach(b=>b()),f.length=0},p=(b,E,T,S)=>(b.addEventListener(E,T,S),()=>b.removeEventListener(E,T,S)),g=gr(()=>[gh(n),k_(c)],([b,E])=>{d(),b&&f.push(...a.flatMap(T=>s.map(S=>p(b,T,S,E))))},{immediate:!0,flush:"post"}),y=()=>{g(),d()};return Mb(y),y}let bL=!1;function lJ(t,n,a={}){const{window:s=Fb,ignore:c=[],capture:f=!0,detectIframe:d=!1}=a;if(!s)return;y8&&!bL&&(bL=!0,Array.from(s.document.body.children).forEach(T=>T.addEventListener("click",Vx)));let p=!0;const g=T=>c.some(S=>{if(typeof S=="string")return Array.from(s.document.querySelectorAll(S)).some(I=>I===T.target||T.composedPath().includes(I));{const I=gh(S);return I&&(T.target===I||T.composedPath().includes(I))}}),b=[Bs(s,"click",T=>{const S=gh(t);if(!(!S||S===T.target||T.composedPath().includes(S))){if(T.detail===0&&(p=!g(T)),!p){p=!0;return}n(T)}},{passive:!0,capture:f}),Bs(s,"pointerdown",T=>{const S=gh(t);S&&(p=!T.composedPath().includes(S)&&!g(T))},{passive:!0}),d&&Bs(s,"blur",T=>{var S;const I=gh(t);((S=s.document.activeElement)==null?void 0:S.tagName)==="IFRAME"&&!(I!=null&&I.contains(s.document.activeElement))&&n(T)})].filter(Boolean);return()=>b.forEach(T=>T())}function cJ(t,n=!1){const a=Ze(),s=()=>a.value=!!t();return s(),oJ(s,n),a}function uJ(t){return JSON.parse(JSON.stringify(t))}const wL=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},EL="__vueuse_ssr_handlers__";wL[EL]=wL[EL]||{};function fJ({document:t=sJ}={}){if(!t)return Ze("visible");const n=Ze(t.visibilityState);return Bs(t,"visibilitychange",()=>{n.value=t.visibilityState}),n}var TL=Object.getOwnPropertySymbols,hJ=Object.prototype.hasOwnProperty,dJ=Object.prototype.propertyIsEnumerable,pJ=(t,n)=>{var a={};for(var s in t)hJ.call(t,s)&&n.indexOf(s)<0&&(a[s]=t[s]);if(t!=null&&TL)for(var s of TL(t))n.indexOf(s)<0&&dJ.call(t,s)&&(a[s]=t[s]);return a};function dc(t,n,a={}){const s=a,{window:c=Fb}=s,f=pJ(s,["window"]);let d;const p=cJ(()=>c&&"ResizeObserver"in c),g=()=>{d&&(d.disconnect(),d=void 0)},y=gr(()=>gh(t),E=>{g(),p.value&&c&&E&&(d=new ResizeObserver(n),d.observe(E,f))},{immediate:!0,flush:"post"}),b=()=>{g(),y()};return Mb(b),{isSupported:p,stop:b}}var SL;(function(t){t.UP="UP",t.RIGHT="RIGHT",t.DOWN="DOWN",t.LEFT="LEFT",t.NONE="NONE"})(SL||(SL={}));var mJ=Object.defineProperty,CL=Object.getOwnPropertySymbols,gJ=Object.prototype.hasOwnProperty,_J=Object.prototype.propertyIsEnumerable,AL=(t,n,a)=>n in t?mJ(t,n,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[n]=a,vJ=(t,n)=>{for(var a in n||(n={}))gJ.call(n,a)&&AL(t,a,n[a]);if(CL)for(var a of CL(n))_J.call(n,a)&&AL(t,a,n[a]);return t};const yJ={easeInSine:[.12,0,.39,0],easeOutSine:[.61,1,.88,1],easeInOutSine:[.37,0,.63,1],easeInQuad:[.11,0,.5,0],easeOutQuad:[.5,1,.89,1],easeInOutQuad:[.45,0,.55,1],easeInCubic:[.32,0,.67,0],easeOutCubic:[.33,1,.68,1],easeInOutCubic:[.65,0,.35,1],easeInQuart:[.5,0,.75,0],easeOutQuart:[.25,1,.5,1],easeInOutQuart:[.76,0,.24,1],easeInQuint:[.64,0,.78,0],easeOutQuint:[.22,1,.36,1],easeInOutQuint:[.83,0,.17,1],easeInExpo:[.7,0,.84,0],easeOutExpo:[.16,1,.3,1],easeInOutExpo:[.87,0,.13,1],easeInCirc:[.55,0,1,.45],easeOutCirc:[0,.55,.45,1],easeInOutCirc:[.85,0,.15,1],easeInBack:[.36,0,.66,-.56],easeOutBack:[.34,1.56,.64,1],easeInOutBack:[.68,-.6,.32,1.6]};vJ({linear:nJ},yJ);function xJ(t,n,a,s={}){var c,f,d;const{clone:p=!1,passive:g=!1,eventName:y,deep:b=!1,defaultValue:E}=s,T=Tn(),S=a||(T==null?void 0:T.emit)||((c=T==null?void 0:T.$emit)==null?void 0:c.bind(T))||((d=(f=T==null?void 0:T.proxy)==null?void 0:f.$emit)==null?void 0:d.bind(T==null?void 0:T.proxy));let I=y;n||(n="modelValue"),I=y||I||`update:${n.toString()}`;const A=F=>p?QY(p)?p(F):uJ(F):F,M=()=>JY(t[n])?A(t[n]):E;if(g){const F=M(),L=Ze(F);return gr(()=>t[n],O=>L.value=A(O)),gr(L,O=>{(O!==t[n]||b)&&S(I,O)},{deep:b}),L}else return Ve({get(){return M()},set(F){S(I,F)}})}function bJ({window:t=Fb}={}){if(!t)return Ze(!1);const n=Ze(t.document.hasFocus());return Bs(t,"blur",()=>{n.value=!1}),Bs(t,"focus",()=>{n.value=!0}),n}const wJ=()=>Li&&/firefox/i.test(window.navigator.userAgent);var EJ=typeof global=="object"&&global&&global.Object===Object&&global;const x8=EJ;var TJ=typeof self=="object"&&self&&self.Object===Object&&self,SJ=x8||TJ||Function("return this")();const xc=SJ;var CJ=xc.Symbol;const Pl=CJ;var b8=Object.prototype,AJ=b8.hasOwnProperty,kJ=b8.toString,Bg=Pl?Pl.toStringTag:void 0;function IJ(t){var n=AJ.call(t,Bg),a=t[Bg];try{t[Bg]=void 0;var s=!0}catch{}var c=kJ.call(t);return s&&(n?t[Bg]=a:delete t[Bg]),c}var MJ=Object.prototype,FJ=MJ.toString;function PJ(t){return FJ.call(t)}var OJ="[object Null]",RJ="[object Undefined]",kL=Pl?Pl.toStringTag:void 0;function rp(t){return t==null?t===void 0?RJ:OJ:kL&&kL in Object(t)?IJ(t):PJ(t)}function iu(t){return t!=null&&typeof t=="object"}var LJ="[object Symbol]";function Pb(t){return typeof t=="symbol"||iu(t)&&rp(t)==LJ}function w8(t,n){for(var a=-1,s=t==null?0:t.length,c=Array(s);++a<s;)c[a]=n(t[a],a,t);return c}var DJ=Array.isArray;const ms=DJ;var BJ=1/0,IL=Pl?Pl.prototype:void 0,ML=IL?IL.toString:void 0;function E8(t){if(typeof t=="string")return t;if(ms(t))return w8(t,E8)+"";if(Pb(t))return ML?ML.call(t):"";var n=t+"";return n=="0"&&1/t==-BJ?"-0":n}var zJ=/\s/;function NJ(t){for(var n=t.length;n--&&zJ.test(t.charAt(n)););return n}var UJ=/^\s+/;function $J(t){return t&&t.slice(0,NJ(t)+1).replace(UJ,"")}function gs(t){var n=typeof t;return t!=null&&(n=="object"||n=="function")}var FL=0/0,VJ=/^[-+]0x[0-9a-f]+$/i,jJ=/^0b[01]+$/i,WJ=/^0o[0-7]+$/i,HJ=parseInt;function qS(t){if(typeof t=="number")return t;if(Pb(t))return FL;if(gs(t)){var n=typeof t.valueOf=="function"?t.valueOf():t;t=gs(n)?n+"":n}if(typeof t!="string")return t===0?t:+t;t=$J(t);var a=jJ.test(t);return a||WJ.test(t)?HJ(t.slice(2),a?2:8):VJ.test(t)?FL:+t}var PL=1/0,GJ=17976931348623157e292;function qJ(t){if(!t)return t===0?t:0;if(t=qS(t),t===PL||t===-PL){var n=t<0?-1:1;return n*GJ}return t===t?t:0}function XJ(t){var n=qJ(t),a=n%1;return n===n?a?n-a:n:0}function TA(t){return t}var ZJ="[object AsyncFunction]",KJ="[object Function]",YJ="[object GeneratorFunction]",JJ="[object Proxy]";function SA(t){if(!gs(t))return!1;var n=rp(t);return n==KJ||n==YJ||n==ZJ||n==JJ}var QJ=xc["__core-js_shared__"];const qT=QJ;var OL=function(){var t=/[^.]+$/.exec(qT&&qT.keys&&qT.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();function eQ(t){return!!OL&&OL in t}var tQ=Function.prototype,rQ=tQ.toString;function np(t){if(t!=null){try{return rQ.call(t)}catch{}try{return t+""}catch{}}return""}var nQ=/[\\^$.*+?()[\]{}|]/g,iQ=/^\[object .+?Constructor\]$/,aQ=Function.prototype,oQ=Object.prototype,sQ=aQ.toString,lQ=oQ.hasOwnProperty,cQ=RegExp("^"+sQ.call(lQ).replace(nQ,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function uQ(t){if(!gs(t)||eQ(t))return!1;var n=SA(t)?cQ:iQ;return n.test(np(t))}function fQ(t,n){return t==null?void 0:t[n]}function ip(t,n){var a=fQ(t,n);return uQ(a)?a:void 0}var hQ=ip(xc,"WeakMap");const XS=hQ;var RL=Object.create,dQ=function(){function t(){}return function(n){if(!gs(n))return{};if(RL)return RL(n);t.prototype=n;var a=new t;return t.prototype=void 0,a}}();const pQ=dQ;function mQ(t,n,a){switch(a.length){case 0:return t.call(n);case 1:return t.call(n,a[0]);case 2:return t.call(n,a[0],a[1]);case 3:return t.call(n,a[0],a[1],a[2])}return t.apply(n,a)}function T8(t,n){var a=-1,s=t.length;for(n||(n=Array(s));++a<s;)n[a]=t[a];return n}var gQ=800,_Q=16,vQ=Date.now;function yQ(t){var n=0,a=0;return function(){var s=vQ(),c=_Q-(s-a);if(a=s,c>0){if(++n>=gQ)return arguments[0]}else n=0;return t.apply(void 0,arguments)}}function xQ(t){return function(){return t}}var bQ=function(){try{var t=ip(Object,"defineProperty");return t({},"",{}),t}catch{}}();const Wx=bQ;var wQ=Wx?function(t,n){return Wx(t,"toString",{configurable:!0,enumerable:!1,value:xQ(n),writable:!0})}:TA;const EQ=wQ;var TQ=yQ(EQ);const S8=TQ;function SQ(t,n){for(var a=-1,s=t==null?0:t.length;++a<s&&n(t[a],a,t)!==!1;);return t}function CQ(t,n,a,s){for(var c=t.length,f=a+(s?1:-1);s?f--:++f<c;)if(n(t[f],f,t))return f;return-1}var AQ=9007199254740991,kQ=/^(?:0|[1-9]\d*)$/;function Ob(t,n){var a=typeof t;return n=n??AQ,!!n&&(a=="number"||a!="symbol"&&kQ.test(t))&&t>-1&&t%1==0&&t<n}function CA(t,n,a){n=="__proto__"&&Wx?Wx(t,n,{configurable:!0,enumerable:!0,value:a,writable:!0}):t[n]=a}function fv(t,n){return t===n||t!==t&&n!==n}var IQ=Object.prototype,MQ=IQ.hasOwnProperty;function AA(t,n,a){var s=t[n];(!(MQ.call(t,n)&&fv(s,a))||a===void 0&&!(n in t))&&CA(t,n,a)}function hv(t,n,a,s){var c=!a;a||(a={});for(var f=-1,d=n.length;++f<d;){var p=n[f],g=s?s(a[p],t[p],p,a,t):void 0;g===void 0&&(g=t[p]),c?CA(a,p,g):AA(a,p,g)}return a}var LL=Math.max;function C8(t,n,a){return n=LL(n===void 0?t.length-1:n,0),function(){for(var s=arguments,c=-1,f=LL(s.length-n,0),d=Array(f);++c<f;)d[c]=s[n+c];c=-1;for(var p=Array(n+1);++c<n;)p[c]=s[c];return p[n]=a(d),mQ(t,this,p)}}function FQ(t,n){return S8(C8(t,n,TA),t+"")}var PQ=9007199254740991;function kA(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=PQ}function pm(t){return t!=null&&kA(t.length)&&!SA(t)}function OQ(t,n,a){if(!gs(a))return!1;var s=typeof n;return(s=="number"?pm(a)&&Ob(n,a.length):s=="string"&&n in a)?fv(a[n],t):!1}function RQ(t){return FQ(function(n,a){var s=-1,c=a.length,f=c>1?a[c-1]:void 0,d=c>2?a[2]:void 0;for(f=t.length>3&&typeof f=="function"?(c--,f):void 0,d&&OQ(a[0],a[1],d)&&(f=c<3?void 0:f,c=1),n=Object(n);++s<c;){var p=a[s];p&&t(n,p,s,f)}return n})}var LQ=Object.prototype;function IA(t){var n=t&&t.constructor,a=typeof n=="function"&&n.prototype||LQ;return t===a}function DQ(t,n){for(var a=-1,s=Array(t);++a<t;)s[a]=n(a);return s}var BQ="[object Arguments]";function DL(t){return iu(t)&&rp(t)==BQ}var A8=Object.prototype,zQ=A8.hasOwnProperty,NQ=A8.propertyIsEnumerable,UQ=DL(function(){return arguments}())?DL:function(t){return iu(t)&&zQ.call(t,"callee")&&!NQ.call(t,"callee")};const I_=UQ;function $Q(){return!1}var k8=typeof al=="object"&&al&&!al.nodeType&&al,BL=k8&&typeof ol=="object"&&ol&&!ol.nodeType&&ol,VQ=BL&&BL.exports===k8,zL=VQ?xc.Buffer:void 0,jQ=zL?zL.isBuffer:void 0,WQ=jQ||$Q;const M_=WQ;var HQ="[object Arguments]",GQ="[object Array]",qQ="[object Boolean]",XQ="[object Date]",ZQ="[object Error]",KQ="[object Function]",YQ="[object Map]",JQ="[object Number]",QQ="[object Object]",eee="[object RegExp]",tee="[object Set]",ree="[object String]",nee="[object WeakMap]",iee="[object ArrayBuffer]",aee="[object DataView]",oee="[object Float32Array]",see="[object Float64Array]",lee="[object Int8Array]",cee="[object Int16Array]",uee="[object Int32Array]",fee="[object Uint8Array]",hee="[object Uint8ClampedArray]",dee="[object Uint16Array]",pee="[object Uint32Array]",wa={};wa[oee]=wa[see]=wa[lee]=wa[cee]=wa[uee]=wa[fee]=wa[hee]=wa[dee]=wa[pee]=!0;wa[HQ]=wa[GQ]=wa[iee]=wa[qQ]=wa[aee]=wa[XQ]=wa[ZQ]=wa[KQ]=wa[YQ]=wa[JQ]=wa[QQ]=wa[eee]=wa[tee]=wa[ree]=wa[nee]=!1;function mee(t){return iu(t)&&kA(t.length)&&!!wa[rp(t)]}function MA(t){return function(n){return t(n)}}var I8=typeof al=="object"&&al&&!al.nodeType&&al,Qg=I8&&typeof ol=="object"&&ol&&!ol.nodeType&&ol,gee=Qg&&Qg.exports===I8,XT=gee&&x8.process,_ee=function(){try{var t=Qg&&Qg.require&&Qg.require("util").types;return t||XT&&XT.binding&&XT.binding("util")}catch{}}();const H0=_ee;var NL=H0&&H0.isTypedArray,vee=NL?MA(NL):mee;const FA=vee;var yee=Object.prototype,xee=yee.hasOwnProperty;function M8(t,n){var a=ms(t),s=!a&&I_(t),c=!a&&!s&&M_(t),f=!a&&!s&&!c&&FA(t),d=a||s||c||f,p=d?DQ(t.length,String):[],g=p.length;for(var y in t)(n||xee.call(t,y))&&!(d&&(y=="length"||c&&(y=="offset"||y=="parent")||f&&(y=="buffer"||y=="byteLength"||y=="byteOffset")||Ob(y,g)))&&p.push(y);return p}function F8(t,n){return function(a){return t(n(a))}}var bee=F8(Object.keys,Object);const wee=bee;var Eee=Object.prototype,Tee=Eee.hasOwnProperty;function See(t){if(!IA(t))return wee(t);var n=[];for(var a in Object(t))Tee.call(t,a)&&a!="constructor"&&n.push(a);return n}function dv(t){return pm(t)?M8(t):See(t)}function Cee(t){var n=[];if(t!=null)for(var a in Object(t))n.push(a);return n}var Aee=Object.prototype,kee=Aee.hasOwnProperty;function Iee(t){if(!gs(t))return Cee(t);var n=IA(t),a=[];for(var s in t)s=="constructor"&&(n||!kee.call(t,s))||a.push(s);return a}function pv(t){return pm(t)?M8(t,!0):Iee(t)}var Mee=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Fee=/^\w*$/;function PA(t,n){if(ms(t))return!1;var a=typeof t;return a=="number"||a=="symbol"||a=="boolean"||t==null||Pb(t)?!0:Fee.test(t)||!Mee.test(t)||n!=null&&t in Object(n)}var Pee=ip(Object,"create");const F_=Pee;function Oee(){this.__data__=F_?F_(null):{},this.size=0}function Ree(t){var n=this.has(t)&&delete this.__data__[t];return this.size-=n?1:0,n}var Lee="__lodash_hash_undefined__",Dee=Object.prototype,Bee=Dee.hasOwnProperty;function zee(t){var n=this.__data__;if(F_){var a=n[t];return a===Lee?void 0:a}return Bee.call(n,t)?n[t]:void 0}var Nee=Object.prototype,Uee=Nee.hasOwnProperty;function $ee(t){var n=this.__data__;return F_?n[t]!==void 0:Uee.call(n,t)}var Vee="__lodash_hash_undefined__";function jee(t,n){var a=this.__data__;return this.size+=this.has(t)?0:1,a[t]=F_&&n===void 0?Vee:n,this}function Hd(t){var n=-1,a=t==null?0:t.length;for(this.clear();++n<a;){var s=t[n];this.set(s[0],s[1])}}Hd.prototype.clear=Oee;Hd.prototype.delete=Ree;Hd.prototype.get=zee;Hd.prototype.has=$ee;Hd.prototype.set=jee;function Wee(){this.__data__=[],this.size=0}function Rb(t,n){for(var a=t.length;a--;)if(fv(t[a][0],n))return a;return-1}var Hee=Array.prototype,Gee=Hee.splice;function qee(t){var n=this.__data__,a=Rb(n,t);if(a<0)return!1;var s=n.length-1;return a==s?n.pop():Gee.call(n,a,1),--this.size,!0}function Xee(t){var n=this.__data__,a=Rb(n,t);return a<0?void 0:n[a][1]}function Zee(t){return Rb(this.__data__,t)>-1}function Kee(t,n){var a=this.__data__,s=Rb(a,t);return s<0?(++this.size,a.push([t,n])):a[s][1]=n,this}function lf(t){var n=-1,a=t==null?0:t.length;for(this.clear();++n<a;){var s=t[n];this.set(s[0],s[1])}}lf.prototype.clear=Wee;lf.prototype.delete=qee;lf.prototype.get=Xee;lf.prototype.has=Zee;lf.prototype.set=Kee;var Yee=ip(xc,"Map");const P_=Yee;function Jee(){this.size=0,this.__data__={hash:new Hd,map:new(P_||lf),string:new Hd}}function Qee(t){var n=typeof t;return n=="string"||n=="number"||n=="symbol"||n=="boolean"?t!=="__proto__":t===null}function Lb(t,n){var a=t.__data__;return Qee(n)?a[typeof n=="string"?"string":"hash"]:a.map}function ete(t){var n=Lb(this,t).delete(t);return this.size-=n?1:0,n}function tte(t){return Lb(this,t).get(t)}function rte(t){return Lb(this,t).has(t)}function nte(t,n){var a=Lb(this,t),s=a.size;return a.set(t,n),this.size+=a.size==s?0:1,this}function cf(t){var n=-1,a=t==null?0:t.length;for(this.clear();++n<a;){var s=t[n];this.set(s[0],s[1])}}cf.prototype.clear=Jee;cf.prototype.delete=ete;cf.prototype.get=tte;cf.prototype.has=rte;cf.prototype.set=nte;var ite="Expected a function";function OA(t,n){if(typeof t!="function"||n!=null&&typeof n!="function")throw new TypeError(ite);var a=function(){var s=arguments,c=n?n.apply(this,s):s[0],f=a.cache;if(f.has(c))return f.get(c);var d=t.apply(this,s);return a.cache=f.set(c,d)||f,d};return a.cache=new(OA.Cache||cf),a}OA.Cache=cf;var ate=500;function ote(t){var n=OA(t,function(s){return a.size===ate&&a.clear(),s}),a=n.cache;return n}var ste=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,lte=/\\(\\)?/g,cte=ote(function(t){var n=[];return t.charCodeAt(0)===46&&n.push(""),t.replace(ste,function(a,s,c,f){n.push(c?f.replace(lte,"$1"):s||a)}),n});const ute=cte;function fte(t){return t==null?"":E8(t)}function Db(t,n){return ms(t)?t:PA(t,n)?[t]:ute(fte(t))}var hte=1/0;function mv(t){if(typeof t=="string"||Pb(t))return t;var n=t+"";return n=="0"&&1/t==-hte?"-0":n}function RA(t,n){n=Db(n,t);for(var a=0,s=n.length;t!=null&&a<s;)t=t[mv(n[a++])];return a&&a==s?t:void 0}function Bo(t,n,a){var s=t==null?void 0:RA(t,n);return s===void 0?a:s}function LA(t,n){for(var a=-1,s=n.length,c=t.length;++a<s;)t[c+a]=n[a];return t}var UL=Pl?Pl.isConcatSpreadable:void 0;function dte(t){return ms(t)||I_(t)||!!(UL&&t&&t[UL])}function DA(t,n,a,s,c){var f=-1,d=t.length;for(a||(a=dte),c||(c=[]);++f<d;){var p=t[f];n>0&&a(p)?n>1?DA(p,n-1,a,s,c):LA(c,p):s||(c[c.length]=p)}return c}function pte(t){var n=t==null?0:t.length;return n?DA(t,1):[]}function mte(t){return S8(C8(t,void 0,pte),t+"")}var gte=F8(Object.getPrototypeOf,Object);const BA=gte;var _te="[object Object]",vte=Function.prototype,yte=Object.prototype,P8=vte.toString,xte=yte.hasOwnProperty,bte=P8.call(Object);function wte(t){if(!iu(t)||rp(t)!=_te)return!1;var n=BA(t);if(n===null)return!0;var a=xte.call(n,"constructor")&&n.constructor;return typeof a=="function"&&a instanceof a&&P8.call(a)==bte}function O_(){if(!arguments.length)return[];var t=arguments[0];return ms(t)?t:[t]}function Ete(){this.__data__=new lf,this.size=0}function Tte(t){var n=this.__data__,a=n.delete(t);return this.size=n.size,a}function Ste(t){return this.__data__.get(t)}function Cte(t){return this.__data__.has(t)}var Ate=200;function kte(t,n){var a=this.__data__;if(a instanceof lf){var s=a.__data__;if(!P_||s.length<Ate-1)return s.push([t,n]),this.size=++a.size,this;a=this.__data__=new cf(s)}return a.set(t,n),this.size=a.size,this}function lc(t){var n=this.__data__=new lf(t);this.size=n.size}lc.prototype.clear=Ete;lc.prototype.delete=Tte;lc.prototype.get=Ste;lc.prototype.has=Cte;lc.prototype.set=kte;function Ite(t,n){return t&&hv(n,dv(n),t)}function Mte(t,n){return t&&hv(n,pv(n),t)}var O8=typeof al=="object"&&al&&!al.nodeType&&al,$L=O8&&typeof ol=="object"&&ol&&!ol.nodeType&&ol,Fte=$L&&$L.exports===O8,VL=Fte?xc.Buffer:void 0,jL=VL?VL.allocUnsafe:void 0;function R8(t,n){if(n)return t.slice();var a=t.length,s=jL?jL(a):new t.constructor(a);return t.copy(s),s}function Pte(t,n){for(var a=-1,s=t==null?0:t.length,c=0,f=[];++a<s;){var d=t[a];n(d,a,t)&&(f[c++]=d)}return f}function L8(){return[]}var Ote=Object.prototype,Rte=Ote.propertyIsEnumerable,WL=Object.getOwnPropertySymbols,Lte=WL?function(t){return t==null?[]:(t=Object(t),Pte(WL(t),function(n){return Rte.call(t,n)}))}:L8;const zA=Lte;function Dte(t,n){return hv(t,zA(t),n)}var Bte=Object.getOwnPropertySymbols,zte=Bte?function(t){for(var n=[];t;)LA(n,zA(t)),t=BA(t);return n}:L8;const D8=zte;function Nte(t,n){return hv(t,D8(t),n)}function B8(t,n,a){var s=n(t);return ms(t)?s:LA(s,a(t))}function ZS(t){return B8(t,dv,zA)}function Ute(t){return B8(t,pv,D8)}var $te=ip(xc,"DataView");const KS=$te;var Vte=ip(xc,"Promise");const YS=Vte;var jte=ip(xc,"Set");const JS=jte;var HL="[object Map]",Wte="[object Object]",GL="[object Promise]",qL="[object Set]",XL="[object WeakMap]",ZL="[object DataView]",Hte=np(KS),Gte=np(P_),qte=np(YS),Xte=np(JS),Zte=np(XS),Sd=rp;(KS&&Sd(new KS(new ArrayBuffer(1)))!=ZL||P_&&Sd(new P_)!=HL||YS&&Sd(YS.resolve())!=GL||JS&&Sd(new JS)!=qL||XS&&Sd(new XS)!=XL)&&(Sd=function(t){var n=rp(t),a=n==Wte?t.constructor:void 0,s=a?np(a):"";if(s)switch(s){case Hte:return ZL;case Gte:return HL;case qte:return GL;case Xte:return qL;case Zte:return XL}return n});const R_=Sd;var Kte=Object.prototype,Yte=Kte.hasOwnProperty;function Jte(t){var n=t.length,a=new t.constructor(n);return n&&typeof t[0]=="string"&&Yte.call(t,"index")&&(a.index=t.index,a.input=t.input),a}var Qte=xc.Uint8Array;const Hx=Qte;function NA(t){var n=new t.constructor(t.byteLength);return new Hx(n).set(new Hx(t)),n}function ere(t,n){var a=n?NA(t.buffer):t.buffer;return new t.constructor(a,t.byteOffset,t.byteLength)}var tre=/\w*$/;function rre(t){var n=new t.constructor(t.source,tre.exec(t));return n.lastIndex=t.lastIndex,n}var KL=Pl?Pl.prototype:void 0,YL=KL?KL.valueOf:void 0;function nre(t){return YL?Object(YL.call(t)):{}}function z8(t,n){var a=n?NA(t.buffer):t.buffer;return new t.constructor(a,t.byteOffset,t.length)}var ire="[object Boolean]",are="[object Date]",ore="[object Map]",sre="[object Number]",lre="[object RegExp]",cre="[object Set]",ure="[object String]",fre="[object Symbol]",hre="[object ArrayBuffer]",dre="[object DataView]",pre="[object Float32Array]",mre="[object Float64Array]",gre="[object Int8Array]",_re="[object Int16Array]",vre="[object Int32Array]",yre="[object Uint8Array]",xre="[object Uint8ClampedArray]",bre="[object Uint16Array]",wre="[object Uint32Array]";function Ere(t,n,a){var s=t.constructor;switch(n){case hre:return NA(t);case ire:case are:return new s(+t);case dre:return ere(t,a);case pre:case mre:case gre:case _re:case vre:case yre:case xre:case bre:case wre:return z8(t,a);case ore:return new s;case sre:case ure:return new s(t);case lre:return rre(t);case cre:return new s;case fre:return nre(t)}}function N8(t){return typeof t.constructor=="function"&&!IA(t)?pQ(BA(t)):{}}var Tre="[object Map]";function Sre(t){return iu(t)&&R_(t)==Tre}var JL=H0&&H0.isMap,Cre=JL?MA(JL):Sre;const Are=Cre;var kre="[object Set]";function Ire(t){return iu(t)&&R_(t)==kre}var QL=H0&&H0.isSet,Mre=QL?MA(QL):Ire;const Fre=Mre;var Pre=1,Ore=2,Rre=4,U8="[object Arguments]",Lre="[object Array]",Dre="[object Boolean]",Bre="[object Date]",zre="[object Error]",$8="[object Function]",Nre="[object GeneratorFunction]",Ure="[object Map]",$re="[object Number]",V8="[object Object]",Vre="[object RegExp]",jre="[object Set]",Wre="[object String]",Hre="[object Symbol]",Gre="[object WeakMap]",qre="[object ArrayBuffer]",Xre="[object DataView]",Zre="[object Float32Array]",Kre="[object Float64Array]",Yre="[object Int8Array]",Jre="[object Int16Array]",Qre="[object Int32Array]",ene="[object Uint8Array]",tne="[object Uint8ClampedArray]",rne="[object Uint16Array]",nne="[object Uint32Array]",xa={};xa[U8]=xa[Lre]=xa[qre]=xa[Xre]=xa[Dre]=xa[Bre]=xa[Zre]=xa[Kre]=xa[Yre]=xa[Jre]=xa[Qre]=xa[Ure]=xa[$re]=xa[V8]=xa[Vre]=xa[jre]=xa[Wre]=xa[Hre]=xa[ene]=xa[tne]=xa[rne]=xa[nne]=!0;xa[zre]=xa[$8]=xa[Gre]=!1;function e_(t,n,a,s,c,f){var d,p=n&Pre,g=n&Ore,y=n&Rre;if(a&&(d=c?a(t,s,c,f):a(t)),d!==void 0)return d;if(!gs(t))return t;var b=ms(t);if(b){if(d=Jte(t),!p)return T8(t,d)}else{var E=R_(t),T=E==$8||E==Nre;if(M_(t))return R8(t,p);if(E==V8||E==U8||T&&!c){if(d=g||T?{}:N8(t),!p)return g?Nte(t,Mte(d,t)):Dte(t,Ite(d,t))}else{if(!xa[E])return c?t:{};d=Ere(t,E,p)}}f||(f=new lc);var S=f.get(t);if(S)return S;f.set(t,d),Fre(t)?t.forEach(function(M){d.add(e_(M,n,a,M,t,f))}):Are(t)&&t.forEach(function(M,F){d.set(F,e_(M,n,a,F,t,f))});var I=y?g?Ute:ZS:g?pv:dv,A=b?void 0:I(t);return SQ(A||t,function(M,F){A&&(F=M,M=t[F]),AA(d,F,e_(M,n,a,F,t,f))}),d}var ine=4;function eD(t){return e_(t,ine)}var ane=1,one=4;function tD(t){return e_(t,ane|one)}var sne="__lodash_hash_undefined__";function lne(t){return this.__data__.set(t,sne),this}function cne(t){return this.__data__.has(t)}function Gx(t){var n=-1,a=t==null?0:t.length;for(this.__data__=new cf;++n<a;)this.add(t[n])}Gx.prototype.add=Gx.prototype.push=lne;Gx.prototype.has=cne;function une(t,n){for(var a=-1,s=t==null?0:t.length;++a<s;)if(n(t[a],a,t))return!0;return!1}function fne(t,n){return t.has(n)}var hne=1,dne=2;function j8(t,n,a,s,c,f){var d=a&hne,p=t.length,g=n.length;if(p!=g&&!(d&&g>p))return!1;var y=f.get(t),b=f.get(n);if(y&&b)return y==n&&b==t;var E=-1,T=!0,S=a&dne?new Gx:void 0;for(f.set(t,n),f.set(n,t);++E<p;){var I=t[E],A=n[E];if(s)var M=d?s(A,I,E,n,t,f):s(I,A,E,t,n,f);if(M!==void 0){if(M)continue;T=!1;break}if(S){if(!une(n,function(F,L){if(!fne(S,L)&&(I===F||c(I,F,a,s,f)))return S.push(L)})){T=!1;break}}else if(!(I===A||c(I,A,a,s,f))){T=!1;break}}return f.delete(t),f.delete(n),T}function pne(t){var n=-1,a=Array(t.size);return t.forEach(function(s,c){a[++n]=[c,s]}),a}function mne(t){var n=-1,a=Array(t.size);return t.forEach(function(s){a[++n]=s}),a}var gne=1,_ne=2,vne="[object Boolean]",yne="[object Date]",xne="[object Error]",bne="[object Map]",wne="[object Number]",Ene="[object RegExp]",Tne="[object Set]",Sne="[object String]",Cne="[object Symbol]",Ane="[object ArrayBuffer]",kne="[object DataView]",rD=Pl?Pl.prototype:void 0,ZT=rD?rD.valueOf:void 0;function Ine(t,n,a,s,c,f,d){switch(a){case kne:if(t.byteLength!=n.byteLength||t.byteOffset!=n.byteOffset)return!1;t=t.buffer,n=n.buffer;case Ane:return!(t.byteLength!=n.byteLength||!f(new Hx(t),new Hx(n)));case vne:case yne:case wne:return fv(+t,+n);case xne:return t.name==n.name&&t.message==n.message;case Ene:case Sne:return t==n+"";case bne:var p=pne;case Tne:var g=s&gne;if(p||(p=mne),t.size!=n.size&&!g)return!1;var y=d.get(t);if(y)return y==n;s|=_ne,d.set(t,n);var b=j8(p(t),p(n),s,c,f,d);return d.delete(t),b;case Cne:if(ZT)return ZT.call(t)==ZT.call(n)}return!1}var Mne=1,Fne=Object.prototype,Pne=Fne.hasOwnProperty;function One(t,n,a,s,c,f){var d=a&Mne,p=ZS(t),g=p.length,y=ZS(n),b=y.length;if(g!=b&&!d)return!1;for(var E=g;E--;){var T=p[E];if(!(d?T in n:Pne.call(n,T)))return!1}var S=f.get(t),I=f.get(n);if(S&&I)return S==n&&I==t;var A=!0;f.set(t,n),f.set(n,t);for(var M=d;++E<g;){T=p[E];var F=t[T],L=n[T];if(s)var O=d?s(L,F,T,n,t,f):s(F,L,T,t,n,f);if(!(O===void 0?F===L||c(F,L,a,s,f):O)){A=!1;break}M||(M=T=="constructor")}if(A&&!M){var N=t.constructor,Q=n.constructor;N!=Q&&"constructor"in t&&"constructor"in n&&!(typeof N=="function"&&N instanceof N&&typeof Q=="function"&&Q instanceof Q)&&(A=!1)}return f.delete(t),f.delete(n),A}var Rne=1,nD="[object Arguments]",iD="[object Array]",Wy="[object Object]",Lne=Object.prototype,aD=Lne.hasOwnProperty;function Dne(t,n,a,s,c,f){var d=ms(t),p=ms(n),g=d?iD:R_(t),y=p?iD:R_(n);g=g==nD?Wy:g,y=y==nD?Wy:y;var b=g==Wy,E=y==Wy,T=g==y;if(T&&M_(t)){if(!M_(n))return!1;d=!0,b=!1}if(T&&!b)return f||(f=new lc),d||FA(t)?j8(t,n,a,s,c,f):Ine(t,n,g,a,s,c,f);if(!(a&Rne)){var S=b&&aD.call(t,"__wrapped__"),I=E&&aD.call(n,"__wrapped__");if(S||I){var A=S?t.value():t,M=I?n.value():n;return f||(f=new lc),c(A,M,a,s,f)}}return T?(f||(f=new lc),One(t,n,a,s,c,f)):!1}function Bb(t,n,a,s,c){return t===n?!0:t==null||n==null||!iu(t)&&!iu(n)?t!==t&&n!==n:Dne(t,n,a,s,Bb,c)}var Bne=1,zne=2;function Nne(t,n,a,s){var c=a.length,f=c,d=!s;if(t==null)return!f;for(t=Object(t);c--;){var p=a[c];if(d&&p[2]?p[1]!==t[p[0]]:!(p[0]in t))return!1}for(;++c<f;){p=a[c];var g=p[0],y=t[g],b=p[1];if(d&&p[2]){if(y===void 0&&!(g in t))return!1}else{var E=new lc;if(s)var T=s(y,b,g,t,n,E);if(!(T===void 0?Bb(b,y,Bne|zne,s,E):T))return!1}}return!0}function W8(t){return t===t&&!gs(t)}function Une(t){for(var n=dv(t),a=n.length;a--;){var s=n[a],c=t[s];n[a]=[s,c,W8(c)]}return n}function H8(t,n){return function(a){return a==null?!1:a[t]===n&&(n!==void 0||t in Object(a))}}function $ne(t){var n=Une(t);return n.length==1&&n[0][2]?H8(n[0][0],n[0][1]):function(a){return a===t||Nne(a,t,n)}}function Vne(t,n){return t!=null&&n in Object(t)}function jne(t,n,a){n=Db(n,t);for(var s=-1,c=n.length,f=!1;++s<c;){var d=mv(n[s]);if(!(f=t!=null&&a(t,d)))break;t=t[d]}return f||++s!=c?f:(c=t==null?0:t.length,!!c&&kA(c)&&Ob(d,c)&&(ms(t)||I_(t)))}function G8(t,n){return t!=null&&jne(t,n,Vne)}var Wne=1,Hne=2;function Gne(t,n){return PA(t)&&W8(n)?H8(mv(t),n):function(a){var s=Bo(a,t);return s===void 0&&s===n?G8(a,t):Bb(n,s,Wne|Hne)}}function qne(t){return function(n){return n==null?void 0:n[t]}}function Xne(t){return function(n){return RA(n,t)}}function Zne(t){return PA(t)?qne(mv(t)):Xne(t)}function q8(t){return typeof t=="function"?t:t==null?TA:typeof t=="object"?ms(t)?Gne(t[0],t[1]):$ne(t):Zne(t)}function Kne(t){return function(n,a,s){for(var c=-1,f=Object(n),d=s(n),p=d.length;p--;){var g=d[t?p:++c];if(a(f[g],g,f)===!1)break}return n}}var Yne=Kne();const X8=Yne;function Jne(t,n){return t&&X8(t,n,dv)}function Qne(t,n){return function(a,s){if(a==null)return a;if(!pm(a))return t(a,s);for(var c=a.length,f=n?c:-1,d=Object(a);(n?f--:++f<c)&&s(d[f],f,d)!==!1;);return a}}var eie=Qne(Jne);const tie=eie;var rie=function(){return xc.Date.now()};const KT=rie;var nie="Expected a function",iie=Math.max,aie=Math.min;function Gd(t,n,a){var s,c,f,d,p,g,y=0,b=!1,E=!1,T=!0;if(typeof t!="function")throw new TypeError(nie);n=qS(n)||0,gs(a)&&(b=!!a.leading,E="maxWait"in a,f=E?iie(qS(a.maxWait)||0,n):f,T="trailing"in a?!!a.trailing:T);function S(ie){var j=s,V=c;return s=c=void 0,y=ie,d=t.apply(V,j),d}function I(ie){return y=ie,p=setTimeout(F,n),b?S(ie):d}function A(ie){var j=ie-g,V=ie-y,D=n-j;return E?aie(D,f-V):D}function M(ie){var j=ie-g,V=ie-y;return g===void 0||j>=n||j<0||E&&V>=f}function F(){var ie=KT();if(M(ie))return L(ie);p=setTimeout(F,A(ie))}function L(ie){return p=void 0,T&&s?S(ie):(s=c=void 0,d)}function O(){p!==void 0&&clearTimeout(p),y=0,s=g=c=p=void 0}function N(){return p===void 0?d:L(KT())}function Q(){var ie=KT(),j=M(ie);if(s=arguments,c=this,g=ie,j){if(p===void 0)return I(g);if(E)return clearTimeout(p),p=setTimeout(F,n),S(g)}return p===void 0&&(p=setTimeout(F,n)),d}return Q.cancel=O,Q.flush=N,Q}function QS(t,n,a){(a!==void 0&&!fv(t[n],a)||a===void 0&&!(n in t))&&CA(t,n,a)}function oie(t){return iu(t)&&pm(t)}function eC(t,n){if(!(n==="constructor"&&typeof t[n]=="function")&&n!="__proto__")return t[n]}function sie(t){return hv(t,pv(t))}function lie(t,n,a,s,c,f,d){var p=eC(t,a),g=eC(n,a),y=d.get(g);if(y){QS(t,a,y);return}var b=f?f(p,g,a+"",t,n,d):void 0,E=b===void 0;if(E){var T=ms(g),S=!T&&M_(g),I=!T&&!S&&FA(g);b=g,T||S||I?ms(p)?b=p:oie(p)?b=T8(p):S?(E=!1,b=R8(g,!0)):I?(E=!1,b=z8(g,!0)):b=[]:wte(g)||I_(g)?(b=p,I_(p)?b=sie(p):(!gs(p)||SA(p))&&(b=N8(g))):E=!1}E&&(d.set(g,b),c(b,g,s,f,d),d.delete(g)),QS(t,a,b)}function Z8(t,n,a,s,c){t!==n&&X8(n,function(f,d){if(c||(c=new lc),gs(f))lie(t,n,d,a,Z8,s,c);else{var p=s?s(eC(t,d),f,d+"",t,n,c):void 0;p===void 0&&(p=f),QS(t,d,p)}},pv)}var cie=Math.max,uie=Math.min;function fie(t,n,a){var s=t==null?0:t.length;if(!s)return-1;var c=s-1;return a!==void 0&&(c=XJ(a),c=a<0?cie(s+c,0):uie(c,s-1)),CQ(t,q8(n),c,!0)}function hie(t,n){var a=-1,s=pm(t)?Array(t.length):[];return tie(t,function(c,f,d){s[++a]=n(c,f,d)}),s}function die(t,n){var a=ms(t)?w8:hie;return a(t,q8(n))}function pie(t,n){return DA(die(t,n),1)}function qx(t){for(var n=-1,a=t==null?0:t.length,s={};++n<a;){var c=t[n];s[c[0]]=c[1]}return s}function L_(t,n){return Bb(t,n)}function ap(t){return t==null}function K8(t){return t===void 0}var mie=RQ(function(t,n,a){Z8(t,n,a)});const Y8=mie;function J8(t,n,a,s){if(!gs(t))return t;n=Db(n,t);for(var c=-1,f=n.length,d=f-1,p=t;p!=null&&++c<f;){var g=mv(n[c]),y=a;if(g==="__proto__"||g==="constructor"||g==="prototype")return t;if(c!=d){var b=p[g];y=s?s(b,g,p):void 0,y===void 0&&(y=gs(b)?b:Ob(n[c+1])?[]:{})}AA(p,g,y),p=p[g]}return t}function gie(t,n,a){for(var s=-1,c=n.length,f={};++s<c;){var d=n[s],p=RA(t,d);a(p,d)&&J8(f,Db(d,t),p)}return f}function _ie(t,n){return gie(t,n,function(a,s){return G8(t,s)})}var vie=mte(function(t,n){return t==null?{}:_ie(t,n)});const yie=vie;function xie(t,n,a){return t==null?t:J8(t,n,a)}var bie="Expected a function";function oD(t,n,a){var s=!0,c=!0;if(typeof t!="function")throw new TypeError(bie);return gs(a)&&(s="leading"in a?!!a.leading:s,c="trailing"in a?!!a.trailing:c),Gd(t,n,{leading:s,maxWait:n,trailing:c})}const au=t=>t===void 0,Wo=t=>typeof t=="boolean",yi=t=>typeof t=="number",pc=t=>typeof Element>"u"?!1:t instanceof Element,wie=t=>Mn(t)?!Number.isNaN(Number(t)):!1,Eie=(t="")=>t.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d"),mh=t=>cv(t),sD=t=>Object.keys(t),Tie=t=>Object.entries(t),bx=(t,n,a)=>({get value(){return Bo(t,n,a)},set value(s){xie(t,n,s)}});class Sie extends Error{constructor(n){super(n),this.name="ElementPlusError"}}function bc(t,n){throw new Sie(`[${t}] ${n}`)}const Q8=(t="")=>t.split(" ").filter(n=>!!n.trim()),F0=(t,n)=>{if(!t||!n)return!1;if(n.includes(" "))throw new Error("className should not contain space.");return t.classList.contains(n)},D_=(t,n)=>{!t||!n.trim()||t.classList.add(...Q8(n))},Sh=(t,n)=>{!t||!n.trim()||t.classList.remove(...Q8(n))},x0=(t,n)=>{var a;if(!Li||!t||!n)return"";let s=hc(n);s==="float"&&(s="cssFloat");try{const c=t.style[s];if(c)return c;const f=(a=document.defaultView)==null?void 0:a.getComputedStyle(t,"");return f?f[s]:""}catch{return t.style[s]}};function mc(t,n="px"){if(!t)return"";if(yi(t)||wie(t))return`${t}${n}`;if(Mn(t))return t}let Hy;const Cie=t=>{var n;if(!Li)return 0;if(Hy!==void 0)return Hy;const a=document.createElement("div");a.className=`${t}-scrollbar__wrap`,a.style.visibility="hidden",a.style.width="100px",a.style.position="absolute",a.style.top="-9999px",document.body.appendChild(a);const s=a.offsetWidth;a.style.overflow="scroll";const c=document.createElement("div");c.style.width="100%",a.appendChild(c);const f=c.offsetWidth;return(n=a.parentNode)==null||n.removeChild(a),Hy=s-f,Hy};function Aie(t,n){if(!Li)return;if(!n){t.scrollTop=0;return}const a=[];let s=n.offsetParent;for(;s!==null&&t!==s&&t.contains(s);)a.push(s),s=s.offsetParent;const c=n.offsetTop+a.reduce((g,y)=>g+y.offsetTop,0),f=c+n.offsetHeight,d=t.scrollTop,p=d+t.clientHeight;c<d?t.scrollTop=c:f>p&&(t.scrollTop=f-t.clientHeight)}/*! Element Plus Icons Vue v2.3.1 */var kie=Ft({name:"ArrowDown",__name:"arrow-down",setup(t){return(n,a)=>(De(),yt("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[gt("path",{fill:"currentColor",d:"M831.872 340.864 512 652.672 192.128 340.864a30.592 30.592 0 0 0-42.752 0 29.12 29.12 0 0 0 0 41.6L489.664 714.24a32 32 0 0 0 44.672 0l340.288-331.712a29.12 29.12 0 0 0 0-41.728 30.592 30.592 0 0 0-42.752 0z"})]))}}),ez=kie,Iie=Ft({name:"ArrowLeft",__name:"arrow-left",setup(t){return(n,a)=>(De(),yt("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[gt("path",{fill:"currentColor",d:"M609.408 149.376 277.76 489.6a32 32 0 0 0 0 44.672l331.648 340.352a29.12 29.12 0 0 0 41.728 0 30.592 30.592 0 0 0 0-42.752L339.264 511.936l311.872-319.872a30.592 30.592 0 0 0 0-42.688 29.12 29.12 0 0 0-41.728 0z"})]))}}),UA=Iie,Mie=Ft({name:"ArrowRight",__name:"arrow-right",setup(t){return(n,a)=>(De(),yt("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[gt("path",{fill:"currentColor",d:"M340.864 149.312a30.592 30.592 0 0 0 0 42.752L652.736 512 340.864 831.872a30.592 30.592 0 0 0 0 42.752 29.12 29.12 0 0 0 41.728 0L714.24 534.336a32 32 0 0 0 0-44.672L382.592 149.376a29.12 29.12 0 0 0-41.728 0z"})]))}}),mm=Mie,Fie=Ft({name:"ArrowUp",__name:"arrow-up",setup(t){return(n,a)=>(De(),yt("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[gt("path",{fill:"currentColor",d:"m488.832 344.32-339.84 356.672a32 32 0 0 0 0 44.16l.384.384a29.44 29.44 0 0 0 42.688 0l320-335.872 319.872 335.872a29.44 29.44 0 0 0 42.688 0l.384-.384a32 32 0 0 0 0-44.16L535.168 344.32a32 32 0 0 0-46.336 0"})]))}}),Pie=Fie,Oie=Ft({name:"Check",__name:"check",setup(t){return(n,a)=>(De(),yt("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[gt("path",{fill:"currentColor",d:"M406.656 706.944 195.84 496.256a32 32 0 1 0-45.248 45.248l256 256 512-512a32 32 0 0 0-45.248-45.248L406.592 706.944z"})]))}}),tz=Oie,Rie=Ft({name:"CircleCheck",__name:"circle-check",setup(t){return(n,a)=>(De(),yt("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[gt("path",{fill:"currentColor",d:"M512 896a384 384 0 1 0 0-768 384 384 0 0 0 0 768m0 64a448 448 0 1 1 0-896 448 448 0 0 1 0 896"}),gt("path",{fill:"currentColor",d:"M745.344 361.344a32 32 0 0 1 45.312 45.312l-288 288a32 32 0 0 1-45.312 0l-160-160a32 32 0 1 1 45.312-45.312L480 626.752l265.344-265.408z"})]))}}),$A=Rie,Lie=Ft({name:"CircleCloseFilled",__name:"circle-close-filled",setup(t){return(n,a)=>(De(),yt("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[gt("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896 448 448 0 0 1 0-896m0 393.664L407.936 353.6a38.4 38.4 0 1 0-54.336 54.336L457.664 512 353.6 616.064a38.4 38.4 0 1 0 54.336 54.336L512 566.336 616.064 670.4a38.4 38.4 0 1 0 54.336-54.336L566.336 512 670.4 407.936a38.4 38.4 0 1 0-54.336-54.336z"})]))}}),rz=Lie,Die=Ft({name:"CircleClose",__name:"circle-close",setup(t){return(n,a)=>(De(),yt("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[gt("path",{fill:"currentColor",d:"m466.752 512-90.496-90.496a32 32 0 0 1 45.248-45.248L512 466.752l90.496-90.496a32 32 0 1 1 45.248 45.248L557.248 512l90.496 90.496a32 32 0 1 1-45.248 45.248L512 557.248l-90.496 90.496a32 32 0 0 1-45.248-45.248z"}),gt("path",{fill:"currentColor",d:"M512 896a384 384 0 1 0 0-768 384 384 0 0 0 0 768m0 64a448 448 0 1 1 0-896 448 448 0 0 1 0 896"})]))}}),zb=Die,Bie=Ft({name:"Close",__name:"close",setup(t){return(n,a)=>(De(),yt("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[gt("path",{fill:"currentColor",d:"M764.288 214.592 512 466.88 259.712 214.592a31.936 31.936 0 0 0-45.12 45.12L466.752 512 214.528 764.224a31.936 31.936 0 1 0 45.12 45.184L512 557.184l252.288 252.288a31.936 31.936 0 0 0 45.12-45.12L557.12 512.064l252.288-252.352a31.936 31.936 0 1 0-45.12-45.184z"})]))}}),Qu=Bie,zie=Ft({name:"DArrowLeft",__name:"d-arrow-left",setup(t){return(n,a)=>(De(),yt("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[gt("path",{fill:"currentColor",d:"M529.408 149.376a29.12 29.12 0 0 1 41.728 0 30.592 30.592 0 0 1 0 42.688L259.264 511.936l311.872 319.936a30.592 30.592 0 0 1-.512 43.264 29.12 29.12 0 0 1-41.216-.512L197.76 534.272a32 32 0 0 1 0-44.672l331.648-340.224zm256 0a29.12 29.12 0 0 1 41.728 0 30.592 30.592 0 0 1 0 42.688L515.264 511.936l311.872 319.936a30.592 30.592 0 0 1-.512 43.264 29.12 29.12 0 0 1-41.216-.512L453.76 534.272a32 32 0 0 1 0-44.672l331.648-340.224z"})]))}}),Nie=zie,Uie=Ft({name:"DArrowRight",__name:"d-arrow-right",setup(t){return(n,a)=>(De(),yt("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[gt("path",{fill:"currentColor",d:"M452.864 149.312a29.12 29.12 0 0 1 41.728.064L826.24 489.664a32 32 0 0 1 0 44.672L494.592 874.624a29.12 29.12 0 0 1-41.728 0 30.592 30.592 0 0 1 0-42.752L764.736 512 452.864 192a30.592 30.592 0 0 1 0-42.688m-256 0a29.12 29.12 0 0 1 41.728.064L570.24 489.664a32 32 0 0 1 0 44.672L238.592 874.624a29.12 29.12 0 0 1-41.728 0 30.592 30.592 0 0 1 0-42.752L508.736 512 196.864 192a30.592 30.592 0 0 1 0-42.688z"})]))}}),$ie=Uie,Vie=Ft({name:"Delete",__name:"delete",setup(t){return(n,a)=>(De(),yt("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[gt("path",{fill:"currentColor",d:"M160 256H96a32 32 0 0 1 0-64h256V95.936a32 32 0 0 1 32-32h256a32 32 0 0 1 32 32V192h256a32 32 0 1 1 0 64h-64v672a32 32 0 0 1-32 32H192a32 32 0 0 1-32-32zm448-64v-64H416v64zM224 896h576V256H224zm192-128a32 32 0 0 1-32-32V416a32 32 0 0 1 64 0v320a32 32 0 0 1-32 32m192 0a32 32 0 0 1-32-32V416a32 32 0 0 1 64 0v320a32 32 0 0 1-32 32"})]))}}),jie=Vie,Wie=Ft({name:"Document",__name:"document",setup(t){return(n,a)=>(De(),yt("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[gt("path",{fill:"currentColor",d:"M832 384H576V128H192v768h640zm-26.496-64L640 154.496V320zM160 64h480l256 256v608a32 32 0 0 1-32 32H160a32 32 0 0 1-32-32V96a32 32 0 0 1 32-32m160 448h384v64H320zm0-192h160v64H320zm0 384h384v64H320z"})]))}}),Hie=Wie,Gie=Ft({name:"Download",__name:"download",setup(t){return(n,a)=>(De(),yt("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[gt("path",{fill:"currentColor",d:"M160 832h704a32 32 0 1 1 0 64H160a32 32 0 1 1 0-64m384-253.696 236.288-236.352 45.248 45.248L508.8 704 192 387.2l45.248-45.248L480 584.704V128h64z"})]))}}),qie=Gie,Xie=Ft({name:"FullScreen",__name:"full-screen",setup(t){return(n,a)=>(De(),yt("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[gt("path",{fill:"currentColor",d:"m160 96.064 192 .192a32 32 0 0 1 0 64l-192-.192V352a32 32 0 0 1-64 0V96h64zm0 831.872V928H96V672a32 32 0 1 1 64 0v191.936l192-.192a32 32 0 1 1 0 64zM864 96.064V96h64v256a32 32 0 1 1-64 0V160.064l-192 .192a32 32 0 1 1 0-64l192-.192zm0 831.872-192-.192a32 32 0 0 1 0-64l192 .192V672a32 32 0 1 1 64 0v256h-64z"})]))}}),Zie=Xie,Kie=Ft({name:"Hide",__name:"hide",setup(t){return(n,a)=>(De(),yt("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[gt("path",{fill:"currentColor",d:"M876.8 156.8c0-9.6-3.2-16-9.6-22.4-6.4-6.4-12.8-9.6-22.4-9.6-9.6 0-16 3.2-22.4 9.6L736 220.8c-64-32-137.6-51.2-224-60.8-160 16-288 73.6-377.6 176C44.8 438.4 0 496 0 512s48 73.6 134.4 176c22.4 25.6 44.8 48 73.6 67.2l-86.4 89.6c-6.4 6.4-9.6 12.8-9.6 22.4 0 9.6 3.2 16 9.6 22.4 6.4 6.4 12.8 9.6 22.4 9.6 9.6 0 16-3.2 22.4-9.6l704-710.4c3.2-6.4 6.4-12.8 6.4-22.4Zm-646.4 528c-76.8-70.4-128-128-153.6-172.8 28.8-48 80-105.6 153.6-172.8C304 272 400 230.4 512 224c64 3.2 124.8 19.2 176 44.8l-54.4 54.4C598.4 300.8 560 288 512 288c-64 0-115.2 22.4-160 64s-64 96-64 160c0 48 12.8 89.6 35.2 124.8L256 707.2c-9.6-6.4-19.2-16-25.6-22.4Zm140.8-96c-12.8-22.4-19.2-48-19.2-76.8 0-44.8 16-83.2 48-112 32-28.8 67.2-48 112-48 28.8 0 54.4 6.4 73.6 19.2zM889.599 336c-12.8-16-28.8-28.8-41.6-41.6l-48 48c73.6 67.2 124.8 124.8 150.4 169.6-28.8 48-80 105.6-153.6 172.8-73.6 67.2-172.8 108.8-284.8 115.2-51.2-3.2-99.2-12.8-140.8-28.8l-48 48c57.6 22.4 118.4 38.4 188.8 44.8 160-16 288-73.6 377.6-176C979.199 585.6 1024 528 1024 512s-48.001-73.6-134.401-176Z"}),gt("path",{fill:"currentColor",d:"M511.998 672c-12.8 0-25.6-3.2-38.4-6.4l-51.2 51.2c28.8 12.8 57.6 19.2 89.6 19.2 64 0 115.2-22.4 160-64 41.6-41.6 64-96 64-160 0-32-6.4-64-19.2-89.6l-51.2 51.2c3.2 12.8 6.4 25.6 6.4 38.4 0 44.8-16 83.2-48 112-32 28.8-67.2 48-112 48Z"})]))}}),tC=Kie,Yie=Ft({name:"InfoFilled",__name:"info-filled",setup(t){return(n,a)=>(De(),yt("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[gt("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896.064A448 448 0 0 1 512 64m67.2 275.072c33.28 0 60.288-23.104 60.288-57.344s-27.072-57.344-60.288-57.344c-33.28 0-60.16 23.104-60.16 57.344s26.88 57.344 60.16 57.344M590.912 699.2c0-6.848 2.368-24.64 1.024-34.752l-52.608 60.544c-10.88 11.456-24.512 19.392-30.912 17.28a12.992 12.992 0 0 1-8.256-14.72l87.68-276.992c7.168-35.136-12.544-67.2-54.336-71.296-44.096 0-108.992 44.736-148.48 101.504 0 6.784-1.28 23.68.064 33.792l52.544-60.608c10.88-11.328 23.552-19.328 29.952-17.152a12.8 12.8 0 0 1 7.808 16.128L388.48 728.576c-10.048 32.256 8.96 63.872 55.04 71.04 67.84 0 107.904-43.648 147.456-100.416z"})]))}}),nz=Yie,Jie=Ft({name:"Loading",__name:"loading",setup(t){return(n,a)=>(De(),yt("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[gt("path",{fill:"currentColor",d:"M512 64a32 32 0 0 1 32 32v192a32 32 0 0 1-64 0V96a32 32 0 0 1 32-32m0 640a32 32 0 0 1 32 32v192a32 32 0 1 1-64 0V736a32 32 0 0 1 32-32m448-192a32 32 0 0 1-32 32H736a32 32 0 1 1 0-64h192a32 32 0 0 1 32 32m-640 0a32 32 0 0 1-32 32H96a32 32 0 0 1 0-64h192a32 32 0 0 1 32 32M195.2 195.2a32 32 0 0 1 45.248 0L376.32 331.008a32 32 0 0 1-45.248 45.248L195.2 240.448a32 32 0 0 1 0-45.248zm452.544 452.544a32 32 0 0 1 45.248 0L828.8 783.552a32 32 0 0 1-45.248 45.248L647.744 692.992a32 32 0 0 1 0-45.248zM828.8 195.264a32 32 0 0 1 0 45.184L692.992 376.32a32 32 0 0 1-45.248-45.248l135.808-135.808a32 32 0 0 1 45.248 0m-452.544 452.48a32 32 0 0 1 0 45.248L240.448 828.8a32 32 0 0 1-45.248-45.248l135.808-135.808a32 32 0 0 1 45.248 0z"})]))}}),Nb=Jie,Qie=Ft({name:"Minus",__name:"minus",setup(t){return(n,a)=>(De(),yt("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[gt("path",{fill:"currentColor",d:"M128 544h768a32 32 0 1 0 0-64H128a32 32 0 0 0 0 64"})]))}}),eae=Qie,tae=Ft({name:"MoreFilled",__name:"more-filled",setup(t){return(n,a)=>(De(),yt("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[gt("path",{fill:"currentColor",d:"M176 416a112 112 0 1 1 0 224 112 112 0 0 1 0-224m336 0a112 112 0 1 1 0 224 112 112 0 0 1 0-224m336 0a112 112 0 1 1 0 224 112 112 0 0 1 0-224"})]))}}),lD=tae,rae=Ft({name:"Plus",__name:"plus",setup(t){return(n,a)=>(De(),yt("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[gt("path",{fill:"currentColor",d:"M480 480V128a32 32 0 0 1 64 0v352h352a32 32 0 1 1 0 64H544v352a32 32 0 1 1-64 0V544H128a32 32 0 0 1 0-64z"})]))}}),nae=rae,iae=Ft({name:"Refresh",__name:"refresh",setup(t){return(n,a)=>(De(),yt("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[gt("path",{fill:"currentColor",d:"M771.776 794.88A384 384 0 0 1 128 512h64a320 320 0 0 0 555.712 216.448H654.72a32 32 0 1 1 0-64h149.056a32 32 0 0 1 32 32v148.928a32 32 0 1 1-64 0v-50.56zM276.288 295.616h92.992a32 32 0 0 1 0 64H220.16a32 32 0 0 1-32-32V178.56a32 32 0 0 1 64 0v50.56A384 384 0 0 1 896.128 512h-64a320 320 0 0 0-555.776-216.384z"})]))}}),aae=iae,oae=Ft({name:"Search",__name:"search",setup(t){return(n,a)=>(De(),yt("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[gt("path",{fill:"currentColor",d:"m795.904 750.72 124.992 124.928a32 32 0 0 1-45.248 45.248L750.656 795.904a416 416 0 1 1 45.248-45.248zM480 832a352 352 0 1 0 0-704 352 352 0 0 0 0 704"})]))}}),sae=oae,lae=Ft({name:"SuccessFilled",__name:"success-filled",setup(t){return(n,a)=>(De(),yt("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[gt("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896 448 448 0 0 1 0-896m-55.808 536.384-99.52-99.584a38.4 38.4 0 1 0-54.336 54.336l126.72 126.72a38.272 38.272 0 0 0 54.336 0l262.4-262.464a38.4 38.4 0 1 0-54.272-54.336z"})]))}}),iz=lae,cae=Ft({name:"UserFilled",__name:"user-filled",setup(t){return(n,a)=>(De(),yt("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[gt("path",{fill:"currentColor",d:"M288 320a224 224 0 1 0 448 0 224 224 0 1 0-448 0m544 608H160a32 32 0 0 1-32-32v-96a160 160 0 0 1 160-160h448a160 160 0 0 1 160 160v96a32 32 0 0 1-32 32z"})]))}}),uae=cae,fae=Ft({name:"View",__name:"view",setup(t){return(n,a)=>(De(),yt("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[gt("path",{fill:"currentColor",d:"M512 160c320 0 512 352 512 352S832 864 512 864 0 512 0 512s192-352 512-352m0 64c-225.28 0-384.128 208.064-436.8 288 52.608 79.872 211.456 288 436.8 288 225.28 0 384.128-208.064 436.8-288-52.608-79.872-211.456-288-436.8-288zm0 64a224 224 0 1 1 0 448 224 224 0 0 1 0-448m0 64a160.192 160.192 0 0 0-160 160c0 88.192 71.744 160 160 160s160-71.808 160-160-71.744-160-160-160"})]))}}),hae=fae,dae=Ft({name:"WarningFilled",__name:"warning-filled",setup(t){return(n,a)=>(De(),yt("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[gt("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896 448 448 0 0 1 0-896m0 192a58.432 58.432 0 0 0-58.24 63.744l23.36 256.384a35.072 35.072 0 0 0 69.76 0l23.296-256.384A58.432 58.432 0 0 0 512 256m0 512a51.2 51.2 0 1 0 0-102.4 51.2 51.2 0 0 0 0 102.4"})]))}}),VA=dae,pae=Ft({name:"ZoomIn",__name:"zoom-in",setup(t){return(n,a)=>(De(),yt("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[gt("path",{fill:"currentColor",d:"m795.904 750.72 124.992 124.928a32 32 0 0 1-45.248 45.248L750.656 795.904a416 416 0 1 1 45.248-45.248zM480 832a352 352 0 1 0 0-704 352 352 0 0 0 0 704m-32-384v-96a32 32 0 0 1 64 0v96h96a32 32 0 0 1 0 64h-96v96a32 32 0 0 1-64 0v-96h-96a32 32 0 0 1 0-64z"})]))}}),mae=pae;const az="__epPropKey",br=t=>t,gae=t=>$n(t)&&!!t[az],Ub=(t,n)=>{if(!$n(t)||gae(t))return t;const{values:a,required:s,default:c,type:f,validator:d}=t,g={type:f,required:!!s,validator:a||d?y=>{let b=!1,E=[];if(a&&(E=Array.from(a),Kn(t,"default")&&E.push(c),b||(b=E.includes(y))),d&&(b||(b=d(y))),!b&&E.length>0){const T=[...new Set(E)].map(S=>JSON.stringify(S)).join(", ");KZ(`Invalid prop: validation failed${n?` for prop "${n}"`:""}. Expected one of [${T}], got value ${JSON.stringify(y)}.`)}return b}:void 0,[az]:!0};return Kn(t,"default")&&(g.default=c),g},rn=t=>qx(Object.entries(t).map(([n,a])=>[n,Ub(a,n)])),xo=br([String,Object,Function]),oz={Close:Qu},sz={Close:Qu,SuccessFilled:iz,InfoFilled:nz,WarningFilled:VA,CircleCloseFilled:rz},G0={success:iz,warning:VA,error:rz,info:nz},lz={validating:Nb,success:$A,error:zb},ca=(t,n)=>{if(t.install=a=>{for(const s of[t,...Object.values(n??{})])a.component(s.name,s)},n)for(const[a,s]of Object.entries(n))t[a]=s;return t},cz=(t,n)=>(t.install=a=>{t._context=a._context,a.config.globalProperties[n]=t},t),_ae=(t,n)=>(t.install=a=>{a.directive(n,t)},t),Ko=t=>(t.install=Si,t),vae=(...t)=>n=>{t.forEach(a=>{Yr(a)?a(n):a.value=n})},ds={tab:"Tab",enter:"Enter",space:"Space",left:"ArrowLeft",up:"ArrowUp",right:"ArrowRight",down:"ArrowDown",esc:"Escape",delete:"Delete",backspace:"Backspace",numpadEnter:"NumpadEnter",pageUp:"PageUp",pageDown:"PageDown",home:"Home",end:"End"},ma="update:modelValue",Ch="change",rC="input",op=["","default","small","large"],yae={large:40,default:32,small:24},xae=t=>yae[t||"default"],jA=t=>["",...op].includes(t);var wx=(t=>(t[t.TEXT=1]="TEXT",t[t.CLASS=2]="CLASS",t[t.STYLE=4]="STYLE",t[t.PROPS=8]="PROPS",t[t.FULL_PROPS=16]="FULL_PROPS",t[t.HYDRATE_EVENTS=32]="HYDRATE_EVENTS",t[t.STABLE_FRAGMENT=64]="STABLE_FRAGMENT",t[t.KEYED_FRAGMENT=128]="KEYED_FRAGMENT",t[t.UNKEYED_FRAGMENT=256]="UNKEYED_FRAGMENT",t[t.NEED_PATCH=512]="NEED_PATCH",t[t.DYNAMIC_SLOTS=1024]="DYNAMIC_SLOTS",t[t.HOISTED=-1]="HOISTED",t[t.BAIL=-2]="BAIL",t))(wx||{});const t_=t=>{const n=Wr(t)?t:[t],a=[];return n.forEach(s=>{var c;Wr(s)?a.push(...t_(s)):ps(s)&&Wr(s.children)?a.push(...t_(s.children)):(a.push(s),ps(s)&&((c=s.component)!=null&&c.subTree)&&a.push(...t_(s.component.subTree)))}),a},uz=t=>/([\uAC00-\uD7AF\u3130-\u318F])+/gi.test(t),bae=t=>Li?window.requestAnimationFrame(t):setTimeout(t,16),fz=()=>Math.floor(Math.random()*1e4),fs=t=>t,wae=["class","style"],Eae=/^on[A-Z]/,Tae=(t={})=>{const{excludeListeners:n=!1,excludeKeys:a}=t,s=Ve(()=>((a==null?void 0:a.value)||[]).concat(wae)),c=Tn();return Ve(c?()=>{var f;return qx(Object.entries((f=c.proxy)==null?void 0:f.$attrs).filter(([d])=>!s.value.includes(d)&&!(n&&Eae.test(d))))}:()=>({}))},q0=({from:t,replacement:n,scope:a,version:s,ref:c,type:f="API"},d)=>{gr(()=>W(d),p=>{},{immediate:!0})},hz=(t,n,a)=>{let s={offsetX:0,offsetY:0};const c=p=>{const g=p.clientX,y=p.clientY,{offsetX:b,offsetY:E}=s,T=t.value.getBoundingClientRect(),S=T.left,I=T.top,A=T.width,M=T.height,F=document.documentElement.clientWidth,L=document.documentElement.clientHeight,O=-S+b,N=-I+E,Q=F-S-A+b,ie=L-I-M+E,j=D=>{const te=Math.min(Math.max(b+D.clientX-g,O),Q),ue=Math.min(Math.max(E+D.clientY-y,N),ie);s={offsetX:te,offsetY:ue},t.value&&(t.value.style.transform=`translate(${mc(te)}, ${mc(ue)})`)},V=()=>{document.removeEventListener("mousemove",j),document.removeEventListener("mouseup",V)};document.addEventListener("mousemove",j),document.addEventListener("mouseup",V)},f=()=>{n.value&&t.value&&n.value.addEventListener("mousedown",c)},d=()=>{n.value&&t.value&&n.value.removeEventListener("mousedown",c)};di(()=>{wh(()=>{a.value?f():d()})}),to(()=>{d()})};var Sae={name:"en",el:{colorpicker:{confirm:"OK",clear:"Clear",defaultLabel:"color picker",description:"current color is {color}. press enter to select a new color."},datepicker:{now:"Now",today:"Today",cancel:"Cancel",clear:"Clear",confirm:"OK",dateTablePrompt:"Use the arrow keys and enter to select the day of the month",monthTablePrompt:"Use the arrow keys and enter to select the month",yearTablePrompt:"Use the arrow keys and enter to select the year",selectedDate:"Selected date",selectDate:"Select date",selectTime:"Select time",startDate:"Start Date",startTime:"Start Time",endDate:"End Date",endTime:"End Time",prevYear:"Previous Year",nextYear:"Next Year",prevMonth:"Previous Month",nextMonth:"Next Month",year:"",month1:"January",month2:"February",month3:"March",month4:"April",month5:"May",month6:"June",month7:"July",month8:"August",month9:"September",month10:"October",month11:"November",month12:"December",week:"week",weeks:{sun:"Sun",mon:"Mon",tue:"Tue",wed:"Wed",thu:"Thu",fri:"Fri",sat:"Sat"},weeksFull:{sun:"Sunday",mon:"Monday",tue:"Tuesday",wed:"Wednesday",thu:"Thursday",fri:"Friday",sat:"Saturday"},months:{jan:"Jan",feb:"Feb",mar:"Mar",apr:"Apr",may:"May",jun:"Jun",jul:"Jul",aug:"Aug",sep:"Sep",oct:"Oct",nov:"Nov",dec:"Dec"}},inputNumber:{decrease:"decrease number",increase:"increase number"},select:{loading:"Loading",noMatch:"No matching data",noData:"No data",placeholder:"Select"},dropdown:{toggleDropdown:"Toggle Dropdown"},cascader:{noMatch:"No matching data",loading:"Loading",placeholder:"Select",noData:"No data"},pagination:{goto:"Go to",pagesize:"/page",total:"Total {total}",pageClassifier:"",page:"Page",prev:"Go to previous page",next:"Go to next page",currentPage:"page {pager}",prevPages:"Previous {pager} pages",nextPages:"Next {pager} pages",deprecationWarning:"Deprecated usages detected, please refer to the el-pagination documentation for more details"},dialog:{close:"Close this dialog"},drawer:{close:"Close this dialog"},messagebox:{title:"Message",confirm:"OK",cancel:"Cancel",error:"Illegal input",close:"Close this dialog"},upload:{deleteTip:"press delete to remove",delete:"Delete",preview:"Preview",continue:"Continue"},slider:{defaultLabel:"slider between {min} and {max}",defaultRangeStartLabel:"pick start value",defaultRangeEndLabel:"pick end value"},table:{emptyText:"No Data",confirmFilter:"Confirm",resetFilter:"Reset",clearFilter:"All",sumText:"Sum"},tree:{emptyText:"No Data"},transfer:{noMatch:"No matching data",noData:"No data",titles:["List 1","List 2"],filterPlaceholder:"Enter keyword",noCheckedFormat:"{total} items",hasCheckedFormat:"{checked}/{total} checked"},image:{error:"FAILED"},pageHeader:{title:"Back"},popconfirm:{confirmButtonText:"Yes",cancelButtonText:"No"}}};const Cae=t=>(n,a)=>Aae(n,a,W(t)),Aae=(t,n,a)=>Bo(a,t,t).replace(/\{(\w+)\}/g,(s,c)=>{var f;return`${(f=n==null?void 0:n[c])!=null?f:`{${c}}`}`}),kae=t=>{const n=Ve(()=>W(t).name),a=ai(t)?t:Ze(t);return{lang:n,locale:a,t:Cae(t)}},dz=Symbol("localeContextKey"),Yo=t=>{const n=t||Gr(dz,Ze());return kae(Ve(()=>n.value||Sae))},r_="el",Iae="is-",wd=(t,n,a,s,c)=>{let f=`${t}-${n}`;return a&&(f+=`-${a}`),s&&(f+=`__${s}`),c&&(f+=`--${c}`),f},pz=Symbol("namespaceContextKey"),WA=t=>{const n=t||(Tn()?Gr(pz,Ze(r_)):Ze(r_));return Ve(()=>W(n)||r_)},Rr=(t,n)=>{const a=WA(n);return{namespace:a,b:(A="")=>wd(a.value,t,A,"",""),e:A=>A?wd(a.value,t,"",A,""):"",m:A=>A?wd(a.value,t,"","",A):"",be:(A,M)=>A&&M?wd(a.value,t,A,M,""):"",em:(A,M)=>A&&M?wd(a.value,t,"",A,M):"",bm:(A,M)=>A&&M?wd(a.value,t,A,"",M):"",bem:(A,M,F)=>A&&M&&F?wd(a.value,t,A,M,F):"",is:(A,...M)=>{const F=M.length>=1?M[0]:!0;return A&&F?`${Iae}${A}`:""},cssVar:A=>{const M={};for(const F in A)A[F]&&(M[`--${a.value}-${F}`]=A[F]);return M},cssVarName:A=>`--${a.value}-${A}`,cssVarBlock:A=>{const M={};for(const F in A)A[F]&&(M[`--${a.value}-${t}-${F}`]=A[F]);return M},cssVarBlockName:A=>`--${a.value}-${t}-${A}`}},mz=(t,n={})=>{ai(t)||bc("[useLockscreen]","You need to pass a ref param to this function");const a=n.ns||Rr("popup"),s=kB(()=>a.bm("parent","hidden"));if(!Li||F0(document.body,s.value))return;let c=0,f=!1,d="0";const p=()=>{setTimeout(()=>{Sh(document==null?void 0:document.body,s.value),f&&document&&(document.body.style.width=d)},200)};gr(t,g=>{if(!g){p();return}f=!F0(document.body,s.value),f&&(d=document.body.style.width),c=Cie(a.namespace.value);const y=document.documentElement.clientHeight<document.body.scrollHeight,b=x0(document.body,"overflowY");c>0&&(y||b==="scroll")&&f&&(document.body.style.width=`calc(100% - ${c}px)`),D_(document.body,s.value)}),tA(()=>p())},Mae=Ub({type:br(Boolean),default:null}),Fae=Ub({type:br(Function)}),gz=t=>{const n=`update:${t}`,a=`onUpdate:${t}`,s=[n],c={[t]:Mae,[a]:Fae};return{useModelToggle:({indicator:d,toggleReason:p,shouldHideWhenRouteChanges:g,shouldProceed:y,onShow:b,onHide:E})=>{const T=Tn(),{emit:S}=T,I=T.props,A=Ve(()=>Yr(I[a])),M=Ve(()=>I[t]===null),F=j=>{d.value!==!0&&(d.value=!0,p&&(p.value=j),Yr(b)&&b(j))},L=j=>{d.value!==!1&&(d.value=!1,p&&(p.value=j),Yr(E)&&E(j))},O=j=>{if(I.disabled===!0||Yr(y)&&!y())return;const V=A.value&&Li;V&&S(n,!0),(M.value||!V)&&F(j)},N=j=>{if(I.disabled===!0||!Li)return;const V=A.value&&Li;V&&S(n,!1),(M.value||!V)&&L(j)},Q=j=>{Wo(j)&&(I.disabled&&j?A.value&&S(n,!1):d.value!==j&&(j?F():L()))},ie=()=>{d.value?N():O()};return gr(()=>I[t],Q),g&&T.appContext.config.globalProperties.$route!==void 0&&gr(()=>({...T.proxy.$route}),()=>{g.value&&d.value&&N()}),di(()=>{Q(I[t])}),{hide:N,show:O,toggle:ie,hasUpdateHandler:A}},useModelToggleProps:c,useModelToggleEmits:s}};gz("modelValue");const _z=t=>{const n=Tn();return Ve(()=>{var a,s;return(s=(a=n==null?void 0:n.proxy)==null?void 0:a.$props)==null?void 0:s[t]})};var zs="top",Ol="bottom",Rl="right",Ns="left",HA="auto",gv=[zs,Ol,Rl,Ns],X0="start",B_="end",Pae="clippingParents",vz="viewport",zg="popper",Oae="reference",cD=gv.reduce(function(t,n){return t.concat([n+"-"+X0,n+"-"+B_])},[]),$b=[].concat(gv,[HA]).reduce(function(t,n){return t.concat([n,n+"-"+X0,n+"-"+B_])},[]),Rae="beforeRead",Lae="read",Dae="afterRead",Bae="beforeMain",zae="main",Nae="afterMain",Uae="beforeWrite",$ae="write",Vae="afterWrite",jae=[Rae,Lae,Dae,Bae,zae,Nae,Uae,$ae,Vae];function ou(t){return t?(t.nodeName||"").toLowerCase():null}function wc(t){if(t==null)return window;if(t.toString()!=="[object Window]"){var n=t.ownerDocument;return n&&n.defaultView||window}return t}function Z0(t){var n=wc(t).Element;return t instanceof n||t instanceof Element}function Il(t){var n=wc(t).HTMLElement;return t instanceof n||t instanceof HTMLElement}function GA(t){if(typeof ShadowRoot>"u")return!1;var n=wc(t).ShadowRoot;return t instanceof n||t instanceof ShadowRoot}function Wae(t){var n=t.state;Object.keys(n.elements).forEach(function(a){var s=n.styles[a]||{},c=n.attributes[a]||{},f=n.elements[a];!Il(f)||!ou(f)||(Object.assign(f.style,s),Object.keys(c).forEach(function(d){var p=c[d];p===!1?f.removeAttribute(d):f.setAttribute(d,p===!0?"":p)}))})}function Hae(t){var n=t.state,a={popper:{position:n.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(n.elements.popper.style,a.popper),n.styles=a,n.elements.arrow&&Object.assign(n.elements.arrow.style,a.arrow),function(){Object.keys(n.elements).forEach(function(s){var c=n.elements[s],f=n.attributes[s]||{},d=Object.keys(n.styles.hasOwnProperty(s)?n.styles[s]:a[s]),p=d.reduce(function(g,y){return g[y]="",g},{});!Il(c)||!ou(c)||(Object.assign(c.style,p),Object.keys(f).forEach(function(g){c.removeAttribute(g)}))})}}var yz={name:"applyStyles",enabled:!0,phase:"write",fn:Wae,effect:Hae,requires:["computeStyles"]};function nu(t){return t.split("-")[0]}var zd=Math.max,Xx=Math.min,K0=Math.round;function Y0(t,n){n===void 0&&(n=!1);var a=t.getBoundingClientRect(),s=1,c=1;if(Il(t)&&n){var f=t.offsetHeight,d=t.offsetWidth;d>0&&(s=K0(a.width)/d||1),f>0&&(c=K0(a.height)/f||1)}return{width:a.width/s,height:a.height/c,top:a.top/c,right:a.right/s,bottom:a.bottom/c,left:a.left/s,x:a.left/s,y:a.top/c}}function qA(t){var n=Y0(t),a=t.offsetWidth,s=t.offsetHeight;return Math.abs(n.width-a)<=1&&(a=n.width),Math.abs(n.height-s)<=1&&(s=n.height),{x:t.offsetLeft,y:t.offsetTop,width:a,height:s}}function xz(t,n){var a=n.getRootNode&&n.getRootNode();if(t.contains(n))return!0;if(a&&GA(a)){var s=n;do{if(s&&t.isSameNode(s))return!0;s=s.parentNode||s.host}while(s)}return!1}function ef(t){return wc(t).getComputedStyle(t)}function Gae(t){return["table","td","th"].indexOf(ou(t))>=0}function Oh(t){return((Z0(t)?t.ownerDocument:t.document)||window.document).documentElement}function Vb(t){return ou(t)==="html"?t:t.assignedSlot||t.parentNode||(GA(t)?t.host:null)||Oh(t)}function uD(t){return!Il(t)||ef(t).position==="fixed"?null:t.offsetParent}function qae(t){var n=navigator.userAgent.toLowerCase().indexOf("firefox")!==-1,a=navigator.userAgent.indexOf("Trident")!==-1;if(a&&Il(t)){var s=ef(t);if(s.position==="fixed")return null}var c=Vb(t);for(GA(c)&&(c=c.host);Il(c)&&["html","body"].indexOf(ou(c))<0;){var f=ef(c);if(f.transform!=="none"||f.perspective!=="none"||f.contain==="paint"||["transform","perspective"].indexOf(f.willChange)!==-1||n&&f.willChange==="filter"||n&&f.filter&&f.filter!=="none")return c;c=c.parentNode}return null}function _v(t){for(var n=wc(t),a=uD(t);a&&Gae(a)&&ef(a).position==="static";)a=uD(a);return a&&(ou(a)==="html"||ou(a)==="body"&&ef(a).position==="static")?n:a||qae(t)||n}function XA(t){return["top","bottom"].indexOf(t)>=0?"x":"y"}function n_(t,n,a){return zd(t,Xx(n,a))}function Xae(t,n,a){var s=n_(t,n,a);return s>a?a:s}function bz(){return{top:0,right:0,bottom:0,left:0}}function wz(t){return Object.assign({},bz(),t)}function Ez(t,n){return n.reduce(function(a,s){return a[s]=t,a},{})}var Zae=function(t,n){return t=typeof t=="function"?t(Object.assign({},n.rects,{placement:n.placement})):t,wz(typeof t!="number"?t:Ez(t,gv))};function Kae(t){var n,a=t.state,s=t.name,c=t.options,f=a.elements.arrow,d=a.modifiersData.popperOffsets,p=nu(a.placement),g=XA(p),y=[Ns,Rl].indexOf(p)>=0,b=y?"height":"width";if(!(!f||!d)){var E=Zae(c.padding,a),T=qA(f),S=g==="y"?zs:Ns,I=g==="y"?Ol:Rl,A=a.rects.reference[b]+a.rects.reference[g]-d[g]-a.rects.popper[b],M=d[g]-a.rects.reference[g],F=_v(f),L=F?g==="y"?F.clientHeight||0:F.clientWidth||0:0,O=A/2-M/2,N=E[S],Q=L-T[b]-E[I],ie=L/2-T[b]/2+O,j=n_(N,ie,Q),V=g;a.modifiersData[s]=(n={},n[V]=j,n.centerOffset=j-ie,n)}}function Yae(t){var n=t.state,a=t.options,s=a.element,c=s===void 0?"[data-popper-arrow]":s;c!=null&&(typeof c=="string"&&(c=n.elements.popper.querySelector(c),!c)||!xz(n.elements.popper,c)||(n.elements.arrow=c))}var Jae={name:"arrow",enabled:!0,phase:"main",fn:Kae,effect:Yae,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function J0(t){return t.split("-")[1]}var Qae={top:"auto",right:"auto",bottom:"auto",left:"auto"};function eoe(t){var n=t.x,a=t.y,s=window,c=s.devicePixelRatio||1;return{x:K0(n*c)/c||0,y:K0(a*c)/c||0}}function fD(t){var n,a=t.popper,s=t.popperRect,c=t.placement,f=t.variation,d=t.offsets,p=t.position,g=t.gpuAcceleration,y=t.adaptive,b=t.roundOffsets,E=t.isFixed,T=d.x,S=T===void 0?0:T,I=d.y,A=I===void 0?0:I,M=typeof b=="function"?b({x:S,y:A}):{x:S,y:A};S=M.x,A=M.y;var F=d.hasOwnProperty("x"),L=d.hasOwnProperty("y"),O=Ns,N=zs,Q=window;if(y){var ie=_v(a),j="clientHeight",V="clientWidth";if(ie===wc(a)&&(ie=Oh(a),ef(ie).position!=="static"&&p==="absolute"&&(j="scrollHeight",V="scrollWidth")),ie=ie,c===zs||(c===Ns||c===Rl)&&f===B_){N=Ol;var D=E&&ie===Q&&Q.visualViewport?Q.visualViewport.height:ie[j];A-=D-s.height,A*=g?1:-1}if(c===Ns||(c===zs||c===Ol)&&f===B_){O=Rl;var te=E&&ie===Q&&Q.visualViewport?Q.visualViewport.width:ie[V];S-=te-s.width,S*=g?1:-1}}var ue=Object.assign({position:p},y&&Qae),J=b===!0?eoe({x:S,y:A}):{x:S,y:A};if(S=J.x,A=J.y,g){var le;return Object.assign({},ue,(le={},le[N]=L?"0":"",le[O]=F?"0":"",le.transform=(Q.devicePixelRatio||1)<=1?"translate("+S+"px, "+A+"px)":"translate3d("+S+"px, "+A+"px, 0)",le))}return Object.assign({},ue,(n={},n[N]=L?A+"px":"",n[O]=F?S+"px":"",n.transform="",n))}function toe(t){var n=t.state,a=t.options,s=a.gpuAcceleration,c=s===void 0?!0:s,f=a.adaptive,d=f===void 0?!0:f,p=a.roundOffsets,g=p===void 0?!0:p,y={placement:nu(n.placement),variation:J0(n.placement),popper:n.elements.popper,popperRect:n.rects.popper,gpuAcceleration:c,isFixed:n.options.strategy==="fixed"};n.modifiersData.popperOffsets!=null&&(n.styles.popper=Object.assign({},n.styles.popper,fD(Object.assign({},y,{offsets:n.modifiersData.popperOffsets,position:n.options.strategy,adaptive:d,roundOffsets:g})))),n.modifiersData.arrow!=null&&(n.styles.arrow=Object.assign({},n.styles.arrow,fD(Object.assign({},y,{offsets:n.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:g})))),n.attributes.popper=Object.assign({},n.attributes.popper,{"data-popper-placement":n.placement})}var Tz={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:toe,data:{}},Gy={passive:!0};function roe(t){var n=t.state,a=t.instance,s=t.options,c=s.scroll,f=c===void 0?!0:c,d=s.resize,p=d===void 0?!0:d,g=wc(n.elements.popper),y=[].concat(n.scrollParents.reference,n.scrollParents.popper);return f&&y.forEach(function(b){b.addEventListener("scroll",a.update,Gy)}),p&&g.addEventListener("resize",a.update,Gy),function(){f&&y.forEach(function(b){b.removeEventListener("scroll",a.update,Gy)}),p&&g.removeEventListener("resize",a.update,Gy)}}var Sz={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:roe,data:{}},noe={left:"right",right:"left",bottom:"top",top:"bottom"};function Ex(t){return t.replace(/left|right|bottom|top/g,function(n){return noe[n]})}var ioe={start:"end",end:"start"};function hD(t){return t.replace(/start|end/g,function(n){return ioe[n]})}function ZA(t){var n=wc(t),a=n.pageXOffset,s=n.pageYOffset;return{scrollLeft:a,scrollTop:s}}function KA(t){return Y0(Oh(t)).left+ZA(t).scrollLeft}function aoe(t){var n=wc(t),a=Oh(t),s=n.visualViewport,c=a.clientWidth,f=a.clientHeight,d=0,p=0;return s&&(c=s.width,f=s.height,/^((?!chrome|android).)*safari/i.test(navigator.userAgent)||(d=s.offsetLeft,p=s.offsetTop)),{width:c,height:f,x:d+KA(t),y:p}}function ooe(t){var n,a=Oh(t),s=ZA(t),c=(n=t.ownerDocument)==null?void 0:n.body,f=zd(a.scrollWidth,a.clientWidth,c?c.scrollWidth:0,c?c.clientWidth:0),d=zd(a.scrollHeight,a.clientHeight,c?c.scrollHeight:0,c?c.clientHeight:0),p=-s.scrollLeft+KA(t),g=-s.scrollTop;return ef(c||a).direction==="rtl"&&(p+=zd(a.clientWidth,c?c.clientWidth:0)-f),{width:f,height:d,x:p,y:g}}function YA(t){var n=ef(t),a=n.overflow,s=n.overflowX,c=n.overflowY;return/auto|scroll|overlay|hidden/.test(a+c+s)}function Cz(t){return["html","body","#document"].indexOf(ou(t))>=0?t.ownerDocument.body:Il(t)&&YA(t)?t:Cz(Vb(t))}function i_(t,n){var a;n===void 0&&(n=[]);var s=Cz(t),c=s===((a=t.ownerDocument)==null?void 0:a.body),f=wc(s),d=c?[f].concat(f.visualViewport||[],YA(s)?s:[]):s,p=n.concat(d);return c?p:p.concat(i_(Vb(d)))}function nC(t){return Object.assign({},t,{left:t.x,top:t.y,right:t.x+t.width,bottom:t.y+t.height})}function soe(t){var n=Y0(t);return n.top=n.top+t.clientTop,n.left=n.left+t.clientLeft,n.bottom=n.top+t.clientHeight,n.right=n.left+t.clientWidth,n.width=t.clientWidth,n.height=t.clientHeight,n.x=n.left,n.y=n.top,n}function dD(t,n){return n===vz?nC(aoe(t)):Z0(n)?soe(n):nC(ooe(Oh(t)))}function loe(t){var n=i_(Vb(t)),a=["absolute","fixed"].indexOf(ef(t).position)>=0,s=a&&Il(t)?_v(t):t;return Z0(s)?n.filter(function(c){return Z0(c)&&xz(c,s)&&ou(c)!=="body"}):[]}function coe(t,n,a){var s=n==="clippingParents"?loe(t):[].concat(n),c=[].concat(s,[a]),f=c[0],d=c.reduce(function(p,g){var y=dD(t,g);return p.top=zd(y.top,p.top),p.right=Xx(y.right,p.right),p.bottom=Xx(y.bottom,p.bottom),p.left=zd(y.left,p.left),p},dD(t,f));return d.width=d.right-d.left,d.height=d.bottom-d.top,d.x=d.left,d.y=d.top,d}function Az(t){var n=t.reference,a=t.element,s=t.placement,c=s?nu(s):null,f=s?J0(s):null,d=n.x+n.width/2-a.width/2,p=n.y+n.height/2-a.height/2,g;switch(c){case zs:g={x:d,y:n.y-a.height};break;case Ol:g={x:d,y:n.y+n.height};break;case Rl:g={x:n.x+n.width,y:p};break;case Ns:g={x:n.x-a.width,y:p};break;default:g={x:n.x,y:n.y}}var y=c?XA(c):null;if(y!=null){var b=y==="y"?"height":"width";switch(f){case X0:g[y]=g[y]-(n[b]/2-a[b]/2);break;case B_:g[y]=g[y]+(n[b]/2-a[b]/2);break}}return g}function z_(t,n){n===void 0&&(n={});var a=n,s=a.placement,c=s===void 0?t.placement:s,f=a.boundary,d=f===void 0?Pae:f,p=a.rootBoundary,g=p===void 0?vz:p,y=a.elementContext,b=y===void 0?zg:y,E=a.altBoundary,T=E===void 0?!1:E,S=a.padding,I=S===void 0?0:S,A=wz(typeof I!="number"?I:Ez(I,gv)),M=b===zg?Oae:zg,F=t.rects.popper,L=t.elements[T?M:b],O=coe(Z0(L)?L:L.contextElement||Oh(t.elements.popper),d,g),N=Y0(t.elements.reference),Q=Az({reference:N,element:F,strategy:"absolute",placement:c}),ie=nC(Object.assign({},F,Q)),j=b===zg?ie:N,V={top:O.top-j.top+A.top,bottom:j.bottom-O.bottom+A.bottom,left:O.left-j.left+A.left,right:j.right-O.right+A.right},D=t.modifiersData.offset;if(b===zg&&D){var te=D[c];Object.keys(V).forEach(function(ue){var J=[Rl,Ol].indexOf(ue)>=0?1:-1,le=[zs,Ol].indexOf(ue)>=0?"y":"x";V[ue]+=te[le]*J})}return V}function uoe(t,n){n===void 0&&(n={});var a=n,s=a.placement,c=a.boundary,f=a.rootBoundary,d=a.padding,p=a.flipVariations,g=a.allowedAutoPlacements,y=g===void 0?$b:g,b=J0(s),E=b?p?cD:cD.filter(function(I){return J0(I)===b}):gv,T=E.filter(function(I){return y.indexOf(I)>=0});T.length===0&&(T=E);var S=T.reduce(function(I,A){return I[A]=z_(t,{placement:A,boundary:c,rootBoundary:f,padding:d})[nu(A)],I},{});return Object.keys(S).sort(function(I,A){return S[I]-S[A]})}function foe(t){if(nu(t)===HA)return[];var n=Ex(t);return[hD(t),n,hD(n)]}function hoe(t){var n=t.state,a=t.options,s=t.name;if(!n.modifiersData[s]._skip){for(var c=a.mainAxis,f=c===void 0?!0:c,d=a.altAxis,p=d===void 0?!0:d,g=a.fallbackPlacements,y=a.padding,b=a.boundary,E=a.rootBoundary,T=a.altBoundary,S=a.flipVariations,I=S===void 0?!0:S,A=a.allowedAutoPlacements,M=n.options.placement,F=nu(M),L=F===M,O=g||(L||!I?[Ex(M)]:foe(M)),N=[M].concat(O).reduce(function(et,Ge){return et.concat(nu(Ge)===HA?uoe(n,{placement:Ge,boundary:b,rootBoundary:E,padding:y,flipVariations:I,allowedAutoPlacements:A}):Ge)},[]),Q=n.rects.reference,ie=n.rects.popper,j=new Map,V=!0,D=N[0],te=0;te<N.length;te++){var ue=N[te],J=nu(ue),le=J0(ue)===X0,re=[zs,Ol].indexOf(J)>=0,Fe=re?"width":"height",Ye=z_(n,{placement:ue,boundary:b,rootBoundary:E,altBoundary:T,padding:y}),Ee=re?le?Rl:Ns:le?Ol:zs;Q[Fe]>ie[Fe]&&(Ee=Ex(Ee));var ut=Ex(Ee),Ne=[];if(f&&Ne.push(Ye[J]<=0),p&&Ne.push(Ye[Ee]<=0,Ye[ut]<=0),Ne.every(function(et){return et})){D=ue,V=!1;break}j.set(ue,Ne)}if(V)for(var He=I?3:1,Oe=function(et){var Ge=N.find(function(ze){var oe=j.get(ze);if(oe)return oe.slice(0,et).every(function(Me){return Me})});if(Ge)return D=Ge,"break"},Pe=He;Pe>0;Pe--){var rt=Oe(Pe);if(rt==="break")break}n.placement!==D&&(n.modifiersData[s]._skip=!0,n.placement=D,n.reset=!0)}}var doe={name:"flip",enabled:!0,phase:"main",fn:hoe,requiresIfExists:["offset"],data:{_skip:!1}};function pD(t,n,a){return a===void 0&&(a={x:0,y:0}),{top:t.top-n.height-a.y,right:t.right-n.width+a.x,bottom:t.bottom-n.height+a.y,left:t.left-n.width-a.x}}function mD(t){return[zs,Rl,Ol,Ns].some(function(n){return t[n]>=0})}function poe(t){var n=t.state,a=t.name,s=n.rects.reference,c=n.rects.popper,f=n.modifiersData.preventOverflow,d=z_(n,{elementContext:"reference"}),p=z_(n,{altBoundary:!0}),g=pD(d,s),y=pD(p,c,f),b=mD(g),E=mD(y);n.modifiersData[a]={referenceClippingOffsets:g,popperEscapeOffsets:y,isReferenceHidden:b,hasPopperEscaped:E},n.attributes.popper=Object.assign({},n.attributes.popper,{"data-popper-reference-hidden":b,"data-popper-escaped":E})}var moe={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:poe};function goe(t,n,a){var s=nu(t),c=[Ns,zs].indexOf(s)>=0?-1:1,f=typeof a=="function"?a(Object.assign({},n,{placement:t})):a,d=f[0],p=f[1];return d=d||0,p=(p||0)*c,[Ns,Rl].indexOf(s)>=0?{x:p,y:d}:{x:d,y:p}}function _oe(t){var n=t.state,a=t.options,s=t.name,c=a.offset,f=c===void 0?[0,0]:c,d=$b.reduce(function(b,E){return b[E]=goe(E,n.rects,f),b},{}),p=d[n.placement],g=p.x,y=p.y;n.modifiersData.popperOffsets!=null&&(n.modifiersData.popperOffsets.x+=g,n.modifiersData.popperOffsets.y+=y),n.modifiersData[s]=d}var voe={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:_oe};function yoe(t){var n=t.state,a=t.name;n.modifiersData[a]=Az({reference:n.rects.reference,element:n.rects.popper,strategy:"absolute",placement:n.placement})}var kz={name:"popperOffsets",enabled:!0,phase:"read",fn:yoe,data:{}};function xoe(t){return t==="x"?"y":"x"}function boe(t){var n=t.state,a=t.options,s=t.name,c=a.mainAxis,f=c===void 0?!0:c,d=a.altAxis,p=d===void 0?!1:d,g=a.boundary,y=a.rootBoundary,b=a.altBoundary,E=a.padding,T=a.tether,S=T===void 0?!0:T,I=a.tetherOffset,A=I===void 0?0:I,M=z_(n,{boundary:g,rootBoundary:y,padding:E,altBoundary:b}),F=nu(n.placement),L=J0(n.placement),O=!L,N=XA(F),Q=xoe(N),ie=n.modifiersData.popperOffsets,j=n.rects.reference,V=n.rects.popper,D=typeof A=="function"?A(Object.assign({},n.rects,{placement:n.placement})):A,te=typeof D=="number"?{mainAxis:D,altAxis:D}:Object.assign({mainAxis:0,altAxis:0},D),ue=n.modifiersData.offset?n.modifiersData.offset[n.placement]:null,J={x:0,y:0};if(ie){if(f){var le,re=N==="y"?zs:Ns,Fe=N==="y"?Ol:Rl,Ye=N==="y"?"height":"width",Ee=ie[N],ut=Ee+M[re],Ne=Ee-M[Fe],He=S?-V[Ye]/2:0,Oe=L===X0?j[Ye]:V[Ye],Pe=L===X0?-V[Ye]:-j[Ye],rt=n.elements.arrow,et=S&&rt?qA(rt):{width:0,height:0},Ge=n.modifiersData["arrow#persistent"]?n.modifiersData["arrow#persistent"].padding:bz(),ze=Ge[re],oe=Ge[Fe],Me=n_(0,j[Ye],et[Ye]),fe=O?j[Ye]/2-He-Me-ze-te.mainAxis:Oe-Me-ze-te.mainAxis,pe=O?-j[Ye]/2+He+Me+oe+te.mainAxis:Pe+Me+oe+te.mainAxis,ot=n.elements.arrow&&_v(n.elements.arrow),xe=ot?N==="y"?ot.clientTop||0:ot.clientLeft||0:0,ae=(le=ue==null?void 0:ue[N])!=null?le:0,X=Ee+fe-ae-xe,Ce=Ee+pe-ae,he=n_(S?Xx(ut,X):ut,Ee,S?zd(Ne,Ce):Ne);ie[N]=he,J[N]=he-Ee}if(p){var G,K=N==="x"?zs:Ns,se=N==="x"?Ol:Rl,Ae=ie[Q],Se=Q==="y"?"height":"width",ye=Ae+M[K],Xe=Ae-M[se],be=[zs,Ns].indexOf(F)!==-1,Be=(G=ue==null?void 0:ue[Q])!=null?G:0,ct=be?ye:Ae-j[Se]-V[Se]-Be+te.altAxis,At=be?Ae+j[Se]+V[Se]-Be-te.altAxis:Xe,$t=S&&be?Xae(ct,Ae,At):n_(S?ct:ye,Ae,S?At:Xe);ie[Q]=$t,J[Q]=$t-Ae}n.modifiersData[s]=J}}var woe={name:"preventOverflow",enabled:!0,phase:"main",fn:boe,requiresIfExists:["offset"]};function Eoe(t){return{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}}function Toe(t){return t===wc(t)||!Il(t)?ZA(t):Eoe(t)}function Soe(t){var n=t.getBoundingClientRect(),a=K0(n.width)/t.offsetWidth||1,s=K0(n.height)/t.offsetHeight||1;return a!==1||s!==1}function Coe(t,n,a){a===void 0&&(a=!1);var s=Il(n),c=Il(n)&&Soe(n),f=Oh(n),d=Y0(t,c),p={scrollLeft:0,scrollTop:0},g={x:0,y:0};return(s||!s&&!a)&&((ou(n)!=="body"||YA(f))&&(p=Toe(n)),Il(n)?(g=Y0(n,!0),g.x+=n.clientLeft,g.y+=n.clientTop):f&&(g.x=KA(f))),{x:d.left+p.scrollLeft-g.x,y:d.top+p.scrollTop-g.y,width:d.width,height:d.height}}function Aoe(t){var n=new Map,a=new Set,s=[];t.forEach(function(f){n.set(f.name,f)});function c(f){a.add(f.name);var d=[].concat(f.requires||[],f.requiresIfExists||[]);d.forEach(function(p){if(!a.has(p)){var g=n.get(p);g&&c(g)}}),s.push(f)}return t.forEach(function(f){a.has(f.name)||c(f)}),s}function koe(t){var n=Aoe(t);return jae.reduce(function(a,s){return a.concat(n.filter(function(c){return c.phase===s}))},[])}function Ioe(t){var n;return function(){return n||(n=new Promise(function(a){Promise.resolve().then(function(){n=void 0,a(t())})})),n}}function Moe(t){var n=t.reduce(function(a,s){var c=a[s.name];return a[s.name]=c?Object.assign({},c,s,{options:Object.assign({},c.options,s.options),data:Object.assign({},c.data,s.data)}):s,a},{});return Object.keys(n).map(function(a){return n[a]})}var gD={placement:"bottom",modifiers:[],strategy:"absolute"};function _D(){for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return!n.some(function(s){return!(s&&typeof s.getBoundingClientRect=="function")})}function JA(t){t===void 0&&(t={});var n=t,a=n.defaultModifiers,s=a===void 0?[]:a,c=n.defaultOptions,f=c===void 0?gD:c;return function(d,p,g){g===void 0&&(g=f);var y={placement:"bottom",orderedModifiers:[],options:Object.assign({},gD,f),modifiersData:{},elements:{reference:d,popper:p},attributes:{},styles:{}},b=[],E=!1,T={state:y,setOptions:function(A){var M=typeof A=="function"?A(y.options):A;I(),y.options=Object.assign({},f,y.options,M),y.scrollParents={reference:Z0(d)?i_(d):d.contextElement?i_(d.contextElement):[],popper:i_(p)};var F=koe(Moe([].concat(s,y.options.modifiers)));return y.orderedModifiers=F.filter(function(L){return L.enabled}),S(),T.update()},forceUpdate:function(){if(!E){var A=y.elements,M=A.reference,F=A.popper;if(_D(M,F)){y.rects={reference:Coe(M,_v(F),y.options.strategy==="fixed"),popper:qA(F)},y.reset=!1,y.placement=y.options.placement,y.orderedModifiers.forEach(function(V){return y.modifiersData[V.name]=Object.assign({},V.data)});for(var L=0;L<y.orderedModifiers.length;L++){if(y.reset===!0){y.reset=!1,L=-1;continue}var O=y.orderedModifiers[L],N=O.fn,Q=O.options,ie=Q===void 0?{}:Q,j=O.name;typeof N=="function"&&(y=N({state:y,options:ie,name:j,instance:T})||y)}}}},update:Ioe(function(){return new Promise(function(A){T.forceUpdate(),A(y)})}),destroy:function(){I(),E=!0}};if(!_D(d,p))return T;T.setOptions(g).then(function(A){!E&&g.onFirstUpdate&&g.onFirstUpdate(A)});function S(){y.orderedModifiers.forEach(function(A){var M=A.name,F=A.options,L=F===void 0?{}:F,O=A.effect;if(typeof O=="function"){var N=O({state:y,name:M,instance:T,options:L}),Q=function(){};b.push(N||Q)}})}function I(){b.forEach(function(A){return A()}),b=[]}return T}}JA();var Foe=[Sz,kz,Tz,yz];JA({defaultModifiers:Foe});var Poe=[Sz,kz,Tz,yz,voe,doe,woe,Jae,moe],Iz=JA({defaultModifiers:Poe});const Ooe=(t,n,a={})=>{const s={name:"updateState",enabled:!0,phase:"write",fn:({state:g})=>{const y=Roe(g);Object.assign(d.value,y)},requires:["computeStyles"]},c=Ve(()=>{const{onFirstUpdate:g,placement:y,strategy:b,modifiers:E}=W(a);return{onFirstUpdate:g,placement:y||"bottom",strategy:b||"absolute",modifiers:[...E||[],s,{name:"applyStyles",enabled:!1}]}}),f=Rs(),d=Ze({styles:{popper:{position:W(c).strategy,left:"0",top:"0"},arrow:{position:"absolute"}},attributes:{}}),p=()=>{f.value&&(f.value.destroy(),f.value=void 0)};return gr(c,g=>{const y=W(f);y&&y.setOptions(g)},{deep:!0}),gr([t,n],([g,y])=>{p(),!(!g||!y)&&(f.value=Iz(g,y,W(c)))}),to(()=>{p()}),{state:Ve(()=>{var g;return{...((g=W(f))==null?void 0:g.state)||{}}}),styles:Ve(()=>W(d).styles),attributes:Ve(()=>W(d).attributes),update:()=>{var g;return(g=W(f))==null?void 0:g.update()},forceUpdate:()=>{var g;return(g=W(f))==null?void 0:g.forceUpdate()},instanceRef:Ve(()=>W(f))}};function Roe(t){const n=Object.keys(t.elements),a=qx(n.map(c=>[c,t.styles[c]||{}])),s=qx(n.map(c=>[c,t.attributes[c]]));return{styles:a,attributes:s}}const QA=t=>{if(!t)return{onClick:Si,onMousedown:Si,onMouseup:Si};let n=!1,a=!1;return{onClick:d=>{n&&a&&t(d),n=a=!1},onMousedown:d=>{n=d.target===d.currentTarget},onMouseup:d=>{a=d.target===d.currentTarget}}};function vD(){let t;const n=(s,c)=>{a(),t=window.setTimeout(s,c)},a=()=>window.clearTimeout(t);return Mb(()=>a()),{registerTimeout:n,cancelTimeout:a}}const yD={prefix:Math.floor(Math.random()*1e4),current:0},Loe=Symbol("elIdInjection"),Mz=()=>Tn()?Gr(Loe,yD):yD,gc=t=>{const n=Mz(),a=WA();return Ve(()=>W(t)||`${a.value}-id-${n.prefix}-${n.current++}`)};let b0=[];const xD=t=>{const n=t;n.key===ds.esc&&b0.forEach(a=>a(n))},Doe=t=>{di(()=>{b0.length===0&&document.addEventListener("keydown",xD),Li&&b0.push(t)}),to(()=>{b0=b0.filter(n=>n!==t),b0.length===0&&Li&&document.removeEventListener("keydown",xD)})};let bD;const Fz=()=>{const t=WA(),n=Mz(),a=Ve(()=>`${t.value}-popper-container-${n.prefix}`),s=Ve(()=>`#${a.value}`);return{id:a,selector:s}},Boe=t=>{const n=document.createElement("div");return n.id=t,document.body.appendChild(n),n},zoe=()=>{const{id:t,selector:n}=Fz();return Cb(()=>{Li&&!bD&&!document.body.querySelector(n.value)&&(bD=Boe(t.value))}),{id:t,selector:n}},Noe=rn({showAfter:{type:Number,default:0},hideAfter:{type:Number,default:200},autoClose:{type:Number,default:0}}),Pz=({showAfter:t,hideAfter:n,autoClose:a,open:s,close:c})=>{const{registerTimeout:f}=vD(),{registerTimeout:d,cancelTimeout:p}=vD();return{onOpen:b=>{f(()=>{s(b);const E=W(a);yi(E)&&E>0&&d(()=>{c(b)},E)},W(t))},onClose:b=>{p(),f(()=>{c(b)},W(n))}}},Oz=Symbol("elForwardRef"),Uoe=t=>{Ji(Oz,{setForwardRef:a=>{t.value=a}})},$oe=t=>({mounted(n){t(n)},updated(n){t(n)},unmounted(){t(null)}}),wD=Ze(0),Rz=2e3,Lz=Symbol("zIndexContextKey"),jb=t=>{const n=t||(Tn()?Gr(Lz,void 0):void 0),a=Ve(()=>{const f=W(n);return yi(f)?f:Rz}),s=Ve(()=>a.value+wD.value);return{initialZIndex:a,currentZIndex:s,nextZIndex:()=>(wD.value++,s.value)}};function Voe(t){const n=Ze();function a(){if(t.value==null)return;const{selectionStart:c,selectionEnd:f,value:d}=t.value;if(c==null||f==null)return;const p=d.slice(0,Math.max(0,c)),g=d.slice(Math.max(0,f));n.value={selectionStart:c,selectionEnd:f,value:d,beforeTxt:p,afterTxt:g}}function s(){if(t.value==null||n.value==null)return;const{value:c}=t.value,{beforeTxt:f,afterTxt:d,selectionStart:p}=n.value;if(f==null||d==null||p==null)return;let g=c.length;if(c.endsWith(d))g=c.length-d.length;else if(c.startsWith(f))g=f.length;else{const y=f[p-1],b=c.indexOf(y,p-1);b!==-1&&(g=b+1)}t.value.setSelectionRange(g,g)}return[a,s]}const joe=(t,n,a)=>t_(t.subTree).filter(f=>{var d;return ps(f)&&((d=f.type)==null?void 0:d.name)===n&&!!f.component}).map(f=>f.component.uid).map(f=>a[f]).filter(f=>!!f),Dz=(t,n)=>{const a={},s=Rs([]);return{children:s,addChild:d=>{a[d.uid]=d,s.value=joe(t,n,a)},removeChild:d=>{delete a[d],s.value=s.value.filter(p=>p.uid!==d)}}},Rh=Ub({type:String,values:op,required:!1}),Bz=Symbol("size"),Woe=()=>{const t=Gr(Bz,{});return Ve(()=>W(t.size)||"")};function Hoe(t,{afterFocus:n,beforeBlur:a,afterBlur:s}={}){const c=Tn(),{emit:f}=c,d=Rs(),p=Ze(!1),g=E=>{p.value||(p.value=!0,f("focus",E),n==null||n())},y=E=>{var T;Yr(a)&&a(E)||E.relatedTarget&&((T=d.value)!=null&&T.contains(E.relatedTarget))||(p.value=!1,f("blur",E),s==null||s())},b=()=>{var E;(E=t.value)==null||E.focus()};return gr(d,E=>{E&&E.setAttribute("tabindex","-1")}),Bs(d,"click",b),{wrapperRef:d,isFocused:p,handleFocus:g,handleBlur:y}}const zz=Symbol(),Zx=Ze();function Wb(t,n=void 0){const a=Tn()?Gr(zz,Zx):Zx;return t?Ve(()=>{var s,c;return(c=(s=a.value)==null?void 0:s[t])!=null?c:n}):a}function Hb(t,n){const a=Wb(),s=Rr(t,Ve(()=>{var p;return((p=a.value)==null?void 0:p.namespace)||r_})),c=Yo(Ve(()=>{var p;return(p=a.value)==null?void 0:p.locale})),f=jb(Ve(()=>{var p;return((p=a.value)==null?void 0:p.zIndex)||Rz})),d=Ve(()=>{var p;return W(n)||((p=a.value)==null?void 0:p.size)||""});return Nz(Ve(()=>W(a)||{})),{ns:s,locale:c,zIndex:f,size:d}}const Nz=(t,n,a=!1)=>{var s;const c=!!Tn(),f=c?Wb():void 0,d=(s=n==null?void 0:n.provide)!=null?s:c?Ji:void 0;if(!d)return;const p=Ve(()=>{const g=W(t);return f!=null&&f.value?Goe(f.value,g):g});return d(zz,p),d(dz,Ve(()=>p.value.locale)),d(pz,Ve(()=>p.value.namespace)),d(Lz,Ve(()=>p.value.zIndex)),d(Bz,{size:Ve(()=>p.value.size||"")}),(a||!Zx.value)&&(Zx.value=p.value),p},Goe=(t,n)=>{var a;const s=[...new Set([...sD(t),...sD(n)])],c={};for(const f of s)c[f]=(a=n[f])!=null?a:t[f];return c},qoe=rn({a11y:{type:Boolean,default:!0},locale:{type:br(Object)},size:Rh,button:{type:br(Object)},experimentalFeatures:{type:br(Object)},keyboardNavigation:{type:Boolean,default:!0},message:{type:br(Object)},zIndex:Number,namespace:{type:String,default:"el"}}),iC={},Xoe=Ft({name:"ElConfigProvider",props:qoe,setup(t,{slots:n}){gr(()=>t.message,s=>{Object.assign(iC,s??{})},{immediate:!0,deep:!0});const a=Nz(t);return()=>vr(n,"default",{config:a==null?void 0:a.value})}}),Uz=ca(Xoe);var Hr=(t,n)=>{const a=t.__vccOpts||t;for(const[s,c]of n)a[s]=c;return a};const Zoe=rn({size:{type:br([Number,String])},color:{type:String}}),Koe=Ft({name:"ElIcon",inheritAttrs:!1}),Yoe=Ft({...Koe,props:Zoe,setup(t){const n=t,a=Rr("icon"),s=Ve(()=>{const{size:c,color:f}=n;return!c&&!f?{}:{fontSize:au(c)?void 0:mc(c),"--color":f}});return(c,f)=>(De(),yt("i",Ds({class:W(a).b(),style:W(s)},c.$attrs),[vr(c.$slots,"default")],16))}});var Joe=Hr(Yoe,[["__file","/home/runner/work/element-plus/element-plus/packages/components/icon/src/icon.vue"]]);const Hn=ca(Joe),gm=Symbol("formContextKey"),qd=Symbol("formItemContextKey"),_c=(t,n={})=>{const a=Ze(void 0),s=n.prop?a:_z("size"),c=n.global?a:Woe(),f=n.form?{size:void 0}:Gr(gm,void 0),d=n.formItem?{size:void 0}:Gr(qd,void 0);return Ve(()=>s.value||W(t)||(d==null?void 0:d.size)||(f==null?void 0:f.size)||c.value||"")},cu=t=>{const n=_z("disabled"),a=Gr(gm,void 0);return Ve(()=>n.value||W(t)||(a==null?void 0:a.disabled)||!1)},Lh=()=>{const t=Gr(gm,void 0),n=Gr(qd,void 0);return{form:t,formItem:n}},vv=(t,{formItemContext:n,disableIdGeneration:a,disableIdManagement:s})=>{a||(a=Ze(!1)),s||(s=Ze(!1));const c=Ze();let f;const d=Ve(()=>{var p;return!!(!t.label&&n&&n.inputIds&&((p=n.inputIds)==null?void 0:p.length)<=1)});return di(()=>{f=gr([Cl(t,"id"),a],([p,g])=>{const y=p??(g?void 0:gc().value);y!==c.value&&(n!=null&&n.removeInputId&&(c.value&&n.removeInputId(c.value),!(s!=null&&s.value)&&!g&&y&&n.addInputId(y)),c.value=y)},{immediate:!0})}),of(()=>{f&&f(),n!=null&&n.removeInputId&&c.value&&n.removeInputId(c.value)}),{isLabeledByFormItem:d,inputId:c}},Qoe=rn({size:{type:String,values:op},disabled:Boolean}),ese=rn({...Qoe,model:Object,rules:{type:br(Object)},labelPosition:{type:String,values:["left","right","top"],default:"right"},requireAsteriskPosition:{type:String,values:["left","right"],default:"left"},labelWidth:{type:[String,Number],default:""},labelSuffix:{type:String,default:""},inline:Boolean,inlineMessage:Boolean,statusIcon:Boolean,showMessage:{type:Boolean,default:!0},validateOnRuleChange:{type:Boolean,default:!0},hideRequiredAsterisk:Boolean,scrollToError:Boolean,scrollIntoViewOptions:{type:[Object,Boolean]}}),tse={validate:(t,n,a)=>(Wr(t)||Mn(t))&&Wo(n)&&Mn(a)};function rse(){const t=Ze([]),n=Ve(()=>{if(!t.value.length)return"0";const f=Math.max(...t.value);return f?`${f}px`:""});function a(f){const d=t.value.indexOf(f);return d===-1&&n.value,d}function s(f,d){if(f&&d){const p=a(d);t.value.splice(p,1,f)}else f&&t.value.push(f)}function c(f){const d=a(f);d>-1&&t.value.splice(d,1)}return{autoLabelWidth:n,registerLabelWidth:s,deregisterLabelWidth:c}}const qy=(t,n)=>{const a=O_(n);return a.length>0?t.filter(s=>s.prop&&a.includes(s.prop)):t},nse="ElForm",ise=Ft({name:nse}),ase=Ft({...ise,props:ese,emits:tse,setup(t,{expose:n,emit:a}){const s=t,c=[],f=_c(),d=Rr("form"),p=Ve(()=>{const{labelPosition:L,inline:O}=s;return[d.b(),d.m(f.value||"default"),{[d.m(`label-${L}`)]:L,[d.m("inline")]:O}]}),g=L=>{c.push(L)},y=L=>{L.prop&&c.splice(c.indexOf(L),1)},b=(L=[])=>{s.model&&qy(c,L).forEach(O=>O.resetField())},E=(L=[])=>{qy(c,L).forEach(O=>O.clearValidate())},T=Ve(()=>!!s.model),S=L=>{if(c.length===0)return[];const O=qy(c,L);return O.length?O:[]},I=async L=>M(void 0,L),A=async(L=[])=>{if(!T.value)return!1;const O=S(L);if(O.length===0)return!0;let N={};for(const Q of O)try{await Q.validate("")}catch(ie){N={...N,...ie}}return Object.keys(N).length===0?!0:Promise.reject(N)},M=async(L=[],O)=>{const N=!Yr(O);try{const Q=await A(L);return Q===!0&&(O==null||O(Q)),Q}catch(Q){if(Q instanceof Error)throw Q;const ie=Q;return s.scrollToError&&F(Object.keys(ie)[0]),O==null||O(!1,ie),N&&Promise.reject(ie)}},F=L=>{var O;const N=qy(c,L)[0];N&&((O=N.$el)==null||O.scrollIntoView(s.scrollIntoViewOptions))};return gr(()=>s.rules,()=>{s.validateOnRuleChange&&I().catch(L=>void 0)},{deep:!0}),Ji(gm,bo({...yc(s),emit:a,resetFields:b,clearValidate:E,validateField:M,addField:g,removeField:y,...rse()})),n({validate:I,validateField:M,resetFields:b,clearValidate:E,scrollToField:F}),(L,O)=>(De(),yt("form",{class:ht(W(p))},[vr(L.$slots,"default")],2))}});var ose=Hr(ase,[["__file","/home/runner/work/element-plus/element-plus/packages/components/form/src/form.vue"]]);function Pd(){return Pd=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var a=arguments[n];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(t[s]=a[s])}return t},Pd.apply(this,arguments)}function sse(t,n){t.prototype=Object.create(n.prototype),t.prototype.constructor=t,N_(t,n)}function aC(t){return aC=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(a){return a.__proto__||Object.getPrototypeOf(a)},aC(t)}function N_(t,n){return N_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,c){return s.__proto__=c,s},N_(t,n)}function lse(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Tx(t,n,a){return lse()?Tx=Reflect.construct.bind():Tx=function(c,f,d){var p=[null];p.push.apply(p,f);var g=Function.bind.apply(c,p),y=new g;return d&&N_(y,d.prototype),y},Tx.apply(null,arguments)}function cse(t){return Function.toString.call(t).indexOf("[native code]")!==-1}function oC(t){var n=typeof Map=="function"?new Map:void 0;return oC=function(s){if(s===null||!cse(s))return s;if(typeof s!="function")throw new TypeError("Super expression must either be null or a function");if(typeof n<"u"){if(n.has(s))return n.get(s);n.set(s,c)}function c(){return Tx(s,arguments,aC(this).constructor)}return c.prototype=Object.create(s.prototype,{constructor:{value:c,enumerable:!1,writable:!0,configurable:!0}}),N_(c,s)},oC(t)}var use=/%[sdj%]/g,fse=function(){};typeof process<"u"&&process.env;function sC(t){if(!t||!t.length)return null;var n={};return t.forEach(function(a){var s=a.field;n[s]=n[s]||[],n[s].push(a)}),n}function il(t){for(var n=arguments.length,a=new Array(n>1?n-1:0),s=1;s<n;s++)a[s-1]=arguments[s];var c=0,f=a.length;if(typeof t=="function")return t.apply(null,a);if(typeof t=="string"){var d=t.replace(use,function(p){if(p==="%%")return"%";if(c>=f)return p;switch(p){case"%s":return String(a[c++]);case"%d":return Number(a[c++]);case"%j":try{return JSON.stringify(a[c++])}catch{return"[Circular]"}break;default:return p}});return d}return t}function hse(t){return t==="string"||t==="url"||t==="hex"||t==="email"||t==="date"||t==="pattern"}function po(t,n){return!!(t==null||n==="array"&&Array.isArray(t)&&!t.length||hse(n)&&typeof t=="string"&&!t)}function dse(t,n,a){var s=[],c=0,f=t.length;function d(p){s.push.apply(s,p||[]),c++,c===f&&a(s)}t.forEach(function(p){n(p,d)})}function ED(t,n,a){var s=0,c=t.length;function f(d){if(d&&d.length){a(d);return}var p=s;s=s+1,p<c?n(t[p],f):a([])}f([])}function pse(t){var n=[];return Object.keys(t).forEach(function(a){n.push.apply(n,t[a]||[])}),n}var TD=function(t){sse(n,t);function n(a,s){var c;return c=t.call(this,"Async Validation Error")||this,c.errors=a,c.fields=s,c}return n}(oC(Error));function mse(t,n,a,s,c){if(n.first){var f=new Promise(function(T,S){var I=function(F){return s(F),F.length?S(new TD(F,sC(F))):T(c)},A=pse(t);ED(A,a,I)});return f.catch(function(T){return T}),f}var d=n.firstFields===!0?Object.keys(t):n.firstFields||[],p=Object.keys(t),g=p.length,y=0,b=[],E=new Promise(function(T,S){var I=function(M){if(b.push.apply(b,M),y++,y===g)return s(b),b.length?S(new TD(b,sC(b))):T(c)};p.length||(s(b),T(c)),p.forEach(function(A){var M=t[A];d.indexOf(A)!==-1?ED(M,a,I):dse(M,a,I)})});return E.catch(function(T){return T}),E}function gse(t){return!!(t&&t.message!==void 0)}function _se(t,n){for(var a=t,s=0;s<n.length;s++){if(a==null)return a;a=a[n[s]]}return a}function SD(t,n){return function(a){var s;return t.fullFields?s=_se(n,t.fullFields):s=n[a.field||t.fullField],gse(a)?(a.field=a.field||t.fullField,a.fieldValue=s,a):{message:typeof a=="function"?a():a,fieldValue:s,field:a.field||t.fullField}}}function CD(t,n){if(n){for(var a in n)if(n.hasOwnProperty(a)){var s=n[a];typeof s=="object"&&typeof t[a]=="object"?t[a]=Pd({},t[a],s):t[a]=s}}return t}var $z=function(n,a,s,c,f,d){n.required&&(!s.hasOwnProperty(n.field)||po(a,d||n.type))&&c.push(il(f.messages.required,n.fullField))},vse=function(n,a,s,c,f){(/^\s+$/.test(a)||a==="")&&c.push(il(f.messages.whitespace,n.fullField))},Xy,yse=function(){if(Xy)return Xy;var t="[a-fA-F\\d:]",n=function(N){return N&&N.includeBoundaries?"(?:(?<=\\s|^)(?="+t+")|(?<="+t+")(?=\\s|$))":""},a="(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}",s="[a-fA-F\\d]{1,4}",c=(`
(?:
(?:`+s+":){7}(?:"+s+`|:)|                                    // 1:2:3:4:5:6:7::  1:2:3:4:5:6:7:8
(?:`+s+":){6}(?:"+a+"|:"+s+`|:)|                             // 1:2:3:4:5:6::    1:2:3:4:5:6::8   1:2:3:4:5:6::8  1:2:3:4:5:6::1.2.3.4
(?:`+s+":){5}(?::"+a+"|(?::"+s+`){1,2}|:)|                   // 1:2:3:4:5::      1:2:3:4:5::7:8   1:2:3:4:5::8    1:2:3:4:5::7:1.2.3.4
(?:`+s+":){4}(?:(?::"+s+"){0,1}:"+a+"|(?::"+s+`){1,3}|:)| // 1:2:3:4::        1:2:3:4::6:7:8   1:2:3:4::8      1:2:3:4::6:7:1.2.3.4
(?:`+s+":){3}(?:(?::"+s+"){0,2}:"+a+"|(?::"+s+`){1,4}|:)| // 1:2:3::          1:2:3::5:6:7:8   1:2:3::8        1:2:3::5:6:7:1.2.3.4
(?:`+s+":){2}(?:(?::"+s+"){0,3}:"+a+"|(?::"+s+`){1,5}|:)| // 1:2::            1:2::4:5:6:7:8   1:2::8          1:2::4:5:6:7:1.2.3.4
(?:`+s+":){1}(?:(?::"+s+"){0,4}:"+a+"|(?::"+s+`){1,6}|:)| // 1::              1::3:4:5:6:7:8   1::8            1::3:4:5:6:7:1.2.3.4
(?::(?:(?::`+s+"){0,5}:"+a+"|(?::"+s+`){1,7}|:))             // ::2:3:4:5:6:7:8  ::2:3:4:5:6:7:8  ::8             ::1.2.3.4
)(?:%[0-9a-zA-Z]{1,})?                                             // %eth0            %1
`).replace(/\s*\/\/.*$/gm,"").replace(/\n/g,"").trim(),f=new RegExp("(?:^"+a+"$)|(?:^"+c+"$)"),d=new RegExp("^"+a+"$"),p=new RegExp("^"+c+"$"),g=function(N){return N&&N.exact?f:new RegExp("(?:"+n(N)+a+n(N)+")|(?:"+n(N)+c+n(N)+")","g")};g.v4=function(O){return O&&O.exact?d:new RegExp(""+n(O)+a+n(O),"g")},g.v6=function(O){return O&&O.exact?p:new RegExp(""+n(O)+c+n(O),"g")};var y="(?:(?:[a-z]+:)?//)",b="(?:\\S+(?::\\S*)?@)?",E=g.v4().source,T=g.v6().source,S="(?:(?:[a-z\\u00a1-\\uffff0-9][-_]*)*[a-z\\u00a1-\\uffff0-9]+)",I="(?:\\.(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)*",A="(?:\\.(?:[a-z\\u00a1-\\uffff]{2,}))",M="(?::\\d{2,5})?",F='(?:[/?#][^\\s"]*)?',L="(?:"+y+"|www\\.)"+b+"(?:localhost|"+E+"|"+T+"|"+S+I+A+")"+M+F;return Xy=new RegExp("(?:^"+L+"$)","i"),Xy},AD={email:/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+\.)+[a-zA-Z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]{2,}))$/,hex:/^#?([a-f0-9]{6}|[a-f0-9]{3})$/i},Hg={integer:function(n){return Hg.number(n)&&parseInt(n,10)===n},float:function(n){return Hg.number(n)&&!Hg.integer(n)},array:function(n){return Array.isArray(n)},regexp:function(n){if(n instanceof RegExp)return!0;try{return!!new RegExp(n)}catch{return!1}},date:function(n){return typeof n.getTime=="function"&&typeof n.getMonth=="function"&&typeof n.getYear=="function"&&!isNaN(n.getTime())},number:function(n){return isNaN(n)?!1:typeof n=="number"},object:function(n){return typeof n=="object"&&!Hg.array(n)},method:function(n){return typeof n=="function"},email:function(n){return typeof n=="string"&&n.length<=320&&!!n.match(AD.email)},url:function(n){return typeof n=="string"&&n.length<=2048&&!!n.match(yse())},hex:function(n){return typeof n=="string"&&!!n.match(AD.hex)}},xse=function(n,a,s,c,f){if(n.required&&a===void 0){$z(n,a,s,c,f);return}var d=["integer","float","array","regexp","object","method","email","number","date","url","hex"],p=n.type;d.indexOf(p)>-1?Hg[p](a)||c.push(il(f.messages.types[p],n.fullField,n.type)):p&&typeof a!==n.type&&c.push(il(f.messages.types[p],n.fullField,n.type))},bse=function(n,a,s,c,f){var d=typeof n.len=="number",p=typeof n.min=="number",g=typeof n.max=="number",y=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,b=a,E=null,T=typeof a=="number",S=typeof a=="string",I=Array.isArray(a);if(T?E="number":S?E="string":I&&(E="array"),!E)return!1;I&&(b=a.length),S&&(b=a.replace(y,"_").length),d?b!==n.len&&c.push(il(f.messages[E].len,n.fullField,n.len)):p&&!g&&b<n.min?c.push(il(f.messages[E].min,n.fullField,n.min)):g&&!p&&b>n.max?c.push(il(f.messages[E].max,n.fullField,n.max)):p&&g&&(b<n.min||b>n.max)&&c.push(il(f.messages[E].range,n.fullField,n.min,n.max))},g0="enum",wse=function(n,a,s,c,f){n[g0]=Array.isArray(n[g0])?n[g0]:[],n[g0].indexOf(a)===-1&&c.push(il(f.messages[g0],n.fullField,n[g0].join(", ")))},Ese=function(n,a,s,c,f){if(n.pattern){if(n.pattern instanceof RegExp)n.pattern.lastIndex=0,n.pattern.test(a)||c.push(il(f.messages.pattern.mismatch,n.fullField,a,n.pattern));else if(typeof n.pattern=="string"){var d=new RegExp(n.pattern);d.test(a)||c.push(il(f.messages.pattern.mismatch,n.fullField,a,n.pattern))}}},xi={required:$z,whitespace:vse,type:xse,range:bse,enum:wse,pattern:Ese},Tse=function(n,a,s,c,f){var d=[],p=n.required||!n.required&&c.hasOwnProperty(n.field);if(p){if(po(a,"string")&&!n.required)return s();xi.required(n,a,c,d,f,"string"),po(a,"string")||(xi.type(n,a,c,d,f),xi.range(n,a,c,d,f),xi.pattern(n,a,c,d,f),n.whitespace===!0&&xi.whitespace(n,a,c,d,f))}s(d)},Sse=function(n,a,s,c,f){var d=[],p=n.required||!n.required&&c.hasOwnProperty(n.field);if(p){if(po(a)&&!n.required)return s();xi.required(n,a,c,d,f),a!==void 0&&xi.type(n,a,c,d,f)}s(d)},Cse=function(n,a,s,c,f){var d=[],p=n.required||!n.required&&c.hasOwnProperty(n.field);if(p){if(a===""&&(a=void 0),po(a)&&!n.required)return s();xi.required(n,a,c,d,f),a!==void 0&&(xi.type(n,a,c,d,f),xi.range(n,a,c,d,f))}s(d)},Ase=function(n,a,s,c,f){var d=[],p=n.required||!n.required&&c.hasOwnProperty(n.field);if(p){if(po(a)&&!n.required)return s();xi.required(n,a,c,d,f),a!==void 0&&xi.type(n,a,c,d,f)}s(d)},kse=function(n,a,s,c,f){var d=[],p=n.required||!n.required&&c.hasOwnProperty(n.field);if(p){if(po(a)&&!n.required)return s();xi.required(n,a,c,d,f),po(a)||xi.type(n,a,c,d,f)}s(d)},Ise=function(n,a,s,c,f){var d=[],p=n.required||!n.required&&c.hasOwnProperty(n.field);if(p){if(po(a)&&!n.required)return s();xi.required(n,a,c,d,f),a!==void 0&&(xi.type(n,a,c,d,f),xi.range(n,a,c,d,f))}s(d)},Mse=function(n,a,s,c,f){var d=[],p=n.required||!n.required&&c.hasOwnProperty(n.field);if(p){if(po(a)&&!n.required)return s();xi.required(n,a,c,d,f),a!==void 0&&(xi.type(n,a,c,d,f),xi.range(n,a,c,d,f))}s(d)},Fse=function(n,a,s,c,f){var d=[],p=n.required||!n.required&&c.hasOwnProperty(n.field);if(p){if(a==null&&!n.required)return s();xi.required(n,a,c,d,f,"array"),a!=null&&(xi.type(n,a,c,d,f),xi.range(n,a,c,d,f))}s(d)},Pse=function(n,a,s,c,f){var d=[],p=n.required||!n.required&&c.hasOwnProperty(n.field);if(p){if(po(a)&&!n.required)return s();xi.required(n,a,c,d,f),a!==void 0&&xi.type(n,a,c,d,f)}s(d)},Ose="enum",Rse=function(n,a,s,c,f){var d=[],p=n.required||!n.required&&c.hasOwnProperty(n.field);if(p){if(po(a)&&!n.required)return s();xi.required(n,a,c,d,f),a!==void 0&&xi[Ose](n,a,c,d,f)}s(d)},Lse=function(n,a,s,c,f){var d=[],p=n.required||!n.required&&c.hasOwnProperty(n.field);if(p){if(po(a,"string")&&!n.required)return s();xi.required(n,a,c,d,f),po(a,"string")||xi.pattern(n,a,c,d,f)}s(d)},Dse=function(n,a,s,c,f){var d=[],p=n.required||!n.required&&c.hasOwnProperty(n.field);if(p){if(po(a,"date")&&!n.required)return s();if(xi.required(n,a,c,d,f),!po(a,"date")){var g;a instanceof Date?g=a:g=new Date(a),xi.type(n,g,c,d,f),g&&xi.range(n,g.getTime(),c,d,f)}}s(d)},Bse=function(n,a,s,c,f){var d=[],p=Array.isArray(a)?"array":typeof a;xi.required(n,a,c,d,f,p),s(d)},YT=function(n,a,s,c,f){var d=n.type,p=[],g=n.required||!n.required&&c.hasOwnProperty(n.field);if(g){if(po(a,d)&&!n.required)return s();xi.required(n,a,c,p,f,d),po(a,d)||xi.type(n,a,c,p,f)}s(p)},zse=function(n,a,s,c,f){var d=[],p=n.required||!n.required&&c.hasOwnProperty(n.field);if(p){if(po(a)&&!n.required)return s();xi.required(n,a,c,d,f)}s(d)},a_={string:Tse,method:Sse,number:Cse,boolean:Ase,regexp:kse,integer:Ise,float:Mse,array:Fse,object:Pse,enum:Rse,pattern:Lse,date:Dse,url:YT,hex:YT,email:YT,required:Bse,any:zse};function lC(){return{default:"Validation error on field %s",required:"%s is required",enum:"%s must be one of %s",whitespace:"%s cannot be empty",date:{format:"%s date %s is invalid for format %s",parse:"%s date could not be parsed, %s is invalid ",invalid:"%s date %s is invalid"},types:{string:"%s is not a %s",method:"%s is not a %s (function)",array:"%s is not an %s",object:"%s is not an %s",number:"%s is not a %s",date:"%s is not a %s",boolean:"%s is not a %s",integer:"%s is not an %s",float:"%s is not a %s",regexp:"%s is not a valid %s",email:"%s is not a valid %s",url:"%s is not a valid %s",hex:"%s is not a valid %s"},string:{len:"%s must be exactly %s characters",min:"%s must be at least %s characters",max:"%s cannot be longer than %s characters",range:"%s must be between %s and %s characters"},number:{len:"%s must equal %s",min:"%s cannot be less than %s",max:"%s cannot be greater than %s",range:"%s must be between %s and %s"},array:{len:"%s must be exactly %s in length",min:"%s cannot be less than %s in length",max:"%s cannot be greater than %s in length",range:"%s must be between %s and %s in length"},pattern:{mismatch:"%s value %s does not match pattern %s"},clone:function(){var n=JSON.parse(JSON.stringify(this));return n.clone=this.clone,n}}}var cC=lC(),yv=function(){function t(a){this.rules=null,this._messages=cC,this.define(a)}var n=t.prototype;return n.define=function(s){var c=this;if(!s)throw new Error("Cannot configure a schema with no rules");if(typeof s!="object"||Array.isArray(s))throw new Error("Rules must be an object");this.rules={},Object.keys(s).forEach(function(f){var d=s[f];c.rules[f]=Array.isArray(d)?d:[d]})},n.messages=function(s){return s&&(this._messages=CD(lC(),s)),this._messages},n.validate=function(s,c,f){var d=this;c===void 0&&(c={}),f===void 0&&(f=function(){});var p=s,g=c,y=f;if(typeof g=="function"&&(y=g,g={}),!this.rules||Object.keys(this.rules).length===0)return y&&y(null,p),Promise.resolve(p);function b(A){var M=[],F={};function L(N){if(Array.isArray(N)){var Q;M=(Q=M).concat.apply(Q,N)}else M.push(N)}for(var O=0;O<A.length;O++)L(A[O]);M.length?(F=sC(M),y(M,F)):y(null,p)}if(g.messages){var E=this.messages();E===cC&&(E=lC()),CD(E,g.messages),g.messages=E}else g.messages=this.messages();var T={},S=g.keys||Object.keys(this.rules);S.forEach(function(A){var M=d.rules[A],F=p[A];M.forEach(function(L){var O=L;typeof O.transform=="function"&&(p===s&&(p=Pd({},p)),F=p[A]=O.transform(F)),typeof O=="function"?O={validator:O}:O=Pd({},O),O.validator=d.getValidationMethod(O),O.validator&&(O.field=A,O.fullField=O.fullField||A,O.type=d.getType(O),T[A]=T[A]||[],T[A].push({rule:O,value:F,source:p,field:A}))})});var I={};return mse(T,g,function(A,M){var F=A.rule,L=(F.type==="object"||F.type==="array")&&(typeof F.fields=="object"||typeof F.defaultField=="object");L=L&&(F.required||!F.required&&A.value),F.field=A.field;function O(ie,j){return Pd({},j,{fullField:F.fullField+"."+ie,fullFields:F.fullFields?[].concat(F.fullFields,[ie]):[ie]})}function N(ie){ie===void 0&&(ie=[]);var j=Array.isArray(ie)?ie:[ie];!g.suppressWarning&&j.length&&t.warning("async-validator:",j),j.length&&F.message!==void 0&&(j=[].concat(F.message));var V=j.map(SD(F,p));if(g.first&&V.length)return I[F.field]=1,M(V);if(!L)M(V);else{if(F.required&&!A.value)return F.message!==void 0?V=[].concat(F.message).map(SD(F,p)):g.error&&(V=[g.error(F,il(g.messages.required,F.field))]),M(V);var D={};F.defaultField&&Object.keys(A.value).map(function(J){D[J]=F.defaultField}),D=Pd({},D,A.rule.fields);var te={};Object.keys(D).forEach(function(J){var le=D[J],re=Array.isArray(le)?le:[le];te[J]=re.map(O.bind(null,J))});var ue=new t(te);ue.messages(g.messages),A.rule.options&&(A.rule.options.messages=g.messages,A.rule.options.error=g.error),ue.validate(A.value,A.rule.options||g,function(J){var le=[];V&&V.length&&le.push.apply(le,V),J&&J.length&&le.push.apply(le,J),M(le.length?le:null)})}}var Q;if(F.asyncValidator)Q=F.asyncValidator(F,A.value,N,A.source,g);else if(F.validator){try{Q=F.validator(F,A.value,N,A.source,g)}catch(ie){console.error==null||console.error(ie),g.suppressValidatorError||setTimeout(function(){throw ie},0),N(ie.message)}Q===!0?N():Q===!1?N(typeof F.message=="function"?F.message(F.fullField||F.field):F.message||(F.fullField||F.field)+" fails"):Q instanceof Array?N(Q):Q instanceof Error&&N(Q.message)}Q&&Q.then&&Q.then(function(){return N()},function(ie){return N(ie)})},function(A){b(A)},p)},n.getType=function(s){if(s.type===void 0&&s.pattern instanceof RegExp&&(s.type="pattern"),typeof s.validator!="function"&&s.type&&!a_.hasOwnProperty(s.type))throw new Error(il("Unknown rule type %s",s.type));return s.type||"string"},n.getValidationMethod=function(s){if(typeof s.validator=="function")return s.validator;var c=Object.keys(s),f=c.indexOf("message");return f!==-1&&c.splice(f,1),c.length===1&&c[0]==="required"?a_.required:a_[this.getType(s)]||void 0},t}();yv.register=function(n,a){if(typeof a!="function")throw new Error("Cannot register a validator by type, validator is not a function");a_[n]=a};yv.warning=fse;yv.messages=cC;yv.validators=a_;const Nse=["","error","validating","success"],Use=rn({label:String,labelWidth:{type:[String,Number],default:""},prop:{type:br([String,Array])},required:{type:Boolean,default:void 0},rules:{type:br([Object,Array])},error:String,validateStatus:{type:String,values:Nse},for:String,inlineMessage:{type:[String,Boolean],default:""},showMessage:{type:Boolean,default:!0},size:{type:String,values:op}}),kD="ElLabelWrap";var $se=Ft({name:kD,props:{isAutoWidth:Boolean,updateAll:Boolean},setup(t,{slots:n}){const a=Gr(gm,void 0),s=Gr(qd);s||bc(kD,"usage: <el-form-item><label-wrap /></el-form-item>");const c=Rr("form"),f=Ze(),d=Ze(0),p=()=>{var b;if((b=f.value)!=null&&b.firstElementChild){const E=window.getComputedStyle(f.value.firstElementChild).width;return Math.ceil(Number.parseFloat(E))}else return 0},g=(b="update")=>{Fn(()=>{n.default&&t.isAutoWidth&&(b==="update"?d.value=p():b==="remove"&&(a==null||a.deregisterLabelWidth(d.value)))})},y=()=>g("update");return di(()=>{y()}),to(()=>{g("remove")}),hm(()=>y()),gr(d,(b,E)=>{t.updateAll&&(a==null||a.registerLabelWidth(b,E))}),dc(Ve(()=>{var b,E;return(E=(b=f.value)==null?void 0:b.firstElementChild)!=null?E:null}),y),()=>{var b,E;if(!n)return null;const{isAutoWidth:T}=t;if(T){const S=a==null?void 0:a.autoLabelWidth,I=s==null?void 0:s.hasLabel,A={};if(I&&S&&S!=="auto"){const M=Math.max(0,Number.parseInt(S,10)-d.value),F=a.labelPosition==="left"?"marginRight":"marginLeft";M&&(A[F]=`${M}px`)}return me("div",{ref:f,class:[c.be("item","label-wrap")],style:A},[(b=n.default)==null?void 0:b.call(n)])}else return me(mn,{ref:f},[(E=n.default)==null?void 0:E.call(n)])}}});const Vse=["role","aria-labelledby"],jse=Ft({name:"ElFormItem"}),Wse=Ft({...jse,props:Use,setup(t,{expose:n}){const a=t,s=sf(),c=Gr(gm,void 0),f=Gr(qd,void 0),d=_c(void 0,{formItem:!1}),p=Rr("form-item"),g=gc().value,y=Ze([]),b=Ze(""),E=aJ(b,100),T=Ze(""),S=Ze();let I,A=!1;const M=Ve(()=>{if((c==null?void 0:c.labelPosition)==="top")return{};const oe=mc(a.labelWidth||(c==null?void 0:c.labelWidth)||"");return oe?{width:oe}:{}}),F=Ve(()=>{if((c==null?void 0:c.labelPosition)==="top"||c!=null&&c.inline)return{};if(!a.label&&!a.labelWidth&&D)return{};const oe=mc(a.labelWidth||(c==null?void 0:c.labelWidth)||"");return!a.label&&!s.label?{marginLeft:oe}:{}}),L=Ve(()=>[p.b(),p.m(d.value),p.is("error",b.value==="error"),p.is("validating",b.value==="validating"),p.is("success",b.value==="success"),p.is("required",re.value||a.required),p.is("no-asterisk",c==null?void 0:c.hideRequiredAsterisk),(c==null?void 0:c.requireAsteriskPosition)==="right"?"asterisk-right":"asterisk-left",{[p.m("feedback")]:c==null?void 0:c.statusIcon}]),O=Ve(()=>Wo(a.inlineMessage)?a.inlineMessage:(c==null?void 0:c.inlineMessage)||!1),N=Ve(()=>[p.e("error"),{[p.em("error","inline")]:O.value}]),Q=Ve(()=>a.prop?Mn(a.prop)?a.prop:a.prop.join("."):""),ie=Ve(()=>!!(a.label||s.label)),j=Ve(()=>a.for||(y.value.length===1?y.value[0]:void 0)),V=Ve(()=>!j.value&&ie.value),D=!!f,te=Ve(()=>{const oe=c==null?void 0:c.model;if(!(!oe||!a.prop))return bx(oe,a.prop).value}),ue=Ve(()=>{const{required:oe}=a,Me=[];a.rules&&Me.push(...O_(a.rules));const fe=c==null?void 0:c.rules;if(fe&&a.prop){const pe=bx(fe,a.prop).value;pe&&Me.push(...O_(pe))}if(oe!==void 0){const pe=Me.map((ot,xe)=>[ot,xe]).filter(([ot])=>Object.keys(ot).includes("required"));if(pe.length>0)for(const[ot,xe]of pe)ot.required!==oe&&(Me[xe]={...ot,required:oe});else Me.push({required:oe})}return Me}),J=Ve(()=>ue.value.length>0),le=oe=>ue.value.filter(fe=>!fe.trigger||!oe?!0:Array.isArray(fe.trigger)?fe.trigger.includes(oe):fe.trigger===oe).map(({trigger:fe,...pe})=>pe),re=Ve(()=>ue.value.some(oe=>oe.required)),Fe=Ve(()=>{var oe;return E.value==="error"&&a.showMessage&&((oe=c==null?void 0:c.showMessage)!=null?oe:!0)}),Ye=Ve(()=>`${a.label||""}${(c==null?void 0:c.labelSuffix)||""}`),Ee=oe=>{b.value=oe},ut=oe=>{var Me,fe;const{errors:pe,fields:ot}=oe;(!pe||!ot)&&console.error(oe),Ee("error"),T.value=pe?(fe=(Me=pe==null?void 0:pe[0])==null?void 0:Me.message)!=null?fe:`${a.prop} is required`:"",c==null||c.emit("validate",a.prop,!1,T.value)},Ne=()=>{Ee("success"),c==null||c.emit("validate",a.prop,!0,"")},He=async oe=>{const Me=Q.value;return new yv({[Me]:oe}).validate({[Me]:te.value},{firstFields:!0}).then(()=>(Ne(),!0)).catch(pe=>(ut(pe),Promise.reject(pe)))},Oe=async(oe,Me)=>{if(A||!a.prop)return!1;const fe=Yr(Me);if(!J.value)return Me==null||Me(!1),!1;const pe=le(oe);return pe.length===0?(Me==null||Me(!0),!0):(Ee("validating"),He(pe).then(()=>(Me==null||Me(!0),!0)).catch(ot=>{const{fields:xe}=ot;return Me==null||Me(!1,xe),fe?!1:Promise.reject(xe)}))},Pe=()=>{Ee(""),T.value="",A=!1},rt=async()=>{const oe=c==null?void 0:c.model;if(!oe||!a.prop)return;const Me=bx(oe,a.prop);A=!0,Me.value=eD(I),await Fn(),Pe(),A=!1},et=oe=>{y.value.includes(oe)||y.value.push(oe)},Ge=oe=>{y.value=y.value.filter(Me=>Me!==oe)};gr(()=>a.error,oe=>{T.value=oe||"",Ee(oe?"error":"")},{immediate:!0}),gr(()=>a.validateStatus,oe=>Ee(oe||""));const ze=bo({...yc(a),$el:S,size:d,validateState:b,labelId:g,inputIds:y,isGroup:V,hasLabel:ie,addInputId:et,removeInputId:Ge,resetField:rt,clearValidate:Pe,validate:Oe});return Ji(qd,ze),di(()=>{a.prop&&(c==null||c.addField(ze),I=eD(te.value))}),to(()=>{c==null||c.removeField(ze)}),n({size:d,validateMessage:T,validateState:b,validate:Oe,clearValidate:Pe,resetField:rt}),(oe,Me)=>{var fe;return De(),yt("div",{ref_key:"formItemRef",ref:S,class:ht(W(L)),role:W(V)?"group":void 0,"aria-labelledby":W(V)?W(g):void 0},[me(W($se),{"is-auto-width":W(M).width==="auto","update-all":((fe=W(c))==null?void 0:fe.labelWidth)==="auto"},{default:we(()=>[W(ie)?(De(),Ht(Zi(W(j)?"label":"div"),{key:0,id:W(g),for:W(j),class:ht(W(p).e("label")),style:xn(W(M))},{default:we(()=>[vr(oe.$slots,"label",{label:W(Ye)},()=>[Sr(Lr(W(Ye)),1)])]),_:3},8,["id","for","class","style"])):Wt("v-if",!0)]),_:3},8,["is-auto-width","update-all"]),gt("div",{class:ht(W(p).e("content")),style:xn(W(F))},[vr(oe.$slots,"default"),me(u8,{name:`${W(p).namespace.value}-zoom-in-top`},{default:we(()=>[W(Fe)?vr(oe.$slots,"error",{key:0,error:T.value},()=>[gt("div",{class:ht(W(N))},Lr(T.value),3)]):Wt("v-if",!0)]),_:3},8,["name"])],6)],10,Vse)}}});var Vz=Hr(Wse,[["__file","/home/runner/work/element-plus/element-plus/packages/components/form/src/form-item.vue"]]);const ek=ca(ose,{FormItem:Vz}),tk=Ko(Vz);let ec;const Hse=`
  height:0 !important;
  visibility:hidden !important;
  ${wJ()?"":"overflow:hidden !important;"}
  position:absolute !important;
  z-index:-1000 !important;
  top:0 !important;
  right:0 !important;
`,Gse=["letter-spacing","line-height","padding-top","padding-bottom","font-family","font-weight","font-size","text-rendering","text-transform","width","text-indent","padding-left","padding-right","border-width","box-sizing"];function qse(t){const n=window.getComputedStyle(t),a=n.getPropertyValue("box-sizing"),s=Number.parseFloat(n.getPropertyValue("padding-bottom"))+Number.parseFloat(n.getPropertyValue("padding-top")),c=Number.parseFloat(n.getPropertyValue("border-bottom-width"))+Number.parseFloat(n.getPropertyValue("border-top-width"));return{contextStyle:Gse.map(d=>`${d}:${n.getPropertyValue(d)}`).join(";"),paddingSize:s,borderSize:c,boxSizing:a}}function ID(t,n=1,a){var s;ec||(ec=document.createElement("textarea"),document.body.appendChild(ec));const{paddingSize:c,borderSize:f,boxSizing:d,contextStyle:p}=qse(t);ec.setAttribute("style",`${p};${Hse}`),ec.value=t.value||t.placeholder||"";let g=ec.scrollHeight;const y={};d==="border-box"?g=g+f:d==="content-box"&&(g=g-c),ec.value="";const b=ec.scrollHeight-c;if(yi(n)){let E=b*n;d==="border-box"&&(E=E+c+f),g=Math.max(E,g),y.minHeight=`${E}px`}if(yi(a)){let E=b*a;d==="border-box"&&(E=E+c+f),g=Math.min(E,g)}return y.height=`${g}px`,(s=ec.parentNode)==null||s.removeChild(ec),ec=void 0,y}const Xse=rn({id:{type:String,default:void 0},size:Rh,disabled:Boolean,modelValue:{type:br([String,Number,Object]),default:""},type:{type:String,default:"text"},resize:{type:String,values:["none","both","horizontal","vertical"]},autosize:{type:br([Boolean,Object]),default:!1},autocomplete:{type:String,default:"off"},formatter:{type:Function},parser:{type:Function},placeholder:{type:String},form:{type:String},readonly:{type:Boolean,default:!1},clearable:{type:Boolean,default:!1},showPassword:{type:Boolean,default:!1},showWordLimit:{type:Boolean,default:!1},suffixIcon:{type:xo},prefixIcon:{type:xo},containerRole:{type:String,default:void 0},label:{type:String,default:void 0},tabindex:{type:[String,Number],default:0},validateEvent:{type:Boolean,default:!0},inputStyle:{type:br([Object,Array,String]),default:()=>fs({})},autofocus:{type:Boolean,default:!1}}),Zse={[ma]:t=>Mn(t),input:t=>Mn(t),change:t=>Mn(t),focus:t=>t instanceof FocusEvent,blur:t=>t instanceof FocusEvent,clear:()=>!0,mouseleave:t=>t instanceof MouseEvent,mouseenter:t=>t instanceof MouseEvent,keydown:t=>t instanceof Event,compositionstart:t=>t instanceof CompositionEvent,compositionupdate:t=>t instanceof CompositionEvent,compositionend:t=>t instanceof CompositionEvent},Kse=["role"],Yse=["id","type","disabled","formatter","parser","readonly","autocomplete","tabindex","aria-label","placeholder","form","autofocus"],Jse=["id","tabindex","disabled","readonly","autocomplete","aria-label","placeholder","form","autofocus"],Qse=Ft({name:"ElInput",inheritAttrs:!1}),ele=Ft({...Qse,props:Xse,emits:Zse,setup(t,{expose:n,emit:a}){const s=t,c=wK(),f=sf(),d=Ve(()=>{const Be={};return s.containerRole==="combobox"&&(Be["aria-haspopup"]=c["aria-haspopup"],Be["aria-owns"]=c["aria-owns"],Be["aria-expanded"]=c["aria-expanded"]),Be}),p=Ve(()=>[s.type==="textarea"?M.b():A.b(),A.m(S.value),A.is("disabled",I.value),A.is("exceed",et.value),{[A.b("group")]:f.prepend||f.append,[A.bm("group","append")]:f.append,[A.bm("group","prepend")]:f.prepend,[A.m("prefix")]:f.prefix||s.prefixIcon,[A.m("suffix")]:f.suffix||s.suffixIcon||s.clearable||s.showPassword,[A.bm("suffix","password-clear")]:He.value&&Oe.value},c.class]),g=Ve(()=>[A.e("wrapper"),A.is("focus",te.value)]),y=Tae({excludeKeys:Ve(()=>Object.keys(d.value))}),{form:b,formItem:E}=Lh(),{inputId:T}=vv(s,{formItemContext:E}),S=_c(),I=cu(),A=Rr("input"),M=Rr("textarea"),F=Rs(),L=Rs(),O=Ze(!1),N=Ze(!1),Q=Ze(!1),ie=Ze(),j=Rs(s.inputStyle),V=Ve(()=>F.value||L.value),{wrapperRef:D,isFocused:te,handleFocus:ue,handleBlur:J}=Hoe(V,{afterBlur(){var Be;s.validateEvent&&((Be=E==null?void 0:E.validate)==null||Be.call(E,"blur").catch(ct=>void 0))}}),le=Ve(()=>{var Be;return(Be=b==null?void 0:b.statusIcon)!=null?Be:!1}),re=Ve(()=>(E==null?void 0:E.validateState)||""),Fe=Ve(()=>re.value&&lz[re.value]),Ye=Ve(()=>Q.value?hae:tC),Ee=Ve(()=>[c.style,s.inputStyle]),ut=Ve(()=>[s.inputStyle,j.value,{resize:s.resize}]),Ne=Ve(()=>ap(s.modelValue)?"":String(s.modelValue)),He=Ve(()=>s.clearable&&!I.value&&!s.readonly&&!!Ne.value&&(te.value||O.value)),Oe=Ve(()=>s.showPassword&&!I.value&&!s.readonly&&!!Ne.value&&(!!Ne.value||te.value)),Pe=Ve(()=>s.showWordLimit&&!!y.value.maxlength&&(s.type==="text"||s.type==="textarea")&&!I.value&&!s.readonly&&!s.showPassword),rt=Ve(()=>Ne.value.length),et=Ve(()=>!!Pe.value&&rt.value>Number(y.value.maxlength)),Ge=Ve(()=>!!f.suffix||!!s.suffixIcon||He.value||s.showPassword||Pe.value||!!re.value&&le.value),[ze,oe]=Voe(F);dc(L,Be=>{if(pe(),!Pe.value||s.resize!=="both")return;const ct=Be[0],{width:At}=ct.contentRect;ie.value={right:`calc(100% - ${At+15+6}px)`}});const Me=()=>{const{type:Be,autosize:ct}=s;if(!(!Li||Be!=="textarea"||!L.value))if(ct){const At=$n(ct)?ct.minRows:void 0,$t=$n(ct)?ct.maxRows:void 0,mr=ID(L.value,At,$t);j.value={overflowY:"hidden",...mr},Fn(()=>{L.value.offsetHeight,j.value=mr})}else j.value={minHeight:ID(L.value).minHeight}},pe=(Be=>{let ct=!1;return()=>{var At;if(ct||!s.autosize)return;((At=L.value)==null?void 0:At.offsetParent)===null||(Be(),ct=!0)}})(Me),ot=()=>{const Be=V.value,ct=s.formatter?s.formatter(Ne.value):Ne.value;!Be||Be.value===ct||(Be.value=ct)},xe=async Be=>{ze();let{value:ct}=Be.target;if(s.formatter&&(ct=s.parser?s.parser(ct):ct),!N.value){if(ct===Ne.value){ot();return}a(ma,ct),a("input",ct),await Fn(),ot(),oe()}},ae=Be=>{a("change",Be.target.value)},X=Be=>{a("compositionstart",Be),N.value=!0},Ce=Be=>{var ct;a("compositionupdate",Be);const At=(ct=Be.target)==null?void 0:ct.value,$t=At[At.length-1]||"";N.value=!uz($t)},he=Be=>{a("compositionend",Be),N.value&&(N.value=!1,xe(Be))},G=()=>{Q.value=!Q.value,K()},K=async()=>{var Be;await Fn(),(Be=V.value)==null||Be.focus()},se=()=>{var Be;return(Be=V.value)==null?void 0:Be.blur()},Ae=Be=>{O.value=!1,a("mouseleave",Be)},Se=Be=>{O.value=!0,a("mouseenter",Be)},ye=Be=>{a("keydown",Be)},Xe=()=>{var Be;(Be=V.value)==null||Be.select()},be=()=>{a(ma,""),a("change",""),a("clear"),a("input","")};return gr(()=>s.modelValue,()=>{var Be;Fn(()=>Me()),s.validateEvent&&((Be=E==null?void 0:E.validate)==null||Be.call(E,"change").catch(ct=>void 0))}),gr(Ne,()=>ot()),gr(()=>s.type,async()=>{await Fn(),ot(),Me()}),di(()=>{!s.formatter&&s.parser,ot(),Fn(Me)}),n({input:F,textarea:L,ref:V,textareaStyle:ut,autosize:Cl(s,"autosize"),focus:K,blur:se,select:Xe,clear:be,resizeTextarea:Me}),(Be,ct)=>ci((De(),yt("div",Ds(W(d),{class:W(p),style:W(Ee),role:Be.containerRole,onMouseenter:Se,onMouseleave:Ae}),[Wt(" input "),Be.type!=="textarea"?(De(),yt(mn,{key:0},[Wt(" prepend slot "),Be.$slots.prepend?(De(),yt("div",{key:0,class:ht(W(A).be("group","prepend"))},[vr(Be.$slots,"prepend")],2)):Wt("v-if",!0),gt("div",{ref_key:"wrapperRef",ref:D,class:ht(W(g))},[Wt(" prefix slot "),Be.$slots.prefix||Be.prefixIcon?(De(),yt("span",{key:0,class:ht(W(A).e("prefix"))},[gt("span",{class:ht(W(A).e("prefix-inner"))},[vr(Be.$slots,"prefix"),Be.prefixIcon?(De(),Ht(W(Hn),{key:0,class:ht(W(A).e("icon"))},{default:we(()=>[(De(),Ht(Zi(Be.prefixIcon)))]),_:1},8,["class"])):Wt("v-if",!0)],2)],2)):Wt("v-if",!0),gt("input",Ds({id:W(T),ref_key:"input",ref:F,class:W(A).e("inner")},W(y),{type:Be.showPassword?Q.value?"text":"password":Be.type,disabled:W(I),formatter:Be.formatter,parser:Be.parser,readonly:Be.readonly,autocomplete:Be.autocomplete,tabindex:Be.tabindex,"aria-label":Be.label,placeholder:Be.placeholder,style:Be.inputStyle,form:s.form,autofocus:s.autofocus,onCompositionstart:X,onCompositionupdate:Ce,onCompositionend:he,onInput:xe,onFocus:ct[0]||(ct[0]=(...At)=>W(ue)&&W(ue)(...At)),onBlur:ct[1]||(ct[1]=(...At)=>W(J)&&W(J)(...At)),onChange:ae,onKeydown:ye}),null,16,Yse),Wt(" suffix slot "),W(Ge)?(De(),yt("span",{key:1,class:ht(W(A).e("suffix"))},[gt("span",{class:ht(W(A).e("suffix-inner"))},[!W(He)||!W(Oe)||!W(Pe)?(De(),yt(mn,{key:0},[vr(Be.$slots,"suffix"),Be.suffixIcon?(De(),Ht(W(Hn),{key:0,class:ht(W(A).e("icon"))},{default:we(()=>[(De(),Ht(Zi(Be.suffixIcon)))]),_:1},8,["class"])):Wt("v-if",!0)],64)):Wt("v-if",!0),W(He)?(De(),Ht(W(Hn),{key:1,class:ht([W(A).e("icon"),W(A).e("clear")]),onMousedown:si(W(Si),["prevent"]),onClick:be},{default:we(()=>[me(W(zb))]),_:1},8,["class","onMousedown"])):Wt("v-if",!0),W(Oe)?(De(),Ht(W(Hn),{key:2,class:ht([W(A).e("icon"),W(A).e("password")]),onClick:G},{default:we(()=>[(De(),Ht(Zi(W(Ye))))]),_:1},8,["class"])):Wt("v-if",!0),W(Pe)?(De(),yt("span",{key:3,class:ht(W(A).e("count"))},[gt("span",{class:ht(W(A).e("count-inner"))},Lr(W(rt))+" / "+Lr(W(y).maxlength),3)],2)):Wt("v-if",!0),W(re)&&W(Fe)&&W(le)?(De(),Ht(W(Hn),{key:4,class:ht([W(A).e("icon"),W(A).e("validateIcon"),W(A).is("loading",W(re)==="validating")])},{default:we(()=>[(De(),Ht(Zi(W(Fe))))]),_:1},8,["class"])):Wt("v-if",!0)],2)],2)):Wt("v-if",!0)],2),Wt(" append slot "),Be.$slots.append?(De(),yt("div",{key:1,class:ht(W(A).be("group","append"))},[vr(Be.$slots,"append")],2)):Wt("v-if",!0)],64)):(De(),yt(mn,{key:1},[Wt(" textarea "),gt("textarea",Ds({id:W(T),ref_key:"textarea",ref:L,class:W(M).e("inner")},W(y),{tabindex:Be.tabindex,disabled:W(I),readonly:Be.readonly,autocomplete:Be.autocomplete,style:W(ut),"aria-label":Be.label,placeholder:Be.placeholder,form:s.form,autofocus:s.autofocus,onCompositionstart:X,onCompositionupdate:Ce,onCompositionend:he,onInput:xe,onFocus:ct[2]||(ct[2]=(...At)=>W(ue)&&W(ue)(...At)),onBlur:ct[3]||(ct[3]=(...At)=>W(J)&&W(J)(...At)),onChange:ae,onKeydown:ye}),null,16,Jse),W(Pe)?(De(),yt("span",{key:0,style:xn(ie.value),class:ht(W(A).e("count"))},Lr(W(rt))+" / "+Lr(W(y).maxlength),7)):Wt("v-if",!0)],64))],16,Kse)),[[la,Be.type!=="hidden"]])}});var tle=Hr(ele,[["__file","/home/runner/work/element-plus/element-plus/packages/components/input/src/input.vue"]]);const uf=ca(tle),T0=4,rle={vertical:{offset:"offsetHeight",scroll:"scrollTop",scrollSize:"scrollHeight",size:"height",key:"vertical",axis:"Y",client:"clientY",direction:"top"},horizontal:{offset:"offsetWidth",scroll:"scrollLeft",scrollSize:"scrollWidth",size:"width",key:"horizontal",axis:"X",client:"clientX",direction:"left"}},nle=({move:t,size:n,bar:a})=>({[a.size]:n,transform:`translate${a.axis}(${t}%)`}),jz=Symbol("scrollbarContextKey"),ile=rn({vertical:Boolean,size:String,move:Number,ratio:{type:Number,required:!0},always:Boolean}),ale="Thumb",ole=Ft({__name:"thumb",props:ile,setup(t){const n=t,a=Gr(jz),s=Rr("scrollbar");a||bc(ale,"can not inject scrollbar context");const c=Ze(),f=Ze(),d=Ze({}),p=Ze(!1);let g=!1,y=!1,b=Li?document.onselectstart:null;const E=Ve(()=>rle[n.vertical?"vertical":"horizontal"]),T=Ve(()=>nle({size:n.size,move:n.move,bar:E.value})),S=Ve(()=>c.value[E.value.offset]**2/a.wrapElement[E.value.scrollSize]/n.ratio/f.value[E.value.offset]),I=ie=>{var j;if(ie.stopPropagation(),ie.ctrlKey||[1,2].includes(ie.button))return;(j=window.getSelection())==null||j.removeAllRanges(),M(ie);const V=ie.currentTarget;V&&(d.value[E.value.axis]=V[E.value.offset]-(ie[E.value.client]-V.getBoundingClientRect()[E.value.direction]))},A=ie=>{if(!f.value||!c.value||!a.wrapElement)return;const j=Math.abs(ie.target.getBoundingClientRect()[E.value.direction]-ie[E.value.client]),V=f.value[E.value.offset]/2,D=(j-V)*100*S.value/c.value[E.value.offset];a.wrapElement[E.value.scroll]=D*a.wrapElement[E.value.scrollSize]/100},M=ie=>{ie.stopImmediatePropagation(),g=!0,document.addEventListener("mousemove",F),document.addEventListener("mouseup",L),b=document.onselectstart,document.onselectstart=()=>!1},F=ie=>{if(!c.value||!f.value||g===!1)return;const j=d.value[E.value.axis];if(!j)return;const V=(c.value.getBoundingClientRect()[E.value.direction]-ie[E.value.client])*-1,D=f.value[E.value.offset]-j,te=(V-D)*100*S.value/c.value[E.value.offset];a.wrapElement[E.value.scroll]=te*a.wrapElement[E.value.scrollSize]/100},L=()=>{g=!1,d.value[E.value.axis]=0,document.removeEventListener("mousemove",F),document.removeEventListener("mouseup",L),Q(),y&&(p.value=!1)},O=()=>{y=!1,p.value=!!n.size},N=()=>{y=!0,p.value=g};to(()=>{Q(),document.removeEventListener("mouseup",L)});const Q=()=>{document.onselectstart!==b&&(document.onselectstart=b)};return Bs(Cl(a,"scrollbarElement"),"mousemove",O),Bs(Cl(a,"scrollbarElement"),"mouseleave",N),(ie,j)=>(De(),Ht(Xo,{name:W(s).b("fade"),persisted:""},{default:we(()=>[ci(gt("div",{ref_key:"instance",ref:c,class:ht([W(s).e("bar"),W(s).is(W(E).key)]),onMousedown:A},[gt("div",{ref_key:"thumb",ref:f,class:ht(W(s).e("thumb")),style:xn(W(T)),onMousedown:I},null,38)],34),[[la,ie.always||p.value]])]),_:1},8,["name"]))}});var MD=Hr(ole,[["__file","/home/runner/work/element-plus/element-plus/packages/components/scrollbar/src/thumb.vue"]]);const sle=rn({always:{type:Boolean,default:!0},width:String,height:String,ratioX:{type:Number,default:1},ratioY:{type:Number,default:1}}),lle=Ft({__name:"bar",props:sle,setup(t,{expose:n}){const a=t,s=Ze(0),c=Ze(0);return n({handleScroll:d=>{if(d){const p=d.offsetHeight-T0,g=d.offsetWidth-T0;c.value=d.scrollTop*100/p*a.ratioY,s.value=d.scrollLeft*100/g*a.ratioX}}}),(d,p)=>(De(),yt(mn,null,[me(MD,{move:s.value,ratio:d.ratioX,size:d.width,always:d.always},null,8,["move","ratio","size","always"]),me(MD,{move:c.value,ratio:d.ratioY,size:d.height,vertical:"",always:d.always},null,8,["move","ratio","size","always"])],64))}});var cle=Hr(lle,[["__file","/home/runner/work/element-plus/element-plus/packages/components/scrollbar/src/bar.vue"]]);const ule=rn({height:{type:[String,Number],default:""},maxHeight:{type:[String,Number],default:""},native:{type:Boolean,default:!1},wrapStyle:{type:br([String,Object,Array]),default:""},wrapClass:{type:[String,Array],default:""},viewClass:{type:[String,Array],default:""},viewStyle:{type:[String,Array,Object],default:""},noresize:Boolean,tag:{type:String,default:"div"},always:Boolean,minSize:{type:Number,default:20},id:String,role:String,ariaLabel:String,ariaOrientation:{type:String,values:["horizontal","vertical"]}}),fle={scroll:({scrollTop:t,scrollLeft:n})=>[t,n].every(yi)},hle="ElScrollbar",dle=Ft({name:hle}),ple=Ft({...dle,props:ule,emits:fle,setup(t,{expose:n,emit:a}){const s=t,c=Rr("scrollbar");let f,d;const p=Ze(),g=Ze(),y=Ze(),b=Ze("0"),E=Ze("0"),T=Ze(),S=Ze(1),I=Ze(1),A=Ve(()=>{const j={};return s.height&&(j.height=mc(s.height)),s.maxHeight&&(j.maxHeight=mc(s.maxHeight)),[s.wrapStyle,j]}),M=Ve(()=>[s.wrapClass,c.e("wrap"),{[c.em("wrap","hidden-default")]:!s.native}]),F=Ve(()=>[c.e("view"),s.viewClass]),L=()=>{var j;g.value&&((j=T.value)==null||j.handleScroll(g.value),a("scroll",{scrollTop:g.value.scrollTop,scrollLeft:g.value.scrollLeft}))};function O(j,V){$n(j)?g.value.scrollTo(j):yi(j)&&yi(V)&&g.value.scrollTo(j,V)}const N=j=>{yi(j)&&(g.value.scrollTop=j)},Q=j=>{yi(j)&&(g.value.scrollLeft=j)},ie=()=>{if(!g.value)return;const j=g.value.offsetHeight-T0,V=g.value.offsetWidth-T0,D=j**2/g.value.scrollHeight,te=V**2/g.value.scrollWidth,ue=Math.max(D,s.minSize),J=Math.max(te,s.minSize);S.value=D/(j-D)/(ue/(j-ue)),I.value=te/(V-te)/(J/(V-J)),E.value=ue+T0<j?`${ue}px`:"",b.value=J+T0<V?`${J}px`:""};return gr(()=>s.noresize,j=>{j?(f==null||f(),d==null||d()):({stop:f}=dc(y,ie),d=Bs("resize",ie))},{immediate:!0}),gr(()=>[s.maxHeight,s.height],()=>{s.native||Fn(()=>{var j;ie(),g.value&&((j=T.value)==null||j.handleScroll(g.value))})}),Ji(jz,bo({scrollbarElement:p,wrapElement:g})),di(()=>{s.native||Fn(()=>{ie()})}),hm(()=>ie()),n({wrapRef:g,update:ie,scrollTo:O,setScrollTop:N,setScrollLeft:Q,handleScroll:L}),(j,V)=>(De(),yt("div",{ref_key:"scrollbarRef",ref:p,class:ht(W(c).b())},[gt("div",{ref_key:"wrapRef",ref:g,class:ht(W(M)),style:xn(W(A)),onScroll:L},[(De(),Ht(Zi(j.tag),{id:j.id,ref_key:"resizeRef",ref:y,class:ht(W(F)),style:xn(j.viewStyle),role:j.role,"aria-label":j.ariaLabel,"aria-orientation":j.ariaOrientation},{default:we(()=>[vr(j.$slots,"default")]),_:3},8,["id","class","style","role","aria-label","aria-orientation"]))],38),j.native?Wt("v-if",!0):(De(),Ht(cle,{key:0,ref_key:"barRef",ref:T,height:E.value,width:b.value,always:j.always,"ratio-x":I.value,"ratio-y":S.value},null,8,["height","width","always","ratio-x","ratio-y"]))],2))}});var mle=Hr(ple,[["__file","/home/runner/work/element-plus/element-plus/packages/components/scrollbar/src/scrollbar.vue"]]);const Dh=ca(mle),rk=Symbol("popper"),Wz=Symbol("popperContent"),gle=["dialog","grid","group","listbox","menu","navigation","tooltip","tree"],Hz=rn({role:{type:String,values:gle,default:"tooltip"}}),_le=Ft({name:"ElPopper",inheritAttrs:!1}),vle=Ft({..._le,props:Hz,setup(t,{expose:n}){const a=t,s=Ze(),c=Ze(),f=Ze(),d=Ze(),p=Ve(()=>a.role),g={triggerRef:s,popperInstanceRef:c,contentRef:f,referenceRef:d,role:p};return n(g),Ji(rk,g),(y,b)=>vr(y.$slots,"default")}});var yle=Hr(vle,[["__file","/home/runner/work/element-plus/element-plus/packages/components/popper/src/popper.vue"]]);const Gz=rn({arrowOffset:{type:Number,default:5}}),xle=Ft({name:"ElPopperArrow",inheritAttrs:!1}),ble=Ft({...xle,props:Gz,setup(t,{expose:n}){const a=t,s=Rr("popper"),{arrowOffset:c,arrowRef:f,arrowStyle:d}=Gr(Wz,void 0);return gr(()=>a.arrowOffset,p=>{c.value=p}),to(()=>{f.value=void 0}),n({arrowRef:f}),(p,g)=>(De(),yt("span",{ref_key:"arrowRef",ref:f,class:ht(W(s).e("arrow")),style:xn(W(d)),"data-popper-arrow":""},null,6))}});var wle=Hr(ble,[["__file","/home/runner/work/element-plus/element-plus/packages/components/popper/src/arrow.vue"]]);const Ele="ElOnlyChild",Tle=Ft({name:Ele,setup(t,{slots:n,attrs:a}){var s;const c=Gr(Oz),f=$oe((s=c==null?void 0:c.setForwardRef)!=null?s:Si);return()=>{var d;const p=(d=n.default)==null?void 0:d.call(n,a);if(!p||p.length>1)return null;const g=qz(p);return g?ci(Ju(g,a),[[f]]):null}}});function qz(t){if(!t)return null;const n=t;for(const a of n){if($n(a))switch(a.type){case Ls:continue;case dm:case"svg":return FD(a);case mn:return qz(a.children);default:return a}return FD(a)}return null}function FD(t){const n=Rr("only-child");return me("span",{class:n.e("content")},[t])}const Xz=rn({virtualRef:{type:br(Object)},virtualTriggering:Boolean,onMouseenter:{type:br(Function)},onMouseleave:{type:br(Function)},onClick:{type:br(Function)},onKeydown:{type:br(Function)},onFocus:{type:br(Function)},onBlur:{type:br(Function)},onContextmenu:{type:br(Function)},id:String,open:Boolean}),Sle=Ft({name:"ElPopperTrigger",inheritAttrs:!1}),Cle=Ft({...Sle,props:Xz,setup(t,{expose:n}){const a=t,{role:s,triggerRef:c}=Gr(rk,void 0);Uoe(c);const f=Ve(()=>p.value?a.id:void 0),d=Ve(()=>{if(s&&s.value==="tooltip")return a.open&&a.id?a.id:void 0}),p=Ve(()=>{if(s&&s.value!=="tooltip")return s.value}),g=Ve(()=>p.value?`${a.open}`:void 0);let y;return di(()=>{gr(()=>a.virtualRef,b=>{b&&(c.value=gh(b))},{immediate:!0}),gr(c,(b,E)=>{y==null||y(),y=void 0,pc(b)&&(["onMouseenter","onMouseleave","onClick","onKeydown","onFocus","onBlur","onContextmenu"].forEach(T=>{var S;const I=a[T];I&&(b.addEventListener(T.slice(2).toLowerCase(),I),(S=E==null?void 0:E.removeEventListener)==null||S.call(E,T.slice(2).toLowerCase(),I))}),y=gr([f,d,p,g],T=>{["aria-controls","aria-describedby","aria-haspopup","aria-expanded"].forEach((S,I)=>{ap(T[I])?b.removeAttribute(S):b.setAttribute(S,T[I])})},{immediate:!0})),pc(E)&&["aria-controls","aria-describedby","aria-haspopup","aria-expanded"].forEach(T=>E.removeAttribute(T))},{immediate:!0})}),to(()=>{y==null||y(),y=void 0}),n({triggerRef:c}),(b,E)=>b.virtualTriggering?Wt("v-if",!0):(De(),Ht(W(Tle),Ds({key:0},b.$attrs,{"aria-controls":W(f),"aria-describedby":W(d),"aria-expanded":W(g),"aria-haspopup":W(p)}),{default:we(()=>[vr(b.$slots,"default")]),_:3},16,["aria-controls","aria-describedby","aria-expanded","aria-haspopup"]))}});var Ale=Hr(Cle,[["__file","/home/runner/work/element-plus/element-plus/packages/components/popper/src/trigger.vue"]]);const JT="focus-trap.focus-after-trapped",QT="focus-trap.focus-after-released",kle="focus-trap.focusout-prevented",PD={cancelable:!0,bubbles:!1},Ile={cancelable:!0,bubbles:!1},OD="focusAfterTrapped",RD="focusAfterReleased",Zz=Symbol("elFocusTrap"),nk=Ze(),Gb=Ze(0),ik=Ze(0);let Zy=0;const Kz=t=>{const n=[],a=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:s=>{const c=s.tagName==="INPUT"&&s.type==="hidden";return s.disabled||s.hidden||c?NodeFilter.FILTER_SKIP:s.tabIndex>=0||s===document.activeElement?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;a.nextNode();)n.push(a.currentNode);return n},LD=(t,n)=>{for(const a of t)if(!Mle(a,n))return a},Mle=(t,n)=>{if(getComputedStyle(t).visibility==="hidden")return!0;for(;t;){if(n&&t===n)return!1;if(getComputedStyle(t).display==="none")return!0;t=t.parentElement}return!1},Fle=t=>{const n=Kz(t),a=LD(n,t),s=LD(n.reverse(),t);return[a,s]},Ple=t=>t instanceof HTMLInputElement&&"select"in t,lh=(t,n)=>{if(t&&t.focus){const a=document.activeElement;t.focus({preventScroll:!0}),ik.value=window.performance.now(),t!==a&&Ple(t)&&n&&t.select()}};function DD(t,n){const a=[...t],s=t.indexOf(n);return s!==-1&&a.splice(s,1),a}const Ole=()=>{let t=[];return{push:s=>{const c=t[0];c&&s!==c&&c.pause(),t=DD(t,s),t.unshift(s)},remove:s=>{var c,f;t=DD(t,s),(f=(c=t[0])==null?void 0:c.resume)==null||f.call(c)}}},Rle=(t,n=!1)=>{const a=document.activeElement;for(const s of t)if(lh(s,n),document.activeElement!==a)return},BD=Ole(),Lle=()=>Gb.value>ik.value,Ky=()=>{nk.value="pointer",Gb.value=window.performance.now()},zD=()=>{nk.value="keyboard",Gb.value=window.performance.now()},Dle=()=>(di(()=>{Zy===0&&(document.addEventListener("mousedown",Ky),document.addEventListener("touchstart",Ky),document.addEventListener("keydown",zD)),Zy++}),to(()=>{Zy--,Zy<=0&&(document.removeEventListener("mousedown",Ky),document.removeEventListener("touchstart",Ky),document.removeEventListener("keydown",zD))}),{focusReason:nk,lastUserFocusTimestamp:Gb,lastAutomatedFocusTimestamp:ik}),Yy=t=>new CustomEvent(kle,{...Ile,detail:t}),Ble=Ft({name:"ElFocusTrap",inheritAttrs:!1,props:{loop:Boolean,trapped:Boolean,focusTrapEl:Object,focusStartEl:{type:[Object,String],default:"first"}},emits:[OD,RD,"focusin","focusout","focusout-prevented","release-requested"],setup(t,{emit:n}){const a=Ze();let s,c;const{focusReason:f}=Dle();Doe(I=>{t.trapped&&!d.paused&&n("release-requested",I)});const d={paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}},p=I=>{if(!t.loop&&!t.trapped||d.paused)return;const{key:A,altKey:M,ctrlKey:F,metaKey:L,currentTarget:O,shiftKey:N}=I,{loop:Q}=t,ie=A===ds.tab&&!M&&!F&&!L,j=document.activeElement;if(ie&&j){const V=O,[D,te]=Fle(V);if(D&&te){if(!N&&j===te){const J=Yy({focusReason:f.value});n("focusout-prevented",J),J.defaultPrevented||(I.preventDefault(),Q&&lh(D,!0))}else if(N&&[D,V].includes(j)){const J=Yy({focusReason:f.value});n("focusout-prevented",J),J.defaultPrevented||(I.preventDefault(),Q&&lh(te,!0))}}else if(j===V){const J=Yy({focusReason:f.value});n("focusout-prevented",J),J.defaultPrevented||I.preventDefault()}}};Ji(Zz,{focusTrapRef:a,onKeydown:p}),gr(()=>t.focusTrapEl,I=>{I&&(a.value=I)},{immediate:!0}),gr([a],([I],[A])=>{I&&(I.addEventListener("keydown",p),I.addEventListener("focusin",b),I.addEventListener("focusout",E)),A&&(A.removeEventListener("keydown",p),A.removeEventListener("focusin",b),A.removeEventListener("focusout",E))});const g=I=>{n(OD,I)},y=I=>n(RD,I),b=I=>{const A=W(a);if(!A)return;const M=I.target,F=I.relatedTarget,L=M&&A.contains(M);t.trapped||F&&A.contains(F)||(s=F),L&&n("focusin",I),!d.paused&&t.trapped&&(L?c=M:lh(c,!0))},E=I=>{const A=W(a);if(!(d.paused||!A))if(t.trapped){const M=I.relatedTarget;!ap(M)&&!A.contains(M)&&setTimeout(()=>{if(!d.paused&&t.trapped){const F=Yy({focusReason:f.value});n("focusout-prevented",F),F.defaultPrevented||lh(c,!0)}},0)}else{const M=I.target;M&&A.contains(M)||n("focusout",I)}};async function T(){await Fn();const I=W(a);if(I){BD.push(d);const A=I.contains(document.activeElement)?s:document.activeElement;if(s=A,!I.contains(A)){const F=new Event(JT,PD);I.addEventListener(JT,g),I.dispatchEvent(F),F.defaultPrevented||Fn(()=>{let L=t.focusStartEl;Mn(L)||(lh(L),document.activeElement!==L&&(L="first")),L==="first"&&Rle(Kz(I),!0),(document.activeElement===A||L==="container")&&lh(I)})}}}function S(){const I=W(a);if(I){I.removeEventListener(JT,g);const A=new CustomEvent(QT,{...PD,detail:{focusReason:f.value}});I.addEventListener(QT,y),I.dispatchEvent(A),!A.defaultPrevented&&(f.value=="keyboard"||!Lle()||I.contains(document.activeElement))&&lh(s??document.body),I.removeEventListener(QT,y),BD.remove(d)}}return di(()=>{t.trapped&&T(),gr(()=>t.trapped,I=>{I?T():S()})}),to(()=>{t.trapped&&S()}),{onKeydown:p}}});function zle(t,n,a,s,c,f){return vr(t.$slots,"default",{handleKeydown:t.onKeydown})}var ak=Hr(Ble,[["render",zle],["__file","/home/runner/work/element-plus/element-plus/packages/components/focus-trap/src/focus-trap.vue"]]);const Nle=["fixed","absolute"],Ule=rn({boundariesPadding:{type:Number,default:0},fallbackPlacements:{type:br(Array),default:void 0},gpuAcceleration:{type:Boolean,default:!0},offset:{type:Number,default:12},placement:{type:String,values:$b,default:"bottom"},popperOptions:{type:br(Object),default:()=>({})},strategy:{type:String,values:Nle,default:"absolute"}}),Yz=rn({...Ule,id:String,style:{type:br([String,Array,Object])},className:{type:br([String,Array,Object])},effect:{type:String,default:"dark"},visible:Boolean,enterable:{type:Boolean,default:!0},pure:Boolean,focusOnShow:{type:Boolean,default:!1},trapping:{type:Boolean,default:!1},popperClass:{type:br([String,Array,Object])},popperStyle:{type:br([String,Array,Object])},referenceEl:{type:br(Object)},triggerTargetEl:{type:br(Object)},stopPopperMouseEvent:{type:Boolean,default:!0},ariaLabel:{type:String,default:void 0},virtualTriggering:Boolean,zIndex:Number}),$le={mouseenter:t=>t instanceof MouseEvent,mouseleave:t=>t instanceof MouseEvent,focus:()=>!0,blur:()=>!0,close:()=>!0},Vle=(t,n=[])=>{const{placement:a,strategy:s,popperOptions:c}=t,f={placement:a,strategy:s,...c,modifiers:[...Wle(t),...n]};return Hle(f,c==null?void 0:c.modifiers),f},jle=t=>{if(Li)return gh(t)};function Wle(t){const{offset:n,gpuAcceleration:a,fallbackPlacements:s}=t;return[{name:"offset",options:{offset:[0,n??12]}},{name:"preventOverflow",options:{padding:{top:2,bottom:2,left:5,right:5}}},{name:"flip",options:{padding:5,fallbackPlacements:s}},{name:"computeStyles",options:{gpuAcceleration:a}}]}function Hle(t,n){n&&(t.modifiers=[...t.modifiers,...n??[]])}const Gle=0,qle=t=>{const{popperInstanceRef:n,contentRef:a,triggerRef:s,role:c}=Gr(rk,void 0),f=Ze(),d=Ze(),p=Ve(()=>({name:"eventListeners",enabled:!!t.visible})),g=Ve(()=>{var F;const L=W(f),O=(F=W(d))!=null?F:Gle;return{name:"arrow",enabled:!K8(L),options:{element:L,padding:O}}}),y=Ve(()=>({onFirstUpdate:()=>{I()},...Vle(t,[W(g),W(p)])})),b=Ve(()=>jle(t.referenceEl)||W(s)),{attributes:E,state:T,styles:S,update:I,forceUpdate:A,instanceRef:M}=Ooe(b,a,y);return gr(M,F=>n.value=F),di(()=>{gr(()=>{var F;return(F=W(b))==null?void 0:F.getBoundingClientRect()},()=>{I()})}),{attributes:E,arrowRef:f,contentRef:a,instanceRef:M,state:T,styles:S,role:c,forceUpdate:A,update:I}},Xle=(t,{attributes:n,styles:a,role:s})=>{const{nextZIndex:c}=jb(),f=Rr("popper"),d=Ve(()=>W(n).popper),p=Ze(yi(t.zIndex)?t.zIndex:c()),g=Ve(()=>[f.b(),f.is("pure",t.pure),f.is(t.effect),t.popperClass]),y=Ve(()=>[{zIndex:W(p)},W(a).popper,t.popperStyle||{}]),b=Ve(()=>s.value==="dialog"?"false":void 0),E=Ve(()=>W(a).arrow||{});return{ariaModal:b,arrowStyle:E,contentAttrs:d,contentClass:g,contentStyle:y,contentZIndex:p,updateZIndex:()=>{p.value=yi(t.zIndex)?t.zIndex:c()}}},Zle=(t,n)=>{const a=Ze(!1),s=Ze();return{focusStartRef:s,trapped:a,onFocusAfterReleased:y=>{var b;((b=y.detail)==null?void 0:b.focusReason)!=="pointer"&&(s.value="first",n("blur"))},onFocusAfterTrapped:()=>{n("focus")},onFocusInTrap:y=>{t.visible&&!a.value&&(y.target&&(s.value=y.target),a.value=!0)},onFocusoutPrevented:y=>{t.trapping||(y.detail.focusReason==="pointer"&&y.preventDefault(),a.value=!1)},onReleaseRequested:()=>{a.value=!1,n("close")}}},Kle=Ft({name:"ElPopperContent"}),Yle=Ft({...Kle,props:Yz,emits:$le,setup(t,{expose:n,emit:a}){const s=t,{focusStartRef:c,trapped:f,onFocusAfterReleased:d,onFocusAfterTrapped:p,onFocusInTrap:g,onFocusoutPrevented:y,onReleaseRequested:b}=Zle(s,a),{attributes:E,arrowRef:T,contentRef:S,styles:I,instanceRef:A,role:M,update:F}=qle(s),{ariaModal:L,arrowStyle:O,contentAttrs:N,contentClass:Q,contentStyle:ie,updateZIndex:j}=Xle(s,{styles:I,attributes:E,role:M}),V=Gr(qd,void 0),D=Ze();Ji(Wz,{arrowStyle:O,arrowRef:T,arrowOffset:D}),V&&(V.addInputId||V.removeInputId)&&Ji(qd,{...V,addInputId:Si,removeInputId:Si});let te;const ue=(le=!0)=>{F(),le&&j()},J=()=>{ue(!1),s.visible&&s.focusOnShow?f.value=!0:s.visible===!1&&(f.value=!1)};return di(()=>{gr(()=>s.triggerTargetEl,(le,re)=>{te==null||te(),te=void 0;const Fe=W(le||S.value),Ye=W(re||S.value);pc(Fe)&&(te=gr([M,()=>s.ariaLabel,L,()=>s.id],Ee=>{["role","aria-label","aria-modal","id"].forEach((ut,Ne)=>{ap(Ee[Ne])?Fe.removeAttribute(ut):Fe.setAttribute(ut,Ee[Ne])})},{immediate:!0})),Ye!==Fe&&pc(Ye)&&["role","aria-label","aria-modal","id"].forEach(Ee=>{Ye.removeAttribute(Ee)})},{immediate:!0}),gr(()=>s.visible,J,{immediate:!0})}),to(()=>{te==null||te(),te=void 0}),n({popperContentRef:S,popperInstanceRef:A,updatePopper:ue,contentStyle:ie}),(le,re)=>(De(),yt("div",Ds({ref_key:"contentRef",ref:S},W(N),{style:W(ie),class:W(Q),tabindex:"-1",onMouseenter:re[0]||(re[0]=Fe=>le.$emit("mouseenter",Fe)),onMouseleave:re[1]||(re[1]=Fe=>le.$emit("mouseleave",Fe))}),[me(W(ak),{trapped:W(f),"trap-on-focus-in":!0,"focus-trap-el":W(S),"focus-start-el":W(c),onFocusAfterTrapped:W(p),onFocusAfterReleased:W(d),onFocusin:W(g),onFocusoutPrevented:W(y),onReleaseRequested:W(b)},{default:we(()=>[vr(le.$slots,"default")]),_:3},8,["trapped","focus-trap-el","focus-start-el","onFocusAfterTrapped","onFocusAfterReleased","onFocusin","onFocusoutPrevented","onReleaseRequested"])],16))}});var Jle=Hr(Yle,[["__file","/home/runner/work/element-plus/element-plus/packages/components/popper/src/content.vue"]]);const Qle=ca(yle),ok=Symbol("elTooltip"),rl=rn({...Noe,...Yz,appendTo:{type:br([String,Object])},content:{type:String,default:""},rawContent:{type:Boolean,default:!1},persistent:Boolean,ariaLabel:String,visible:{type:br(Boolean),default:null},transition:String,teleported:{type:Boolean,default:!0},disabled:Boolean}),U_=rn({...Xz,disabled:Boolean,trigger:{type:br([String,Array]),default:"hover"},triggerKeys:{type:br(Array),default:()=>[ds.enter,ds.space]}}),{useModelToggleProps:ece,useModelToggleEmits:tce,useModelToggle:rce}=gz("visible"),nce=rn({...Hz,...ece,...rl,...U_,...Gz,showArrow:{type:Boolean,default:!0}}),ice=[...tce,"before-show","before-hide","show","hide","open","close"],ace=(t,n)=>Wr(t)?t.includes(n):t===n,_0=(t,n,a)=>s=>{ace(W(t),n)&&a(s)},oce=Ft({name:"ElTooltipTrigger"}),sce=Ft({...oce,props:U_,setup(t,{expose:n}){const a=t,s=Rr("tooltip"),{controlled:c,id:f,open:d,onOpen:p,onClose:g,onToggle:y}=Gr(ok,void 0),b=Ze(null),E=()=>{if(W(c)||a.disabled)return!0},T=Cl(a,"trigger"),S=$u(E,_0(T,"hover",p)),I=$u(E,_0(T,"hover",g)),A=$u(E,_0(T,"click",N=>{N.button===0&&y(N)})),M=$u(E,_0(T,"focus",p)),F=$u(E,_0(T,"focus",g)),L=$u(E,_0(T,"contextmenu",N=>{N.preventDefault(),y(N)})),O=$u(E,N=>{const{code:Q}=N;a.triggerKeys.includes(Q)&&(N.preventDefault(),y(N))});return n({triggerRef:b}),(N,Q)=>(De(),Ht(W(Ale),{id:W(f),"virtual-ref":N.virtualRef,open:W(d),"virtual-triggering":N.virtualTriggering,class:ht(W(s).e("trigger")),onBlur:W(F),onClick:W(A),onContextmenu:W(L),onFocus:W(M),onMouseenter:W(S),onMouseleave:W(I),onKeydown:W(O)},{default:we(()=>[vr(N.$slots,"default")]),_:3},8,["id","virtual-ref","open","virtual-triggering","class","onBlur","onClick","onContextmenu","onFocus","onMouseenter","onMouseleave","onKeydown"]))}});var lce=Hr(sce,[["__file","/home/runner/work/element-plus/element-plus/packages/components/tooltip/src/trigger.vue"]]);const cce=Ft({name:"ElTooltipContent",inheritAttrs:!1}),uce=Ft({...cce,props:rl,setup(t,{expose:n}){const a=t,{selector:s}=Fz(),c=Rr("tooltip"),f=Ze(null),d=Ze(!1),{controlled:p,id:g,open:y,trigger:b,onClose:E,onOpen:T,onShow:S,onHide:I,onBeforeShow:A,onBeforeHide:M}=Gr(ok,void 0),F=Ve(()=>a.transition||`${c.namespace.value}-fade-in-linear`),L=Ve(()=>a.persistent);to(()=>{d.value=!0});const O=Ve(()=>W(L)?!0:W(y)),N=Ve(()=>a.disabled?!1:W(y)),Q=Ve(()=>a.appendTo||s.value),ie=Ve(()=>{var Ee;return(Ee=a.style)!=null?Ee:{}}),j=Ve(()=>!W(y)),V=()=>{I()},D=()=>{if(W(p))return!0},te=$u(D,()=>{a.enterable&&W(b)==="hover"&&T()}),ue=$u(D,()=>{W(b)==="hover"&&E()}),J=()=>{var Ee,ut;(ut=(Ee=f.value)==null?void 0:Ee.updatePopper)==null||ut.call(Ee),A==null||A()},le=()=>{M==null||M()},re=()=>{S(),Ye=lJ(Ve(()=>{var Ee;return(Ee=f.value)==null?void 0:Ee.popperContentRef}),()=>{if(W(p))return;W(b)!=="hover"&&E()})},Fe=()=>{a.virtualTriggering||E()};let Ye;return gr(()=>W(y),Ee=>{Ee||Ye==null||Ye()},{flush:"post"}),gr(()=>a.content,()=>{var Ee,ut;(ut=(Ee=f.value)==null?void 0:Ee.updatePopper)==null||ut.call(Ee)}),n({contentRef:f}),(Ee,ut)=>(De(),Ht(KB,{disabled:!Ee.teleported,to:W(Q)},[me(Xo,{name:W(F),onAfterLeave:V,onBeforeEnter:J,onAfterEnter:re,onBeforeLeave:le},{default:we(()=>[W(O)?ci((De(),Ht(W(Jle),Ds({key:0,id:W(g),ref_key:"contentRef",ref:f},Ee.$attrs,{"aria-label":Ee.ariaLabel,"aria-hidden":W(j),"boundaries-padding":Ee.boundariesPadding,"fallback-placements":Ee.fallbackPlacements,"gpu-acceleration":Ee.gpuAcceleration,offset:Ee.offset,placement:Ee.placement,"popper-options":Ee.popperOptions,strategy:Ee.strategy,effect:Ee.effect,enterable:Ee.enterable,pure:Ee.pure,"popper-class":Ee.popperClass,"popper-style":[Ee.popperStyle,W(ie)],"reference-el":Ee.referenceEl,"trigger-target-el":Ee.triggerTargetEl,visible:W(N),"z-index":Ee.zIndex,onMouseenter:W(te),onMouseleave:W(ue),onBlur:Fe,onClose:W(E)}),{default:we(()=>[d.value?Wt("v-if",!0):vr(Ee.$slots,"default",{key:0})]),_:3},16,["id","aria-label","aria-hidden","boundaries-padding","fallback-placements","gpu-acceleration","offset","placement","popper-options","strategy","effect","enterable","pure","popper-class","popper-style","reference-el","trigger-target-el","visible","z-index","onMouseenter","onMouseleave","onClose"])),[[la,W(N)]]):Wt("v-if",!0)]),_:3},8,["name"])],8,["disabled","to"]))}});var fce=Hr(uce,[["__file","/home/runner/work/element-plus/element-plus/packages/components/tooltip/src/content.vue"]]);const hce=["innerHTML"],dce={key:1},pce=Ft({name:"ElTooltip"}),mce=Ft({...pce,props:nce,emits:ice,setup(t,{expose:n,emit:a}){const s=t;zoe();const c=gc(),f=Ze(),d=Ze(),p=()=>{var F;const L=W(f);L&&((F=L.popperInstanceRef)==null||F.update())},g=Ze(!1),y=Ze(),{show:b,hide:E,hasUpdateHandler:T}=rce({indicator:g,toggleReason:y}),{onOpen:S,onClose:I}=Pz({showAfter:Cl(s,"showAfter"),hideAfter:Cl(s,"hideAfter"),autoClose:Cl(s,"autoClose"),open:b,close:E}),A=Ve(()=>Wo(s.visible)&&!T.value);Ji(ok,{controlled:A,id:c,open:uv(g),trigger:Cl(s,"trigger"),onOpen:F=>{S(F)},onClose:F=>{I(F)},onToggle:F=>{W(g)?I(F):S(F)},onShow:()=>{a("show",y.value)},onHide:()=>{a("hide",y.value)},onBeforeShow:()=>{a("before-show",y.value)},onBeforeHide:()=>{a("before-hide",y.value)},updatePopper:p}),gr(()=>s.disabled,F=>{F&&g.value&&(g.value=!1)});const M=F=>{var L,O;const N=(O=(L=d.value)==null?void 0:L.contentRef)==null?void 0:O.popperContentRef,Q=(F==null?void 0:F.relatedTarget)||document.activeElement;return N&&N.contains(Q)};return NB(()=>g.value&&E()),n({popperRef:f,contentRef:d,isFocusInsideContent:M,updatePopper:p,onOpen:S,onClose:I,hide:E}),(F,L)=>(De(),Ht(W(Qle),{ref_key:"popperRef",ref:f,role:F.role},{default:we(()=>[me(lce,{disabled:F.disabled,trigger:F.trigger,"trigger-keys":F.triggerKeys,"virtual-ref":F.virtualRef,"virtual-triggering":F.virtualTriggering},{default:we(()=>[F.$slots.default?vr(F.$slots,"default",{key:0}):Wt("v-if",!0)]),_:3},8,["disabled","trigger","trigger-keys","virtual-ref","virtual-triggering"]),me(fce,{ref_key:"contentRef",ref:d,"aria-label":F.ariaLabel,"boundaries-padding":F.boundariesPadding,content:F.content,disabled:F.disabled,effect:F.effect,enterable:F.enterable,"fallback-placements":F.fallbackPlacements,"hide-after":F.hideAfter,"gpu-acceleration":F.gpuAcceleration,offset:F.offset,persistent:F.persistent,"popper-class":F.popperClass,"popper-style":F.popperStyle,placement:F.placement,"popper-options":F.popperOptions,pure:F.pure,"raw-content":F.rawContent,"reference-el":F.referenceEl,"trigger-target-el":F.triggerTargetEl,"show-after":F.showAfter,strategy:F.strategy,teleported:F.teleported,transition:F.transition,"virtual-triggering":F.virtualTriggering,"z-index":F.zIndex,"append-to":F.appendTo},{default:we(()=>[vr(F.$slots,"content",{},()=>[F.rawContent?(De(),yt("span",{key:0,innerHTML:F.content},null,8,hce)):(De(),yt("span",dce,Lr(F.content),1))]),F.showArrow?(De(),Ht(W(wle),{key:0,"arrow-offset":F.arrowOffset},null,8,["arrow-offset"])):Wt("v-if",!0)]),_:3},8,["aria-label","boundaries-padding","content","disabled","effect","enterable","fallback-placements","hide-after","gpu-acceleration","offset","persistent","popper-class","popper-style","placement","popper-options","pure","raw-content","reference-el","trigger-target-el","show-after","strategy","teleported","transition","virtual-triggering","z-index","append-to"])]),_:3},8,["role"]))}});var gce=Hr(mce,[["__file","/home/runner/work/element-plus/element-plus/packages/components/tooltip/src/tooltip.vue"]]);const sk=ca(gce),_ce=rn({value:{type:[String,Number],default:""},max:{type:Number,default:99},isDot:Boolean,hidden:Boolean,type:{type:String,values:["primary","success","warning","info","danger"],default:"danger"}}),vce=["textContent"],yce=Ft({name:"ElBadge"}),xce=Ft({...yce,props:_ce,setup(t,{expose:n}){const a=t,s=Rr("badge"),c=Ve(()=>a.isDot?"":yi(a.value)&&yi(a.max)?a.max<a.value?`${a.max}+`:`${a.value}`:`${a.value}`);return n({content:c}),(f,d)=>(De(),yt("div",{class:ht(W(s).b())},[vr(f.$slots,"default"),me(Xo,{name:`${W(s).namespace.value}-zoom-in-center`,persisted:""},{default:we(()=>[ci(gt("sup",{class:ht([W(s).e("content"),W(s).em("content",f.type),W(s).is("fixed",!!f.$slots.default),W(s).is("dot",f.isDot)]),textContent:Lr(W(c))},null,10,vce),[[la,!f.hidden&&(W(c)||f.isDot)]])]),_:1},8,["name"])],2))}});var bce=Hr(xce,[["__file","/home/runner/work/element-plus/element-plus/packages/components/badge/src/badge.vue"]]);const wce=ca(bce),Jz=Symbol("buttonGroupContextKey"),Ece=(t,n)=>{q0({from:"type.text",replacement:"link",version:"3.0.0",scope:"props",ref:"https://element-plus.org/en-US/component/button.html#button-attributes"},Ve(()=>t.type==="text"));const a=Gr(Jz,void 0),s=Wb("button"),{form:c}=Lh(),f=_c(Ve(()=>a==null?void 0:a.size)),d=cu(),p=Ze(),g=sf(),y=Ve(()=>t.type||(a==null?void 0:a.type)||""),b=Ve(()=>{var I,A,M;return(M=(A=t.autoInsertSpace)!=null?A:(I=s.value)==null?void 0:I.autoInsertSpace)!=null?M:!1}),E=Ve(()=>t.tag==="button"?{ariaDisabled:d.value||t.loading,disabled:d.value||t.loading,autofocus:t.autofocus,type:t.nativeType}:{}),T=Ve(()=>{var I;const A=(I=g.default)==null?void 0:I.call(g);if(b.value&&(A==null?void 0:A.length)===1){const M=A[0];if((M==null?void 0:M.type)===dm){const F=M.children;return/^\p{Unified_Ideograph}{2}$/u.test(F.trim())}}return!1});return{_disabled:d,_size:f,_type:y,_ref:p,_props:E,shouldAddSpace:T,handleClick:I=>{t.nativeType==="reset"&&(c==null||c.resetFields()),n("click",I)}}},Tce=["default","primary","success","warning","info","danger","text",""],Sce=["button","submit","reset"],uC=rn({size:Rh,disabled:Boolean,type:{type:String,values:Tce,default:""},icon:{type:xo},nativeType:{type:String,values:Sce,default:"button"},loading:Boolean,loadingIcon:{type:xo,default:()=>Nb},plain:Boolean,text:Boolean,link:Boolean,bg:Boolean,autofocus:Boolean,round:Boolean,circle:Boolean,color:String,dark:Boolean,autoInsertSpace:{type:Boolean,default:void 0},tag:{type:br([String,Object]),default:"button"}}),Cce={click:t=>t instanceof MouseEvent};function Ao(t,n){Ace(t)&&(t="100%");var a=kce(t);return t=n===360?t:Math.min(n,Math.max(0,parseFloat(t))),a&&(t=parseInt(String(t*n),10)/100),Math.abs(t-n)<1e-6?1:(n===360?t=(t<0?t%n+n:t%n)/parseFloat(String(n)):t=t%n/parseFloat(String(n)),t)}function Jy(t){return Math.min(1,Math.max(0,t))}function Ace(t){return typeof t=="string"&&t.indexOf(".")!==-1&&parseFloat(t)===1}function kce(t){return typeof t=="string"&&t.indexOf("%")!==-1}function Qz(t){return t=parseFloat(t),(isNaN(t)||t<0||t>1)&&(t=1),t}function Qy(t){return t<=1?"".concat(Number(t)*100,"%"):t}function Od(t){return t.length===1?"0"+t:String(t)}function Ice(t,n,a){return{r:Ao(t,255)*255,g:Ao(n,255)*255,b:Ao(a,255)*255}}function ND(t,n,a){t=Ao(t,255),n=Ao(n,255),a=Ao(a,255);var s=Math.max(t,n,a),c=Math.min(t,n,a),f=0,d=0,p=(s+c)/2;if(s===c)d=0,f=0;else{var g=s-c;switch(d=p>.5?g/(2-s-c):g/(s+c),s){case t:f=(n-a)/g+(n<a?6:0);break;case n:f=(a-t)/g+2;break;case a:f=(t-n)/g+4;break}f/=6}return{h:f,s:d,l:p}}function eS(t,n,a){return a<0&&(a+=1),a>1&&(a-=1),a<1/6?t+(n-t)*(6*a):a<1/2?n:a<2/3?t+(n-t)*(2/3-a)*6:t}function Mce(t,n,a){var s,c,f;if(t=Ao(t,360),n=Ao(n,100),a=Ao(a,100),n===0)c=a,f=a,s=a;else{var d=a<.5?a*(1+n):a+n-a*n,p=2*a-d;s=eS(p,d,t+1/3),c=eS(p,d,t),f=eS(p,d,t-1/3)}return{r:s*255,g:c*255,b:f*255}}function UD(t,n,a){t=Ao(t,255),n=Ao(n,255),a=Ao(a,255);var s=Math.max(t,n,a),c=Math.min(t,n,a),f=0,d=s,p=s-c,g=s===0?0:p/s;if(s===c)f=0;else{switch(s){case t:f=(n-a)/p+(n<a?6:0);break;case n:f=(a-t)/p+2;break;case a:f=(t-n)/p+4;break}f/=6}return{h:f,s:g,v:d}}function Fce(t,n,a){t=Ao(t,360)*6,n=Ao(n,100),a=Ao(a,100);var s=Math.floor(t),c=t-s,f=a*(1-n),d=a*(1-c*n),p=a*(1-(1-c)*n),g=s%6,y=[a,d,f,f,p,a][g],b=[p,a,a,d,f,f][g],E=[f,f,p,a,a,d][g];return{r:y*255,g:b*255,b:E*255}}function $D(t,n,a,s){var c=[Od(Math.round(t).toString(16)),Od(Math.round(n).toString(16)),Od(Math.round(a).toString(16))];return s&&c[0].startsWith(c[0].charAt(1))&&c[1].startsWith(c[1].charAt(1))&&c[2].startsWith(c[2].charAt(1))?c[0].charAt(0)+c[1].charAt(0)+c[2].charAt(0):c.join("")}function Pce(t,n,a,s,c){var f=[Od(Math.round(t).toString(16)),Od(Math.round(n).toString(16)),Od(Math.round(a).toString(16)),Od(Oce(s))];return c&&f[0].startsWith(f[0].charAt(1))&&f[1].startsWith(f[1].charAt(1))&&f[2].startsWith(f[2].charAt(1))&&f[3].startsWith(f[3].charAt(1))?f[0].charAt(0)+f[1].charAt(0)+f[2].charAt(0)+f[3].charAt(0):f.join("")}function Oce(t){return Math.round(parseFloat(t)*255).toString(16)}function VD(t){return el(t)/255}function el(t){return parseInt(t,16)}function Rce(t){return{r:t>>16,g:(t&65280)>>8,b:t&255}}var fC={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",goldenrod:"#daa520",gold:"#ffd700",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavenderblush:"#fff0f5",lavender:"#e6e6fa",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};function Lce(t){var n={r:0,g:0,b:0},a=1,s=null,c=null,f=null,d=!1,p=!1;return typeof t=="string"&&(t=zce(t)),typeof t=="object"&&(Lu(t.r)&&Lu(t.g)&&Lu(t.b)?(n=Ice(t.r,t.g,t.b),d=!0,p=String(t.r).substr(-1)==="%"?"prgb":"rgb"):Lu(t.h)&&Lu(t.s)&&Lu(t.v)?(s=Qy(t.s),c=Qy(t.v),n=Fce(t.h,s,c),d=!0,p="hsv"):Lu(t.h)&&Lu(t.s)&&Lu(t.l)&&(s=Qy(t.s),f=Qy(t.l),n=Mce(t.h,s,f),d=!0,p="hsl"),Object.prototype.hasOwnProperty.call(t,"a")&&(a=t.a)),a=Qz(a),{ok:d,format:t.format||p,r:Math.min(255,Math.max(n.r,0)),g:Math.min(255,Math.max(n.g,0)),b:Math.min(255,Math.max(n.b,0)),a}}var Dce="[-\\+]?\\d+%?",Bce="[-\\+]?\\d*\\.\\d+%?",_h="(?:".concat(Bce,")|(?:").concat(Dce,")"),tS="[\\s|\\(]+(".concat(_h,")[,|\\s]+(").concat(_h,")[,|\\s]+(").concat(_h,")\\s*\\)?"),rS="[\\s|\\(]+(".concat(_h,")[,|\\s]+(").concat(_h,")[,|\\s]+(").concat(_h,")[,|\\s]+(").concat(_h,")\\s*\\)?"),rc={CSS_UNIT:new RegExp(_h),rgb:new RegExp("rgb"+tS),rgba:new RegExp("rgba"+rS),hsl:new RegExp("hsl"+tS),hsla:new RegExp("hsla"+rS),hsv:new RegExp("hsv"+tS),hsva:new RegExp("hsva"+rS),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/};function zce(t){if(t=t.trim().toLowerCase(),t.length===0)return!1;var n=!1;if(fC[t])t=fC[t],n=!0;else if(t==="transparent")return{r:0,g:0,b:0,a:0,format:"name"};var a=rc.rgb.exec(t);return a?{r:a[1],g:a[2],b:a[3]}:(a=rc.rgba.exec(t),a?{r:a[1],g:a[2],b:a[3],a:a[4]}:(a=rc.hsl.exec(t),a?{h:a[1],s:a[2],l:a[3]}:(a=rc.hsla.exec(t),a?{h:a[1],s:a[2],l:a[3],a:a[4]}:(a=rc.hsv.exec(t),a?{h:a[1],s:a[2],v:a[3]}:(a=rc.hsva.exec(t),a?{h:a[1],s:a[2],v:a[3],a:a[4]}:(a=rc.hex8.exec(t),a?{r:el(a[1]),g:el(a[2]),b:el(a[3]),a:VD(a[4]),format:n?"name":"hex8"}:(a=rc.hex6.exec(t),a?{r:el(a[1]),g:el(a[2]),b:el(a[3]),format:n?"name":"hex"}:(a=rc.hex4.exec(t),a?{r:el(a[1]+a[1]),g:el(a[2]+a[2]),b:el(a[3]+a[3]),a:VD(a[4]+a[4]),format:n?"name":"hex8"}:(a=rc.hex3.exec(t),a?{r:el(a[1]+a[1]),g:el(a[2]+a[2]),b:el(a[3]+a[3]),format:n?"name":"hex"}:!1)))))))))}function Lu(t){return!!rc.CSS_UNIT.exec(String(t))}var Nce=function(){function t(n,a){n===void 0&&(n=""),a===void 0&&(a={});var s;if(n instanceof t)return n;typeof n=="number"&&(n=Rce(n)),this.originalInput=n;var c=Lce(n);this.originalInput=n,this.r=c.r,this.g=c.g,this.b=c.b,this.a=c.a,this.roundA=Math.round(100*this.a)/100,this.format=(s=a.format)!==null&&s!==void 0?s:c.format,this.gradientType=a.gradientType,this.r<1&&(this.r=Math.round(this.r)),this.g<1&&(this.g=Math.round(this.g)),this.b<1&&(this.b=Math.round(this.b)),this.isValid=c.ok}return t.prototype.isDark=function(){return this.getBrightness()<128},t.prototype.isLight=function(){return!this.isDark()},t.prototype.getBrightness=function(){var n=this.toRgb();return(n.r*299+n.g*587+n.b*114)/1e3},t.prototype.getLuminance=function(){var n=this.toRgb(),a,s,c,f=n.r/255,d=n.g/255,p=n.b/255;return f<=.03928?a=f/12.92:a=Math.pow((f+.055)/1.055,2.4),d<=.03928?s=d/12.92:s=Math.pow((d+.055)/1.055,2.4),p<=.03928?c=p/12.92:c=Math.pow((p+.055)/1.055,2.4),.2126*a+.7152*s+.0722*c},t.prototype.getAlpha=function(){return this.a},t.prototype.setAlpha=function(n){return this.a=Qz(n),this.roundA=Math.round(100*this.a)/100,this},t.prototype.isMonochrome=function(){var n=this.toHsl().s;return n===0},t.prototype.toHsv=function(){var n=UD(this.r,this.g,this.b);return{h:n.h*360,s:n.s,v:n.v,a:this.a}},t.prototype.toHsvString=function(){var n=UD(this.r,this.g,this.b),a=Math.round(n.h*360),s=Math.round(n.s*100),c=Math.round(n.v*100);return this.a===1?"hsv(".concat(a,", ").concat(s,"%, ").concat(c,"%)"):"hsva(".concat(a,", ").concat(s,"%, ").concat(c,"%, ").concat(this.roundA,")")},t.prototype.toHsl=function(){var n=ND(this.r,this.g,this.b);return{h:n.h*360,s:n.s,l:n.l,a:this.a}},t.prototype.toHslString=function(){var n=ND(this.r,this.g,this.b),a=Math.round(n.h*360),s=Math.round(n.s*100),c=Math.round(n.l*100);return this.a===1?"hsl(".concat(a,", ").concat(s,"%, ").concat(c,"%)"):"hsla(".concat(a,", ").concat(s,"%, ").concat(c,"%, ").concat(this.roundA,")")},t.prototype.toHex=function(n){return n===void 0&&(n=!1),$D(this.r,this.g,this.b,n)},t.prototype.toHexString=function(n){return n===void 0&&(n=!1),"#"+this.toHex(n)},t.prototype.toHex8=function(n){return n===void 0&&(n=!1),Pce(this.r,this.g,this.b,this.a,n)},t.prototype.toHex8String=function(n){return n===void 0&&(n=!1),"#"+this.toHex8(n)},t.prototype.toHexShortString=function(n){return n===void 0&&(n=!1),this.a===1?this.toHexString(n):this.toHex8String(n)},t.prototype.toRgb=function(){return{r:Math.round(this.r),g:Math.round(this.g),b:Math.round(this.b),a:this.a}},t.prototype.toRgbString=function(){var n=Math.round(this.r),a=Math.round(this.g),s=Math.round(this.b);return this.a===1?"rgb(".concat(n,", ").concat(a,", ").concat(s,")"):"rgba(".concat(n,", ").concat(a,", ").concat(s,", ").concat(this.roundA,")")},t.prototype.toPercentageRgb=function(){var n=function(a){return"".concat(Math.round(Ao(a,255)*100),"%")};return{r:n(this.r),g:n(this.g),b:n(this.b),a:this.a}},t.prototype.toPercentageRgbString=function(){var n=function(a){return Math.round(Ao(a,255)*100)};return this.a===1?"rgb(".concat(n(this.r),"%, ").concat(n(this.g),"%, ").concat(n(this.b),"%)"):"rgba(".concat(n(this.r),"%, ").concat(n(this.g),"%, ").concat(n(this.b),"%, ").concat(this.roundA,")")},t.prototype.toName=function(){if(this.a===0)return"transparent";if(this.a<1)return!1;for(var n="#"+$D(this.r,this.g,this.b,!1),a=0,s=Object.entries(fC);a<s.length;a++){var c=s[a],f=c[0],d=c[1];if(n===d)return f}return!1},t.prototype.toString=function(n){var a=!!n;n=n??this.format;var s=!1,c=this.a<1&&this.a>=0,f=!a&&c&&(n.startsWith("hex")||n==="name");return f?n==="name"&&this.a===0?this.toName():this.toRgbString():(n==="rgb"&&(s=this.toRgbString()),n==="prgb"&&(s=this.toPercentageRgbString()),(n==="hex"||n==="hex6")&&(s=this.toHexString()),n==="hex3"&&(s=this.toHexString(!0)),n==="hex4"&&(s=this.toHex8String(!0)),n==="hex8"&&(s=this.toHex8String()),n==="name"&&(s=this.toName()),n==="hsl"&&(s=this.toHslString()),n==="hsv"&&(s=this.toHsvString()),s||this.toHexString())},t.prototype.toNumber=function(){return(Math.round(this.r)<<16)+(Math.round(this.g)<<8)+Math.round(this.b)},t.prototype.clone=function(){return new t(this.toString())},t.prototype.lighten=function(n){n===void 0&&(n=10);var a=this.toHsl();return a.l+=n/100,a.l=Jy(a.l),new t(a)},t.prototype.brighten=function(n){n===void 0&&(n=10);var a=this.toRgb();return a.r=Math.max(0,Math.min(255,a.r-Math.round(255*-(n/100)))),a.g=Math.max(0,Math.min(255,a.g-Math.round(255*-(n/100)))),a.b=Math.max(0,Math.min(255,a.b-Math.round(255*-(n/100)))),new t(a)},t.prototype.darken=function(n){n===void 0&&(n=10);var a=this.toHsl();return a.l-=n/100,a.l=Jy(a.l),new t(a)},t.prototype.tint=function(n){return n===void 0&&(n=10),this.mix("white",n)},t.prototype.shade=function(n){return n===void 0&&(n=10),this.mix("black",n)},t.prototype.desaturate=function(n){n===void 0&&(n=10);var a=this.toHsl();return a.s-=n/100,a.s=Jy(a.s),new t(a)},t.prototype.saturate=function(n){n===void 0&&(n=10);var a=this.toHsl();return a.s+=n/100,a.s=Jy(a.s),new t(a)},t.prototype.greyscale=function(){return this.desaturate(100)},t.prototype.spin=function(n){var a=this.toHsl(),s=(a.h+n)%360;return a.h=s<0?360+s:s,new t(a)},t.prototype.mix=function(n,a){a===void 0&&(a=50);var s=this.toRgb(),c=new t(n).toRgb(),f=a/100,d={r:(c.r-s.r)*f+s.r,g:(c.g-s.g)*f+s.g,b:(c.b-s.b)*f+s.b,a:(c.a-s.a)*f+s.a};return new t(d)},t.prototype.analogous=function(n,a){n===void 0&&(n=6),a===void 0&&(a=30);var s=this.toHsl(),c=360/a,f=[this];for(s.h=(s.h-(c*n>>1)+720)%360;--n;)s.h=(s.h+c)%360,f.push(new t(s));return f},t.prototype.complement=function(){var n=this.toHsl();return n.h=(n.h+180)%360,new t(n)},t.prototype.monochromatic=function(n){n===void 0&&(n=6);for(var a=this.toHsv(),s=a.h,c=a.s,f=a.v,d=[],p=1/n;n--;)d.push(new t({h:s,s:c,v:f})),f=(f+p)%1;return d},t.prototype.splitcomplement=function(){var n=this.toHsl(),a=n.h;return[this,new t({h:(a+72)%360,s:n.s,l:n.l}),new t({h:(a+216)%360,s:n.s,l:n.l})]},t.prototype.onBackground=function(n){var a=this.toRgb(),s=new t(n).toRgb(),c=a.a+s.a*(1-a.a);return new t({r:(a.r*a.a+s.r*s.a*(1-a.a))/c,g:(a.g*a.a+s.g*s.a*(1-a.a))/c,b:(a.b*a.a+s.b*s.a*(1-a.a))/c,a:c})},t.prototype.triad=function(){return this.polyad(3)},t.prototype.tetrad=function(){return this.polyad(4)},t.prototype.polyad=function(n){for(var a=this.toHsl(),s=a.h,c=[this],f=360/n,d=1;d<n;d++)c.push(new t({h:(s+d*f)%360,s:a.s,l:a.l}));return c},t.prototype.equals=function(n){return this.toRgbString()===new t(n).toRgbString()},t}();function rh(t,n=20){return t.mix("#141414",n).toString()}function Uce(t){const n=cu(),a=Rr("button");return Ve(()=>{let s={};const c=t.color;if(c){const f=new Nce(c),d=t.dark?f.tint(20).toString():rh(f,20);if(t.plain)s=a.cssVarBlock({"bg-color":t.dark?rh(f,90):f.tint(90).toString(),"text-color":c,"border-color":t.dark?rh(f,50):f.tint(50).toString(),"hover-text-color":`var(${a.cssVarName("color-white")})`,"hover-bg-color":c,"hover-border-color":c,"active-bg-color":d,"active-text-color":`var(${a.cssVarName("color-white")})`,"active-border-color":d}),n.value&&(s[a.cssVarBlockName("disabled-bg-color")]=t.dark?rh(f,90):f.tint(90).toString(),s[a.cssVarBlockName("disabled-text-color")]=t.dark?rh(f,50):f.tint(50).toString(),s[a.cssVarBlockName("disabled-border-color")]=t.dark?rh(f,80):f.tint(80).toString());else{const p=t.dark?rh(f,30):f.tint(30).toString(),g=f.isDark()?`var(${a.cssVarName("color-white")})`:`var(${a.cssVarName("color-black")})`;if(s=a.cssVarBlock({"bg-color":c,"text-color":g,"border-color":c,"hover-bg-color":p,"hover-text-color":g,"hover-border-color":p,"active-bg-color":d,"active-border-color":d}),n.value){const y=t.dark?rh(f,50):f.tint(50).toString();s[a.cssVarBlockName("disabled-bg-color")]=y,s[a.cssVarBlockName("disabled-text-color")]=t.dark?"rgba(255, 255, 255, 0.5)":`var(${a.cssVarName("color-white")})`,s[a.cssVarBlockName("disabled-border-color")]=y}}}return s})}const $ce=Ft({name:"ElButton"}),Vce=Ft({...$ce,props:uC,emits:Cce,setup(t,{expose:n,emit:a}){const s=t,c=Uce(s),f=Rr("button"),{_ref:d,_size:p,_type:g,_disabled:y,_props:b,shouldAddSpace:E,handleClick:T}=Ece(s,a);return n({ref:d,size:p,type:g,disabled:y,shouldAddSpace:E}),(S,I)=>(De(),Ht(Zi(S.tag),Ds({ref_key:"_ref",ref:d},W(b),{class:[W(f).b(),W(f).m(W(g)),W(f).m(W(p)),W(f).is("disabled",W(y)),W(f).is("loading",S.loading),W(f).is("plain",S.plain),W(f).is("round",S.round),W(f).is("circle",S.circle),W(f).is("text",S.text),W(f).is("link",S.link),W(f).is("has-bg",S.bg)],style:W(c),onClick:W(T)}),{default:we(()=>[S.loading?(De(),yt(mn,{key:0},[S.$slots.loading?vr(S.$slots,"loading",{key:0}):(De(),Ht(W(Hn),{key:1,class:ht(W(f).is("loading"))},{default:we(()=>[(De(),Ht(Zi(S.loadingIcon)))]),_:1},8,["class"]))],64)):S.icon||S.$slots.icon?(De(),Ht(W(Hn),{key:1},{default:we(()=>[S.icon?(De(),Ht(Zi(S.icon),{key:0})):vr(S.$slots,"icon",{key:1})]),_:3})):Wt("v-if",!0),S.$slots.default?(De(),yt("span",{key:2,class:ht({[W(f).em("text","expand")]:W(E)})},[vr(S.$slots,"default")],2)):Wt("v-if",!0)]),_:3},16,["class","style","onClick"]))}});var jce=Hr(Vce,[["__file","/home/runner/work/element-plus/element-plus/packages/components/button/src/button.vue"]]);const Wce={size:uC.size,type:uC.type},Hce=Ft({name:"ElButtonGroup"}),Gce=Ft({...Hce,props:Wce,setup(t){const n=t;Ji(Jz,bo({size:Cl(n,"size"),type:Cl(n,"type")}));const a=Rr("button");return(s,c)=>(De(),yt("div",{class:ht(`${W(a).b("group")}`)},[vr(s.$slots,"default")],2))}});var eN=Hr(Gce,[["__file","/home/runner/work/element-plus/element-plus/packages/components/button/src/button-group.vue"]]);const uu=ca(jce,{ButtonGroup:eN});Ko(eN);var $o=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function qb(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}const ch=new Map;let jD;Li&&(document.addEventListener("mousedown",t=>jD=t),document.addEventListener("mouseup",t=>{for(const n of ch.values())for(const{documentHandler:a}of n)a(t,jD)}));function WD(t,n){let a=[];return Array.isArray(n.arg)?a=n.arg:pc(n.arg)&&a.push(n.arg),function(s,c){const f=n.instance.popperRef,d=s.target,p=c==null?void 0:c.target,g=!n||!n.instance,y=!d||!p,b=t.contains(d)||t.contains(p),E=t===d,T=a.length&&a.some(I=>I==null?void 0:I.contains(d))||a.length&&a.includes(p),S=f&&(f.contains(d)||f.contains(p));g||y||b||E||T||S||n.value(s,c)}}const tN={beforeMount(t,n){ch.has(t)||ch.set(t,[]),ch.get(t).push({documentHandler:WD(t,n),bindingFn:n.value})},updated(t,n){ch.has(t)||ch.set(t,[]);const a=ch.get(t),s=a.findIndex(f=>f.bindingFn===n.oldValue),c={documentHandler:WD(t,n),bindingFn:n.value};s>=0?a.splice(s,1,c):a.push(c)},unmounted(t){ch.delete(t)}},hC="_trap-focus-children",Rd=[],HD=t=>{if(Rd.length===0)return;const n=Rd[Rd.length-1][hC];if(n.length>0&&t.code===ds.tab){if(n.length===1){t.preventDefault(),document.activeElement!==n[0]&&n[0].focus();return}const a=t.shiftKey,s=t.target===n[0],c=t.target===n[n.length-1];s&&a&&(t.preventDefault(),n[n.length-1].focus()),c&&!a&&(t.preventDefault(),n[0].focus())}},qce={beforeMount(t){t[hC]=gL(t),Rd.push(t),Rd.length<=1&&document.addEventListener("keydown",HD)},updated(t){Fn(()=>{t[hC]=gL(t)})},unmounted(){Rd.shift(),Rd.length===0&&document.removeEventListener("keydown",HD)}};var GD=!1,Id,dC,pC,Sx,Cx,rN,Ax,mC,gC,_C,nN,vC,yC,iN,aN;function Is(){if(!GD){GD=!0;var t=navigator.userAgent,n=/(?:MSIE.(\d+\.\d+))|(?:(?:Firefox|GranParadiso|Iceweasel).(\d+\.\d+))|(?:Opera(?:.+Version.|.)(\d+\.\d+))|(?:AppleWebKit.(\d+(?:\.\d+)?))|(?:Trident\/\d+\.\d+.*rv:(\d+\.\d+))/.exec(t),a=/(Mac OS X)|(Windows)|(Linux)/.exec(t);if(vC=/\b(iPhone|iP[ao]d)/.exec(t),yC=/\b(iP[ao]d)/.exec(t),_C=/Android/i.exec(t),iN=/FBAN\/\w+;/i.exec(t),aN=/Mobile/i.exec(t),nN=!!/Win64/.exec(t),n){Id=n[1]?parseFloat(n[1]):n[5]?parseFloat(n[5]):NaN,Id&&document&&document.documentMode&&(Id=document.documentMode);var s=/(?:Trident\/(\d+.\d+))/.exec(t);rN=s?parseFloat(s[1])+4:Id,dC=n[2]?parseFloat(n[2]):NaN,pC=n[3]?parseFloat(n[3]):NaN,Sx=n[4]?parseFloat(n[4]):NaN,Sx?(n=/(?:Chrome\/(\d+\.\d+))/.exec(t),Cx=n&&n[1]?parseFloat(n[1]):NaN):Cx=NaN}else Id=dC=pC=Cx=Sx=NaN;if(a){if(a[1]){var c=/(?:Mac OS X (\d+(?:[._]\d+)?))/.exec(t);Ax=c?parseFloat(c[1].replace("_",".")):!0}else Ax=!1;mC=!!a[2],gC=!!a[3]}else Ax=mC=gC=!1}}var xC={ie:function(){return Is()||Id},ieCompatibilityMode:function(){return Is()||rN>Id},ie64:function(){return xC.ie()&&nN},firefox:function(){return Is()||dC},opera:function(){return Is()||pC},webkit:function(){return Is()||Sx},safari:function(){return xC.webkit()},chrome:function(){return Is()||Cx},windows:function(){return Is()||mC},osx:function(){return Is()||Ax},linux:function(){return Is()||gC},iphone:function(){return Is()||vC},mobile:function(){return Is()||vC||yC||_C||aN},nativeApp:function(){return Is()||iN},android:function(){return Is()||_C},ipad:function(){return Is()||yC}},Xce=xC,ex=!!(typeof window<"u"&&window.document&&window.document.createElement),Zce={canUseDOM:ex,canUseWorkers:typeof Worker<"u",canUseEventListeners:ex&&!!(window.addEventListener||window.attachEvent),canUseViewport:ex&&!!window.screen,isInWorker:!ex},oN=Zce,sN;oN.canUseDOM&&(sN=document.implementation&&document.implementation.hasFeature&&document.implementation.hasFeature("","")!==!0);function Kce(t,n){if(!oN.canUseDOM||n&&!("addEventListener"in document))return!1;var a="on"+t,s=a in document;if(!s){var c=document.createElement("div");c.setAttribute(a,"return;"),s=typeof c[a]=="function"}return!s&&sN&&t==="wheel"&&(s=document.implementation.hasFeature("Events.wheel","3.0")),s}var Yce=Kce,qD=10,XD=40,ZD=800;function lN(t){var n=0,a=0,s=0,c=0;return"detail"in t&&(a=t.detail),"wheelDelta"in t&&(a=-t.wheelDelta/120),"wheelDeltaY"in t&&(a=-t.wheelDeltaY/120),"wheelDeltaX"in t&&(n=-t.wheelDeltaX/120),"axis"in t&&t.axis===t.HORIZONTAL_AXIS&&(n=a,a=0),s=n*qD,c=a*qD,"deltaY"in t&&(c=t.deltaY),"deltaX"in t&&(s=t.deltaX),(s||c)&&t.deltaMode&&(t.deltaMode==1?(s*=XD,c*=XD):(s*=ZD,c*=ZD)),s&&!n&&(n=s<1?-1:1),c&&!a&&(a=c<1?-1:1),{spinX:n,spinY:a,pixelX:s,pixelY:c}}lN.getEventType=function(){return Xce.firefox()?"DOMMouseScroll":Yce("wheel")?"wheel":"mousewheel"};var Jce=lN;/**
* Checks if an event is supported in the current execution environment.
*
* NOTE: This will not work correctly for non-generic events such as `change`,
* `reset`, `load`, `error`, and `select`.
*
* Borrows from Modernizr.
*
* @param {string} eventNameSuffix Event name, e.g. "click".
* @param {?boolean} capture Check if the capture phase is supported.
* @return {boolean} True if the event is supported.
* @internal
* @license Modernizr 3.0.0pre (Custom Build) | MIT
*/const Qce=function(t,n){if(t&&t.addEventListener){const a=function(s){const c=Jce(s);n&&Reflect.apply(n,this,[s,c])};t.addEventListener("wheel",a,{passive:!0})}},eue={beforeMount(t,n){Qce(t,n.value)}},tue=rn({initialIndex:{type:Number,default:0},height:{type:String,default:""},trigger:{type:String,values:["hover","click"],default:"hover"},autoplay:{type:Boolean,default:!0},interval:{type:Number,default:3e3},indicatorPosition:{type:String,values:["","none","outside"],default:""},arrow:{type:String,values:["always","hover","never"],default:"hover"},type:{type:String,values:["","card"],default:""},loop:{type:Boolean,default:!0},direction:{type:String,values:["horizontal","vertical"],default:"horizontal"},pauseOnHover:{type:Boolean,default:!0}}),rue={change:(t,n)=>[t,n].every(yi)},cN=Symbol("carouselContextKey"),KD=300,nue=(t,n,a)=>{const{children:s,addChild:c,removeChild:f}=Dz(Tn(),"ElCarouselItem"),d=sf(),p=Ze(-1),g=Ze(null),y=Ze(!1),b=Ze(),E=Ze(0),T=Ze(!0),S=Ve(()=>t.arrow!=="never"&&!W(M)),I=Ve(()=>s.value.some(rt=>rt.props.label.toString().length>0)),A=Ve(()=>t.type==="card"),M=Ve(()=>t.direction==="vertical"),F=Ve(()=>t.height!=="auto"?{height:t.height}:{height:`${E.value}px`,overflow:"hidden"}),L=oD(rt=>{V(rt)},KD,{trailing:!0}),O=oD(rt=>{Ye(rt)},KD),N=rt=>T.value?p.value<=1?rt<=1:rt>1:!0;function Q(){g.value&&(clearInterval(g.value),g.value=null)}function ie(){t.interval<=0||!t.autoplay||g.value||(g.value=setInterval(()=>j(),t.interval))}const j=()=>{p.value<s.value.length-1?p.value=p.value+1:t.loop&&(p.value=0)};function V(rt){if(Mn(rt)){const ze=s.value.filter(oe=>oe.props.name===rt);ze.length>0&&(rt=s.value.indexOf(ze[0]))}if(rt=Number(rt),Number.isNaN(rt)||rt!==Math.floor(rt))return;const et=s.value.length,Ge=p.value;rt<0?p.value=t.loop?et-1:0:rt>=et?p.value=t.loop?0:et-1:p.value=rt,Ge===p.value&&D(Ge),Ne()}function D(rt){s.value.forEach((et,Ge)=>{et.translateItem(Ge,p.value,rt)})}function te(rt,et){var Ge,ze,oe,Me;const fe=W(s),pe=fe.length;if(pe===0||!rt.states.inStage)return!1;const ot=et+1,xe=et-1,ae=pe-1,X=fe[ae].states.active,Ce=fe[0].states.active,he=(ze=(Ge=fe[ot])==null?void 0:Ge.states)==null?void 0:ze.active,G=(Me=(oe=fe[xe])==null?void 0:oe.states)==null?void 0:Me.active;return et===ae&&Ce||he?"left":et===0&&X||G?"right":!1}function ue(){y.value=!0,t.pauseOnHover&&Q()}function J(){y.value=!1,ie()}function le(rt){W(M)||s.value.forEach((et,Ge)=>{rt===te(et,Ge)&&(et.states.hover=!0)})}function re(){W(M)||s.value.forEach(rt=>{rt.states.hover=!1})}function Fe(rt){p.value=rt}function Ye(rt){t.trigger==="hover"&&rt!==p.value&&(p.value=rt)}function Ee(){V(p.value-1)}function ut(){V(p.value+1)}function Ne(){Q(),t.pauseOnHover||ie()}function He(rt){t.height==="auto"&&(E.value=rt)}function Oe(){var rt;const et=(rt=d.default)==null?void 0:rt.call(d);if(!et)return null;const Ge=t_(et),ze="ElCarouselItem",oe=Ge.filter(Me=>ps(Me)&&Me.type.name===ze);return(oe==null?void 0:oe.length)===2&&t.loop&&!A.value?(T.value=!0,oe):(T.value=!1,null)}gr(()=>p.value,(rt,et)=>{D(et),T.value&&(rt=rt%2,et=et%2),et>-1&&n("change",rt,et)}),gr(()=>t.autoplay,rt=>{rt?ie():Q()}),gr(()=>t.loop,()=>{V(p.value)}),gr(()=>t.interval,()=>{Ne()});const Pe=Rs();return di(()=>{gr(()=>s.value,()=>{s.value.length>0&&V(t.initialIndex)},{immediate:!0}),Pe.value=dc(b.value,()=>{D()}),ie()}),to(()=>{Q(),b.value&&Pe.value&&Pe.value.stop()}),Ji(cN,{root:b,isCardType:A,isVertical:M,items:s,loop:t.loop,addItem:c,removeItem:f,setActiveItem:V,setContainerHeight:He}),{root:b,activeIndex:p,arrowDisplay:S,hasLabel:I,hover:y,isCardType:A,items:s,isVertical:M,containerStyle:F,isItemsTwoLength:T,handleButtonEnter:le,handleButtonLeave:re,handleIndicatorClick:Fe,handleMouseEnter:ue,handleMouseLeave:J,setActiveItem:V,prev:Ee,next:ut,PlaceholderItem:Oe,isTwoLengthShow:N,throttledArrowClick:L,throttledIndicatorHover:O}},iue=["onMouseenter","onClick"],aue={key:0},oue="ElCarousel",sue=Ft({name:oue}),lue=Ft({...sue,props:tue,emits:rue,setup(t,{expose:n,emit:a}){const s=t,{root:c,activeIndex:f,arrowDisplay:d,hasLabel:p,hover:g,isCardType:y,items:b,isVertical:E,containerStyle:T,handleButtonEnter:S,handleButtonLeave:I,handleIndicatorClick:A,handleMouseEnter:M,handleMouseLeave:F,setActiveItem:L,prev:O,next:N,PlaceholderItem:Q,isTwoLengthShow:ie,throttledArrowClick:j,throttledIndicatorHover:V}=nue(s,a),D=Rr("carousel"),te=Ve(()=>{const J=[D.b(),D.m(s.direction)];return W(y)&&J.push(D.m("card")),J}),ue=Ve(()=>{const J=[D.e("indicators"),D.em("indicators",s.direction)];return W(p)&&J.push(D.em("indicators","labels")),s.indicatorPosition==="outside"&&J.push(D.em("indicators","outside")),W(E)&&J.push(D.em("indicators","right")),J});return n({setActiveItem:L,prev:O,next:N}),(J,le)=>(De(),yt("div",{ref_key:"root",ref:c,class:ht(W(te)),onMouseenter:le[6]||(le[6]=si((...re)=>W(M)&&W(M)(...re),["stop"])),onMouseleave:le[7]||(le[7]=si((...re)=>W(F)&&W(F)(...re),["stop"]))},[gt("div",{class:ht(W(D).e("container")),style:xn(W(T))},[W(d)?(De(),Ht(Xo,{key:0,name:"carousel-arrow-left",persisted:""},{default:we(()=>[ci(gt("button",{type:"button",class:ht([W(D).e("arrow"),W(D).em("arrow","left")]),onMouseenter:le[0]||(le[0]=re=>W(S)("left")),onMouseleave:le[1]||(le[1]=(...re)=>W(I)&&W(I)(...re)),onClick:le[2]||(le[2]=si(re=>W(j)(W(f)-1),["stop"]))},[me(W(Hn),null,{default:we(()=>[me(W(UA))]),_:1})],34),[[la,(J.arrow==="always"||W(g))&&(s.loop||W(f)>0)]])]),_:1})):Wt("v-if",!0),W(d)?(De(),Ht(Xo,{key:1,name:"carousel-arrow-right",persisted:""},{default:we(()=>[ci(gt("button",{type:"button",class:ht([W(D).e("arrow"),W(D).em("arrow","right")]),onMouseenter:le[3]||(le[3]=re=>W(S)("right")),onMouseleave:le[4]||(le[4]=(...re)=>W(I)&&W(I)(...re)),onClick:le[5]||(le[5]=si(re=>W(j)(W(f)+1),["stop"]))},[me(W(Hn),null,{default:we(()=>[me(W(mm))]),_:1})],34),[[la,(J.arrow==="always"||W(g))&&(s.loop||W(f)<W(b).length-1)]])]),_:1})):Wt("v-if",!0),me(W(Q)),vr(J.$slots,"default")],6),J.indicatorPosition!=="none"?(De(),yt("ul",{key:0,class:ht(W(ue))},[(De(!0),yt(mn,null,pa(W(b),(re,Fe)=>ci((De(),yt("li",{key:Fe,class:ht([W(D).e("indicator"),W(D).em("indicator",J.direction),W(D).is("active",Fe===W(f))]),onMouseenter:Ye=>W(V)(Fe),onClick:si(Ye=>W(A)(Fe),["stop"])},[gt("button",{class:ht(W(D).e("button"))},[W(p)?(De(),yt("span",aue,Lr(re.props.label),1)):Wt("v-if",!0)],2)],42,iue)),[[la,W(ie)(Fe)]])),128))],2)):Wt("v-if",!0)],34))}});var cue=Hr(lue,[["__file","/home/runner/work/element-plus/element-plus/packages/components/carousel/src/carousel.vue"]]);const uue=rn({name:{type:String,default:""},label:{type:[String,Number],default:""}}),fue=(t,n)=>{const a=Gr(cN),s=Tn(),c=.83,f=Ze(),d=Ze(!1),p=Ze(0),g=Ze(1),y=Ze(!1),b=Ze(!1),E=Ze(!1),T=Ze(!1),{isCardType:S,isVertical:I}=a;function A(N,Q,ie){const j=ie-1,V=Q-1,D=Q+1,te=ie/2;return Q===0&&N===j?-1:Q===j&&N===0?ie:N<V&&Q-N>=te?ie+1:N>D&&N-Q>=te?-2:N}function M(N,Q){var ie,j;const V=W(I)?((ie=a.root.value)==null?void 0:ie.offsetHeight)||0:((j=a.root.value)==null?void 0:j.offsetWidth)||0;return E.value?V*((2-c)*(N-Q)+1)/4:N<Q?-(1+c)*V/4:(3+c)*V/4}function F(N,Q,ie){const j=a.root.value;return j?((ie?j.offsetHeight:j.offsetWidth)||0)*(N-Q):0}const L=(N,Q,ie)=>{var j;const V=W(S),D=(j=a.items.value.length)!=null?j:Number.NaN,te=N===Q;!V&&!au(ie)&&(T.value=te||N===ie),!te&&D>2&&a.loop&&(N=A(N,Q,D));const ue=W(I);y.value=te,V?(E.value=Math.round(Math.abs(N-Q))<=1,p.value=M(N,Q),g.value=W(y)?1:c):p.value=F(N,Q,ue),b.value=!0,te&&f.value&&a.setContainerHeight(f.value.offsetHeight)};function O(){if(a&&W(S)){const N=a.items.value.findIndex(({uid:Q})=>Q===s.uid);a.setActiveItem(N)}}return di(()=>{a.addItem({props:t,states:bo({hover:d,translate:p,scale:g,active:y,ready:b,inStage:E,animating:T}),uid:s.uid,translateItem:L})}),of(()=>{a.removeItem(s.uid)}),{carouselItemRef:f,active:y,animating:T,hover:d,inStage:E,isVertical:I,translate:p,isCardType:S,scale:g,ready:b,handleItemClick:O}},hue=Ft({name:"ElCarouselItem"}),due=Ft({...hue,props:uue,setup(t){const n=t,a=Rr("carousel"),{carouselItemRef:s,active:c,animating:f,hover:d,inStage:p,isVertical:g,translate:y,isCardType:b,scale:E,ready:T,handleItemClick:S}=fue(n),I=Ve(()=>{const M=`${`translate${W(g)?"Y":"X"}`}(${W(y)}px)`,F=`scale(${W(E)})`;return{transform:[M,F].join(" ")}});return(A,M)=>ci((De(),yt("div",{ref_key:"carouselItemRef",ref:s,class:ht([W(a).e("item"),W(a).is("active",W(c)),W(a).is("in-stage",W(p)),W(a).is("hover",W(d)),W(a).is("animating",W(f)),{[W(a).em("item","card")]:W(b),[W(a).em("item","card-vertical")]:W(b)&&W(g)}]),style:xn(W(I)),onClick:M[0]||(M[0]=(...F)=>W(S)&&W(S)(...F))},[W(b)?ci((De(),yt("div",{key:0,class:ht(W(a).e("mask"))},null,2)),[[la,!W(c)]]):Wt("v-if",!0),vr(A.$slots,"default")],6)),[[la,W(T)]])}});var uN=Hr(due,[["__file","/home/runner/work/element-plus/element-plus/packages/components/carousel/src/carousel-item.vue"]]);const pue=ca(cue,{CarouselItem:uN}),mue=Ko(uN),fN={modelValue:{type:[Number,String,Boolean],default:void 0},label:{type:[String,Boolean,Number,Object],default:void 0},indeterminate:Boolean,disabled:Boolean,checked:Boolean,name:{type:String,default:void 0},trueLabel:{type:[String,Number],default:void 0},falseLabel:{type:[String,Number],default:void 0},id:{type:String,default:void 0},controls:{type:String,default:void 0},border:Boolean,size:Rh,tabindex:[String,Number],validateEvent:{type:Boolean,default:!0}},hN={[ma]:t=>Mn(t)||yi(t)||Wo(t),change:t=>Mn(t)||yi(t)||Wo(t)},_m=Symbol("checkboxGroupContextKey"),gue=({model:t,isChecked:n})=>{const a=Gr(_m,void 0),s=Ve(()=>{var f,d;const p=(f=a==null?void 0:a.max)==null?void 0:f.value,g=(d=a==null?void 0:a.min)==null?void 0:d.value;return!au(p)&&t.value.length>=p&&!n.value||!au(g)&&t.value.length<=g&&n.value});return{isDisabled:cu(Ve(()=>(a==null?void 0:a.disabled.value)||s.value)),isLimitDisabled:s}},_ue=(t,{model:n,isLimitExceeded:a,hasOwnLabel:s,isDisabled:c,isLabeledByFormItem:f})=>{const d=Gr(_m,void 0),{formItem:p}=Lh(),{emit:g}=Tn();function y(I){var A,M;return I===t.trueLabel||I===!0?(A=t.trueLabel)!=null?A:!0:(M=t.falseLabel)!=null?M:!1}function b(I,A){g("change",y(I),A)}function E(I){if(a.value)return;const A=I.target;g("change",y(A.checked),I)}async function T(I){a.value||!s.value&&!c.value&&f.value&&(I.composedPath().some(F=>F.tagName==="LABEL")||(n.value=y([!1,t.falseLabel].includes(n.value)),await Fn(),b(n.value,I)))}const S=Ve(()=>(d==null?void 0:d.validateEvent)||t.validateEvent);return gr(()=>t.modelValue,()=>{S.value&&(p==null||p.validate("change").catch(I=>void 0))}),{handleChange:E,onClickRoot:T}},vue=t=>{const n=Ze(!1),{emit:a}=Tn(),s=Gr(_m,void 0),c=Ve(()=>au(s)===!1),f=Ze(!1);return{model:Ve({get(){var p,g;return c.value?(p=s==null?void 0:s.modelValue)==null?void 0:p.value:(g=t.modelValue)!=null?g:n.value},set(p){var g,y;c.value&&Wr(p)?(f.value=((g=s==null?void 0:s.max)==null?void 0:g.value)!==void 0&&p.length>(s==null?void 0:s.max.value),f.value===!1&&((y=s==null?void 0:s.changeEvent)==null||y.call(s,p))):(a(ma,p),n.value=p)}}),isGroup:c,isLimitExceeded:f}},yue=(t,n,{model:a})=>{const s=Gr(_m,void 0),c=Ze(!1),f=Ve(()=>{const y=a.value;return Wo(y)?y:Wr(y)?$n(t.label)?y.map(ti).some(b=>L_(b,t.label)):y.map(ti).includes(t.label):y!=null?y===t.trueLabel:!!y}),d=_c(Ve(()=>{var y;return(y=s==null?void 0:s.size)==null?void 0:y.value}),{prop:!0}),p=_c(Ve(()=>{var y;return(y=s==null?void 0:s.size)==null?void 0:y.value})),g=Ve(()=>!!n.default||!ap(t.label));return{checkboxButtonSize:d,isChecked:f,isFocused:c,checkboxSize:p,hasOwnLabel:g}},xue=(t,{model:n})=>{function a(){Wr(n.value)&&!n.value.includes(t.label)?n.value.push(t.label):n.value=t.trueLabel||!0}t.checked&&a()},dN=(t,n)=>{const{formItem:a}=Lh(),{model:s,isGroup:c,isLimitExceeded:f}=vue(t),{isFocused:d,isChecked:p,checkboxButtonSize:g,checkboxSize:y,hasOwnLabel:b}=yue(t,n,{model:s}),{isDisabled:E}=gue({model:s,isChecked:p}),{inputId:T,isLabeledByFormItem:S}=vv(t,{formItemContext:a,disableIdGeneration:b,disableIdManagement:c}),{handleChange:I,onClickRoot:A}=_ue(t,{model:s,isLimitExceeded:f,hasOwnLabel:b,isDisabled:E,isLabeledByFormItem:S});return xue(t,{model:s}),{inputId:T,isLabeledByFormItem:S,isChecked:p,isDisabled:E,isFocused:d,checkboxButtonSize:g,checkboxSize:y,hasOwnLabel:b,model:s,handleChange:I,onClickRoot:A}},bue=["id","indeterminate","name","tabindex","disabled","true-value","false-value"],wue=["id","indeterminate","disabled","value","name","tabindex"],Eue=Ft({name:"ElCheckbox"}),Tue=Ft({...Eue,props:fN,emits:hN,setup(t){const n=t,a=sf(),{inputId:s,isLabeledByFormItem:c,isChecked:f,isDisabled:d,isFocused:p,checkboxSize:g,hasOwnLabel:y,model:b,handleChange:E,onClickRoot:T}=dN(n,a),S=Rr("checkbox"),I=Ve(()=>[S.b(),S.m(g.value),S.is("disabled",d.value),S.is("bordered",n.border),S.is("checked",f.value)]),A=Ve(()=>[S.e("input"),S.is("disabled",d.value),S.is("checked",f.value),S.is("indeterminate",n.indeterminate),S.is("focus",p.value)]);return(M,F)=>(De(),Ht(Zi(!W(y)&&W(c)?"span":"label"),{class:ht(W(I)),"aria-controls":M.indeterminate?M.controls:null,onClick:W(T)},{default:we(()=>[gt("span",{class:ht(W(A))},[M.trueLabel||M.falseLabel?ci((De(),yt("input",{key:0,id:W(s),"onUpdate:modelValue":F[0]||(F[0]=L=>ai(b)?b.value=L:null),class:ht(W(S).e("original")),type:"checkbox",indeterminate:M.indeterminate,name:M.name,tabindex:M.tabindex,disabled:W(d),"true-value":M.trueLabel,"false-value":M.falseLabel,onChange:F[1]||(F[1]=(...L)=>W(E)&&W(E)(...L)),onFocus:F[2]||(F[2]=L=>p.value=!0),onBlur:F[3]||(F[3]=L=>p.value=!1),onClick:F[4]||(F[4]=si(()=>{},["stop"]))},null,42,bue)),[[$x,W(b)]]):ci((De(),yt("input",{key:1,id:W(s),"onUpdate:modelValue":F[5]||(F[5]=L=>ai(b)?b.value=L:null),class:ht(W(S).e("original")),type:"checkbox",indeterminate:M.indeterminate,disabled:W(d),value:M.label,name:M.name,tabindex:M.tabindex,onChange:F[6]||(F[6]=(...L)=>W(E)&&W(E)(...L)),onFocus:F[7]||(F[7]=L=>p.value=!0),onBlur:F[8]||(F[8]=L=>p.value=!1),onClick:F[9]||(F[9]=si(()=>{},["stop"]))},null,42,wue)),[[$x,W(b)]]),gt("span",{class:ht(W(S).e("inner"))},null,2)],2),W(y)?(De(),yt("span",{key:0,class:ht(W(S).e("label"))},[vr(M.$slots,"default"),M.$slots.default?Wt("v-if",!0):(De(),yt(mn,{key:0},[Sr(Lr(M.label),1)],64))],2)):Wt("v-if",!0)]),_:3},8,["class","aria-controls","onClick"]))}});var Sue=Hr(Tue,[["__file","/home/runner/work/element-plus/element-plus/packages/components/checkbox/src/checkbox.vue"]]);const Cue=["name","tabindex","disabled","true-value","false-value"],Aue=["name","tabindex","disabled","value"],kue=Ft({name:"ElCheckboxButton"}),Iue=Ft({...kue,props:fN,emits:hN,setup(t){const n=t,a=sf(),{isFocused:s,isChecked:c,isDisabled:f,checkboxButtonSize:d,model:p,handleChange:g}=dN(n,a),y=Gr(_m,void 0),b=Rr("checkbox"),E=Ve(()=>{var S,I,A,M;const F=(I=(S=y==null?void 0:y.fill)==null?void 0:S.value)!=null?I:"";return{backgroundColor:F,borderColor:F,color:(M=(A=y==null?void 0:y.textColor)==null?void 0:A.value)!=null?M:"",boxShadow:F?`-1px 0 0 0 ${F}`:void 0}}),T=Ve(()=>[b.b("button"),b.bm("button",d.value),b.is("disabled",f.value),b.is("checked",c.value),b.is("focus",s.value)]);return(S,I)=>(De(),yt("label",{class:ht(W(T))},[S.trueLabel||S.falseLabel?ci((De(),yt("input",{key:0,"onUpdate:modelValue":I[0]||(I[0]=A=>ai(p)?p.value=A:null),class:ht(W(b).be("button","original")),type:"checkbox",name:S.name,tabindex:S.tabindex,disabled:W(f),"true-value":S.trueLabel,"false-value":S.falseLabel,onChange:I[1]||(I[1]=(...A)=>W(g)&&W(g)(...A)),onFocus:I[2]||(I[2]=A=>s.value=!0),onBlur:I[3]||(I[3]=A=>s.value=!1),onClick:I[4]||(I[4]=si(()=>{},["stop"]))},null,42,Cue)),[[$x,W(p)]]):ci((De(),yt("input",{key:1,"onUpdate:modelValue":I[5]||(I[5]=A=>ai(p)?p.value=A:null),class:ht(W(b).be("button","original")),type:"checkbox",name:S.name,tabindex:S.tabindex,disabled:W(f),value:S.label,onChange:I[6]||(I[6]=(...A)=>W(g)&&W(g)(...A)),onFocus:I[7]||(I[7]=A=>s.value=!0),onBlur:I[8]||(I[8]=A=>s.value=!1),onClick:I[9]||(I[9]=si(()=>{},["stop"]))},null,42,Aue)),[[$x,W(p)]]),S.$slots.default||S.label?(De(),yt("span",{key:2,class:ht(W(b).be("button","inner")),style:xn(W(c)?W(E):void 0)},[vr(S.$slots,"default",{},()=>[Sr(Lr(S.label),1)])],6)):Wt("v-if",!0)],2))}});var pN=Hr(Iue,[["__file","/home/runner/work/element-plus/element-plus/packages/components/checkbox/src/checkbox-button.vue"]]);const Mue=rn({modelValue:{type:br(Array),default:()=>[]},disabled:Boolean,min:Number,max:Number,size:Rh,label:String,fill:String,textColor:String,tag:{type:String,default:"div"},validateEvent:{type:Boolean,default:!0}}),Fue={[ma]:t=>Wr(t),change:t=>Wr(t)},Pue=Ft({name:"ElCheckboxGroup"}),Oue=Ft({...Pue,props:Mue,emits:Fue,setup(t,{emit:n}){const a=t,s=Rr("checkbox"),{formItem:c}=Lh(),{inputId:f,isLabeledByFormItem:d}=vv(a,{formItemContext:c}),p=async y=>{n(ma,y),await Fn(),n("change",y)},g=Ve({get(){return a.modelValue},set(y){p(y)}});return Ji(_m,{...yie(yc(a),["size","min","max","disabled","validateEvent","fill","textColor"]),modelValue:g,changeEvent:p}),gr(()=>a.modelValue,()=>{a.validateEvent&&(c==null||c.validate("change").catch(y=>void 0))}),(y,b)=>{var E;return De(),Ht(Zi(y.tag),{id:W(f),class:ht(W(s).b("group")),role:"group","aria-label":W(d)?void 0:y.label||"checkbox-group","aria-labelledby":W(d)?(E=W(c))==null?void 0:E.labelId:void 0},{default:we(()=>[vr(y.$slots,"default")]),_:3},8,["id","class","aria-label","aria-labelledby"])}}});var mN=Hr(Oue,[["__file","/home/runner/work/element-plus/element-plus/packages/components/checkbox/src/checkbox-group.vue"]]);const Q0=ca(Sue,{CheckboxButton:pN,CheckboxGroup:mN});Ko(pN);Ko(mN);const gN=rn({size:Rh,disabled:Boolean,label:{type:[String,Number,Boolean],default:""}}),Rue=rn({...gN,modelValue:{type:[String,Number,Boolean],default:""},name:{type:String,default:""},border:Boolean}),_N={[ma]:t=>Mn(t)||yi(t)||Wo(t),[Ch]:t=>Mn(t)||yi(t)||Wo(t)},vN=Symbol("radioGroupKey"),yN=(t,n)=>{const a=Ze(),s=Gr(vN,void 0),c=Ve(()=>!!s),f=Ve({get(){return c.value?s.modelValue:t.modelValue},set(b){c.value?s.changeEvent(b):n&&n(ma,b),a.value.checked=t.modelValue===t.label}}),d=_c(Ve(()=>s==null?void 0:s.size)),p=cu(Ve(()=>s==null?void 0:s.disabled)),g=Ze(!1),y=Ve(()=>p.value||c.value&&f.value!==t.label?-1:0);return{radioRef:a,isGroup:c,radioGroup:s,focus:g,size:d,disabled:p,tabIndex:y,modelValue:f}},Lue=["value","name","disabled"],Due=Ft({name:"ElRadio"}),Bue=Ft({...Due,props:Rue,emits:_N,setup(t,{emit:n}){const a=t,s=Rr("radio"),{radioRef:c,radioGroup:f,focus:d,size:p,disabled:g,modelValue:y}=yN(a,n);function b(){Fn(()=>n("change",y.value))}return(E,T)=>{var S;return De(),yt("label",{class:ht([W(s).b(),W(s).is("disabled",W(g)),W(s).is("focus",W(d)),W(s).is("bordered",E.border),W(s).is("checked",W(y)===E.label),W(s).m(W(p))])},[gt("span",{class:ht([W(s).e("input"),W(s).is("disabled",W(g)),W(s).is("checked",W(y)===E.label)])},[ci(gt("input",{ref_key:"radioRef",ref:c,"onUpdate:modelValue":T[0]||(T[0]=I=>ai(y)?y.value=I:null),class:ht(W(s).e("original")),value:E.label,name:E.name||((S=W(f))==null?void 0:S.name),disabled:W(g),type:"radio",onFocus:T[1]||(T[1]=I=>d.value=!0),onBlur:T[2]||(T[2]=I=>d.value=!1),onChange:b,onClick:T[3]||(T[3]=si(()=>{},["stop"]))},null,42,Lue),[[f8,W(y)]]),gt("span",{class:ht(W(s).e("inner"))},null,2)],2),gt("span",{class:ht(W(s).e("label")),onKeydown:T[4]||(T[4]=si(()=>{},["stop"]))},[vr(E.$slots,"default",{},()=>[Sr(Lr(E.label),1)])],34)],2)}}});var zue=Hr(Bue,[["__file","/home/runner/work/element-plus/element-plus/packages/components/radio/src/radio.vue"]]);const Nue=rn({...gN,name:{type:String,default:""}}),Uue=["value","name","disabled"],$ue=Ft({name:"ElRadioButton"}),Vue=Ft({...$ue,props:Nue,setup(t){const n=t,a=Rr("radio"),{radioRef:s,focus:c,size:f,disabled:d,modelValue:p,radioGroup:g}=yN(n),y=Ve(()=>({backgroundColor:(g==null?void 0:g.fill)||"",borderColor:(g==null?void 0:g.fill)||"",boxShadow:g!=null&&g.fill?`-1px 0 0 0 ${g.fill}`:"",color:(g==null?void 0:g.textColor)||""}));return(b,E)=>{var T;return De(),yt("label",{class:ht([W(a).b("button"),W(a).is("active",W(p)===b.label),W(a).is("disabled",W(d)),W(a).is("focus",W(c)),W(a).bm("button",W(f))])},[ci(gt("input",{ref_key:"radioRef",ref:s,"onUpdate:modelValue":E[0]||(E[0]=S=>ai(p)?p.value=S:null),class:ht(W(a).be("button","original-radio")),value:b.label,type:"radio",name:b.name||((T=W(g))==null?void 0:T.name),disabled:W(d),onFocus:E[1]||(E[1]=S=>c.value=!0),onBlur:E[2]||(E[2]=S=>c.value=!1),onClick:E[3]||(E[3]=si(()=>{},["stop"]))},null,42,Uue),[[f8,W(p)]]),gt("span",{class:ht(W(a).be("button","inner")),style:xn(W(p)===b.label?W(y):{}),onKeydown:E[4]||(E[4]=si(()=>{},["stop"]))},[vr(b.$slots,"default",{},()=>[Sr(Lr(b.label),1)])],38)],2)}}});var xN=Hr(Vue,[["__file","/home/runner/work/element-plus/element-plus/packages/components/radio/src/radio-button.vue"]]);const jue=rn({id:{type:String,default:void 0},size:Rh,disabled:Boolean,modelValue:{type:[String,Number,Boolean],default:""},fill:{type:String,default:""},label:{type:String,default:void 0},textColor:{type:String,default:""},name:{type:String,default:void 0},validateEvent:{type:Boolean,default:!0}}),Wue=_N,Hue=["id","aria-label","aria-labelledby"],Gue=Ft({name:"ElRadioGroup"}),que=Ft({...Gue,props:jue,emits:Wue,setup(t,{emit:n}){const a=t,s=Rr("radio"),c=gc(),f=Ze(),{formItem:d}=Lh(),{inputId:p,isLabeledByFormItem:g}=vv(a,{formItemContext:d}),y=E=>{n(ma,E),Fn(()=>n("change",E))};di(()=>{const E=f.value.querySelectorAll("[type=radio]"),T=E[0];!Array.from(E).some(S=>S.checked)&&T&&(T.tabIndex=0)});const b=Ve(()=>a.name||c.value);return Ji(vN,bo({...yc(a),changeEvent:y,name:b})),gr(()=>a.modelValue,()=>{a.validateEvent&&(d==null||d.validate("change").catch(E=>void 0))}),(E,T)=>(De(),yt("div",{id:W(p),ref_key:"radioGroupRef",ref:f,class:ht(W(s).b("group")),role:"radiogroup","aria-label":W(g)?void 0:E.label||"radio-group","aria-labelledby":W(g)?W(d).labelId:void 0},[vr(E.$slots,"default")],10,Hue))}});var bN=Hr(que,[["__file","/home/runner/work/element-plus/element-plus/packages/components/radio/src/radio-group.vue"]]);const lk=ca(zue,{RadioButton:xN,RadioGroup:bN}),xv=Ko(bN),wN=Ko(xN),EN=rn({type:{type:String,values:["success","info","warning","danger",""],default:""},closable:Boolean,disableTransitions:Boolean,hit:Boolean,color:{type:String,default:""},size:{type:String,values:op,default:""},effect:{type:String,values:["dark","light","plain"],default:"light"},round:Boolean}),Xue={close:t=>t instanceof MouseEvent,click:t=>t instanceof MouseEvent},Zue=Ft({name:"ElTag"}),Kue=Ft({...Zue,props:EN,emits:Xue,setup(t,{emit:n}){const a=t,s=_c(),c=Rr("tag"),f=Ve(()=>{const{type:g,hit:y,effect:b,closable:E,round:T}=a;return[c.b(),c.is("closable",E),c.m(g),c.m(s.value),c.m(b),c.is("hit",y),c.is("round",T)]}),d=g=>{n("close",g)},p=g=>{n("click",g)};return(g,y)=>g.disableTransitions?(De(),yt("span",{key:0,class:ht(W(f)),style:xn({backgroundColor:g.color}),onClick:p},[gt("span",{class:ht(W(c).e("content"))},[vr(g.$slots,"default")],2),g.closable?(De(),Ht(W(Hn),{key:0,class:ht(W(c).e("close")),onClick:si(d,["stop"])},{default:we(()=>[me(W(Qu))]),_:1},8,["class","onClick"])):Wt("v-if",!0)],6)):(De(),Ht(Xo,{key:1,name:`${W(c).namespace.value}-zoom-in-center`,appear:""},{default:we(()=>[gt("span",{class:ht(W(f)),style:xn({backgroundColor:g.color}),onClick:p},[gt("span",{class:ht(W(c).e("content"))},[vr(g.$slots,"default")],2),g.closable?(De(),Ht(W(Hn),{key:0,class:ht(W(c).e("close")),onClick:si(d,["stop"])},{default:we(()=>[me(W(Qu))]),_:1},8,["class","onClick"])):Wt("v-if",!0)],6)]),_:3},8,["name"]))}});var Yue=Hr(Kue,[["__file","/home/runner/work/element-plus/element-plus/packages/components/tag/src/tag.vue"]]);const Jue=ca(Yue),TN=Symbol("rowContextKey"),Que=["start","center","end","space-around","space-between","space-evenly"],efe=["top","middle","bottom"],tfe=rn({tag:{type:String,default:"div"},gutter:{type:Number,default:0},justify:{type:String,values:Que,default:"start"},align:{type:String,values:efe}}),rfe=Ft({name:"ElRow"}),nfe=Ft({...rfe,props:tfe,setup(t){const n=t,a=Rr("row"),s=Ve(()=>n.gutter);Ji(TN,{gutter:s});const c=Ve(()=>{const d={};return n.gutter&&(d.marginRight=d.marginLeft=`-${n.gutter/2}px`),d}),f=Ve(()=>[a.b(),a.is(`justify-${n.justify}`,n.justify!=="start"),a.is(`align-${n.align}`,!!n.align)]);return(d,p)=>(De(),Ht(Zi(d.tag),{class:ht(W(f)),style:xn(W(c))},{default:we(()=>[vr(d.$slots,"default")]),_:3},8,["class","style"]))}});var ife=Hr(nfe,[["__file","/home/runner/work/element-plus/element-plus/packages/components/row/src/row.vue"]]);const Ll=ca(ife),afe=rn({tag:{type:String,default:"div"},span:{type:Number,default:24},offset:{type:Number,default:0},pull:{type:Number,default:0},push:{type:Number,default:0},xs:{type:br([Number,Object]),default:()=>fs({})},sm:{type:br([Number,Object]),default:()=>fs({})},md:{type:br([Number,Object]),default:()=>fs({})},lg:{type:br([Number,Object]),default:()=>fs({})},xl:{type:br([Number,Object]),default:()=>fs({})}}),ofe=Ft({name:"ElCol"}),sfe=Ft({...ofe,props:afe,setup(t){const n=t,{gutter:a}=Gr(TN,{gutter:Ve(()=>0)}),s=Rr("col"),c=Ve(()=>{const d={};return a.value&&(d.paddingLeft=d.paddingRight=`${a.value/2}px`),d}),f=Ve(()=>{const d=[];return["span","offset","pull","push"].forEach(y=>{const b=n[y];yi(b)&&(y==="span"?d.push(s.b(`${n[y]}`)):b>0&&d.push(s.b(`${y}-${n[y]}`)))}),["xs","sm","md","lg","xl"].forEach(y=>{yi(n[y])?d.push(s.b(`${y}-${n[y]}`)):$n(n[y])&&Object.entries(n[y]).forEach(([b,E])=>{d.push(b!=="span"?s.b(`${y}-${b}-${E}`):s.b(`${y}-${E}`))})}),a.value&&d.push(s.is("guttered")),[s.b(),d]});return(d,p)=>(De(),Ht(Zi(d.tag),{class:ht(W(f)),style:xn(W(c))},{default:we(()=>[vr(d.$slots,"default")]),_:3},8,["class","style"]))}});var lfe=Hr(sfe,[["__file","/home/runner/work/element-plus/element-plus/packages/components/col/src/col.vue"]]);const Ec=ca(lfe),YD=t=>typeof yi(t),cfe=rn({accordion:Boolean,modelValue:{type:br([Array,String,Number]),default:()=>fs([])}}),ufe={[ma]:YD,[Ch]:YD},SN=Symbol("collapseContextKey"),ffe=(t,n)=>{const a=Ze(O_(t.modelValue)),s=f=>{a.value=f;const d=t.accordion?a.value[0]:a.value;n(ma,d),n(Ch,d)},c=f=>{if(t.accordion)s([a.value[0]===f?"":f]);else{const d=[...a.value],p=d.indexOf(f);p>-1?d.splice(p,1):d.push(f),s(d)}};return gr(()=>t.modelValue,()=>a.value=O_(t.modelValue),{deep:!0}),Ji(SN,{activeNames:a,handleItemClick:c}),{activeNames:a,setActiveNames:s}},hfe=()=>{const t=Rr("collapse");return{rootKls:Ve(()=>t.b())}},dfe=Ft({name:"ElCollapse"}),pfe=Ft({...dfe,props:cfe,emits:ufe,setup(t,{expose:n,emit:a}){const s=t,{activeNames:c,setActiveNames:f}=ffe(s,a),{rootKls:d}=hfe();return n({activeNames:c,setActiveNames:f}),(p,g)=>(De(),yt("div",{class:ht(W(d))},[vr(p.$slots,"default")],2))}});var mfe=Hr(pfe,[["__file","/home/runner/work/element-plus/element-plus/packages/components/collapse/src/collapse.vue"]]);const gfe=Ft({name:"ElCollapseTransition"}),_fe=Ft({...gfe,setup(t){const n=Rr("collapse-transition"),a=c=>{c.style.maxHeight="",c.style.overflow=c.dataset.oldOverflow,c.style.paddingTop=c.dataset.oldPaddingTop,c.style.paddingBottom=c.dataset.oldPaddingBottom},s={beforeEnter(c){c.dataset||(c.dataset={}),c.dataset.oldPaddingTop=c.style.paddingTop,c.dataset.oldPaddingBottom=c.style.paddingBottom,c.style.maxHeight=0,c.style.paddingTop=0,c.style.paddingBottom=0},enter(c){c.dataset.oldOverflow=c.style.overflow,c.scrollHeight!==0?c.style.maxHeight=`${c.scrollHeight}px`:c.style.maxHeight=0,c.style.paddingTop=c.dataset.oldPaddingTop,c.style.paddingBottom=c.dataset.oldPaddingBottom,c.style.overflow="hidden"},afterEnter(c){c.style.maxHeight="",c.style.overflow=c.dataset.oldOverflow},enterCancelled(c){a(c)},beforeLeave(c){c.dataset||(c.dataset={}),c.dataset.oldPaddingTop=c.style.paddingTop,c.dataset.oldPaddingBottom=c.style.paddingBottom,c.dataset.oldOverflow=c.style.overflow,c.style.maxHeight=`${c.scrollHeight}px`,c.style.overflow="hidden"},leave(c){c.scrollHeight!==0&&(c.style.maxHeight=0,c.style.paddingTop=0,c.style.paddingBottom=0)},afterLeave(c){a(c)},leaveCancelled(c){a(c)}};return(c,f)=>(De(),Ht(Xo,Ds({name:W(n).b()},xK(s)),{default:we(()=>[vr(c.$slots,"default")]),_:3},16,["name"]))}});var kx=Hr(_fe,[["__file","/home/runner/work/element-plus/element-plus/packages/components/collapse-transition/src/collapse-transition.vue"]]);kx.install=t=>{t.component(kx.name,kx)};const vfe=kx,yfe=rn({title:{type:String,default:""},name:{type:br([String,Number]),default:()=>fz()},disabled:Boolean}),xfe=t=>{const n=Gr(SN),a=Ze(!1),s=Ze(!1),c=Ze(fz()),f=Ve(()=>n==null?void 0:n.activeNames.value.includes(t.name));return{focusing:a,id:c,isActive:f,handleFocus:()=>{setTimeout(()=>{s.value?s.value=!1:a.value=!0},50)},handleHeaderClick:()=>{t.disabled||(n==null||n.handleItemClick(t.name),a.value=!1,s.value=!0)},handleEnterClick:()=>{n==null||n.handleItemClick(t.name)}}},bfe=(t,{focusing:n,isActive:a,id:s})=>{const c=Rr("collapse"),f=Ve(()=>[c.b("item"),c.is("active",W(a)),c.is("disabled",t.disabled)]),d=Ve(()=>[c.be("item","header"),c.is("active",W(a)),{focusing:W(n)&&!t.disabled}]),p=Ve(()=>[c.be("item","arrow"),c.is("active",W(a))]),g=Ve(()=>c.be("item","wrap")),y=Ve(()=>c.be("item","content")),b=Ve(()=>c.b(`content-${W(s)}`)),E=Ve(()=>c.b(`head-${W(s)}`));return{arrowKls:p,headKls:d,rootKls:f,itemWrapperKls:g,itemContentKls:y,scopedContentId:b,scopedHeadId:E}},wfe=["id","aria-expanded","aria-controls","aria-describedby","tabindex"],Efe=["id","aria-hidden","aria-labelledby"],Tfe=Ft({name:"ElCollapseItem"}),Sfe=Ft({...Tfe,props:yfe,setup(t,{expose:n}){const a=t,{focusing:s,id:c,isActive:f,handleFocus:d,handleHeaderClick:p,handleEnterClick:g}=xfe(a),{arrowKls:y,headKls:b,rootKls:E,itemWrapperKls:T,itemContentKls:S,scopedContentId:I,scopedHeadId:A}=bfe(a,{focusing:s,isActive:f,id:c});return n({isActive:f}),(M,F)=>(De(),yt("div",{class:ht(W(E))},[gt("button",{id:W(A),class:ht(W(b)),"aria-expanded":W(f),"aria-controls":W(I),"aria-describedby":W(I),tabindex:M.disabled?-1:0,type:"button",onClick:F[0]||(F[0]=(...L)=>W(p)&&W(p)(...L)),onKeydown:F[1]||(F[1]=Ya(si((...L)=>W(g)&&W(g)(...L),["stop","prevent"]),["space","enter"])),onFocus:F[2]||(F[2]=(...L)=>W(d)&&W(d)(...L)),onBlur:F[3]||(F[3]=L=>s.value=!1)},[vr(M.$slots,"title",{},()=>[Sr(Lr(M.title),1)]),me(W(Hn),{class:ht(W(y))},{default:we(()=>[me(W(mm))]),_:1},8,["class"])],42,wfe),me(W(vfe),null,{default:we(()=>[ci(gt("div",{id:W(I),role:"region",class:ht(W(T)),"aria-hidden":!W(f),"aria-labelledby":W(A)},[gt("div",{class:ht(W(S))},[vr(M.$slots,"default")],2)],10,Efe),[[la,W(f)]])]),_:3})],2))}});var CN=Hr(Sfe,[["__file","/home/runner/work/element-plus/element-plus/packages/components/collapse/src/collapse-item.vue"]]);const Cfe=ca(mfe,{CollapseItem:CN}),Afe=Ko(CN),kfe=Ft({name:"ElContainer"}),Ife=Ft({...kfe,props:{direction:{type:String}},setup(t){const n=t,a=sf(),s=Rr("container"),c=Ve(()=>n.direction==="vertical"?!0:n.direction==="horizontal"?!1:a&&a.default?a.default().some(d=>{const p=d.type.name;return p==="ElHeader"||p==="ElFooter"}):!1);return(f,d)=>(De(),yt("section",{class:ht([W(s).b(),W(s).is("vertical",W(c))])},[vr(f.$slots,"default")],2))}});var Mfe=Hr(Ife,[["__file","/home/runner/work/element-plus/element-plus/packages/components/container/src/container.vue"]]);const Ffe=Ft({name:"ElAside"}),Pfe=Ft({...Ffe,props:{width:{type:String,default:null}},setup(t){const n=t,a=Rr("aside"),s=Ve(()=>n.width?a.cssVarBlock({width:n.width}):{});return(c,f)=>(De(),yt("aside",{class:ht(W(a).b()),style:xn(W(s))},[vr(c.$slots,"default")],6))}});var AN=Hr(Pfe,[["__file","/home/runner/work/element-plus/element-plus/packages/components/container/src/aside.vue"]]);const Ofe=Ft({name:"ElFooter"}),Rfe=Ft({...Ofe,props:{height:{type:String,default:null}},setup(t){const n=t,a=Rr("footer"),s=Ve(()=>n.height?a.cssVarBlock({height:n.height}):{});return(c,f)=>(De(),yt("footer",{class:ht(W(a).b()),style:xn(W(s))},[vr(c.$slots,"default")],6))}});var kN=Hr(Rfe,[["__file","/home/runner/work/element-plus/element-plus/packages/components/container/src/footer.vue"]]);const Lfe=Ft({name:"ElHeader"}),Dfe=Ft({...Lfe,props:{height:{type:String,default:null}},setup(t){const n=t,a=Rr("header"),s=Ve(()=>n.height?a.cssVarBlock({height:n.height}):{});return(c,f)=>(De(),yt("header",{class:ht(W(a).b()),style:xn(W(s))},[vr(c.$slots,"default")],6))}});var IN=Hr(Dfe,[["__file","/home/runner/work/element-plus/element-plus/packages/components/container/src/header.vue"]]);const Bfe=Ft({name:"ElMain"}),zfe=Ft({...Bfe,setup(t){const n=Rr("main");return(a,s)=>(De(),yt("main",{class:ht(W(n).b())},[vr(a.$slots,"default")],2))}});var MN=Hr(zfe,[["__file","/home/runner/work/element-plus/element-plus/packages/components/container/src/main.vue"]]);const Xb=ca(Mfe,{Aside:AN,Footer:kN,Header:IN,Main:MN}),Nfe=Ko(AN);Ko(kN);const Ufe=Ko(IN),Zb=Ko(MN),$fe=rn({mask:{type:Boolean,default:!0},customMaskEvent:{type:Boolean,default:!1},overlayClass:{type:br([String,Array,Object])},zIndex:{type:br([String,Number])}}),Vfe={click:t=>t instanceof MouseEvent},jfe="overlay";var Wfe=Ft({name:"ElOverlay",props:$fe,emits:Vfe,setup(t,{slots:n,emit:a}){const s=Rr(jfe),c=g=>{a("click",g)},{onClick:f,onMousedown:d,onMouseup:p}=QA(t.customMaskEvent?void 0:c);return()=>t.mask?me("div",{class:[s.b(),t.overlayClass],style:{zIndex:t.zIndex},onClick:f,onMousedown:d,onMouseup:p},[vr(n,"default")],wx.STYLE|wx.CLASS|wx.PROPS,["onClick","onMouseup","onMousedown"]):En("div",{class:t.overlayClass,style:{zIndex:t.zIndex,position:"fixed",top:"0px",right:"0px",bottom:"0px",left:"0px"}},[vr(n,"default")])}});const FN=Wfe,PN=Symbol("dialogInjectionKey"),ON=rn({center:Boolean,alignCenter:Boolean,closeIcon:{type:xo},customClass:{type:String,default:""},draggable:Boolean,fullscreen:Boolean,showClose:{type:Boolean,default:!0},title:{type:String,default:""},ariaLevel:{type:String,default:"2"}}),Hfe={close:()=>!0},Gfe=["aria-level"],qfe=["aria-label"],Xfe=["id"],Zfe=Ft({name:"ElDialogContent"}),Kfe=Ft({...Zfe,props:ON,emits:Hfe,setup(t){const n=t,{t:a}=Yo(),{Close:s}=oz,{dialogRef:c,headerRef:f,bodyId:d,ns:p,style:g}=Gr(PN),{focusTrapRef:y}=Gr(Zz),b=Ve(()=>[p.b(),p.is("fullscreen",n.fullscreen),p.is("draggable",n.draggable),p.is("align-center",n.alignCenter),{[p.m("center")]:n.center},n.customClass]),E=vae(y,c),T=Ve(()=>n.draggable);return hz(c,f,T),(S,I)=>(De(),yt("div",{ref:W(E),class:ht(W(b)),style:xn(W(g)),tabindex:"-1"},[gt("header",{ref_key:"headerRef",ref:f,class:ht(W(p).e("header"))},[vr(S.$slots,"header",{},()=>[gt("span",{role:"heading","aria-level":S.ariaLevel,class:ht(W(p).e("title"))},Lr(S.title),11,Gfe)]),S.showClose?(De(),yt("button",{key:0,"aria-label":W(a)("el.dialog.close"),class:ht(W(p).e("headerbtn")),type:"button",onClick:I[0]||(I[0]=A=>S.$emit("close"))},[me(W(Hn),{class:ht(W(p).e("close"))},{default:we(()=>[(De(),Ht(Zi(S.closeIcon||W(s))))]),_:1},8,["class"])],10,qfe)):Wt("v-if",!0)],2),gt("div",{id:W(d),class:ht(W(p).e("body"))},[vr(S.$slots,"default")],10,Xfe),S.$slots.footer?(De(),yt("footer",{key:0,class:ht(W(p).e("footer"))},[vr(S.$slots,"footer")],2)):Wt("v-if",!0)],6))}});var Yfe=Hr(Kfe,[["__file","/home/runner/work/element-plus/element-plus/packages/components/dialog/src/dialog-content.vue"]]);const Jfe=rn({...ON,appendToBody:Boolean,appendTo:{type:br(String),default:"body"},beforeClose:{type:br(Function)},destroyOnClose:Boolean,closeOnClickModal:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},lockScroll:{type:Boolean,default:!0},modal:{type:Boolean,default:!0},openDelay:{type:Number,default:0},closeDelay:{type:Number,default:0},top:{type:String},modelValue:Boolean,modalClass:String,width:{type:[String,Number]},zIndex:{type:Number},trapFocus:{type:Boolean,default:!1},headerAriaLevel:{type:String,default:"2"}}),Qfe={open:()=>!0,opened:()=>!0,close:()=>!0,closed:()=>!0,[ma]:t=>Wo(t),openAutoFocus:()=>!0,closeAutoFocus:()=>!0},ehe=(t,n)=>{var a;const c=Tn().emit,{nextZIndex:f}=jb();let d="";const p=gc(),g=gc(),y=Ze(!1),b=Ze(!1),E=Ze(!1),T=Ze((a=t.zIndex)!=null?a:f());let S,I;const A=Wb("namespace",r_),M=Ve(()=>{const Fe={},Ye=`--${A.value}-dialog`;return t.fullscreen||(t.top&&(Fe[`${Ye}-margin-top`]=t.top),t.width&&(Fe[`${Ye}-width`]=mc(t.width))),Fe}),F=Ve(()=>t.alignCenter?{display:"flex"}:{});function L(){c("opened")}function O(){c("closed"),c(ma,!1),t.destroyOnClose&&(E.value=!1)}function N(){c("close")}function Q(){I==null||I(),S==null||S(),t.openDelay&&t.openDelay>0?{stop:S}=jx(()=>D(),t.openDelay):D()}function ie(){S==null||S(),I==null||I(),t.closeDelay&&t.closeDelay>0?{stop:I}=jx(()=>te(),t.closeDelay):te()}function j(){function Fe(Ye){Ye||(b.value=!0,y.value=!1)}t.beforeClose?t.beforeClose(Fe):ie()}function V(){t.closeOnClickModal&&j()}function D(){Li&&(y.value=!0)}function te(){y.value=!1}function ue(){c("openAutoFocus")}function J(){c("closeAutoFocus")}function le(Fe){var Ye;((Ye=Fe.detail)==null?void 0:Ye.focusReason)==="pointer"&&Fe.preventDefault()}t.lockScroll&&mz(y);function re(){t.closeOnPressEscape&&j()}return gr(()=>t.modelValue,Fe=>{Fe?(b.value=!1,Q(),E.value=!0,T.value=K8(t.zIndex)?f():T.value++,Fn(()=>{c("open"),n.value&&(n.value.scrollTop=0)})):y.value&&ie()}),gr(()=>t.fullscreen,Fe=>{n.value&&(Fe?(d=n.value.style.transform,n.value.style.transform=""):n.value.style.transform=d)}),di(()=>{t.modelValue&&(y.value=!0,E.value=!0,Q())}),{afterEnter:L,afterLeave:O,beforeLeave:N,handleClose:j,onModalClick:V,close:ie,doClose:te,onOpenAutoFocus:ue,onCloseAutoFocus:J,onCloseRequested:re,onFocusoutPrevented:le,titleId:p,bodyId:g,closed:b,style:M,overlayDialogStyle:F,rendered:E,visible:y,zIndex:T}},the=["aria-label","aria-labelledby","aria-describedby"],rhe=Ft({name:"ElDialog",inheritAttrs:!1}),nhe=Ft({...rhe,props:Jfe,emits:Qfe,setup(t,{expose:n}){const a=t,s=sf();q0({scope:"el-dialog",from:"the title slot",replacement:"the header slot",version:"3.0.0",ref:"https://element-plus.org/en-US/component/dialog.html#slots"},Ve(()=>!!s.title)),q0({scope:"el-dialog",from:"custom-class",replacement:"class",version:"2.3.0",ref:"https://element-plus.org/en-US/component/dialog.html#attributes",type:"Attribute"},Ve(()=>!!a.customClass));const c=Rr("dialog"),f=Ze(),d=Ze(),p=Ze(),{visible:g,titleId:y,bodyId:b,style:E,overlayDialogStyle:T,rendered:S,zIndex:I,afterEnter:A,afterLeave:M,beforeLeave:F,handleClose:L,onModalClick:O,onOpenAutoFocus:N,onCloseAutoFocus:Q,onCloseRequested:ie,onFocusoutPrevented:j}=ehe(a,f);Ji(PN,{dialogRef:f,headerRef:d,bodyId:b,ns:c,rendered:S,style:E});const V=QA(O),D=Ve(()=>a.draggable&&!a.fullscreen);return n({visible:g,dialogContentRef:p}),(te,ue)=>(De(),Ht(KB,{to:te.appendTo,disabled:te.appendTo!=="body"?!1:!te.appendToBody},[me(Xo,{name:"dialog-fade",onAfterEnter:W(A),onAfterLeave:W(M),onBeforeLeave:W(F),persisted:""},{default:we(()=>[ci(me(W(FN),{"custom-mask-event":"",mask:te.modal,"overlay-class":te.modalClass,"z-index":W(I)},{default:we(()=>[gt("div",{role:"dialog","aria-modal":"true","aria-label":te.title||void 0,"aria-labelledby":te.title?void 0:W(y),"aria-describedby":W(b),class:ht(`${W(c).namespace.value}-overlay-dialog`),style:xn(W(T)),onClick:ue[0]||(ue[0]=(...J)=>W(V).onClick&&W(V).onClick(...J)),onMousedown:ue[1]||(ue[1]=(...J)=>W(V).onMousedown&&W(V).onMousedown(...J)),onMouseup:ue[2]||(ue[2]=(...J)=>W(V).onMouseup&&W(V).onMouseup(...J))},[me(W(ak),{loop:"",trapped:W(g),"focus-start-el":"container",onFocusAfterTrapped:W(N),onFocusAfterReleased:W(Q),onFocusoutPrevented:W(j),onReleaseRequested:W(ie)},{default:we(()=>[W(S)?(De(),Ht(Yfe,Ds({key:0,ref_key:"dialogContentRef",ref:p},te.$attrs,{"custom-class":te.customClass,center:te.center,"align-center":te.alignCenter,"close-icon":te.closeIcon,draggable:W(D),fullscreen:te.fullscreen,"show-close":te.showClose,title:te.title,"aria-level":te.headerAriaLevel,onClose:W(L)}),T_({header:we(()=>[te.$slots.title?vr(te.$slots,"title",{key:1}):vr(te.$slots,"header",{key:0,close:W(L),titleId:W(y),titleClass:W(c).e("title")})]),default:we(()=>[vr(te.$slots,"default")]),_:2},[te.$slots.footer?{name:"footer",fn:we(()=>[vr(te.$slots,"footer")])}:void 0]),1040,["custom-class","center","align-center","close-icon","draggable","fullscreen","show-close","title","aria-level","onClose"])):Wt("v-if",!0)]),_:3},8,["trapped","onFocusAfterTrapped","onFocusAfterReleased","onFocusoutPrevented","onReleaseRequested"])],46,the)]),_:3},8,["mask","overlay-class","z-index"]),[[la,W(g)]])]),_:3},8,["onAfterEnter","onAfterLeave","onBeforeLeave"])],8,["to","disabled"]))}});var ihe=Hr(nhe,[["__file","/home/runner/work/element-plus/element-plus/packages/components/dialog/src/dialog.vue"]]);const ahe=ca(ihe),ohe=rn({direction:{type:String,values:["horizontal","vertical"],default:"horizontal"},contentPosition:{type:String,values:["left","center","right"],default:"center"},borderStyle:{type:br(String),default:"solid"}}),she=Ft({name:"ElDivider"}),lhe=Ft({...she,props:ohe,setup(t){const n=t,a=Rr("divider"),s=Ve(()=>a.cssVar({"border-style":n.borderStyle}));return(c,f)=>(De(),yt("div",{class:ht([W(a).b(),W(a).m(c.direction)]),style:xn(W(s)),role:"separator"},[c.$slots.default&&c.direction!=="vertical"?(De(),yt("div",{key:0,class:ht([W(a).e("text"),W(a).is(c.contentPosition)])},[vr(c.$slots,"default")],2)):Wt("v-if",!0)],6))}});var che=Hr(lhe,[["__file","/home/runner/work/element-plus/element-plus/packages/components/divider/src/divider.vue"]]);const uhe=ca(che),fhe=Ft({inheritAttrs:!1});function hhe(t,n,a,s,c,f){return vr(t.$slots,"default")}var dhe=Hr(fhe,[["render",hhe],["__file","/home/runner/work/element-plus/element-plus/packages/components/collection/src/collection.vue"]]);const phe=Ft({name:"ElCollectionItem",inheritAttrs:!1});function mhe(t,n,a,s,c,f){return vr(t.$slots,"default")}var ghe=Hr(phe,[["render",mhe],["__file","/home/runner/work/element-plus/element-plus/packages/components/collection/src/collection-item.vue"]]);const _he="data-el-collection-item",vhe=t=>{const n=`El${t}Collection`,a=`${n}Item`,s=Symbol(n),c=Symbol(a),f={...dhe,name:n,setup(){const p=Ze(null),g=new Map;Ji(s,{itemMap:g,getItems:()=>{const b=W(p);if(!b)return[];const E=Array.from(b.querySelectorAll(`[${_he}]`));return[...g.values()].sort((S,I)=>E.indexOf(S.ref)-E.indexOf(I.ref))},collectionRef:p})}},d={...ghe,name:a,setup(p,{attrs:g}){const y=Ze(null),b=Gr(s,void 0);Ji(c,{collectionItemRef:y}),di(()=>{const E=W(y);E&&b.itemMap.set(E,{ref:E,...g})}),to(()=>{const E=W(y);b.itemMap.delete(E)})}};return{COLLECTION_INJECTION_KEY:s,COLLECTION_ITEM_INJECTION_KEY:c,ElCollection:f,ElCollectionItem:d}},nS=rn({trigger:U_.trigger,effect:{...rl.effect,default:"light"},type:{type:br(String)},placement:{type:br(String),default:"bottom"},popperOptions:{type:br(Object),default:()=>({})},id:String,size:{type:String,default:""},splitButton:Boolean,hideOnClick:{type:Boolean,default:!0},loop:{type:Boolean,default:!0},showTimeout:{type:Number,default:150},hideTimeout:{type:Number,default:150},tabindex:{type:br([Number,String]),default:0},maxHeight:{type:br([Number,String]),default:""},popperClass:{type:String,default:""},disabled:{type:Boolean,default:!1},role:{type:String,default:"menu"},buttonProps:{type:br(Object)},teleported:rl.teleported});rn({command:{type:[Object,String,Number],default:()=>({})},disabled:Boolean,divided:Boolean,textValue:String,icon:{type:xo}});rn({onKeydown:{type:br(Function)}});vhe("Dropdown");const yhe={viewBox:"0 0 79 86",version:"1.1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink"},xhe=["id"],bhe=["stop-color"],whe=["stop-color"],Ehe=["id"],The=["stop-color"],She=["stop-color"],Che=["id"],Ahe={id:"Illustrations",stroke:"none","stroke-width":"1",fill:"none","fill-rule":"evenodd"},khe={id:"B-type",transform:"translate(-1268.000000, -535.000000)"},Ihe={id:"Group-2",transform:"translate(1268.000000, 535.000000)"},Mhe=["fill"],Fhe=["fill"],Phe={id:"Group-Copy",transform:"translate(34.500000, 31.500000) scale(-1, 1) rotate(-25.000000) translate(-34.500000, -31.500000) translate(7.000000, 10.000000)"},Ohe=["fill"],Rhe=["fill"],Lhe=["fill"],Dhe=["fill"],Bhe=["fill"],zhe={id:"Rectangle-Copy-17",transform:"translate(53.000000, 45.000000)"},Nhe=["fill","xlink:href"],Uhe=["fill","mask"],$he=["fill"],Vhe=Ft({name:"ImgEmpty"}),jhe=Ft({...Vhe,setup(t){const n=Rr("empty"),a=gc();return(s,c)=>(De(),yt("svg",yhe,[gt("defs",null,[gt("linearGradient",{id:`linearGradient-1-${W(a)}`,x1:"38.8503086%",y1:"0%",x2:"61.1496914%",y2:"100%"},[gt("stop",{"stop-color":`var(${W(n).cssVarBlockName("fill-color-1")})`,offset:"0%"},null,8,bhe),gt("stop",{"stop-color":`var(${W(n).cssVarBlockName("fill-color-4")})`,offset:"100%"},null,8,whe)],8,xhe),gt("linearGradient",{id:`linearGradient-2-${W(a)}`,x1:"0%",y1:"9.5%",x2:"100%",y2:"90.5%"},[gt("stop",{"stop-color":`var(${W(n).cssVarBlockName("fill-color-1")})`,offset:"0%"},null,8,The),gt("stop",{"stop-color":`var(${W(n).cssVarBlockName("fill-color-6")})`,offset:"100%"},null,8,She)],8,Ehe),gt("rect",{id:`path-3-${W(a)}`,x:"0",y:"0",width:"17",height:"36"},null,8,Che)]),gt("g",Ahe,[gt("g",khe,[gt("g",Ihe,[gt("path",{id:"Oval-Copy-2",d:"M39.5,86 C61.3152476,86 79,83.9106622 79,81.3333333 C79,78.7560045 57.3152476,78 35.5,78 C13.6847524,78 0,78.7560045 0,81.3333333 C0,83.9106622 17.6847524,86 39.5,86 Z",fill:`var(${W(n).cssVarBlockName("fill-color-3")})`},null,8,Mhe),gt("polygon",{id:"Rectangle-Copy-14",fill:`var(${W(n).cssVarBlockName("fill-color-7")})`,transform:"translate(27.500000, 51.500000) scale(1, -1) translate(-27.500000, -51.500000) ",points:"13 58 53 58 42 45 2 45"},null,8,Fhe),gt("g",Phe,[gt("polygon",{id:"Rectangle-Copy-10",fill:`var(${W(n).cssVarBlockName("fill-color-7")})`,transform:"translate(11.500000, 5.000000) scale(1, -1) translate(-11.500000, -5.000000) ",points:"2.84078316e-14 3 18 3 23 7 5 7"},null,8,Ohe),gt("polygon",{id:"Rectangle-Copy-11",fill:`var(${W(n).cssVarBlockName("fill-color-5")})`,points:"-3.69149156e-15 7 38 7 38 43 -3.69149156e-15 43"},null,8,Rhe),gt("rect",{id:"Rectangle-Copy-12",fill:`url(#linearGradient-1-${W(a)})`,transform:"translate(46.500000, 25.000000) scale(-1, 1) translate(-46.500000, -25.000000) ",x:"38",y:"7",width:"17",height:"36"},null,8,Lhe),gt("polygon",{id:"Rectangle-Copy-13",fill:`var(${W(n).cssVarBlockName("fill-color-2")})`,transform:"translate(39.500000, 3.500000) scale(-1, 1) translate(-39.500000, -3.500000) ",points:"24 7 41 7 55 -3.63806207e-12 38 -3.63806207e-12"},null,8,Dhe)]),gt("rect",{id:"Rectangle-Copy-15",fill:`url(#linearGradient-2-${W(a)})`,x:"13",y:"45",width:"40",height:"36"},null,8,Bhe),gt("g",zhe,[gt("use",{id:"Mask",fill:`var(${W(n).cssVarBlockName("fill-color-8")})`,transform:"translate(8.500000, 18.000000) scale(-1, 1) translate(-8.500000, -18.000000) ","xlink:href":`#path-3-${W(a)}`},null,8,Nhe),gt("polygon",{id:"Rectangle-Copy",fill:`var(${W(n).cssVarBlockName("fill-color-9")})`,mask:`url(#mask-4-${W(a)})`,transform:"translate(12.000000, 9.000000) scale(-1, 1) translate(-12.000000, -9.000000) ",points:"7 0 24 0 20 18 7 16.5"},null,8,Uhe)]),gt("polygon",{id:"Rectangle-Copy-18",fill:`var(${W(n).cssVarBlockName("fill-color-2")})`,transform:"translate(66.000000, 51.500000) scale(-1, 1) translate(-66.000000, -51.500000) ",points:"62 45 79 45 70 58 53 58"},null,8,$he)])])])]))}});var Whe=Hr(jhe,[["__file","/home/runner/work/element-plus/element-plus/packages/components/empty/src/img-empty.vue"]]);const Hhe=rn({image:{type:String,default:""},imageSize:Number,description:{type:String,default:""}}),Ghe=["src"],qhe={key:1},Xhe=Ft({name:"ElEmpty"}),Zhe=Ft({...Xhe,props:Hhe,setup(t){const n=t,{t:a}=Yo(),s=Rr("empty"),c=Ve(()=>n.description||a("el.table.emptyText")),f=Ve(()=>({width:mc(n.imageSize)}));return(d,p)=>(De(),yt("div",{class:ht(W(s).b())},[gt("div",{class:ht(W(s).e("image")),style:xn(W(f))},[d.image?(De(),yt("img",{key:0,src:d.image,ondragstart:"return false"},null,8,Ghe)):vr(d.$slots,"image",{key:1},()=>[me(Whe)])],6),gt("div",{class:ht(W(s).e("description"))},[d.$slots.description?vr(d.$slots,"description",{key:0}):(De(),yt("p",qhe,Lr(W(c)),1))],2),d.$slots.default?(De(),yt("div",{key:0,class:ht(W(s).e("bottom"))},[vr(d.$slots,"default")],2)):Wt("v-if",!0)],2))}});var Khe=Hr(Zhe,[["__file","/home/runner/work/element-plus/element-plus/packages/components/empty/src/empty.vue"]]);const Yhe=ca(Khe),RN=Symbol("elPaginationKey"),Jhe=rn({disabled:Boolean,currentPage:{type:Number,default:1},prevText:{type:String},prevIcon:{type:xo}}),Qhe={click:t=>t instanceof MouseEvent},ede=["disabled","aria-label","aria-disabled"],tde={key:0},rde=Ft({name:"ElPaginationPrev"}),nde=Ft({...rde,props:Jhe,emits:Qhe,setup(t){const n=t,{t:a}=Yo(),s=Ve(()=>n.disabled||n.currentPage<=1);return(c,f)=>(De(),yt("button",{type:"button",class:"btn-prev",disabled:W(s),"aria-label":c.prevText||W(a)("el.pagination.prev"),"aria-disabled":W(s),onClick:f[0]||(f[0]=d=>c.$emit("click",d))},[c.prevText?(De(),yt("span",tde,Lr(c.prevText),1)):(De(),Ht(W(Hn),{key:1},{default:we(()=>[(De(),Ht(Zi(c.prevIcon)))]),_:1}))],8,ede))}});var ide=Hr(nde,[["__file","/home/runner/work/element-plus/element-plus/packages/components/pagination/src/components/prev.vue"]]);const ade=rn({disabled:Boolean,currentPage:{type:Number,default:1},pageCount:{type:Number,default:50},nextText:{type:String},nextIcon:{type:xo}}),ode=["disabled","aria-label","aria-disabled"],sde={key:0},lde=Ft({name:"ElPaginationNext"}),cde=Ft({...lde,props:ade,emits:["click"],setup(t){const n=t,{t:a}=Yo(),s=Ve(()=>n.disabled||n.currentPage===n.pageCount||n.pageCount===0);return(c,f)=>(De(),yt("button",{type:"button",class:"btn-next",disabled:W(s),"aria-label":c.nextText||W(a)("el.pagination.next"),"aria-disabled":W(s),onClick:f[0]||(f[0]=d=>c.$emit("click",d))},[c.nextText?(De(),yt("span",sde,Lr(c.nextText),1)):(De(),Ht(W(Hn),{key:1},{default:we(()=>[(De(),Ht(Zi(c.nextIcon)))]),_:1}))],8,ode))}});var ude=Hr(cde,[["__file","/home/runner/work/element-plus/element-plus/packages/components/pagination/src/components/next.vue"]]);const LN=Symbol("ElSelectGroup"),Kb=Symbol("ElSelect");function fde(t,n){const a=Gr(Kb),s=Gr(LN,{disabled:!1}),c=Ve(()=>$n(t.value)),f=Ve(()=>a.props.multiple?E(a.props.modelValue,t.value):T(t.value,a.props.modelValue)),d=Ve(()=>{if(a.props.multiple){const A=a.props.modelValue||[];return!f.value&&A.length>=a.props.multipleLimit&&a.props.multipleLimit>0}else return!1}),p=Ve(()=>t.label||(c.value?"":t.value)),g=Ve(()=>t.value||t.label||""),y=Ve(()=>t.disabled||n.groupDisabled||d.value),b=Tn(),E=(A=[],M)=>{if(c.value){const F=a.props.valueKey;return A&&A.some(L=>ti(Bo(L,F))===Bo(M,F))}else return A&&A.includes(M)},T=(A,M)=>{if(c.value){const{valueKey:F}=a.props;return Bo(A,F)===Bo(M,F)}else return A===M},S=()=>{!t.disabled&&!s.disabled&&(a.hoverIndex=a.optionsArray.indexOf(b.proxy))};gr(()=>p.value,()=>{!t.created&&!a.props.remote&&a.setSelected()}),gr(()=>t.value,(A,M)=>{const{remote:F,valueKey:L}=a.props;if(Object.is(A,M)||(a.onOptionDestroy(M,b.proxy),a.onOptionCreate(b.proxy)),!t.created&&!F){if(L&&$n(A)&&$n(M)&&A[L]===M[L])return;a.setSelected()}}),gr(()=>s.disabled,()=>{n.groupDisabled=s.disabled},{immediate:!0});const{queryChange:I}=ti(a);return gr(I,A=>{const{query:M}=W(A),F=new RegExp(Eie(M),"i");n.visible=F.test(p.value)||t.created,n.visible||a.filteredOptionsCount--},{immediate:!0}),{select:a,currentLabel:p,currentValue:g,itemSelected:f,isDisabled:y,hoverItem:S}}const hde=Ft({name:"ElOption",componentName:"ElOption",props:{value:{required:!0,type:[String,Number,Boolean,Object]},label:[String,Number],created:Boolean,disabled:Boolean},setup(t){const n=Rr("select"),a=gc(),s=Ve(()=>[n.be("dropdown","item"),n.is("disabled",W(p)),{selected:W(d),hover:W(E)}]),c=bo({index:-1,groupDisabled:!1,visible:!0,hitState:!1,hover:!1}),{currentLabel:f,itemSelected:d,isDisabled:p,select:g,hoverItem:y}=fde(t,c),{visible:b,hover:E}=yc(c),T=Tn().proxy;g.onOptionCreate(T),to(()=>{const I=T.value,{selected:A}=g,F=(g.props.multiple?A:[A]).some(L=>L.value===T.value);Fn(()=>{g.cachedOptions.get(I)===T&&!F&&g.cachedOptions.delete(I)}),g.onOptionDestroy(I,T)});function S(){t.disabled!==!0&&c.groupDisabled!==!0&&g.handleOptionSelect(T)}return{ns:n,id:a,containerKls:s,currentLabel:f,itemSelected:d,isDisabled:p,select:g,hoverItem:y,visible:b,hover:E,selectOptionClick:S,states:c}}}),dde=["id","aria-disabled","aria-selected"];function pde(t,n,a,s,c,f){return ci((De(),yt("li",{id:t.id,class:ht(t.containerKls),role:"option","aria-disabled":t.isDisabled||void 0,"aria-selected":t.itemSelected,onMouseenter:n[0]||(n[0]=(...d)=>t.hoverItem&&t.hoverItem(...d)),onClick:n[1]||(n[1]=si((...d)=>t.selectOptionClick&&t.selectOptionClick(...d),["stop"]))},[vr(t.$slots,"default",{},()=>[gt("span",null,Lr(t.currentLabel),1)])],42,dde)),[[la,t.visible]])}var ck=Hr(hde,[["render",pde],["__file","/home/runner/work/element-plus/element-plus/packages/components/select/src/option.vue"]]);const mde=Ft({name:"ElSelectDropdown",componentName:"ElSelectDropdown",setup(){const t=Gr(Kb),n=Rr("select"),a=Ve(()=>t.props.popperClass),s=Ve(()=>t.props.multiple),c=Ve(()=>t.props.fitInputWidth),f=Ze("");function d(){var p;f.value=`${(p=t.selectWrapper)==null?void 0:p.offsetWidth}px`}return di(()=>{d(),dc(t.selectWrapper,d)}),{ns:n,minWidth:f,popperClass:a,isMultiple:s,isFitInputWidth:c}}});function gde(t,n,a,s,c,f){return De(),yt("div",{class:ht([t.ns.b("dropdown"),t.ns.is("multiple",t.isMultiple),t.popperClass]),style:xn({[t.isFitInputWidth?"width":"minWidth"]:t.minWidth})},[t.$slots.header?(De(),yt("div",{key:0,class:ht(t.ns.be("dropdown","header"))},[vr(t.$slots,"header")],2)):Wt("v-if",!0),vr(t.$slots,"default"),t.$slots.footer?(De(),yt("div",{key:1,class:ht(t.ns.be("dropdown","footer"))},[vr(t.$slots,"footer")],2)):Wt("v-if",!0)],6)}var _de=Hr(mde,[["render",gde],["__file","/home/runner/work/element-plus/element-plus/packages/components/select/src/select-dropdown.vue"]]);function vde(t){const{t:n}=Yo();return bo({options:new Map,cachedOptions:new Map,disabledOptions:new Map,createdLabel:null,createdSelected:!1,selected:t.multiple?[]:{},inputLength:20,inputWidth:0,optionsCount:0,filteredOptionsCount:0,visible:!1,selectedLabel:"",hoverIndex:-1,query:"",previousQuery:null,inputHovering:!1,cachedPlaceHolder:"",currentPlaceholder:n("el.select.placeholder"),menuVisibleOnFocus:!1,isOnComposition:!1,prefixWidth:11,mouseEnter:!1,focused:!1})}const yde=(t,n,a)=>{const{t:s}=Yo(),c=Rr("select");q0({from:"suffixTransition",replacement:"override style scheme",version:"2.3.0",scope:"props",ref:"https://element-plus.org/en-US/component/select.html#select-attributes"},Ve(()=>t.suffixTransition===!1));const f=Ze(null),d=Ze(null),p=Ze(null),g=Ze(null),y=Ze(null),b=Ze(null),E=Ze(null),T=Ze(null),S=Ze(),I=Rs({query:""}),A=Rs(""),M=Ze([]);let F=0;const{form:L,formItem:O}=Lh(),N=Ve(()=>!t.filterable||t.multiple||!n.visible),Q=Ve(()=>t.disabled||(L==null?void 0:L.disabled)),ie=Ve(()=>{const Le=t.multiple?Array.isArray(t.modelValue)&&t.modelValue.length>0:t.modelValue!==void 0&&t.modelValue!==null&&t.modelValue!=="";return t.clearable&&!Q.value&&n.inputHovering&&Le}),j=Ve(()=>t.remote&&t.filterable&&!t.remoteShowSuffix?"":t.suffixIcon),V=Ve(()=>c.is("reverse",j.value&&n.visible&&t.suffixTransition)),D=Ve(()=>(L==null?void 0:L.statusIcon)&&(O==null?void 0:O.validateState)&&lz[O==null?void 0:O.validateState]),te=Ve(()=>t.remote?300:0),ue=Ve(()=>t.loading?t.loadingText||s("el.select.loading"):t.remote&&n.query===""&&n.options.size===0?!1:t.filterable&&n.query&&n.options.size>0&&n.filteredOptionsCount===0?t.noMatchText||s("el.select.noMatch"):n.options.size===0?t.noDataText||s("el.select.noData"):null),J=Ve(()=>{const Le=Array.from(n.options.values()),lt=[];return M.value.forEach(xt=>{const Ot=Le.findIndex(jt=>jt.currentLabel===xt);Ot>-1&&lt.push(Le[Ot])}),lt.length>=Le.length?lt:Le}),le=Ve(()=>Array.from(n.cachedOptions.values())),re=Ve(()=>{const Le=J.value.filter(lt=>!lt.created).some(lt=>lt.currentLabel===n.query);return t.filterable&&t.allowCreate&&n.query!==""&&!Le}),Fe=_c(),Ye=Ve(()=>["small"].includes(Fe.value)?"small":"default"),Ee=Ve({get(){return n.visible&&ue.value!==!1},set(Le){n.visible=Le}});gr([()=>Q.value,()=>Fe.value,()=>L==null?void 0:L.size],()=>{Fn(()=>{ut()})}),gr(()=>t.placeholder,Le=>{n.cachedPlaceHolder=n.currentPlaceholder=Le,t.multiple&&Array.isArray(t.modelValue)&&t.modelValue.length>0&&(n.currentPlaceholder="")}),gr(()=>t.modelValue,(Le,lt)=>{t.multiple&&(ut(),Le&&Le.length>0||d.value&&n.query!==""?n.currentPlaceholder="":n.currentPlaceholder=n.cachedPlaceHolder,t.filterable&&!t.reserveKeyword&&(n.query="",Ne(n.query))),Pe(),t.filterable&&!t.multiple&&(n.inputLength=20),!L_(Le,lt)&&t.validateEvent&&(O==null||O.validate("change").catch(xt=>void 0))},{flush:"post",deep:!0}),gr(()=>n.visible,Le=>{var lt,xt,Ot,jt,qt;Le?((xt=(lt=g.value)==null?void 0:lt.updatePopper)==null||xt.call(lt),t.filterable&&(n.filteredOptionsCount=n.optionsCount,n.query=t.remote?"":n.selectedLabel,(jt=(Ot=p.value)==null?void 0:Ot.focus)==null||jt.call(Ot),t.multiple?(qt=d.value)==null||qt.focus():n.selectedLabel&&(n.currentPlaceholder=`${n.selectedLabel}`,n.selectedLabel=""),Ne(n.query),!t.multiple&&!t.remote&&(I.value.query="",Rg(I),Rg(A)))):(t.filterable&&(Yr(t.filterMethod)&&t.filterMethod(""),Yr(t.remoteMethod)&&t.remoteMethod("")),n.query="",n.previousQuery=null,n.selectedLabel="",n.inputLength=20,n.menuVisibleOnFocus=!1,et(),Fn(()=>{d.value&&d.value.value===""&&n.selected.length===0&&(n.currentPlaceholder=n.cachedPlaceHolder)}),t.multiple||(n.selected&&(t.filterable&&t.allowCreate&&n.createdSelected&&n.createdLabel?n.selectedLabel=n.createdLabel:n.selectedLabel=n.selected.currentLabel,t.filterable&&(n.query=n.selectedLabel)),t.filterable&&(n.currentPlaceholder=n.cachedPlaceHolder))),a.emit("visible-change",Le)}),gr(()=>n.options.entries(),()=>{var Le,lt,xt;if(!Li)return;(lt=(Le=g.value)==null?void 0:Le.updatePopper)==null||lt.call(Le),t.multiple&&ut();const Ot=((xt=E.value)==null?void 0:xt.querySelectorAll("input"))||[];(!t.filterable&&!t.defaultFirstOption&&!au(t.modelValue)||!Array.from(Ot).includes(document.activeElement))&&Pe(),t.defaultFirstOption&&(t.filterable||t.remote)&&n.filteredOptionsCount&&Oe()},{flush:"post"}),gr(()=>n.hoverIndex,Le=>{yi(Le)&&Le>-1?S.value=J.value[Le]||{}:S.value={},J.value.forEach(lt=>{lt.hover=S.value===lt})});const ut=()=>{Fn(()=>{var Le,lt;if(!f.value)return;const xt=f.value.$el.querySelector("input");F=F||(xt.clientHeight>0?xt.clientHeight+2:0);const Ot=b.value,jt=getComputedStyle(xt).getPropertyValue(c.cssVarName("input-height")),qt=Number.parseFloat(jt)||xae(Fe.value||(L==null?void 0:L.size)),Jt=Fe.value||qt===F||F<=0?qt:F;!(xt.offsetParent===null)&&(xt.style.height=`${(n.selected.length===0?Jt:Math.max(Ot?Ot.clientHeight+(Ot.clientHeight>Jt?6:0):0,Jt))-2}px`),n.visible&&ue.value!==!1&&((lt=(Le=g.value)==null?void 0:Le.updatePopper)==null||lt.call(Le))})},Ne=async Le=>{if(!(n.previousQuery===Le||n.isOnComposition)){if(n.previousQuery===null&&(Yr(t.filterMethod)||Yr(t.remoteMethod))){n.previousQuery=Le;return}n.previousQuery=Le,Fn(()=>{var lt,xt;n.visible&&((xt=(lt=g.value)==null?void 0:lt.updatePopper)==null||xt.call(lt))}),n.hoverIndex=-1,t.multiple&&t.filterable&&Fn(()=>{if(!Q.value){const lt=d.value.value.length*15+20;n.inputLength=t.collapseTags?Math.min(50,lt):lt,He()}ut()}),t.remote&&Yr(t.remoteMethod)?(n.hoverIndex=-1,t.remoteMethod(Le)):Yr(t.filterMethod)?(t.filterMethod(Le),Rg(A)):(n.filteredOptionsCount=n.optionsCount,I.value.query=Le,Rg(I),Rg(A)),t.defaultFirstOption&&(t.filterable||t.remote)&&n.filteredOptionsCount&&(await Fn(),Oe())}},He=()=>{n.currentPlaceholder!==""&&(n.currentPlaceholder=d.value.value?"":n.cachedPlaceHolder)},Oe=()=>{const Le=J.value.filter(Ot=>Ot.visible&&!Ot.disabled&&!Ot.states.groupDisabled),lt=Le.find(Ot=>Ot.created),xt=Le[0];n.hoverIndex=he(J.value,lt||xt)},Pe=()=>{var Le;if(t.multiple)n.selectedLabel="";else{const xt=rt(t.modelValue);(Le=xt.props)!=null&&Le.created?(n.createdLabel=xt.props.value,n.createdSelected=!0):n.createdSelected=!1,n.selectedLabel=xt.currentLabel,n.selected=xt,t.filterable&&(n.query=n.selectedLabel);return}const lt=[];Array.isArray(t.modelValue)&&t.modelValue.forEach(xt=>{lt.push(rt(xt))}),n.selected=lt,Fn(()=>{ut()})},rt=Le=>{let lt;const xt=gx(Le).toLowerCase()==="object",Ot=gx(Le).toLowerCase()==="null",jt=gx(Le).toLowerCase()==="undefined";for(let Xt=n.cachedOptions.size-1;Xt>=0;Xt--){const or=le.value[Xt];if(xt?Bo(or.value,t.valueKey)===Bo(Le,t.valueKey):or.value===Le){lt={value:Le,currentLabel:or.currentLabel,isDisabled:or.isDisabled};break}}if(lt)return lt;const qt=xt?Le.label:!Ot&&!jt?Le:"",Jt={value:Le,currentLabel:qt};return t.multiple&&(Jt.hitState=!1),Jt},et=()=>{setTimeout(()=>{const Le=t.valueKey;t.multiple?n.selected.length>0?n.hoverIndex=Math.min.apply(null,n.selected.map(lt=>J.value.findIndex(xt=>Bo(xt,Le)===Bo(lt,Le)))):n.hoverIndex=-1:n.hoverIndex=J.value.findIndex(lt=>dr(lt)===dr(n.selected))},300)},Ge=()=>{var Le,lt;ze(),(lt=(Le=g.value)==null?void 0:Le.updatePopper)==null||lt.call(Le),t.multiple&&ut()},ze=()=>{var Le;n.inputWidth=(Le=f.value)==null?void 0:Le.$el.offsetWidth},oe=()=>{t.filterable&&n.query!==n.selectedLabel&&(n.query=n.selectedLabel,Ne(n.query))},Me=Gd(()=>{oe()},te.value),fe=Gd(Le=>{Ne(Le.target.value)},te.value),pe=Le=>{L_(t.modelValue,Le)||a.emit(Ch,Le)},ot=Le=>fie(Le,lt=>!n.disabledOptions.has(lt)),xe=Le=>{if(Le.code!==ds.delete){if(Le.target.value.length<=0&&!ye()){const lt=t.modelValue.slice(),xt=ot(lt);if(xt<0)return;lt.splice(xt,1),a.emit(ma,lt),pe(lt)}Le.target.value.length===1&&t.modelValue.length===0&&(n.currentPlaceholder=n.cachedPlaceHolder)}},ae=(Le,lt)=>{const xt=n.selected.indexOf(lt);if(xt>-1&&!Q.value){const Ot=t.modelValue.slice();Ot.splice(xt,1),a.emit(ma,Ot),pe(Ot),a.emit("remove-tag",lt.value)}Le.stopPropagation(),ct()},X=Le=>{Le.stopPropagation();const lt=t.multiple?[]:"";if(!Mn(lt))for(const xt of n.selected)xt.isDisabled&&lt.push(xt.value);a.emit(ma,lt),pe(lt),n.hoverIndex=-1,n.visible=!1,a.emit("clear"),ct()},Ce=Le=>{var lt;if(t.multiple){const xt=(t.modelValue||[]).slice(),Ot=he(xt,Le.value);Ot>-1?xt.splice(Ot,1):(t.multipleLimit<=0||xt.length<t.multipleLimit)&&xt.push(Le.value),a.emit(ma,xt),pe(xt),Le.created&&(n.query="",Ne(""),n.inputLength=20),t.filterable&&((lt=d.value)==null||lt.focus())}else a.emit(ma,Le.value),pe(Le.value),n.visible=!1;G(),!n.visible&&Fn(()=>{K(Le)})},he=(Le=[],lt)=>{if(!$n(lt))return Le.indexOf(lt);const xt=t.valueKey;let Ot=-1;return Le.some((jt,qt)=>ti(Bo(jt,xt))===Bo(lt,xt)?(Ot=qt,!0):!1),Ot},G=()=>{const Le=d.value||f.value;Le&&(Le==null||Le.focus())},K=Le=>{var lt,xt,Ot,jt,qt;const Jt=Array.isArray(Le)?Le[0]:Le;let Xt=null;if(Jt!=null&&Jt.value){const or=J.value.filter(er=>er.value===Jt.value);or.length>0&&(Xt=or[0].$el)}if(g.value&&Xt){const or=(jt=(Ot=(xt=(lt=g.value)==null?void 0:lt.popperRef)==null?void 0:xt.contentRef)==null?void 0:Ot.querySelector)==null?void 0:jt.call(Ot,`.${c.be("dropdown","wrap")}`);or&&Aie(or,Xt)}(qt=T.value)==null||qt.handleScroll()},se=Le=>{n.optionsCount++,n.filteredOptionsCount++,n.options.set(Le.value,Le),n.cachedOptions.set(Le.value,Le),Le.disabled&&n.disabledOptions.set(Le.value,Le)},Ae=(Le,lt)=>{n.options.get(Le)===lt&&(n.optionsCount--,n.filteredOptionsCount--,n.options.delete(Le))},Se=Le=>{Le.code!==ds.backspace&&ye(!1),n.inputLength=d.value.value.length*15+20,ut()},ye=Le=>{if(!Array.isArray(n.selected))return;const lt=ot(n.selected.map(Ot=>Ot.value)),xt=n.selected[lt];if(xt)return Le===!0||Le===!1?(xt.hitState=Le,Le):(xt.hitState=!xt.hitState,xt.hitState)},Xe=Le=>{const lt=Le.target.value;if(Le.type==="compositionend")n.isOnComposition=!1,Fn(()=>Ne(lt));else{const xt=lt[lt.length-1]||"";n.isOnComposition=!uz(xt)}},be=()=>{Fn(()=>K(n.selected))},Be=Le=>{n.focused||((t.automaticDropdown||t.filterable)&&(t.filterable&&!n.visible&&(n.menuVisibleOnFocus=!0),n.visible=!0),n.focused=!0,a.emit("focus",Le))},ct=()=>{var Le,lt;n.visible?(Le=d.value||f.value)==null||Le.focus():(lt=f.value)==null||lt.focus()},At=()=>{var Le,lt,xt;n.visible=!1,(Le=f.value)==null||Le.blur(),(xt=(lt=p.value)==null?void 0:lt.blur)==null||xt.call(lt)},$t=Le=>{var lt,xt,Ot;(lt=g.value)!=null&&lt.isFocusInsideContent(Le)||(xt=y.value)!=null&&xt.isFocusInsideContent(Le)||(Ot=E.value)!=null&&Ot.contains(Le.relatedTarget)||(n.visible&&Nt(),n.focused=!1,a.emit("blur",Le))},mr=Le=>{X(Le)},Nt=()=>{n.visible=!1},Lt=Le=>{n.visible&&(Le.preventDefault(),Le.stopPropagation(),n.visible=!1)},Qt=Le=>{Le&&!n.mouseEnter||Q.value||(n.menuVisibleOnFocus?n.menuVisibleOnFocus=!1:(!g.value||!g.value.isFocusInsideContent())&&(n.visible=!n.visible),ct())},Gt=()=>{n.visible?J.value[n.hoverIndex]&&Ce(J.value[n.hoverIndex]):Qt()},dr=Le=>$n(Le.value)?Bo(Le.value,t.valueKey):Le.value,Br=Ve(()=>J.value.filter(Le=>Le.visible).every(Le=>Le.disabled)),qr=Ve(()=>t.multiple?n.selected.slice(0,t.maxCollapseTags):[]),Ci=Ve(()=>t.multiple?n.selected.slice(t.maxCollapseTags):[]),Wi=Le=>{if(!n.visible){n.visible=!0;return}if(!(n.options.size===0||n.filteredOptionsCount===0)&&!n.isOnComposition&&!Br.value){Le==="next"?(n.hoverIndex++,n.hoverIndex===n.options.size&&(n.hoverIndex=0)):Le==="prev"&&(n.hoverIndex--,n.hoverIndex<0&&(n.hoverIndex=n.options.size-1));const lt=J.value[n.hoverIndex];(lt.disabled===!0||lt.states.groupDisabled===!0||!lt.visible)&&Wi(Le),Fn(()=>K(S.value))}},Fi=()=>{n.mouseEnter=!0},Ta=()=>{n.mouseEnter=!1},Sa=(Le,lt)=>{var xt,Ot;ae(Le,lt),(Ot=(xt=y.value)==null?void 0:xt.updatePopper)==null||Ot.call(xt)},Ai=Ve(()=>({maxWidth:`${W(n.inputWidth)-32-(D.value?22:0)}px`,width:"100%"}));return{optionList:M,optionsArray:J,hoverOption:S,selectSize:Fe,handleResize:Ge,debouncedOnInputChange:Me,debouncedQueryChange:fe,deletePrevTag:xe,deleteTag:ae,deleteSelected:X,handleOptionSelect:Ce,scrollToOption:K,readonly:N,resetInputHeight:ut,showClose:ie,iconComponent:j,iconReverse:V,showNewOption:re,collapseTagSize:Ye,setSelected:Pe,managePlaceholder:He,selectDisabled:Q,emptyText:ue,toggleLastOptionHitState:ye,resetInputState:Se,handleComposition:Xe,onOptionCreate:se,onOptionDestroy:Ae,handleMenuEnter:be,handleFocus:Be,focus:ct,blur:At,handleBlur:$t,handleClearClick:mr,handleClose:Nt,handleKeydownEscape:Lt,toggleMenu:Qt,selectOption:Gt,getValueKey:dr,navigateOptions:Wi,handleDeleteTooltipTag:Sa,dropMenuVisible:Ee,queryChange:I,groupQueryChange:A,showTagList:qr,collapseTagList:Ci,selectTagsStyle:Ai,reference:f,input:d,iOSInput:p,tooltipRef:g,tagTooltipRef:y,tags:b,selectWrapper:E,scrollbar:T,handleMouseEnter:Fi,handleMouseLeave:Ta}};var xde=Ft({name:"ElOptions",emits:["update-options"],setup(t,{slots:n,emit:a}){let s=[];function c(f,d){if(f.length!==d.length)return!1;for(const[p]of f.entries())if(f[p]!=d[p])return!1;return!0}return()=>{var f,d;const p=(f=n.default)==null?void 0:f.call(n),g=[];function y(b){Array.isArray(b)&&b.forEach(E=>{var T,S,I,A;const M=(T=(E==null?void 0:E.type)||{})==null?void 0:T.name;M==="ElOptionGroup"?y(!Mn(E.children)&&!Array.isArray(E.children)&&Yr((S=E.children)==null?void 0:S.default)?(I=E.children)==null?void 0:I.default():E.children):M==="ElOption"?g.push((A=E.props)==null?void 0:A.label):Array.isArray(E.children)&&y(E.children)})}return p.length&&y((d=p[0])==null?void 0:d.children),c(g,s)||(s=g,a("update-options",g)),p}}});const JD="ElSelect",bde=Ft({name:JD,componentName:JD,components:{ElInput:uf,ElSelectMenu:_de,ElOption:ck,ElOptions:xde,ElTag:Jue,ElScrollbar:Dh,ElTooltip:sk,ElIcon:Hn},directives:{ClickOutside:tN},props:{name:String,id:String,modelValue:{type:[Array,String,Number,Boolean,Object],default:void 0},autocomplete:{type:String,default:"off"},automaticDropdown:Boolean,size:{type:String,validator:jA},effect:{type:String,default:"light"},disabled:Boolean,clearable:Boolean,filterable:Boolean,allowCreate:Boolean,loading:Boolean,popperClass:{type:String,default:""},popperOptions:{type:Object,default:()=>({})},remote:Boolean,loadingText:String,noMatchText:String,noDataText:String,remoteMethod:Function,filterMethod:Function,multiple:Boolean,multipleLimit:{type:Number,default:0},placeholder:{type:String},defaultFirstOption:Boolean,reserveKeyword:{type:Boolean,default:!0},valueKey:{type:String,default:"value"},collapseTags:Boolean,collapseTagsTooltip:Boolean,maxCollapseTags:{type:Number,default:1},teleported:rl.teleported,persistent:{type:Boolean,default:!0},clearIcon:{type:xo,default:zb},fitInputWidth:Boolean,suffixIcon:{type:xo,default:ez},tagType:{...EN.type,default:"info"},validateEvent:{type:Boolean,default:!0},remoteShowSuffix:Boolean,suffixTransition:{type:Boolean,default:!0},placement:{type:String,values:$b,default:"bottom-start"},ariaLabel:{type:String,default:void 0}},emits:[ma,Ch,"remove-tag","clear","visible-change","focus","blur"],setup(t,n){const a=Rr("select"),s=Rr("input"),{t:c}=Yo(),f=gc(),d=vde(t),{optionList:p,optionsArray:g,hoverOption:y,selectSize:b,readonly:E,handleResize:T,collapseTagSize:S,debouncedOnInputChange:I,debouncedQueryChange:A,deletePrevTag:M,deleteTag:F,deleteSelected:L,handleOptionSelect:O,scrollToOption:N,setSelected:Q,resetInputHeight:ie,managePlaceholder:j,showClose:V,selectDisabled:D,iconComponent:te,iconReverse:ue,showNewOption:J,emptyText:le,toggleLastOptionHitState:re,resetInputState:Fe,handleComposition:Ye,onOptionCreate:Ee,onOptionDestroy:ut,handleMenuEnter:Ne,handleFocus:He,focus:Oe,blur:Pe,handleBlur:rt,handleClearClick:et,handleClose:Ge,handleKeydownEscape:ze,toggleMenu:oe,selectOption:Me,getValueKey:fe,navigateOptions:pe,handleDeleteTooltipTag:ot,dropMenuVisible:xe,reference:ae,input:X,iOSInput:Ce,tooltipRef:he,tagTooltipRef:G,tags:K,selectWrapper:se,scrollbar:Ae,queryChange:Se,groupQueryChange:ye,handleMouseEnter:Xe,handleMouseLeave:be,showTagList:Be,collapseTagList:ct,selectTagsStyle:At}=yde(t,d,n),{inputWidth:$t,selected:mr,inputLength:Nt,filteredOptionsCount:Lt,visible:Qt,selectedLabel:Gt,hoverIndex:dr,query:Br,inputHovering:qr,currentPlaceholder:Ci,menuVisibleOnFocus:Wi,isOnComposition:Fi,options:Ta,cachedOptions:Sa,optionsCount:Ai,prefixWidth:Le}=yc(d),lt=Ve(()=>{const fn=[a.b()],Cr=W(b);return Cr&&fn.push(a.m(Cr)),t.disabled&&fn.push(a.m("disabled")),fn}),xt=Ve(()=>[a.e("tags"),a.is("disabled",W(D))]),Ot=Ve(()=>[a.b("tags-wrapper"),{"has-prefix":W(Le)&&W(mr).length}]),jt=Ve(()=>[a.e("input"),a.is(W(b)),a.is("disabled",W(D))]),qt=Ve(()=>[a.e("input"),a.is(W(b)),a.em("input","iOS")]),Jt=Ve(()=>[a.is("empty",!t.allowCreate&&!!W(Br)&&W(Lt)===0)]),Xt=Ve(()=>({maxWidth:`${W($t)>123&&W(mr).length>t.maxCollapseTags?W($t)-123:W($t)-75}px`})),or=Ve(()=>({marginLeft:`${W(Le)}px`,flexGrow:1,width:`${W(Nt)/(W($t)-32)}%`,maxWidth:`${W($t)-42}px`}));Ji(Kb,bo({props:t,options:Ta,optionsArray:g,cachedOptions:Sa,optionsCount:Ai,filteredOptionsCount:Lt,hoverIndex:dr,handleOptionSelect:O,onOptionCreate:Ee,onOptionDestroy:ut,selectWrapper:se,selected:mr,setSelected:Q,queryChange:Se,groupQueryChange:ye})),di(()=>{d.cachedPlaceHolder=Ci.value=t.placeholder||(()=>c("el.select.placeholder")),t.multiple&&Array.isArray(t.modelValue)&&t.modelValue.length>0&&(Ci.value=""),dc(se,T),t.remote&&t.multiple&&ie(),Fn(()=>{const fn=ae.value&&ae.value.$el;if(fn&&($t.value=fn.getBoundingClientRect().width,n.slots.prefix)){const Cr=fn.querySelector(`.${s.e("prefix")}`);Le.value=Math.max(Cr.getBoundingClientRect().width+11,30)}}),Q()}),t.multiple&&!Array.isArray(t.modelValue)&&n.emit(ma,[]),!t.multiple&&Array.isArray(t.modelValue)&&n.emit(ma,"");const er=Ve(()=>{var fn,Cr;return(Cr=(fn=he.value)==null?void 0:fn.popperRef)==null?void 0:Cr.contentRef});return{isIOS:y8,onOptionsRendered:fn=>{p.value=fn},prefixWidth:Le,selectSize:b,readonly:E,handleResize:T,collapseTagSize:S,debouncedOnInputChange:I,debouncedQueryChange:A,deletePrevTag:M,deleteTag:F,handleDeleteTooltipTag:ot,deleteSelected:L,handleOptionSelect:O,scrollToOption:N,inputWidth:$t,selected:mr,inputLength:Nt,filteredOptionsCount:Lt,visible:Qt,selectedLabel:Gt,hoverIndex:dr,query:Br,inputHovering:qr,currentPlaceholder:Ci,menuVisibleOnFocus:Wi,isOnComposition:Fi,options:Ta,resetInputHeight:ie,managePlaceholder:j,showClose:V,selectDisabled:D,iconComponent:te,iconReverse:ue,showNewOption:J,emptyText:le,toggleLastOptionHitState:re,resetInputState:Fe,handleComposition:Ye,handleMenuEnter:Ne,handleFocus:He,focus:Oe,blur:Pe,handleBlur:rt,handleClearClick:et,handleClose:Ge,handleKeydownEscape:ze,toggleMenu:oe,selectOption:Me,getValueKey:fe,navigateOptions:pe,dropMenuVisible:xe,reference:ae,input:X,iOSInput:Ce,tooltipRef:he,popperPaneRef:er,tags:K,selectWrapper:se,scrollbar:Ae,wrapperKls:lt,tagsKls:xt,tagWrapperKls:Ot,inputKls:jt,iOSInputKls:qt,scrollbarKls:Jt,selectTagsStyle:At,nsSelect:a,tagTextStyle:Xt,inputStyle:or,handleMouseEnter:Xe,handleMouseLeave:be,showTagList:Be,collapseTagList:ct,tagTooltipRef:G,contentId:f,hoverOption:y}}}),wde=["disabled","autocomplete","aria-activedescendant","aria-controls","aria-expanded","aria-label"],Ede=["disabled"],Tde={style:{height:"100%",display:"flex","justify-content":"center","align-items":"center"}};function Sde(t,n,a,s,c,f){const d=Vi("el-tag"),p=Vi("el-tooltip"),g=Vi("el-icon"),y=Vi("el-input"),b=Vi("el-option"),E=Vi("el-options"),T=Vi("el-scrollbar"),S=Vi("el-select-menu"),I=dA("click-outside");return ci((De(),yt("div",{ref:"selectWrapper",class:ht(t.wrapperKls),onMouseenter:n[22]||(n[22]=(...A)=>t.handleMouseEnter&&t.handleMouseEnter(...A)),onMouseleave:n[23]||(n[23]=(...A)=>t.handleMouseLeave&&t.handleMouseLeave(...A)),onClick:n[24]||(n[24]=si((...A)=>t.toggleMenu&&t.toggleMenu(...A),["stop"]))},[me(p,{ref:"tooltipRef",visible:t.dropMenuVisible,placement:t.placement,teleported:t.teleported,"popper-class":[t.nsSelect.e("popper"),t.popperClass],"popper-options":t.popperOptions,"fallback-placements":["bottom-start","top-start","right","left"],effect:t.effect,pure:"",trigger:"click",transition:`${t.nsSelect.namespace.value}-zoom-in-top`,"stop-popper-mouse-event":!1,"gpu-acceleration":!1,persistent:t.persistent,onShow:t.handleMenuEnter},{default:we(()=>{var A,M;return[gt("div",{class:"select-trigger",onMouseenter:n[20]||(n[20]=F=>t.inputHovering=!0),onMouseleave:n[21]||(n[21]=F=>t.inputHovering=!1)},[t.multiple?(De(),yt("div",{key:0,ref:"tags",tabindex:"-1",class:ht(t.tagsKls),style:xn(t.selectTagsStyle),onClick:n[15]||(n[15]=(...F)=>t.focus&&t.focus(...F))},[t.collapseTags&&t.selected.length?(De(),Ht(Xo,{key:0,onAfterLeave:t.resetInputHeight},{default:we(()=>[gt("span",{class:ht(t.tagWrapperKls)},[(De(!0),yt(mn,null,pa(t.showTagList,F=>(De(),Ht(d,{key:t.getValueKey(F),closable:!t.selectDisabled&&!F.isDisabled,size:t.collapseTagSize,hit:F.hitState,type:t.tagType,"disable-transitions":"",onClose:L=>t.deleteTag(L,F)},{default:we(()=>[gt("span",{class:ht(t.nsSelect.e("tags-text")),style:xn(t.tagTextStyle)},Lr(F.currentLabel),7)]),_:2},1032,["closable","size","hit","type","onClose"]))),128)),t.selected.length>t.maxCollapseTags?(De(),Ht(d,{key:0,closable:!1,size:t.collapseTagSize,type:t.tagType,"disable-transitions":""},{default:we(()=>[t.collapseTagsTooltip?(De(),Ht(p,{key:0,ref:"tagTooltipRef",disabled:t.dropMenuVisible,"fallback-placements":["bottom","top","right","left"],effect:t.effect,placement:"bottom",teleported:t.teleported},{default:we(()=>[gt("span",{class:ht(t.nsSelect.e("tags-text"))},"+ "+Lr(t.selected.length-t.maxCollapseTags),3)]),content:we(()=>[gt("div",{class:ht(t.nsSelect.e("collapse-tags"))},[(De(!0),yt(mn,null,pa(t.collapseTagList,F=>(De(),yt("div",{key:t.getValueKey(F),class:ht(t.nsSelect.e("collapse-tag"))},[me(d,{class:"in-tooltip",closable:!t.selectDisabled&&!F.isDisabled,size:t.collapseTagSize,hit:F.hitState,type:t.tagType,"disable-transitions":"",style:{margin:"2px"},onClose:L=>t.handleDeleteTooltipTag(L,F)},{default:we(()=>[gt("span",{class:ht(t.nsSelect.e("tags-text")),style:xn({maxWidth:t.inputWidth-75+"px"})},Lr(F.currentLabel),7)]),_:2},1032,["closable","size","hit","type","onClose"])],2))),128))],2)]),_:1},8,["disabled","effect","teleported"])):(De(),yt("span",{key:1,class:ht(t.nsSelect.e("tags-text"))},"+ "+Lr(t.selected.length-t.maxCollapseTags),3))]),_:1},8,["size","type"])):Wt("v-if",!0)],2)]),_:1},8,["onAfterLeave"])):Wt("v-if",!0),t.collapseTags?Wt("v-if",!0):(De(),Ht(Xo,{key:1,onAfterLeave:t.resetInputHeight},{default:we(()=>[gt("span",{class:ht(t.tagWrapperKls),style:xn(t.prefixWidth&&t.selected.length?{marginLeft:`${t.prefixWidth}px`}:"")},[(De(!0),yt(mn,null,pa(t.selected,F=>(De(),Ht(d,{key:t.getValueKey(F),closable:!t.selectDisabled&&!F.isDisabled,size:t.collapseTagSize,hit:F.hitState,type:t.tagType,"disable-transitions":"",onClose:L=>t.deleteTag(L,F)},{default:we(()=>[gt("span",{class:ht(t.nsSelect.e("tags-text")),style:xn({maxWidth:t.inputWidth-75+"px"})},Lr(F.currentLabel),7)]),_:2},1032,["closable","size","hit","type","onClose"]))),128))],6)]),_:1},8,["onAfterLeave"])),t.filterable&&!t.selectDisabled?ci((De(),yt("input",{key:2,ref:"input","onUpdate:modelValue":n[0]||(n[0]=F=>t.query=F),type:"text",class:ht(t.inputKls),disabled:t.selectDisabled,autocomplete:t.autocomplete,style:xn(t.inputStyle),role:"combobox","aria-activedescendant":((A=t.hoverOption)==null?void 0:A.id)||"","aria-controls":t.contentId,"aria-expanded":t.dropMenuVisible,"aria-label":t.ariaLabel,"aria-autocomplete":"none","aria-haspopup":"listbox",onFocus:n[1]||(n[1]=(...F)=>t.handleFocus&&t.handleFocus(...F)),onBlur:n[2]||(n[2]=(...F)=>t.handleBlur&&t.handleBlur(...F)),onKeyup:n[3]||(n[3]=(...F)=>t.managePlaceholder&&t.managePlaceholder(...F)),onKeydown:[n[4]||(n[4]=(...F)=>t.resetInputState&&t.resetInputState(...F)),n[5]||(n[5]=Ya(si(F=>t.navigateOptions("next"),["prevent"]),["down"])),n[6]||(n[6]=Ya(si(F=>t.navigateOptions("prev"),["prevent"]),["up"])),n[7]||(n[7]=Ya((...F)=>t.handleKeydownEscape&&t.handleKeydownEscape(...F),["esc"])),n[8]||(n[8]=Ya(si((...F)=>t.selectOption&&t.selectOption(...F),["stop","prevent"]),["enter"])),n[9]||(n[9]=Ya((...F)=>t.deletePrevTag&&t.deletePrevTag(...F),["delete"])),n[10]||(n[10]=Ya(F=>t.visible=!1,["tab"]))],onCompositionstart:n[11]||(n[11]=(...F)=>t.handleComposition&&t.handleComposition(...F)),onCompositionupdate:n[12]||(n[12]=(...F)=>t.handleComposition&&t.handleComposition(...F)),onCompositionend:n[13]||(n[13]=(...F)=>t.handleComposition&&t.handleComposition(...F)),onInput:n[14]||(n[14]=(...F)=>t.debouncedQueryChange&&t.debouncedQueryChange(...F))},null,46,wde)),[[kY,t.query]]):Wt("v-if",!0)],6)):Wt("v-if",!0),t.isIOS&&!t.multiple&&t.filterable&&t.readonly?(De(),yt("input",{key:1,ref:"iOSInput",class:ht(t.iOSInputKls),disabled:t.selectDisabled,type:"text"},null,10,Ede)):Wt("v-if",!0),me(y,{id:t.id,ref:"reference",modelValue:t.selectedLabel,"onUpdate:modelValue":n[16]||(n[16]=F=>t.selectedLabel=F),type:"text",placeholder:typeof t.currentPlaceholder=="function"?t.currentPlaceholder():t.currentPlaceholder,name:t.name,autocomplete:t.autocomplete,size:t.selectSize,disabled:t.selectDisabled,readonly:t.readonly,"validate-event":!1,class:ht([t.nsSelect.is("focus",t.visible)]),tabindex:t.multiple&&t.filterable?-1:void 0,role:"combobox","aria-activedescendant":((M=t.hoverOption)==null?void 0:M.id)||"","aria-controls":t.contentId,"aria-expanded":t.dropMenuVisible,label:t.ariaLabel,"aria-autocomplete":"none","aria-haspopup":"listbox",onFocus:t.handleFocus,onBlur:t.handleBlur,onInput:t.debouncedOnInputChange,onPaste:t.debouncedOnInputChange,onCompositionstart:t.handleComposition,onCompositionupdate:t.handleComposition,onCompositionend:t.handleComposition,onKeydown:[n[17]||(n[17]=Ya(si(F=>t.navigateOptions("next"),["stop","prevent"]),["down"])),n[18]||(n[18]=Ya(si(F=>t.navigateOptions("prev"),["stop","prevent"]),["up"])),Ya(si(t.selectOption,["stop","prevent"]),["enter"]),Ya(t.handleKeydownEscape,["esc"]),n[19]||(n[19]=Ya(F=>t.visible=!1,["tab"]))]},T_({suffix:we(()=>[t.iconComponent&&!t.showClose?(De(),Ht(g,{key:0,class:ht([t.nsSelect.e("caret"),t.nsSelect.e("icon"),t.iconReverse])},{default:we(()=>[(De(),Ht(Zi(t.iconComponent)))]),_:1},8,["class"])):Wt("v-if",!0),t.showClose&&t.clearIcon?(De(),Ht(g,{key:1,class:ht([t.nsSelect.e("caret"),t.nsSelect.e("icon")]),onClick:t.handleClearClick},{default:we(()=>[(De(),Ht(Zi(t.clearIcon)))]),_:1},8,["class","onClick"])):Wt("v-if",!0)]),_:2},[t.$slots.prefix?{name:"prefix",fn:we(()=>[gt("div",Tde,[vr(t.$slots,"prefix")])])}:void 0]),1032,["id","modelValue","placeholder","name","autocomplete","size","disabled","readonly","class","tabindex","aria-activedescendant","aria-controls","aria-expanded","label","onFocus","onBlur","onInput","onPaste","onCompositionstart","onCompositionupdate","onCompositionend","onKeydown"])],32)]}),content:we(()=>[me(S,null,T_({default:we(()=>[ci(me(T,{id:t.contentId,ref:"scrollbar",tag:"ul","wrap-class":t.nsSelect.be("dropdown","wrap"),"view-class":t.nsSelect.be("dropdown","list"),class:ht(t.scrollbarKls),role:"listbox","aria-label":t.ariaLabel,"aria-orientation":"vertical"},{default:we(()=>[t.showNewOption?(De(),Ht(b,{key:0,value:t.query,created:!0},null,8,["value"])):Wt("v-if",!0),me(E,{onUpdateOptions:t.onOptionsRendered},{default:we(()=>[vr(t.$slots,"default")]),_:3},8,["onUpdateOptions"])]),_:3},8,["id","wrap-class","view-class","class","aria-label"]),[[la,t.options.size>0&&!t.loading]]),t.emptyText&&(!t.allowCreate||t.loading||t.allowCreate&&t.options.size===0)?(De(),yt(mn,{key:0},[t.$slots.empty?vr(t.$slots,"empty",{key:0}):(De(),yt("p",{key:1,class:ht(t.nsSelect.be("dropdown","empty"))},Lr(t.emptyText),3))],64)):Wt("v-if",!0)]),_:2},[t.$slots.header?{name:"header",fn:we(()=>[vr(t.$slots,"header")])}:void 0,t.$slots.footer?{name:"footer",fn:we(()=>[vr(t.$slots,"footer")])}:void 0]),1024)]),_:3},8,["visible","placement","teleported","popper-class","popper-options","effect","transition","persistent","onShow"])],34)),[[I,t.handleClose,t.popperPaneRef]])}var Cde=Hr(bde,[["render",Sde],["__file","/home/runner/work/element-plus/element-plus/packages/components/select/src/select.vue"]]);const Ade=Ft({name:"ElOptionGroup",componentName:"ElOptionGroup",props:{label:String,disabled:Boolean},setup(t){const n=Rr("select"),a=Ze(!0),s=Tn(),c=Ze([]);Ji(LN,bo({...yc(t)}));const f=Gr(Kb);di(()=>{c.value=d(s.subTree)});const d=g=>{const y=[];return Array.isArray(g.children)&&g.children.forEach(b=>{var E;b.type&&b.type.name==="ElOption"&&b.component&&b.component.proxy?y.push(b.component.proxy):(E=b.children)!=null&&E.length&&y.push(...d(b))}),y},{groupQueryChange:p}=ti(f);return gr(p,()=>{a.value=c.value.some(g=>g.visible===!0)},{flush:"post"}),{visible:a,ns:n}}});function kde(t,n,a,s,c,f){return ci((De(),yt("ul",{class:ht(t.ns.be("group","wrap"))},[gt("li",{class:ht(t.ns.be("group","title"))},Lr(t.label),3),gt("li",null,[gt("ul",{class:ht(t.ns.b("group"))},[vr(t.$slots,"default")],2)])],2)),[[la,t.visible]])}var DN=Hr(Ade,[["render",kde],["__file","/home/runner/work/element-plus/element-plus/packages/components/select/src/option-group.vue"]]);const Yb=ca(Cde,{Option:ck,OptionGroup:DN}),Jb=Ko(ck);Ko(DN);const uk=()=>Gr(RN,{}),Ide=rn({pageSize:{type:Number,required:!0},pageSizes:{type:br(Array),default:()=>fs([10,20,30,40,50,100])},popperClass:{type:String},disabled:Boolean,teleported:Boolean,size:{type:String,values:op}}),Mde=Ft({name:"ElPaginationSizes"}),Fde=Ft({...Mde,props:Ide,emits:["page-size-change"],setup(t,{emit:n}){const a=t,{t:s}=Yo(),c=Rr("pagination"),f=uk(),d=Ze(a.pageSize);gr(()=>a.pageSizes,(y,b)=>{if(!L_(y,b)&&Array.isArray(y)){const E=y.includes(a.pageSize)?a.pageSize:a.pageSizes[0];n("page-size-change",E)}}),gr(()=>a.pageSize,y=>{d.value=y});const p=Ve(()=>a.pageSizes);function g(y){var b;y!==d.value&&(d.value=y,(b=f.handleSizeChange)==null||b.call(f,Number(y)))}return(y,b)=>(De(),yt("span",{class:ht(W(c).e("sizes"))},[me(W(Yb),{"model-value":d.value,disabled:y.disabled,"popper-class":y.popperClass,size:y.size,teleported:y.teleported,"validate-event":!1,onChange:g},{default:we(()=>[(De(!0),yt(mn,null,pa(W(p),E=>(De(),Ht(W(Jb),{key:E,value:E,label:E+W(s)("el.pagination.pagesize")},null,8,["value","label"]))),128))]),_:1},8,["model-value","disabled","popper-class","size","teleported"])],2))}});var Pde=Hr(Fde,[["__file","/home/runner/work/element-plus/element-plus/packages/components/pagination/src/components/sizes.vue"]]);const Ode=rn({size:{type:String,values:op}}),Rde=["disabled"],Lde=Ft({name:"ElPaginationJumper"}),Dde=Ft({...Lde,props:Ode,setup(t){const{t:n}=Yo(),a=Rr("pagination"),{pageCount:s,disabled:c,currentPage:f,changeEvent:d}=uk(),p=Ze(),g=Ve(()=>{var E;return(E=p.value)!=null?E:f==null?void 0:f.value});function y(E){p.value=E?+E:""}function b(E){E=Math.trunc(+E),d==null||d(E),p.value=void 0}return(E,T)=>(De(),yt("span",{class:ht(W(a).e("jump")),disabled:W(c)},[gt("span",{class:ht([W(a).e("goto")])},Lr(W(n)("el.pagination.goto")),3),me(W(uf),{size:E.size,class:ht([W(a).e("editor"),W(a).is("in-pagination")]),min:1,max:W(s),disabled:W(c),"model-value":W(g),"validate-event":!1,label:W(n)("el.pagination.page"),type:"number","onUpdate:modelValue":y,onChange:b},null,8,["size","class","max","disabled","model-value","label"]),gt("span",{class:ht([W(a).e("classifier")])},Lr(W(n)("el.pagination.pageClassifier")),3)],10,Rde))}});var Bde=Hr(Dde,[["__file","/home/runner/work/element-plus/element-plus/packages/components/pagination/src/components/jumper.vue"]]);const zde=rn({total:{type:Number,default:1e3}}),Nde=["disabled"],Ude=Ft({name:"ElPaginationTotal"}),$de=Ft({...Ude,props:zde,setup(t){const{t:n}=Yo(),a=Rr("pagination"),{disabled:s}=uk();return(c,f)=>(De(),yt("span",{class:ht(W(a).e("total")),disabled:W(s)},Lr(W(n)("el.pagination.total",{total:c.total})),11,Nde))}});var Vde=Hr($de,[["__file","/home/runner/work/element-plus/element-plus/packages/components/pagination/src/components/total.vue"]]);const jde=rn({currentPage:{type:Number,default:1},pageCount:{type:Number,required:!0},pagerCount:{type:Number,default:7},disabled:Boolean}),Wde=["onKeyup"],Hde=["aria-current","aria-label","tabindex"],Gde=["tabindex","aria-label"],qde=["aria-current","aria-label","tabindex"],Xde=["tabindex","aria-label"],Zde=["aria-current","aria-label","tabindex"],Kde=Ft({name:"ElPaginationPager"}),Yde=Ft({...Kde,props:jde,emits:["change"],setup(t,{emit:n}){const a=t,s=Rr("pager"),c=Rr("icon"),{t:f}=Yo(),d=Ze(!1),p=Ze(!1),g=Ze(!1),y=Ze(!1),b=Ze(!1),E=Ze(!1),T=Ve(()=>{const N=a.pagerCount,Q=(N-1)/2,ie=Number(a.currentPage),j=Number(a.pageCount);let V=!1,D=!1;j>N&&(ie>N-Q&&(V=!0),ie<j-Q&&(D=!0));const te=[];if(V&&!D){const ue=j-(N-2);for(let J=ue;J<j;J++)te.push(J)}else if(!V&&D)for(let ue=2;ue<N;ue++)te.push(ue);else if(V&&D){const ue=Math.floor(N/2)-1;for(let J=ie-ue;J<=ie+ue;J++)te.push(J)}else for(let ue=2;ue<j;ue++)te.push(ue);return te}),S=Ve(()=>["more","btn-quickprev",c.b(),s.is("disabled",a.disabled)]),I=Ve(()=>["more","btn-quicknext",c.b(),s.is("disabled",a.disabled)]),A=Ve(()=>a.disabled?-1:0);wh(()=>{const N=(a.pagerCount-1)/2;d.value=!1,p.value=!1,a.pageCount>a.pagerCount&&(a.currentPage>a.pagerCount-N&&(d.value=!0),a.currentPage<a.pageCount-N&&(p.value=!0))});function M(N=!1){a.disabled||(N?g.value=!0:y.value=!0)}function F(N=!1){N?b.value=!0:E.value=!0}function L(N){const Q=N.target;if(Q.tagName.toLowerCase()==="li"&&Array.from(Q.classList).includes("number")){const ie=Number(Q.textContent);ie!==a.currentPage&&n("change",ie)}else Q.tagName.toLowerCase()==="li"&&Array.from(Q.classList).includes("more")&&O(N)}function O(N){const Q=N.target;if(Q.tagName.toLowerCase()==="ul"||a.disabled)return;let ie=Number(Q.textContent);const j=a.pageCount,V=a.currentPage,D=a.pagerCount-2;Q.className.includes("more")&&(Q.className.includes("quickprev")?ie=V-D:Q.className.includes("quicknext")&&(ie=V+D)),Number.isNaN(+ie)||(ie<1&&(ie=1),ie>j&&(ie=j)),ie!==V&&n("change",ie)}return(N,Q)=>(De(),yt("ul",{class:ht(W(s).b()),onClick:O,onKeyup:Ya(L,["enter"])},[N.pageCount>0?(De(),yt("li",{key:0,class:ht([[W(s).is("active",N.currentPage===1),W(s).is("disabled",N.disabled)],"number"]),"aria-current":N.currentPage===1,"aria-label":W(f)("el.pagination.currentPage",{pager:1}),tabindex:W(A)}," 1 ",10,Hde)):Wt("v-if",!0),d.value?(De(),yt("li",{key:1,class:ht(W(S)),tabindex:W(A),"aria-label":W(f)("el.pagination.prevPages",{pager:N.pagerCount-2}),onMouseenter:Q[0]||(Q[0]=ie=>M(!0)),onMouseleave:Q[1]||(Q[1]=ie=>g.value=!1),onFocus:Q[2]||(Q[2]=ie=>F(!0)),onBlur:Q[3]||(Q[3]=ie=>b.value=!1)},[(g.value||b.value)&&!N.disabled?(De(),Ht(W(Nie),{key:0})):(De(),Ht(W(lD),{key:1}))],42,Gde)):Wt("v-if",!0),(De(!0),yt(mn,null,pa(W(T),ie=>(De(),yt("li",{key:ie,class:ht([[W(s).is("active",N.currentPage===ie),W(s).is("disabled",N.disabled)],"number"]),"aria-current":N.currentPage===ie,"aria-label":W(f)("el.pagination.currentPage",{pager:ie}),tabindex:W(A)},Lr(ie),11,qde))),128)),p.value?(De(),yt("li",{key:2,class:ht(W(I)),tabindex:W(A),"aria-label":W(f)("el.pagination.nextPages",{pager:N.pagerCount-2}),onMouseenter:Q[4]||(Q[4]=ie=>M()),onMouseleave:Q[5]||(Q[5]=ie=>y.value=!1),onFocus:Q[6]||(Q[6]=ie=>F()),onBlur:Q[7]||(Q[7]=ie=>E.value=!1)},[(y.value||E.value)&&!N.disabled?(De(),Ht(W($ie),{key:0})):(De(),Ht(W(lD),{key:1}))],42,Xde)):Wt("v-if",!0),N.pageCount>1?(De(),yt("li",{key:3,class:ht([[W(s).is("active",N.currentPage===N.pageCount),W(s).is("disabled",N.disabled)],"number"]),"aria-current":N.currentPage===N.pageCount,"aria-label":W(f)("el.pagination.currentPage",{pager:N.pageCount}),tabindex:W(A)},Lr(N.pageCount),11,Zde)):Wt("v-if",!0)],42,Wde))}});var Jde=Hr(Yde,[["__file","/home/runner/work/element-plus/element-plus/packages/components/pagination/src/components/pager.vue"]]);const as=t=>typeof t!="number",Qde=rn({pageSize:Number,defaultPageSize:Number,total:Number,pageCount:Number,pagerCount:{type:Number,validator:t=>yi(t)&&Math.trunc(t)===t&&t>4&&t<22&&t%2===1,default:7},currentPage:Number,defaultCurrentPage:Number,layout:{type:String,default:["prev","pager","next","jumper","->","total"].join(", ")},pageSizes:{type:br(Array),default:()=>fs([10,20,30,40,50,100])},popperClass:{type:String,default:""},prevText:{type:String,default:""},prevIcon:{type:xo,default:()=>UA},nextText:{type:String,default:""},nextIcon:{type:xo,default:()=>mm},teleported:{type:Boolean,default:!0},small:Boolean,background:Boolean,disabled:Boolean,hideOnSinglePage:Boolean}),epe={"update:current-page":t=>yi(t),"update:page-size":t=>yi(t),"size-change":t=>yi(t),"current-change":t=>yi(t),"prev-click":t=>yi(t),"next-click":t=>yi(t)},QD="ElPagination";var tpe=Ft({name:QD,props:Qde,emits:epe,setup(t,{emit:n,slots:a}){const{t:s}=Yo(),c=Rr("pagination"),f=Tn().vnode.props||{},d="onUpdate:currentPage"in f||"onUpdate:current-page"in f||"onCurrentChange"in f,p="onUpdate:pageSize"in f||"onUpdate:page-size"in f||"onSizeChange"in f,g=Ve(()=>{if(as(t.total)&&as(t.pageCount)||!as(t.currentPage)&&!d)return!1;if(t.layout.includes("sizes")){if(as(t.pageCount)){if(!as(t.total)&&!as(t.pageSize)&&!p)return!1}else if(!p)return!1}return!0}),y=Ze(as(t.defaultPageSize)?10:t.defaultPageSize),b=Ze(as(t.defaultCurrentPage)?1:t.defaultCurrentPage),E=Ve({get(){return as(t.pageSize)?y.value:t.pageSize},set(O){as(t.pageSize)&&(y.value=O),p&&(n("update:page-size",O),n("size-change",O))}}),T=Ve(()=>{let O=0;return as(t.pageCount)?as(t.total)||(O=Math.max(1,Math.ceil(t.total/E.value))):O=t.pageCount,O}),S=Ve({get(){return as(t.currentPage)?b.value:t.currentPage},set(O){let N=O;O<1?N=1:O>T.value&&(N=T.value),as(t.currentPage)&&(b.value=N),d&&(n("update:current-page",N),n("current-change",N))}});gr(T,O=>{S.value>O&&(S.value=O)});function I(O){S.value=O}function A(O){E.value=O;const N=T.value;S.value>N&&(S.value=N)}function M(){t.disabled||(S.value-=1,n("prev-click",S.value))}function F(){t.disabled||(S.value+=1,n("next-click",S.value))}function L(O,N){O&&(O.props||(O.props={}),O.props.class=[O.props.class,N].join(" "))}return Ji(RN,{pageCount:T,disabled:Ve(()=>t.disabled),currentPage:S,changeEvent:I,handleSizeChange:A}),()=>{var O,N;if(!g.value)return s("el.pagination.deprecationWarning"),null;if(!t.layout||t.hideOnSinglePage&&T.value<=1)return null;const Q=[],ie=[],j=En("div",{class:c.e("rightwrapper")},ie),V={prev:En(ide,{disabled:t.disabled,currentPage:S.value,prevText:t.prevText,prevIcon:t.prevIcon,onClick:M}),jumper:En(Bde,{size:t.small?"small":"default"}),pager:En(Jde,{currentPage:S.value,pageCount:T.value,pagerCount:t.pagerCount,onChange:I,disabled:t.disabled}),next:En(ude,{disabled:t.disabled,currentPage:S.value,pageCount:T.value,nextText:t.nextText,nextIcon:t.nextIcon,onClick:F}),sizes:En(Pde,{pageSize:E.value,pageSizes:t.pageSizes,popperClass:t.popperClass,disabled:t.disabled,teleported:t.teleported,size:t.small?"small":"default"}),slot:(N=(O=a==null?void 0:a.default)==null?void 0:O.call(a))!=null?N:null,total:En(Vde,{total:as(t.total)?0:t.total})},D=t.layout.split(",").map(ue=>ue.trim());let te=!1;return D.forEach(ue=>{if(ue==="->"){te=!0;return}te?ie.push(V[ue]):Q.push(V[ue])}),L(Q[0],c.is("first")),L(Q[Q.length-1],c.is("last")),te&&ie.length>0&&(L(ie[0],c.is("first")),L(ie[ie.length-1],c.is("last")),Q.push(j)),En("div",{class:[c.b(),c.is("background",t.background),{[c.m("small")]:t.small}]},Q)}}});const BN=ca(tpe),rpe=rn({trigger:U_.trigger,placement:nS.placement,disabled:U_.disabled,visible:rl.visible,transition:rl.transition,popperOptions:nS.popperOptions,tabindex:nS.tabindex,content:rl.content,popperStyle:rl.popperStyle,popperClass:rl.popperClass,enterable:{...rl.enterable,default:!0},effect:{...rl.effect,default:"light"},teleported:rl.teleported,title:String,width:{type:[String,Number],default:150},offset:{type:Number,default:void 0},showAfter:{type:Number,default:0},hideAfter:{type:Number,default:200},autoClose:{type:Number,default:0},showArrow:{type:Boolean,default:!0},persistent:{type:Boolean,default:!0},"onUpdate:visible":{type:Function}}),npe={"update:visible":t=>Wo(t),"before-enter":()=>!0,"before-leave":()=>!0,"after-enter":()=>!0,"after-leave":()=>!0},ipe="onUpdate:visible",ape=Ft({name:"ElPopover"}),ope=Ft({...ape,props:rpe,emits:npe,setup(t,{expose:n,emit:a}){const s=t,c=Ve(()=>s[ipe]),f=Rr("popover"),d=Ze(),p=Ve(()=>{var M;return(M=W(d))==null?void 0:M.popperRef}),g=Ve(()=>[{width:mc(s.width)},s.popperStyle]),y=Ve(()=>[f.b(),s.popperClass,{[f.m("plain")]:!!s.content}]),b=Ve(()=>s.transition===`${f.namespace.value}-fade-in-linear`),E=()=>{var M;(M=d.value)==null||M.hide()},T=()=>{a("before-enter")},S=()=>{a("before-leave")},I=()=>{a("after-enter")},A=()=>{a("update:visible",!1),a("after-leave")};return n({popperRef:p,hide:E}),(M,F)=>(De(),Ht(W(sk),Ds({ref_key:"tooltipRef",ref:d},M.$attrs,{trigger:M.trigger,placement:M.placement,disabled:M.disabled,visible:M.visible,transition:M.transition,"popper-options":M.popperOptions,tabindex:M.tabindex,content:M.content,offset:M.offset,"show-after":M.showAfter,"hide-after":M.hideAfter,"auto-close":M.autoClose,"show-arrow":M.showArrow,"aria-label":M.title,effect:M.effect,enterable:M.enterable,"popper-class":W(y),"popper-style":W(g),teleported:M.teleported,persistent:M.persistent,"gpu-acceleration":W(b),"onUpdate:visible":W(c),onBeforeShow:T,onBeforeHide:S,onShow:I,onHide:A}),{content:we(()=>[M.title?(De(),yt("div",{key:0,class:ht(W(f).e("title")),role:"title"},Lr(M.title),3)):Wt("v-if",!0),vr(M.$slots,"default",{},()=>[Sr(Lr(M.content),1)])]),default:we(()=>[M.$slots.reference?vr(M.$slots,"reference",{key:0}):Wt("v-if",!0)]),_:3},16,["trigger","placement","disabled","visible","transition","popper-options","tabindex","content","offset","show-after","hide-after","auto-close","show-arrow","aria-label","effect","enterable","popper-class","popper-style","teleported","persistent","gpu-acceleration","onUpdate:visible"]))}});var spe=Hr(ope,[["__file","/home/runner/work/element-plus/element-plus/packages/components/popover/src/popover.vue"]]);const e5=(t,n)=>{const a=n.arg||n.value,s=a==null?void 0:a.popperRef;s&&(s.triggerRef=t)};var lpe={mounted(t,n){e5(t,n)},updated(t,n){e5(t,n)}};const cpe="popover",upe=_ae(lpe,cpe),fpe=ca(spe,{directive:upe}),hpe=rn({type:{type:String,default:"line",values:["line","circle","dashboard"]},percentage:{type:Number,default:0,validator:t=>t>=0&&t<=100},status:{type:String,default:"",values:["","success","exception","warning"]},indeterminate:{type:Boolean,default:!1},duration:{type:Number,default:3},strokeWidth:{type:Number,default:6},strokeLinecap:{type:br(String),default:"round"},textInside:{type:Boolean,default:!1},width:{type:Number,default:126},showText:{type:Boolean,default:!0},color:{type:br([String,Array,Function]),default:""},striped:Boolean,stripedFlow:Boolean,format:{type:br(Function),default:t=>`${t}%`}}),dpe=["aria-valuenow"],ppe={viewBox:"0 0 100 100"},mpe=["d","stroke","stroke-linecap","stroke-width"],gpe=["d","stroke","opacity","stroke-linecap","stroke-width"],_pe={key:0},vpe=Ft({name:"ElProgress"}),ype=Ft({...vpe,props:hpe,setup(t){const n=t,a={success:"#13ce66",exception:"#ff4949",warning:"#e6a23c",default:"#20a0ff"},s=Rr("progress"),c=Ve(()=>({width:`${n.percentage}%`,animationDuration:`${n.duration}s`,backgroundColor:L(n.percentage)})),f=Ve(()=>(n.strokeWidth/n.width*100).toFixed(1)),d=Ve(()=>["circle","dashboard"].includes(n.type)?Number.parseInt(`${50-Number.parseFloat(f.value)/2}`,10):0),p=Ve(()=>{const O=d.value,N=n.type==="dashboard";return`
          M 50 50
          m 0 ${N?"":"-"}${O}
          a ${O} ${O} 0 1 1 0 ${N?"-":""}${O*2}
          a ${O} ${O} 0 1 1 0 ${N?"":"-"}${O*2}
          `}),g=Ve(()=>2*Math.PI*d.value),y=Ve(()=>n.type==="dashboard"?.75:1),b=Ve(()=>`${-1*g.value*(1-y.value)/2}px`),E=Ve(()=>({strokeDasharray:`${g.value*y.value}px, ${g.value}px`,strokeDashoffset:b.value})),T=Ve(()=>({strokeDasharray:`${g.value*y.value*(n.percentage/100)}px, ${g.value}px`,strokeDashoffset:b.value,transition:"stroke-dasharray 0.6s ease 0s, stroke 0.6s ease, opacity ease 0.6s"})),S=Ve(()=>{let O;return n.color?O=L(n.percentage):O=a[n.status]||a.default,O}),I=Ve(()=>n.status==="warning"?VA:n.type==="line"?n.status==="success"?$A:zb:n.status==="success"?tz:Qu),A=Ve(()=>n.type==="line"?12+n.strokeWidth*.4:n.width*.111111+2),M=Ve(()=>n.format(n.percentage));function F(O){const N=100/O.length;return O.map((ie,j)=>Mn(ie)?{color:ie,percentage:(j+1)*N}:ie).sort((ie,j)=>ie.percentage-j.percentage)}const L=O=>{var N;const{color:Q}=n;if(Yr(Q))return Q(O);if(Mn(Q))return Q;{const ie=F(Q);for(const j of ie)if(j.percentage>O)return j.color;return(N=ie[ie.length-1])==null?void 0:N.color}};return(O,N)=>(De(),yt("div",{class:ht([W(s).b(),W(s).m(O.type),W(s).is(O.status),{[W(s).m("without-text")]:!O.showText,[W(s).m("text-inside")]:O.textInside}]),role:"progressbar","aria-valuenow":O.percentage,"aria-valuemin":"0","aria-valuemax":"100"},[O.type==="line"?(De(),yt("div",{key:0,class:ht(W(s).b("bar"))},[gt("div",{class:ht(W(s).be("bar","outer")),style:xn({height:`${O.strokeWidth}px`})},[gt("div",{class:ht([W(s).be("bar","inner"),{[W(s).bem("bar","inner","indeterminate")]:O.indeterminate},{[W(s).bem("bar","inner","striped")]:O.striped},{[W(s).bem("bar","inner","striped-flow")]:O.stripedFlow}]),style:xn(W(c))},[(O.showText||O.$slots.default)&&O.textInside?(De(),yt("div",{key:0,class:ht(W(s).be("bar","innerText"))},[vr(O.$slots,"default",{percentage:O.percentage},()=>[gt("span",null,Lr(W(M)),1)])],2)):Wt("v-if",!0)],6)],6)],2)):(De(),yt("div",{key:1,class:ht(W(s).b("circle")),style:xn({height:`${O.width}px`,width:`${O.width}px`})},[(De(),yt("svg",ppe,[gt("path",{class:ht(W(s).be("circle","track")),d:W(p),stroke:`var(${W(s).cssVarName("fill-color-light")}, #e5e9f2)`,"stroke-linecap":O.strokeLinecap,"stroke-width":W(f),fill:"none",style:xn(W(E))},null,14,mpe),gt("path",{class:ht(W(s).be("circle","path")),d:W(p),stroke:W(S),fill:"none",opacity:O.percentage?1:0,"stroke-linecap":O.strokeLinecap,"stroke-width":W(f),style:xn(W(T))},null,14,gpe)]))],6)),(O.showText||O.$slots.default)&&!O.textInside?(De(),yt("div",{key:2,class:ht(W(s).e("text")),style:xn({fontSize:`${W(A)}px`})},[vr(O.$slots,"default",{percentage:O.percentage},()=>[O.status?(De(),Ht(W(Hn),{key:1},{default:we(()=>[(De(),Ht(Zi(W(I))))]),_:1})):(De(),yt("span",_pe,Lr(W(M)),1))])],6)):Wt("v-if",!0)],10,dpe))}});var xpe=Hr(ype,[["__file","/home/runner/work/element-plus/element-plus/packages/components/progress/src/progress.vue"]]);const bpe=ca(xpe),wpe=rn({modelValue:{type:[Boolean,String,Number],default:!1},disabled:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},size:{type:String,validator:jA},width:{type:[String,Number],default:""},inlinePrompt:{type:Boolean,default:!1},inactiveActionIcon:{type:xo},activeActionIcon:{type:xo},activeIcon:{type:xo},inactiveIcon:{type:xo},activeText:{type:String,default:""},inactiveText:{type:String,default:""},activeValue:{type:[Boolean,String,Number],default:!0},inactiveValue:{type:[Boolean,String,Number],default:!1},activeColor:{type:String,default:""},inactiveColor:{type:String,default:""},borderColor:{type:String,default:""},name:{type:String,default:""},validateEvent:{type:Boolean,default:!0},beforeChange:{type:br(Function)},id:String,tabindex:{type:[String,Number]},value:{type:[Boolean,String,Number],default:!1},label:{type:String,default:void 0}}),Epe={[ma]:t=>Wo(t)||Mn(t)||yi(t),[Ch]:t=>Wo(t)||Mn(t)||yi(t),[rC]:t=>Wo(t)||Mn(t)||yi(t)},Tpe=["onClick"],Spe=["id","aria-checked","aria-disabled","aria-label","name","true-value","false-value","disabled","tabindex","onKeydown"],Cpe=["aria-hidden"],Ape=["aria-hidden"],kpe=["aria-hidden"],bC="ElSwitch",Ipe=Ft({name:bC}),Mpe=Ft({...Ipe,props:wpe,emits:Epe,setup(t,{expose:n,emit:a}){const s=t,c=Tn(),{formItem:f}=Lh(),d=_c(),p=Rr("switch");(V=>{V.forEach(D=>{q0({from:D[0],replacement:D[1],scope:bC,version:"2.3.0",ref:"https://element-plus.org/en-US/component/switch.html#attributes",type:"Attribute"},Ve(()=>{var te;return!!((te=c.vnode.props)!=null&&te[D[2]])}))})})([['"value"','"model-value" or "v-model"',"value"],['"active-color"',"CSS var `--el-switch-on-color`","activeColor"],['"inactive-color"',"CSS var `--el-switch-off-color`","inactiveColor"],['"border-color"',"CSS var `--el-switch-border-color`","borderColor"]]);const{inputId:y}=vv(s,{formItemContext:f}),b=cu(Ve(()=>s.loading)),E=Ze(s.modelValue!==!1),T=Ze(),S=Ze(),I=Ve(()=>[p.b(),p.m(d.value),p.is("disabled",b.value),p.is("checked",O.value)]),A=Ve(()=>[p.e("label"),p.em("label","left"),p.is("active",!O.value)]),M=Ve(()=>[p.e("label"),p.em("label","right"),p.is("active",O.value)]),F=Ve(()=>({width:mc(s.width)}));gr(()=>s.modelValue,()=>{E.value=!0}),gr(()=>s.value,()=>{E.value=!1});const L=Ve(()=>E.value?s.modelValue:s.value),O=Ve(()=>L.value===s.activeValue);[s.activeValue,s.inactiveValue].includes(L.value)||(a(ma,s.inactiveValue),a(Ch,s.inactiveValue),a(rC,s.inactiveValue)),gr(O,V=>{var D;T.value.checked=V,s.validateEvent&&((D=f==null?void 0:f.validate)==null||D.call(f,"change").catch(te=>void 0))});const N=()=>{const V=O.value?s.inactiveValue:s.activeValue;a(ma,V),a(Ch,V),a(rC,V),Fn(()=>{T.value.checked=O.value})},Q=()=>{if(b.value)return;const{beforeChange:V}=s;if(!V){N();return}const D=V();[Ox(D),Wo(D)].includes(!0)||bc(bC,"beforeChange must return type `Promise<boolean>` or `boolean`"),Ox(D)?D.then(ue=>{ue&&N()}).catch(ue=>{}):D&&N()},ie=Ve(()=>p.cssVarBlock({...s.activeColor?{"on-color":s.activeColor}:null,...s.inactiveColor?{"off-color":s.inactiveColor}:null,...s.borderColor?{"border-color":s.borderColor}:null})),j=()=>{var V,D;(D=(V=T.value)==null?void 0:V.focus)==null||D.call(V)};return di(()=>{T.value.checked=O.value}),n({focus:j,checked:O}),(V,D)=>(De(),yt("div",{class:ht(W(I)),style:xn(W(ie)),onClick:si(Q,["prevent"])},[gt("input",{id:W(y),ref_key:"input",ref:T,class:ht(W(p).e("input")),type:"checkbox",role:"switch","aria-checked":W(O),"aria-disabled":W(b),"aria-label":V.label,name:V.name,"true-value":V.activeValue,"false-value":V.inactiveValue,disabled:W(b),tabindex:V.tabindex,onChange:N,onKeydown:Ya(Q,["enter"])},null,42,Spe),!V.inlinePrompt&&(V.inactiveIcon||V.inactiveText)?(De(),yt("span",{key:0,class:ht(W(A))},[V.inactiveIcon?(De(),Ht(W(Hn),{key:0},{default:we(()=>[(De(),Ht(Zi(V.inactiveIcon)))]),_:1})):Wt("v-if",!0),!V.inactiveIcon&&V.inactiveText?(De(),yt("span",{key:1,"aria-hidden":W(O)},Lr(V.inactiveText),9,Cpe)):Wt("v-if",!0)],2)):Wt("v-if",!0),gt("span",{ref_key:"core",ref:S,class:ht(W(p).e("core")),style:xn(W(F))},[V.inlinePrompt?(De(),yt("div",{key:0,class:ht(W(p).e("inner"))},[V.activeIcon||V.inactiveIcon?(De(),Ht(W(Hn),{key:0,class:ht(W(p).is("icon"))},{default:we(()=>[(De(),Ht(Zi(W(O)?V.activeIcon:V.inactiveIcon)))]),_:1},8,["class"])):V.activeText||V.inactiveText?(De(),yt("span",{key:1,class:ht(W(p).is("text")),"aria-hidden":!W(O)},Lr(W(O)?V.activeText:V.inactiveText),11,Ape)):Wt("v-if",!0)],2)):Wt("v-if",!0),gt("div",{class:ht(W(p).e("action"))},[V.loading?(De(),Ht(W(Hn),{key:0,class:ht(W(p).is("loading"))},{default:we(()=>[me(W(Nb))]),_:1},8,["class"])):V.activeActionIcon&&W(O)?(De(),Ht(W(Hn),{key:1},{default:we(()=>[(De(),Ht(Zi(V.activeActionIcon)))]),_:1})):V.inactiveActionIcon&&!W(O)?(De(),Ht(W(Hn),{key:2},{default:we(()=>[(De(),Ht(Zi(V.inactiveActionIcon)))]),_:1})):Wt("v-if",!0)],2)],6),!V.inlinePrompt&&(V.activeIcon||V.activeText)?(De(),yt("span",{key:1,class:ht(W(M))},[V.activeIcon?(De(),Ht(W(Hn),{key:0},{default:we(()=>[(De(),Ht(Zi(V.activeIcon)))]),_:1})):Wt("v-if",!0),!V.activeIcon&&V.activeText?(De(),yt("span",{key:1,"aria-hidden":!W(O)},Lr(V.activeText),9,kpe)):Wt("v-if",!0)],2)):Wt("v-if",!0)],14,Tpe))}});var Fpe=Hr(Mpe,[["__file","/home/runner/work/element-plus/element-plus/packages/components/switch/src/switch.vue"]]);const Ppe=ca(Fpe);/*!
 * escape-html
 * Copyright(c) 2012-2013 TJ Holowaychuk
 * Copyright(c) 2015 Andreas Lubbe
 * Copyright(c) 2015 Tiancheng "Timothy" Gu
 * MIT Licensed
 */var Ope=/["'&<>]/,Rpe=Lpe;function Lpe(t){var n=""+t,a=Ope.exec(n);if(!a)return n;var s,c="",f=0,d=0;for(f=a.index;f<n.length;f++){switch(n.charCodeAt(f)){case 34:s="&quot;";break;case 38:s="&amp;";break;case 39:s="&#39;";break;case 60:s="&lt;";break;case 62:s="&gt;";break;default:continue}d!==f&&(c+=n.substring(d,f)),d=f+1,c+=s}return d!==f?c+n.substring(d,f):c}const Dpe=qb(Rpe),iS=function(t){var n;return(n=t.target)==null?void 0:n.closest("td")},Bpe=function(t,n,a,s,c){if(!n&&!s&&(!c||Array.isArray(c)&&!c.length))return t;typeof a=="string"?a=a==="descending"?-1:1:a=a&&a<0?-1:1;const f=s?null:function(p,g){return c?(Array.isArray(c)||(c=[c]),c.map(y=>typeof y=="string"?Bo(p,y):y(p,g,t))):(n!=="$key"&&$n(p)&&"$value"in p&&(p=p.$value),[$n(p)?Bo(p,n):p])},d=function(p,g){if(s)return s(p.value,g.value);for(let y=0,b=p.key.length;y<b;y++){if(p.key[y]<g.key[y])return-1;if(p.key[y]>g.key[y])return 1}return 0};return t.map((p,g)=>({value:p,index:g,key:f?f(p,g):null})).sort((p,g)=>{let y=d(p,g);return y||(y=p.index-g.index),y*+a}).map(p=>p.value)},zN=function(t,n){let a=null;return t.columns.forEach(s=>{s.id===n&&(a=s)}),a},zpe=function(t,n){let a=null;for(let s=0;s<t.columns.length;s++){const c=t.columns[s];if(c.columnKey===n){a=c;break}}return a||bc("ElTable",`No column matching with column-key: ${n}`),a},t5=function(t,n,a){const s=(n.className||"").match(new RegExp(`${a}-table_[^\\s]+`,"gm"));return s?zN(t,s[0]):null},So=(t,n)=>{if(!t)throw new Error("Row is required when get row identity");if(typeof n=="string"){if(!n.includes("."))return`${t[n]}`;const a=n.split(".");let s=t;for(const c of a)s=s[c];return`${s}`}else if(typeof n=="function")return n.call(null,t)},Ld=function(t,n){const a={};return(t||[]).forEach((s,c)=>{a[So(s,n)]={row:s,index:c}}),a};function Npe(t,n){const a={};let s;for(s in t)a[s]=t[s];for(s in n)if(Kn(n,s)){const c=n[s];typeof c<"u"&&(a[s]=c)}return a}function fk(t){return t===""||t!==void 0&&(t=Number.parseInt(t,10),Number.isNaN(t)&&(t="")),t}function NN(t){return t===""||t!==void 0&&(t=fk(t),Number.isNaN(t)&&(t=80)),t}function Upe(t){return typeof t=="number"?t:typeof t=="string"?/^\d+(?:px)?$/.test(t)?Number.parseInt(t,10):t:null}function $pe(...t){return t.length===0?n=>n:t.length===1?t[0]:t.reduce((n,a)=>(...s)=>n(a(...s)))}function o_(t,n,a){let s=!1;const c=t.indexOf(n),f=c!==-1,d=p=>{p==="add"?t.push(n):t.splice(c,1),s=!0,Wr(n.children)&&n.children.forEach(g=>{o_(t,g,a??!f)})};return Wo(a)?a&&!f?d("add"):!a&&f&&d("remove"):d(f?"remove":"add"),s}function Vpe(t,n,a="children",s="hasChildren"){const c=d=>!(Array.isArray(d)&&d.length);function f(d,p,g){n(d,p,g),p.forEach(y=>{if(y[s]){n(y,null,g+1);return}const b=y[a];c(b)||f(y,b,g+1)})}t.forEach(d=>{if(d[s]){n(d,null,0);return}const p=d[a];c(p)||f(d,p,0)})}let zu;function jpe(t,n,a,s,c){c=Y8({enterable:!0,showArrow:!0},c);const f=t==null?void 0:t.dataset.prefix,d=t==null?void 0:t.querySelector(`.${f}-scrollbar__wrap`);function p(){const M=c.effect==="light",F=document.createElement("div");return F.className=[`${f}-popper`,M?"is-light":"is-dark",c.popperClass||""].join(" "),a=Dpe(a),F.innerHTML=a,F.style.zIndex=String(s()),t==null||t.appendChild(F),F}function g(){const M=document.createElement("div");return M.className=`${f}-popper__arrow`,M}function y(){b&&b.update()}zu==null||zu(),zu=()=>{try{b&&b.destroy(),S&&(t==null||t.removeChild(S)),n.removeEventListener("mouseenter",E),n.removeEventListener("mouseleave",T),d==null||d.removeEventListener("scroll",zu),zu=void 0}catch{}};let b=null,E=y,T=zu;c.enterable&&({onOpen:E,onClose:T}=Pz({showAfter:c.showAfter,hideAfter:c.hideAfter,open:y,close:zu}));const S=p();S.onmouseenter=E,S.onmouseleave=T;const I=[];if(c.offset&&I.push({name:"offset",options:{offset:[0,c.offset]}}),c.showArrow){const M=S.appendChild(g());I.push({name:"arrow",options:{element:M,padding:10}})}const A=c.popperOptions||{};return b=Iz(n,S,{placement:c.placement||"top",strategy:"fixed",...A,modifiers:A.modifiers?I.concat(A.modifiers):I}),n.addEventListener("mouseenter",E),n.addEventListener("mouseleave",T),d==null||d.addEventListener("scroll",zu),b}function UN(t){return t.children?pie(t.children,UN):[t]}function r5(t,n){return t+n.colSpan}const $N=(t,n,a,s)=>{let c=0,f=t;const d=a.states.columns.value;if(s){const g=UN(s[t]);c=d.slice(0,d.indexOf(g[0])).reduce(r5,0),f=c+g.reduce(r5,0)-1}else c=t;let p;switch(n){case"left":f<a.states.fixedLeafColumnsLength.value&&(p="left");break;case"right":c>=d.length-a.states.rightFixedLeafColumnsLength.value&&(p="right");break;default:f<a.states.fixedLeafColumnsLength.value?p="left":c>=d.length-a.states.rightFixedLeafColumnsLength.value&&(p="right")}return p?{direction:p,start:c,after:f}:{}},hk=(t,n,a,s,c,f=0)=>{const d=[],{direction:p,start:g,after:y}=$N(n,a,s,c);if(p){const b=p==="left";d.push(`${t}-fixed-column--${p}`),b&&y+f===s.states.fixedLeafColumnsLength.value-1?d.push("is-last-column"):!b&&g-f===s.states.columns.value.length-s.states.rightFixedLeafColumnsLength.value&&d.push("is-first-column")}return d};function n5(t,n){return t+(n.realWidth===null||Number.isNaN(n.realWidth)?Number(n.width):n.realWidth)}const dk=(t,n,a,s)=>{const{direction:c,start:f=0,after:d=0}=$N(t,n,a,s);if(!c)return;const p={},g=c==="left",y=a.states.columns.value;return g?p.left=y.slice(0,f).reduce(n5,0):p.right=y.slice(d+1).reverse().reduce(n5,0),p},em=(t,n)=>{t&&(Number.isNaN(t[n])||(t[n]=`${t[n]}px`))};function Wpe(t){const n=Tn(),a=Ze(!1),s=Ze([]);return{updateExpandRows:()=>{const g=t.data.value||[],y=t.rowKey.value;if(a.value)s.value=g.slice();else if(y){const b=Ld(s.value,y);s.value=g.reduce((E,T)=>{const S=So(T,y);return b[S]&&E.push(T),E},[])}else s.value=[]},toggleRowExpansion:(g,y)=>{o_(s.value,g,y)&&n.emit("expand-change",g,s.value.slice())},setExpandRowKeys:g=>{n.store.assertRowKey();const y=t.data.value||[],b=t.rowKey.value,E=Ld(y,b);s.value=g.reduce((T,S)=>{const I=E[S];return I&&T.push(I.row),T},[])},isRowExpanded:g=>{const y=t.rowKey.value;return y?!!Ld(s.value,y)[So(g,y)]:s.value.includes(g)},states:{expandRows:s,defaultExpandAll:a}}}function Hpe(t){const n=Tn(),a=Ze(null),s=Ze(null),c=y=>{n.store.assertRowKey(),a.value=y,d(y)},f=()=>{a.value=null},d=y=>{const{data:b,rowKey:E}=t;let T=null;E.value&&(T=(W(b)||[]).find(S=>So(S,E.value)===y)),s.value=T,n.emit("current-change",s.value,null)};return{setCurrentRowKey:c,restoreCurrentRowKey:f,setCurrentRowByKey:d,updateCurrentRow:y=>{const b=s.value;if(y&&y!==b){s.value=y,n.emit("current-change",s.value,b);return}!y&&b&&(s.value=null,n.emit("current-change",null,b))},updateCurrentRowData:()=>{const y=t.rowKey.value,b=t.data.value||[],E=s.value;if(!b.includes(E)&&E){if(y){const T=So(E,y);d(T)}else s.value=null;s.value===null&&n.emit("current-change",null,E)}else a.value&&(d(a.value),f())},states:{_currentRowKey:a,currentRow:s}}}function Gpe(t){const n=Ze([]),a=Ze({}),s=Ze(16),c=Ze(!1),f=Ze({}),d=Ze("hasChildren"),p=Ze("children"),g=Tn(),y=Ve(()=>{if(!t.rowKey.value)return{};const F=t.data.value||[];return E(F)}),b=Ve(()=>{const F=t.rowKey.value,L=Object.keys(f.value),O={};return L.length&&L.forEach(N=>{if(f.value[N].length){const Q={children:[]};f.value[N].forEach(ie=>{const j=So(ie,F);Q.children.push(j),ie[d.value]&&!O[j]&&(O[j]={children:[]})}),O[N]=Q}}),O}),E=F=>{const L=t.rowKey.value,O={};return Vpe(F,(N,Q,ie)=>{const j=So(N,L);Array.isArray(Q)?O[j]={children:Q.map(V=>So(V,L)),level:ie}:c.value&&(O[j]={children:[],lazy:!0,level:ie})},p.value,d.value),O},T=(F=!1,L=(O=>(O=g.store)==null?void 0:O.states.defaultExpandAll.value)())=>{var O;const N=y.value,Q=b.value,ie=Object.keys(N),j={};if(ie.length){const V=W(a),D=[],te=(J,le)=>{if(F)return n.value?L||n.value.includes(le):!!(L||J!=null&&J.expanded);{const re=L||n.value&&n.value.includes(le);return!!(J!=null&&J.expanded||re)}};ie.forEach(J=>{const le=V[J],re={...N[J]};if(re.expanded=te(le,J),re.lazy){const{loaded:Fe=!1,loading:Ye=!1}=le||{};re.loaded=!!Fe,re.loading=!!Ye,D.push(J)}j[J]=re});const ue=Object.keys(Q);c.value&&ue.length&&D.length&&ue.forEach(J=>{const le=V[J],re=Q[J].children;if(D.includes(J)){if(j[J].children.length!==0)throw new Error("[ElTable]children must be an empty array.");j[J].children=re}else{const{loaded:Fe=!1,loading:Ye=!1}=le||{};j[J]={lazy:!0,loaded:!!Fe,loading:!!Ye,expanded:te(le,J),children:re,level:""}}})}a.value=j,(O=g.store)==null||O.updateTableScrollY()};gr(()=>n.value,()=>{T(!0)}),gr(()=>y.value,()=>{T()}),gr(()=>b.value,()=>{T()});const S=F=>{n.value=F,T()},I=(F,L)=>{g.store.assertRowKey();const O=t.rowKey.value,N=So(F,O),Q=N&&a.value[N];if(N&&Q&&"expanded"in Q){const ie=Q.expanded;L=typeof L>"u"?!Q.expanded:L,a.value[N].expanded=L,ie!==L&&g.emit("expand-change",F,L),g.store.updateTableScrollY()}},A=F=>{g.store.assertRowKey();const L=t.rowKey.value,O=So(F,L),N=a.value[O];c.value&&N&&"loaded"in N&&!N.loaded?M(F,O,N):I(F,void 0)},M=(F,L,O)=>{const{load:N}=g.props;N&&!a.value[L].loaded&&(a.value[L].loading=!0,N(F,O,Q=>{if(!Array.isArray(Q))throw new TypeError("[ElTable] data must be an array");a.value[L].loading=!1,a.value[L].loaded=!0,a.value[L].expanded=!0,Q.length&&(f.value[L]=Q),g.emit("expand-change",F,!0)}))};return{loadData:M,loadOrToggle:A,toggleTreeExpansion:I,updateTreeExpandKeys:S,updateTreeData:T,normalize:E,states:{expandRowKeys:n,treeData:a,indent:s,lazy:c,lazyTreeNodeMap:f,lazyColumnIdentifier:d,childrenColumnName:p}}}const qpe=(t,n)=>{const a=n.sortingColumn;return!a||typeof a.sortable=="string"?t:Bpe(t,n.sortProp,n.sortOrder,a.sortMethod,a.sortBy)},Ix=t=>{const n=[];return t.forEach(a=>{a.children&&a.children.length>0?n.push.apply(n,Ix(a.children)):n.push(a)}),n};function Xpe(){var t;const n=Tn(),{size:a}=yc((t=n.proxy)==null?void 0:t.$props),s=Ze(null),c=Ze([]),f=Ze([]),d=Ze(!1),p=Ze([]),g=Ze([]),y=Ze([]),b=Ze([]),E=Ze([]),T=Ze([]),S=Ze([]),I=Ze([]),A=[],M=Ze(0),F=Ze(0),L=Ze(0),O=Ze(!1),N=Ze([]),Q=Ze(!1),ie=Ze(!1),j=Ze(null),V=Ze({}),D=Ze(null),te=Ze(null),ue=Ze(null),J=Ze(null),le=Ze(null);gr(c,()=>n.state&&Ee(!1),{deep:!0});const re=()=>{if(!s.value)throw new Error("[ElTable] prop row-key is required")},Fe=Nt=>{var Lt;(Lt=Nt.children)==null||Lt.forEach(Qt=>{Qt.fixed=Nt.fixed,Fe(Qt)})},Ye=()=>{p.value.forEach(dr=>{Fe(dr)}),b.value=p.value.filter(dr=>dr.fixed===!0||dr.fixed==="left"),E.value=p.value.filter(dr=>dr.fixed==="right"),b.value.length>0&&p.value[0]&&p.value[0].type==="selection"&&!p.value[0].fixed&&(p.value[0].fixed=!0,b.value.unshift(p.value[0]));const Nt=p.value.filter(dr=>!dr.fixed);g.value=[].concat(b.value).concat(Nt).concat(E.value);const Lt=Ix(Nt),Qt=Ix(b.value),Gt=Ix(E.value);M.value=Lt.length,F.value=Qt.length,L.value=Gt.length,y.value=[].concat(Qt).concat(Lt).concat(Gt),d.value=b.value.length>0||E.value.length>0},Ee=(Nt,Lt=!1)=>{Nt&&Ye(),Lt?n.state.doLayout():n.state.debouncedUpdateLayout()},ut=Nt=>N.value.includes(Nt),Ne=()=>{O.value=!1,N.value.length&&(N.value=[],n.emit("selection-change",[]))},He=()=>{let Nt;if(s.value){Nt=[];const Lt=Ld(N.value,s.value),Qt=Ld(c.value,s.value);for(const Gt in Lt)Kn(Lt,Gt)&&!Qt[Gt]&&Nt.push(Lt[Gt].row)}else Nt=N.value.filter(Lt=>!c.value.includes(Lt));if(Nt.length){const Lt=N.value.filter(Qt=>!Nt.includes(Qt));N.value=Lt,n.emit("selection-change",Lt.slice())}},Oe=()=>(N.value||[]).slice(),Pe=(Nt,Lt=void 0,Qt=!0)=>{if(o_(N.value,Nt,Lt)){const dr=(N.value||[]).slice();Qt&&n.emit("select",dr,Nt),n.emit("selection-change",dr)}},rt=()=>{var Nt,Lt;const Qt=ie.value?!O.value:!(O.value||N.value.length);O.value=Qt;let Gt=!1,dr=0;const Br=(Lt=(Nt=n==null?void 0:n.store)==null?void 0:Nt.states)==null?void 0:Lt.rowKey.value;c.value.forEach((qr,Ci)=>{const Wi=Ci+dr;j.value?j.value.call(null,qr,Wi)&&o_(N.value,qr,Qt)&&(Gt=!0):o_(N.value,qr,Qt)&&(Gt=!0),dr+=ze(So(qr,Br))}),Gt&&n.emit("selection-change",N.value?N.value.slice():[]),n.emit("select-all",N.value)},et=()=>{const Nt=Ld(N.value,s.value);c.value.forEach(Lt=>{const Qt=So(Lt,s.value),Gt=Nt[Qt];Gt&&(N.value[Gt.index]=Lt)})},Ge=()=>{var Nt,Lt,Qt;if(((Nt=c.value)==null?void 0:Nt.length)===0){O.value=!1;return}let Gt;s.value&&(Gt=Ld(N.value,s.value));const dr=function(Wi){return Gt?!!Gt[So(Wi,s.value)]:N.value.includes(Wi)};let Br=!0,qr=0,Ci=0;for(let Wi=0,Fi=(c.value||[]).length;Wi<Fi;Wi++){const Ta=(Qt=(Lt=n==null?void 0:n.store)==null?void 0:Lt.states)==null?void 0:Qt.rowKey.value,Sa=Wi+Ci,Ai=c.value[Wi],Le=j.value&&j.value.call(null,Ai,Sa);if(dr(Ai))qr++;else if(!j.value||Le){Br=!1;break}Ci+=ze(So(Ai,Ta))}qr===0&&(Br=!1),O.value=Br},ze=Nt=>{var Lt;if(!n||!n.store)return 0;const{treeData:Qt}=n.store.states;let Gt=0;const dr=(Lt=Qt.value[Nt])==null?void 0:Lt.children;return dr&&(Gt+=dr.length,dr.forEach(Br=>{Gt+=ze(Br)})),Gt},oe=(Nt,Lt)=>{Array.isArray(Nt)||(Nt=[Nt]);const Qt={};return Nt.forEach(Gt=>{V.value[Gt.id]=Lt,Qt[Gt.columnKey||Gt.id]=Lt}),Qt},Me=(Nt,Lt,Qt)=>{te.value&&te.value!==Nt&&(te.value.order=null),te.value=Nt,ue.value=Lt,J.value=Qt},fe=()=>{let Nt=W(f);Object.keys(V.value).forEach(Lt=>{const Qt=V.value[Lt];if(!Qt||Qt.length===0)return;const Gt=zN({columns:y.value},Lt);Gt&&Gt.filterMethod&&(Nt=Nt.filter(dr=>Qt.some(Br=>Gt.filterMethod.call(null,Br,dr,Gt))))}),D.value=Nt},pe=()=>{c.value=qpe(D.value,{sortingColumn:te.value,sortProp:ue.value,sortOrder:J.value})},ot=(Nt=void 0)=>{Nt&&Nt.filter||fe(),pe()},xe=Nt=>{const{tableHeaderRef:Lt}=n.refs;if(!Lt)return;const Qt=Object.assign({},Lt.filterPanels),Gt=Object.keys(Qt);if(Gt.length)if(typeof Nt=="string"&&(Nt=[Nt]),Array.isArray(Nt)){const dr=Nt.map(Br=>zpe({columns:y.value},Br));Gt.forEach(Br=>{const qr=dr.find(Ci=>Ci.id===Br);qr&&(qr.filteredValue=[])}),n.store.commit("filterChange",{column:dr,values:[],silent:!0,multi:!0})}else Gt.forEach(dr=>{const Br=y.value.find(qr=>qr.id===dr);Br&&(Br.filteredValue=[])}),V.value={},n.store.commit("filterChange",{column:{},values:[],silent:!0})},ae=()=>{te.value&&(Me(null,null,null),n.store.commit("changeSortCondition",{silent:!0}))},{setExpandRowKeys:X,toggleRowExpansion:Ce,updateExpandRows:he,states:G,isRowExpanded:K}=Wpe({data:c,rowKey:s}),{updateTreeExpandKeys:se,toggleTreeExpansion:Ae,updateTreeData:Se,loadOrToggle:ye,states:Xe}=Gpe({data:c,rowKey:s}),{updateCurrentRowData:be,updateCurrentRow:Be,setCurrentRowKey:ct,states:At}=Hpe({data:c,rowKey:s});return{assertRowKey:re,updateColumns:Ye,scheduleLayout:Ee,isSelected:ut,clearSelection:Ne,cleanSelection:He,getSelectionRows:Oe,toggleRowSelection:Pe,_toggleAllSelection:rt,toggleAllSelection:null,updateSelectionByRowKey:et,updateAllSelected:Ge,updateFilters:oe,updateCurrentRow:Be,updateSort:Me,execFilter:fe,execSort:pe,execQuery:ot,clearFilter:xe,clearSort:ae,toggleRowExpansion:Ce,setExpandRowKeysAdapter:Nt=>{X(Nt),se(Nt)},setCurrentRowKey:ct,toggleRowExpansionAdapter:(Nt,Lt)=>{y.value.some(({type:Gt})=>Gt==="expand")?Ce(Nt,Lt):Ae(Nt,Lt)},isRowExpanded:K,updateExpandRows:he,updateCurrentRowData:be,loadOrToggle:ye,updateTreeData:Se,states:{tableSize:a,rowKey:s,data:c,_data:f,isComplex:d,_columns:p,originColumns:g,columns:y,fixedColumns:b,rightFixedColumns:E,leafColumns:T,fixedLeafColumns:S,rightFixedLeafColumns:I,updateOrderFns:A,leafColumnsLength:M,fixedLeafColumnsLength:F,rightFixedLeafColumnsLength:L,isAllSelected:O,selection:N,reserveSelection:Q,selectOnIndeterminate:ie,selectable:j,filters:V,filteredData:D,sortingColumn:te,sortProp:ue,sortOrder:J,hoverRow:le,...G,...Xe,...At}}}function wC(t,n){return t.map(a=>{var s;return a.id===n.id?n:((s=a.children)!=null&&s.length&&(a.children=wC(a.children,n)),a)})}function EC(t){t.forEach(n=>{var a,s;n.no=(a=n.getColumnIndex)==null?void 0:a.call(n),(s=n.children)!=null&&s.length&&EC(n.children)}),t.sort((n,a)=>n.no-a.no)}function Zpe(){const t=Tn(),n=Xpe();return{ns:Rr("table"),...n,mutations:{setData(d,p){const g=W(d._data)!==p;d.data.value=p,d._data.value=p,t.store.execQuery(),t.store.updateCurrentRowData(),t.store.updateExpandRows(),t.store.updateTreeData(t.store.states.defaultExpandAll.value),W(d.reserveSelection)?(t.store.assertRowKey(),t.store.updateSelectionByRowKey()):g?t.store.clearSelection():t.store.cleanSelection(),t.store.updateAllSelected(),t.$ready&&t.store.scheduleLayout()},insertColumn(d,p,g,y){const b=W(d._columns);let E=[];g?(g&&!g.children&&(g.children=[]),g.children.push(p),E=wC(b,g)):(b.push(p),E=b),EC(E),d._columns.value=E,d.updateOrderFns.push(y),p.type==="selection"&&(d.selectable.value=p.selectable,d.reserveSelection.value=p.reserveSelection),t.$ready&&(t.store.updateColumns(),t.store.scheduleLayout())},updateColumnOrder(d,p){var g;((g=p.getColumnIndex)==null?void 0:g.call(p))!==p.no&&(EC(d._columns.value),t.$ready&&t.store.updateColumns())},removeColumn(d,p,g,y){const b=W(d._columns)||[];if(g)g.children.splice(g.children.findIndex(T=>T.id===p.id),1),Fn(()=>{var T;((T=g.children)==null?void 0:T.length)===0&&delete g.children}),d._columns.value=wC(b,g);else{const T=b.indexOf(p);T>-1&&(b.splice(T,1),d._columns.value=b)}const E=d.updateOrderFns.indexOf(y);E>-1&&d.updateOrderFns.splice(E,1),t.$ready&&(t.store.updateColumns(),t.store.scheduleLayout())},sort(d,p){const{prop:g,order:y,init:b}=p;if(g){const E=W(d.columns).find(T=>T.property===g);E&&(E.order=y,t.store.updateSort(E,g,y),t.store.commit("changeSortCondition",{init:b}))}},changeSortCondition(d,p){const{sortingColumn:g,sortProp:y,sortOrder:b}=d,E=W(g),T=W(y),S=W(b);S===null&&(d.sortingColumn.value=null,d.sortProp.value=null);const I={filter:!0};t.store.execQuery(I),(!p||!(p.silent||p.init))&&t.emit("sort-change",{column:E,prop:T,order:S}),t.store.updateTableScrollY()},filterChange(d,p){const{column:g,values:y,silent:b}=p,E=t.store.updateFilters(g,y);t.store.execQuery(),b||t.emit("filter-change",E),t.store.updateTableScrollY()},toggleAllSelection(){t.store.toggleAllSelection()},rowSelectedChanged(d,p){t.store.toggleRowSelection(p),t.store.updateAllSelected()},setHoverRow(d,p){d.hoverRow.value=p},setCurrentRow(d,p){t.store.updateCurrentRow(p)}},commit:function(d,...p){const g=t.store.mutations;if(g[d])g[d].apply(t,[t.store.states].concat(p));else throw new Error(`Action not found: ${d}`)},updateTableScrollY:function(){Fn(()=>t.layout.updateScrollY.apply(t.layout))}}}const s_={rowKey:"rowKey",defaultExpandAll:"defaultExpandAll",selectOnIndeterminate:"selectOnIndeterminate",indent:"indent",lazy:"lazy",data:"data","treeProps.hasChildren":{key:"lazyColumnIdentifier",default:"hasChildren"},"treeProps.children":{key:"childrenColumnName",default:"children"}};function Kpe(t,n){if(!t)throw new Error("Table is required.");const a=Zpe();return a.toggleAllSelection=Gd(a._toggleAllSelection,10),Object.keys(s_).forEach(s=>{VN(jN(n,s),s,a)}),Ype(a,n),a}function Ype(t,n){Object.keys(s_).forEach(a=>{gr(()=>jN(n,a),s=>{VN(s,a,t)})})}function VN(t,n,a){let s=t,c=s_[n];typeof s_[n]=="object"&&(c=c.key,s=s||s_[n].default),a.states[c].value=s}function jN(t,n){if(n.includes(".")){const a=n.split(".");let s=t;return a.forEach(c=>{s=s[c]}),s}else return t[n]}class Jpe{constructor(n){this.observers=[],this.table=null,this.store=null,this.columns=[],this.fit=!0,this.showHeader=!0,this.height=Ze(null),this.scrollX=Ze(!1),this.scrollY=Ze(!1),this.bodyWidth=Ze(null),this.fixedWidth=Ze(null),this.rightFixedWidth=Ze(null),this.gutterWidth=0;for(const a in n)Kn(n,a)&&(ai(this[a])?this[a].value=n[a]:this[a]=n[a]);if(!this.table)throw new Error("Table is required for Table Layout");if(!this.store)throw new Error("Store is required for Table Layout")}updateScrollY(){if(this.height.value===null)return!1;const a=this.table.refs.scrollBarRef;if(this.table.vnode.el&&(a!=null&&a.wrapRef)){let s=!0;const c=this.scrollY.value;return s=a.wrapRef.scrollHeight>a.wrapRef.clientHeight,this.scrollY.value=s,c!==s}return!1}setHeight(n,a="height"){if(!Li)return;const s=this.table.vnode.el;if(n=Upe(n),this.height.value=Number(n),!s&&(n||n===0))return Fn(()=>this.setHeight(n,a));typeof n=="number"?(s.style[a]=`${n}px`,this.updateElsHeight()):typeof n=="string"&&(s.style[a]=n,this.updateElsHeight())}setMaxHeight(n){this.setHeight(n,"max-height")}getFlattenColumns(){const n=[];return this.table.store.states.columns.value.forEach(s=>{s.isColumnGroup?n.push.apply(n,s.columns):n.push(s)}),n}updateElsHeight(){this.updateScrollY(),this.notifyObservers("scrollable")}headerDisplayNone(n){if(!n)return!0;let a=n;for(;a.tagName!=="DIV";){if(getComputedStyle(a).display==="none")return!0;a=a.parentElement}return!1}updateColumnsWidth(){if(!Li)return;const n=this.fit,a=this.table.vnode.el.clientWidth;let s=0;const c=this.getFlattenColumns(),f=c.filter(g=>typeof g.width!="number");if(c.forEach(g=>{typeof g.width=="number"&&g.realWidth&&(g.realWidth=null)}),f.length>0&&n){if(c.forEach(g=>{s+=Number(g.width||g.minWidth||80)}),s<=a){this.scrollX.value=!1;const g=a-s;if(f.length===1)f[0].realWidth=Number(f[0].minWidth||80)+g;else{const y=f.reduce((T,S)=>T+Number(S.minWidth||80),0),b=g/y;let E=0;f.forEach((T,S)=>{if(S===0)return;const I=Math.floor(Number(T.minWidth||80)*b);E+=I,T.realWidth=Number(T.minWidth||80)+I}),f[0].realWidth=Number(f[0].minWidth||80)+g-E}}else this.scrollX.value=!0,f.forEach(g=>{g.realWidth=Number(g.minWidth)});this.bodyWidth.value=Math.max(s,a),this.table.state.resizeState.value.width=this.bodyWidth.value}else c.forEach(g=>{!g.width&&!g.minWidth?g.realWidth=80:g.realWidth=Number(g.width||g.minWidth),s+=g.realWidth}),this.scrollX.value=s>a,this.bodyWidth.value=s;const d=this.store.states.fixedColumns.value;if(d.length>0){let g=0;d.forEach(y=>{g+=Number(y.realWidth||y.width)}),this.fixedWidth.value=g}const p=this.store.states.rightFixedColumns.value;if(p.length>0){let g=0;p.forEach(y=>{g+=Number(y.realWidth||y.width)}),this.rightFixedWidth.value=g}this.notifyObservers("columns")}addObserver(n){this.observers.push(n)}removeObserver(n){const a=this.observers.indexOf(n);a!==-1&&this.observers.splice(a,1)}notifyObservers(n){this.observers.forEach(s=>{var c,f;switch(n){case"columns":(c=s.state)==null||c.onColumnsChange(this);break;case"scrollable":(f=s.state)==null||f.onScrollableChange(this);break;default:throw new Error(`Table Layout don't have event ${n}.`)}})}}const{CheckboxGroup:Qpe}=Q0,e0e=Ft({name:"ElTableFilterPanel",components:{ElCheckbox:Q0,ElCheckboxGroup:Qpe,ElScrollbar:Dh,ElTooltip:sk,ElIcon:Hn,ArrowDown:ez,ArrowUp:Pie},directives:{ClickOutside:tN},props:{placement:{type:String,default:"bottom-start"},store:{type:Object},column:{type:Object},upDataColumn:{type:Function}},setup(t){const n=Tn(),{t:a}=Yo(),s=Rr("table-filter"),c=n==null?void 0:n.parent;c.filterPanels.value[t.column.id]||(c.filterPanels.value[t.column.id]=n);const f=Ze(!1),d=Ze(null),p=Ve(()=>t.column&&t.column.filters),g=Ve({get:()=>{var N;return(((N=t.column)==null?void 0:N.filteredValue)||[])[0]},set:N=>{y.value&&(typeof N<"u"&&N!==null?y.value.splice(0,1,N):y.value.splice(0,1))}}),y=Ve({get(){return t.column?t.column.filteredValue||[]:[]},set(N){t.column&&t.upDataColumn("filteredValue",N)}}),b=Ve(()=>t.column?t.column.filterMultiple:!0),E=N=>N.value===g.value,T=()=>{f.value=!1},S=N=>{N.stopPropagation(),f.value=!f.value},I=()=>{f.value=!1},A=()=>{L(y.value),T()},M=()=>{y.value=[],L(y.value),T()},F=N=>{g.value=N,L(typeof N<"u"&&N!==null?y.value:[]),T()},L=N=>{t.store.commit("filterChange",{column:t.column,values:N}),t.store.updateAllSelected()};gr(f,N=>{t.column&&t.upDataColumn("filterOpened",N)},{immediate:!0});const O=Ve(()=>{var N,Q;return(Q=(N=d.value)==null?void 0:N.popperRef)==null?void 0:Q.contentRef});return{tooltipVisible:f,multiple:b,filteredValue:y,filterValue:g,filters:p,handleConfirm:A,handleReset:M,handleSelect:F,isActive:E,t:a,ns:s,showFilterPanel:S,hideFilterPanel:I,popperPaneRef:O,tooltip:d}}}),t0e={key:0},r0e=["disabled"],n0e=["label","onClick"];function i0e(t,n,a,s,c,f){const d=Vi("el-checkbox"),p=Vi("el-checkbox-group"),g=Vi("el-scrollbar"),y=Vi("arrow-up"),b=Vi("arrow-down"),E=Vi("el-icon"),T=Vi("el-tooltip"),S=dA("click-outside");return De(),Ht(T,{ref:"tooltip",visible:t.tooltipVisible,offset:0,placement:t.placement,"show-arrow":!1,"stop-popper-mouse-event":!1,teleported:"",effect:"light",pure:"","popper-class":t.ns.b(),persistent:""},{content:we(()=>[t.multiple?(De(),yt("div",t0e,[gt("div",{class:ht(t.ns.e("content"))},[me(g,{"wrap-class":t.ns.e("wrap")},{default:we(()=>[me(p,{modelValue:t.filteredValue,"onUpdate:modelValue":n[0]||(n[0]=I=>t.filteredValue=I),class:ht(t.ns.e("checkbox-group"))},{default:we(()=>[(De(!0),yt(mn,null,pa(t.filters,I=>(De(),Ht(d,{key:I.value,label:I.value},{default:we(()=>[Sr(Lr(I.text),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue","class"])]),_:1},8,["wrap-class"])],2),gt("div",{class:ht(t.ns.e("bottom"))},[gt("button",{class:ht({[t.ns.is("disabled")]:t.filteredValue.length===0}),disabled:t.filteredValue.length===0,type:"button",onClick:n[1]||(n[1]=(...I)=>t.handleConfirm&&t.handleConfirm(...I))},Lr(t.t("el.table.confirmFilter")),11,r0e),gt("button",{type:"button",onClick:n[2]||(n[2]=(...I)=>t.handleReset&&t.handleReset(...I))},Lr(t.t("el.table.resetFilter")),1)],2)])):(De(),yt("ul",{key:1,class:ht(t.ns.e("list"))},[gt("li",{class:ht([t.ns.e("list-item"),{[t.ns.is("active")]:t.filterValue===void 0||t.filterValue===null}]),onClick:n[3]||(n[3]=I=>t.handleSelect(null))},Lr(t.t("el.table.clearFilter")),3),(De(!0),yt(mn,null,pa(t.filters,I=>(De(),yt("li",{key:I.value,class:ht([t.ns.e("list-item"),t.ns.is("active",t.isActive(I))]),label:I.value,onClick:A=>t.handleSelect(I.value)},Lr(I.text),11,n0e))),128))],2))]),default:we(()=>[ci((De(),yt("span",{class:ht([`${t.ns.namespace.value}-table__column-filter-trigger`,`${t.ns.namespace.value}-none-outline`]),onClick:n[4]||(n[4]=(...I)=>t.showFilterPanel&&t.showFilterPanel(...I))},[me(E,null,{default:we(()=>[t.column.filterOpened?(De(),Ht(y,{key:0})):(De(),Ht(b,{key:1}))]),_:1})],2)),[[S,t.hideFilterPanel,t.popperPaneRef]])]),_:1},8,["visible","placement","popper-class"])}var a0e=Hr(e0e,[["render",i0e],["__file","/home/runner/work/element-plus/element-plus/packages/components/table/src/filter-panel.vue"]]);function WN(t){const n=Tn();Cb(()=>{a.value.addObserver(n)}),di(()=>{s(a.value),c(a.value)}),hm(()=>{s(a.value),c(a.value)}),of(()=>{a.value.removeObserver(n)});const a=Ve(()=>{const f=t.layout;if(!f)throw new Error("Can not find table layout.");return f}),s=f=>{var d;const p=((d=t.vnode.el)==null?void 0:d.querySelectorAll("colgroup > col"))||[];if(!p.length)return;const g=f.getFlattenColumns(),y={};g.forEach(b=>{y[b.id]=b});for(let b=0,E=p.length;b<E;b++){const T=p[b],S=T.getAttribute("name"),I=y[S];I&&T.setAttribute("width",I.realWidth||I.width)}},c=f=>{var d,p;const g=((d=t.vnode.el)==null?void 0:d.querySelectorAll("colgroup > col[name=gutter]"))||[];for(let b=0,E=g.length;b<E;b++)g[b].setAttribute("width",f.scrollY.value?f.gutterWidth:"0");const y=((p=t.vnode.el)==null?void 0:p.querySelectorAll("th.gutter"))||[];for(let b=0,E=y.length;b<E;b++){const T=y[b];T.style.width=f.scrollY.value?`${f.gutterWidth}px`:"0",T.style.display=f.scrollY.value?"":"none"}};return{tableLayout:a.value,onColumnsChange:s,onScrollableChange:c}}const fu=Symbol("ElTable");function o0e(t,n){const a=Tn(),s=Gr(fu),c=A=>{A.stopPropagation()},f=(A,M)=>{!M.filters&&M.sortable?I(A,M,!1):M.filterable&&!M.sortable&&c(A),s==null||s.emit("header-click",M,A)},d=(A,M)=>{s==null||s.emit("header-contextmenu",M,A)},p=Ze(null),g=Ze(!1),y=Ze({}),b=(A,M)=>{if(Li&&!(M.children&&M.children.length>0)&&p.value&&t.border){g.value=!0;const F=s;n("set-drag-visible",!0);const O=(F==null?void 0:F.vnode.el).getBoundingClientRect().left,N=a.vnode.el.querySelector(`th.${M.id}`),Q=N.getBoundingClientRect(),ie=Q.left-O+30;D_(N,"noclick"),y.value={startMouseLeft:A.clientX,startLeft:Q.right-O,startColumnLeft:Q.left-O,tableLeft:O};const j=F==null?void 0:F.refs.resizeProxy;j.style.left=`${y.value.startLeft}px`,document.onselectstart=function(){return!1},document.ondragstart=function(){return!1};const V=te=>{const ue=te.clientX-y.value.startMouseLeft,J=y.value.startLeft+ue;j.style.left=`${Math.max(ie,J)}px`},D=()=>{if(g.value){const{startColumnLeft:te,startLeft:ue}=y.value,le=Number.parseInt(j.style.left,10)-te;M.width=M.realWidth=le,F==null||F.emit("header-dragend",M.width,ue-te,M,A),requestAnimationFrame(()=>{t.store.scheduleLayout(!1,!0)}),document.body.style.cursor="",g.value=!1,p.value=null,y.value={},n("set-drag-visible",!1)}document.removeEventListener("mousemove",V),document.removeEventListener("mouseup",D),document.onselectstart=null,document.ondragstart=null,setTimeout(()=>{Sh(N,"noclick")},0)};document.addEventListener("mousemove",V),document.addEventListener("mouseup",D)}},E=(A,M)=>{if(M.children&&M.children.length>0)return;const F=A.target;if(!pc(F))return;const L=F==null?void 0:F.closest("th");if(!(!M||!M.resizable)&&!g.value&&t.border){const O=L.getBoundingClientRect(),N=document.body.style;O.width>12&&O.right-A.pageX<8?(N.cursor="col-resize",F0(L,"is-sortable")&&(L.style.cursor="col-resize"),p.value=M):g.value||(N.cursor="",F0(L,"is-sortable")&&(L.style.cursor="pointer"),p.value=null)}},T=()=>{Li&&(document.body.style.cursor="")},S=({order:A,sortOrders:M})=>{if(A==="")return M[0];const F=M.indexOf(A||null);return M[F>M.length-2?0:F+1]},I=(A,M,F)=>{var L;A.stopPropagation();const O=M.order===F?null:F||S(M),N=(L=A.target)==null?void 0:L.closest("th");if(N&&F0(N,"noclick")){Sh(N,"noclick");return}if(!M.sortable)return;const Q=t.store.states;let ie=Q.sortProp.value,j;const V=Q.sortingColumn.value;(V!==M||V===M&&V.order===null)&&(V&&(V.order=null),Q.sortingColumn.value=M,ie=M.property),O?j=M.order=O:j=M.order=null,Q.sortProp.value=ie,Q.sortOrder.value=j,s==null||s.store.commit("changeSortCondition")};return{handleHeaderClick:f,handleHeaderContextMenu:d,handleMouseDown:b,handleMouseMove:E,handleMouseOut:T,handleSortClick:I,handleFilterClick:c}}function s0e(t){const n=Gr(fu),a=Rr("table");return{getHeaderRowStyle:p=>{const g=n==null?void 0:n.props.headerRowStyle;return typeof g=="function"?g.call(null,{rowIndex:p}):g},getHeaderRowClass:p=>{const g=[],y=n==null?void 0:n.props.headerRowClassName;return typeof y=="string"?g.push(y):typeof y=="function"&&g.push(y.call(null,{rowIndex:p})),g.join(" ")},getHeaderCellStyle:(p,g,y,b)=>{var E;let T=(E=n==null?void 0:n.props.headerCellStyle)!=null?E:{};typeof T=="function"&&(T=T.call(null,{rowIndex:p,columnIndex:g,row:y,column:b}));const S=dk(g,b.fixed,t.store,y);return em(S,"left"),em(S,"right"),Object.assign({},T,S)},getHeaderCellClass:(p,g,y,b)=>{const E=hk(a.b(),g,b.fixed,t.store,y),T=[b.id,b.order,b.headerAlign,b.className,b.labelClassName,...E];b.children||T.push("is-leaf"),b.sortable&&T.push("is-sortable");const S=n==null?void 0:n.props.headerCellClassName;return typeof S=="string"?T.push(S):typeof S=="function"&&T.push(S.call(null,{rowIndex:p,columnIndex:g,row:y,column:b})),T.push(a.e("cell")),T.filter(I=>!!I).join(" ")}}}const HN=t=>{const n=[];return t.forEach(a=>{a.children?(n.push(a),n.push.apply(n,HN(a.children))):n.push(a)}),n},l0e=t=>{let n=1;const a=(f,d)=>{if(d&&(f.level=d.level+1,n<f.level&&(n=f.level)),f.children){let p=0;f.children.forEach(g=>{a(g,f),p+=g.colSpan}),f.colSpan=p}else f.colSpan=1};t.forEach(f=>{f.level=1,a(f,void 0)});const s=[];for(let f=0;f<n;f++)s.push([]);return HN(t).forEach(f=>{f.children?(f.rowSpan=1,f.children.forEach(d=>d.isSubColumn=!0)):f.rowSpan=n-f.level+1,s[f.level-1].push(f)}),s};function c0e(t){const n=Gr(fu),a=Ve(()=>l0e(t.store.states.originColumns.value));return{isGroup:Ve(()=>{const f=a.value.length>1;return f&&n&&(n.state.isGroup.value=!0),f}),toggleAllSelection:f=>{f.stopPropagation(),n==null||n.store.commit("toggleAllSelection")},columnRows:a}}var u0e=Ft({name:"ElTableHeader",components:{ElCheckbox:Q0},props:{fixed:{type:String,default:""},store:{required:!0,type:Object},border:Boolean,defaultSort:{type:Object,default:()=>({prop:"",order:""})}},setup(t,{emit:n}){const a=Tn(),s=Gr(fu),c=Rr("table"),f=Ze({}),{onColumnsChange:d,onScrollableChange:p}=WN(s);di(async()=>{await Fn(),await Fn();const{prop:ie,order:j}=t.defaultSort;s==null||s.store.commit("sort",{prop:ie,order:j,init:!0})});const{handleHeaderClick:g,handleHeaderContextMenu:y,handleMouseDown:b,handleMouseMove:E,handleMouseOut:T,handleSortClick:S,handleFilterClick:I}=o0e(t,n),{getHeaderRowStyle:A,getHeaderRowClass:M,getHeaderCellStyle:F,getHeaderCellClass:L}=s0e(t),{isGroup:O,toggleAllSelection:N,columnRows:Q}=c0e(t);return a.state={onColumnsChange:d,onScrollableChange:p},a.filterPanels=f,{ns:c,filterPanels:f,onColumnsChange:d,onScrollableChange:p,columnRows:Q,getHeaderRowClass:M,getHeaderRowStyle:A,getHeaderCellClass:L,getHeaderCellStyle:F,handleHeaderClick:g,handleHeaderContextMenu:y,handleMouseDown:b,handleMouseMove:E,handleMouseOut:T,handleSortClick:S,handleFilterClick:I,isGroup:O,toggleAllSelection:N}},render(){const{ns:t,isGroup:n,columnRows:a,getHeaderCellStyle:s,getHeaderCellClass:c,getHeaderRowClass:f,getHeaderRowStyle:d,handleHeaderClick:p,handleHeaderContextMenu:g,handleMouseDown:y,handleMouseMove:b,handleSortClick:E,handleMouseOut:T,store:S,$parent:I}=this;let A=1;return En("thead",{class:{[t.is("group")]:n}},a.map((M,F)=>En("tr",{class:f(F),key:F,style:d(F)},M.map((L,O)=>(L.rowSpan>A&&(A=L.rowSpan),En("th",{class:c(F,O,M,L),colspan:L.colSpan,key:`${L.id}-thead`,rowspan:L.rowSpan,style:s(F,O,M,L),onClick:N=>p(N,L),onContextmenu:N=>g(N,L),onMousedown:N=>y(N,L),onMousemove:N=>b(N,L),onMouseout:T},[En("div",{class:["cell",L.filteredValue&&L.filteredValue.length>0?"highlight":""]},[L.renderHeader?L.renderHeader({column:L,$index:O,store:S,_self:I}):L.label,L.sortable&&En("span",{onClick:N=>E(N,L),class:"caret-wrapper"},[En("i",{onClick:N=>E(N,L,"ascending"),class:"sort-caret ascending"}),En("i",{onClick:N=>E(N,L,"descending"),class:"sort-caret descending"})]),L.filterable&&En(a0e,{store:S,placement:L.filterPlacement||"bottom-start",column:L,upDataColumn:(N,Q)=>{L[N]=Q}})])]))))))}});function f0e(t){const n=Gr(fu),a=Ze(""),s=Ze(En("div")),{nextZIndex:c}=jb(),f=(I,A,M)=>{var F;const L=n,O=iS(I);let N;const Q=(F=L==null?void 0:L.vnode.el)==null?void 0:F.dataset.prefix;O&&(N=t5({columns:t.store.states.columns.value},O,Q),N&&(L==null||L.emit(`cell-${M}`,A,N,O,I))),L==null||L.emit(`row-${M}`,A,N,I)},d=(I,A)=>{f(I,A,"dblclick")},p=(I,A)=>{t.store.commit("setCurrentRow",A),f(I,A,"click")},g=(I,A)=>{f(I,A,"contextmenu")},y=Gd(I=>{t.store.commit("setHoverRow",I)},30),b=Gd(()=>{t.store.commit("setHoverRow",null)},30),E=I=>{const A=window.getComputedStyle(I,null),M=Number.parseInt(A.paddingLeft,10)||0,F=Number.parseInt(A.paddingRight,10)||0,L=Number.parseInt(A.paddingTop,10)||0,O=Number.parseInt(A.paddingBottom,10)||0;return{left:M,right:F,top:L,bottom:O}};return{handleDoubleClick:d,handleClick:p,handleContextMenu:g,handleMouseEnter:y,handleMouseLeave:b,handleCellMouseEnter:(I,A,M)=>{var F;const L=n,O=iS(I),N=(F=L==null?void 0:L.vnode.el)==null?void 0:F.dataset.prefix;if(O){const Ee=t5({columns:t.store.states.columns.value},O,N),ut=L.hoverState={cell:O,column:Ee,row:A};L==null||L.emit("cell-mouse-enter",ut.row,ut.column,ut.cell,I)}if(!M)return;const Q=I.target.querySelector(".cell");if(!(F0(Q,`${N}-tooltip`)&&Q.childNodes.length))return;const ie=document.createRange();ie.setStart(Q,0),ie.setEnd(Q,Q.childNodes.length);let j=ie.getBoundingClientRect().width,V=ie.getBoundingClientRect().height;j-Math.floor(j)<.001&&(j=Math.floor(j)),V-Math.floor(V)<.001&&(V=Math.floor(V));const{top:ue,left:J,right:le,bottom:re}=E(Q),Fe=J+le,Ye=ue+re;(j+Fe>Q.offsetWidth||V+Ye>Q.offsetHeight||Q.scrollWidth>Q.offsetWidth)&&jpe(n==null?void 0:n.refs.tableWrapper,O,O.innerText||O.textContent,c,M)},handleCellMouseLeave:I=>{if(!iS(I))return;const M=n==null?void 0:n.hoverState;n==null||n.emit("cell-mouse-leave",M==null?void 0:M.row,M==null?void 0:M.column,M==null?void 0:M.cell,I)},tooltipContent:a,tooltipTrigger:s}}function h0e(t){const n=Gr(fu),a=Rr("table");return{getRowStyle:(y,b)=>{const E=n==null?void 0:n.props.rowStyle;return typeof E=="function"?E.call(null,{row:y,rowIndex:b}):E||null},getRowClass:(y,b)=>{const E=[a.e("row")];n!=null&&n.props.highlightCurrentRow&&y===t.store.states.currentRow.value&&E.push("current-row"),t.stripe&&b%2===1&&E.push(a.em("row","striped"));const T=n==null?void 0:n.props.rowClassName;return typeof T=="string"?E.push(T):typeof T=="function"&&E.push(T.call(null,{row:y,rowIndex:b})),E},getCellStyle:(y,b,E,T)=>{const S=n==null?void 0:n.props.cellStyle;let I=S??{};typeof S=="function"&&(I=S.call(null,{rowIndex:y,columnIndex:b,row:E,column:T}));const A=dk(b,t==null?void 0:t.fixed,t.store);return em(A,"left"),em(A,"right"),Object.assign({},I,A)},getCellClass:(y,b,E,T,S)=>{const I=hk(a.b(),b,t==null?void 0:t.fixed,t.store,void 0,S),A=[T.id,T.align,T.className,...I],M=n==null?void 0:n.props.cellClassName;return typeof M=="string"?A.push(M):typeof M=="function"&&A.push(M.call(null,{rowIndex:y,columnIndex:b,row:E,column:T})),A.push(a.e("cell")),A.filter(F=>!!F).join(" ")},getSpan:(y,b,E,T)=>{let S=1,I=1;const A=n==null?void 0:n.props.spanMethod;if(typeof A=="function"){const M=A({row:y,column:b,rowIndex:E,columnIndex:T});Array.isArray(M)?(S=M[0],I=M[1]):typeof M=="object"&&(S=M.rowspan,I=M.colspan)}return{rowspan:S,colspan:I}},getColspanRealWidth:(y,b,E)=>{if(b<1)return y[E].realWidth;const T=y.map(({realWidth:S,width:I})=>S||I).slice(E,E+b);return Number(T.reduce((S,I)=>Number(S)+Number(I),-1))}}}function d0e(t){const n=Gr(fu),a=Rr("table"),{handleDoubleClick:s,handleClick:c,handleContextMenu:f,handleMouseEnter:d,handleMouseLeave:p,handleCellMouseEnter:g,handleCellMouseLeave:y,tooltipContent:b,tooltipTrigger:E}=f0e(t),{getRowStyle:T,getRowClass:S,getCellStyle:I,getCellClass:A,getSpan:M,getColspanRealWidth:F}=h0e(t),L=Ve(()=>t.store.states.columns.value.findIndex(({type:j})=>j==="default")),O=(j,V)=>{const D=n.props.rowKey;return D?So(j,D):V},N=(j,V,D,te=!1)=>{const{tooltipEffect:ue,tooltipOptions:J,store:le}=t,{indent:re,columns:Fe}=le.states,Ye=S(j,V);let Ee=!0;return D&&(Ye.push(a.em("row",`level-${D.level}`)),Ee=D.display),En("tr",{style:[Ee?null:{display:"none"},T(j,V)],class:Ye,key:O(j,V),onDblclick:Ne=>s(Ne,j),onClick:Ne=>c(Ne,j),onContextmenu:Ne=>f(Ne,j),onMouseenter:()=>d(V),onMouseleave:p},Fe.value.map((Ne,He)=>{const{rowspan:Oe,colspan:Pe}=M(j,Ne,V,He);if(!Oe||!Pe)return null;const rt=Object.assign({},Ne);rt.realWidth=F(Fe.value,Pe,He);const et={store:t.store,_self:t.context||n,column:rt,row:j,$index:V,cellIndex:He,expanded:te};He===L.value&&D&&(et.treeNode={indent:D.level*re.value,level:D.level},typeof D.expanded=="boolean"&&(et.treeNode.expanded=D.expanded,"loading"in D&&(et.treeNode.loading=D.loading),"noLazyChildren"in D&&(et.treeNode.noLazyChildren=D.noLazyChildren)));const Ge=`${V},${He}`,ze=rt.columnKey||rt.rawColumnKey||"",oe=Q(He,Ne,et),Me=Ne.showOverflowTooltip&&Y8({effect:ue},J,Ne.showOverflowTooltip);return En("td",{style:I(V,He,j,Ne),class:A(V,He,j,Ne,Pe-1),key:`${ze}${Ge}`,rowspan:Oe,colspan:Pe,onMouseenter:fe=>g(fe,j,Me),onMouseleave:y},[oe])}))},Q=(j,V,D)=>V.renderCell(D);return{wrappedRowRender:(j,V)=>{const D=t.store,{isRowExpanded:te,assertRowKey:ue}=D,{treeData:J,lazyTreeNodeMap:le,childrenColumnName:re,rowKey:Fe}=D.states,Ye=D.states.columns.value;if(Ye.some(({type:ut})=>ut==="expand")){const ut=te(j),Ne=N(j,V,void 0,ut),He=n.renderExpanded;return ut?He?[[Ne,En("tr",{key:`expanded-row__${Ne.key}`},[En("td",{colspan:Ye.length,class:`${a.e("cell")} ${a.e("expanded-cell")}`},[He({row:j,$index:V,store:D,expanded:ut})])])]]:(console.error("[Element Error]renderExpanded is required."),Ne):[[Ne]]}else if(Object.keys(J.value).length){ue();const ut=So(j,Fe.value);let Ne=J.value[ut],He=null;Ne&&(He={expanded:Ne.expanded,level:Ne.level,display:!0},typeof Ne.lazy=="boolean"&&(typeof Ne.loaded=="boolean"&&Ne.loaded&&(He.noLazyChildren=!(Ne.children&&Ne.children.length)),He.loading=Ne.loading));const Oe=[N(j,V,He)];if(Ne){let Pe=0;const rt=(Ge,ze)=>{Ge&&Ge.length&&ze&&Ge.forEach(oe=>{const Me={display:ze.display&&ze.expanded,level:ze.level+1,expanded:!1,noLazyChildren:!1,loading:!1},fe=So(oe,Fe.value);if(fe==null)throw new Error("For nested data item, row-key is required.");if(Ne={...J.value[fe]},Ne&&(Me.expanded=Ne.expanded,Ne.level=Ne.level||Me.level,Ne.display=!!(Ne.expanded&&Me.display),typeof Ne.lazy=="boolean"&&(typeof Ne.loaded=="boolean"&&Ne.loaded&&(Me.noLazyChildren=!(Ne.children&&Ne.children.length)),Me.loading=Ne.loading)),Pe++,Oe.push(N(oe,V+Pe,Me)),Ne){const pe=le.value[fe]||oe[re.value];rt(pe,Ne)}})};Ne.display=!0;const et=le.value[ut]||j[re.value];rt(et,Ne)}return Oe}else return N(j,V,void 0)},tooltipContent:b,tooltipTrigger:E}}const p0e={store:{required:!0,type:Object},stripe:Boolean,tooltipEffect:String,tooltipOptions:{type:Object},context:{default:()=>({}),type:Object},rowClassName:[String,Function],rowStyle:[Object,Function],fixed:{type:String,default:""},highlight:Boolean};var m0e=Ft({name:"ElTableBody",props:p0e,setup(t){const n=Tn(),a=Gr(fu),s=Rr("table"),{wrappedRowRender:c,tooltipContent:f,tooltipTrigger:d}=d0e(t),{onColumnsChange:p,onScrollableChange:g}=WN(a);return gr(t.store.states.hoverRow,(y,b)=>{!t.store.states.isComplex.value||!Li||bae(()=>{const E=n==null?void 0:n.vnode.el,T=Array.from((E==null?void 0:E.children)||[]).filter(A=>A==null?void 0:A.classList.contains(`${s.e("row")}`)),S=T[b],I=T[y];S&&Sh(S,"hover-row"),I&&D_(I,"hover-row")})}),of(()=>{var y;(y=zu)==null||y()}),{ns:s,onColumnsChange:p,onScrollableChange:g,wrappedRowRender:c,tooltipContent:f,tooltipTrigger:d}},render(){const{wrappedRowRender:t,store:n}=this,a=n.states.data.value||[];return En("tbody",{tabIndex:-1},[a.reduce((s,c)=>s.concat(t(c,s.length)),[])])}});function g0e(){const t=Gr(fu),n=t==null?void 0:t.store,a=Ve(()=>n.states.fixedLeafColumnsLength.value),s=Ve(()=>n.states.rightFixedColumns.value.length),c=Ve(()=>n.states.columns.value.length),f=Ve(()=>n.states.fixedColumns.value.length),d=Ve(()=>n.states.rightFixedColumns.value.length);return{leftFixedLeafCount:a,rightFixedLeafCount:s,columnsCount:c,leftFixedCount:f,rightFixedCount:d,columns:n.states.columns}}function _0e(t){const{columns:n}=g0e(),a=Rr("table");return{getCellClasses:(f,d)=>{const p=f[d],g=[a.e("cell"),p.id,p.align,p.labelClassName,...hk(a.b(),d,p.fixed,t.store)];return p.className&&g.push(p.className),p.children||g.push(a.is("leaf")),g},getCellStyles:(f,d)=>{const p=dk(d,f.fixed,t.store);return em(p,"left"),em(p,"right"),p},columns:n}}var v0e=Ft({name:"ElTableFooter",props:{fixed:{type:String,default:""},store:{required:!0,type:Object},summaryMethod:Function,sumText:String,border:Boolean,defaultSort:{type:Object,default:()=>({prop:"",order:""})}},setup(t){const{getCellClasses:n,getCellStyles:a,columns:s}=_0e(t);return{ns:Rr("table"),getCellClasses:n,getCellStyles:a,columns:s}},render(){const{columns:t,getCellStyles:n,getCellClasses:a,summaryMethod:s,sumText:c}=this,f=this.store.states.data.value;let d=[];return s?d=s({columns:t,data:f}):t.forEach((p,g)=>{if(g===0){d[g]=c;return}const y=f.map(S=>Number(S[p.property])),b=[];let E=!0;y.forEach(S=>{if(!Number.isNaN(+S)){E=!1;const I=`${S}`.split(".")[1];b.push(I?I.length:0)}});const T=Math.max.apply(null,b);E?d[g]="":d[g]=y.reduce((S,I)=>{const A=Number(I);return Number.isNaN(+A)?S:Number.parseFloat((S+I).toFixed(Math.min(T,20)))},0)}),En(En("tfoot",[En("tr",{},[...t.map((p,g)=>En("td",{key:g,colspan:p.colSpan,rowspan:p.rowSpan,class:a(t,g),style:n(p,g)},[En("div",{class:["cell",p.labelClassName]},[d[g]])]))])]))}});function y0e(t){return{setCurrentRow:b=>{t.commit("setCurrentRow",b)},getSelectionRows:()=>t.getSelectionRows(),toggleRowSelection:(b,E)=>{t.toggleRowSelection(b,E,!1),t.updateAllSelected()},clearSelection:()=>{t.clearSelection()},clearFilter:b=>{t.clearFilter(b)},toggleAllSelection:()=>{t.commit("toggleAllSelection")},toggleRowExpansion:(b,E)=>{t.toggleRowExpansionAdapter(b,E)},clearSort:()=>{t.clearSort()},sort:(b,E)=>{t.commit("sort",{prop:b,order:E})}}}function x0e(t,n,a,s){const c=Ze(!1),f=Ze(null),d=Ze(!1),p=Ne=>{d.value=Ne},g=Ze({width:null,height:null,headerHeight:null}),y=Ze(!1),b={display:"inline-block",verticalAlign:"middle"},E=Ze(),T=Ze(0),S=Ze(0),I=Ze(0),A=Ze(0),M=Ze(0);wh(()=>{n.setHeight(t.height)}),wh(()=>{n.setMaxHeight(t.maxHeight)}),gr(()=>[t.currentRowKey,a.states.rowKey],([Ne,He])=>{!W(He)||!W(Ne)||a.setCurrentRowKey(`${Ne}`)},{immediate:!0}),gr(()=>t.data,Ne=>{s.store.commit("setData",Ne)},{immediate:!0,deep:!0}),wh(()=>{t.expandRowKeys&&a.setExpandRowKeysAdapter(t.expandRowKeys)});const F=()=>{s.store.commit("setHoverRow",null),s.hoverState&&(s.hoverState=null)},L=(Ne,He)=>{const{pixelX:Oe,pixelY:Pe}=He;Math.abs(Oe)>=Math.abs(Pe)&&(s.refs.bodyWrapper.scrollLeft+=He.pixelX/5)},O=Ve(()=>t.height||t.maxHeight||a.states.fixedColumns.value.length>0||a.states.rightFixedColumns.value.length>0),N=Ve(()=>({width:n.bodyWidth.value?`${n.bodyWidth.value}px`:""})),Q=()=>{O.value&&n.updateElsHeight(),n.updateColumnsWidth(),requestAnimationFrame(D)};di(async()=>{await Fn(),a.updateColumns(),te(),requestAnimationFrame(Q);const Ne=s.vnode.el,He=s.refs.headerWrapper;t.flexible&&Ne&&Ne.parentElement&&(Ne.parentElement.style.minWidth="0"),g.value={width:E.value=Ne.offsetWidth,height:Ne.offsetHeight,headerHeight:t.showHeader&&He?He.offsetHeight:null},a.states.columns.value.forEach(Oe=>{Oe.filteredValue&&Oe.filteredValue.length&&s.store.commit("filterChange",{column:Oe,values:Oe.filteredValue,silent:!0})}),s.$ready=!0});const ie=(Ne,He)=>{if(!Ne)return;const Oe=Array.from(Ne.classList).filter(Pe=>!Pe.startsWith("is-scrolling-"));Oe.push(n.scrollX.value?He:"is-scrolling-none"),Ne.className=Oe.join(" ")},j=Ne=>{const{tableWrapper:He}=s.refs;ie(He,Ne)},V=Ne=>{const{tableWrapper:He}=s.refs;return!!(He&&He.classList.contains(Ne))},D=function(){if(!s.refs.scrollBarRef)return;if(!n.scrollX.value){const ze="is-scrolling-none";V(ze)||j(ze);return}const Ne=s.refs.scrollBarRef.wrapRef;if(!Ne)return;const{scrollLeft:He,offsetWidth:Oe,scrollWidth:Pe}=Ne,{headerWrapper:rt,footerWrapper:et}=s.refs;rt&&(rt.scrollLeft=He),et&&(et.scrollLeft=He);const Ge=Pe-Oe-1;He>=Ge?j("is-scrolling-right"):j(He===0?"is-scrolling-left":"is-scrolling-middle")},te=()=>{s.refs.scrollBarRef&&(s.refs.scrollBarRef.wrapRef&&Bs(s.refs.scrollBarRef.wrapRef,"scroll",D,{passive:!0}),t.fit?dc(s.vnode.el,ue):Bs(window,"resize",ue),dc(s.refs.bodyWrapper,()=>{var Ne,He;ue(),(He=(Ne=s.refs)==null?void 0:Ne.scrollBarRef)==null||He.update()}))},ue=()=>{var Ne,He,Oe,Pe;const rt=s.vnode.el;if(!s.$ready||!rt)return;let et=!1;const{width:Ge,height:ze,headerHeight:oe}=g.value,Me=E.value=rt.offsetWidth;Ge!==Me&&(et=!0);const fe=rt.offsetHeight;(t.height||O.value)&&ze!==fe&&(et=!0);const pe=t.tableLayout==="fixed"?s.refs.headerWrapper:(Ne=s.refs.tableHeaderRef)==null?void 0:Ne.$el;t.showHeader&&(pe==null?void 0:pe.offsetHeight)!==oe&&(et=!0),T.value=((He=s.refs.tableWrapper)==null?void 0:He.scrollHeight)||0,I.value=(pe==null?void 0:pe.scrollHeight)||0,A.value=((Oe=s.refs.footerWrapper)==null?void 0:Oe.offsetHeight)||0,M.value=((Pe=s.refs.appendWrapper)==null?void 0:Pe.offsetHeight)||0,S.value=T.value-I.value-A.value-M.value,et&&(g.value={width:Me,height:fe,headerHeight:t.showHeader&&(pe==null?void 0:pe.offsetHeight)||0},Q())},J=_c(),le=Ve(()=>{const{bodyWidth:Ne,scrollY:He,gutterWidth:Oe}=n;return Ne.value?`${Ne.value-(He.value?Oe:0)}px`:""}),re=Ve(()=>t.maxHeight?"fixed":t.tableLayout),Fe=Ve(()=>{if(t.data&&t.data.length)return null;let Ne="100%";t.height&&S.value&&(Ne=`${S.value}px`);const He=E.value;return{width:He?`${He}px`:"",height:Ne}}),Ye=Ve(()=>t.height?{height:Number.isNaN(Number(t.height))?t.height:`${t.height}px`}:t.maxHeight?{maxHeight:Number.isNaN(Number(t.maxHeight))?t.maxHeight:`${t.maxHeight}px`}:{}),Ee=Ve(()=>t.height?{height:"100%"}:t.maxHeight?Number.isNaN(Number(t.maxHeight))?{maxHeight:`calc(${t.maxHeight} - ${I.value+A.value}px)`}:{maxHeight:`${t.maxHeight-I.value-A.value}px`}:{});return{isHidden:c,renderExpanded:f,setDragVisible:p,isGroup:y,handleMouseLeave:F,handleHeaderFooterMousewheel:L,tableSize:J,emptyBlockStyle:Fe,handleFixedMousewheel:(Ne,He)=>{const Oe=s.refs.bodyWrapper;if(Math.abs(He.spinY)>0){const Pe=Oe.scrollTop;He.pixelY<0&&Pe!==0&&Ne.preventDefault(),He.pixelY>0&&Oe.scrollHeight-Oe.clientHeight>Pe&&Ne.preventDefault(),Oe.scrollTop+=Math.ceil(He.pixelY/5)}else Oe.scrollLeft+=Math.ceil(He.pixelX/5)},resizeProxyVisible:d,bodyWidth:le,resizeState:g,doLayout:Q,tableBodyStyles:N,tableLayout:re,scrollbarViewStyle:b,tableInnerStyle:Ye,scrollbarStyle:Ee}}function b0e(t){const n=Ze(),a=()=>{const c=t.vnode.el.querySelector(".hidden-columns"),f={childList:!0,subtree:!0},d=t.store.states.updateOrderFns;n.value=new MutationObserver(()=>{d.forEach(p=>p())}),n.value.observe(c,f)};di(()=>{a()}),of(()=>{var s;(s=n.value)==null||s.disconnect()})}var w0e={data:{type:Array,default:()=>[]},size:Rh,width:[String,Number],height:[String,Number],maxHeight:[String,Number],fit:{type:Boolean,default:!0},stripe:Boolean,border:Boolean,rowKey:[String,Function],showHeader:{type:Boolean,default:!0},showSummary:Boolean,sumText:String,summaryMethod:Function,rowClassName:[String,Function],rowStyle:[Object,Function],cellClassName:[String,Function],cellStyle:[Object,Function],headerRowClassName:[String,Function],headerRowStyle:[Object,Function],headerCellClassName:[String,Function],headerCellStyle:[Object,Function],highlightCurrentRow:Boolean,currentRowKey:[String,Number],emptyText:String,expandRowKeys:Array,defaultExpandAll:Boolean,defaultSort:Object,tooltipEffect:String,tooltipOptions:Object,spanMethod:Function,selectOnIndeterminate:{type:Boolean,default:!0},indent:{type:Number,default:16},treeProps:{type:Object,default:()=>({hasChildren:"hasChildren",children:"children"})},lazy:Boolean,load:Function,style:{type:Object,default:()=>({})},className:{type:String,default:""},tableLayout:{type:String,default:"fixed"},scrollbarAlwaysOn:{type:Boolean,default:!1},flexible:Boolean,showOverflowTooltip:[Boolean,Object]};function GN(t){const n=t.tableLayout==="auto";let a=t.columns||[];n&&a.every(c=>c.width===void 0)&&(a=[]);const s=c=>{const f={key:`${t.tableLayout}_${c.id}`,style:{},name:void 0};return n?f.style={width:`${c.width}px`}:f.name=c.id,f};return En("colgroup",{},a.map(c=>En("col",s(c))))}GN.props=["columns","tableLayout"];const E0e=()=>{const t=Ze(),n=(f,d)=>{const p=t.value;p&&p.scrollTo(f,d)},a=(f,d)=>{const p=t.value;p&&yi(d)&&["Top","Left"].includes(f)&&p[`setScroll${f}`](d)};return{scrollBarRef:t,scrollTo:n,setScrollTop:f=>a("Top",f),setScrollLeft:f=>a("Left",f)}};let T0e=1;const S0e=Ft({name:"ElTable",directives:{Mousewheel:eue},components:{TableHeader:u0e,TableBody:m0e,TableFooter:v0e,ElScrollbar:Dh,hColgroup:GN},props:w0e,emits:["select","select-all","selection-change","cell-mouse-enter","cell-mouse-leave","cell-contextmenu","cell-click","cell-dblclick","row-click","row-contextmenu","row-dblclick","header-click","header-contextmenu","sort-change","filter-change","current-change","header-dragend","expand-change"],setup(t){const{t:n}=Yo(),a=Rr("table"),s=Tn();Ji(fu,s);const c=Kpe(s,t);s.store=c;const f=new Jpe({store:s.store,table:s,fit:t.fit,showHeader:t.showHeader});s.layout=f;const d=Ve(()=>(c.states.data.value||[]).length===0),{setCurrentRow:p,getSelectionRows:g,toggleRowSelection:y,clearSelection:b,clearFilter:E,toggleAllSelection:T,toggleRowExpansion:S,clearSort:I,sort:A}=y0e(c),{isHidden:M,renderExpanded:F,setDragVisible:L,isGroup:O,handleMouseLeave:N,handleHeaderFooterMousewheel:Q,tableSize:ie,emptyBlockStyle:j,handleFixedMousewheel:V,resizeProxyVisible:D,bodyWidth:te,resizeState:ue,doLayout:J,tableBodyStyles:le,tableLayout:re,scrollbarViewStyle:Fe,tableInnerStyle:Ye,scrollbarStyle:Ee}=x0e(t,f,c,s),{scrollBarRef:ut,scrollTo:Ne,setScrollLeft:He,setScrollTop:Oe}=E0e(),Pe=Gd(J,50),rt=`${a.namespace.value}-table_${T0e++}`;s.tableId=rt,s.state={isGroup:O,resizeState:ue,doLayout:J,debouncedUpdateLayout:Pe};const et=Ve(()=>t.sumText||n("el.table.sumText")),Ge=Ve(()=>t.emptyText||n("el.table.emptyText"));return b0e(s),{ns:a,layout:f,store:c,handleHeaderFooterMousewheel:Q,handleMouseLeave:N,tableId:rt,tableSize:ie,isHidden:M,isEmpty:d,renderExpanded:F,resizeProxyVisible:D,resizeState:ue,isGroup:O,bodyWidth:te,tableBodyStyles:le,emptyBlockStyle:j,debouncedUpdateLayout:Pe,handleFixedMousewheel:V,setCurrentRow:p,getSelectionRows:g,toggleRowSelection:y,clearSelection:b,clearFilter:E,toggleAllSelection:T,toggleRowExpansion:S,clearSort:I,doLayout:J,sort:A,t:n,setDragVisible:L,context:s,computedSumText:et,computedEmptyText:Ge,tableLayout:re,scrollbarViewStyle:Fe,tableInnerStyle:Ye,scrollbarStyle:Ee,scrollBarRef:ut,scrollTo:Ne,setScrollLeft:He,setScrollTop:Oe}}}),C0e=["data-prefix"],A0e={ref:"hiddenColumns",class:"hidden-columns"};function k0e(t,n,a,s,c,f){const d=Vi("hColgroup"),p=Vi("table-header"),g=Vi("table-body"),y=Vi("table-footer"),b=Vi("el-scrollbar"),E=dA("mousewheel");return De(),yt("div",{ref:"tableWrapper",class:ht([{[t.ns.m("fit")]:t.fit,[t.ns.m("striped")]:t.stripe,[t.ns.m("border")]:t.border||t.isGroup,[t.ns.m("hidden")]:t.isHidden,[t.ns.m("group")]:t.isGroup,[t.ns.m("fluid-height")]:t.maxHeight,[t.ns.m("scrollable-x")]:t.layout.scrollX.value,[t.ns.m("scrollable-y")]:t.layout.scrollY.value,[t.ns.m("enable-row-hover")]:!t.store.states.isComplex.value,[t.ns.m("enable-row-transition")]:(t.store.states.data.value||[]).length!==0&&(t.store.states.data.value||[]).length<100,"has-footer":t.showSummary},t.ns.m(t.tableSize),t.className,t.ns.b(),t.ns.m(`layout-${t.tableLayout}`)]),style:xn(t.style),"data-prefix":t.ns.namespace.value,onMouseleave:n[0]||(n[0]=(...T)=>t.handleMouseLeave&&t.handleMouseLeave(...T))},[gt("div",{class:ht(t.ns.e("inner-wrapper")),style:xn(t.tableInnerStyle)},[gt("div",A0e,[vr(t.$slots,"default")],512),t.showHeader&&t.tableLayout==="fixed"?ci((De(),yt("div",{key:0,ref:"headerWrapper",class:ht(t.ns.e("header-wrapper"))},[gt("table",{ref:"tableHeader",class:ht(t.ns.e("header")),style:xn(t.tableBodyStyles),border:"0",cellpadding:"0",cellspacing:"0"},[me(d,{columns:t.store.states.columns.value,"table-layout":t.tableLayout},null,8,["columns","table-layout"]),me(p,{ref:"tableHeaderRef",border:t.border,"default-sort":t.defaultSort,store:t.store,onSetDragVisible:t.setDragVisible},null,8,["border","default-sort","store","onSetDragVisible"])],6)],2)),[[E,t.handleHeaderFooterMousewheel]]):Wt("v-if",!0),gt("div",{ref:"bodyWrapper",class:ht(t.ns.e("body-wrapper"))},[me(b,{ref:"scrollBarRef","view-style":t.scrollbarViewStyle,"wrap-style":t.scrollbarStyle,always:t.scrollbarAlwaysOn},{default:we(()=>[gt("table",{ref:"tableBody",class:ht(t.ns.e("body")),cellspacing:"0",cellpadding:"0",border:"0",style:xn({width:t.bodyWidth,tableLayout:t.tableLayout})},[me(d,{columns:t.store.states.columns.value,"table-layout":t.tableLayout},null,8,["columns","table-layout"]),t.showHeader&&t.tableLayout==="auto"?(De(),Ht(p,{key:0,ref:"tableHeaderRef",class:ht(t.ns.e("body-header")),border:t.border,"default-sort":t.defaultSort,store:t.store,onSetDragVisible:t.setDragVisible},null,8,["class","border","default-sort","store","onSetDragVisible"])):Wt("v-if",!0),me(g,{context:t.context,highlight:t.highlightCurrentRow,"row-class-name":t.rowClassName,"tooltip-effect":t.tooltipEffect,"tooltip-options":t.tooltipOptions,"row-style":t.rowStyle,store:t.store,stripe:t.stripe},null,8,["context","highlight","row-class-name","tooltip-effect","tooltip-options","row-style","store","stripe"]),t.showSummary&&t.tableLayout==="auto"?(De(),Ht(y,{key:1,class:ht(t.ns.e("body-footer")),border:t.border,"default-sort":t.defaultSort,store:t.store,"sum-text":t.computedSumText,"summary-method":t.summaryMethod},null,8,["class","border","default-sort","store","sum-text","summary-method"])):Wt("v-if",!0)],6),t.isEmpty?(De(),yt("div",{key:0,ref:"emptyBlock",style:xn(t.emptyBlockStyle),class:ht(t.ns.e("empty-block"))},[gt("span",{class:ht(t.ns.e("empty-text"))},[vr(t.$slots,"empty",{},()=>[Sr(Lr(t.computedEmptyText),1)])],2)],6)):Wt("v-if",!0),t.$slots.append?(De(),yt("div",{key:1,ref:"appendWrapper",class:ht(t.ns.e("append-wrapper"))},[vr(t.$slots,"append")],2)):Wt("v-if",!0)]),_:3},8,["view-style","wrap-style","always"])],2),t.showSummary&&t.tableLayout==="fixed"?ci((De(),yt("div",{key:1,ref:"footerWrapper",class:ht(t.ns.e("footer-wrapper"))},[gt("table",{class:ht(t.ns.e("footer")),cellspacing:"0",cellpadding:"0",border:"0",style:xn(t.tableBodyStyles)},[me(d,{columns:t.store.states.columns.value,"table-layout":t.tableLayout},null,8,["columns","table-layout"]),me(y,{border:t.border,"default-sort":t.defaultSort,store:t.store,"sum-text":t.computedSumText,"summary-method":t.summaryMethod},null,8,["border","default-sort","store","sum-text","summary-method"])],6)],2)),[[la,!t.isEmpty],[E,t.handleHeaderFooterMousewheel]]):Wt("v-if",!0),t.border||t.isGroup?(De(),yt("div",{key:2,class:ht(t.ns.e("border-left-patch"))},null,2)):Wt("v-if",!0)],6),ci(gt("div",{ref:"resizeProxy",class:ht(t.ns.e("column-resize-proxy"))},null,2),[[la,t.resizeProxyVisible]])],46,C0e)}var I0e=Hr(S0e,[["render",k0e],["__file","/home/runner/work/element-plus/element-plus/packages/components/table/src/table.vue"]]);const M0e={selection:"table-column--selection",expand:"table__expand-column"},F0e={default:{order:""},selection:{width:48,minWidth:48,realWidth:48,order:""},expand:{width:48,minWidth:48,realWidth:48,order:""},index:{width:48,minWidth:48,realWidth:48,order:""}},P0e=t=>M0e[t]||"",O0e={selection:{renderHeader({store:t,column:n}){function a(){return t.states.data.value&&t.states.data.value.length===0}return En(Q0,{disabled:a(),size:t.states.tableSize.value,indeterminate:t.states.selection.value.length>0&&!t.states.isAllSelected.value,"onUpdate:modelValue":t.toggleAllSelection,modelValue:t.states.isAllSelected.value,ariaLabel:n.label})},renderCell({row:t,column:n,store:a,$index:s}){return En(Q0,{disabled:n.selectable?!n.selectable.call(null,t,s):!1,size:a.states.tableSize.value,onChange:()=>{a.commit("rowSelectedChanged",t)},onClick:c=>c.stopPropagation(),modelValue:a.isSelected(t),ariaLabel:n.label})},sortable:!1,resizable:!1},index:{renderHeader({column:t}){return t.label||"#"},renderCell({column:t,$index:n}){let a=n+1;const s=t.index;return typeof s=="number"?a=n+s:typeof s=="function"&&(a=s(n)),En("div",{},[a])},sortable:!1},expand:{renderHeader({column:t}){return t.label||""},renderCell({row:t,store:n,expanded:a}){const{ns:s}=n,c=[s.e("expand-icon")];return a&&c.push(s.em("expand-icon","expanded")),En("div",{class:c,onClick:function(d){d.stopPropagation(),n.toggleRowExpansion(t)}},{default:()=>[En(Hn,null,{default:()=>[En(mm)]})]})},sortable:!1,resizable:!1}};function R0e({row:t,column:n,$index:a}){var s;const c=n.property,f=c&&bx(t,c).value;return n&&n.formatter?n.formatter(t,n,f,a):((s=f==null?void 0:f.toString)==null?void 0:s.call(f))||""}function L0e({row:t,treeNode:n,store:a},s=!1){const{ns:c}=a;if(!n)return s?[En("span",{class:c.e("placeholder")})]:null;const f=[],d=function(p){p.stopPropagation(),!n.loading&&a.loadOrToggle(t)};if(n.indent&&f.push(En("span",{class:c.e("indent"),style:{"padding-left":`${n.indent}px`}})),typeof n.expanded=="boolean"&&!n.noLazyChildren){const p=[c.e("expand-icon"),n.expanded?c.em("expand-icon","expanded"):""];let g=mm;n.loading&&(g=Nb),f.push(En("div",{class:p,onClick:d},{default:()=>[En(Hn,{class:{[c.is("loading")]:n.loading}},{default:()=>[En(g)]})]}))}else f.push(En("span",{class:c.e("placeholder")}));return f}function i5(t,n){return t.reduce((a,s)=>(a[s]=s,a),n)}function D0e(t,n){const a=Tn();return{registerComplexWatchers:()=>{const f=["fixed"],d={realWidth:"width",realMinWidth:"minWidth"},p=i5(f,d);Object.keys(p).forEach(g=>{const y=d[g];Kn(n,y)&&gr(()=>n[y],b=>{let E=b;y==="width"&&g==="realWidth"&&(E=fk(b)),y==="minWidth"&&g==="realMinWidth"&&(E=NN(b)),a.columnConfig.value[y]=E,a.columnConfig.value[g]=E;const T=y==="fixed";t.value.store.scheduleLayout(T)})})},registerNormalWatchers:()=>{const f=["label","filters","filterMultiple","filteredValue","sortable","index","formatter","className","labelClassName","showOverflowTooltip"],d={property:"prop",align:"realAlign",headerAlign:"realHeaderAlign"},p=i5(f,d);Object.keys(p).forEach(g=>{const y=d[g];Kn(n,y)&&gr(()=>n[y],b=>{a.columnConfig.value[g]=b})})}}}function B0e(t,n,a){const s=Tn(),c=Ze(""),f=Ze(!1),d=Ze(),p=Ze(),g=Rr("table");wh(()=>{d.value=t.align?`is-${t.align}`:null,d.value}),wh(()=>{p.value=t.headerAlign?`is-${t.headerAlign}`:d.value,p.value});const y=Ve(()=>{let N=s.vnode.vParent||s.parent;for(;N&&!N.tableId&&!N.columnId;)N=N.vnode.vParent||N.parent;return N}),b=Ve(()=>{const{store:N}=s.parent;if(!N)return!1;const{treeData:Q}=N.states,ie=Q.value;return ie&&Object.keys(ie).length>0}),E=Ze(fk(t.width)),T=Ze(NN(t.minWidth)),S=N=>(E.value&&(N.width=E.value),T.value&&(N.minWidth=T.value),!E.value&&T.value&&(N.width=void 0),N.minWidth||(N.minWidth=80),N.realWidth=Number(N.width===void 0?N.minWidth:N.width),N),I=N=>{const Q=N.type,ie=O0e[Q]||{};Object.keys(ie).forEach(V=>{const D=ie[V];V!=="className"&&D!==void 0&&(N[V]=D)});const j=P0e(Q);if(j){const V=`${W(g.namespace)}-${j}`;N.className=N.className?`${N.className} ${V}`:V}return N},A=N=>{Array.isArray(N)?N.forEach(ie=>Q(ie)):Q(N);function Q(ie){var j;((j=ie==null?void 0:ie.type)==null?void 0:j.name)==="ElTableColumn"&&(ie.vParent=s)}};return{columnId:c,realAlign:d,isSubColumn:f,realHeaderAlign:p,columnOrTableParent:y,setColumnWidth:S,setColumnForcedProps:I,setColumnRenders:N=>{t.renderHeader||N.type!=="selection"&&(N.renderHeader=ie=>{s.columnConfig.value.label;const j=n.header;return j?j(ie):N.label});let Q=N.renderCell;return N.type==="expand"?(N.renderCell=ie=>En("div",{class:"cell"},[Q(ie)]),a.value.renderExpanded=ie=>n.default?n.default(ie):n.default):(Q=Q||R0e,N.renderCell=ie=>{let j=null;if(n.default){const le=n.default(ie);j=le.some(re=>re.type!==Ls)?le:Q(ie)}else j=Q(ie);const{columns:V}=a.value.store.states,D=V.value.findIndex(le=>le.type==="default"),te=b.value&&ie.cellIndex===D,ue=L0e(ie,te),J={class:"cell",style:{}};return N.showOverflowTooltip&&(J.class=`${J.class} ${W(g.namespace)}-tooltip`,J.style={width:`${(ie.column.realWidth||Number(ie.column.width))-1}px`}),A(j),En("div",J,[ue,j])}),N},getPropsData:(...N)=>N.reduce((Q,ie)=>(Array.isArray(ie)&&ie.forEach(j=>{Q[j]=t[j]}),Q),{}),getColumnElIndex:(N,Q)=>Array.prototype.indexOf.call(N,Q),updateColumnOrder:()=>{a.value.store.commit("updateColumnOrder",s.columnConfig.value)}}}var z0e={type:{type:String,default:"default"},label:String,className:String,labelClassName:String,property:String,prop:String,width:{type:[String,Number],default:""},minWidth:{type:[String,Number],default:""},renderHeader:Function,sortable:{type:[Boolean,String],default:!1},sortMethod:Function,sortBy:[String,Function,Array],resizable:{type:Boolean,default:!0},columnKey:String,align:String,headerAlign:String,showOverflowTooltip:{type:[Boolean,Object],default:void 0},fixed:[Boolean,String],formatter:Function,selectable:Function,reserveSelection:Boolean,filterMethod:Function,filteredValue:Array,filters:Array,filterPlacement:String,filterMultiple:{type:Boolean,default:!0},index:[Number,Function],sortOrders:{type:Array,default:()=>["ascending","descending",null],validator:t=>t.every(n=>["ascending","descending",null].includes(n))}};let N0e=1;var qN=Ft({name:"ElTableColumn",components:{ElCheckbox:Q0},props:z0e,setup(t,{slots:n}){const a=Tn(),s=Ze({}),c=Ve(()=>{let O=a.parent;for(;O&&!O.tableId;)O=O.parent;return O}),{registerNormalWatchers:f,registerComplexWatchers:d}=D0e(c,t),{columnId:p,isSubColumn:g,realHeaderAlign:y,columnOrTableParent:b,setColumnWidth:E,setColumnForcedProps:T,setColumnRenders:S,getPropsData:I,getColumnElIndex:A,realAlign:M,updateColumnOrder:F}=B0e(t,n,c),L=b.value;p.value=`${L.tableId||L.columnId}_column_${N0e++}`,Cb(()=>{g.value=c.value!==L;const O=t.type||"default",N=t.sortable===""?!0:t.sortable,Q=au(t.showOverflowTooltip)?L.props.showOverflowTooltip:t.showOverflowTooltip,ie={...F0e[O],id:p.value,type:O,property:t.prop||t.property,align:M,headerAlign:y,showOverflowTooltip:Q,filterable:t.filters||t.filterMethod,filteredValue:[],filterPlacement:"",isColumnGroup:!1,isSubColumn:!1,filterOpened:!1,sortable:N,index:t.index,rawColumnKey:a.vnode.key};let ue=I(["columnKey","label","className","labelClassName","type","renderHeader","formatter","fixed","resizable"],["sortMethod","sortBy","sortOrders"],["selectable","reserveSelection"],["filterMethod","filters","filterMultiple","filterOpened","filteredValue","filterPlacement"]);ue=Npe(ie,ue),ue=$pe(S,E,T)(ue),s.value=ue,f(),d()}),di(()=>{var O;const N=b.value,Q=g.value?N.vnode.el.children:(O=N.refs.hiddenColumns)==null?void 0:O.children,ie=()=>A(Q||[],a.vnode.el);s.value.getColumnIndex=ie,ie()>-1&&c.value.store.commit("insertColumn",s.value,g.value?N.columnConfig.value:null,F)}),to(()=>{c.value.store.commit("removeColumn",s.value,g.value?L.columnConfig.value:null,F)}),a.columnId=p.value,a.columnConfig=s},render(){var t,n,a;try{const s=(n=(t=this.$slots).default)==null?void 0:n.call(t,{row:{},column:{},$index:-1}),c=[];if(Array.isArray(s))for(const d of s)((a=d.type)==null?void 0:a.name)==="ElTableColumn"||d.shapeFlag&2?c.push(d):d.type===mn&&Array.isArray(d.children)&&d.children.forEach(p=>{(p==null?void 0:p.patchFlag)!==1024&&!Mn(p==null?void 0:p.children)&&c.push(p)});return En("div",c)}catch{return En("div",[])}}});const U0e=ca(I0e,{TableColumn:qN}),$0e=Ko(qN),Qb=Symbol("tabsRootContextKey"),V0e=rn({tabs:{type:br(Array),default:()=>fs([])}}),XN="ElTabBar",j0e=Ft({name:XN}),W0e=Ft({...j0e,props:V0e,setup(t,{expose:n}){const a=t,s=Tn(),c=Gr(Qb);c||bc(XN,"<el-tabs><el-tab-bar /></el-tabs>");const f=Rr("tabs"),d=Ze(),p=Ze(),g=()=>{let b=0,E=0;const T=["top","bottom"].includes(c.props.tabPosition)?"width":"height",S=T==="width"?"x":"y",I=S==="x"?"left":"top";return a.tabs.every(A=>{var M,F;const L=(F=(M=s.parent)==null?void 0:M.refs)==null?void 0:F[`tab-${A.uid}`];if(!L)return!1;if(!A.active)return!0;b=L[`offset${mh(I)}`],E=L[`client${mh(T)}`];const O=window.getComputedStyle(L);return T==="width"&&(a.tabs.length>1&&(E-=Number.parseFloat(O.paddingLeft)+Number.parseFloat(O.paddingRight)),b+=Number.parseFloat(O.paddingLeft)),!1}),{[T]:`${E}px`,transform:`translate${mh(S)}(${b}px)`}},y=()=>p.value=g();return gr(()=>a.tabs,async()=>{await Fn(),y()},{immediate:!0}),dc(d,()=>y()),n({ref:d,update:y}),(b,E)=>(De(),yt("div",{ref_key:"barRef",ref:d,class:ht([W(f).e("active-bar"),W(f).is(W(c).props.tabPosition)]),style:xn(p.value)},null,6))}});var H0e=Hr(W0e,[["__file","/home/runner/work/element-plus/element-plus/packages/components/tabs/src/tab-bar.vue"]]);const G0e=rn({panes:{type:br(Array),default:()=>fs([])},currentName:{type:[String,Number],default:""},editable:Boolean,type:{type:String,values:["card","border-card",""],default:""},stretch:Boolean}),q0e={tabClick:(t,n,a)=>a instanceof Event,tabRemove:(t,n)=>n instanceof Event},a5="ElTabNav",X0e=Ft({name:a5,props:G0e,emits:q0e,setup(t,{expose:n,emit:a}){const s=Tn(),c=Gr(Qb);c||bc(a5,"<el-tabs><tab-nav /></el-tabs>");const f=Rr("tabs"),d=fJ(),p=bJ(),g=Ze(),y=Ze(),b=Ze(),E=Ze(),T=Ze(!1),S=Ze(0),I=Ze(!1),A=Ze(!0),M=Ve(()=>["top","bottom"].includes(c.props.tabPosition)?"width":"height"),F=Ve(()=>({transform:`translate${M.value==="width"?"X":"Y"}(-${S.value}px)`})),L=()=>{if(!g.value)return;const D=g.value[`offset${mh(M.value)}`],te=S.value;if(!te)return;const ue=te>D?te-D:0;S.value=ue},O=()=>{if(!g.value||!y.value)return;const D=y.value[`offset${mh(M.value)}`],te=g.value[`offset${mh(M.value)}`],ue=S.value;if(D-ue<=te)return;const J=D-ue>te*2?ue+te:D-te;S.value=J},N=async()=>{const D=y.value;if(!T.value||!b.value||!g.value||!D)return;await Fn();const te=b.value.querySelector(".is-active");if(!te)return;const ue=g.value,J=["top","bottom"].includes(c.props.tabPosition),le=te.getBoundingClientRect(),re=ue.getBoundingClientRect(),Fe=J?D.offsetWidth-re.width:D.offsetHeight-re.height,Ye=S.value;let Ee=Ye;J?(le.left<re.left&&(Ee=Ye-(re.left-le.left)),le.right>re.right&&(Ee=Ye+le.right-re.right)):(le.top<re.top&&(Ee=Ye-(re.top-le.top)),le.bottom>re.bottom&&(Ee=Ye+(le.bottom-re.bottom))),Ee=Math.max(Ee,0),S.value=Math.min(Ee,Fe)},Q=()=>{var D;if(!y.value||!g.value)return;t.stretch&&((D=E.value)==null||D.update());const te=y.value[`offset${mh(M.value)}`],ue=g.value[`offset${mh(M.value)}`],J=S.value;ue<te?(T.value=T.value||{},T.value.prev=J,T.value.next=J+ue<te,te-J<ue&&(S.value=te-ue)):(T.value=!1,J>0&&(S.value=0))},ie=D=>{const te=D.code,{up:ue,down:J,left:le,right:re}=ds;if(![ue,J,le,re].includes(te))return;const Fe=Array.from(D.currentTarget.querySelectorAll("[role=tab]:not(.is-disabled)")),Ye=Fe.indexOf(D.target);let Ee;te===le||te===ue?Ye===0?Ee=Fe.length-1:Ee=Ye-1:Ye<Fe.length-1?Ee=Ye+1:Ee=0,Fe[Ee].focus({preventScroll:!0}),Fe[Ee].click(),j()},j=()=>{A.value&&(I.value=!0)},V=()=>I.value=!1;return gr(d,D=>{D==="hidden"?A.value=!1:D==="visible"&&setTimeout(()=>A.value=!0,50)}),gr(p,D=>{D?setTimeout(()=>A.value=!0,50):A.value=!1}),dc(b,Q),di(()=>setTimeout(()=>N(),0)),hm(()=>Q()),n({scrollToActiveTab:N,removeFocus:V}),gr(()=>t.panes,()=>s.update(),{flush:"post",deep:!0}),()=>{const D=T.value?[me("span",{class:[f.e("nav-prev"),f.is("disabled",!T.value.prev)],onClick:L},[me(Hn,null,{default:()=>[me(UA,null,null)]})]),me("span",{class:[f.e("nav-next"),f.is("disabled",!T.value.next)],onClick:O},[me(Hn,null,{default:()=>[me(mm,null,null)]})])]:null,te=t.panes.map((ue,J)=>{var le,re,Fe,Ye;const Ee=ue.uid,ut=ue.props.disabled,Ne=(re=(le=ue.props.name)!=null?le:ue.index)!=null?re:`${J}`,He=!ut&&(ue.isClosable||t.editable);ue.index=`${J}`;const Oe=He?me(Hn,{class:"is-icon-close",onClick:et=>a("tabRemove",ue,et)},{default:()=>[me(Qu,null,null)]}):null,Pe=((Ye=(Fe=ue.slots).label)==null?void 0:Ye.call(Fe))||ue.props.label,rt=!ut&&ue.active?0:-1;return me("div",{ref:`tab-${Ee}`,class:[f.e("item"),f.is(c.props.tabPosition),f.is("active",ue.active),f.is("disabled",ut),f.is("closable",He),f.is("focus",I.value)],id:`tab-${Ne}`,key:`tab-${Ee}`,"aria-controls":`pane-${Ne}`,role:"tab","aria-selected":ue.active,tabindex:rt,onFocus:()=>j(),onBlur:()=>V(),onClick:et=>{V(),a("tabClick",ue,Ne,et)},onKeydown:et=>{He&&(et.code===ds.delete||et.code===ds.backspace)&&a("tabRemove",ue,et)}},[Pe,Oe])});return me("div",{ref:b,class:[f.e("nav-wrap"),f.is("scrollable",!!T.value),f.is(c.props.tabPosition)]},[D,me("div",{class:f.e("nav-scroll"),ref:g},[me("div",{class:[f.e("nav"),f.is(c.props.tabPosition),f.is("stretch",t.stretch&&["top","bottom"].includes(c.props.tabPosition))],ref:y,style:F.value,role:"tablist",onKeydown:ie},[t.type?null:me(H0e,{ref:E,tabs:[...t.panes]},null),te])])])}}}),Z0e=rn({type:{type:String,values:["card","border-card",""],default:""},activeName:{type:[String,Number]},closable:Boolean,addable:Boolean,modelValue:{type:[String,Number]},editable:Boolean,tabPosition:{type:String,values:["top","right","bottom","left"],default:"top"},beforeLeave:{type:br(Function),default:()=>!0},stretch:Boolean}),aS=t=>Mn(t)||yi(t),K0e={[ma]:t=>aS(t),tabClick:(t,n)=>n instanceof Event,tabChange:t=>aS(t),edit:(t,n)=>["remove","add"].includes(n),tabRemove:t=>aS(t),tabAdd:()=>!0},Y0e=Ft({name:"ElTabs",props:Z0e,emits:K0e,setup(t,{emit:n,slots:a,expose:s}){var c,f;const d=Rr("tabs"),{children:p,addChild:g,removeChild:y}=Dz(Tn(),"ElTabPane"),b=Ze(),E=Ze((f=(c=t.modelValue)!=null?c:t.activeName)!=null?f:"0"),T=async(M,F=!1)=>{var L,O,N;if(!(E.value===M||au(M)))try{await((L=t.beforeLeave)==null?void 0:L.call(t,M,E.value))!==!1&&(E.value=M,F&&(n(ma,M),n("tabChange",M)),(N=(O=b.value)==null?void 0:O.removeFocus)==null||N.call(O))}catch{}},S=(M,F,L)=>{M.props.disabled||(T(F,!0),n("tabClick",M,L))},I=(M,F)=>{M.props.disabled||au(M.props.name)||(F.stopPropagation(),n("edit",M.props.name,"remove"),n("tabRemove",M.props.name))},A=()=>{n("edit",void 0,"add"),n("tabAdd")};return q0({from:'"activeName"',replacement:'"model-value" or "v-model"',scope:"ElTabs",version:"2.3.0",ref:"https://element-plus.org/en-US/component/tabs.html#attributes",type:"Attribute"},Ve(()=>!!t.activeName)),gr(()=>t.activeName,M=>T(M)),gr(()=>t.modelValue,M=>T(M)),gr(E,async()=>{var M;await Fn(),(M=b.value)==null||M.scrollToActiveTab()}),Ji(Qb,{props:t,currentName:E,registerPane:g,unregisterPane:y}),s({currentName:E}),()=>{const M=a.addIcon,F=t.editable||t.addable?me("span",{class:d.e("new-tab"),tabindex:"0",onClick:A,onKeydown:N=>{N.code===ds.enter&&A()}},[M?vr(a,"addIcon"):me(Hn,{class:d.is("icon-plus")},{default:()=>[me(nae,null,null)]})]):null,L=me("div",{class:[d.e("header"),d.is(t.tabPosition)]},[F,me(X0e,{ref:b,currentName:E.value,editable:t.editable,type:t.type,panes:p.value,stretch:t.stretch,onTabClick:S,onTabRemove:I},null)]),O=me("div",{class:d.e("content")},[vr(a,"default")]);return me("div",{class:[d.b(),d.m(t.tabPosition),{[d.m("card")]:t.type==="card",[d.m("border-card")]:t.type==="border-card"}]},[...t.tabPosition!=="bottom"?[L,O]:[O,L]])}}}),J0e=rn({label:{type:String,default:""},name:{type:[String,Number]},closable:Boolean,disabled:Boolean,lazy:Boolean}),Q0e=["id","aria-hidden","aria-labelledby"],ZN="ElTabPane",eme=Ft({name:ZN}),tme=Ft({...eme,props:J0e,setup(t){const n=t,a=Tn(),s=sf(),c=Gr(Qb);c||bc(ZN,"usage: <el-tabs><el-tab-pane /></el-tabs/>");const f=Rr("tab-pane"),d=Ze(),p=Ve(()=>n.closable||c.props.closable),g=yL(()=>{var S;return c.currentName.value===((S=n.name)!=null?S:d.value)}),y=Ze(g.value),b=Ve(()=>{var S;return(S=n.name)!=null?S:d.value}),E=yL(()=>!n.lazy||y.value||g.value);gr(g,S=>{S&&(y.value=!0)});const T=bo({uid:a.uid,slots:s,props:n,paneName:b,active:g,index:d,isClosable:p});return di(()=>{c.registerPane(T)}),of(()=>{c.unregisterPane(T.uid)}),(S,I)=>W(E)?ci((De(),yt("div",{key:0,id:`pane-${W(b)}`,class:ht(W(f).b()),role:"tabpanel","aria-hidden":!W(g),"aria-labelledby":`tab-${W(b)}`},[vr(S.$slots,"default")],10,Q0e)),[[la,W(g)]]):Wt("v-if",!0)}});var KN=Hr(tme,[["__file","/home/runner/work/element-plus/element-plus/packages/components/tabs/src/tab-pane.vue"]]);const rme=ca(Y0e,{TabPane:KN}),nme=Ko(KN),YN=Symbol("uploadContextKey"),ime="ElUpload";class ame extends Error{constructor(n,a,s,c){super(n),this.name="UploadAjaxError",this.status=a,this.method=s,this.url=c}}function o5(t,n,a){let s;return a.response?s=`${a.response.error||a.response}`:a.responseText?s=`${a.responseText}`:s=`fail to ${n.method} ${t} ${a.status}`,new ame(s,a.status,n.method,t)}function ome(t){const n=t.responseText||t.response;if(!n)return n;try{return JSON.parse(n)}catch{return n}}const sme=t=>{typeof XMLHttpRequest>"u"&&bc(ime,"XMLHttpRequest is undefined");const n=new XMLHttpRequest,a=t.action;n.upload&&n.upload.addEventListener("progress",f=>{const d=f;d.percent=f.total>0?f.loaded/f.total*100:0,t.onProgress(d)});const s=new FormData;if(t.data)for(const[f,d]of Object.entries(t.data))Wr(d)&&d.length?s.append(f,...d):s.append(f,d);s.append(t.filename,t.file,t.file.name),n.addEventListener("error",()=>{t.onError(o5(a,t,n))}),n.addEventListener("load",()=>{if(n.status<200||n.status>=300)return t.onError(o5(a,t,n));t.onSuccess(ome(n))}),n.open(t.method,a,!0),t.withCredentials&&"withCredentials"in n&&(n.withCredentials=!0);const c=t.headers||{};if(c instanceof Headers)c.forEach((f,d)=>n.setRequestHeader(d,f));else for(const[f,d]of Object.entries(c))ap(d)||n.setRequestHeader(f,String(d));return n.send(s),n},JN=["text","picture","picture-card"];let lme=1;const Kx=()=>Date.now()+lme++,QN=rn({action:{type:String,default:"#"},headers:{type:br(Object)},method:{type:String,default:"post"},data:{type:br([Object,Function,Promise]),default:()=>fs({})},multiple:{type:Boolean,default:!1},name:{type:String,default:"file"},drag:{type:Boolean,default:!1},withCredentials:Boolean,showFileList:{type:Boolean,default:!0},accept:{type:String,default:""},fileList:{type:br(Array),default:()=>fs([])},autoUpload:{type:Boolean,default:!0},listType:{type:String,values:JN,default:"text"},httpRequest:{type:br(Function),default:sme},disabled:Boolean,limit:Number}),cme=rn({...QN,beforeUpload:{type:br(Function),default:Si},beforeRemove:{type:br(Function)},onRemove:{type:br(Function),default:Si},onChange:{type:br(Function),default:Si},onPreview:{type:br(Function),default:Si},onSuccess:{type:br(Function),default:Si},onProgress:{type:br(Function),default:Si},onError:{type:br(Function),default:Si},onExceed:{type:br(Function),default:Si}}),ume=rn({files:{type:br(Array),default:()=>fs([])},disabled:{type:Boolean,default:!1},handlePreview:{type:br(Function),default:Si},listType:{type:String,values:JN,default:"text"}}),fme={remove:t=>!!t},hme=["onKeydown"],dme=["src"],pme=["onClick"],mme=["title"],gme=["onClick"],_me=["onClick"],vme=Ft({name:"ElUploadList"}),yme=Ft({...vme,props:ume,emits:fme,setup(t,{emit:n}){const a=t,{t:s}=Yo(),c=Rr("upload"),f=Rr("icon"),d=Rr("list"),p=cu(),g=Ze(!1),y=Ve(()=>[c.b("list"),c.bm("list",a.listType),c.is("disabled",a.disabled)]),b=E=>{n("remove",E)};return(E,T)=>(De(),Ht(u8,{tag:"ul",class:ht(W(y)),name:W(d).b()},{default:we(()=>[(De(!0),yt(mn,null,pa(E.files,S=>(De(),yt("li",{key:S.uid||S.name,class:ht([W(c).be("list","item"),W(c).is(S.status),{focusing:g.value}]),tabindex:"0",onKeydown:Ya(I=>!W(p)&&b(S),["delete"]),onFocus:T[0]||(T[0]=I=>g.value=!0),onBlur:T[1]||(T[1]=I=>g.value=!1),onClick:T[2]||(T[2]=I=>g.value=!1)},[vr(E.$slots,"default",{file:S},()=>[E.listType==="picture"||S.status!=="uploading"&&E.listType==="picture-card"?(De(),yt("img",{key:0,class:ht(W(c).be("list","item-thumbnail")),src:S.url,alt:""},null,10,dme)):Wt("v-if",!0),S.status==="uploading"||E.listType!=="picture-card"?(De(),yt("div",{key:1,class:ht(W(c).be("list","item-info"))},[gt("a",{class:ht(W(c).be("list","item-name")),onClick:si(I=>E.handlePreview(S),["prevent"])},[me(W(Hn),{class:ht(W(f).m("document"))},{default:we(()=>[me(W(Hie))]),_:1},8,["class"]),gt("span",{class:ht(W(c).be("list","item-file-name")),title:S.name},Lr(S.name),11,mme)],10,pme),S.status==="uploading"?(De(),Ht(W(bpe),{key:0,type:E.listType==="picture-card"?"circle":"line","stroke-width":E.listType==="picture-card"?6:2,percentage:Number(S.percentage),style:xn(E.listType==="picture-card"?"":"margin-top: 0.5rem")},null,8,["type","stroke-width","percentage","style"])):Wt("v-if",!0)],2)):Wt("v-if",!0),gt("label",{class:ht(W(c).be("list","item-status-label"))},[E.listType==="text"?(De(),Ht(W(Hn),{key:0,class:ht([W(f).m("upload-success"),W(f).m("circle-check")])},{default:we(()=>[me(W($A))]),_:1},8,["class"])):["picture-card","picture"].includes(E.listType)?(De(),Ht(W(Hn),{key:1,class:ht([W(f).m("upload-success"),W(f).m("check")])},{default:we(()=>[me(W(tz))]),_:1},8,["class"])):Wt("v-if",!0)],2),W(p)?Wt("v-if",!0):(De(),Ht(W(Hn),{key:2,class:ht(W(f).m("close")),onClick:I=>b(S)},{default:we(()=>[me(W(Qu))]),_:2},1032,["class","onClick"])),Wt(" Due to close btn only appears when li gets focused disappears after li gets blurred, thus keyboard navigation can never reach close btn"),Wt(" This is a bug which needs to be fixed "),Wt(" TODO: Fix the incorrect navigation interaction "),W(p)?Wt("v-if",!0):(De(),yt("i",{key:3,class:ht(W(f).m("close-tip"))},Lr(W(s)("el.upload.deleteTip")),3)),E.listType==="picture-card"?(De(),yt("span",{key:4,class:ht(W(c).be("list","item-actions"))},[gt("span",{class:ht(W(c).be("list","item-preview")),onClick:I=>E.handlePreview(S)},[me(W(Hn),{class:ht(W(f).m("zoom-in"))},{default:we(()=>[me(W(mae))]),_:1},8,["class"])],10,gme),W(p)?Wt("v-if",!0):(De(),yt("span",{key:0,class:ht(W(c).be("list","item-delete")),onClick:I=>b(S)},[me(W(Hn),{class:ht(W(f).m("delete"))},{default:we(()=>[me(W(jie))]),_:1},8,["class"])],10,_me))],2)):Wt("v-if",!0)])],42,hme))),128)),vr(E.$slots,"append")]),_:3},8,["class","name"]))}});var s5=Hr(yme,[["__file","/home/runner/work/element-plus/element-plus/packages/components/upload/src/upload-list.vue"]]);const xme=rn({disabled:{type:Boolean,default:!1}}),bme={file:t=>Wr(t)},wme=["onDrop","onDragover"],eU="ElUploadDrag",Eme=Ft({name:eU}),Tme=Ft({...Eme,props:xme,emits:bme,setup(t,{emit:n}){const a=Gr(YN);a||bc(eU,"usage: <el-upload><el-upload-dragger /></el-upload>");const s=Rr("upload"),c=Ze(!1),f=cu(),d=g=>{if(f.value)return;c.value=!1,g.stopPropagation();const y=Array.from(g.dataTransfer.files),b=a.accept.value;if(!b){n("file",y);return}const E=y.filter(T=>{const{type:S,name:I}=T,A=I.includes(".")?`.${I.split(".").pop()}`:"",M=S.replace(/\/.*$/,"");return b.split(",").map(F=>F.trim()).filter(F=>F).some(F=>F.startsWith(".")?A===F:/\/\*$/.test(F)?M===F.replace(/\/\*$/,""):/^[^/]+\/[^/]+$/.test(F)?S===F:!1)});n("file",E)},p=()=>{f.value||(c.value=!0)};return(g,y)=>(De(),yt("div",{class:ht([W(s).b("dragger"),W(s).is("dragover",c.value)]),onDrop:si(d,["prevent"]),onDragover:si(p,["prevent"]),onDragleave:y[0]||(y[0]=si(b=>c.value=!1,["prevent"]))},[vr(g.$slots,"default")],42,wme))}});var Sme=Hr(Tme,[["__file","/home/runner/work/element-plus/element-plus/packages/components/upload/src/upload-dragger.vue"]]);const Cme=rn({...QN,beforeUpload:{type:br(Function),default:Si},onRemove:{type:br(Function),default:Si},onStart:{type:br(Function),default:Si},onSuccess:{type:br(Function),default:Si},onProgress:{type:br(Function),default:Si},onError:{type:br(Function),default:Si},onExceed:{type:br(Function),default:Si}}),Ame=["onKeydown"],kme=["name","multiple","accept"],Ime=Ft({name:"ElUploadContent",inheritAttrs:!1}),Mme=Ft({...Ime,props:Cme,setup(t,{expose:n}){const a=t,s=Rr("upload"),c=cu(),f=Rs({}),d=Rs(),p=A=>{if(A.length===0)return;const{autoUpload:M,limit:F,fileList:L,multiple:O,onStart:N,onExceed:Q}=a;if(F&&L.length+A.length>F){Q(A,L);return}O||(A=A.slice(0,1));for(const ie of A){const j=ie;j.uid=Kx(),N(j),M&&g(j)}},g=async A=>{if(d.value.value="",!a.beforeUpload)return b(A);let M,F={};try{const O=a.data,N=a.beforeUpload(A);F=Rx(a.data)?tD(a.data):a.data,M=await N,Rx(a.data)&&L_(O,F)&&(F=tD(a.data))}catch{M=!1}if(M===!1){a.onRemove(A);return}let L=A;M instanceof Blob&&(M instanceof File?L=M:L=new File([M],A.name,{type:A.type})),b(Object.assign(L,{uid:A.uid}),F)},y=async(A,M)=>Yr(A)?A(M):A,b=async(A,M)=>{const{headers:F,data:L,method:O,withCredentials:N,name:Q,action:ie,onProgress:j,onSuccess:V,onError:D,httpRequest:te}=a;try{M=await y(M??L,A)}catch{a.onRemove(A);return}const{uid:ue}=A,J={headers:F||{},withCredentials:N,file:A,data:M,method:O,filename:Q,action:ie,onProgress:re=>{j(re,A)},onSuccess:re=>{V(re,A),delete f.value[ue]},onError:re=>{D(re,A),delete f.value[ue]}},le=te(J);f.value[ue]=le,le instanceof Promise&&le.then(J.onSuccess,J.onError)},E=A=>{const M=A.target.files;M&&p(Array.from(M))},T=()=>{c.value||(d.value.value="",d.value.click())},S=()=>{T()};return n({abort:A=>{Tie(f.value).filter(A?([F])=>String(A.uid)===F:()=>!0).forEach(([F,L])=>{L instanceof XMLHttpRequest&&L.abort(),delete f.value[F]})},upload:g}),(A,M)=>(De(),yt("div",{class:ht([W(s).b(),W(s).m(A.listType),W(s).is("drag",A.drag)]),tabindex:"0",onClick:T,onKeydown:Ya(si(S,["self"]),["enter","space"])},[A.drag?(De(),Ht(Sme,{key:0,disabled:W(c),onFile:p},{default:we(()=>[vr(A.$slots,"default")]),_:3},8,["disabled"])):vr(A.$slots,"default",{key:1}),gt("input",{ref_key:"inputRef",ref:d,class:ht(W(s).e("input")),name:A.name,multiple:A.multiple,accept:A.accept,type:"file",onChange:E,onClick:M[0]||(M[0]=si(()=>{},["stop"]))},null,42,kme)],42,Ame))}});var l5=Hr(Mme,[["__file","/home/runner/work/element-plus/element-plus/packages/components/upload/src/upload-content.vue"]]);const c5="ElUpload",u5=t=>{var n;(n=t.url)!=null&&n.startsWith("blob:")&&URL.revokeObjectURL(t.url)},Fme=(t,n)=>{const a=xJ(t,"fileList",void 0,{passive:!0}),s=T=>a.value.find(S=>S.uid===T.uid);function c(T){var S;(S=n.value)==null||S.abort(T)}function f(T=["ready","uploading","success","fail"]){a.value=a.value.filter(S=>!T.includes(S.status))}const d=(T,S)=>{const I=s(S);I&&(console.error(T),I.status="fail",a.value.splice(a.value.indexOf(I),1),t.onError(T,I,a.value),t.onChange(I,a.value))},p=(T,S)=>{const I=s(S);I&&(t.onProgress(T,I,a.value),I.status="uploading",I.percentage=Math.round(T.percent))},g=(T,S)=>{const I=s(S);I&&(I.status="success",I.response=T,t.onSuccess(T,I,a.value),t.onChange(I,a.value))},y=T=>{ap(T.uid)&&(T.uid=Kx());const S={name:T.name,percentage:0,status:"ready",size:T.size,raw:T,uid:T.uid};if(t.listType==="picture-card"||t.listType==="picture")try{S.url=URL.createObjectURL(T)}catch(I){I.message,t.onError(I,S,a.value)}a.value=[...a.value,S],t.onChange(S,a.value)},b=async T=>{const S=T instanceof File?s(T):T;S||bc(c5,"file to be removed not found");const I=A=>{c(A);const M=a.value;M.splice(M.indexOf(A),1),t.onRemove(A,M),u5(A)};t.beforeRemove?await t.beforeRemove(S,a.value)!==!1&&I(S):I(S)};function E(){a.value.filter(({status:T})=>T==="ready").forEach(({raw:T})=>{var S;return T&&((S=n.value)==null?void 0:S.upload(T))})}return gr(()=>t.listType,T=>{T!=="picture-card"&&T!=="picture"||(a.value=a.value.map(S=>{const{raw:I,url:A}=S;if(!A&&I)try{S.url=URL.createObjectURL(I)}catch(M){t.onError(M,S,a.value)}return S}))}),gr(a,T=>{for(const S of T)S.uid||(S.uid=Kx()),S.status||(S.status="success")},{immediate:!0,deep:!0}),{uploadFiles:a,abort:c,clearFiles:f,handleError:d,handleProgress:p,handleStart:y,handleSuccess:g,handleRemove:b,submit:E,revokeFileObjectURL:u5}},Pme=Ft({name:"ElUpload"}),Ome=Ft({...Pme,props:cme,setup(t,{expose:n}){const a=t,s=cu(),c=Rs(),{abort:f,submit:d,clearFiles:p,uploadFiles:g,handleStart:y,handleError:b,handleRemove:E,handleSuccess:T,handleProgress:S,revokeFileObjectURL:I}=Fme(a,c),A=Ve(()=>a.listType==="picture-card"),M=Ve(()=>({...a,fileList:g.value,onStart:y,onProgress:S,onSuccess:T,onError:b,onRemove:E}));return to(()=>{g.value.forEach(I)}),Ji(YN,{accept:Cl(a,"accept")}),n({abort:f,submit:d,clearFiles:p,handleStart:y,handleRemove:E}),(F,L)=>(De(),yt("div",null,[W(A)&&F.showFileList?(De(),Ht(s5,{key:0,disabled:W(s),"list-type":F.listType,files:W(g),"handle-preview":F.onPreview,onRemove:W(E)},T_({append:we(()=>[me(l5,Ds({ref_key:"uploadRef",ref:c},W(M)),{default:we(()=>[F.$slots.trigger?vr(F.$slots,"trigger",{key:0}):Wt("v-if",!0),!F.$slots.trigger&&F.$slots.default?vr(F.$slots,"default",{key:1}):Wt("v-if",!0)]),_:3},16)]),_:2},[F.$slots.file?{name:"default",fn:we(({file:O})=>[vr(F.$slots,"file",{file:O})])}:void 0]),1032,["disabled","list-type","files","handle-preview","onRemove"])):Wt("v-if",!0),!W(A)||W(A)&&!F.showFileList?(De(),Ht(l5,Ds({key:1,ref_key:"uploadRef",ref:c},W(M)),{default:we(()=>[F.$slots.trigger?vr(F.$slots,"trigger",{key:0}):Wt("v-if",!0),!F.$slots.trigger&&F.$slots.default?vr(F.$slots,"default",{key:1}):Wt("v-if",!0)]),_:3},16)):Wt("v-if",!0),F.$slots.trigger?vr(F.$slots,"default",{key:2}):Wt("v-if",!0),vr(F.$slots,"tip"),!W(A)&&F.showFileList?(De(),Ht(s5,{key:3,disabled:W(s),"list-type":F.listType,files:W(g),"handle-preview":F.onPreview,onRemove:W(E)},T_({_:2},[F.$slots.file?{name:"default",fn:we(({file:O})=>[vr(F.$slots,"file",{file:O})])}:void 0]),1032,["disabled","list-type","files","handle-preview","onRemove"])):Wt("v-if",!0)]))}});var Rme=Hr(Ome,[["__file","/home/runner/work/element-plus/element-plus/packages/components/upload/src/upload.vue"]]);const Lme=ca(Rme);function Dme(t){let n;const a=Ze(!1),s=bo({...t,originalPosition:"",originalOverflow:"",visible:!1});function c(T){s.text=T}function f(){const T=s.parent,S=E.ns;if(!T.vLoadingAddClassList){let I=T.getAttribute("loading-number");I=Number.parseInt(I)-1,I?T.setAttribute("loading-number",I.toString()):(Sh(T,S.bm("parent","relative")),T.removeAttribute("loading-number")),Sh(T,S.bm("parent","hidden"))}d(),b.unmount()}function d(){var T,S;(S=(T=E.$el)==null?void 0:T.parentNode)==null||S.removeChild(E.$el)}function p(){var T;t.beforeClose&&!t.beforeClose()||(a.value=!0,clearTimeout(n),n=window.setTimeout(g,400),s.visible=!1,(T=t.closed)==null||T.call(t))}function g(){if(!a.value)return;const T=s.parent;a.value=!1,T.vLoadingAddClassList=void 0,f()}const b=EA(Ft({name:"ElLoading",setup(T,{expose:S}){const{ns:I,zIndex:A}=Hb("loading");return S({ns:I,zIndex:A}),()=>{const M=s.spinner||s.svg,F=En("svg",{class:"circular",viewBox:s.svgViewBox?s.svgViewBox:"0 0 50 50",...M?{innerHTML:M}:{}},[En("circle",{class:"path",cx:"25",cy:"25",r:"20",fill:"none"})]),L=s.text?En("p",{class:I.b("text")},[s.text]):void 0;return En(Xo,{name:I.b("fade"),onAfterLeave:g},{default:we(()=>[ci(me("div",{style:{backgroundColor:s.background||""},class:[I.b("mask"),s.customClass,s.fullscreen?"is-fullscreen":""]},[En("div",{class:I.b("spinner")},[F,L])]),[[la,s.visible]])])})}}})),E=b.mount(document.createElement("div"));return{...yc(s),setText:c,removeElLoadingChild:d,close:p,handleAfterLeave:g,vm:E,get $el(){return E.$el}}}let tx;const TC=function(t={}){if(!Li)return;const n=Bme(t);if(n.fullscreen&&tx)return tx;const a=Dme({...n,closed:()=>{var c;(c=n.closed)==null||c.call(n),n.fullscreen&&(tx=void 0)}});zme(n,n.parent,a),f5(n,n.parent,a),n.parent.vLoadingAddClassList=()=>f5(n,n.parent,a);let s=n.parent.getAttribute("loading-number");return s?s=`${Number.parseInt(s)+1}`:s="1",n.parent.setAttribute("loading-number",s),n.parent.appendChild(a.$el),Fn(()=>a.visible.value=n.visible),n.fullscreen&&(tx=a),a},Bme=t=>{var n,a,s,c;let f;return Mn(t.target)?f=(n=document.querySelector(t.target))!=null?n:document.body:f=t.target||document.body,{parent:f===document.body||t.body?document.body:f,background:t.background||"",svg:t.svg||"",svgViewBox:t.svgViewBox||"",spinner:t.spinner||!1,text:t.text||"",fullscreen:f===document.body&&((a=t.fullscreen)!=null?a:!0),lock:(s=t.lock)!=null?s:!1,customClass:t.customClass||"",visible:(c=t.visible)!=null?c:!0,target:f}},zme=async(t,n,a)=>{const{nextZIndex:s}=a.vm.zIndex||a.vm._.exposed.zIndex,c={};if(t.fullscreen)a.originalPosition.value=x0(document.body,"position"),a.originalOverflow.value=x0(document.body,"overflow"),c.zIndex=s();else if(t.parent===document.body){a.originalPosition.value=x0(document.body,"position"),await Fn();for(const f of["top","left"]){const d=f==="top"?"scrollTop":"scrollLeft";c[f]=`${t.target.getBoundingClientRect()[f]+document.body[d]+document.documentElement[d]-Number.parseInt(x0(document.body,`margin-${f}`),10)}px`}for(const f of["height","width"])c[f]=`${t.target.getBoundingClientRect()[f]}px`}else a.originalPosition.value=x0(n,"position");for(const[f,d]of Object.entries(c))a.$el.style[f]=d},f5=(t,n,a)=>{const s=a.vm.ns||a.vm._.exposed.ns;["absolute","fixed","sticky"].includes(a.originalPosition.value)?Sh(n,s.bm("parent","relative")):D_(n,s.bm("parent","relative")),t.fullscreen&&t.lock?D_(n,s.bm("parent","hidden")):Sh(n,s.bm("parent","hidden"))},SC=Symbol("ElLoading"),h5=(t,n)=>{var a,s,c,f;const d=n.instance,p=T=>$n(n.value)?n.value[T]:void 0,g=T=>{const S=Mn(T)&&(d==null?void 0:d[T])||T;return S&&Ze(S)},y=T=>g(p(T)||t.getAttribute(`element-loading-${Fh(T)}`)),b=(a=p("fullscreen"))!=null?a:n.modifiers.fullscreen,E={text:y("text"),svg:y("svg"),svgViewBox:y("svgViewBox"),spinner:y("spinner"),background:y("background"),customClass:y("customClass"),fullscreen:b,target:(s=p("target"))!=null?s:b?void 0:t,body:(c=p("body"))!=null?c:n.modifiers.body,lock:(f=p("lock"))!=null?f:n.modifiers.lock};t[SC]={options:E,instance:TC(E)}},Nme=(t,n)=>{for(const a of Object.keys(n))ai(n[a])&&(n[a].value=t[a])},d5={mounted(t,n){n.value&&h5(t,n)},updated(t,n){const a=t[SC];n.oldValue!==n.value&&(n.value&&!n.oldValue?h5(t,n):n.value&&n.oldValue?$n(n.value)&&Nme(n.value,a.options):a==null||a.instance.close())},unmounted(t){var n;(n=t[SC])==null||n.instance.close()}},p5={install(t){t.directive("loading",d5),t.config.globalProperties.$loading=TC},directive:d5,service:TC},tU=["success","info","warning","error"],Ms=fs({customClass:"",center:!1,dangerouslyUseHTMLString:!1,duration:3e3,icon:void 0,id:"",message:"",onClose:void 0,showClose:!1,type:"info",offset:16,zIndex:0,grouping:!1,repeatNum:1,appendTo:Li?document.body:void 0}),Ume=rn({customClass:{type:String,default:Ms.customClass},center:{type:Boolean,default:Ms.center},dangerouslyUseHTMLString:{type:Boolean,default:Ms.dangerouslyUseHTMLString},duration:{type:Number,default:Ms.duration},icon:{type:xo,default:Ms.icon},id:{type:String,default:Ms.id},message:{type:br([String,Object,Function]),default:Ms.message},onClose:{type:br(Function),required:!1},showClose:{type:Boolean,default:Ms.showClose},type:{type:String,values:tU,default:Ms.type},offset:{type:Number,default:Ms.offset},zIndex:{type:Number,default:Ms.zIndex},grouping:{type:Boolean,default:Ms.grouping},repeatNum:{type:Number,default:Ms.repeatNum}}),$me={destroy:()=>!0},oc=oA([]),Vme=t=>{const n=oc.findIndex(c=>c.id===t),a=oc[n];let s;return n>0&&(s=oc[n-1]),{current:a,prev:s}},jme=t=>{const{prev:n}=Vme(t);return n?n.vm.exposed.bottom.value:0},Wme=(t,n)=>oc.findIndex(s=>s.id===t)>0?20:n,Hme=["id"],Gme=["innerHTML"],qme=Ft({name:"ElMessage"}),Xme=Ft({...qme,props:Ume,emits:$me,setup(t,{expose:n}){const a=t,{Close:s}=sz,{ns:c,zIndex:f}=Hb("message"),{currentZIndex:d,nextZIndex:p}=f,g=Ze(),y=Ze(!1),b=Ze(0);let E;const T=Ve(()=>a.type?a.type==="error"?"danger":a.type:"info"),S=Ve(()=>{const j=a.type;return{[c.bm("icon",j)]:j&&G0[j]}}),I=Ve(()=>a.icon||G0[a.type]||""),A=Ve(()=>jme(a.id)),M=Ve(()=>Wme(a.id,a.offset)+A.value),F=Ve(()=>b.value+M.value),L=Ve(()=>({top:`${M.value}px`,zIndex:d.value}));function O(){a.duration!==0&&({stop:E}=jx(()=>{Q()},a.duration))}function N(){E==null||E()}function Q(){y.value=!1}function ie({code:j}){j===ds.esc&&Q()}return di(()=>{O(),p(),y.value=!0}),gr(()=>a.repeatNum,()=>{N(),O()}),Bs(document,"keydown",ie),dc(g,()=>{b.value=g.value.getBoundingClientRect().height}),n({visible:y,bottom:F,close:Q}),(j,V)=>(De(),Ht(Xo,{name:W(c).b("fade"),onBeforeLeave:j.onClose,onAfterLeave:V[0]||(V[0]=D=>j.$emit("destroy")),persisted:""},{default:we(()=>[ci(gt("div",{id:j.id,ref_key:"messageRef",ref:g,class:ht([W(c).b(),{[W(c).m(j.type)]:j.type&&!j.icon},W(c).is("center",j.center),W(c).is("closable",j.showClose),j.customClass]),style:xn(W(L)),role:"alert",onMouseenter:N,onMouseleave:O},[j.repeatNum>1?(De(),Ht(W(wce),{key:0,value:j.repeatNum,type:W(T),class:ht(W(c).e("badge"))},null,8,["value","type","class"])):Wt("v-if",!0),W(I)?(De(),Ht(W(Hn),{key:1,class:ht([W(c).e("icon"),W(S)])},{default:we(()=>[(De(),Ht(Zi(W(I))))]),_:1},8,["class"])):Wt("v-if",!0),vr(j.$slots,"default",{},()=>[j.dangerouslyUseHTMLString?(De(),yt(mn,{key:1},[Wt(" Caution here, message could've been compromised, never use user's input as message "),gt("p",{class:ht(W(c).e("content")),innerHTML:j.message},null,10,Gme)],2112)):(De(),yt("p",{key:0,class:ht(W(c).e("content"))},Lr(j.message),3))]),j.showClose?(De(),Ht(W(Hn),{key:2,class:ht(W(c).e("closeBtn")),onClick:si(Q,["stop"])},{default:we(()=>[me(W(s))]),_:1},8,["class","onClick"])):Wt("v-if",!0)],46,Hme),[[la,y.value]])]),_:3},8,["name","onBeforeLeave"]))}});var Zme=Hr(Xme,[["__file","/home/runner/work/element-plus/element-plus/packages/components/message/src/message.vue"]]);let Kme=1;const rU=t=>{const n=!t||Mn(t)||ps(t)||Yr(t)?{message:t}:t,a={...Ms,...n};if(!a.appendTo)a.appendTo=document.body;else if(Mn(a.appendTo)){let s=document.querySelector(a.appendTo);pc(s)||(s=document.body),a.appendTo=s}return a},Yme=t=>{const n=oc.indexOf(t);if(n===-1)return;oc.splice(n,1);const{handler:a}=t;a.close()},Jme=({appendTo:t,...n},a)=>{const s=`message_${Kme++}`,c=n.onClose,f=document.createElement("div"),d={...n,id:s,onClose:()=>{c==null||c(),Yme(b)},onDestroy:()=>{W0(null,f)}},p=me(Zme,d,Yr(d.message)||ps(d.message)?{default:Yr(d.message)?d.message:()=>d.message}:null);p.appContext=a||tm._context,W0(p,f),t.appendChild(f.firstElementChild);const g=p.component,b={id:s,vnode:p,vm:g,handler:{close:()=>{g.exposed.visible.value=!1}},props:p.component.props};return b},tm=(t={},n)=>{if(!Li)return{close:()=>{}};if(yi(iC.max)&&oc.length>=iC.max)return{close:()=>{}};const a=rU(t);if(a.grouping&&oc.length){const c=oc.find(({vnode:f})=>{var d;return((d=f.props)==null?void 0:d.message)===a.message});if(c)return c.props.repeatNum+=1,c.props.type=a.type,c.handler}const s=Jme(a,n);return oc.push(s),s.handler};tU.forEach(t=>{tm[t]=(n={},a)=>{const s=rU(n);return tm({...s,type:t},a)}});function Qme(t){for(const n of oc)(!t||t===n.props.type)&&n.handler.close()}tm.closeAll=Qme;tm._context=null;const Yx=cz(tm,"$message"),ege=Ft({name:"ElMessageBox",directives:{TrapFocus:qce},components:{ElButton:uu,ElFocusTrap:ak,ElInput:uf,ElOverlay:FN,ElIcon:Hn,...sz},inheritAttrs:!1,props:{buttonSize:{type:String,validator:jA},modal:{type:Boolean,default:!0},lockScroll:{type:Boolean,default:!0},showClose:{type:Boolean,default:!0},closeOnClickModal:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},closeOnHashChange:{type:Boolean,default:!0},center:Boolean,draggable:Boolean,roundButton:{default:!1,type:Boolean},container:{type:String,default:"body"},boxType:{type:String,default:""}},emits:["vanish","action"],setup(t,{emit:n}){const{locale:a,zIndex:s,ns:c,size:f}=Hb("message-box",Ve(()=>t.buttonSize)),{t:d}=a,{nextZIndex:p}=s,g=Ze(!1),y=bo({autofocus:!0,beforeClose:null,callback:null,cancelButtonText:"",cancelButtonClass:"",confirmButtonText:"",confirmButtonClass:"",customClass:"",customStyle:{},dangerouslyUseHTMLString:!1,distinguishCancelAndClose:!1,icon:"",inputPattern:null,inputPlaceholder:"",inputType:"text",inputValue:null,inputValidator:null,inputErrorMessage:"",message:null,modalFade:!0,modalClass:"",showCancelButton:!1,showConfirmButton:!0,type:"",title:void 0,showInput:!1,action:"",confirmButtonLoading:!1,cancelButtonLoading:!1,confirmButtonDisabled:!1,editorErrorMessage:"",validateError:!1,zIndex:p()}),b=Ve(()=>{const Fe=y.type;return{[c.bm("icon",Fe)]:Fe&&G0[Fe]}}),E=gc(),T=gc(),S=Ve(()=>y.icon||G0[y.type]||""),I=Ve(()=>!!y.message),A=Ze(),M=Ze(),F=Ze(),L=Ze(),O=Ze(),N=Ve(()=>y.confirmButtonClass);gr(()=>y.inputValue,async Fe=>{await Fn(),t.boxType==="prompt"&&Fe!==null&&ue()},{immediate:!0}),gr(()=>g.value,Fe=>{var Ye,Ee;Fe&&(t.boxType!=="prompt"&&(y.autofocus?F.value=(Ee=(Ye=O.value)==null?void 0:Ye.$el)!=null?Ee:A.value:F.value=A.value),y.zIndex=p()),t.boxType==="prompt"&&(Fe?Fn().then(()=>{var ut;L.value&&L.value.$el&&(y.autofocus?F.value=(ut=J())!=null?ut:A.value:F.value=A.value)}):(y.editorErrorMessage="",y.validateError=!1))});const Q=Ve(()=>t.draggable);hz(A,M,Q),di(async()=>{await Fn(),t.closeOnHashChange&&window.addEventListener("hashchange",ie)}),to(()=>{t.closeOnHashChange&&window.removeEventListener("hashchange",ie)});function ie(){g.value&&(g.value=!1,Fn(()=>{y.action&&n("action",y.action)}))}const j=()=>{t.closeOnClickModal&&te(y.distinguishCancelAndClose?"close":"cancel")},V=QA(j),D=Fe=>{if(y.inputType!=="textarea")return Fe.preventDefault(),te("confirm")},te=Fe=>{var Ye;t.boxType==="prompt"&&Fe==="confirm"&&!ue()||(y.action=Fe,y.beforeClose?(Ye=y.beforeClose)==null||Ye.call(y,Fe,y,ie):ie())},ue=()=>{if(t.boxType==="prompt"){const Fe=y.inputPattern;if(Fe&&!Fe.test(y.inputValue||""))return y.editorErrorMessage=y.inputErrorMessage||d("el.messagebox.error"),y.validateError=!0,!1;const Ye=y.inputValidator;if(typeof Ye=="function"){const Ee=Ye(y.inputValue);if(Ee===!1)return y.editorErrorMessage=y.inputErrorMessage||d("el.messagebox.error"),y.validateError=!0,!1;if(typeof Ee=="string")return y.editorErrorMessage=Ee,y.validateError=!0,!1}}return y.editorErrorMessage="",y.validateError=!1,!0},J=()=>{const Fe=L.value.$refs;return Fe.input||Fe.textarea},le=()=>{te("close")},re=()=>{t.closeOnPressEscape&&le()};return t.lockScroll&&mz(g),{...yc(y),ns:c,overlayEvent:V,visible:g,hasMessage:I,typeClass:b,contentId:E,inputId:T,btnSize:f,iconComponent:S,confirmButtonClasses:N,rootRef:A,focusStartRef:F,headerRef:M,inputRef:L,confirmRef:O,doClose:ie,handleClose:le,onCloseRequested:re,handleWrapperClick:j,handleInputEnter:D,handleAction:te,t:d}}}),tge=["aria-label","aria-describedby"],rge=["aria-label"],nge=["id"];function ige(t,n,a,s,c,f){const d=Vi("el-icon"),p=Vi("close"),g=Vi("el-input"),y=Vi("el-button"),b=Vi("el-focus-trap"),E=Vi("el-overlay");return De(),Ht(Xo,{name:"fade-in-linear",onAfterLeave:n[11]||(n[11]=T=>t.$emit("vanish")),persisted:""},{default:we(()=>[ci(me(E,{"z-index":t.zIndex,"overlay-class":[t.ns.is("message-box"),t.modalClass],mask:t.modal},{default:we(()=>[gt("div",{role:"dialog","aria-label":t.title,"aria-modal":"true","aria-describedby":t.showInput?void 0:t.contentId,class:ht(`${t.ns.namespace.value}-overlay-message-box`),onClick:n[8]||(n[8]=(...T)=>t.overlayEvent.onClick&&t.overlayEvent.onClick(...T)),onMousedown:n[9]||(n[9]=(...T)=>t.overlayEvent.onMousedown&&t.overlayEvent.onMousedown(...T)),onMouseup:n[10]||(n[10]=(...T)=>t.overlayEvent.onMouseup&&t.overlayEvent.onMouseup(...T))},[me(b,{loop:"",trapped:t.visible,"focus-trap-el":t.rootRef,"focus-start-el":t.focusStartRef,onReleaseRequested:t.onCloseRequested},{default:we(()=>[gt("div",{ref:"rootRef",class:ht([t.ns.b(),t.customClass,t.ns.is("draggable",t.draggable),{[t.ns.m("center")]:t.center}]),style:xn(t.customStyle),tabindex:"-1",onClick:n[7]||(n[7]=si(()=>{},["stop"]))},[t.title!==null&&t.title!==void 0?(De(),yt("div",{key:0,ref:"headerRef",class:ht(t.ns.e("header"))},[gt("div",{class:ht(t.ns.e("title"))},[t.iconComponent&&t.center?(De(),Ht(d,{key:0,class:ht([t.ns.e("status"),t.typeClass])},{default:we(()=>[(De(),Ht(Zi(t.iconComponent)))]),_:1},8,["class"])):Wt("v-if",!0),gt("span",null,Lr(t.title),1)],2),t.showClose?(De(),yt("button",{key:0,type:"button",class:ht(t.ns.e("headerbtn")),"aria-label":t.t("el.messagebox.close"),onClick:n[0]||(n[0]=T=>t.handleAction(t.distinguishCancelAndClose?"close":"cancel")),onKeydown:n[1]||(n[1]=Ya(si(T=>t.handleAction(t.distinguishCancelAndClose?"close":"cancel"),["prevent"]),["enter"]))},[me(d,{class:ht(t.ns.e("close"))},{default:we(()=>[me(p)]),_:1},8,["class"])],42,rge)):Wt("v-if",!0)],2)):Wt("v-if",!0),gt("div",{id:t.contentId,class:ht(t.ns.e("content"))},[gt("div",{class:ht(t.ns.e("container"))},[t.iconComponent&&!t.center&&t.hasMessage?(De(),Ht(d,{key:0,class:ht([t.ns.e("status"),t.typeClass])},{default:we(()=>[(De(),Ht(Zi(t.iconComponent)))]),_:1},8,["class"])):Wt("v-if",!0),t.hasMessage?(De(),yt("div",{key:1,class:ht(t.ns.e("message"))},[vr(t.$slots,"default",{},()=>[t.dangerouslyUseHTMLString?(De(),Ht(Zi(t.showInput?"label":"p"),{key:1,for:t.showInput?t.inputId:void 0,innerHTML:t.message},null,8,["for","innerHTML"])):(De(),Ht(Zi(t.showInput?"label":"p"),{key:0,for:t.showInput?t.inputId:void 0},{default:we(()=>[Sr(Lr(t.dangerouslyUseHTMLString?"":t.message),1)]),_:1},8,["for"]))])],2)):Wt("v-if",!0)],2),ci(gt("div",{class:ht(t.ns.e("input"))},[me(g,{id:t.inputId,ref:"inputRef",modelValue:t.inputValue,"onUpdate:modelValue":n[2]||(n[2]=T=>t.inputValue=T),type:t.inputType,placeholder:t.inputPlaceholder,"aria-invalid":t.validateError,class:ht({invalid:t.validateError}),onKeydown:Ya(t.handleInputEnter,["enter"])},null,8,["id","modelValue","type","placeholder","aria-invalid","class","onKeydown"]),gt("div",{class:ht(t.ns.e("errormsg")),style:xn({visibility:t.editorErrorMessage?"visible":"hidden"})},Lr(t.editorErrorMessage),7)],2),[[la,t.showInput]])],10,nge),gt("div",{class:ht(t.ns.e("btns"))},[t.showCancelButton?(De(),Ht(y,{key:0,loading:t.cancelButtonLoading,class:ht([t.cancelButtonClass]),round:t.roundButton,size:t.btnSize,onClick:n[3]||(n[3]=T=>t.handleAction("cancel")),onKeydown:n[4]||(n[4]=Ya(si(T=>t.handleAction("cancel"),["prevent"]),["enter"]))},{default:we(()=>[Sr(Lr(t.cancelButtonText||t.t("el.messagebox.cancel")),1)]),_:1},8,["loading","class","round","size"])):Wt("v-if",!0),ci(me(y,{ref:"confirmRef",type:"primary",loading:t.confirmButtonLoading,class:ht([t.confirmButtonClasses]),round:t.roundButton,disabled:t.confirmButtonDisabled,size:t.btnSize,onClick:n[5]||(n[5]=T=>t.handleAction("confirm")),onKeydown:n[6]||(n[6]=Ya(si(T=>t.handleAction("confirm"),["prevent"]),["enter"]))},{default:we(()=>[Sr(Lr(t.confirmButtonText||t.t("el.messagebox.confirm")),1)]),_:1},8,["loading","class","round","disabled","size"]),[[la,t.showConfirmButton]])],2)],6)]),_:3},8,["trapped","focus-trap-el","focus-start-el","onReleaseRequested"])],42,tge)]),_:3},8,["z-index","overlay-class","mask"]),[[la,t.visible]])]),_:3})}var age=Hr(ege,[["render",ige],["__file","/home/runner/work/element-plus/element-plus/packages/components/message-box/src/index.vue"]]);const $_=new Map,oge=t=>{let n=document.body;return t.appendTo&&(Mn(t.appendTo)&&(n=document.querySelector(t.appendTo)),pc(t.appendTo)&&(n=t.appendTo),pc(n)||(n=document.body)),n},sge=(t,n,a=null)=>{const s=me(age,t,Yr(t.message)||ps(t.message)?{default:Yr(t.message)?t.message:()=>t.message}:null);return s.appContext=a,W0(s,n),oge(t).appendChild(n.firstElementChild),s.component},lge=()=>document.createElement("div"),cge=(t,n)=>{const a=lge();t.onVanish=()=>{W0(null,a),$_.delete(c)},t.onAction=f=>{const d=$_.get(c);let p;t.showInput?p={value:c.inputValue,action:f}:p=f,t.callback?t.callback(p,s.proxy):f==="cancel"||f==="close"?t.distinguishCancelAndClose&&f!=="cancel"?d.reject("close"):d.reject("cancel"):d.resolve(p)};const s=sge(t,a,n),c=s.proxy;for(const f in t)Kn(t,f)&&!Kn(c.$props,f)&&(c[f]=t[f]);return c.visible=!0,c};function vm(t,n=null){if(!Li)return Promise.reject();let a;return Mn(t)||ps(t)?t={message:t}:a=t.callback,new Promise((s,c)=>{const f=cge(t,n??vm._context);$_.set(f,{options:t,callback:a,resolve:s,reject:c})})}const uge=["alert","confirm","prompt"],fge={alert:{closeOnPressEscape:!1,closeOnClickModal:!1},confirm:{showCancelButton:!0},prompt:{showCancelButton:!0,showInput:!0}};uge.forEach(t=>{vm[t]=hge(t)});function hge(t){return(n,a,s,c)=>{let f="";return $n(a)?(s=a,f=""):au(a)?f="":f=a,vm(Object.assign({title:f,message:n,type:"",...fge[t]},s,{boxType:t}),c)}}vm.close=()=>{$_.forEach((t,n)=>{n.doClose()}),$_.clear()};vm._context=null;const uh=vm;uh.install=t=>{uh._context=t._context,t.config.globalProperties.$msgbox=uh,t.config.globalProperties.$messageBox=uh,t.config.globalProperties.$alert=uh.alert,t.config.globalProperties.$confirm=uh.confirm,t.config.globalProperties.$prompt=uh.prompt};const Vu=uh,nU=["success","info","warning","error"],dge=rn({customClass:{type:String,default:""},dangerouslyUseHTMLString:{type:Boolean,default:!1},duration:{type:Number,default:4500},icon:{type:xo},id:{type:String,default:""},message:{type:br([String,Object]),default:""},offset:{type:Number,default:0},onClick:{type:br(Function),default:()=>{}},onClose:{type:br(Function),required:!0},position:{type:String,values:["top-right","top-left","bottom-right","bottom-left"],default:"top-right"},showClose:{type:Boolean,default:!0},title:{type:String,default:""},type:{type:String,values:[...nU,""],default:""},zIndex:Number}),pge={destroy:()=>!0},mge=["id"],gge=["textContent"],_ge={key:0},vge=["innerHTML"],yge=Ft({name:"ElNotification"}),xge=Ft({...yge,props:dge,emits:pge,setup(t,{expose:n}){const a=t,{ns:s,zIndex:c}=Hb("notification"),{nextZIndex:f,currentZIndex:d}=c,{Close:p}=oz,g=Ze(!1);let y;const b=Ve(()=>{const O=a.type;return O&&G0[a.type]?s.m(O):""}),E=Ve(()=>a.type&&G0[a.type]||a.icon),T=Ve(()=>a.position.endsWith("right")?"right":"left"),S=Ve(()=>a.position.startsWith("top")?"top":"bottom"),I=Ve(()=>{var O;return{[S.value]:`${a.offset}px`,zIndex:(O=a.zIndex)!=null?O:d.value}});function A(){a.duration>0&&({stop:y}=jx(()=>{g.value&&F()},a.duration))}function M(){y==null||y()}function F(){g.value=!1}function L({code:O}){O===ds.delete||O===ds.backspace?M():O===ds.esc?g.value&&F():A()}return di(()=>{A(),f(),g.value=!0}),Bs(document,"keydown",L),n({visible:g,close:F}),(O,N)=>(De(),Ht(Xo,{name:W(s).b("fade"),onBeforeLeave:O.onClose,onAfterLeave:N[1]||(N[1]=Q=>O.$emit("destroy")),persisted:""},{default:we(()=>[ci(gt("div",{id:O.id,class:ht([W(s).b(),O.customClass,W(T)]),style:xn(W(I)),role:"alert",onMouseenter:M,onMouseleave:A,onClick:N[0]||(N[0]=(...Q)=>O.onClick&&O.onClick(...Q))},[W(E)?(De(),Ht(W(Hn),{key:0,class:ht([W(s).e("icon"),W(b)])},{default:we(()=>[(De(),Ht(Zi(W(E))))]),_:1},8,["class"])):Wt("v-if",!0),gt("div",{class:ht(W(s).e("group"))},[gt("h2",{class:ht(W(s).e("title")),textContent:Lr(O.title)},null,10,gge),ci(gt("div",{class:ht(W(s).e("content")),style:xn(O.title?void 0:{margin:0})},[vr(O.$slots,"default",{},()=>[O.dangerouslyUseHTMLString?(De(),yt(mn,{key:1},[Wt(" Caution here, message could've been compromised, never use user's input as message "),gt("p",{innerHTML:O.message},null,8,vge)],2112)):(De(),yt("p",_ge,Lr(O.message),1))])],6),[[la,O.message]]),O.showClose?(De(),Ht(W(Hn),{key:0,class:ht(W(s).e("closeBtn")),onClick:si(F,["stop"])},{default:we(()=>[me(W(p))]),_:1},8,["class","onClick"])):Wt("v-if",!0)],2)],46,mge),[[la,g.value]])]),_:3},8,["name","onBeforeLeave"]))}});var bge=Hr(xge,[["__file","/home/runner/work/element-plus/element-plus/packages/components/notification/src/notification.vue"]]);const Jx={"top-left":[],"top-right":[],"bottom-left":[],"bottom-right":[]},CC=16;let wge=1;const rm=function(t={},n=null){if(!Li)return{close:()=>{}};(typeof t=="string"||ps(t))&&(t={message:t});const a=t.position||"top-right";let s=t.offset||0;Jx[a].forEach(({vm:b})=>{var E;s+=(((E=b.el)==null?void 0:E.offsetHeight)||0)+CC}),s+=CC;const c=`notification_${wge++}`,f=t.onClose,d={...t,offset:s,id:c,onClose:()=>{Ege(c,a,f)}};let p=document.body;pc(t.appendTo)?p=t.appendTo:Mn(t.appendTo)&&(p=document.querySelector(t.appendTo)),pc(p)||(p=document.body);const g=document.createElement("div"),y=me(bge,d,ps(d.message)?{default:()=>d.message}:null);return y.appContext=n??rm._context,y.props.onDestroy=()=>{W0(null,g)},W0(y,g),Jx[a].push({vm:y}),p.appendChild(g.firstElementChild),{close:()=>{y.component.exposed.visible.value=!1}}};nU.forEach(t=>{rm[t]=(n={})=>((typeof n=="string"||ps(n))&&(n={message:n}),rm({...n,type:t}))});function Ege(t,n,a){const s=Jx[n],c=s.findIndex(({vm:y})=>{var b;return((b=y.component)==null?void 0:b.props.id)===t});if(c===-1)return;const{vm:f}=s[c];if(!f)return;a==null||a(f);const d=f.el.offsetHeight,p=n.split("-")[0];s.splice(c,1);const g=s.length;if(!(g<1))for(let y=c;y<g;y++){const{el:b,component:E}=s[y].vm,T=Number.parseInt(b.style[p],10)-d-CC;E.props.offset=T}}function Tge(){for(const t of Object.values(Jx))t.forEach(({vm:n})=>{n.component.exposed.visible.value=!1})}rm.closeAll=Tge;rm._context=null;const cs=cz(rm,"$notify"),Sge=Ft({components:{ElConfigProvider:Uz},setup(){return{zIndex:3e3,size:"small"}}}),Cge=Object.assign(Sge,{__name:"App",setup(t){const{proxy:n}=Tn(),a=Ph();return window.sessionStorage.getItem("token")&&n.$axios.get("/user/verification",{responseType:"json"}).then(s=>{const{id:c,username:f,role_id:d}=s.data.data;a.id=c,a.username=f,a.role=d,a.isLoggedIn=!0}).catch(s=>{}),(s,c)=>{const f=Vi("router-view");return De(),Ht(W(Uz),{size:s.size,"z-index":s.zIndex},{default:we(()=>[me(f)]),_:1},8,["size","z-index"])}}});/*!
  * vue-router v4.2.5
  * (c) 2023 Eduardo San Martin Morote
  * @license MIT
  */const w0=typeof window<"u";function Age(t){return t.__esModule||t[Symbol.toStringTag]==="Module"}const na=Object.assign;function oS(t,n){const a={};for(const s in n){const c=n[s];a[s]=vc(c)?c.map(t):t(c)}return a}const l_=()=>{},vc=Array.isArray,kge=/\/$/,Ige=t=>t.replace(kge,"");function sS(t,n,a="/"){let s,c={},f="",d="";const p=n.indexOf("#");let g=n.indexOf("?");return p<g&&p>=0&&(g=-1),g>-1&&(s=n.slice(0,g),f=n.slice(g+1,p>-1?p:n.length),c=t(f)),p>-1&&(s=s||n.slice(0,p),d=n.slice(p,n.length)),s=Oge(s??n,a),{fullPath:s+(f&&"?")+f+d,path:s,query:c,hash:d}}function Mge(t,n){const a=n.query?t(n.query):"";return n.path+(a&&"?")+a+(n.hash||"")}function m5(t,n){return!n||!t.toLowerCase().startsWith(n.toLowerCase())?t:t.slice(n.length)||"/"}function Fge(t,n,a){const s=n.matched.length-1,c=a.matched.length-1;return s>-1&&s===c&&nm(n.matched[s],a.matched[c])&&iU(n.params,a.params)&&t(n.query)===t(a.query)&&n.hash===a.hash}function nm(t,n){return(t.aliasOf||t)===(n.aliasOf||n)}function iU(t,n){if(Object.keys(t).length!==Object.keys(n).length)return!1;for(const a in t)if(!Pge(t[a],n[a]))return!1;return!0}function Pge(t,n){return vc(t)?g5(t,n):vc(n)?g5(n,t):t===n}function g5(t,n){return vc(n)?t.length===n.length&&t.every((a,s)=>a===n[s]):t.length===1&&t[0]===n}function Oge(t,n){if(t.startsWith("/"))return t;if(!t)return n;const a=n.split("/"),s=t.split("/"),c=s[s.length-1];(c===".."||c===".")&&s.push("");let f=a.length-1,d,p;for(d=0;d<s.length;d++)if(p=s[d],p!==".")if(p==="..")f>1&&f--;else break;return a.slice(0,f).join("/")+"/"+s.slice(d-(d===s.length?1:0)).join("/")}var V_;(function(t){t.pop="pop",t.push="push"})(V_||(V_={}));var c_;(function(t){t.back="back",t.forward="forward",t.unknown=""})(c_||(c_={}));function Rge(t){if(!t)if(w0){const n=document.querySelector("base");t=n&&n.getAttribute("href")||"/",t=t.replace(/^\w+:\/\/[^\/]+/,"")}else t="/";return t[0]!=="/"&&t[0]!=="#"&&(t="/"+t),Ige(t)}const Lge=/^[^#]+#/;function Dge(t,n){return t.replace(Lge,"#")+n}function Bge(t,n){const a=document.documentElement.getBoundingClientRect(),s=t.getBoundingClientRect();return{behavior:n.behavior,left:s.left-a.left-(n.left||0),top:s.top-a.top-(n.top||0)}}const ew=()=>({left:window.pageXOffset,top:window.pageYOffset});function zge(t){let n;if("el"in t){const a=t.el,s=typeof a=="string"&&a.startsWith("#"),c=typeof a=="string"?s?document.getElementById(a.slice(1)):document.querySelector(a):a;if(!c)return;n=Bge(c,t)}else n=t;"scrollBehavior"in document.documentElement.style?window.scrollTo(n):window.scrollTo(n.left!=null?n.left:window.pageXOffset,n.top!=null?n.top:window.pageYOffset)}function _5(t,n){return(history.state?history.state.position-n:-1)+t}const AC=new Map;function Nge(t,n){AC.set(t,n)}function Uge(t){const n=AC.get(t);return AC.delete(t),n}let $ge=()=>location.protocol+"//"+location.host;function aU(t,n){const{pathname:a,search:s,hash:c}=n,f=t.indexOf("#");if(f>-1){let p=c.includes(t.slice(f))?t.slice(f).length:1,g=c.slice(p);return g[0]!=="/"&&(g="/"+g),m5(g,"")}return m5(a,t)+s+c}function Vge(t,n,a,s){let c=[],f=[],d=null;const p=({state:T})=>{const S=aU(t,location),I=a.value,A=n.value;let M=0;if(T){if(a.value=S,n.value=T,d&&d===I){d=null;return}M=A?T.position-A.position:0}else s(S);c.forEach(F=>{F(a.value,I,{delta:M,type:V_.pop,direction:M?M>0?c_.forward:c_.back:c_.unknown})})};function g(){d=a.value}function y(T){c.push(T);const S=()=>{const I=c.indexOf(T);I>-1&&c.splice(I,1)};return f.push(S),S}function b(){const{history:T}=window;T.state&&T.replaceState(na({},T.state,{scroll:ew()}),"")}function E(){for(const T of f)T();f=[],window.removeEventListener("popstate",p),window.removeEventListener("beforeunload",b)}return window.addEventListener("popstate",p),window.addEventListener("beforeunload",b,{passive:!0}),{pauseListeners:g,listen:y,destroy:E}}function v5(t,n,a,s=!1,c=!1){return{back:t,current:n,forward:a,replaced:s,position:window.history.length,scroll:c?ew():null}}function jge(t){const{history:n,location:a}=window,s={value:aU(t,a)},c={value:n.state};c.value||f(s.value,{back:null,current:s.value,forward:null,position:n.length-1,replaced:!0,scroll:null},!0);function f(g,y,b){const E=t.indexOf("#"),T=E>-1?(a.host&&document.querySelector("base")?t:t.slice(E))+g:$ge()+t+g;try{n[b?"replaceState":"pushState"](y,"",T),c.value=y}catch(S){console.error(S),a[b?"replace":"assign"](T)}}function d(g,y){const b=na({},n.state,v5(c.value.back,g,c.value.forward,!0),y,{position:c.value.position});f(g,b,!0),s.value=g}function p(g,y){const b=na({},c.value,n.state,{forward:g,scroll:ew()});f(b.current,b,!0);const E=na({},v5(s.value,g,null),{position:b.position+1},y);f(g,E,!1),s.value=g}return{location:s,state:c,push:p,replace:d}}function Wge(t){t=Rge(t);const n=jge(t),a=Vge(t,n.state,n.location,n.replace);function s(f,d=!0){d||a.pauseListeners(),history.go(f)}const c=na({location:"",base:t,go:s,createHref:Dge.bind(null,t)},n,a);return Object.defineProperty(c,"location",{enumerable:!0,get:()=>n.location.value}),Object.defineProperty(c,"state",{enumerable:!0,get:()=>n.state.value}),c}function Hge(t){return t=location.host?t||location.pathname+location.search:"",t.includes("#")||(t+="#"),Wge(t)}function Gge(t){return typeof t=="string"||t&&typeof t=="object"}function oU(t){return typeof t=="string"||typeof t=="symbol"}const nh={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0},sU=Symbol("");var y5;(function(t){t[t.aborted=4]="aborted",t[t.cancelled=8]="cancelled",t[t.duplicated=16]="duplicated"})(y5||(y5={}));function im(t,n){return na(new Error,{type:t,[sU]:!0},n)}function Du(t,n){return t instanceof Error&&sU in t&&(n==null||!!(t.type&n))}const x5="[^/]+?",qge={sensitive:!1,strict:!1,start:!0,end:!0},Xge=/[.+*?^${}()[\]/\\]/g;function Zge(t,n){const a=na({},qge,n),s=[];let c=a.start?"^":"";const f=[];for(const y of t){const b=y.length?[]:[90];a.strict&&!y.length&&(c+="/");for(let E=0;E<y.length;E++){const T=y[E];let S=40+(a.sensitive?.25:0);if(T.type===0)E||(c+="/"),c+=T.value.replace(Xge,"\\$&"),S+=40;else if(T.type===1){const{value:I,repeatable:A,optional:M,regexp:F}=T;f.push({name:I,repeatable:A,optional:M});const L=F||x5;if(L!==x5){S+=10;try{new RegExp(`(${L})`)}catch(N){throw new Error(`Invalid custom RegExp for param "${I}" (${L}): `+N.message)}}let O=A?`((?:${L})(?:/(?:${L}))*)`:`(${L})`;E||(O=M&&y.length<2?`(?:/${O})`:"/"+O),M&&(O+="?"),c+=O,S+=20,M&&(S+=-8),A&&(S+=-20),L===".*"&&(S+=-50)}b.push(S)}s.push(b)}if(a.strict&&a.end){const y=s.length-1;s[y][s[y].length-1]+=.7000000000000001}a.strict||(c+="/?"),a.end?c+="$":a.strict&&(c+="(?:/|$)");const d=new RegExp(c,a.sensitive?"":"i");function p(y){const b=y.match(d),E={};if(!b)return null;for(let T=1;T<b.length;T++){const S=b[T]||"",I=f[T-1];E[I.name]=S&&I.repeatable?S.split("/"):S}return E}function g(y){let b="",E=!1;for(const T of t){(!E||!b.endsWith("/"))&&(b+="/"),E=!1;for(const S of T)if(S.type===0)b+=S.value;else if(S.type===1){const{value:I,repeatable:A,optional:M}=S,F=I in y?y[I]:"";if(vc(F)&&!A)throw new Error(`Provided param "${I}" is an array but it is not repeatable (* or + modifiers)`);const L=vc(F)?F.join("/"):F;if(!L)if(M)T.length<2&&(b.endsWith("/")?b=b.slice(0,-1):E=!0);else throw new Error(`Missing required param "${I}"`);b+=L}}return b||"/"}return{re:d,score:s,keys:f,parse:p,stringify:g}}function Kge(t,n){let a=0;for(;a<t.length&&a<n.length;){const s=n[a]-t[a];if(s)return s;a++}return t.length<n.length?t.length===1&&t[0]===40+40?-1:1:t.length>n.length?n.length===1&&n[0]===40+40?1:-1:0}function Yge(t,n){let a=0;const s=t.score,c=n.score;for(;a<s.length&&a<c.length;){const f=Kge(s[a],c[a]);if(f)return f;a++}if(Math.abs(c.length-s.length)===1){if(b5(s))return 1;if(b5(c))return-1}return c.length-s.length}function b5(t){const n=t[t.length-1];return t.length>0&&n[n.length-1]<0}const Jge={type:0,value:""},Qge=/[a-zA-Z0-9_]/;function e_e(t){if(!t)return[[]];if(t==="/")return[[Jge]];if(!t.startsWith("/"))throw new Error(`Invalid path "${t}"`);function n(S){throw new Error(`ERR (${a})/"${y}": ${S}`)}let a=0,s=a;const c=[];let f;function d(){f&&c.push(f),f=[]}let p=0,g,y="",b="";function E(){y&&(a===0?f.push({type:0,value:y}):a===1||a===2||a===3?(f.length>1&&(g==="*"||g==="+")&&n(`A repeatable param (${y}) must be alone in its segment. eg: '/:ids+.`),f.push({type:1,value:y,regexp:b,repeatable:g==="*"||g==="+",optional:g==="*"||g==="?"})):n("Invalid state to consume buffer"),y="")}function T(){y+=g}for(;p<t.length;){if(g=t[p++],g==="\\"&&a!==2){s=a,a=4;continue}switch(a){case 0:g==="/"?(y&&E(),d()):g===":"?(E(),a=1):T();break;case 4:T(),a=s;break;case 1:g==="("?a=2:Qge.test(g)?T():(E(),a=0,g!=="*"&&g!=="?"&&g!=="+"&&p--);break;case 2:g===")"?b[b.length-1]=="\\"?b=b.slice(0,-1)+g:a=3:b+=g;break;case 3:E(),a=0,g!=="*"&&g!=="?"&&g!=="+"&&p--,b="";break;default:n("Unknown state");break}}return a===2&&n(`Unfinished custom RegExp for param "${y}"`),E(),d(),c}function t_e(t,n,a){const s=Zge(e_e(t.path),a),c=na(s,{record:t,parent:n,children:[],alias:[]});return n&&!c.record.aliasOf==!n.record.aliasOf&&n.children.push(c),c}function r_e(t,n){const a=[],s=new Map;n=T5({strict:!1,end:!0,sensitive:!1},n);function c(b){return s.get(b)}function f(b,E,T){const S=!T,I=n_e(b);I.aliasOf=T&&T.record;const A=T5(n,b),M=[I];if("alias"in b){const O=typeof b.alias=="string"?[b.alias]:b.alias;for(const N of O)M.push(na({},I,{components:T?T.record.components:I.components,path:N,aliasOf:T?T.record:I}))}let F,L;for(const O of M){const{path:N}=O;if(E&&N[0]!=="/"){const Q=E.record.path,ie=Q[Q.length-1]==="/"?"":"/";O.path=E.record.path+(N&&ie+N)}if(F=t_e(O,E,A),T?T.alias.push(F):(L=L||F,L!==F&&L.alias.push(F),S&&b.name&&!E5(F)&&d(b.name)),I.children){const Q=I.children;for(let ie=0;ie<Q.length;ie++)f(Q[ie],F,T&&T.children[ie])}T=T||F,(F.record.components&&Object.keys(F.record.components).length||F.record.name||F.record.redirect)&&g(F)}return L?()=>{d(L)}:l_}function d(b){if(oU(b)){const E=s.get(b);E&&(s.delete(b),a.splice(a.indexOf(E),1),E.children.forEach(d),E.alias.forEach(d))}else{const E=a.indexOf(b);E>-1&&(a.splice(E,1),b.record.name&&s.delete(b.record.name),b.children.forEach(d),b.alias.forEach(d))}}function p(){return a}function g(b){let E=0;for(;E<a.length&&Yge(b,a[E])>=0&&(b.record.path!==a[E].record.path||!lU(b,a[E]));)E++;a.splice(E,0,b),b.record.name&&!E5(b)&&s.set(b.record.name,b)}function y(b,E){let T,S={},I,A;if("name"in b&&b.name){if(T=s.get(b.name),!T)throw im(1,{location:b});A=T.record.name,S=na(w5(E.params,T.keys.filter(L=>!L.optional).map(L=>L.name)),b.params&&w5(b.params,T.keys.map(L=>L.name))),I=T.stringify(S)}else if("path"in b)I=b.path,T=a.find(L=>L.re.test(I)),T&&(S=T.parse(I),A=T.record.name);else{if(T=E.name?s.get(E.name):a.find(L=>L.re.test(E.path)),!T)throw im(1,{location:b,currentLocation:E});A=T.record.name,S=na({},E.params,b.params),I=T.stringify(S)}const M=[];let F=T;for(;F;)M.unshift(F.record),F=F.parent;return{name:A,path:I,params:S,matched:M,meta:a_e(M)}}return t.forEach(b=>f(b)),{addRoute:f,resolve:y,removeRoute:d,getRoutes:p,getRecordMatcher:c}}function w5(t,n){const a={};for(const s of n)s in t&&(a[s]=t[s]);return a}function n_e(t){return{path:t.path,redirect:t.redirect,name:t.name,meta:t.meta||{},aliasOf:void 0,beforeEnter:t.beforeEnter,props:i_e(t),children:t.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in t?t.components||null:t.component&&{default:t.component}}}function i_e(t){const n={},a=t.props||!1;if("component"in t)n.default=a;else for(const s in t.components)n[s]=typeof a=="object"?a[s]:a;return n}function E5(t){for(;t;){if(t.record.aliasOf)return!0;t=t.parent}return!1}function a_e(t){return t.reduce((n,a)=>na(n,a.meta),{})}function T5(t,n){const a={};for(const s in t)a[s]=s in n?n[s]:t[s];return a}function lU(t,n){return n.children.some(a=>a===t||lU(t,a))}const cU=/#/g,o_e=/&/g,s_e=/\//g,l_e=/=/g,c_e=/\?/g,uU=/\+/g,u_e=/%5B/g,f_e=/%5D/g,fU=/%5E/g,h_e=/%60/g,hU=/%7B/g,d_e=/%7C/g,dU=/%7D/g,p_e=/%20/g;function pk(t){return encodeURI(""+t).replace(d_e,"|").replace(u_e,"[").replace(f_e,"]")}function m_e(t){return pk(t).replace(hU,"{").replace(dU,"}").replace(fU,"^")}function kC(t){return pk(t).replace(uU,"%2B").replace(p_e,"+").replace(cU,"%23").replace(o_e,"%26").replace(h_e,"`").replace(hU,"{").replace(dU,"}").replace(fU,"^")}function g_e(t){return kC(t).replace(l_e,"%3D")}function __e(t){return pk(t).replace(cU,"%23").replace(c_e,"%3F")}function v_e(t){return t==null?"":__e(t).replace(s_e,"%2F")}function Qx(t){try{return decodeURIComponent(""+t)}catch{}return""+t}function y_e(t){const n={};if(t===""||t==="?")return n;const s=(t[0]==="?"?t.slice(1):t).split("&");for(let c=0;c<s.length;++c){const f=s[c].replace(uU," "),d=f.indexOf("="),p=Qx(d<0?f:f.slice(0,d)),g=d<0?null:Qx(f.slice(d+1));if(p in n){let y=n[p];vc(y)||(y=n[p]=[y]),y.push(g)}else n[p]=g}return n}function S5(t){let n="";for(let a in t){const s=t[a];if(a=g_e(a),s==null){s!==void 0&&(n+=(n.length?"&":"")+a);continue}(vc(s)?s.map(f=>f&&kC(f)):[s&&kC(s)]).forEach(f=>{f!==void 0&&(n+=(n.length?"&":"")+a,f!=null&&(n+="="+f))})}return n}function x_e(t){const n={};for(const a in t){const s=t[a];s!==void 0&&(n[a]=vc(s)?s.map(c=>c==null?null:""+c):s==null?s:""+s)}return n}const b_e=Symbol(""),C5=Symbol(""),tw=Symbol(""),pU=Symbol(""),IC=Symbol("");function Ng(){let t=[];function n(s){return t.push(s),()=>{const c=t.indexOf(s);c>-1&&t.splice(c,1)}}function a(){t=[]}return{add:n,list:()=>t.slice(),reset:a}}function dh(t,n,a,s,c){const f=s&&(s.enterCallbacks[c]=s.enterCallbacks[c]||[]);return()=>new Promise((d,p)=>{const g=E=>{E===!1?p(im(4,{from:a,to:n})):E instanceof Error?p(E):Gge(E)?p(im(2,{from:n,to:E})):(f&&s.enterCallbacks[c]===f&&typeof E=="function"&&f.push(E),d())},y=t.call(s&&s.instances[c],n,a,g);let b=Promise.resolve(y);t.length<3&&(b=b.then(g)),b.catch(E=>p(E))})}function lS(t,n,a,s){const c=[];for(const f of t)for(const d in f.components){let p=f.components[d];if(!(n!=="beforeRouteEnter"&&!f.instances[d]))if(w_e(p)){const y=(p.__vccOpts||p)[n];y&&c.push(dh(y,a,s,f,d))}else{let g=p();c.push(()=>g.then(y=>{if(!y)return Promise.reject(new Error(`Couldn't resolve component "${d}" at "${f.path}"`));const b=Age(y)?y.default:y;f.components[d]=b;const T=(b.__vccOpts||b)[n];return T&&dh(T,a,s,f,d)()}))}}return c}function w_e(t){return typeof t=="object"||"displayName"in t||"props"in t||"__vccOpts"in t}function A5(t){const n=Gr(tw),a=Gr(pU),s=Ve(()=>n.resolve(W(t.to))),c=Ve(()=>{const{matched:g}=s.value,{length:y}=g,b=g[y-1],E=a.matched;if(!b||!E.length)return-1;const T=E.findIndex(nm.bind(null,b));if(T>-1)return T;const S=k5(g[y-2]);return y>1&&k5(b)===S&&E[E.length-1].path!==S?E.findIndex(nm.bind(null,g[y-2])):T}),f=Ve(()=>c.value>-1&&C_e(a.params,s.value.params)),d=Ve(()=>c.value>-1&&c.value===a.matched.length-1&&iU(a.params,s.value.params));function p(g={}){return S_e(g)?n[W(t.replace)?"replace":"push"](W(t.to)).catch(l_):Promise.resolve()}return{route:s,href:Ve(()=>s.value.href),isActive:f,isExactActive:d,navigate:p}}const E_e=Ft({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"}},useLink:A5,setup(t,{slots:n}){const a=bo(A5(t)),{options:s}=Gr(tw),c=Ve(()=>({[I5(t.activeClass,s.linkActiveClass,"router-link-active")]:a.isActive,[I5(t.exactActiveClass,s.linkExactActiveClass,"router-link-exact-active")]:a.isExactActive}));return()=>{const f=n.default&&n.default(a);return t.custom?f:En("a",{"aria-current":a.isExactActive?t.ariaCurrentValue:null,href:a.href,onClick:a.navigate,class:c.value},f)}}}),T_e=E_e;function S_e(t){if(!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)&&!t.defaultPrevented&&!(t.button!==void 0&&t.button!==0)){if(t.currentTarget&&t.currentTarget.getAttribute){const n=t.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(n))return}return t.preventDefault&&t.preventDefault(),!0}}function C_e(t,n){for(const a in n){const s=n[a],c=t[a];if(typeof s=="string"){if(s!==c)return!1}else if(!vc(c)||c.length!==s.length||s.some((f,d)=>f!==c[d]))return!1}return!0}function k5(t){return t?t.aliasOf?t.aliasOf.path:t.path:""}const I5=(t,n,a)=>t??n??a,A_e=Ft({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(t,{attrs:n,slots:a}){const s=Gr(IC),c=Ve(()=>t.route||s.value),f=Gr(C5,0),d=Ve(()=>{let y=W(f);const{matched:b}=c.value;let E;for(;(E=b[y])&&!E.components;)y++;return y}),p=Ve(()=>c.value.matched[d.value]);Ji(C5,Ve(()=>d.value+1)),Ji(b_e,p),Ji(IC,c);const g=Ze();return gr(()=>[g.value,p.value,t.name],([y,b,E],[T,S,I])=>{b&&(b.instances[E]=y,S&&S!==b&&y&&y===T&&(b.leaveGuards.size||(b.leaveGuards=S.leaveGuards),b.updateGuards.size||(b.updateGuards=S.updateGuards))),y&&b&&(!S||!nm(b,S)||!T)&&(b.enterCallbacks[E]||[]).forEach(A=>A(y))},{flush:"post"}),()=>{const y=c.value,b=t.name,E=p.value,T=E&&E.components[b];if(!T)return M5(a.default,{Component:T,route:y});const S=E.props[b],I=S?S===!0?y.params:typeof S=="function"?S(y):S:null,M=En(T,na({},I,n,{onVnodeUnmounted:F=>{F.component.isUnmounted&&(E.instances[b]=null)},ref:g}));return M5(a.default,{Component:M,route:y})||M}}});function M5(t,n){if(!t)return null;const a=t(n);return a.length===1?a[0]:a}const k_e=A_e;function I_e(t){const n=r_e(t.routes,t),a=t.parseQuery||y_e,s=t.stringifyQuery||S5,c=t.history,f=Ng(),d=Ng(),p=Ng(),g=Rs(nh);let y=nh;w0&&t.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const b=oS.bind(null,oe=>""+oe),E=oS.bind(null,v_e),T=oS.bind(null,Qx);function S(oe,Me){let fe,pe;return oU(oe)?(fe=n.getRecordMatcher(oe),pe=Me):pe=oe,n.addRoute(pe,fe)}function I(oe){const Me=n.getRecordMatcher(oe);Me&&n.removeRoute(Me)}function A(){return n.getRoutes().map(oe=>oe.record)}function M(oe){return!!n.getRecordMatcher(oe)}function F(oe,Me){if(Me=na({},Me||g.value),typeof oe=="string"){const X=sS(a,oe,Me.path),Ce=n.resolve({path:X.path},Me),he=c.createHref(X.fullPath);return na(X,Ce,{params:T(Ce.params),hash:Qx(X.hash),redirectedFrom:void 0,href:he})}let fe;if("path"in oe)fe=na({},oe,{path:sS(a,oe.path,Me.path).path});else{const X=na({},oe.params);for(const Ce in X)X[Ce]==null&&delete X[Ce];fe=na({},oe,{params:E(X)}),Me.params=E(Me.params)}const pe=n.resolve(fe,Me),ot=oe.hash||"";pe.params=b(T(pe.params));const xe=Mge(s,na({},oe,{hash:m_e(ot),path:pe.path})),ae=c.createHref(xe);return na({fullPath:xe,hash:ot,query:s===S5?x_e(oe.query):oe.query||{}},pe,{redirectedFrom:void 0,href:ae})}function L(oe){return typeof oe=="string"?sS(a,oe,g.value.path):na({},oe)}function O(oe,Me){if(y!==oe)return im(8,{from:Me,to:oe})}function N(oe){return j(oe)}function Q(oe){return N(na(L(oe),{replace:!0}))}function ie(oe){const Me=oe.matched[oe.matched.length-1];if(Me&&Me.redirect){const{redirect:fe}=Me;let pe=typeof fe=="function"?fe(oe):fe;return typeof pe=="string"&&(pe=pe.includes("?")||pe.includes("#")?pe=L(pe):{path:pe},pe.params={}),na({query:oe.query,hash:oe.hash,params:"path"in pe?{}:oe.params},pe)}}function j(oe,Me){const fe=y=F(oe),pe=g.value,ot=oe.state,xe=oe.force,ae=oe.replace===!0,X=ie(fe);if(X)return j(na(L(X),{state:typeof X=="object"?na({},ot,X.state):ot,force:xe,replace:ae}),Me||fe);const Ce=fe;Ce.redirectedFrom=Me;let he;return!xe&&Fge(s,pe,fe)&&(he=im(16,{to:Ce,from:pe}),Oe(pe,pe,!0,!1)),(he?Promise.resolve(he):te(Ce,pe)).catch(G=>Du(G)?Du(G,2)?G:He(G):ut(G,Ce,pe)).then(G=>{if(G){if(Du(G,2))return j(na({replace:ae},L(G.to),{state:typeof G.to=="object"?na({},ot,G.to.state):ot,force:xe}),Me||Ce)}else G=J(Ce,pe,!0,ae,ot);return ue(Ce,pe,G),G})}function V(oe,Me){const fe=O(oe,Me);return fe?Promise.reject(fe):Promise.resolve()}function D(oe){const Me=et.values().next().value;return Me&&typeof Me.runWithContext=="function"?Me.runWithContext(oe):oe()}function te(oe,Me){let fe;const[pe,ot,xe]=M_e(oe,Me);fe=lS(pe.reverse(),"beforeRouteLeave",oe,Me);for(const X of pe)X.leaveGuards.forEach(Ce=>{fe.push(dh(Ce,oe,Me))});const ae=V.bind(null,oe,Me);return fe.push(ae),ze(fe).then(()=>{fe=[];for(const X of f.list())fe.push(dh(X,oe,Me));return fe.push(ae),ze(fe)}).then(()=>{fe=lS(ot,"beforeRouteUpdate",oe,Me);for(const X of ot)X.updateGuards.forEach(Ce=>{fe.push(dh(Ce,oe,Me))});return fe.push(ae),ze(fe)}).then(()=>{fe=[];for(const X of xe)if(X.beforeEnter)if(vc(X.beforeEnter))for(const Ce of X.beforeEnter)fe.push(dh(Ce,oe,Me));else fe.push(dh(X.beforeEnter,oe,Me));return fe.push(ae),ze(fe)}).then(()=>(oe.matched.forEach(X=>X.enterCallbacks={}),fe=lS(xe,"beforeRouteEnter",oe,Me),fe.push(ae),ze(fe))).then(()=>{fe=[];for(const X of d.list())fe.push(dh(X,oe,Me));return fe.push(ae),ze(fe)}).catch(X=>Du(X,8)?X:Promise.reject(X))}function ue(oe,Me,fe){p.list().forEach(pe=>D(()=>pe(oe,Me,fe)))}function J(oe,Me,fe,pe,ot){const xe=O(oe,Me);if(xe)return xe;const ae=Me===nh,X=w0?history.state:{};fe&&(pe||ae?c.replace(oe.fullPath,na({scroll:ae&&X&&X.scroll},ot)):c.push(oe.fullPath,ot)),g.value=oe,Oe(oe,Me,fe,ae),He()}let le;function re(){le||(le=c.listen((oe,Me,fe)=>{if(!Ge.listening)return;const pe=F(oe),ot=ie(pe);if(ot){j(na(ot,{replace:!0}),pe).catch(l_);return}y=pe;const xe=g.value;w0&&Nge(_5(xe.fullPath,fe.delta),ew()),te(pe,xe).catch(ae=>Du(ae,12)?ae:Du(ae,2)?(j(ae.to,pe).then(X=>{Du(X,20)&&!fe.delta&&fe.type===V_.pop&&c.go(-1,!1)}).catch(l_),Promise.reject()):(fe.delta&&c.go(-fe.delta,!1),ut(ae,pe,xe))).then(ae=>{ae=ae||J(pe,xe,!1),ae&&(fe.delta&&!Du(ae,8)?c.go(-fe.delta,!1):fe.type===V_.pop&&Du(ae,20)&&c.go(-1,!1)),ue(pe,xe,ae)}).catch(l_)}))}let Fe=Ng(),Ye=Ng(),Ee;function ut(oe,Me,fe){He(oe);const pe=Ye.list();return pe.length?pe.forEach(ot=>ot(oe,Me,fe)):console.error(oe),Promise.reject(oe)}function Ne(){return Ee&&g.value!==nh?Promise.resolve():new Promise((oe,Me)=>{Fe.add([oe,Me])})}function He(oe){return Ee||(Ee=!oe,re(),Fe.list().forEach(([Me,fe])=>oe?fe(oe):Me()),Fe.reset()),oe}function Oe(oe,Me,fe,pe){const{scrollBehavior:ot}=t;if(!w0||!ot)return Promise.resolve();const xe=!fe&&Uge(_5(oe.fullPath,0))||(pe||!fe)&&history.state&&history.state.scroll||null;return Fn().then(()=>ot(oe,Me,xe)).then(ae=>ae&&zge(ae)).catch(ae=>ut(ae,oe,Me))}const Pe=oe=>c.go(oe);let rt;const et=new Set,Ge={currentRoute:g,listening:!0,addRoute:S,removeRoute:I,hasRoute:M,getRoutes:A,resolve:F,options:t,push:N,replace:Q,go:Pe,back:()=>Pe(-1),forward:()=>Pe(1),beforeEach:f.add,beforeResolve:d.add,afterEach:p.add,onError:Ye.add,isReady:Ne,install(oe){const Me=this;oe.component("RouterLink",T_e),oe.component("RouterView",k_e),oe.config.globalProperties.$router=Me,Object.defineProperty(oe.config.globalProperties,"$route",{enumerable:!0,get:()=>W(g)}),w0&&!rt&&g.value===nh&&(rt=!0,N(c.location).catch(ot=>{}));const fe={};for(const ot in nh)Object.defineProperty(fe,ot,{get:()=>g.value[ot],enumerable:!0});oe.provide(tw,Me),oe.provide(pU,oA(fe)),oe.provide(IC,g);const pe=oe.unmount;et.add(oe),oe.unmount=function(){et.delete(oe),et.size<1&&(y=nh,le&&le(),le=null,g.value=nh,rt=!1,Ee=!1),pe()}}};function ze(oe){return oe.reduce((Me,fe)=>Me.then(()=>D(fe)),Promise.resolve())}return Ge}function M_e(t,n){const a=[],s=[],c=[],f=Math.max(n.matched.length,t.matched.length);for(let d=0;d<f;d++){const p=n.matched[d];p&&(t.matched.find(y=>nm(y,p))?s.push(p):a.push(p));const g=t.matched[d];g&&(n.matched.find(y=>nm(y,g))||c.push(g))}return[a,s,c]}function mU(){return Gr(tw)}const gU="/assets/logo-71b72a76.png",F_e="/assets/circle-83d4f865.svg",P_e="/building.png";var _U={exports:{}};(function(t,n){(function(a,s){t.exports=s()})($o,function(){var a,s,c;function f(p,g){if(!a)a=g;else if(!s)s=g;else{var y="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+a+")(sharedChunk); ("+s+")(sharedChunk); self.onerror = null;",b={};a(b),c=g(b),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(c.workerUrl=window.URL.createObjectURL(new Blob([y],{type:"text/javascript"})))}}f(["exports"],function(p){var g=typeof self<"u"?self:{},y="3.0.0";let b;const E={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(b==null){const r=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{b={}.API_URL_REGEX!=null?new RegExp({}.API_URL_REGEX):r}catch{b=r}}return b},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!E.API_URL)return null;try{const r=new URL(E.API_URL);return r.hostname==="api.mapbox.cn"?"https://events.mapbox.cn/events/v2":r.hostname==="api.mapbox.com"?"https://events.mapbox.com/events/v2":null}catch{return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,DEFAULT_STYLE:"mapbox://styles/mapbox/standard",MAX_PARALLEL_IMAGE_REQUESTS:16,DRACO_URL:"https://api.mapbox.com/mapbox-gl-js/draco_decoder_gltf_v1.5.6.wasm",GLYPHS_URL:"mapbox://fonts/mapbox/{fontstack}/{range}.pbf"},T={supported:!1,testSupport:function(r){!A&&I&&(M?F(r):S=r)}};let S,I,A=!1,M=!1;function F(r){const e=r.createTexture();r.bindTexture(r.TEXTURE_2D,e);try{if(r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,I),r.isContextLost())return;T.supported=!0}catch{}r.deleteTexture(e),A=!0}g.document&&(I=g.document.createElement("img"),I.onload=function(){S&&F(S),S=null,M=!0},I.onerror=function(){A=!0,S=null},I.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const L="01";function O(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var N=Q;function Q(r,e,i,o){this.cx=3*r,this.bx=3*(i-r)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(o-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=r,this.p1y=e,this.p2x=i,this.p2y=o}Q.prototype={sampleCurveX:function(r){return((this.ax*r+this.bx)*r+this.cx)*r},sampleCurveY:function(r){return((this.ay*r+this.by)*r+this.cy)*r},sampleCurveDerivativeX:function(r){return(3*this.ax*r+2*this.bx)*r+this.cx},solveCurveX:function(r,e){if(e===void 0&&(e=1e-6),r<0)return 0;if(r>1)return 1;for(var i=r,o=0;o<8;o++){var l=this.sampleCurveX(i)-r;if(Math.abs(l)<e)return i;var u=this.sampleCurveDerivativeX(i);if(Math.abs(u)<1e-6)break;i-=l/u}var h=0,m=1;for(i=r,o=0;o<20&&(l=this.sampleCurveX(i),!(Math.abs(l-r)<e));o++)r>l?h=i:m=i,i=.5*(m-h)+h;return i},solve:function(r,e){return this.sampleCurveY(this.solveCurveX(r,e))}};var ie=O(N),j=V;function V(r,e){this.x=r,this.y=e}V.prototype={clone:function(){return new V(this.x,this.y)},add:function(r){return this.clone()._add(r)},sub:function(r){return this.clone()._sub(r)},multByPoint:function(r){return this.clone()._multByPoint(r)},divByPoint:function(r){return this.clone()._divByPoint(r)},mult:function(r){return this.clone()._mult(r)},div:function(r){return this.clone()._div(r)},rotate:function(r){return this.clone()._rotate(r)},rotateAround:function(r,e){return this.clone()._rotateAround(r,e)},matMult:function(r){return this.clone()._matMult(r)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(r){return this.x===r.x&&this.y===r.y},dist:function(r){return Math.sqrt(this.distSqr(r))},distSqr:function(r){var e=r.x-this.x,i=r.y-this.y;return e*e+i*i},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(r){return Math.atan2(this.y-r.y,this.x-r.x)},angleWith:function(r){return this.angleWithSep(r.x,r.y)},angleWithSep:function(r,e){return Math.atan2(this.x*e-this.y*r,this.x*r+this.y*e)},_matMult:function(r){var e=r[2]*this.x+r[3]*this.y;return this.x=r[0]*this.x+r[1]*this.y,this.y=e,this},_add:function(r){return this.x+=r.x,this.y+=r.y,this},_sub:function(r){return this.x-=r.x,this.y-=r.y,this},_mult:function(r){return this.x*=r,this.y*=r,this},_div:function(r){return this.x/=r,this.y/=r,this},_multByPoint:function(r){return this.x*=r.x,this.y*=r.y,this},_divByPoint:function(r){return this.x/=r.x,this.y/=r.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var r=this.y;return this.y=this.x,this.x=-r,this},_rotate:function(r){var e=Math.cos(r),i=Math.sin(r),o=i*this.x+e*this.y;return this.x=e*this.x-i*this.y,this.y=o,this},_rotateAround:function(r,e){var i=Math.cos(r),o=Math.sin(r),l=e.y+o*(this.x-e.x)+i*(this.y-e.y);return this.x=e.x+i*(this.x-e.x)-o*(this.y-e.y),this.y=l,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},V.convert=function(r){return r instanceof V?r:Array.isArray(r)?new V(r[0],r[1]):r};var D=O(j);function te(r,e){if(Array.isArray(r)){if(!Array.isArray(e)||r.length!==e.length)return!1;for(let i=0;i<r.length;i++)if(!te(r[i],e[i]))return!1;return!0}if(typeof r=="object"&&r!==null&&e!==null){if(typeof e!="object"||Object.keys(r).length!==Object.keys(e).length)return!1;for(const i in r)if(!te(r[i],e[i]))return!1;return!0}return r===e}const ue=Math.PI/180,J=180/Math.PI;function le(r){return r*ue}function re(r){return r*J}const Fe=[[0,0],[1,0],[1,1],[0,1]];function Ye(r){if(r<=0)return 0;if(r>=1)return 1;const e=r*r,i=e*r;return 4*(r<.5?i:3*(r-e)+i-.75)}function Ee(r){let e=1/0,i=1/0,o=-1/0,l=-1/0;for(const u of r)e=Math.min(e,u.x),i=Math.min(i,u.y),o=Math.max(o,u.x),l=Math.max(l,u.y);return{min:new D(e,i),max:new D(o,l)}}function ut(r,e,i=0,o=!0){const l=new D(i,i),u=r.sub(l),h=e.add(l),m=[u,new D(h.x,u.y),h,new D(u.x,h.y)];return o&&m.push(u.clone()),m}function Ne(r,e,i,o){const l=new ie(r,e,i,o);return function(u){return l.solve(u)}}const He=Ne(.25,.1,.25,1);function Oe(r,e,i){return Math.min(i,Math.max(e,r))}function Pe(r,e,i){return(i=Oe((i-r)/(e-r),0,1))*i*(3-2*i)}function rt(r,e,i){const o=i-e,l=((r-e)%o+o)%o+e;return l===e?i:l}function et(r,e,i){if(!r.length)return i(null,[]);let o=r.length;const l=new Array(r.length);let u=null;r.forEach((h,m)=>{e(h,(_,v)=>{_&&(u=_),l[m]=v,--o==0&&i(u,l)})})}function Ge(r){const e=[];for(const i in r)e.push(r[i]);return e}function ze(r,...e){for(const i of e)for(const o in i)r[o]=i[o];return r}function oe(r,e){const i={};for(let o=0;o<e.length;o++){const l=e[o];l in r&&(i[l]=r[l])}return i}let Me=1;function fe(){return Me++}function pe(){return function r(e){return e?(e^Math.random()*(16>>e/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,r)}()}function ot(r){return r<=1?1:Math.pow(2,Math.ceil(Math.log(r)/Math.LN2))}function xe(r){return!!r&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(r)}function ae(r,e){r.forEach(i=>{e[i]&&(e[i]=e[i].bind(e))})}function X(r,e){return r.indexOf(e,r.length-e.length)!==-1}function Ce(r,e,i){const o={};for(const l in r)o[l]=e.call(i||this,r[l],l,r);return o}function he(r,e,i){const o={};for(const l in r)e.call(i||this,r[l],l,r)&&(o[l]=r[l]);return o}function G(r){return Array.isArray(r)?r.map(G):typeof r=="object"&&r?Ce(r,G):r}const K={};function se(r){K[r]||(typeof console<"u"&&console.warn(r),K[r]=!0)}function Ae(r,e,i){return(i.y-r.y)*(e.x-r.x)>(e.y-r.y)*(i.x-r.x)}function Se(r){let e=0;for(let i,o,l=0,u=r.length,h=u-1;l<u;h=l++)i=r[l],o=r[h],e+=(o.x-i.x)*(i.y+o.y);return e}function ye([r,e,i]){const o=le(e+90),l=le(i);return{x:r*Math.cos(o)*Math.sin(l),y:r*Math.sin(o)*Math.sin(l),z:r*Math.cos(l),azimuthal:e,polar:i}}function Xe(r,e,i){const o=Math.sqrt(r*r+e*e+i*i),l=o>0?Math.acos(i/o)*J:0;let u=r!==0||e!==0?Math.atan2(-e,-r)*J+90:0;return u<0&&(u+=360),[o,u,l]}function be(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function Be(r){const e={};if(r.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(i,o,l,u)=>{const h=l||u;return e[o]=!h||h.toLowerCase(),""}),e["max-age"]){const i=parseInt(e["max-age"],10);isNaN(i)?delete e["max-age"]:e["max-age"]=i}return e}let ct=null;function At(){return!!g.document.fullscreenElement||!!g.document.webkitFullscreenElement}function $t(r){try{const e=g[r];return e.setItem("_mapbox_test_",1),e.removeItem("_mapbox_test_"),!0}catch{return!1}}function mr(r,e){return[r[4*e],r[4*e+1],r[4*e+2],r[4*e+3]]}function Nt(r,e,i){r[4*e+0]=i[0],r[4*e+1]=i[1],r[4*e+2]=i[2],r[4*e+3]=i[3]}function Lt(r,e){return[Math.pow(r[0],2.2)*e,Math.pow(r[1],2.2)*e,Math.pow(r[2],2.2)*e]}function Qt(r){return[Math.pow(r[0],1/2.2),Math.pow(r[1],1/2.2),Math.pow(r[2],1/2.2)]}const Gt="mapbox-tiles";let dr=500,Br=50,qr,Ci;function Wi(){try{return g.caches}catch{}}function Fi(){Wi()&&!qr&&(qr=g.caches.open(Gt))}function Ta(r){const e=r.indexOf("?");if(e<0)return r;const i=function(l){const u=l.indexOf("?");return u>0?l.slice(u+1).split("&"):[]}(r),o=i.filter(l=>{const u=l.split("=");return u[0]==="language"||u[0]==="worldview"});return o.length?`${r.slice(0,e)}?${o.join("&")}`:r.slice(0,e)}let Sa=1/0;function Ai(r){Sa++,Sa>Br&&(r.getActor().send("enforceCacheSizeLimit",dr),Sa=0)}const Le={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image",Model:"Model"};typeof Object.freeze=="function"&&Object.freeze(Le);class lt extends Error{constructor(e,i,o){i===401&&qe(o)&&(e+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(e),this.status=i,this.url=o}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const xt=be()?()=>self.worker&&self.worker.referrer:()=>(g.location.protocol==="blob:"?g.parent:g).location.href,Ot=function(r,e){if(!(/^file:/.test(i=r.url)||/^file:/.test(xt())&&!/^\w+:/.test(i))){if(g.fetch&&g.Request&&g.AbortController&&g.Request.prototype.hasOwnProperty("signal"))return function(o,l){const u=new g.AbortController,h=new g.Request(o.url,{method:o.method||"GET",body:o.body,credentials:o.credentials,headers:o.headers,referrer:xt(),referrerPolicy:o.referrerPolicy,signal:u.signal});let m=!1,_=!1;const v=(x=h.url).indexOf("sku=")>0&&qe(x);var x;o.type==="json"&&h.headers.set("Accept","application/json");const w=(k,P,R)=>{if(_)return;if(k&&k.message!=="SecurityError"&&se(k.toString()),P&&R)return C(P);const z=Date.now();g.fetch(h).then(B=>{if(B.ok){const H=v?B.clone():null;return C(B,H,z)}return l(new lt(B.statusText,B.status,o.url))}).catch(B=>{B.name!=="AbortError"&&l(new Error(`${B.message} ${o.url}`))})},C=(k,P,R)=>{(o.type==="arrayBuffer"?k.arrayBuffer():o.type==="json"?k.json():k.text()).then(z=>{_||(P&&R&&function(B,H,Z){if(Fi(),!qr)return;const Y={status:H.status,statusText:H.statusText,headers:new g.Headers};H.headers.forEach((ce,de)=>Y.headers.set(de,ce));const q=Be(H.headers.get("Cache-Control")||"");if(q["no-store"])return;q["max-age"]&&Y.headers.set("Expires",new Date(Z+1e3*q["max-age"]).toUTCString());const ee=Y.headers.get("Expires");ee&&(new Date(ee).getTime()-Z<42e4||function(ce,de){if(Ci===void 0)try{new Response(new ReadableStream),Ci=!0}catch{Ci=!1}Ci?de(ce.body):ce.blob().then(de)}(H,ce=>{const de=new g.Response(ce,Y);Fi(),qr&&qr.then(ge=>ge.put(Ta(B.url),de)).catch(ge=>se(ge.message))}))}(h,P,R),m=!0,l(null,z,k.headers.get("Cache-Control"),k.headers.get("Expires")))}).catch(z=>{_||l(new Error(z.message))})};return v?function(k,P){if(Fi(),!qr)return P(null);const R=Ta(k.url);qr.then(z=>{z.match(R).then(B=>{const H=function(Z){if(!Z)return!1;const Y=new Date(Z.headers.get("Expires")||0),q=Be(Z.headers.get("Cache-Control")||"");return Y>Date.now()&&!q["no-cache"]}(B);z.delete(R),H&&z.put(R,B.clone()),P(null,B,H)}).catch(P)}).catch(P)}(h,w):w(null,null),{cancel:()=>{_=!0,m||u.abort()}}}(r,e);if(be()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",r,e,void 0,!0)}var i;return function(o,l){const u=new g.XMLHttpRequest;u.open(o.method||"GET",o.url,!0),o.type==="arrayBuffer"&&(u.responseType="arraybuffer");for(const h in o.headers)u.setRequestHeader(h,o.headers[h]);return o.type==="json"&&(u.responseType="text",u.setRequestHeader("Accept","application/json")),u.withCredentials=o.credentials==="include",u.onerror=()=>{l(new Error(u.statusText))},u.onload=()=>{if((u.status>=200&&u.status<300||u.status===0)&&u.response!==null){let h=u.response;if(o.type==="json")try{h=JSON.parse(u.response)}catch(m){return l(m)}l(null,h,u.getResponseHeader("Cache-Control"),u.getResponseHeader("Expires"))}else l(new lt(u.statusText,u.status,o.url))},u.send(o.body),{cancel:()=>u.abort()}}(r,e)},jt=function(r,e){return Ot(ze(r,{type:"json"}),e)},qt=function(r,e){return Ot(ze(r,{type:"arrayBuffer"}),e)};function Jt(r){const e=g.document.createElement("a");return e.href=r,e.protocol===g.document.location.protocol&&e.host===g.document.location.host}const Xt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let or,er;or=[],er=0;const Ur=function(r,e){if(T.supported&&(r.headers||(r.headers={}),r.headers.accept="image/webp,*/*"),er>=E.MAX_PARALLEL_IMAGE_REQUESTS){const u={requestParameters:r,callback:e,cancelled:!1,cancel(){this.cancelled=!0}};return or.push(u),u}er++;let i=!1;const o=()=>{if(!i)for(i=!0,er--;or.length&&er<E.MAX_PARALLEL_IMAGE_REQUESTS;){const u=or.shift(),{requestParameters:h,callback:m,cancelled:_}=u;_||(u.cancel=Ur(h,m).cancel)}},l=qt(r,(u,h,m,_)=>{o(),u?e(u):h&&(g.createImageBitmap?function(v,x){const w=new g.Blob([new Uint8Array(v)],{type:"image/png"});g.createImageBitmap(w).then(C=>{x(null,C)}).catch(C=>{x(new Error(`Could not load image because of ${C.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(h,(v,x)=>e(v,x,m,_)):function(v,x){const w=new g.Image,C=g.URL;w.onload=()=>{x(null,w),C.revokeObjectURL(w.src),w.onload=null,g.requestAnimationFrame(()=>{w.src=Xt})},w.onerror=()=>x(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const k=new g.Blob([new Uint8Array(v)],{type:"image/png"});w.src=v.byteLength?C.createObjectURL(k):Xt}(h,(v,x)=>e(v,x,m,_)))});return{cancel:()=>{l.cancel(),o()}}},fn="NO_ACCESS_TOKEN";class Cr{constructor(e,i,o){this._transformRequestFn=e,this._customAccessToken=i,this._silenceAuthErrors=!!o,this._createSkuToken()}_createSkuToken(){const e=function(){let i="";for(let o=0;o<10;o++)i+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",L,i].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=e.token,this._skuTokenExpiresAt=e.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(e,i){return this._transformRequestFn&&this._transformRequestFn(e,i)||{url:e}}normalizeStyleURL(e,i){if(!_e(e))return e;const o=It(e);return o.params.push(`sdk=js-${y}`),o.path=`/styles/v1${o.path}`,this._makeAPIURL(o,this._customAccessToken||i)}normalizeGlyphsURL(e,i){if(!_e(e))return e;const o=It(e);return o.path=`/fonts/v1${o.path}`,this._makeAPIURL(o,this._customAccessToken||i)}normalizeModelURL(e,i){if(!_e(e))return e;const o=It(e);return o.path=`/models/v1${o.path}`,this._makeAPIURL(o,this._customAccessToken||i)}normalizeSourceURL(e,i,o,l){if(!_e(e))return e;const u=It(e);return u.path=`/v4/${u.authority}.json`,u.params.push("secure"),o&&u.params.push(`language=${o}`),l&&u.params.push(`worldview=${l}`),this._makeAPIURL(u,this._customAccessToken||i)}normalizeSpriteURL(e,i,o,l){const u=It(e);return _e(e)?(u.path=`/styles/v1${u.path}/sprite${i}${o}`,this._makeAPIURL(u,this._customAccessToken||l)):(u.path+=`${i}${o}`,Bt(u))}normalizeTileURL(e,i,o){if(this._isSkuTokenExpired()&&this._createSkuToken(),e&&!_e(e))return e;const l=It(e);l.path=l.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${i||o&&l.authority!=="raster"&&o===512?"@2x":""}${T.supported?".webp":"$1"}`),l.authority==="raster"?l.path=`/${E.RASTER_URL_PREFIX}${l.path}`:(l.path=l.path.replace(/^.+\/v4\//,"/"),l.path=`/${E.TILE_URL_VERSION}${l.path}`);const u=this._customAccessToken||function(h){for(const m of h){const _=m.match(/^access_token=(.*)$/);if(_)return _[1]}return null}(l.params)||E.ACCESS_TOKEN;return E.REQUIRE_ACCESS_TOKEN&&u&&this._skuToken&&l.params.push(`sku=${this._skuToken}`),this._makeAPIURL(l,u)}canonicalizeTileURL(e,i){const o=It(e);if(!o.path.match(/^(\/v4\/|\/raster\/v1\/)/)||!o.path.match(/\.[\w]+$/))return e;let l="mapbox://";o.path.match(/^\/raster\/v1\//)?l+=`raster/${o.path.replace(`/${E.RASTER_URL_PREFIX}/`,"")}`:l+=`tiles/${o.path.replace(`/${E.TILE_URL_VERSION}/`,"")}`;let u=o.params;return i&&(u=u.filter(h=>!h.match(/^access_token=/))),u.length&&(l+=`?${u.join("&")}`),l}canonicalizeTileset(e,i){const o=!!i&&_e(i),l=[];for(const u of e.tiles||[])qe(u)?l.push(this.canonicalizeTileURL(u,o)):l.push(u);return l}_makeAPIURL(e,i){const o="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",l=It(E.API_URL);if(e.protocol=l.protocol,e.authority=l.authority,e.protocol==="http"){const u=e.params.indexOf("secure");u>=0&&e.params.splice(u,1)}if(l.path!=="/"&&(e.path=`${l.path}${e.path}`),!E.REQUIRE_ACCESS_TOKEN)return Bt(e);if(i=i||E.ACCESS_TOKEN,!this._silenceAuthErrors){if(!i)throw new Error(`An API access token is required to use Mapbox GL. ${o}`);if(i[0]==="s")throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${o}`)}return e.params=e.params.filter(u=>u.indexOf("access_token")===-1),e.params.push(`access_token=${i||""}`),Bt(e)}}function _e(r){return r.indexOf("mapbox:")===0}function qe(r){return E.API_URL_REGEX.test(r)}function Ue(r){return E.API_CDN_URL_REGEX.test(r)}function je(r){return E.API_STYLE_REGEX.test(r)&&!Ke(r)}function Ke(r){return E.API_SPRITE_REGEX.test(r)}const nt=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function It(r){const e=r.match(nt);if(!e)throw new Error("Unable to parse URL object");return{protocol:e[1],authority:e[2],path:e[3]||"/",params:e[4]?e[4].split("&"):[]}}function Bt(r){const e=r.params.length?`?${r.params.join("&")}`:"";return`${r.protocol}://${r.authority}${r.path}${e}`}const kt="mapbox.eventData";function Dt(r){if(!r)return null;const e=r.split(".");if(!e||e.length!==3)return null;try{return JSON.parse(decodeURIComponent(g.atob(e[1]).split("").map(i=>"%"+("00"+i.charCodeAt(0).toString(16)).slice(-2)).join("")))}catch{return null}}class Rt{constructor(e){this.type=e,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(e){const i=Dt(E.ACCESS_TOKEN);let o="";return o=i&&i.u?g.btoa(encodeURIComponent(i.u).replace(/%([0-9A-F]{2})/g,(l,u)=>String.fromCharCode(+("0x"+u)))):E.ACCESS_TOKEN||"",e?`${kt}.${e}:${o}`:`${kt}:${o}`}fetchEventData(){const e=$t("localStorage"),i=this.getStorageKey(),o=this.getStorageKey("uuid");if(e)try{const l=g.localStorage.getItem(i);l&&(this.eventData=JSON.parse(l));const u=g.localStorage.getItem(o);u&&(this.anonId=u)}catch{se("Unable to read from LocalStorage")}}saveEventData(){const e=$t("localStorage"),i=this.getStorageKey(),o=this.getStorageKey("uuid");if(e)try{g.localStorage.setItem(o,this.anonId),Object.keys(this.eventData).length>=1&&g.localStorage.setItem(i,JSON.stringify(this.eventData))}catch{se("Unable to write to LocalStorage")}}processRequests(e){}postEvent(e,i,o,l){if(!E.EVENTS_URL)return;const u=It(E.EVENTS_URL);u.params.push(`access_token=${l||E.ACCESS_TOKEN||""}`);const h={event:this.type,created:new Date(e).toISOString()},m=i?ze(h,i):h,_={url:Bt(u),headers:{"Content-Type":"text/plain"},body:JSON.stringify([m])};this.pendingRequest=function(v,x){return Ot(ze(v,{method:"POST"}),x)}(_,v=>{this.pendingRequest=null,o(v),this.saveEventData(),this.processRequests(l)})}queueRequest(e,i){this.queue.push(e),this.processRequests(i)}}const fr=new class extends Rt{constructor(r){super("appUserTurnstile"),this._customAccessToken=r}postTurnstileEvent(r,e){E.EVENTS_URL&&E.ACCESS_TOKEN&&Array.isArray(r)&&r.some(i=>_e(i)||qe(i))&&this.queueRequest(Date.now(),e)}processRequests(r){if(this.pendingRequest||this.queue.length===0)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const e=Dt(E.ACCESS_TOKEN),i=e?e.u:E.ACCESS_TOKEN;let o=i!==this.eventData.tokenU;xe(this.anonId)||(this.anonId=pe(),o=!0);const l=this.queue.shift();if(this.eventData.lastSuccess){const u=new Date(this.eventData.lastSuccess),h=new Date(l),m=(l-this.eventData.lastSuccess)/864e5;o=o||m>=1||m<-1||u.getDate()!==h.getDate()}else o=!0;o?this.postEvent(l,{sdkIdentifier:"mapbox-gl-js",sdkVersion:y,skuId:L,"enabled.telemetry":!1,userId:this.anonId},u=>{u||(this.eventData.lastSuccess=l,this.eventData.tokenU=i)},r):this.processRequests()}},Tr=fr.postTurnstileEvent.bind(fr),zr=new class extends Rt{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(r,e,i,o){this.skuToken=e,this.errorCb=o,E.EVENTS_URL&&(i||E.ACCESS_TOKEN?this.queueRequest({id:r,timestamp:Date.now()},i):this.errorCb(new Error(fn)))}processRequests(r){if(this.pendingRequest||this.queue.length===0)return;const{id:e,timestamp:i}=this.queue.shift();e&&this.success[e]||(this.anonId||this.fetchEventData(),xe(this.anonId)||(this.anonId=pe()),this.postEvent(i,{sdkIdentifier:"mapbox-gl-js",sdkVersion:y,skuId:L,skuToken:this.skuToken,userId:this.anonId},o=>{o?this.errorCb(o):e&&(this.success[e]=!0)},r))}},yr=zr.postMapLoadEvent.bind(zr),wr=new class extends Rt{constructor(){super("gljs.performance")}postPerformanceEvent(r,e){E.EVENTS_URL&&(r||E.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:e},r)}processRequests(r){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:e,performanceData:i}=this.queue.shift(),o=function(l){const u=g.performance.getEntriesByType("resource"),h=g.performance.getEntriesByType("mark"),m=function(C){const k={};if(C){for(const P in C)if(P!=="other")for(const R of C[P]){const z=`${P}ResolveRangeMin`,B=`${P}ResolveRangeMax`,H=`${P}RequestCount`,Z=`${P}RequestCachedCount`;k[z]=Math.min(k[z]||1/0,R.startTime),k[B]=Math.max(k[B]||-1/0,R.responseEnd);const Y=q=>{k[q]===void 0&&(k[q]=0),++k[q]};R.transferSize!==void 0&&R.transferSize===0&&Y(Z),Y(H)}}return k}(function(C,k){const P={};if(C)for(const R of C){const z=k(R);P[z]===void 0&&(P[z]=[]),P[z].push(R)}return P}(u,_s)),_=g.devicePixelRatio,v=g.navigator.connection||g.navigator.mozConnection||g.navigator.webkitConnection,x={counters:[],metadata:[],attributes:[]},w=(C,k,P)=>{P!=null&&C.push({name:k,value:P.toString()})};for(const C in m)w(x.counters,C,m[C]);if(l.interactionRange[0]!==1/0&&l.interactionRange[1]!==-1/0&&(w(x.counters,"interactionRangeMin",l.interactionRange[0]),w(x.counters,"interactionRangeMax",l.interactionRange[1])),h)for(const C of Object.keys(ro)){const k=ro[C],P=h.find(R=>R.name===k);P&&w(x.counters,k,P.startTime)}return w(x.counters,"visibilityHidden",l.visibilityHidden),w(x.attributes,"style",function(C){if(C)for(const k of C){const P=k.name.split("?")[0];if(je(P)){const R=P.split("/").slice(-2);if(R.length===2)return`mapbox://styles/${R[0]}/${R[1]}`}}}(u)),w(x.attributes,"terrainEnabled",l.terrainEnabled?"true":"false"),w(x.attributes,"fogEnabled",l.fogEnabled?"true":"false"),w(x.attributes,"projection",l.projection),w(x.attributes,"zoom",l.zoom),w(x.metadata,"devicePixelRatio",_),w(x.metadata,"connectionEffectiveType",v?v.effectiveType:void 0),w(x.metadata,"navigatorUserAgent",g.navigator.userAgent),w(x.metadata,"screenWidth",g.screen.width),w(x.metadata,"screenHeight",g.screen.height),w(x.metadata,"windowWidth",g.innerWidth),w(x.metadata,"windowHeight",g.innerHeight),w(x.metadata,"mapWidth",l.width/_),w(x.metadata,"mapHeight",l.height/_),w(x.metadata,"webglRenderer",l.renderer),w(x.metadata,"webglVendor",l.vendor),w(x.metadata,"sdkVersion",y),w(x.metadata,"sdkIdentifier","mapbox-gl-js"),x}(i);for(const l of o.metadata);for(const l of o.counters);for(const l of o.attributes);this.postEvent(e,o,()=>{},r)}},On=wr.postPerformanceEvent.bind(wr),Di=new class extends Rt{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(r,e,i,o){if(!E.API_URL||!E.SESSION_PATH)return;const l=It(E.API_URL+E.SESSION_PATH);l.params.push(`sku=${e||""}`),l.params.push(`access_token=${o||E.ACCESS_TOKEN||""}`);const u={url:Bt(l),headers:{"Content-Type":"text/plain"}};this.pendingRequest=function(h,m){return Ot(ze(h,{method:"GET"}),m)}(u,h=>{this.pendingRequest=null,i(h),this.saveEventData(),this.processRequests(o)})}getSessionAPI(r,e,i,o){this.skuToken=e,this.errorCb=o,E.SESSION_PATH&&E.API_URL&&(i||E.ACCESS_TOKEN?this.queueRequest({id:r,timestamp:Date.now()},i):this.errorCb(new Error(fn)))}processRequests(r){if(this.pendingRequest||this.queue.length===0)return;const{id:e,timestamp:i}=this.queue.shift();e&&this.success[e]||this.getSession(i,this.skuToken,o=>{o?this.errorCb(o):e&&(this.success[e]=!0)},r)}},Vn=Di.getSessionAPI.bind(Di),Ca=new Set;function zl(r,e){e?Ca.add(r):Ca.delete(r)}const ro={create:"create",load:"load",fullLoad:"fullLoad"},no={mark(r){g.performance.mark(r)},measure(r,e,i){g.performance.measure(r,e,i)}};function _s(r){const e=r.name.split("?")[0];return Ue(e)&&e.includes("mapbox-gl.js")?"javascript":Ue(e)&&e.includes("mapbox-gl.css")?"css":function(i){return E.API_FONTS_REGEX.test(i)}(e)?"fontRange":Ke(e)?"sprite":je(e)?"style":function(i){return E.API_TILEJSON_REGEX.test(i)}(e)?"tilejson":"other"}const js=g.performance;function Ha(r){const e=r?r.url.toString():void 0;return js.getEntriesByName(e)}var km=Im;function Im(r){return!function(e){return typeof window>"u"||typeof document>"u"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var o,l,u=new Blob([""],{type:"text/javascript"}),h=URL.createObjectURL(u);try{l=new Worker(h),o=!0}catch{o=!1}return l&&l.terminate(),URL.revokeObjectURL(h),o}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var o=document.createElement("canvas");o.width=o.height=1;var l=o.getContext("2d");if(!l)return!1;var u=l.getImageData(0,0,1,1);return u&&u.width===o.width}()?(Mm[i=e&&e.failIfMajorPerformanceCaveat]===void 0&&(Mm[i]=function(o){var l,u=function(h){var m=document.createElement("canvas"),_=Object.create(Im.webGLContextAttributes);return _.failIfMajorPerformanceCaveat=h,m.getContext("webgl",_)||m.getContext("experimental-webgl",_)}(o);if(!u)return!1;try{l=u.createShader(u.VERTEX_SHADER)}catch{return!1}return!(!l||u.isContextLost())&&(u.shaderSource(l,"void main() {}"),u.compileShader(l),u.getShaderParameter(l,u.COMPILE_STATUS)===!0)}(i)),Mm[i]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var i}(r)}var Mm={};let mp,gp,hf,Sc;Im.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};const Jr={now:()=>hf!==void 0?hf:g.performance.now(),setNow(r){hf=r},restoreNow(){hf=void 0},frame(r){const e=g.requestAnimationFrame(r);return{cancel:()=>g.cancelAnimationFrame(e)}},getImageData(r,e=0){const{width:i,height:o}=r;Sc||(Sc=g.document.createElement("canvas"));const l=Sc.getContext("2d",{willReadFrequently:!0});if(!l)throw new Error("failed to create canvas 2d context");return(i>Sc.width||o>Sc.height)&&(Sc.width=i,Sc.height=o),l.clearRect(-e,-e,i+2*e,o+2*e),l.drawImage(r,0,0,i,o),l.getImageData(-e,-e,i+2*e,o+2*e)},resolveURL:r=>(mp||(mp=g.document.createElement("a")),mp.href=r,mp.href),get devicePixelRatio(){return g.devicePixelRatio},get prefersReducedMotion(){return!!g.matchMedia&&(gp==null&&(gp=g.matchMedia("(prefers-reduced-motion: reduce)")),gp.matches)}};function pi(r,e,i){const o=g.document.createElement(r);return e!==void 0&&(o.className=e),i&&i.appendChild(o),o}function Nl(r,e,i){const o=g.document.createElementNS("http://www.w3.org/2000/svg",r);for(const l of Object.keys(e))o.setAttributeNS(null,l,e[l]);return i&&i.appendChild(o),o}const pu=g.document&&g.document.documentElement.style,Cc=pu&&pu.userSelect!==void 0?"userSelect":"WebkitUserSelect";let U;function ne(){pu&&Cc&&(U=pu[Cc],pu[Cc]="none")}function Te(){pu&&Cc&&(pu[Cc]=U)}function it(r){r.preventDefault(),r.stopPropagation(),g.removeEventListener("click",it,!0)}function mt(){g.addEventListener("click",it,!0),g.setTimeout(()=>{g.removeEventListener("click",it,!0)},0)}function vt(r,e){const i=r.getBoundingClientRect();return _r(r,i,e)}function wt(r,e){const i=r.getBoundingClientRect(),o=[];for(let l=0;l<e.length;l++)o.push(_r(r,i,e[l]));return o}function sr(r){return g.InstallTrigger!==void 0&&r.button===2&&r.ctrlKey&&g.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:r.button}function _r(r,e,i){const o=r.offsetWidth===e.width?1:r.offsetWidth/e.width;return new D((i.clientX-e.left)*o,(i.clientY-e.top)*o)}function Fr(r,e,i){i[r]&&i[r].indexOf(e)!==-1||(i[r]=i[r]||[],i[r].push(e))}function Ir(r,e,i){if(i&&i[r]){const o=i[r].indexOf(e);o!==-1&&i[r].splice(o,1)}}class _t{constructor(e,i={}){ze(this,i),this.type=e}}class ar extends _t{constructor(e,i={}){super("error",ze({error:e},i))}}class Ln{on(e,i){return this._listeners=this._listeners||{},Fr(e,i,this._listeners),this}off(e,i){return Ir(e,i,this._listeners),Ir(e,i,this._oneTimeListeners),this}once(e,i){return i?(this._oneTimeListeners=this._oneTimeListeners||{},Fr(e,i,this._oneTimeListeners),this):new Promise(o=>this.once(e,o))}fire(e,i){typeof e=="string"&&(e=new _t(e,i||{}));const o=e.type;if(this.listens(o)){e.target=this;const l=this._listeners&&this._listeners[o]?this._listeners[o].slice():[];for(const m of l)m.call(this,e);const u=this._oneTimeListeners&&this._oneTimeListeners[o]?this._oneTimeListeners[o].slice():[];for(const m of u)Ir(o,m,this._oneTimeListeners),m.call(this,e);const h=this._eventedParent;h&&(ze(e,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),h.fire(e))}else e instanceof ar&&console.error(e.error);return this}listens(e){return!!(this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e))}setEventedParent(e,i){return this._eventedParent=e,this._eventedParentData=i,this}}var at=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"fragment":{"type":"boolean"},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360},"pitch":{"type":"number","default":0},"light":{"type":"light"},"lights":{"required":false,"type":"array","value":"light-3d"},"terrain":{"type":"terrain"},"fog":{"type":"fog"},"camera":{"type":"camera"},"imports":{"type":"array","value":"import"},"schema":{"type":"schema"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string","default":"mapbox://fonts/mapbox/{fontstack}/{range}.pbf"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"},"models":{"type":"models"}},"model":{"type":"string","required":true},"import":{"id":{"type":"string","required":true},"url":{"type":"string","required":true},"config":{"type":"config"},"data":{"type":"$root"}},"config":{"*":{"type":"*"}},"schema":{"*":{"type":"option"}},"option":{"default":{"type":"*","required":true},"type":{"type":"enum","values":{"string":1,"number":1,"boolean":1,"color":1}},"array":{"type":"boolean"},"minValue":{"type":"number"},"maxValue":{"type":"number"},"stepValue":{"type":"number"},"values":{"type":"array","value":"*"},"metadata":{"type":"*"}},"models":{"*":{"type":"model"}},"light-3d":{"id":{"type":"string","required":true},"properties":{"type":"properties"},"type":{"type":"enum","values":{"ambient":{},"directional":{},"flat":{}}}},"properties":["properties_light_directional","properties_light_ambient","properties_light_flat"],"properties_light_directional":{"direction":{"type":"array","default":[210,30],"minimum":[0,0],"maximum":[360,90],"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"cast-shadows":{"type":"boolean","default":false,"expression":{},"property-type":"data-constant"},"shadow-intensity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_ambient":{"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_flat":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"property-type":"data-constant","expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image","source_model"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":1,"mapbox":1},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":1}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":1}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":1}},"url":{"required":false,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_model":{"type":{"required":true,"type":"enum","values":{"model":1,"batched-model":1}},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"tiles":{"type":"array","value":"string"}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"hillshade":{},"model":{},"background":{},"sky":{},"slot":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"slot":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky","layout_model"],"layout_background":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_model":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"model-id":{"type":"string","default":"","property-type":"data-driven","expression":{"parameters":["zoom","feature"]}}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","private":true,"default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":1,"round":1,"square":1},"default":"butt","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":1,"round":1,"miter":1},"default":"miter","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":1,"line":1,"line-center":1},"default":"point","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":1,"viewport-y":1,"source":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-z-elevate":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":1,"width":1,"height":1,"both":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":1,"left":1,"center":1,"right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","default":0,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":1,"vertical":1},"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":1,"uppercase":1,"lowercase":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":1,"!=":1,">":1,">=":1,"<":1,"<=":1,"in":1,"!in":1,"all":1,"any":1,"none":1,"has":1,"!has":1}},"geometry_type":{"type":"enum","values":{"Point":1,"LineString":1,"Polygon":1}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":1,"exponential":1,"interval":1,"categorical":1},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":1,"lab":1,"hcl":1},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vertical-range":{"type":"array","default":[0,0],"minimum":0,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}}},"camera":{"camera-projection":{"type":"enum","values":{"perspective":1,"orthographic":1},"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"default":"perspective","property-type":"data-constant"}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"property-type":"data-constant","expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":1,"equalEarth":1,"equirectangular":1,"lambertConformalConic":1,"mercator":1,"naturalEarth":1,"winkelTripel":1,"globe":1},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky","paint_model"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","private":true,"default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","private":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-wall-radius":{"property-type":"data-constant","type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-radius":{"property-type":"data-constant","type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-attenuation":{"property-type":"data-constant","type":"number","default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-flood-light-color":{"property-type":"data-constant","type":"color","default":"#ffffff","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-intensity":{"property-type":"data-constant","type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-wall-radius":{"property-type":"data-driven","type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-radius":{"property-type":"data-driven","type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-attenuation":{"property-type":"data-constant","type":"number","default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-vertical-scale":{"property-type":"data-constant","type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-rounded-roof":{"property-type":"data-constant","type":"boolean","default":true,"expression":{"parameters":["zoom"]}},"fill-extrusion-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"property-type":"constant"},"line-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-border-width":{"type":"number","private":true,"default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-border-color":{"type":"color","private":true,"default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-driven"},"text-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-image-cross-fade":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"transition":true},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-color":{"type":"color","expression":{"interpolated":true,"parameters":["raster-value"]},"property-type":"color-ramp"},"raster-color-mix":{"type":"array","default":[0.2126,0.7152,0.0722,0],"length":4,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-color-range":{"type":"array","default":[0,1],"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":1,"nearest":1},"default":"linear","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_background":{"background-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":1,"atmosphere":1},"default":"atmosphere","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","default":10,"minimum":0,"maximum":100,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","value":"number","default":[0,0],"length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","default":90,"minimum":0,"maximum":180,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_model":{"model-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"model-rotation":{"type":"array","value":"number","length":3,"default":[0,0,0],"period":360,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-scale":{"type":"array","value":"number","length":3,"default":[1,1,1],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-translation":{"type":"array","value":"number","length":3,"default":[0,0,0],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-color":{"type":"color","default":"#ffffff","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light","zoom"]},"transition":true},"model-color-mix-intensity":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-type":{"type":"enum","values":{"common-3d":1,"location-indicator":1},"default":"common-3d","property-type":"data-constant"},"model-cast-shadows":{"type":"boolean","default":true,"expression":{},"property-type":"data-constant"},"model-receive-shadows":{"type":"boolean","default":true,"expression":{},"property-type":"data-constant"},"model-ambient-occlusion-intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant","transition":true},"model-emissive-strength":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":5,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-roughness":{"type":"number","default":1,"minimum":0,"maximum":1,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state"]},"transition":true},"model-height-based-emissive-strength-multiplier":{"type":"array","default":[1,1,1,1,0],"length":5,"value":"number","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"}},"transition":{"duration":{"type":"number","default":300,"minimum":0},"delay":{"type":"number","default":0,"minimum":0}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');class nr{constructor(e,i,o,l){this.message=(e?`${e}: `:"")+o,l&&(this.identifier=l),i!=null&&i.__line__&&(this.line=i.__line__)}}class Kt extends nr{}function Nr(r,...e){for(const i of e)for(const o in i)r[o]=i[o];return r}function Sn(r){return r instanceof Number||r instanceof String||r instanceof Boolean?r.valueOf():r}function aa(r){if(Array.isArray(r))return r.map(aa);if(r instanceof Object&&!(r instanceof Number||r instanceof String||r instanceof Boolean)){const e={};for(const i in r)e[i]=aa(r[i]);return e}return Sn(r)}class Da extends Error{constructor(e,i){super(i),this.message=i,this.key=e}}var vs=Da;class Fm{constructor(e,i=[]){this.parent=e,this.bindings={};for(const[o,l]of i)this.bindings[o]=l}concat(e){return new Fm(this,e)}get(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(`${e} not found in scope.`)}has(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)}}var ua=Fm;const mu={kind:"null"},pr={kind:"number"},vn={kind:"string"},jn={kind:"boolean"},Jo={kind:"color"},gu={kind:"object"},Dn={kind:"value"},Nh={kind:"collator"},df={kind:"formatted"},Uh={kind:"resolvedImage"};function Io(r,e){return{kind:"array",itemType:r,N:e}}function ga(r){if(r.kind==="array"){const e=ga(r.itemType);return typeof r.N=="number"?`array<${e}, ${r.N}>`:r.itemType.kind==="value"?"array":`array<${e}>`}return r.kind}const Ov=[mu,pr,vn,jn,Jo,df,gu,Io(Dn),Uh];function pf(r,e){if(e.kind==="error")return null;if(r.kind==="array"){if(e.kind==="array"&&(e.N===0&&e.itemType.kind==="value"||!pf(r.itemType,e.itemType))&&(typeof r.N!="number"||r.N===e.N))return null}else{if(r.kind===e.kind)return null;if(r.kind==="value"){for(const i of Ov)if(!pf(i,e))return null}}return`Expected ${ga(r)} but found ${ga(e)} instead.`}function _p(r,e){return e.some(i=>i.kind===r.kind)}function $h(r,e){return e.some(i=>i==="null"?r===null:i==="array"?Array.isArray(r):i==="object"?r&&!Array.isArray(r)&&typeof r=="object":i===typeof r)}var Pm,Vh={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function mf(r){return(r=Math.round(r))<0?0:r>255?255:r}function vp(r){return mf(r[r.length-1]==="%"?parseFloat(r)/100*255:parseInt(r))}function Qo(r){return(e=r[r.length-1]==="%"?parseFloat(r)/100:parseFloat(r))<0?0:e>1?1:e;var e}function yp(r,e,i){return i<0?i+=1:i>1&&(i-=1),6*i<1?r+(e-r)*i*6:2*i<1?e:3*i<2?r+(e-r)*(2/3-i)*6:r}try{Pm={}.parseCSSColor=function(r){var e,i=r.replace(/ /g,"").toLowerCase();if(i in Vh)return Vh[i].slice();if(i[0]==="#")return i.length===4?(e=parseInt(i.substr(1),16))>=0&&e<=4095?[(3840&e)>>4|(3840&e)>>8,240&e|(240&e)>>4,15&e|(15&e)<<4,1]:null:i.length===7&&(e=parseInt(i.substr(1),16))>=0&&e<=16777215?[(16711680&e)>>16,(65280&e)>>8,255&e,1]:null;var o=i.indexOf("("),l=i.indexOf(")");if(o!==-1&&l+1===i.length){var u=i.substr(0,o),h=i.substr(o+1,l-(o+1)).split(","),m=1;switch(u){case"rgba":if(h.length!==4)return null;m=Qo(h.pop());case"rgb":return h.length!==3?null:[vp(h[0]),vp(h[1]),vp(h[2]),m];case"hsla":if(h.length!==4)return null;m=Qo(h.pop());case"hsl":if(h.length!==3)return null;var _=(parseFloat(h[0])%360+360)%360/360,v=Qo(h[1]),x=Qo(h[2]),w=x<=.5?x*(v+1):x+v-x*v,C=2*x-w;return[mf(255*yp(C,w,_+1/3)),mf(255*yp(C,w,_)),mf(255*yp(C,w,_-1/3)),m];default:return null}}return null}}catch{}class wo{constructor(e,i,o,l=1){this.r=e,this.g=i,this.b=o,this.a=l}static parse(e){if(!e)return;if(e instanceof wo)return e;if(typeof e!="string")return;const i=Pm(e);return i?new wo(i[0]/255*i[3],i[1]/255*i[3],i[2]/255*i[3],i[3]):void 0}toString(){const[e,i,o,l]=this.toArray();return`rgba(${Math.round(e)},${Math.round(i)},${Math.round(o)},${l})`}toArray(){const{r:e,g:i,b:o,a:l}=this;return l===0?[0,0,0,0]:[255*e/l,255*i/l,255*o/l,l]}toArray01(){const{r:e,g:i,b:o,a:l}=this;return l===0?[0,0,0,0]:[e/l,i/l,o/l,l]}toArray01Scaled(e){const{r:i,g:o,b:l,a:u}=this;return u===0?[0,0,0]:[i/u*e,o/u*e,l/u*e]}toArray01PremultipliedAlpha(){const{r:e,g:i,b:o,a:l}=this;return[e,i,o,l]}toArray01Linear(){const{r:e,g:i,b:o,a:l}=this;return l===0?[0,0,0,0]:[Math.pow(e/l,2.2),Math.pow(i/l,2.2),Math.pow(o/l,2.2),l]}}wo.black=new wo(0,0,0,1),wo.white=new wo(1,1,1,1),wo.transparent=new wo(0,0,0,0),wo.red=new wo(1,0,0,1),wo.blue=new wo(0,0,1,1);var hn=wo;class xp{constructor(e,i,o){this.sensitivity=e?i?"variant":"case":i?"accent":"base",this.locale=o,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(e,i){return this.collator.compare(e,i)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class gf{constructor(e,i,o,l,u){this.text=e.normalize?e.normalize():e,this.image=i,this.scale=o,this.fontStack=l,this.textColor=u}}class Eo{constructor(e){this.sections=e}static fromString(e){return new Eo([new gf(e,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(e=>e.text.length!==0||e.image&&e.image.namePrimary.length!==0)}static factory(e){return e instanceof Eo?e:Eo.fromString(e)}toString(){return this.sections.length===0?"":this.sections.map(e=>e.text).join("")}serialize(){const e=["format"];for(const i of this.sections){if(i.image){e.push(["image",i.image.namePrimary]);continue}e.push(i.text);const o={};i.fontStack&&(o["text-font"]=["literal",i.fontStack.split(",")]),i.scale&&(o["font-scale"]=i.scale),i.textColor&&(o["text-color"]=["rgba"].concat(i.textColor.toArray())),e.push(o)}return e}}class es{constructor(e){this.namePrimary=e.namePrimary,e.nameSecondary&&(this.nameSecondary=e.nameSecondary),this.available=e.available}toString(){return this.nameSecondary?`[${this.namePrimary},${this.nameSecondary}]`:this.namePrimary}static fromString(e,i){return e?new es({namePrimary:e,nameSecondary:i,available:!1}):null}serialize(){return this.nameSecondary?["image",this.namePrimary,this.nameSecondary]:["image",this.namePrimary]}}function Rv(r,e,i,o){return typeof r=="number"&&r>=0&&r<=255&&typeof e=="number"&&e>=0&&e<=255&&typeof i=="number"&&i>=0&&i<=255?o===void 0||typeof o=="number"&&o>=0&&o<=1?null:`Invalid rgba value [${[r,e,i,o].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof o=="number"?[r,e,i,o]:[r,e,i]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function ys(r){if(r===null||typeof r=="string"||typeof r=="boolean"||typeof r=="number"||r instanceof hn||r instanceof xp||r instanceof Eo||r instanceof es)return!0;if(Array.isArray(r)){for(const e of r)if(!ys(e))return!1;return!0}if(typeof r=="object"){for(const e in r)if(!ys(r[e]))return!1;return!0}return!1}function Aa(r){if(r===null)return mu;if(typeof r=="string")return vn;if(typeof r=="boolean")return jn;if(typeof r=="number")return pr;if(r instanceof hn)return Jo;if(r instanceof xp)return Nh;if(r instanceof Eo)return df;if(r instanceof es)return Uh;if(Array.isArray(r)){const e=r.length;let i;for(const o of r){const l=Aa(o);if(i){if(i===l)continue;i=Dn;break}i=l}return Io(i||Dn,e)}return gu}function jh(r){const e=typeof r;return r===null?"":e==="string"||e==="number"||e==="boolean"?String(r):r instanceof hn||r instanceof Eo||r instanceof es?r.toString():JSON.stringify(r)}class Om{constructor(e,i){this.type=e,this.value=i}static parse(e,i){if(e.length!==2)return i.error(`'literal' expression requires exactly one argument, but found ${e.length-1} instead.`);if(!ys(e[1]))return i.error("invalid value");const o=e[1];let l=Aa(o);const u=i.expectedType;return l.kind!=="array"||l.N!==0||!u||u.kind!=="array"||typeof u.N=="number"&&u.N!==0||(l=u),new Om(l,o)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof hn?["rgba"].concat(this.value.toArray()):this.value instanceof Eo?this.value.serialize():this.value}}var _u=Om,_a=class{constructor(r){this.name="ExpressionEvaluationError",this.message=r}toJSON(){return this.message}};const Wh={string:vn,number:pr,boolean:jn,object:gu};class Hh{constructor(e,i){this.type=e,this.args=i}static parse(e,i){if(e.length<2)return i.error("Expected at least one argument.");let o,l=1;const u=e[0];if(u==="array"){let m,_;if(e.length>2){const v=e[1];if(typeof v!="string"||!(v in Wh)||v==="object")return i.error('The item type argument of "array" must be one of string, number, boolean',1);m=Wh[v],l++}else m=Dn;if(e.length>3){if(e[2]!==null&&(typeof e[2]!="number"||e[2]<0||e[2]!==Math.floor(e[2])))return i.error('The length argument to "array" must be a positive integer literal',2);_=e[2],l++}o=Io(m,_)}else o=Wh[u];const h=[];for(;l<e.length;l++){const m=i.parse(e[l],l,Dn);if(!m)return null;h.push(m)}return new Hh(o,h)}evaluate(e){for(let i=0;i<this.args.length;i++){const o=this.args[i].evaluate(e);if(!pf(this.type,Aa(o)))return o;if(i===this.args.length-1)throw new _a(`Expected value to be of type ${ga(this.type)}, but found ${ga(Aa(o))} instead.`)}return null}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){const e=this.type,i=[e.kind];if(e.kind==="array"){const o=e.itemType;if(o.kind==="string"||o.kind==="number"||o.kind==="boolean"){i.push(o.kind);const l=e.N;(typeof l=="number"||this.args.length>1)&&i.push(l)}}return i.concat(this.args.map(o=>o.serialize()))}}var Ws=Hh;class Ul{constructor(e){this.type=df,this.sections=e}static parse(e,i){if(e.length<2)return i.error("Expected at least one argument.");const o=e[1];if(!Array.isArray(o)&&typeof o=="object")return i.error("First argument must be an image or text section.");const l=[];let u=!1;for(let h=1;h<=e.length-1;++h){const m=e[h];if(u&&typeof m=="object"&&!Array.isArray(m)){u=!1;let _=null;if(m["font-scale"]&&(_=i.parse(m["font-scale"],1,pr),!_))return null;let v=null;if(m["text-font"]&&(v=i.parse(m["text-font"],1,Io(vn)),!v))return null;let x=null;if(m["text-color"]&&(x=i.parse(m["text-color"],1,Jo),!x))return null;const w=l[l.length-1];w.scale=_,w.font=v,w.textColor=x}else{const _=i.parse(e[h],1,Dn);if(!_)return null;const v=_.type.kind;if(v!=="string"&&v!=="value"&&v!=="null"&&v!=="resolvedImage")return i.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");u=!0,l.push({content:_,scale:null,font:null,textColor:null})}}return new Ul(l)}evaluate(e){return new Eo(this.sections.map(i=>{const o=i.content.evaluate(e);return Aa(o)===Uh?new gf("",o,null,null,null):new gf(jh(o),null,i.scale?i.scale.evaluate(e):null,i.font?i.font.evaluate(e).join(","):null,i.textColor?i.textColor.evaluate(e):null)}))}eachChild(e){for(const i of this.sections)e(i.content),i.scale&&e(i.scale),i.font&&e(i.font),i.textColor&&e(i.textColor)}outputDefined(){return!1}serialize(){const e=["format"];for(const i of this.sections){e.push(i.content.serialize());const o={};i.scale&&(o["font-scale"]=i.scale.serialize()),i.font&&(o["text-font"]=i.font.serialize()),i.textColor&&(o["text-color"]=i.textColor.serialize()),e.push(o)}return e}}class Gh{constructor(e,i){this.type=Uh,this.inputPrimary=e,this.inputSecondary=i}static parse(e,i){if(e.length<2)return i.error("Expected two or more arguments.");const o=i.parse(e[1],1,vn);if(!o)return i.error("No image name provided.");if(e.length===2)return new Gh(o);const l=i.parse(e[2],1,vn);return l?new Gh(o,l):i.error("Secondary image variant is not a string.")}evaluate(e){const i=es.fromString(this.inputPrimary.evaluate(e),this.inputSecondary?this.inputSecondary.evaluate(e):void 0);return i&&e.availableImages&&(i.available=e.availableImages.indexOf(i.namePrimary)>-1,i.nameSecondary&&i.available&&e.availableImages&&(i.available=e.availableImages.indexOf(i.nameSecondary)>-1)),i}eachChild(e){e(this.inputPrimary),this.inputSecondary&&e(this.inputSecondary)}outputDefined(){return!1}serialize(){return this.inputSecondary?["image",this.inputPrimary.serialize(),this.inputSecondary.serialize()]:["image",this.inputPrimary.serialize()]}}function ei(r){return r instanceof Number?"number":r instanceof String?"string":r instanceof Boolean?"boolean":Array.isArray(r)?"array":r===null?"null":typeof r}const Ow={"to-boolean":jn,"to-color":Jo,"to-number":pr,"to-string":vn};class Rm{constructor(e,i){this.type=e,this.args=i}static parse(e,i){if(e.length<2)return i.error("Expected at least one argument.");const o=e[0],l=[];let u=mu;if(o==="to-array"){if(!Array.isArray(e[1]))return null;const h=e[1].length;if(i.expectedType){if(i.expectedType.kind!=="array")return i.error(`Expected ${i.expectedType.kind} but found array.`);u=Io(i.expectedType.itemType,h)}else{if(!(h>0&&ys(e[1][0])))return null;u=Io(Aa(e[1][0]),h)}for(let m=0;m<h;m++){const _=e[1][m];let v;if(ei(_)==="array")v=i.parse(_,void 0,u.itemType);else{const x=ei(_);if(x!==u.itemType.kind)return i.error(`Expected ${u.itemType.kind} but found ${x}.`);v=i.registry.literal.parse(["literal",_===void 0?null:_],i)}if(!v)return null;l.push(v)}}else{if((o==="to-boolean"||o==="to-string")&&e.length!==2)return i.error("Expected one argument.");u=Ow[o];for(let h=1;h<e.length;h++){const m=i.parse(e[h],h,Dn);if(!m)return null;l.push(m)}}return new Rm(u,l)}evaluate(e){if(this.type.kind==="boolean")return!!this.args[0].evaluate(e);if(this.type.kind==="color"){let i,o;for(const l of this.args){if(i=l.evaluate(e),o=null,i instanceof hn)return i;if(typeof i=="string"){const u=e.parseColor(i);if(u)return u}else if(Array.isArray(i)&&(o=i.length<3||i.length>4?`Invalid rbga value ${JSON.stringify(i)}: expected an array containing either three or four numeric values.`:Rv(i[0],i[1],i[2],i[3]),!o))return new hn(i[0]/255,i[1]/255,i[2]/255,i[3])}throw new _a(o||`Could not parse color from value '${typeof i=="string"?i:String(JSON.stringify(i))}'`)}if(this.type.kind==="number"){let i=null;for(const o of this.args){if(i=o.evaluate(e),i===null)return 0;const l=Number(i);if(!isNaN(l))return l}throw new _a(`Could not convert ${JSON.stringify(i)} to number.`)}return this.type.kind==="formatted"?Eo.fromString(jh(this.args[0].evaluate(e))):this.type.kind==="resolvedImage"?es.fromString(jh(this.args[0].evaluate(e))):this.type.kind==="array"?this.args.map(i=>i.evaluate(e)):jh(this.args[0].evaluate(e))}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){if(this.type.kind==="formatted")return new Ul([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new Gh(this.args[0]).serialize();const e=this.type.kind==="array"?[]:[`to-${this.type.kind}`];return this.eachChild(i=>{e.push(i.serialize())}),e}}var vu=Rm;const Lv=["Unknown","Point","LineString","Polygon"];var bp=class{constructor(r){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null,this.options=r}id(){return this.feature&&this.feature.id!==void 0?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Lv[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}measureLight(r){return this.globals.brightness||0}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const r=this.featureDistanceData.center,e=this.featureDistanceData.scale,{x:i,y:o}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(i*e-r[0])+this.featureDistanceData.bearing[1]*(o*e-r[1])}return 0}parseColor(r){let e=this._parseColorCache[r];return e||(e=this._parseColorCache[r]=hn.parse(r)),e}getConfig(r){return this.options?this.options.get(r):null}};class xs{constructor(e,i,o,l){this.name=e,this.type=i,this._evaluate=o,this.args=l}evaluate(e){return this._evaluate(e,this.args)}eachChild(e){this.args.forEach(e)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(e=>e.serialize()))}static parse(e,i){const o=e[0],l=xs.definitions[o];if(!l)return i.error(`Unknown expression "${o}". If you wanted a literal array, use ["literal", [...]].`,0);const u=Array.isArray(l)?l[0]:l.type,h=Array.isArray(l)?[[l[1],l[2]]]:l.overloads,m=h.filter(([v])=>!Array.isArray(v)||v.length===e.length-1);let _=null;for(const[v,x]of m){_=new Ip(i.registry,i.path,null,i.scope,void 0,i.options);const w=[];let C=!1;for(let k=1;k<e.length;k++){const P=e[k],R=Array.isArray(v)?v[k-1]:v.type,z=_.parse(P,1+w.length,R);if(!z){C=!0;break}w.push(z)}if(!C)if(Array.isArray(v)&&v.length!==w.length)_.error(`Expected ${v.length} arguments, but found ${w.length} instead.`);else{for(let k=0;k<w.length;k++){const P=Array.isArray(v)?v[k]:v.type,R=w[k];_.concat(k+1).checkSubtype(P,R.type)}if(_.errors.length===0)return new xs(o,u,x,w)}}if(m.length===1)i.errors.push(..._.errors);else{const v=(m.length?m:h).map(([w])=>{return C=w,Array.isArray(C)?`(${C.map(ga).join(", ")})`:`(${ga(C.type)}...)`;var C}).join(" | "),x=[];for(let w=1;w<e.length;w++){const C=i.parse(e[w],1+x.length);if(!C)return null;x.push(ga(C.type))}i.error(`Expected arguments of type ${v}, but found (${x.join(", ")}) instead.`)}return null}static register(e,i){xs.definitions=i;for(const o in i)e[o]=xs}}var Ga=xs;class ul{constructor(e,i,o){this.type=Nh,this.locale=o,this.caseSensitive=e,this.diacriticSensitive=i}static parse(e,i){if(e.length!==2)return i.error("Expected one argument.");const o=e[1];if(typeof o!="object"||Array.isArray(o))return i.error("Collator options argument must be an object.");const l=i.parse(o["case-sensitive"]!==void 0&&o["case-sensitive"],1,jn);if(!l)return null;const u=i.parse(o["diacritic-sensitive"]!==void 0&&o["diacritic-sensitive"],1,jn);if(!u)return null;let h=null;return o.locale&&(h=i.parse(o.locale,1,vn),!h)?null:new ul(l,u,h)}evaluate(e){return new xp(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)}eachChild(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)}outputDefined(){return!1}serialize(){const e={};return e["case-sensitive"]=this.caseSensitive.serialize(),e["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(e.locale=this.locale.serialize()),["collator",e]}}var qh={exports:{}};qh.exports=function(){function r(o,l,u,h,m){for(;h>u;){if(h-u>600){var _=h-u+1,v=l-u+1,x=Math.log(_),w=.5*Math.exp(2*x/3),C=.5*Math.sqrt(x*w*(_-w)/_)*(v-_/2<0?-1:1);r(o,l,Math.max(u,Math.floor(l-v*w/_+C)),Math.min(h,Math.floor(l+(_-v)*w/_+C)),m)}var k=o[l],P=u,R=h;for(e(o,u,l),m(o[h],k)>0&&e(o,u,h);P<R;){for(e(o,P,R),P++,R--;m(o[P],k)<0;)P++;for(;m(o[R],k)>0;)R--}m(o[u],k)===0?e(o,u,R):e(o,++R,h),R<=l&&(u=R+1),l<=R&&(h=R-1)}}function e(o,l,u){var h=o[l];o[l]=o[u],o[u]=h}function i(o,l){return o<l?-1:o>l?1:0}return function(o,l,u,h,m){r(o,l,u||0,h||o.length-1,m||i)}}();var Ac=O(qh.exports);function Rw(r){let e=0;for(let i,o,l=0,u=r.length,h=u-1;l<u;h=l++)i=r[l],o=r[h],e+=(o.x-i.x)*(i.y+o.y);return e}function kc(r,e){r[0]=Math.min(r[0],e[0]),r[1]=Math.min(r[1],e[1]),r[2]=Math.max(r[2],e[0]),r[3]=Math.max(r[3],e[1])}function $l(r,e){return!(r[0]<=e[0]||r[2]>=e[2]||r[1]<=e[1]||r[3]>=e[3])}function Dv(r,e,i){const o=r[0]-e[0],l=r[1]-e[1],u=r[0]-i[0],h=r[1]-i[1];return o*h-u*l==0&&o*u<=0&&l*h<=0}function yu(r,e,i=!1){let o=!1;for(let m=0,_=e.length;m<_;m++){const v=e[m];for(let x=0,w=v.length,C=w-1;x<w;C=x++){const k=v[C],P=v[x];if(Dv(r,k,P))return i;(u=k)[1]>(l=r)[1]!=(h=P)[1]>l[1]&&l[0]<(h[0]-u[0])*(l[1]-u[1])/(h[1]-u[1])+u[0]&&(o=!o)}}var l,u,h;return o}function Bv(r,e,i,o){const l=o[0]-i[0],u=o[1]-i[1],h=(r[0]-i[0])*u-l*(r[1]-i[1]),m=(e[0]-i[0])*u-l*(e[1]-i[1]);return h>0&&m<0||h<0&&m>0}function wp(r,e,i,o){return(l=[o[0]-i[0],o[1]-i[1]])[0]*(u=[e[0]-r[0],e[1]-r[1]])[1]-l[1]*u[0]!=0&&!(!Bv(r,e,i,o)||!Bv(i,o,r,e));var l,u}const Vl=8192;function zv(r,e){const i=(180+r[0])/360,o=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+r[1]*Math.PI/360)))/360,l=Math.pow(2,e.z);return[Math.round(i*l*Vl),Math.round(o*l*Vl)]}function Ep(r,e){for(let i=0;i<e.length;i++)if(yu(r,e[i]))return!0;return!1}function _f(r,e,i){for(const o of i)for(let l=0,u=o.length,h=u-1;l<u;h=l++)if(wp(r,e,o[h],o[l]))return!0;return!1}function Nv(r,e){for(let i=0;i<r.length;++i)if(!yu(r[i],e))return!1;for(let i=0;i<r.length-1;++i)if(_f(r[i],r[i+1],e))return!1;return!0}function Ic(r,e){for(let i=0;i<e.length;i++)if(Nv(r,e[i]))return!0;return!1}function Lm(r,e,i){const o=[];for(let l=0;l<r.length;l++){const u=[];for(let h=0;h<r[l].length;h++){const m=zv(r[l][h],i);kc(e,m),u.push(m)}o.push(u)}return o}function Mc(r,e,i){const o=[];for(let l=0;l<r.length;l++){const u=Lm(r[l],e,i);o.push(u)}return o}function Dm(r,e,i,o){if(r[0]<i[0]||r[0]>i[2]){const l=.5*o;let u=r[0]-i[0]>l?-o:i[0]-r[0]>l?o:0;u===0&&(u=r[0]-i[2]>l?-o:i[2]-r[0]>l?o:0),r[0]+=u}kc(e,r)}function Uv(r,e,i,o){const l=Math.pow(2,o.z)*Vl,u=[o.x*Vl,o.y*Vl],h=[];if(!r)return h;for(const m of r)for(const _ of m){const v=[_.x+u[0],_.y+u[1]];Dm(v,e,i,l),h.push(v)}return h}function Xh(r,e,i,o){const l=Math.pow(2,o.z)*Vl,u=[o.x*Vl,o.y*Vl],h=[];if(!r)return h;for(const _ of r){const v=[];for(const x of _){const w=[x.x+u[0],x.y+u[1]];kc(e,w),v.push(w)}h.push(v)}if(e[2]-e[0]<=l/2){(m=e)[0]=m[1]=1/0,m[2]=m[3]=-1/0;for(const _ of h)for(const v of _)Dm(v,e,i,l)}var m;return h}class xu{constructor(e,i){this.type=jn,this.geojson=e,this.geometries=i}static parse(e,i){if(e.length!==2)return i.error(`'within' expression requires exactly one argument, but found ${e.length-1} instead.`);if(ys(e[1])){const o=e[1];if(o.type==="FeatureCollection")for(let l=0;l<o.features.length;++l){const u=o.features[l].geometry.type;if(u==="Polygon"||u==="MultiPolygon")return new xu(o,o.features[l].geometry)}else if(o.type==="Feature"){const l=o.geometry.type;if(l==="Polygon"||l==="MultiPolygon")return new xu(o,o.geometry)}else if(o.type==="Polygon"||o.type==="MultiPolygon")return new xu(o,o)}return i.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return function(i,o){const l=[1/0,1/0,-1/0,-1/0],u=[1/0,1/0,-1/0,-1/0],h=i.canonicalID();if(!h)return!1;if(o.type==="Polygon"){const m=Lm(o.coordinates,u,h),_=Uv(i.geometry(),l,u,h);if(!$l(l,u))return!1;for(const v of _)if(!yu(v,m))return!1}if(o.type==="MultiPolygon"){const m=Mc(o.coordinates,u,h),_=Uv(i.geometry(),l,u,h);if(!$l(l,u))return!1;for(const v of _)if(!Ep(v,m))return!1}return!0}(e,this.geometries);if(e.geometryType()==="LineString")return function(i,o){const l=[1/0,1/0,-1/0,-1/0],u=[1/0,1/0,-1/0,-1/0],h=i.canonicalID();if(!h)return!1;if(o.type==="Polygon"){const m=Lm(o.coordinates,u,h),_=Xh(i.geometry(),l,u,h);if(!$l(l,u))return!1;for(const v of _)if(!Nv(v,m))return!1}if(o.type==="MultiPolygon"){const m=Mc(o.coordinates,u,h),_=Xh(i.geometry(),l,u,h);if(!$l(l,u))return!1;for(const v of _)if(!Ic(v,m))return!1}return!0}(e,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}var Tp=xu,Bm={exports:{}};Bm.exports=function(){var r={kilometers:1,miles:.621371192237334,nauticalmiles:.5399568034557235,meters:1e3,metres:1e3,yards:1093.6132983377079,feet:3280.839895013123,inches:39370.078740157485},e=1/298.257223563,i=e*(2-e),o=Math.PI/180,l=function(v,x){if(v===void 0)throw new Error("No latitude given.");if(x&&!r[x])throw new Error("Unknown unit "+x+". Use one of: "+Object.keys(r).join(", "));var w=6378.137*o*(x?r[x]:1),C=Math.cos(v*o),k=1/(1-i*(1-C*C)),P=Math.sqrt(k);this.kx=w*P*C,this.ky=w*P*k*(1-i)},u={units:{configurable:!0}};function h(v,x){return v[0]===x[0]&&v[1]===x[1]}function m(v,x,w){var C=_(x[0]-v[0]);return[v[0]+C*w,v[1]+(x[1]-v[1])*w]}function _(v){for(;v<-180;)v+=360;for(;v>180;)v-=360;return v}return l.fromTile=function(v,x,w){var C=Math.PI*(1-2*(v+.5)/Math.pow(2,x)),k=Math.atan(.5*(Math.exp(C)-Math.exp(-C)))/o;return new l(k,w)},u.units.get=function(){return r},l.prototype.distance=function(v,x){var w=_(v[0]-x[0])*this.kx,C=(v[1]-x[1])*this.ky;return Math.sqrt(w*w+C*C)},l.prototype.bearing=function(v,x){var w=_(x[0]-v[0])*this.kx;return Math.atan2(w,(x[1]-v[1])*this.ky)/o},l.prototype.destination=function(v,x,w){var C=w*o;return this.offset(v,Math.sin(C)*x,Math.cos(C)*x)},l.prototype.offset=function(v,x,w){return[v[0]+x/this.kx,v[1]+w/this.ky]},l.prototype.lineDistance=function(v){for(var x=0,w=0;w<v.length-1;w++)x+=this.distance(v[w],v[w+1]);return x},l.prototype.area=function(v){for(var x=0,w=0;w<v.length;w++)for(var C=v[w],k=0,P=C.length,R=P-1;k<P;R=k++)x+=_(C[k][0]-C[R][0])*(C[k][1]+C[R][1])*(w?-1:1);return Math.abs(x)/2*this.kx*this.ky},l.prototype.along=function(v,x){var w=0;if(x<=0)return v[0];for(var C=0;C<v.length-1;C++){var k=v[C],P=v[C+1],R=this.distance(k,P);if((w+=R)>x)return m(k,P,(x-(w-R))/R)}return v[v.length-1]},l.prototype.pointToSegmentDistance=function(v,x,w){var C=x[0],k=x[1],P=_(w[0]-C)*this.kx,R=(w[1]-k)*this.ky,z=0;return P===0&&R===0||((z=(_(v[0]-C)*this.kx*P+(v[1]-k)*this.ky*R)/(P*P+R*R))>1?(C=w[0],k=w[1]):z>0&&(C+=P/this.kx*z,k+=R/this.ky*z)),P=_(v[0]-C)*this.kx,R=(v[1]-k)*this.ky,Math.sqrt(P*P+R*R)},l.prototype.pointOnLine=function(v,x){for(var w,C,k,P,R=1/0,z=0;z<v.length-1;z++){var B=v[z][0],H=v[z][1],Z=_(v[z+1][0]-B)*this.kx,Y=(v[z+1][1]-H)*this.ky,q=0;Z===0&&Y===0||((q=(_(x[0]-B)*this.kx*Z+(x[1]-H)*this.ky*Y)/(Z*Z+Y*Y))>1?(B=v[z+1][0],H=v[z+1][1]):q>0&&(B+=Z/this.kx*q,H+=Y/this.ky*q));var ee=(Z=_(x[0]-B)*this.kx)*Z+(Y=(x[1]-H)*this.ky)*Y;ee<R&&(R=ee,w=B,C=H,k=z,P=q)}return{point:[w,C],index:k,t:Math.max(0,Math.min(1,P))}},l.prototype.lineSlice=function(v,x,w){var C=this.pointOnLine(w,v),k=this.pointOnLine(w,x);if(C.index>k.index||C.index===k.index&&C.t>k.t){var P=C;C=k,k=P}var R=[C.point],z=C.index+1,B=k.index;!h(w[z],R[0])&&z<=B&&R.push(w[z]);for(var H=z+1;H<=B;H++)R.push(w[H]);return h(w[B],k.point)||R.push(k.point),R},l.prototype.lineSliceAlong=function(v,x,w){for(var C=0,k=[],P=0;P<w.length-1;P++){var R=w[P],z=w[P+1],B=this.distance(R,z);if((C+=B)>v&&k.length===0&&k.push(m(R,z,(v-(C-B))/B)),C>=x)return k.push(m(R,z,(x-(C-B))/B)),k;C>v&&k.push(z)}return k},l.prototype.bufferPoint=function(v,x){var w=x/this.ky,C=x/this.kx;return[v[0]-C,v[1]-w,v[0]+C,v[1]+w]},l.prototype.bufferBBox=function(v,x){var w=x/this.ky,C=x/this.kx;return[v[0]-C,v[1]-w,v[2]+C,v[3]+w]},l.prototype.insideBBox=function(v,x){return _(v[0]-x[0])>=0&&_(v[0]-x[2])<=0&&v[1]>=x[1]&&v[1]<=x[3]},Object.defineProperties(l,u),l}();var Sp=O(Bm.exports),vf={exports:{}};vf.exports=function(){var r=function(i,o){if(i===void 0&&(i=[]),o===void 0&&(o=e),this.data=i,this.length=this.data.length,this.compare=o,this.length>0)for(var l=(this.length>>1)-1;l>=0;l--)this._down(l)};function e(i,o){return i<o?-1:i>o?1:0}return r.prototype.push=function(i){this.data.push(i),this.length++,this._up(this.length-1)},r.prototype.pop=function(){if(this.length!==0){var i=this.data[0],o=this.data.pop();return this.length--,this.length>0&&(this.data[0]=o,this._down(0)),i}},r.prototype.peek=function(){return this.data[0]},r.prototype._up=function(i){for(var o=this.data,l=this.compare,u=o[i];i>0;){var h=i-1>>1,m=o[h];if(l(u,m)>=0)break;o[i]=m,i=h}o[i]=u},r.prototype._down=function(i){for(var o=this.data,l=this.compare,u=this.length>>1,h=o[i];i<u;){var m=1+(i<<1),_=o[m],v=m+1;if(v<this.length&&l(o[v],_)<0&&(m=v,_=o[v]),l(_,h)>=0)break;o[i]=_,i=m}o[i]=h},r}();var Cp=O(vf.exports),Et=8192;function Ct(r,e){return e.dist-r.dist}const Vt=100,kr=50;function nn(r){const e=[1/0,1/0,-1/0,-1/0];if(e.length!==r.length)return!1;for(let i=0;i<e.length;i++)if(e[i]!==r[i])return!1;return!0}function Hi(r){return r[1]-r[0]+1}function zn(r,e){const i=r[1]>=r[0]&&r[1]<e;return i||console.warn("Distance Expression: Index is out of range"),i}function va(r,e){if(r[0]>r[1])return[null,null];const i=Hi(r);if(e){if(i===2)return[r,null];const o=Math.floor(i/2);return[[r[0],r[0]+o],[r[0]+o,r[1]]]}{if(i===1)return[r,null];const o=Math.floor(i/2)-1;return[[r[0],r[0]+o],[r[0]+o+1,r[1]]]}}function oa(r,e){const i=[1/0,1/0,-1/0,-1/0];if(!zn(e,r.length))return i;for(let o=e[0];o<=e[1];++o)kc(i,r[o]);return i}function Mo(r){const e=[1/0,1/0,-1/0,-1/0];for(let i=0;i<r.length;++i)for(let o=0;o<r[i].length;++o)kc(e,r[i][o]);return e}function ya(r,e,i){if(nn(r)||nn(e))return NaN;let o=0,l=0;return r[2]<e[0]&&(o=e[0]-r[2]),r[0]>e[2]&&(o=r[0]-e[2]),r[1]>e[3]&&(l=r[1]-e[3]),r[3]<e[1]&&(l=e[1]-r[3]),i.distance([0,0],[o,l])}function Pa(r,e){const i=Math.pow(2,e.z);return[(l=(r.x/Et+e.x)/i,360*l-180),(o=(r.y/Et+e.y)/i,360/Math.PI*Math.atan(Math.exp((180-360*o)*Math.PI/180))-90)];var o,l}function fl(r,e){const i=[];for(let o=0;o<r.length;++o)i.push(Pa(r[o],e));return i}function hl(r,e,i){const o=i.pointOnLine(e,r).point;return i.distance(r,o)}function mo(r,e,i,o,l){const u=i.slice(o[0],o[1]+1);let h=1/0;for(let m=e[0];m<=e[1];++m)if((h=Math.min(h,hl(r[m],u,l)))===0)return 0;return h}function Hs(r,e,i,o,l){const u=Math.min(l.pointToSegmentDistance(r,i,o),l.pointToSegmentDistance(e,i,o)),h=Math.min(l.pointToSegmentDistance(i,r,e),l.pointToSegmentDistance(o,r,e));return Math.min(u,h)}function yf(r,e,i,o,l){if(!zn(e,r.length)||!zn(o,i.length))return NaN;let u=1/0;for(let h=e[0];h<e[1];++h)for(let m=o[0];m<o[1];++m){if(wp(r[h],r[h+1],i[m],i[m+1]))return 0;u=Math.min(u,Hs(r[h],r[h+1],i[m],i[m+1],l))}return u}function Ap(r,e,i,o,l){if(!zn(e,r.length)||!zn(o,i.length))return NaN;let u=1/0;for(let h=e[0];h<=e[1];++h)for(let m=o[0];m<=o[1];++m)if((u=Math.min(u,l.distance(r[h],i[m])))===0)return u;return u}function xf(r,e,i){if(yu(r,e,!0))return 0;let o=1/0;for(const l of e){const u=l.length;if(u<2)return console.warn("Distance Expression: Invalid polygon!"),NaN;if(l[0]!==l[u-1]&&(o=Math.min(o,i.pointToSegmentDistance(r,l[u-1],l[0])))===0||(o=Math.min(o,hl(r,l,i)))===0)return o}return o}function Zh(r,e,i,o){if(!zn(e,r.length))return NaN;for(let u=e[0];u<=e[1];++u)if(yu(r[u],i,!0))return 0;let l=1/0;for(let u=e[0];u<e[1];++u)for(const h of i)for(let m=0,_=h.length,v=_-1;m<_;v=m++){if(wp(r[u],r[u+1],h[v],h[m]))return 0;l=Math.min(l,Hs(r[u],r[u+1],h[v],h[m],o))}return l}function zm(r,e){for(const i of r)for(let o=0;o<=i.length-1;++o)if(yu(i[o],e,!0))return!0;return!1}function Lw(r,e,i,o=1/0){const l=Mo(r),u=Mo(e);if(o!==1/0&&ya(l,u,i)>=o)return o;if($l(l,u)){if(zm(r,e))return 0}else if(zm(e,r))return 0;let h=o;for(const m of r)for(let _=0,v=m.length,x=v-1;_<v;x=_++)for(const w of e)for(let C=0,k=w.length,P=k-1;C<k;P=C++){if(wp(m[x],m[_],w[P],w[C]))return 0;h=Math.min(h,Hs(m[x],m[_],w[P],w[C],i))}return h}function kp(r,e,i,o,l,u,h){if(u===null||h===null)return;const m=ya(oa(o,u),oa(l,h),i);m<e&&r.push({dist:m,range1:u,range2:h})}function ea(r,e,i,o,l=1/0){let u=Math.min(o.distance(r[0],i[0][0]),l);if(u===0)return u;const h=new Cp([{dist:0,range1:[0,r.length-1],range2:[0,0]}],Ct),m=e?kr:Vt,_=Mo(i);for(;h.length;){const v=h.pop();if(v.dist>=u)continue;const x=v.range1;if(Hi(x)<=m){if(!zn(x,r.length))return NaN;if(e){const w=Zh(r,x,i,o);if((u=Math.min(u,w))===0)return u}else for(let w=x[0];w<=x[1];++w){const C=xf(r[w],i,o);if((u=Math.min(u,C))===0)return u}}else{const w=va(x,e);if(w[0]!==null){const C=ya(oa(r,w[0]),_,o);C<u&&h.push({dist:C,range1:w[0],range2:[0,0]})}if(w[1]!==null){const C=ya(oa(r,w[1]),_,o);C<u&&h.push({dist:C,range1:w[1],range2:[0,0]})}}}return u}function Pi(r,e,i,o,l,u=1/0){let h=Math.min(u,l.distance(r[0],i[0]));if(h===0)return h;const m=new Cp([{dist:0,range1:[0,r.length-1],range2:[0,i.length-1]}],Ct),_=e?kr:Vt,v=o?kr:Vt;for(;m.length;){const x=m.pop();if(x.dist>=h)continue;const w=x.range1,C=x.range2;if(Hi(w)<=_&&Hi(C)<=v){if(!zn(w,r.length)||!zn(C,i.length))return NaN;if(e&&o?h=Math.min(h,yf(r,w,i,C,l)):e||o?e&&!o?h=Math.min(h,mo(i,C,r,w,l)):!e&&o&&(h=Math.min(h,mo(r,w,i,C,l))):h=Math.min(h,Ap(r,w,i,C,l)),h===0)return h}else{const k=va(w,e),P=va(C,o);kp(m,h,l,r,i,k[0],P[0]),kp(m,h,l,r,i,k[0],P[1]),kp(m,h,l,r,i,k[1],P[0]),kp(m,h,l,r,i,k[1],P[1])}}return h}function bf(r,e,i,o,l=1/0){let u=l;const h=oa(r,[0,r.length-1]);for(const m of i)if(!(u!==1/0&&ya(h,oa(m,[0,m.length-1]),o)>=u)&&(u=Math.min(u,Pi(r,e,m,!0,o,u)),u===0))return u;return u}function Gs(r,e,i,o,l=1/0){let u=l;const h=oa(r,[0,r.length-1]);for(const m of i){if(u!==1/0&&ya(h,Mo(m),o)>=u)continue;const _=ea(r,e,m,o,u);if(isNaN(_))return _;if((u=Math.min(u,_))===0)return u}return u}function Kh(r){return r==="Point"||r==="MultiPoint"||r==="LineString"||r==="MultiLineString"||r==="Polygon"||r==="MultiPolygon"}class go{constructor(e,i){this.type=pr,this.geojson=e,this.geometries=i}static parse(e,i){if(e.length!==2)return i.error(`'distance' expression requires either one argument, but found ' ${e.length-1} instead.`);if(ys(e[1])){const o=e[1];if(o.type==="FeatureCollection"){for(let l=0;l<o.features.length;++l)if(Kh(o.features[l].geometry.type))return new go(o,o.features[l].geometry)}else if(o.type==="Feature"){if(Kh(o.geometry.type))return new go(o,o.geometry)}else if(Kh(o.type))return new go(o,o)}return i.error("'distance' expression needs to be an array with format ['Distance', GeoJSONObj].")}evaluate(e){const i=e.geometry(),o=e.canonicalID();if(i!=null&&o!=null){if(e.geometryType()==="Point")return function(l,u,h){const m=[];for(const v of l)for(const x of v)m.push(Pa(x,u));const _=new Sp(m[0][1],"meters");return h.type==="Point"||h.type==="MultiPoint"||h.type==="LineString"?Pi(m,!1,h.type==="Point"?[h.coordinates]:h.coordinates,h.type==="LineString",_):h.type==="MultiLineString"?bf(m,!1,h.coordinates,_):h.type==="Polygon"||h.type==="MultiPolygon"?Gs(m,!1,h.type==="Polygon"?[h.coordinates]:h.coordinates,_):null}(i,o,this.geometries);if(e.geometryType()==="LineString")return function(l,u,h){const m=[];for(const v of l){const x=[];for(const w of v)x.push(Pa(w,u));m.push(x)}const _=new Sp(m[0][0][1],"meters");if(h.type==="Point"||h.type==="MultiPoint"||h.type==="LineString")return bf(h.type==="Point"?[h.coordinates]:h.coordinates,h.type==="LineString",m,_);if(h.type==="MultiLineString"){let v=1/0;for(let x=0;x<h.coordinates.length;x++){const w=bf(h.coordinates[x],!0,m,_,v);if(isNaN(w))return w;if((v=Math.min(v,w))===0)return v}return v}if(h.type==="Polygon"||h.type==="MultiPolygon"){let v=1/0;for(let x=0;x<m.length;x++){const w=Gs(m[x],!0,h.type==="Polygon"?[h.coordinates]:h.coordinates,_,v);if(isNaN(w))return w;if((v=Math.min(v,w))===0)return v}return v}return null}(i,o,this.geometries);if(e.geometryType()==="Polygon")return function(l,u,h){const m=[];for(const v of function(x,w){const C=x.length;if(C<=1)return[x];const k=[];let P,R;for(let z=0;z<C;z++){const B=Rw(x[z]);B!==0&&(x[z].area=Math.abs(B),R===void 0&&(R=B<0),R===B<0?(P&&k.push(P),P=[x[z]]):P.push(x[z]))}return P&&k.push(P),k}(l)){const x=[];for(let w=0;w<v.length;++w)x.push(fl(v[w],u));m.push(x)}const _=new Sp(m[0][0][0][1],"meters");if(h.type==="Point"||h.type==="MultiPoint"||h.type==="LineString")return Gs(h.type==="Point"?[h.coordinates]:h.coordinates,h.type==="LineString",m,_);if(h.type==="MultiLineString"){let v=1/0;for(let x=0;x<h.coordinates.length;x++){const w=Gs(h.coordinates[x],!0,m,_,v);if(isNaN(w))return w;if((v=Math.min(v,w))===0)return v}return v}return h.type==="Polygon"||h.type==="MultiPolygon"?function(v,x,w){let C=1/0;for(const k of v)for(const P of x){const R=Lw(k,P,w,C);if(isNaN(R))return R;if((C=Math.min(C,R))===0)return C}return C}(h.type==="Polygon"?[h.coordinates]:h.coordinates,m,_):null}(i,o,this.geometries);console.warn("Distance Expression: currently only evaluates valid Point/LineString/Polygon geometries.")}else console.warn("Distance Expression: requirs valid feature and canonical information.");return null}eachChild(){}outputDefined(){return!0}serialize(){return["distance",this.geojson]}}var qs=go;function bs(r){if(r instanceof Ga&&(r.name==="get"&&r.args.length===1||r.name==="feature-state"||r.name==="has"&&r.args.length===1||r.name==="properties"||r.name==="geometry-type"||r.name==="id"||/^filter-/.test(r.name))||r instanceof Tp||r instanceof qs)return!1;let e=!0;return r.eachChild(i=>{e&&!bs(i)&&(e=!1)}),e}function Fc(r){if(r instanceof Ga&&r.name==="feature-state")return!1;let e=!0;return r.eachChild(i=>{e&&!Fc(i)&&(e=!1)}),e}function wf(r){if(r instanceof Ga&&r.name==="config")return!1;let e=!0;return r.eachChild(i=>{e&&!wf(i)&&(e=!1)}),e}function Xs(r,e){if(r instanceof Ga&&e.indexOf(r.name)>=0)return!1;let i=!0;return r.eachChild(o=>{i&&!Xs(o,e)&&(i=!1)}),i}class jl{constructor(e,i){this.type=i.type,this.name=e,this.boundExpression=i}static parse(e,i){if(e.length!==2||typeof e[1]!="string")return i.error("'var' expression requires exactly one string literal argument.");const o=e[1];return i.scope.has(o)?new jl(o,i.scope.get(o)):i.error(`Unknown variable "${o}". Make sure "${o}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(e){return this.boundExpression.evaluate(e)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}var Nm=jl;class Ef{constructor(e,i=[],o,l=new ua,u=[],h){this.registry=e,this.path=i,this.key=i.map(m=>`[${m}]`).join(""),this.scope=l,this.errors=u,this.expectedType=o,this.options=h}parse(e,i,o,l,u={}){return i||o?this.concat(i,o,l)._parse(e,u):this._parse(e,u)}_parse(e,i){function o(l,u,h){return h==="assert"?new Ws(u,[l]):h==="coerce"?new vu(u,[l]):l}if(e!==null&&typeof e!="string"&&typeof e!="boolean"&&typeof e!="number"||(e=["literal",e]),Array.isArray(e)){if(e.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const l=typeof e[0]=="string"?this.registry[e[0]]:void 0;if(l){let u=l.parse(e,this);if(!u)return null;if(this.expectedType){const h=this.expectedType,m=u.type;if(h.kind!=="string"&&h.kind!=="number"&&h.kind!=="boolean"&&h.kind!=="object"&&h.kind!=="array"||m.kind!=="value")if(h.kind!=="color"&&h.kind!=="formatted"&&h.kind!=="resolvedImage"||m.kind!=="value"&&m.kind!=="string"){if(this.checkSubtype(h,m))return null}else u=o(u,h,i.typeAnnotation||"coerce");else u=o(u,h,i.typeAnnotation||"assert")}if(!(u instanceof _u)&&u.type.kind!=="resolvedImage"&&Tf(u)){const h=new bp(this.options);try{u=new _u(u.type,u.evaluate(h))}catch(m){return this.error(m.message),null}}return u}return vu.parse(["to-array",e],this)}return this.error(e===void 0?"'undefined' value invalid. Use null instead.":typeof e=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof e} instead.`)}concat(e,i,o){const l=typeof e=="number"?this.path.concat(e):this.path,u=o?this.scope.concat(o):this.scope;return new Ef(this.registry,l,i||null,u,this.errors,this.options)}error(e,...i){const o=`${this.key}${i.map(l=>`[${l}]`).join("")}`;this.errors.push(new vs(o,e))}checkSubtype(e,i){const o=pf(e,i);return o&&this.error(o),o}}var Ip=Ef;function Tf(r){if(r instanceof Nm)return Tf(r.boundExpression);if(r instanceof Ga&&r.name==="error"||r instanceof Ga&&r.name==="config"||r instanceof ul||r instanceof Tp||r instanceof qs)return!1;const e=r instanceof vu||r instanceof Ws;let i=!0;return r.eachChild(o=>{i=e?i&&Tf(o):i&&o instanceof _u}),!!i&&bs(r)&&Xs(r,["zoom","heatmap-density","line-progress","raster-value","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center","measure-light"])}function bu(r,e){const i=r.length-1;let o,l,u=0,h=i,m=0;for(;u<=h;)if(m=Math.floor((u+h)/2),o=r[m],l=r[m+1],o<=e){if(m===i||e<l)return m;u=m+1}else{if(!(o>e))throw new _a("Input is not a number.");h=m-1}return 0}class Mp{constructor(e,i,o){this.type=e,this.input=i,this.labels=[],this.outputs=[];for(const[l,u]of o)this.labels.push(l),this.outputs.push(u)}static parse(e,i){if(e.length-1<4)return i.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return i.error("Expected an even number of arguments.");const o=i.parse(e[1],1,pr);if(!o)return null;const l=[];let u=null;i.expectedType&&i.expectedType.kind!=="value"&&(u=i.expectedType);for(let h=1;h<e.length;h+=2){const m=h===1?-1/0:e[h],_=e[h+1],v=h,x=h+1;if(typeof m!="number")return i.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',v);if(l.length&&l[l.length-1][0]>=m)return i.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',v);const w=i.parse(_,x,u);if(!w)return null;u=u||w.type,l.push([m,w])}return new Mp(u,o,l)}evaluate(e){const i=this.labels,o=this.outputs;if(i.length===1)return o[0].evaluate(e);const l=this.input.evaluate(e);if(l<=i[0])return o[0].evaluate(e);const u=i.length;return l>=i[u-1]?o[u-1].evaluate(e):o[bu(i,l)].evaluate(e)}eachChild(e){e(this.input);for(const i of this.outputs)e(i)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}serialize(){const e=["step",this.input.serialize()];for(let i=0;i<this.labels.length;i++)i>0&&e.push(this.labels[i]),e.push(this.outputs[i].serialize());return e}}var Sf=Mp;function $r(r,e,i){return r*(1-i)+e*i}function f3(r,e,i){return r.map((o,l)=>$r(o,e[l],i))}var $v=Object.freeze({__proto__:null,array:f3,color:function(r,e,i){return new hn($r(r.r,e.r,i),$r(r.g,e.g,i),$r(r.b,e.b,i),$r(r.a,e.a,i))},number:$r});const h3=.95047,d3=1.08883,p3=4/29,Fp=6/29,m3=3*Fp*Fp,b$=Fp*Fp*Fp,w$=Math.PI/180,E$=180/Math.PI;function Dw(r){return r>b$?Math.pow(r,1/3):r/m3+p3}function Bw(r){return r>Fp?r*r*r:m3*(r-p3)}function zw(r){return 255*(r<=.0031308?12.92*r:1.055*Math.pow(r,1/2.4)-.055)}function Nw(r){return(r/=255)<=.04045?r/12.92:Math.pow((r+.055)/1.055,2.4)}function g3(r){const e=Nw(r.r),i=Nw(r.g),o=Nw(r.b),l=Dw((.4124564*e+.3575761*i+.1804375*o)/h3),u=Dw((.2126729*e+.7151522*i+.072175*o)/1);return{l:116*u-16,a:500*(l-u),b:200*(u-Dw((.0193339*e+.119192*i+.9503041*o)/d3)),alpha:r.a}}function _3(r){let e=(r.l+16)/116,i=isNaN(r.a)?e:e+r.a/500,o=isNaN(r.b)?e:e-r.b/200;return e=1*Bw(e),i=h3*Bw(i),o=d3*Bw(o),new hn(zw(3.2404542*i-1.5371385*e-.4985314*o),zw(-.969266*i+1.8760108*e+.041556*o),zw(.0556434*i-.2040259*e+1.0572252*o),r.alpha)}function T$(r,e,i){const o=e-r;return r+i*(o>180||o<-180?o-360*Math.round(o/360):o)}const Um={forward:g3,reverse:_3,interpolate:function(r,e,i){return{l:$r(r.l,e.l,i),a:$r(r.a,e.a,i),b:$r(r.b,e.b,i),alpha:$r(r.alpha,e.alpha,i)}}},$m={forward:function(r){const{l:e,a:i,b:o}=g3(r),l=Math.atan2(o,i)*E$;return{h:l<0?l+360:l,c:Math.sqrt(i*i+o*o),l:e,alpha:r.a}},reverse:function(r){const e=r.h*w$,i=r.c;return _3({l:r.l,a:Math.cos(e)*i,b:Math.sin(e)*i,alpha:r.alpha})},interpolate:function(r,e,i){return{h:T$(r.h,e.h,i),c:$r(r.c,e.c,i),l:$r(r.l,e.l,i),alpha:$r(r.alpha,e.alpha,i)}}};var v3=Object.freeze({__proto__:null,hcl:$m,lab:Um});class Vv{constructor(e,i,o,l,u){this.type=e,this.operator=i,this.interpolation=o,this.input=l,this.labels=[],this.outputs=[];for(const[h,m]of u)this.labels.push(h),this.outputs.push(m)}static interpolationFactor(e,i,o,l){let u=0;if(e.name==="exponential")u=Uw(i,e.base,o,l);else if(e.name==="linear")u=Uw(i,1,o,l);else if(e.name==="cubic-bezier"){const h=e.controlPoints;u=new ie(h[0],h[1],h[2],h[3]).solve(Uw(i,1,o,l))}return u}static parse(e,i){let[o,l,u,...h]=e;if(!Array.isArray(l)||l.length===0)return i.error("Expected an interpolation type expression.",1);if(l[0]==="linear")l={name:"linear"};else if(l[0]==="exponential"){const v=l[1];if(typeof v!="number")return i.error("Exponential interpolation requires a numeric base.",1,1);l={name:"exponential",base:v}}else{if(l[0]!=="cubic-bezier")return i.error(`Unknown interpolation type ${String(l[0])}`,1,0);{const v=l.slice(1);if(v.length!==4||v.some(x=>typeof x!="number"||x<0||x>1))return i.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);l={name:"cubic-bezier",controlPoints:v}}}if(e.length-1<4)return i.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return i.error("Expected an even number of arguments.");if(u=i.parse(u,2,pr),!u)return null;const m=[];let _=null;o==="interpolate-hcl"||o==="interpolate-lab"?_=Jo:i.expectedType&&i.expectedType.kind!=="value"&&(_=i.expectedType);for(let v=0;v<h.length;v+=2){const x=h[v],w=h[v+1],C=v+3,k=v+4;if(typeof x!="number")return i.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',C);if(m.length&&m[m.length-1][0]>=x)return i.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',C);const P=i.parse(w,k,_);if(!P)return null;_=_||P.type,m.push([x,P])}return _.kind==="number"||_.kind==="color"||_.kind==="array"&&_.itemType.kind==="number"&&typeof _.N=="number"?new Vv(_,o,l,u,m):i.error(`Type ${ga(_)} is not interpolatable.`)}evaluate(e){const i=this.labels,o=this.outputs;if(i.length===1)return o[0].evaluate(e);const l=this.input.evaluate(e);if(l<=i[0])return o[0].evaluate(e);const u=i.length;if(l>=i[u-1])return o[u-1].evaluate(e);const h=bu(i,l),m=Vv.interpolationFactor(this.interpolation,l,i[h],i[h+1]),_=o[h].evaluate(e),v=o[h+1].evaluate(e);return this.operator==="interpolate"?$v[this.type.kind.toLowerCase()](_,v,m):this.operator==="interpolate-hcl"?$m.reverse($m.interpolate($m.forward(_),$m.forward(v),m)):Um.reverse(Um.interpolate(Um.forward(_),Um.forward(v),m))}eachChild(e){e(this.input);for(const i of this.outputs)e(i)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}serialize(){let e;e=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const i=[this.operator,e,this.input.serialize()];for(let o=0;o<this.labels.length;o++)i.push(this.labels[o],this.outputs[o].serialize());return i}}function Uw(r,e,i,o){const l=o-i,u=r-i;return l===0?0:e===1?u/l:(Math.pow(e,u)-1)/(Math.pow(e,l)-1)}var Pc=Vv;class $w{constructor(e,i){this.type=e,this.args=i}static parse(e,i){if(e.length<2)return i.error("Expectected at least one argument.");let o=null;const l=i.expectedType;l&&l.kind!=="value"&&(o=l);const u=[];for(const m of e.slice(1)){const _=i.parse(m,1+u.length,o,void 0,{typeAnnotation:"omit"});if(!_)return null;o=o||_.type,u.push(_)}const h=l&&u.some(m=>pf(l,m.type));return new $w(h?Dn:o,u)}evaluate(e){let i,o=null,l=0;for(const u of this.args){if(l++,o=u.evaluate(e),o&&o instanceof es&&!o.available&&(i||(i=o),o=null,l===this.args.length))return i;if(o!==null)break}return o}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){const e=["coalesce"];return this.eachChild(i=>{e.push(i.serialize())}),e}}var y3=$w;class Vw{constructor(e,i){this.type=i.type,this.bindings=[].concat(e),this.result=i}evaluate(e){return this.result.evaluate(e)}eachChild(e){for(const i of this.bindings)e(i[1]);e(this.result)}static parse(e,i){if(e.length<4)return i.error(`Expected at least 3 arguments, but found ${e.length-1} instead.`);const o=[];for(let u=1;u<e.length-1;u+=2){const h=e[u];if(typeof h!="string")return i.error(`Expected string, but found ${typeof h} instead.`,u);if(/[^a-zA-Z0-9_]/.test(h))return i.error("Variable names must contain only alphanumeric characters or '_'.",u);const m=i.parse(e[u+1],u+1);if(!m)return null;o.push([h,m])}const l=i.parse(e[e.length-1],e.length-1,i.expectedType,o);return l?new Vw(o,l):null}outputDefined(){return this.result.outputDefined()}serialize(){const e=["let"];for(const[i,o]of this.bindings)e.push(i,o.serialize());return e.push(this.result.serialize()),e}}var x3=Vw;class jw{constructor(e,i,o){this.type=e,this.index=i,this.input=o}static parse(e,i){if(e.length!==3)return i.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const o=i.parse(e[1],1,pr),l=i.parse(e[2],2,Io(i.expectedType||Dn));return o&&l?new jw(l.type.itemType,o,l):null}evaluate(e){const i=this.index.evaluate(e),o=this.input.evaluate(e);if(i<0)throw new _a(`Array index out of bounds: ${i} < 0.`);if(i>=o.length)throw new _a(`Array index out of bounds: ${i} > ${o.length-1}.`);if(i!==Math.floor(i))throw new _a(`Array index must be an integer, but found ${i} instead.`);return o[i]}eachChild(e){e(this.index),e(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}var S$=jw;class Ww{constructor(e,i){this.type=jn,this.needle=e,this.haystack=i}static parse(e,i){if(e.length!==3)return i.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const o=i.parse(e[1],1,Dn),l=i.parse(e[2],2,Dn);return o&&l?_p(o.type,[jn,vn,pr,mu,Dn])?new Ww(o,l):i.error(`Expected first argument to be of type boolean, string, number or null, but found ${ga(o.type)} instead`):null}evaluate(e){const i=this.needle.evaluate(e),o=this.haystack.evaluate(e);if(o==null)return!1;if(!$h(i,["boolean","string","number","null"]))throw new _a(`Expected first argument to be of type boolean, string, number or null, but found ${ga(Aa(i))} instead.`);if(!$h(o,["string","array"]))throw new _a(`Expected second argument to be of type array or string, but found ${ga(Aa(o))} instead.`);return o.indexOf(i)>=0}eachChild(e){e(this.needle),e(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}var C$=Ww;class jv{constructor(e,i,o){this.type=pr,this.needle=e,this.haystack=i,this.fromIndex=o}static parse(e,i){if(e.length<=2||e.length>=5)return i.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const o=i.parse(e[1],1,Dn),l=i.parse(e[2],2,Dn);if(!o||!l)return null;if(!_p(o.type,[jn,vn,pr,mu,Dn]))return i.error(`Expected first argument to be of type boolean, string, number or null, but found ${ga(o.type)} instead`);if(e.length===4){const u=i.parse(e[3],3,pr);return u?new jv(o,l,u):null}return new jv(o,l)}evaluate(e){const i=this.needle.evaluate(e),o=this.haystack.evaluate(e);if(!$h(i,["boolean","string","number","null"]))throw new _a(`Expected first argument to be of type boolean, string, number or null, but found ${ga(Aa(i))} instead.`);if(!$h(o,["string","array"]))throw new _a(`Expected second argument to be of type array or string, but found ${ga(Aa(o))} instead.`);if(this.fromIndex){const l=this.fromIndex.evaluate(e);return o.indexOf(i,l)}return o.indexOf(i)}eachChild(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const e=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),e]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}var A$=jv;class Hw{constructor(e,i,o,l,u,h){this.inputType=e,this.type=i,this.input=o,this.cases=l,this.outputs=u,this.otherwise=h}static parse(e,i){if(e.length<5)return i.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if(e.length%2!=1)return i.error("Expected an even number of arguments.");let o,l;i.expectedType&&i.expectedType.kind!=="value"&&(l=i.expectedType);const u={},h=[];for(let v=2;v<e.length-1;v+=2){let x=e[v];const w=e[v+1];Array.isArray(x)||(x=[x]);const C=i.concat(v);if(x.length===0)return C.error("Expected at least one branch label.");for(const P of x){if(typeof P!="number"&&typeof P!="string")return C.error("Branch labels must be numbers or strings.");if(typeof P=="number"&&Math.abs(P)>Number.MAX_SAFE_INTEGER)return C.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof P=="number"&&Math.floor(P)!==P)return C.error("Numeric branch labels must be integer values.");if(o){if(C.checkSubtype(o,Aa(P)))return null}else o=Aa(P);if(u[String(P)]!==void 0)return C.error("Branch labels must be unique.");u[String(P)]=h.length}const k=i.parse(w,v,l);if(!k)return null;l=l||k.type,h.push(k)}const m=i.parse(e[1],1,Dn);if(!m)return null;const _=i.parse(e[e.length-1],e.length-1,l);return _?m.type.kind!=="value"&&i.concat(1).checkSubtype(o,m.type)?null:new Hw(o,l,m,u,h,_):null}evaluate(e){const i=this.input.evaluate(e);return(Aa(i)===this.inputType&&this.outputs[this.cases[i]]||this.otherwise).evaluate(e)}eachChild(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)}outputDefined(){return this.outputs.every(e=>e.outputDefined())&&this.otherwise.outputDefined()}serialize(){const e=["match",this.input.serialize()],i=Object.keys(this.cases).sort(),o=[],l={};for(const h of i){const m=l[this.cases[h]];m===void 0?(l[this.cases[h]]=o.length,o.push([this.cases[h],[h]])):o[m][1].push(h)}const u=h=>this.inputType.kind==="number"?Number(h):h;for(const[h,m]of o)e.push(m.length===1?u(m[0]):m.map(u)),e.push(this.outputs[h].serialize());return e.push(this.otherwise.serialize()),e}}var k$=Hw;class Gw{constructor(e,i,o){this.type=e,this.branches=i,this.otherwise=o}static parse(e,i){if(e.length<4)return i.error(`Expected at least 3 arguments, but found only ${e.length-1}.`);if(e.length%2!=0)return i.error("Expected an odd number of arguments.");let o;i.expectedType&&i.expectedType.kind!=="value"&&(o=i.expectedType);const l=[];for(let h=1;h<e.length-1;h+=2){const m=i.parse(e[h],h,jn);if(!m)return null;const _=i.parse(e[h+1],h+1,o);if(!_)return null;l.push([m,_]),o=o||_.type}const u=i.parse(e[e.length-1],e.length-1,o);return u?new Gw(o,l,u):null}evaluate(e){for(const[i,o]of this.branches)if(i.evaluate(e))return o.evaluate(e);return this.otherwise.evaluate(e)}eachChild(e){for(const[i,o]of this.branches)e(i),e(o);e(this.otherwise)}outputDefined(){return this.branches.every(([e,i])=>i.outputDefined())&&this.otherwise.outputDefined()}serialize(){const e=["case"];return this.eachChild(i=>{e.push(i.serialize())}),e}}var I$=Gw;class Wv{constructor(e,i,o,l){this.type=e,this.input=i,this.beginIndex=o,this.endIndex=l}static parse(e,i){if(e.length<=2||e.length>=5)return i.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const o=i.parse(e[1],1,Dn),l=i.parse(e[2],2,pr);if(!o||!l)return null;if(!_p(o.type,[Io(Dn),vn,Dn]))return i.error(`Expected first argument to be of type array or string, but found ${ga(o.type)} instead`);if(e.length===4){const u=i.parse(e[3],3,pr);return u?new Wv(o.type,o,l,u):null}return new Wv(o.type,o,l)}evaluate(e){const i=this.input.evaluate(e),o=this.beginIndex.evaluate(e);if(!$h(i,["string","array"]))throw new _a(`Expected first argument to be of type array or string, but found ${ga(Aa(i))} instead.`);if(this.endIndex){const l=this.endIndex.evaluate(e);return i.slice(o,l)}return i.slice(o)}eachChild(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const e=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),e]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}var M$=Wv;function b3(r,e){return r==="=="||r==="!="?e.kind==="boolean"||e.kind==="string"||e.kind==="number"||e.kind==="null"||e.kind==="value":e.kind==="string"||e.kind==="number"||e.kind==="value"}function w3(r,e,i,o){return o.compare(e,i)===0}function Pp(r,e,i){const o=r!=="=="&&r!=="!=";return class vU{constructor(u,h,m){this.type=jn,this.lhs=u,this.rhs=h,this.collator=m,this.hasUntypedArgument=u.type.kind==="value"||h.type.kind==="value"}static parse(u,h){if(u.length!==3&&u.length!==4)return h.error("Expected two or three arguments.");const m=u[0];let _=h.parse(u[1],1,Dn);if(!_)return null;if(!b3(m,_.type))return h.concat(1).error(`"${m}" comparisons are not supported for type '${ga(_.type)}'.`);let v=h.parse(u[2],2,Dn);if(!v)return null;if(!b3(m,v.type))return h.concat(2).error(`"${m}" comparisons are not supported for type '${ga(v.type)}'.`);if(_.type.kind!==v.type.kind&&_.type.kind!=="value"&&v.type.kind!=="value")return h.error(`Cannot compare types '${ga(_.type)}' and '${ga(v.type)}'.`);o&&(_.type.kind==="value"&&v.type.kind!=="value"?_=new Ws(v.type,[_]):_.type.kind!=="value"&&v.type.kind==="value"&&(v=new Ws(_.type,[v])));let x=null;if(u.length===4){if(_.type.kind!=="string"&&v.type.kind!=="string"&&_.type.kind!=="value"&&v.type.kind!=="value")return h.error("Cannot use collator to compare non-string types.");if(x=h.parse(u[3],3,Nh),!x)return null}return new vU(_,v,x)}evaluate(u){const h=this.lhs.evaluate(u),m=this.rhs.evaluate(u);if(o&&this.hasUntypedArgument){const _=Aa(h),v=Aa(m);if(_.kind!==v.kind||_.kind!=="string"&&_.kind!=="number")throw new _a(`Expected arguments for "${r}" to be (string, string) or (number, number), but found (${_.kind}, ${v.kind}) instead.`)}if(this.collator&&!o&&this.hasUntypedArgument){const _=Aa(h),v=Aa(m);if(_.kind!=="string"||v.kind!=="string")return e(u,h,m)}return this.collator?i(u,h,m,this.collator.evaluate(u)):e(u,h,m)}eachChild(u){u(this.lhs),u(this.rhs),this.collator&&u(this.collator)}outputDefined(){return!0}serialize(){const u=[r];return this.eachChild(h=>{u.push(h.serialize())}),u}}}const F$=Pp("==",function(r,e,i){return e===i},w3),P$=Pp("!=",function(r,e,i){return e!==i},function(r,e,i,o){return!w3(0,e,i,o)}),O$=Pp("<",function(r,e,i){return e<i},function(r,e,i,o){return o.compare(e,i)<0}),R$=Pp(">",function(r,e,i){return e>i},function(r,e,i,o){return o.compare(e,i)>0}),L$=Pp("<=",function(r,e,i){return e<=i},function(r,e,i,o){return o.compare(e,i)<=0}),D$=Pp(">=",function(r,e,i){return e>=i},function(r,e,i,o){return o.compare(e,i)>=0});class qw{constructor(e,i,o,l,u,h){this.type=vn,this.number=e,this.locale=i,this.currency=o,this.unit=l,this.minFractionDigits=u,this.maxFractionDigits=h}static parse(e,i){if(e.length!==3)return i.error("Expected two arguments.");const o=i.parse(e[1],1,pr);if(!o)return null;const l=e[2];if(typeof l!="object"||Array.isArray(l))return i.error("NumberFormat options argument must be an object.");let u=null;if(l.locale&&(u=i.parse(l.locale,1,vn),!u))return null;let h=null;if(l.currency&&(h=i.parse(l.currency,1,vn),!h))return null;let m=null;if(l.unit&&(m=i.parse(l.unit,1,vn),!m))return null;let _=null;if(l["min-fraction-digits"]&&(_=i.parse(l["min-fraction-digits"],1,pr),!_))return null;let v=null;return l["max-fraction-digits"]&&(v=i.parse(l["max-fraction-digits"],1,pr),!v)?null:new qw(o,u,h,m,_,v)}evaluate(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(e):void 0,unit:this.unit?this.unit.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))}eachChild(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.unit&&e(this.unit),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const e={};return this.locale&&(e.locale=this.locale.serialize()),this.currency&&(e.currency=this.currency.serialize()),this.unit&&(e.unit=this.unit.serialize()),this.minFractionDigits&&(e["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(e["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),e]}}class Xw{constructor(e){this.type=pr,this.input=e}static parse(e,i){if(e.length!==2)return i.error(`Expected 1 argument, but found ${e.length-1} instead.`);const o=i.parse(e[1],1);return o?o.type.kind!=="array"&&o.type.kind!=="string"&&o.type.kind!=="value"?i.error(`Expected argument of type string or array, but found ${ga(o.type)} instead.`):new Xw(o):null}evaluate(e){const i=this.input.evaluate(e);if(typeof i=="string"||Array.isArray(i))return i.length;throw new _a(`Expected value to be of type string or array, but found ${ga(Aa(i))} instead.`)}eachChild(e){e(this.input)}outputDefined(){return!1}serialize(){const e=["length"];return this.eachChild(i=>{e.push(i.serialize())}),e}}function Zw(r){return function(){r=1831565813+(r|=0)|0;let e=Math.imul(r^r>>>15,1|r);return e=e+Math.imul(e^e>>>7,61|e)^e,((e^e>>>14)>>>0)/4294967296}}const E3={"==":F$,"!=":P$,">":R$,"<":O$,">=":D$,"<=":L$,array:Ws,at:S$,boolean:Ws,case:I$,coalesce:y3,collator:ul,format:Ul,image:Gh,in:C$,"index-of":A$,interpolate:Pc,"interpolate-hcl":Pc,"interpolate-lab":Pc,length:Xw,let:x3,literal:_u,match:k$,number:Ws,"number-format":qw,object:Ws,slice:M$,step:Sf,string:Ws,"to-boolean":vu,"to-color":vu,"to-number":vu,"to-string":vu,var:Nm,within:Tp,distance:qs};function T3(r,[e,i,o,l]){e=e.evaluate(r),i=i.evaluate(r),o=o.evaluate(r);const u=l?l.evaluate(r):1,h=Rv(e,i,o,u);if(h)throw new _a(h);return new hn(e/255*u,i/255*u,o/255*u,u)}function S3(r,[e,i,o,l]){e=e.evaluate(r),i=i.evaluate(r),o=o.evaluate(r);const u=l?l.evaluate(r):1,h=function(v,x,w,C){return typeof v=="number"&&v>=0&&v<=360?typeof x=="number"&&x>=0&&x<=100&&typeof w=="number"&&w>=0&&w<=100?C===void 0||typeof C=="number"&&C>=0&&C<=1?null:`Invalid hsla value [${[v,x,w,C].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid hsla value [${(typeof C=="number"?[v,x,w,C]:[v,x,w]).join(", ")}]: 's', and 'l' must be between 0 and 100.`:`Invalid hsla value [${(typeof C=="number"?[v,x,w,C]:[v,x,w]).join(", ")}]: 'h' must be between 0 and 360.`}(e,i,o,u);if(h)throw new _a(h);const m=`hsla(${e}, ${i}%, ${o}%, ${u})`,_=hn.parse(m);if(!_)throw new _a(`Failed to parse HSLA color: ${m}`);return _}function C3(r,e){return r in e}function Kw(r,e){const i=e[r];return i===void 0?null:i}function A3(r,e,i){i.length&&(e+=`${i}`);const o=r.getConfig(e);return o?o.evaluate(r):null}function Yh(r){return{type:r}}Ga.register(E3,{error:[{kind:"error"},[vn],(r,[e])=>{throw new _a(e.evaluate(r))}],typeof:[vn,[Dn],(r,[e])=>ga(Aa(e.evaluate(r)))],"to-rgba":[Io(pr,4),[Jo],(r,[e])=>e.evaluate(r).toArray()],rgb:[Jo,[pr,pr,pr],T3],rgba:[Jo,[pr,pr,pr,pr],T3],hsl:[Jo,[pr,pr,pr],S3],hsla:[Jo,[pr,pr,pr,pr],S3],has:{type:jn,overloads:[[[vn],(r,[e])=>C3(e.evaluate(r),r.properties())],[[vn,gu],(r,[e,i])=>C3(e.evaluate(r),i.evaluate(r))]]},get:{type:Dn,overloads:[[[vn],(r,[e])=>Kw(e.evaluate(r),r.properties())],[[vn,gu],(r,[e,i])=>Kw(e.evaluate(r),i.evaluate(r))]]},config:{type:Dn,overloads:[[[vn],(r,[e])=>A3(r,e.evaluate(r),"")],[[vn,vn],(r,[e,i])=>A3(r,e.evaluate(r),i.evaluate(r))]]},"feature-state":[Dn,[vn],(r,[e])=>Kw(e.evaluate(r),r.featureState||{})],properties:[gu,[],r=>r.properties()],"geometry-type":[vn,[],r=>r.geometryType()],id:[Dn,[],r=>r.id()],zoom:[pr,[],r=>r.globals.zoom],pitch:[pr,[],r=>r.globals.pitch||0],"distance-from-center":[pr,[],r=>r.distanceFromCenter()],"measure-light":[pr,[vn],(r,[e])=>r.measureLight(e.evaluate(r))],"heatmap-density":[pr,[],r=>r.globals.heatmapDensity||0],"line-progress":[pr,[],r=>r.globals.lineProgress||0],"raster-value":[pr,[],r=>r.globals.rasterValue||0],"sky-radial-progress":[pr,[],r=>r.globals.skyRadialProgress||0],accumulated:[Dn,[],r=>r.globals.accumulated===void 0?null:r.globals.accumulated],"+":[pr,Yh(pr),(r,e)=>{let i=0;for(const o of e)i+=o.evaluate(r);return i}],"*":[pr,Yh(pr),(r,e)=>{let i=1;for(const o of e)i*=o.evaluate(r);return i}],"-":{type:pr,overloads:[[[pr,pr],(r,[e,i])=>e.evaluate(r)-i.evaluate(r)],[[pr],(r,[e])=>-e.evaluate(r)]]},"/":[pr,[pr,pr],(r,[e,i])=>e.evaluate(r)/i.evaluate(r)],"%":[pr,[pr,pr],(r,[e,i])=>e.evaluate(r)%i.evaluate(r)],ln2:[pr,[],()=>Math.LN2],pi:[pr,[],()=>Math.PI],e:[pr,[],()=>Math.E],"^":[pr,[pr,pr],(r,[e,i])=>Math.pow(e.evaluate(r),i.evaluate(r))],sqrt:[pr,[pr],(r,[e])=>Math.sqrt(e.evaluate(r))],log10:[pr,[pr],(r,[e])=>Math.log(e.evaluate(r))/Math.LN10],ln:[pr,[pr],(r,[e])=>Math.log(e.evaluate(r))],log2:[pr,[pr],(r,[e])=>Math.log(e.evaluate(r))/Math.LN2],sin:[pr,[pr],(r,[e])=>Math.sin(e.evaluate(r))],cos:[pr,[pr],(r,[e])=>Math.cos(e.evaluate(r))],tan:[pr,[pr],(r,[e])=>Math.tan(e.evaluate(r))],asin:[pr,[pr],(r,[e])=>Math.asin(e.evaluate(r))],acos:[pr,[pr],(r,[e])=>Math.acos(e.evaluate(r))],atan:[pr,[pr],(r,[e])=>Math.atan(e.evaluate(r))],min:[pr,Yh(pr),(r,e)=>Math.min(...e.map(i=>i.evaluate(r)))],max:[pr,Yh(pr),(r,e)=>Math.max(...e.map(i=>i.evaluate(r)))],abs:[pr,[pr],(r,[e])=>Math.abs(e.evaluate(r))],round:[pr,[pr],(r,[e])=>{const i=e.evaluate(r);return i<0?-Math.round(-i):Math.round(i)}],floor:[pr,[pr],(r,[e])=>Math.floor(e.evaluate(r))],ceil:[pr,[pr],(r,[e])=>Math.ceil(e.evaluate(r))],"filter-==":[jn,[vn,Dn],(r,[e,i])=>r.properties()[e.value]===i.value],"filter-id-==":[jn,[Dn],(r,[e])=>r.id()===e.value],"filter-type-==":[jn,[vn],(r,[e])=>r.geometryType()===e.value],"filter-<":[jn,[vn,Dn],(r,[e,i])=>{const o=r.properties()[e.value],l=i.value;return typeof o==typeof l&&o<l}],"filter-id-<":[jn,[Dn],(r,[e])=>{const i=r.id(),o=e.value;return typeof i==typeof o&&i<o}],"filter->":[jn,[vn,Dn],(r,[e,i])=>{const o=r.properties()[e.value],l=i.value;return typeof o==typeof l&&o>l}],"filter-id->":[jn,[Dn],(r,[e])=>{const i=r.id(),o=e.value;return typeof i==typeof o&&i>o}],"filter-<=":[jn,[vn,Dn],(r,[e,i])=>{const o=r.properties()[e.value],l=i.value;return typeof o==typeof l&&o<=l}],"filter-id-<=":[jn,[Dn],(r,[e])=>{const i=r.id(),o=e.value;return typeof i==typeof o&&i<=o}],"filter->=":[jn,[vn,Dn],(r,[e,i])=>{const o=r.properties()[e.value],l=i.value;return typeof o==typeof l&&o>=l}],"filter-id->=":[jn,[Dn],(r,[e])=>{const i=r.id(),o=e.value;return typeof i==typeof o&&i>=o}],"filter-has":[jn,[Dn],(r,[e])=>e.value in r.properties()],"filter-has-id":[jn,[],r=>r.id()!==null&&r.id()!==void 0],"filter-type-in":[jn,[Io(vn)],(r,[e])=>e.value.indexOf(r.geometryType())>=0],"filter-id-in":[jn,[Io(Dn)],(r,[e])=>e.value.indexOf(r.id())>=0],"filter-in-small":[jn,[vn,Io(Dn)],(r,[e,i])=>i.value.indexOf(r.properties()[e.value])>=0],"filter-in-large":[jn,[vn,Io(Dn)],(r,[e,i])=>function(o,l,u,h){for(;u<=h;){const m=u+h>>1;if(l[m]===o)return!0;l[m]>o?h=m-1:u=m+1}return!1}(r.properties()[e.value],i.value,0,i.value.length-1)],all:{type:jn,overloads:[[[jn,jn],(r,[e,i])=>e.evaluate(r)&&i.evaluate(r)],[Yh(jn),(r,e)=>{for(const i of e)if(!i.evaluate(r))return!1;return!0}]]},any:{type:jn,overloads:[[[jn,jn],(r,[e,i])=>e.evaluate(r)||i.evaluate(r)],[Yh(jn),(r,e)=>{for(const i of e)if(i.evaluate(r))return!0;return!1}]]},"!":[jn,[jn],(r,[e])=>!e.evaluate(r)],"is-supported-script":[jn,[vn],(r,[e])=>{const i=r.globals&&r.globals.isSupportedScript;return!i||i(e.evaluate(r))}],upcase:[vn,[vn],(r,[e])=>e.evaluate(r).toUpperCase()],downcase:[vn,[vn],(r,[e])=>e.evaluate(r).toLowerCase()],concat:[vn,Yh(Dn),(r,e)=>e.map(i=>jh(i.evaluate(r))).join("")],"resolved-locale":[vn,[Nh],(r,[e])=>e.evaluate(r).resolvedLocale()],random:[pr,[pr,pr,Dn],(r,e)=>{const[i,o,l]=e.map(h=>h.evaluate(r));if(i>o||i===o)return i;let u;if(typeof l=="string")u=function(h){let m=0;if(h.length===0)return m;for(let _=0;_<h.length;_++)m=(m<<5)-m+h.charCodeAt(_),m&=m;return m}(l);else{if(typeof l!="number")throw new _a(`Invalid seed input: ${l}`);u=l}return i+Zw(u)()*(o-i)}]});var Vm=E3;function k3(r){return{result:"success",value:r}}function Jh(r){return{result:"error",value:r}}function I3(r,e){return!!r&&!!r.parameters&&r.parameters.indexOf(e)>-1}function Qh(r){return r["property-type"]==="data-driven"}function M3(r){return I3(r.expression,"measure-light")}function Yw(r){return I3(r.expression,"zoom")}function Jw(r){return!!r.expression&&r.expression.interpolated}function Hv(r){return typeof r=="object"&&r!==null&&!Array.isArray(r)}function B$(r){return r}function F3(r,e){const i=e.type==="color",o=r.stops&&typeof r.stops[0][0]=="object",l=o||!(o||r.property!==void 0),u=r.type||(Jw(e)?"exponential":"interval");if(i&&((r=Nr({},r)).stops&&(r.stops=r.stops.map(v=>[v[0],hn.parse(v[1])])),r.default=hn.parse(r.default?r.default:e.default)),r.colorSpace&&r.colorSpace!=="rgb"&&!v3[r.colorSpace])throw new Error(`Unknown color space: ${r.colorSpace}`);let h,m,_;if(u==="exponential")h=P3;else if(u==="interval")h=N$;else if(u==="categorical"){h=z$,m=Object.create(null);for(const v of r.stops)m[v[0]]=v[1];_=typeof r.stops[0][0]}else{if(u!=="identity")throw new Error(`Unknown function type "${u}"`);h=U$}if(o){const v={},x=[];for(let k=0;k<r.stops.length;k++){const P=r.stops[k],R=P[0].zoom;v[R]===void 0&&(v[R]={zoom:R,type:r.type,property:r.property,default:r.default,stops:[]},x.push(R)),v[R].stops.push([P[0].value,P[1]])}const w=[];for(const k of x)w.push([v[k].zoom,F3(v[k],e)]);const C={name:"linear"};return{kind:"composite",interpolationType:C,interpolationFactor:Pc.interpolationFactor.bind(void 0,C),zoomStops:w.map(k=>k[0]),evaluate:({zoom:k},P)=>P3({stops:w,base:r.base},e,k).evaluate(k,P)}}if(l){const v=u==="exponential"?{name:"exponential",base:r.base!==void 0?r.base:1}:null;return{kind:"camera",interpolationType:v,interpolationFactor:Pc.interpolationFactor.bind(void 0,v),zoomStops:r.stops.map(x=>x[0]),evaluate:({zoom:x})=>h(r,e,x,m,_)}}return{kind:"source",evaluate(v,x){const w=x&&x.properties?x.properties[r.property]:void 0;return w===void 0?jm(r.default,e.default):h(r,e,w,m,_)}}}function jm(r,e,i){return r!==void 0?r:e!==void 0?e:i!==void 0?i:void 0}function z$(r,e,i,o,l){return jm(typeof i===l?o[i]:void 0,r.default,e.default)}function N$(r,e,i){if(ei(i)!=="number")return jm(r.default,e.default);const o=r.stops.length;if(o===1||i<=r.stops[0][0])return r.stops[0][1];if(i>=r.stops[o-1][0])return r.stops[o-1][1];const l=bu(r.stops.map(u=>u[0]),i);return r.stops[l][1]}function P3(r,e,i){const o=r.base!==void 0?r.base:1;if(ei(i)!=="number")return jm(r.default,e.default);const l=r.stops.length;if(l===1||i<=r.stops[0][0])return r.stops[0][1];if(i>=r.stops[l-1][0])return r.stops[l-1][1];const u=bu(r.stops.map(x=>x[0]),i),h=function(x,w,C,k){const P=k-C,R=x-C;return P===0?0:w===1?R/P:(Math.pow(w,R)-1)/(Math.pow(w,P)-1)}(i,o,r.stops[u][0],r.stops[u+1][0]),m=r.stops[u][1],_=r.stops[u+1][1];let v=$v[e.type]||B$;if(r.colorSpace&&r.colorSpace!=="rgb"){const x=v3[r.colorSpace];v=(w,C)=>x.reverse(x.interpolate(x.forward(w),x.forward(C),h))}return typeof m.evaluate=="function"?{evaluate(...x){const w=m.evaluate.apply(void 0,x),C=_.evaluate.apply(void 0,x);if(w!==void 0&&C!==void 0)return v(w,C,h)}}:v(m,_,h)}function U$(r,e,i){return e.type==="color"?i=hn.parse(i):e.type==="formatted"?i=Eo.fromString(i.toString()):e.type==="resolvedImage"?i=es.fromString(i.toString()):ei(i)===e.type||e.type==="enum"&&e.values[i]||(i=void 0),jm(i,r.default,e.default)}class Qw{constructor(e,i,o){this.expression=e,this._warningHistory={},this._evaluator=new bp(o),this._defaultValue=i?function(l){return l.type==="color"&&(Hv(l.default)||Array.isArray(l.default))?new hn(0,0,0,0):l.type==="color"?hn.parse(l.default)||null:l.default===void 0?null:l.default}(i):null,this._enumValues=i&&i.type==="enum"?i.values:null}evaluateWithoutErrorHandling(e,i,o,l,u,h,m,_){return this._evaluator.globals=e,this._evaluator.feature=i,this._evaluator.featureState=o,this._evaluator.canonical=l||null,this._evaluator.availableImages=u||null,this._evaluator.formattedSection=h,this._evaluator.featureTileCoord=m||null,this._evaluator.featureDistanceData=_||null,this.expression.evaluate(this._evaluator)}evaluate(e,i,o,l,u,h,m,_){this._evaluator.globals=e,this._evaluator.feature=i||null,this._evaluator.featureState=o||null,this._evaluator.canonical=l||null,this._evaluator.availableImages=u||null,this._evaluator.formattedSection=h||null,this._evaluator.featureTileCoord=m||null,this._evaluator.featureDistanceData=_||null;try{const v=this.expression.evaluate(this._evaluator);if(v==null||typeof v=="number"&&v!=v)return this._defaultValue;if(this._enumValues&&!(v in this._enumValues))throw new _a(`Expected value to be one of ${Object.keys(this._enumValues).map(x=>JSON.stringify(x)).join(", ")}, but found ${JSON.stringify(v)} instead.`);return v}catch(v){return this._warningHistory[v.message]||(this._warningHistory[v.message]=!0,typeof console<"u"&&console.warn(v.message)),this._defaultValue}}}function Gv(r){return Array.isArray(r)&&r.length>0&&typeof r[0]=="string"&&r[0]in Vm}function Cf(r,e,i){const o=new Ip(Vm,[],e?function(u){const h={color:Jo,string:vn,number:pr,enum:vn,boolean:jn,formatted:df,resolvedImage:Uh};return u.type==="array"?Io(h[u.value]||Dn,u.length):h[u.type]}(e):void 0,void 0,void 0,i),l=o.parse(r,void 0,void 0,void 0,e&&e.type==="string"?{typeAnnotation:"coerce"}:void 0);return l?k3(new Qw(l,e,i)):Jh(o.errors)}class e2{constructor(e,i,o){this.kind=e,this._styleExpression=i,this.isLightConstant=o,this.isStateDependent=e!=="constant"&&!Fc(i.expression),this.isConfigDependent=!wf(i.expression)}evaluateWithoutErrorHandling(e,i,o,l,u,h){return this._styleExpression.evaluateWithoutErrorHandling(e,i,o,l,u,h)}evaluate(e,i,o,l,u,h){return this._styleExpression.evaluate(e,i,o,l,u,h)}}class Af{constructor(e,i,o,l,u){this.kind=e,this.zoomStops=o,this._styleExpression=i,this.isStateDependent=e!=="camera"&&!Fc(i.expression),this.isLightConstant=u,this.isConfigDependent=!wf(i.expression),this.interpolationType=l}evaluateWithoutErrorHandling(e,i,o,l,u,h){return this._styleExpression.evaluateWithoutErrorHandling(e,i,o,l,u,h)}evaluate(e,i,o,l,u,h){return this._styleExpression.evaluate(e,i,o,l,u,h)}interpolationFactor(e,i,o){return this.interpolationType?Pc.interpolationFactor(this.interpolationType,e,i,o):0}}function t2(r,e,i){if((r=Cf(r,e,i)).result==="error")return r;const o=r.value.expression,l=bs(o);if(!l&&!Qh(e))return Jh([new vs("","data expressions not supported")]);const u=Xs(o,["zoom","pitch","distance-from-center"]);if(!u&&!Yw(e))return Jh([new vs("","zoom expressions not supported")]);const h=Xs(o,["measure-light"]);if(!h&&!M3(e))return Jh([new vs("","measure-light expression not supported")]);const m=e.expression&&e.expression.relaxZoomRestriction,_=Xv(o);return _||u||m?_ instanceof vs?Jh([_]):_ instanceof Pc&&!Jw(e)?Jh([new vs("",'"interpolate" expressions cannot be used with this property')]):k3(_?new Af(l?"camera":"composite",r.value,_.labels,_ instanceof Pc?_.interpolation:void 0,h):new e2(l?"constant":"source",r.value,h)):Jh([new vs("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression, or in the properties of atmosphere.')])}class qv{constructor(e,i){this._parameters=e,this._specification=i,Nr(this,F3(this._parameters,this._specification))}static deserialize(e){return new qv(e._parameters,e._specification)}static serialize(e){return{_parameters:e._parameters,_specification:e._specification}}}function Xv(r){let e=null;if(r instanceof x3)e=Xv(r.result);else if(r instanceof y3){for(const i of r.args)if(e=Xv(i),e)break}else(r instanceof Sf||r instanceof Pc)&&r.input instanceof Ga&&r.input.name==="zoom"&&(e=r);return e instanceof vs||r.eachChild(i=>{const o=Xv(i);o instanceof vs?e=o:e&&o&&e!==o&&(e=new vs("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),e}function dl(r){const e=r.key,i=r.value,o=r.valueSpec||{},l=r.objectElementValidators||{},u=r.style,h=r.styleSpec;let m=[];const _=ei(i);if(_!=="object")return[new nr(e,i,`object expected, ${_} found`)];for(const v in i){const x=v.split(".")[0];let w;l[x]?w=l[x]:o[x]?w=io:l["*"]?w=l["*"]:o["*"]&&(w=io),w?m=m.concat(w({key:(e&&`${e}.`)+v,value:i[v],valueSpec:o[x]||o["*"],style:u,styleSpec:h,object:i,objectKey:v},i)):m.push(new Kt(e,i[v],`unknown property "${v}"`))}for(const v in o)l[v]||o[v].required&&o[v].default===void 0&&i[v]===void 0&&m.push(new nr(e,i,`missing required property "${v}"`));return m}function O3(r){const e=r.value,i=r.valueSpec,o=r.style,l=r.styleSpec,u=r.key,h=r.arrayElementValidator||io;if(ei(e)!=="array")return[new nr(u,e,`array expected, ${ei(e)} found`)];if(i.length&&e.length!==i.length)return[new nr(u,e,`array length ${i.length} expected, length ${e.length} found`)];if(i["min-length"]&&e.length<i["min-length"])return[new nr(u,e,`array length at least ${i["min-length"]} expected, length ${e.length} found`)];let m={type:i.value,values:i.values,minimum:i.minimum,maximum:i.maximum,function:void 0};l.$version<7&&(m.function=i.function),ei(i.value)==="object"&&(m=i.value);let _=[];for(let v=0;v<e.length;v++)_=_.concat(h({array:e,arrayIndex:v,value:e[v],valueSpec:m,style:o,styleSpec:l,key:`${u}[${v}]`},!0));return _}function R3(r){const e=r.key,i=r.value,o=r.valueSpec;let l=ei(i);if(l==="number"&&i!=i&&(l="NaN"),l!=="number")return[new nr(e,i,`number expected, ${l} found`)];if("minimum"in o){let u=o.minimum;if(ei(o.minimum)==="array"&&(u=o.minimum[r.arrayIndex]),i<u)return[new nr(e,i,`${i} is less than the minimum value ${u}`)]}if("maximum"in o){let u=o.maximum;if(ei(o.maximum)==="array"&&(u=o.maximum[r.arrayIndex]),i>u)return[new nr(e,i,`${i} is greater than the maximum value ${u}`)]}return[]}function L3(r){const e=r.valueSpec,i=Sn(r.value.type);let o,l,u,h={};const m=i!=="categorical"&&r.value.property===void 0,_=!m,v=ei(r.value.stops)==="array"&&ei(r.value.stops[0])==="array"&&ei(r.value.stops[0][0])==="object",x=dl({key:r.key,value:r.value,valueSpec:r.styleSpec.function,style:r.style,styleSpec:r.styleSpec,objectElementValidators:{stops:function(k){if(i==="identity")return[new nr(k.key,k.value,'identity function may not have a "stops" property')];let P=[];const R=k.value;return P=P.concat(O3({key:k.key,value:R,valueSpec:k.valueSpec,style:k.style,styleSpec:k.styleSpec,arrayElementValidator:w})),ei(R)==="array"&&R.length===0&&P.push(new nr(k.key,R,"array must have at least one stop")),P},default:function(k){return io({key:k.key,value:k.value,valueSpec:e,style:k.style,styleSpec:k.styleSpec})}}});return i==="identity"&&m&&x.push(new nr(r.key,r.value,'missing required property "property"')),i==="identity"||r.value.stops||x.push(new nr(r.key,r.value,'missing required property "stops"')),i==="exponential"&&r.valueSpec.expression&&!Jw(r.valueSpec)&&x.push(new nr(r.key,r.value,"exponential functions not supported")),r.styleSpec.$version>=8&&(_&&!Qh(r.valueSpec)?x.push(new nr(r.key,r.value,"property functions not supported")):m&&!Yw(r.valueSpec)&&x.push(new nr(r.key,r.value,"zoom functions not supported"))),i!=="categorical"&&!v||r.value.property!==void 0||x.push(new nr(r.key,r.value,'"property" property is required')),x;function w(k){let P=[];const R=k.value,z=k.key;if(ei(R)!=="array")return[new nr(z,R,`array expected, ${ei(R)} found`)];if(R.length!==2)return[new nr(z,R,`array length 2 expected, length ${R.length} found`)];if(v){if(ei(R[0])!=="object")return[new nr(z,R,`object expected, ${ei(R[0])} found`)];if(R[0].zoom===void 0)return[new nr(z,R,"object stop key must have zoom")];if(R[0].value===void 0)return[new nr(z,R,"object stop key must have value")];const B=Sn(R[0].zoom);if(typeof B!="number")return[new nr(z,R[0].zoom,"stop zoom values must be numbers")];if(u&&u>B)return[new nr(z,R[0].zoom,"stop zoom values must appear in ascending order")];B!==u&&(u=B,l=void 0,h={}),P=P.concat(dl({key:`${z}[0]`,value:R[0],valueSpec:{zoom:{}},style:k.style,styleSpec:k.styleSpec,objectElementValidators:{zoom:R3,value:C}}))}else P=P.concat(C({key:`${z}[0]`,value:R[0],valueSpec:{},style:k.style,styleSpec:k.styleSpec},R));return Gv(aa(R[1]))?P.concat([new nr(`${z}[1]`,R[1],"expressions are not allowed in function stops.")]):P.concat(io({key:`${z}[1]`,value:R[1],valueSpec:e,style:k.style,styleSpec:k.styleSpec}))}function C(k,P){const R=ei(k.value),z=Sn(k.value),B=k.value!==null?k.value:P;if(o){if(R!==o)return[new nr(k.key,B,`${R} stop domain type must match previous stop domain type ${o}`)]}else o=R;if(R!=="number"&&R!=="string"&&R!=="boolean"&&typeof z!="number"&&typeof z!="string"&&typeof z!="boolean")return[new nr(k.key,B,"stop domain value must be a number, string, or boolean")];if(R!=="number"&&i!=="categorical"){let H=`number expected, ${R} found`;return Qh(e)&&i===void 0&&(H+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new nr(k.key,B,H)]}return i!=="categorical"||R!=="number"||typeof z=="number"&&isFinite(z)&&Math.floor(z)===z?i!=="categorical"&&R==="number"&&typeof z=="number"&&typeof l=="number"&&l!==void 0&&z<l?[new nr(k.key,B,"stop domain values must appear in ascending order")]:(l=z,i==="categorical"&&z in h?[new nr(k.key,B,"stop domain values must be unique")]:(h[z]=!0,[])):[new nr(k.key,B,`integer expected, found ${String(z)}`)]}}function ed(r){const e=(r.expressionContext==="property"?t2:Cf)(aa(r.value),r.valueSpec);if(e.result==="error")return e.value.map(o=>new nr(`${r.key}${o.key}`,r.value,o.message));const i=e.value.expression||e.value._styleExpression.expression;if(r.expressionContext==="property"&&r.propertyKey==="text-font"&&!i.outputDefined())return[new nr(r.key,r.value,`Invalid data expression for "${r.propertyKey}". Output values must be contained as literals within the expression.`)];if(r.expressionContext==="property"&&r.propertyType==="layout"&&!Fc(i))return[new nr(r.key,r.value,'"feature-state" data expressions are not supported with layout properties.')];if(r.expressionContext==="filter")return D3(i,r);if(r.expressionContext&&r.expressionContext.indexOf("cluster")===0){if(!Xs(i,["zoom","feature-state"]))return[new nr(r.key,r.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(r.expressionContext==="cluster-initial"&&!bs(i))return[new nr(r.key,r.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function D3(r,e){const i=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(e.valueSpec&&e.valueSpec.expression)for(const l of e.valueSpec.expression.parameters)i.delete(l);if(i.size===0)return[];const o=[];return r instanceof Ga&&i.has(r.name)?[new nr(e.key,e.value,`["${r.name}"] expression is not supported in a filter for a ${e.object.type} layer with id: ${e.object.id}`)]:(r.eachChild(l=>{o.push(...D3(l,e))}),o)}function Zv(r){const e=r.key,i=r.value,o=r.valueSpec,l=[];return Array.isArray(o.values)?o.values.indexOf(Sn(i))===-1&&l.push(new nr(e,i,`expected one of [${o.values.join(", ")}], ${JSON.stringify(i)} found`)):Object.keys(o.values).indexOf(Sn(i))===-1&&l.push(new nr(e,i,`expected one of [${Object.keys(o.values).join(", ")}], ${JSON.stringify(i)} found`)),l}function r2(r){if(r===!0||r===!1)return!0;if(!Array.isArray(r)||r.length===0)return!1;switch(r[0]){case"has":return r.length>=2&&r[1]!=="$id"&&r[1]!=="$type";case"in":return r.length>=3&&(typeof r[1]!="string"||Array.isArray(r[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return r.length!==3||Array.isArray(r[1])||Array.isArray(r[2]);case"any":case"all":for(const e of r.slice(1))if(!r2(e)&&typeof e!="boolean")return!1;return!0;default:return!0}}function Kv(r,e="fill"){if(r==null)return{filter:()=>!0,needGeometry:!1,needFeature:!1};r2(r)||(r=Yv(r));const i=r;let o=!0;try{o=function(v){if(!Op(v))return v;let x=aa(v);return z3(x),x=B3(x),x}(i)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
${JSON.stringify(i,null,2)}
        `)}const l=at[`filter_${e}`],u=Cf(o,l);let h=null;if(u.result==="error")throw new Error(u.value.map(v=>`${v.key}: ${v.message}`).join(", "));h=(v,x,w)=>u.value.evaluate(v,x,{},w);let m=null,_=null;if(o!==i){const v=Cf(i,l);if(v.result==="error")throw new Error(v.value.map(x=>`${x.key}: ${x.message}`).join(", "));m=(x,w,C,k,P)=>v.value.evaluate(x,w,{},C,void 0,void 0,k,P),_=!bs(v.value.expression)}return{filter:h,dynamicFilter:m||void 0,needGeometry:N3(o),needFeature:!!_}}function B3(r){if(!Array.isArray(r))return r;const e=function(i){if($$.has(i[0])){for(let o=1;o<i.length;o++)if(Op(i[o]))return!0}return i}(r);return e===!0?e:e.map(i=>B3(i))}function z3(r){let e=!1;const i=[];if(r[0]==="case"){for(let o=1;o<r.length-1;o+=2)e=e||Op(r[o]),i.push(r[o+1]);i.push(r[r.length-1])}else if(r[0]==="match"){e=e||Op(r[1]);for(let o=2;o<r.length-1;o+=2)i.push(r[o+1]);i.push(r[r.length-1])}else if(r[0]==="step"){e=e||Op(r[1]);for(let o=1;o<r.length-1;o+=2)i.push(r[o+1])}e&&(r.length=0,r.push("any",...i));for(let o=1;o<r.length;o++)z3(r[o])}function Op(r){if(!Array.isArray(r))return!1;if((e=r[0])==="pitch"||e==="distance-from-center")return!0;var e;for(let i=1;i<r.length;i++)if(Op(r[i]))return!0;return!1}const $$=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function V$(r,e){return r<e?-1:r>e?1:0}function N3(r){if(!Array.isArray(r))return!1;if(r[0]==="within"||r[0]==="distance")return!0;for(let e=1;e<r.length;e++)if(N3(r[e]))return!0;return!1}function Yv(r){if(!r)return!0;const e=r[0];return r.length<=1?e!=="any":e==="=="?n2(r[1],r[2],"=="):e==="!="?Jv(n2(r[1],r[2],"==")):e==="<"||e===">"||e==="<="||e===">="?n2(r[1],r[2],e):e==="any"?(i=r.slice(1),["any"].concat(i.map(Yv))):e==="all"?["all"].concat(r.slice(1).map(Yv)):e==="none"?["all"].concat(r.slice(1).map(Yv).map(Jv)):e==="in"?U3(r[1],r.slice(2)):e==="!in"?Jv(U3(r[1],r.slice(2))):e==="has"?$3(r[1]):e!=="!has"||Jv($3(r[1]));var i}function n2(r,e,i){switch(r){case"$type":return[`filter-type-${i}`,e];case"$id":return[`filter-id-${i}`,e];default:return[`filter-${i}`,r,e]}}function U3(r,e){if(e.length===0)return!1;switch(r){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some(i=>typeof i!=typeof e[0])?["filter-in-large",r,["literal",e.sort(V$)]]:["filter-in-small",r,["literal",e]]}}function $3(r){switch(r){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",r]}}function Jv(r){return["!",r]}function i2(r){return r2(aa(r.value))?ed(Nr({},r,{expressionContext:"filter",valueSpec:r.styleSpec[`filter_${r.layerType||"fill"}`]})):V3(r)}function V3(r){const e=r.value,i=r.key;if(ei(e)!=="array")return[new nr(i,e,`array expected, ${ei(e)} found`)];const o=r.styleSpec;let l,u=[];if(e.length<1)return[new nr(i,e,"filter array must have at least 1 element")];switch(u=u.concat(Zv({key:`${i}[0]`,value:e[0],valueSpec:o.filter_operator,style:r.style,styleSpec:r.styleSpec})),Sn(e[0])){case"<":case"<=":case">":case">=":e.length>=2&&Sn(e[1])==="$type"&&u.push(new nr(i,e,`"$type" cannot be use with operator "${e[0]}"`));case"==":case"!=":e.length!==3&&u.push(new nr(i,e,`filter array for operator "${e[0]}" must have 3 elements`));case"in":case"!in":e.length>=2&&(l=ei(e[1]),l!=="string"&&u.push(new nr(`${i}[1]`,e[1],`string expected, ${l} found`)));for(let h=2;h<e.length;h++)l=ei(e[h]),Sn(e[1])==="$type"?u=u.concat(Zv({key:`${i}[${h}]`,value:e[h],valueSpec:o.geometry_type,style:r.style,styleSpec:r.styleSpec})):l!=="string"&&l!=="number"&&l!=="boolean"&&u.push(new nr(`${i}[${h}]`,e[h],`string, number, or boolean expected, ${l} found`));break;case"any":case"all":case"none":for(let h=1;h<e.length;h++)u=u.concat(V3({key:`${i}[${h}]`,value:e[h],style:r.style,styleSpec:r.styleSpec}));break;case"has":case"!has":l=ei(e[1]),e.length!==2?u.push(new nr(i,e,`filter array for "${e[0]}" operator must have 2 elements`)):l!=="string"&&u.push(new nr(`${i}[1]`,e[1],`string expected, ${l} found`))}return u}function j3(r,e){const i=r.key,o=r.style,l=r.layer,u=r.styleSpec,h=r.value,m=r.objectKey,_=u[`${e}_${r.layerType}`];if(!_)return[];const v=m.match(/^(.*)-transition$/);if(e==="paint"&&v&&_[v[1]]&&_[v[1]].transition)return io({key:i,value:h,valueSpec:u.transition,style:o,styleSpec:u});const x=r.valueSpec||_[m];if(!x)return[new Kt(i,h,`unknown property "${m}"`)];let w;if(ei(h)==="string"&&Qh(x)&&!x.tokens&&(w=/^{([^}]+)}$/.exec(h))){const k=`\`{ "type": "identity", "property": ${w?JSON.stringify(w[1]):'"_"'} }\``;return[new nr(i,h,`"${m}" does not support interpolation syntax
Use an identity property function instead: ${k}.`)]}const C=[];if(r.layerType==="symbol")m!=="text-field"||!o||o.glyphs||o.imports||C.push(new nr(i,h,'use of "text-field" requires a style "glyphs" property')),m==="text-font"&&Hv(aa(h))&&Sn(h.type)==="identity"&&C.push(new nr(i,h,'"text-font" does not support identity functions'));else if(r.layerType==="model"&&e==="paint"&&l&&l.layout&&l.layout.hasOwnProperty("model-id")&&Qh(x)&&(M3(x)||Yw(x))){const k=t2(aa(h),x),P=k.value.expression||k.value._styleExpression.expression;P&&!Xs(P,["measure-light"])&&C.push(new nr(i,h,`${m} does not support measure-light expressions when the model layer source is vector tile or GeoJSON.`))}return C.concat(io({key:r.key,value:h,valueSpec:x,style:o,styleSpec:u,expressionContext:"property",propertyType:e,propertyKey:m}))}function W3(r){return j3(r,"paint")}function H3(r){return j3(r,"layout")}function G3(r){let e=[];const i=r.value,o=r.key,l=r.style,u=r.styleSpec;i.type||i.ref||e.push(new nr(o,i,'either "type" or "ref" is required'));let h=Sn(i.type);const m=Sn(i.ref);if(i.id){const _=Sn(i.id);for(let v=0;v<r.arrayIndex;v++){const x=l.layers[v];Sn(x.id)===_&&e.push(new nr(o,i.id,`duplicate layer id "${i.id}", previously used at line ${x.id.__line__}`))}}if("ref"in i){let _;["type","source","source-layer","filter","layout"].forEach(v=>{v in i&&e.push(new nr(o,i[v],`"${v}" is prohibited for ref layers`))}),l.layers.forEach(v=>{Sn(v.id)===m&&(_=v)}),_?_.ref?e.push(new nr(o,i.ref,"ref cannot reference another ref layer")):h=Sn(_.type):typeof m=="string"&&e.push(new nr(o,i.ref,`ref layer "${m}" not found`))}else if(h!=="background"&&h!=="sky"&&h!=="slot")if(i.source){const _=l.sources&&l.sources[i.source],v=_&&Sn(_.type);_?v==="vector"&&h==="raster"?e.push(new nr(o,i.source,`layer "${i.id}" requires a raster source`)):v==="raster"&&h!=="raster"?e.push(new nr(o,i.source,`layer "${i.id}" requires a vector source`)):v!=="vector"||i["source-layer"]?v==="raster-dem"&&h!=="hillshade"?e.push(new nr(o,i.source,"raster-dem source can only be used with layer type 'hillshade'.")):h!=="line"||!i.paint||!i.paint["line-gradient"]&&!i.paint["line-trim-offset"]||v==="geojson"&&_.lineMetrics||e.push(new nr(o,i,`layer "${i.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):e.push(new nr(o,i,`layer "${i.id}" must specify a "source-layer"`)):e.push(new nr(o,i.source,`source "${i.source}" not found`))}else e.push(new nr(o,i,'missing required property "source"'));return e=e.concat(dl({key:o,value:i,valueSpec:u.layer,style:r.style,styleSpec:r.styleSpec,objectElementValidators:{"*":()=>[],type:()=>io({key:`${o}.type`,value:i.type,valueSpec:u.layer.type,style:r.style,styleSpec:r.styleSpec,object:i,objectKey:"type"}),filter:_=>i2(Nr({layerType:h},_)),layout:_=>dl({layer:i,key:_.key,value:_.value,valueSpec:{},style:_.style,styleSpec:_.styleSpec,objectElementValidators:{"*":v=>H3(Nr({layerType:h},v))}}),paint:_=>dl({layer:i,key:_.key,value:_.value,valueSpec:{},style:_.style,styleSpec:_.styleSpec,objectElementValidators:{"*":v=>W3(Nr({layerType:h,layer:i},v))}})}})),e}function Rp(r){const e=r.value,i=r.key,o=ei(e);return o!=="string"?[new nr(i,e,`string expected, ${o} found`)]:[]}const q3={promoteId:function({key:r,value:e}){if(ei(e)==="string")return Rp({key:r,value:e});{const i=[];for(const o in e)i.push(...Rp({key:`${r}.${o}`,value:e[o]}));return i}}};function X3(r){const e=r.value,i=r.key,o=r.styleSpec,l=r.style;if(!e.type)return[new nr(i,e,'"type" is required')];const u=Sn(e.type);let h;switch(u){case"vector":case"raster":case"raster-dem":return h=dl({key:i,value:e,valueSpec:o[`source_${u.replace("-","_")}`],style:r.style,styleSpec:o,objectElementValidators:q3}),h;case"geojson":if(h=dl({key:i,value:e,valueSpec:o.source_geojson,style:l,styleSpec:o,objectElementValidators:q3}),e.cluster)for(const m in e.clusterProperties){const[_,v]=e.clusterProperties[m],x=typeof _=="string"?[_,["accumulated"],["get",m]]:_;h.push(...ed({key:`${i}.${m}.map`,value:v,expressionContext:"cluster-map"})),h.push(...ed({key:`${i}.${m}.reduce`,value:x,expressionContext:"cluster-reduce"}))}return h;case"video":return dl({key:i,value:e,valueSpec:o.source_video,style:l,styleSpec:o});case"image":return dl({key:i,value:e,valueSpec:o.source_image,style:l,styleSpec:o});case"canvas":return[new nr(i,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Zv({key:`${i}.type`,value:e.type,valueSpec:{values:j$(o)},style:l,styleSpec:o})}}function j$(r){return r.source.reduce((e,i)=>{const o=r[i];return o.type.type==="enum"&&(e=e.concat(Object.keys(o.type.values))),e},[])}function Z3(r){const e=r.value;let i=[];if(!e)return i;const o=ei(e);return o!=="string"?(i=i.concat([new nr(r.key,e,`string expected, "${o}" found`)]),i):(function(l){const u=l.indexOf("://")===-1;try{return new URL(l,u?"http://example.com":void 0),!0}catch{return!1}}(e)||(i=i.concat([new nr(r.key,e,`invalid url "${e}"`)])),i)}function K3(r){const e=r.value,i=r.styleSpec,o=i.light,l=r.style;let u=[];const h=ei(e);if(e===void 0)return u;if(h!=="object")return u=u.concat([new nr("light",e,`object expected, ${h} found`)]),u;for(const m in e){const _=m.match(/^(.*)-transition$/);u=u.concat(_&&o[_[1]]&&o[_[1]].transition?io({key:m,value:e[m],valueSpec:i.transition,style:l,styleSpec:i}):o[m]?io({key:m,value:e[m],valueSpec:o[m],style:l,styleSpec:i}):[new nr(m,e[m],`unknown property "${m}"`)])}return u}function Y3(r){const e=r.value;let i=[];if(!e)return i;const o=ei(e);if(o!=="object")return i=i.concat([new nr("light-3d",e,`object expected, ${o} found`)]),i;const l=r.styleSpec,u=l["light-3d"],h=r.key,m=r.style,_=r.style.lights;for(const w of["type","id"])if(!(w in e))return i=i.concat([new nr("light-3d",e,`missing property ${w} on light`)]),i;if(e.type&&_)for(let w=0;w<r.arrayIndex;w++){const C=Sn(e.type),k=_[w];Sn(k.type)===C&&i.push(new nr(h,e.id,`duplicate light type "${e.type}", previously defined at line ${k.id.__line__}`))}const v=`properties_light_${e.type}`;if(!(v in l))return i=i.concat([new nr("light-3d",e,`Invalid light type ${e.type}`)]),i;const x=l[v];for(const w in e)if(w==="properties"){const C=e[w],k=ei(C);if(k!=="object")return i=i.concat([new nr("properties",C,`object expected, ${k} found`)]),i;for(const P in C)i=i.concat(x[P]?io({key:P,value:C[P],valueSpec:x[P],style:m,styleSpec:l}):[new Kt(r.key,C[P],`unknown property "${P}"`)])}else{const C=w.match(/^(.*)-transition$/);i=i.concat(C&&u[C[1]]&&u[C[1]].transition?io({key:w,value:e[w],valueSpec:l.transition,style:m,styleSpec:l}):u[w]?io({key:w,value:e[w],valueSpec:u[w],style:m,styleSpec:l}):[new Kt(w,e[w],`unknown property "${w}"`)])}return i}function J3(r){const e=r.value,i=r.key,o=r.style,l=r.styleSpec,u=l.terrain;let h=[];const m=ei(e);if(e===void 0)return h;if(m!=="object")return h=h.concat([new nr("terrain",e,`object expected, ${m} found`)]),h;for(const _ in e){const v=_.match(/^(.*)-transition$/);h=h.concat(v&&u[v[1]]&&u[v[1]].transition?io({key:_,value:e[_],valueSpec:l.transition,style:o,styleSpec:l}):u[_]?io({key:_,value:e[_],valueSpec:u[_],style:o,styleSpec:l}):[new Kt(_,e[_],`unknown property "${_}"`)])}if(e.source){const _=o.sources&&o.sources[e.source],v=_&&Sn(_.type);_?v!=="raster-dem"&&h.push(new nr(i,e.source,`terrain cannot be used with a source of type ${String(v)}, it only be used with a "raster-dem" source type`)):h.push(new nr(i,e.source,`source "${e.source}" not found`))}else h.push(new nr(i,e,'terrain is missing required property "source"'));return h}function Q3(r){const e=r.value,i=r.style,o=r.styleSpec,l=o.fog;let u=[];const h=ei(e);if(e===void 0)return u;if(h!=="object")return u=u.concat([new nr("fog",e,`object expected, ${h} found`)]),u;for(const m in e){const _=m.match(/^(.*)-transition$/);u=u.concat(_&&l[_[1]]&&l[_[1]].transition?io({key:m,value:e[m],valueSpec:o.transition,style:i,styleSpec:o}):l[m]?io({key:m,value:e[m],valueSpec:l[m],style:i,styleSpec:o}):[new Kt(m,e[m],`unknown property "${m}"`)])}return u}const e4={"*":()=>[],array:O3,boolean:function(r){const e=r.value,i=r.key,o=ei(e);return o!=="boolean"?[new nr(i,e,`boolean expected, ${o} found`)]:[]},number:R3,color:function(r){const e=r.key,i=r.value,o=ei(i);return o!=="string"?[new nr(e,i,`color expected, ${o} found`)]:Pm(i)===null?[new nr(e,i,`color expected, "${i}" found`)]:[]},enum:Zv,filter:i2,function:L3,layer:G3,object:dl,source:X3,model:Z3,light:K3,"light-3d":Y3,terrain:J3,fog:Q3,string:Rp,formatted:function(r){return Rp(r).length===0?[]:ed(r)},resolvedImage:function(r){return Rp(r).length===0?[]:ed(r)},projection:function(r){const e=r.value,i=r.styleSpec,o=i.projection,l=r.style;let u=[];const h=ei(e);if(h==="object")for(const m in e)u=u.concat(io({key:m,value:e[m],valueSpec:o[m],style:l,styleSpec:i}));else h!=="string"&&(u=u.concat([new nr("projection",e,`object or string expected, ${h} found`)]));return u},import:function(r){const{value:e,styleSpec:i}=r,{data:o,...l}=e;Object.defineProperty(l,"__line__",{value:e.__line__,enumerable:!1});let u=dl(Nr({},r,{value:l,valueSpec:i.import}));return Sn(l.id)===""&&u.push(new nr(`${r.key}.id`,l,"import id can't be an empty string")),o&&(u=u.concat(t4(o,i,{key:`${r.key}.data`}))),u}};function io(r,e=!1){const i=r.value,o=r.valueSpec,l=r.styleSpec;if(o.expression&&Hv(Sn(i)))return L3(r);if(o.expression&&Gv(aa(i)))return ed(r);if(o.type&&e4[o.type]){const u=e4[o.type](r);return e===!0&&u.length>0&&ei(r.value)==="array"?ed(r):u}return dl(Nr({},r,{valueSpec:o.type?l[o.type]:o}))}function W$(r){const e=r.value,i=r.key,o=Rp(r);return o.length||(e.indexOf("{fontstack}")===-1&&o.push(new nr(i,e,'"glyphs" url must include a "{fontstack}" token')),e.indexOf("{range}")===-1&&o.push(new nr(i,e,'"glyphs" url must include a "{range}" token'))),o}function t4(r,e=at,i={}){return io({key:i.key||"",value:r,valueSpec:e.$root,styleSpec:e,style:r,objectElementValidators:{glyphs:W$,"*":()=>[]}})}function Lp(r,e=at){return Wl(t4(r,e))}const H$=r=>Wl(X3(r)),G$=r=>Wl(K3(r)),q$=r=>Wl(Y3(r)),X$=r=>Wl(J3(r)),Z$=r=>Wl(Q3(r)),K$=r=>Wl(G3(r)),a2=r=>Wl(i2(r)),Y$=r=>Wl(W3(r)),J$=r=>Wl(H3(r)),Q$=r=>Wl(Z3(r));function Wl(r){return r.slice().sort((e,i)=>e.line&&i.line?e.line-i.line:0)}function Qv(r,e){let i=!1;if(e&&e.length)for(const o of e)o instanceof Kt?se(o.message):(r.fire(new ar(new Error(o.message))),i=!0);return i}var eV=Oc,kf=3;function Oc(r,e,i){var o=this.cells=[];if(r instanceof ArrayBuffer){this.arrayBuffer=r;var l=new Int32Array(this.arrayBuffer);r=l[0],this.d=(e=l[1])+2*(i=l[2]);for(var u=0;u<this.d*this.d;u++){var h=l[kf+u],m=l[kf+u+1];o.push(h===m?null:l.subarray(h,m))}var _=l[kf+o.length+1];this.keys=l.subarray(l[kf+o.length],_),this.bboxes=l.subarray(_),this.insert=this._insertReadonly}else{this.d=e+2*i;for(var v=0;v<this.d*this.d;v++)o.push([]);this.keys=[],this.bboxes=[]}this.n=e,this.extent=r,this.padding=i,this.scale=e/r,this.uid=0;var x=i/e*r;this.min=-x,this.max=r+x}Oc.prototype.insert=function(r,e,i,o,l){this._forEachCell(e,i,o,l,this._insertCell,this.uid++),this.keys.push(r),this.bboxes.push(e),this.bboxes.push(i),this.bboxes.push(o),this.bboxes.push(l)},Oc.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},Oc.prototype._insertCell=function(r,e,i,o,l,u){this.cells[l].push(u)},Oc.prototype.query=function(r,e,i,o,l){var u=this.min,h=this.max;if(r<=u&&e<=u&&h<=i&&h<=o&&!l)return Array.prototype.slice.call(this.keys);var m=[];return this._forEachCell(r,e,i,o,this._queryCell,m,{},l),m},Oc.prototype._queryCell=function(r,e,i,o,l,u,h,m){var _=this.cells[l];if(_!==null)for(var v=this.keys,x=this.bboxes,w=0;w<_.length;w++){var C=_[w];if(h[C]===void 0){var k=4*C;(m?m(x[k+0],x[k+1],x[k+2],x[k+3]):r<=x[k+2]&&e<=x[k+3]&&i>=x[k+0]&&o>=x[k+1])?(h[C]=!0,u.push(v[C])):h[C]=!1}}},Oc.prototype._forEachCell=function(r,e,i,o,l,u,h,m){for(var _=this._convertToCellCoord(r),v=this._convertToCellCoord(e),x=this._convertToCellCoord(i),w=this._convertToCellCoord(o),C=_;C<=x;C++)for(var k=v;k<=w;k++){var P=this.d*k+C;if((!m||m(this._convertFromCellCoord(C),this._convertFromCellCoord(k),this._convertFromCellCoord(C+1),this._convertFromCellCoord(k+1)))&&l.call(this,r,e,i,o,P,u,h,m))return}},Oc.prototype._convertFromCellCoord=function(r){return(r-this.padding)/this.scale},Oc.prototype._convertToCellCoord=function(r){return Math.max(0,Math.min(this.d-1,Math.floor(r*this.scale)+this.padding))},Oc.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var r=this.cells,e=kf+this.cells.length+1+1,i=0,o=0;o<this.cells.length;o++)i+=this.cells[o].length;var l=new Int32Array(e+i+this.keys.length+this.bboxes.length);l[0]=this.extent,l[1]=this.n,l[2]=this.padding;for(var u=e,h=0;h<r.length;h++){var m=r[h];l[kf+h]=u,l.set(m,u),u+=m.length}return l[kf+r.length]=u,l.set(this.keys,u),l[kf+r.length+1]=u+=this.keys.length,l.set(this.bboxes,u),u+=this.bboxes.length,l.buffer};var Dp=O(eV);const e1={};function xr(r,e,i={}){Object.defineProperty(r,"_classRegistryKey",{value:e,writeable:!1}),e1[e]={klass:r,omit:i.omit||[]}}xr(Object,"Object"),Dp.serialize=function(r,e){const i=r.toArrayBuffer();return e&&e.add(i),{buffer:i}},Dp.deserialize=function(r){return new Dp(r.buffer)},Object.defineProperty(Dp,"name",{value:"Grid"}),xr(Dp,"Grid"),xr(hn,"Color"),xr(Error,"Error"),xr(lt,"AJAXError"),xr(es,"ResolvedImage"),xr(qv,"StylePropertyFunction"),xr(Qw,"StyleExpression",{omit:["_evaluator"]}),xr(Af,"ZoomDependentExpression"),xr(e2,"ZoomConstantExpression"),xr(Ga,"CompoundExpression",{omit:["_evaluate"]});for(const r in Vm)e1[Vm[r]._classRegistryKey]||xr(Vm[r],`Expression${r}`);function r4(r){return r&&typeof ArrayBuffer<"u"&&(r instanceof ArrayBuffer||r.constructor&&r.constructor.name==="ArrayBuffer")}function n4(r){return g.ImageBitmap&&r instanceof g.ImageBitmap}function Bp(r,e){if(r==null||typeof r=="boolean"||typeof r=="number"||typeof r=="string"||r instanceof Boolean||r instanceof Number||r instanceof String||r instanceof Date||r instanceof RegExp)return r;if(r4(r)||n4(r))return e&&e.add(r),r;if(ArrayBuffer.isView(r)){const i=r;return e&&e.add(i.buffer),i}if(r instanceof g.ImageData)return e&&e.add(r.data.buffer),r;if(Array.isArray(r)){const i=[];for(const o of r)i.push(Bp(o,e));return i}if(r instanceof Map){const i={$name:"Map"};for(const[o,l]of r.entries())i[o]=Bp(l);return i}if(typeof r=="object"){const i=r.constructor,o=i._classRegistryKey;if(!o)throw new Error(`can't serialize object of unregistered class ${o}`);const l=i.serialize?i.serialize(r,e):{};if(!i.serialize){for(const u in r)r.hasOwnProperty(u)&&(e1[o].omit.indexOf(u)>=0||(l[u]=Bp(r[u],e)));r instanceof Error&&(l.message=r.message)}if(l.$name)throw new Error("$name property is reserved for worker serialization logic.");return o!=="Object"&&(l.$name=o),l}throw new Error("can't serialize object of type "+typeof r)}function zp(r){if(r==null||typeof r=="boolean"||typeof r=="number"||typeof r=="string"||r instanceof Boolean||r instanceof Number||r instanceof String||r instanceof Date||r instanceof RegExp||r4(r)||n4(r)||ArrayBuffer.isView(r)||r instanceof g.ImageData)return r;if(Array.isArray(r))return r.map(zp);if(typeof r=="object"){const e=r.$name||"Object";if(e==="Map"){const l=new Map;for(const u of Object.keys(r))u!=="$name"&&l.set(u,zp(r[u]));return l}const{klass:i}=e1[e];if(!i)throw new Error(`can't deserialize unregistered class ${e}`);if(i.deserialize)return i.deserialize(r);const o=Object.create(i.prototype);for(const l of Object.keys(r))l!=="$name"&&(o[l]=zp(r[l]));return o}throw new Error("can't deserialize object of type "+typeof r)}const Ar={"Latin-1 Supplement":r=>r>=128&&r<=255,Arabic:r=>r>=1536&&r<=1791,"Arabic Supplement":r=>r>=1872&&r<=1919,"Arabic Extended-A":r=>r>=2208&&r<=2303,"Hangul Jamo":r=>r>=4352&&r<=4607,"Unified Canadian Aboriginal Syllabics":r=>r>=5120&&r<=5759,Khmer:r=>r>=6016&&r<=6143,"Unified Canadian Aboriginal Syllabics Extended":r=>r>=6320&&r<=6399,"General Punctuation":r=>r>=8192&&r<=8303,"Letterlike Symbols":r=>r>=8448&&r<=8527,"Number Forms":r=>r>=8528&&r<=8591,"Miscellaneous Technical":r=>r>=8960&&r<=9215,"Control Pictures":r=>r>=9216&&r<=9279,"Optical Character Recognition":r=>r>=9280&&r<=9311,"Enclosed Alphanumerics":r=>r>=9312&&r<=9471,"Geometric Shapes":r=>r>=9632&&r<=9727,"Miscellaneous Symbols":r=>r>=9728&&r<=9983,"Miscellaneous Symbols and Arrows":r=>r>=11008&&r<=11263,"CJK Radicals Supplement":r=>r>=11904&&r<=12031,"Kangxi Radicals":r=>r>=12032&&r<=12255,"Ideographic Description Characters":r=>r>=12272&&r<=12287,"CJK Symbols and Punctuation":r=>r>=12288&&r<=12351,Hiragana:r=>r>=12352&&r<=12447,Katakana:r=>r>=12448&&r<=12543,Bopomofo:r=>r>=12544&&r<=12591,"Hangul Compatibility Jamo":r=>r>=12592&&r<=12687,Kanbun:r=>r>=12688&&r<=12703,"Bopomofo Extended":r=>r>=12704&&r<=12735,"CJK Strokes":r=>r>=12736&&r<=12783,"Katakana Phonetic Extensions":r=>r>=12784&&r<=12799,"Enclosed CJK Letters and Months":r=>r>=12800&&r<=13055,"CJK Compatibility":r=>r>=13056&&r<=13311,"CJK Unified Ideographs Extension A":r=>r>=13312&&r<=19903,"Yijing Hexagram Symbols":r=>r>=19904&&r<=19967,"CJK Unified Ideographs":r=>r>=19968&&r<=40959,"Yi Syllables":r=>r>=40960&&r<=42127,"Yi Radicals":r=>r>=42128&&r<=42191,"Hangul Jamo Extended-A":r=>r>=43360&&r<=43391,"Hangul Syllables":r=>r>=44032&&r<=55215,"Hangul Jamo Extended-B":r=>r>=55216&&r<=55295,"Private Use Area":r=>r>=57344&&r<=63743,"CJK Compatibility Ideographs":r=>r>=63744&&r<=64255,"Arabic Presentation Forms-A":r=>r>=64336&&r<=65023,"Vertical Forms":r=>r>=65040&&r<=65055,"CJK Compatibility Forms":r=>r>=65072&&r<=65103,"Small Form Variants":r=>r>=65104&&r<=65135,"Arabic Presentation Forms-B":r=>r>=65136&&r<=65279,"Halfwidth and Fullwidth Forms":r=>r>=65280&&r<=65519,"CJK Unified Ideographs Extension B":r=>r>=131072&&r<=173791};function o2(r){for(const e of r)if(s2(e.charCodeAt(0)))return!0;return!1}function tV(r){for(const e of r)if(!rV(e.charCodeAt(0)))return!1;return!0}function rV(r){return!(Ar.Arabic(r)||Ar["Arabic Supplement"](r)||Ar["Arabic Extended-A"](r)||Ar["Arabic Presentation Forms-A"](r)||Ar["Arabic Presentation Forms-B"](r))}function s2(r){return!(r!==746&&r!==747&&(r<4352||!(Ar["Bopomofo Extended"](r)||Ar.Bopomofo(r)||Ar["CJK Compatibility Forms"](r)&&!(r>=65097&&r<=65103)||Ar["CJK Compatibility Ideographs"](r)||Ar["CJK Compatibility"](r)||Ar["CJK Radicals Supplement"](r)||Ar["CJK Strokes"](r)||!(!Ar["CJK Symbols and Punctuation"](r)||r>=12296&&r<=12305||r>=12308&&r<=12319||r===12336)||Ar["CJK Unified Ideographs Extension A"](r)||Ar["CJK Unified Ideographs"](r)||Ar["Enclosed CJK Letters and Months"](r)||Ar["Hangul Compatibility Jamo"](r)||Ar["Hangul Jamo Extended-A"](r)||Ar["Hangul Jamo Extended-B"](r)||Ar["Hangul Jamo"](r)||Ar["Hangul Syllables"](r)||Ar.Hiragana(r)||Ar["Ideographic Description Characters"](r)||Ar.Kanbun(r)||Ar["Kangxi Radicals"](r)||Ar["Katakana Phonetic Extensions"](r)||Ar.Katakana(r)&&r!==12540||!(!Ar["Halfwidth and Fullwidth Forms"](r)||r===65288||r===65289||r===65293||r>=65306&&r<=65310||r===65339||r===65341||r===65343||r>=65371&&r<=65503||r===65507||r>=65512&&r<=65519)||!(!Ar["Small Form Variants"](r)||r>=65112&&r<=65118||r>=65123&&r<=65126)||Ar["Unified Canadian Aboriginal Syllabics"](r)||Ar["Unified Canadian Aboriginal Syllabics Extended"](r)||Ar["Vertical Forms"](r)||Ar["Yijing Hexagram Symbols"](r)||Ar["Yi Syllables"](r)||Ar["Yi Radicals"](r))))}function i4(r){return!(s2(r)||function(e){return!!(Ar["Latin-1 Supplement"](e)&&(e===167||e===169||e===174||e===177||e===188||e===189||e===190||e===215||e===247)||Ar["General Punctuation"](e)&&(e===8214||e===8224||e===8225||e===8240||e===8241||e===8251||e===8252||e===8258||e===8263||e===8264||e===8265||e===8273)||Ar["Letterlike Symbols"](e)||Ar["Number Forms"](e)||Ar["Miscellaneous Technical"](e)&&(e>=8960&&e<=8967||e>=8972&&e<=8991||e>=8996&&e<=9e3||e===9003||e>=9085&&e<=9114||e>=9150&&e<=9165||e===9167||e>=9169&&e<=9179||e>=9186&&e<=9215)||Ar["Control Pictures"](e)&&e!==9251||Ar["Optical Character Recognition"](e)||Ar["Enclosed Alphanumerics"](e)||Ar["Geometric Shapes"](e)||Ar["Miscellaneous Symbols"](e)&&!(e>=9754&&e<=9759)||Ar["Miscellaneous Symbols and Arrows"](e)&&(e>=11026&&e<=11055||e>=11088&&e<=11097||e>=11192&&e<=11243)||Ar["CJK Symbols and Punctuation"](e)||Ar.Katakana(e)||Ar["Private Use Area"](e)||Ar["CJK Compatibility Forms"](e)||Ar["Small Form Variants"](e)||Ar["Halfwidth and Fullwidth Forms"](e)||e===8734||e===8756||e===8757||e>=9984&&e<=10087||e>=10102&&e<=10131||e===65532||e===65533)}(r))}function a4(r){return r>=1424&&r<=2303||Ar["Arabic Presentation Forms-A"](r)||Ar["Arabic Presentation Forms-B"](r)}function nV(r,e){return!(!e&&a4(r)||r>=2304&&r<=3583||r>=3840&&r<=4255||Ar.Khmer(r))}function iV(r){for(const e of r)if(a4(e.charCodeAt(0)))return!0;return!1}const l2="deferred",c2="loading",u2="loaded";let f2=null,ws="unavailable",If=null;const o4=function(r){r&&typeof r=="string"&&r.indexOf("NetworkError")>-1&&(ws="error"),f2&&f2(r)};function h2(){d2.fire(new _t("pluginStateChange",{pluginStatus:ws,pluginURL:If}))}const d2=new Ln,p2=function(){return ws},s4=function(){if(ws!==l2||!If)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");ws=c2,h2(),If&&qt({url:If},r=>{r?o4(r):(ws=u2,h2())})},pl={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>ws===u2||pl.applyArabicShaping!=null,isLoading:()=>ws===c2,setState(r){ws=r.pluginStatus,If=r.pluginURL},isParsed:()=>pl.applyArabicShaping!=null&&pl.processBidirectionalText!=null&&pl.processStyledBidirectionalText!=null,getPluginURL:()=>If};class Gi{constructor(e,i){this.zoom=e,i?(this.now=i.now,this.fadeDuration=i.fadeDuration,this.transition=i.transition,this.pitch=i.pitch,this.brightness=i.brightness):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0,this.brightness=0)}isSupportedScript(e){return function(i,o){for(const l of i)if(!nV(l.charCodeAt(0),o))return!1;return!0}(e,pl.isLoaded())}}class t1{constructor(e,i,o){this.property=e,this.value=i,this.expression=function(l,u,h){if(Hv(l))return new qv(l,u);if(Gv(l)||Array.isArray(l)&&l.length>0){const m=t2(l,u,h);if(m.result==="error")throw new Error(m.value.map(_=>`${_.key}: ${_.message}`).join(", "));return m.value}{let m=l;return typeof l=="string"&&u.type==="color"&&(m=hn.parse(l)),{kind:"constant",isConfigDependent:!1,evaluate:()=>m}}}(i===void 0?e.specification.default:i,e.specification,o)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(e,i,o){return this.property.possiblyEvaluate(this,e,i,o)}}class m2{constructor(e,i){this.property=e,this.value=new t1(e,void 0,i)}transitioned(e,i){return new l4(this.property,this.value,i,ze({},e.transition,this.transition),e.now)}untransitioned(){return new l4(this.property,this.value,null,{},0)}}class Wm{constructor(e,i){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues),this._options=i,this.isConfigDependent=!1}getValue(e){return G(this._values[e].value.value)}setValue(e,i){this._values.hasOwnProperty(e)||(this._values[e]=new m2(this._values[e].property,this._options)),this._values[e].value=new t1(this._values[e].property,i===null?void 0:G(i),this._options),this.isConfigDependent=this.isConfigDependent||this._values[e].value.expression.isConfigDependent}setTransitionOrValue(e,i){i&&(this._options=i);const o=this._properties.properties;if(e)for(const l in e){const u=e[l];if(X(l,"-transition")){const h=l.slice(0,-11);o[h]&&this.setTransition(h,u)}else o[l]&&this.setValue(l,u)}}getTransition(e){return G(this._values[e].transition)}setTransition(e,i){this._values.hasOwnProperty(e)||(this._values[e]=new m2(this._values[e].property)),this._values[e].transition=G(i)||void 0}serialize(){const e={};for(const i of Object.keys(this._values)){const o=this.getValue(i);o!==void 0&&(e[i]=o);const l=this.getTransition(i);l!==void 0&&(e[`${i}-transition`]=l)}return e}transitioned(e,i){const o=new c4(this._properties);for(const l of Object.keys(this._values))o._values[l]=this._values[l].transitioned(e,i._values[l]);return o}untransitioned(){const e=new c4(this._properties);for(const i of Object.keys(this._values))e._values[i]=this._values[i].untransitioned();return e}}class l4{constructor(e,i,o,l,u){const h=l.delay||0,m=l.duration||0;u=u||0,this.property=e,this.value=i,this.begin=u+h,this.end=this.begin+m,e.specification.transition&&(l.delay||l.duration)&&(this.prior=o)}possiblyEvaluate(e,i,o){const l=e.now||0,u=this.value.possiblyEvaluate(e,i,o),h=this.prior;if(h){if(l>this.end)return this.prior=null,u;if(this.value.isDataDriven())return this.prior=null,u;if(l<this.begin)return h.possiblyEvaluate(e,i,o);{const m=(l-this.begin)/(this.end-this.begin);return this.property.interpolate(h.possiblyEvaluate(e,i,o),u,Ye(m))}}return u}}class c4{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)}possiblyEvaluate(e,i,o){const l=new Hm(this._properties);for(const u of Object.keys(this._values))l._values[u]=this._values[u].possiblyEvaluate(e,i,o);return l}hasTransition(){for(const e of Object.keys(this._values))if(this._values[e].prior)return!0;return!1}}class aV{constructor(e,i){this._properties=e,this._values=Object.create(e.defaultPropertyValues),this._options=i,this.isConfigDependent=!1}getValue(e){return G(this._values[e].value)}setValue(e,i){this._values[e]=new t1(this._values[e].property,i===null?void 0:G(i),this._options),this.isConfigDependent=this.isConfigDependent||this._values[e].expression.isConfigDependent}serialize(){const e={};for(const i of Object.keys(this._values)){const o=this.getValue(i);o!==void 0&&(e[i]=o)}return e}possiblyEvaluate(e,i,o){const l=new Hm(this._properties);for(const u of Object.keys(this._values))l._values[u]=this._values[u].possiblyEvaluate(e,i,o);return l}}class Np{constructor(e,i,o){this.property=e,this.value=i,this.parameters=o}isConstant(){return this.value.kind==="constant"}constantOr(e){return this.value.kind==="constant"?this.value.value:e}evaluate(e,i,o,l){return this.property.evaluate(this.value,this.parameters,e,i,o,l)}}class Hm{constructor(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)}get(e){return this._values[e]}}class Yt{constructor(e){this.specification=e}possiblyEvaluate(e,i){return e.expression.evaluate(i)}interpolate(e,i,o){const l=$v[this.specification.type];return l?l(e,i,o):e}}class Pr{constructor(e,i){this.specification=e,this.overrides=i}possiblyEvaluate(e,i,o,l){return new Np(this,e.expression.kind==="constant"||e.expression.kind==="camera"?{kind:"constant",value:e.expression.evaluate(i,null,{},o,l)}:e.expression,i)}interpolate(e,i,o){if(e.value.kind!=="constant"||i.value.kind!=="constant")return e;if(e.value.value===void 0||i.value.value===void 0)return new Np(this,{kind:"constant",value:void 0},e.parameters);const l=$v[this.specification.type];return l?new Np(this,{kind:"constant",value:l(e.value.value,i.value.value,o)},e.parameters):e}evaluate(e,i,o,l,u,h){return e.kind==="constant"?e.value:e.evaluate(i,o,l,u,h)}}class Gm{constructor(e){this.specification=e}possiblyEvaluate(e,i,o,l){return!!e.expression.evaluate(i,null,{},o,l)}interpolate(){return!1}}class sa{constructor(e){this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const i=new Gi(0,{});for(const o in e){const l=e[o];l.specification.overridable&&this.overridableProperties.push(o);const u=this.defaultPropertyValues[o]=new t1(l,void 0),h=this.defaultTransitionablePropertyValues[o]=new m2(l);this.defaultTransitioningPropertyValues[o]=h.untransitioned(),this.defaultPossiblyEvaluatedValues[o]=u.possiblyEvaluate(i)}}}function To(r,e){return e?`${r}${e}`:r}function g2(r){const e=r.indexOf("");return e>=0?r.slice(0,e):r}xr(Pr,"DataDrivenProperty"),xr(Yt,"DataConstantProperty"),xr(Gm,"ColorRampProperty");const u4="-transition";class Zs extends Ln{constructor(e,i,o){if(super(),this.id=e.id,this.type=e.type,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,this.isConfigDependent=!1,e.type!=="custom"&&(this.metadata=e.metadata,this.minzoom=e.minzoom,this.maxzoom=e.maxzoom,e.type!=="background"&&e.type!=="sky"&&e.type!=="slot"&&(this.source=e.source,this.sourceLayer=e["source-layer"],this.filter=e.filter),this.options=o,e.slot&&(this.slot=e.slot),i.layout&&(this._unevaluatedLayout=new aV(i.layout,o),this.isConfigDependent=this.isConfigDependent||this._unevaluatedLayout.isConfigDependent),i.paint)){this._transitionablePaint=new Wm(i.paint,o);for(const l in e.paint)this.setPaintProperty(l,e.paint[l],{validate:!1});for(const l in e.layout)this.setLayoutProperty(l,e.layout[l],{validate:!1});this.isConfigDependent=this.isConfigDependent||this._transitionablePaint.isConfigDependent,this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Hm(i.paint)}}setScope(e){this.scope=e,this.fqid=To(this.id,e)}getLayoutProperty(e){return e==="visibility"?this.visibility:this._unevaluatedLayout.getValue(e)}setLayoutProperty(e,i,o={}){if(i!=null&&this._validate(J$,`layers.${this.id}.layout.${e}`,e,i,o))return;if(this.type==="custom"&&e==="visibility")return void(this.visibility=i);const l=this._unevaluatedLayout;l._properties.properties[e]&&(l.setValue(e,i),this.isConfigDependent=this.isConfigDependent||l.isConfigDependent,e==="visibility"&&this.possiblyEvaluateVisibility())}possiblyEvaluateVisibility(){this.visibility=this._unevaluatedLayout._values.visibility.possiblyEvaluate({zoom:0})}getPaintProperty(e){return X(e,u4)?this._transitionablePaint.getTransition(e.slice(0,-11)):this._transitionablePaint.getValue(e)}setPaintProperty(e,i,o={}){if(i!=null&&this._validate(Y$,`layers.${this.id}.paint.${e}`,e,i,o))return!1;const l=this._transitionablePaint,u=l._properties.properties;if(X(e,u4)){const C=e.slice(0,-11);return u[C]&&l.setTransition(C,i||void 0),!1}if(!u[e])return!1;const h=l._values[e],m=h.value.isDataDriven(),_=h.value;l.setValue(e,i),this.isConfigDependent=this.isConfigDependent||l.isConfigDependent,this._handleSpecialPaintPropertyUpdate(e);const v=l._values[e].value,x=v.isDataDriven(),w=X(e,"pattern")||e==="line-dasharray";return x||m||w||this._handleOverridablePaintPropertyUpdate(e,_,v)}_handleSpecialPaintPropertyUpdate(e){}getProgramIds(){return null}getDefaultProgramParams(e,i){return null}_handleOverridablePaintPropertyUpdate(e,i,o){return!1}isHidden(e){return!!(this.minzoom&&e<this.minzoom)||!!(this.maxzoom&&e>=this.maxzoom)||this.visibility==="none"}updateTransitions(e){this._transitioningPaint=this._transitionablePaint.transitioned(e,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(e,i){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(e,void 0,i)),this.paint=this._transitioningPaint.possiblyEvaluate(e,void 0,i)}serialize(){return he({id:this.id,type:this.type,slot:this.slot,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()},(e,i)=>!(e===void 0||i==="layout"&&!Object.keys(e).length||i==="paint"&&!Object.keys(e).length))}_validate(e,i,o,l,u={}){return(!u||u.validate!==!1)&&Qv(this,e.call(Lp,{key:i,layerType:this.type,objectKey:o,value:l,styleSpec:at,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}hasShadowPass(){return!1}canCastShadows(){return!1}hasLightBeamPass(){return!1}cutoffRange(){return 0}resize(){}isStateDependent(){for(const e in this.paint._values){const i=this.paint.get(e);if(i instanceof Np&&Qh(i.property.specification)&&(i.value.kind==="source"||i.value.kind==="composite")&&i.value.isStateDependent)return!0}return!1}compileFilter(){this._filterCompiled||(this._featureFilter=Kv(this.filter),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}}class oV{constructor(){this.changed=!1,this._updatedLayers={},this._removedLayers={},this.updatedSourceCaches={},this.updatedPaintProps=new Set,this.changedImages=new Set}updateLayer(e){const i=e.scope;this._updatedLayers[i]=this._updatedLayers[i]||new Set,this._updatedLayers[i].add(e.id)}removeLayer(e){const i=e.scope;this._removedLayers[i]=this._removedLayers[i]||{},this._updatedLayers[i]=this._updatedLayers[i]||new Set,this._removedLayers[i][e.id]=e,this._updatedLayers[i].delete(e.id),this.updatedPaintProps.delete(e.fqid)}getRemovedLayer(e){return this._removedLayers[e.scope]?this._removedLayers[e.scope][e.id]:null}discardLayerRemoval(e){this._removedLayers[e.scope]&&delete this._removedLayers[e.scope][e.id]}getLayerUpdatesByScope(){const e={};for(const i in this._updatedLayers)e[i]=e[i]||{},e[i].updatedIds=Array.from(this._updatedLayers[i].values());for(const i in this._removedLayers)e[i]=e[i]||{},e[i].removedIds=Object.keys(this._removedLayers[i]);return e}reset(){this.changed=!1,this._updatedLayers={},this._removedLayers={},this.updatedSourceCaches={},this.updatedPaintProps.clear(),this.changedImages.clear()}}const sV={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class r1{constructor(e,i){this._structArray=e,this._pos1=i*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class qi{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(e,i){return e._trim(),i&&(e.isTransferred=!0,i.add(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}}static deserialize(e){const i=Object.create(this.prototype);return i.arrayBuffer=e.arrayBuffer,i.length=e.length,i.capacity=e.arrayBuffer.byteLength/i.bytesPerElement,i._refreshViews(),i}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(e){this.reserve(e),this.length=e}reserve(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const i=this.uint8;this._refreshViews(),i&&this.uint8.set(i)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function Zn(r,e=1){let i=0,o=0;return{members:r.map(l=>{const u=sV[l.type].BYTES_PER_ELEMENT,h=i=f4(i,Math.max(e,u)),m=l.components||1;return o=Math.max(o,u),i+=u*m,{name:l.name,type:l.type,components:m,offset:h}}),size:f4(i,Math.max(o,e)),alignment:e}}function f4(r,e){return Math.ceil(r/e)*e}class Es extends qi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i){const o=this.length;return this.resize(o+1),this.emplace(o,e,i)}emplace(e,i,o){const l=2*e;return this.int16[l+0]=i,this.int16[l+1]=o,e}}Es.prototype.bytesPerElement=4,xr(Es,"StructArrayLayout2i4");class n1 extends qi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,o){const l=this.length;return this.resize(l+1),this.emplace(l,e,i,o)}emplace(e,i,o,l){const u=3*e;return this.int16[u+0]=i,this.int16[u+1]=o,this.int16[u+2]=l,e}}n1.prototype.bytesPerElement=6,xr(n1,"StructArrayLayout3i6");class td extends qi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,o,l){const u=this.length;return this.resize(u+1),this.emplace(u,e,i,o,l)}emplace(e,i,o,l,u){const h=4*e;return this.int16[h+0]=i,this.int16[h+1]=o,this.int16[h+2]=l,this.int16[h+3]=u,e}}td.prototype.bytesPerElement=8,xr(td,"StructArrayLayout4i8");class _2 extends qi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,o,l,u){const h=this.length;return this.resize(h+1),this.emplace(h,e,i,o,l,u)}emplace(e,i,o,l,u,h){const m=5*e;return this.int16[m+0]=i,this.int16[m+1]=o,this.int16[m+2]=l,this.int16[m+3]=u,this.int16[m+4]=h,e}}_2.prototype.bytesPerElement=10,xr(_2,"StructArrayLayout5i10");class v2 extends qi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,o,l,u,h,m){const _=this.length;return this.resize(_+1),this.emplace(_,e,i,o,l,u,h,m)}emplace(e,i,o,l,u,h,m,_){const v=6*e,x=12*e,w=3*e;return this.int16[v+0]=i,this.int16[v+1]=o,this.uint8[x+4]=l,this.uint8[x+5]=u,this.uint8[x+6]=h,this.uint8[x+7]=m,this.float32[w+2]=_,e}}v2.prototype.bytesPerElement=12,xr(v2,"StructArrayLayout2i4ub1f12");class Mf extends qi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,o,l){const u=this.length;return this.resize(u+1),this.emplace(u,e,i,o,l)}emplace(e,i,o,l,u){const h=4*e;return this.float32[h+0]=i,this.float32[h+1]=o,this.float32[h+2]=l,this.float32[h+3]=u,e}}Mf.prototype.bytesPerElement=16,xr(Mf,"StructArrayLayout4f16");class Ff extends qi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,o,l,u){const h=this.length;return this.resize(h+1),this.emplace(h,e,i,o,l,u)}emplace(e,i,o,l,u,h){const m=6*e,_=3*e;return this.uint16[m+0]=i,this.uint16[m+1]=o,this.uint16[m+2]=l,this.uint16[m+3]=u,this.float32[_+2]=h,e}}Ff.prototype.bytesPerElement=12,xr(Ff,"StructArrayLayout4ui1f12");class i1 extends qi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i,o,l){const u=this.length;return this.resize(u+1),this.emplace(u,e,i,o,l)}emplace(e,i,o,l,u){const h=4*e;return this.uint16[h+0]=i,this.uint16[h+1]=o,this.uint16[h+2]=l,this.uint16[h+3]=u,e}}i1.prototype.bytesPerElement=8,xr(i1,"StructArrayLayout4ui8");class a1 extends qi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,o,l,u,h){const m=this.length;return this.resize(m+1),this.emplace(m,e,i,o,l,u,h)}emplace(e,i,o,l,u,h,m){const _=6*e;return this.int16[_+0]=i,this.int16[_+1]=o,this.int16[_+2]=l,this.int16[_+3]=u,this.int16[_+4]=h,this.int16[_+5]=m,e}}a1.prototype.bytesPerElement=12,xr(a1,"StructArrayLayout6i12");class y2 extends qi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i,o,l,u,h,m,_,v,x,w,C){const k=this.length;return this.resize(k+1),this.emplace(k,e,i,o,l,u,h,m,_,v,x,w,C)}emplace(e,i,o,l,u,h,m,_,v,x,w,C,k){const P=12*e;return this.int16[P+0]=i,this.int16[P+1]=o,this.int16[P+2]=l,this.int16[P+3]=u,this.uint16[P+4]=h,this.uint16[P+5]=m,this.uint16[P+6]=_,this.uint16[P+7]=v,this.int16[P+8]=x,this.int16[P+9]=w,this.int16[P+10]=C,this.int16[P+11]=k,e}}y2.prototype.bytesPerElement=24,xr(y2,"StructArrayLayout4i4ui4i24");class x2 extends qi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,o,l,u,h){const m=this.length;return this.resize(m+1),this.emplace(m,e,i,o,l,u,h)}emplace(e,i,o,l,u,h,m){const _=10*e,v=5*e;return this.int16[_+0]=i,this.int16[_+1]=o,this.int16[_+2]=l,this.float32[v+2]=u,this.float32[v+3]=h,this.float32[v+4]=m,e}}x2.prototype.bytesPerElement=20,xr(x2,"StructArrayLayout3i3f20");class b2 extends qi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e){const i=this.length;return this.resize(i+1),this.emplace(i,e)}emplace(e,i){return this.uint32[1*e+0]=i,e}}b2.prototype.bytesPerElement=4,xr(b2,"StructArrayLayout1ul4");class Pf extends qi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i){const o=this.length;return this.resize(o+1),this.emplace(o,e,i)}emplace(e,i,o){const l=2*e;return this.uint16[l+0]=i,this.uint16[l+1]=o,e}}Pf.prototype.bytesPerElement=4,xr(Pf,"StructArrayLayout2ui4");class w2 extends qi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i,o,l,u,h,m,_,v,x,w,C,k){const P=this.length;return this.resize(P+1),this.emplace(P,e,i,o,l,u,h,m,_,v,x,w,C,k)}emplace(e,i,o,l,u,h,m,_,v,x,w,C,k,P){const R=20*e,z=10*e;return this.int16[R+0]=i,this.int16[R+1]=o,this.int16[R+2]=l,this.int16[R+3]=u,this.int16[R+4]=h,this.float32[z+3]=m,this.float32[z+4]=_,this.float32[z+5]=v,this.float32[z+6]=x,this.int16[R+14]=w,this.uint32[z+8]=C,this.uint16[R+18]=k,this.uint16[R+19]=P,e}}w2.prototype.bytesPerElement=40,xr(w2,"StructArrayLayout5i4f1i1ul2ui40");class o1 extends qi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,o,l,u,h,m){const _=this.length;return this.resize(_+1),this.emplace(_,e,i,o,l,u,h,m)}emplace(e,i,o,l,u,h,m,_){const v=8*e;return this.int16[v+0]=i,this.int16[v+1]=o,this.int16[v+2]=l,this.int16[v+4]=u,this.int16[v+5]=h,this.int16[v+6]=m,this.int16[v+7]=_,e}}o1.prototype.bytesPerElement=16,xr(o1,"StructArrayLayout3i2i2i16");class E2 extends qi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,o,l,u){const h=this.length;return this.resize(h+1),this.emplace(h,e,i,o,l,u)}emplace(e,i,o,l,u,h){const m=4*e,_=8*e;return this.float32[m+0]=i,this.float32[m+1]=o,this.float32[m+2]=l,this.int16[_+6]=u,this.int16[_+7]=h,e}}E2.prototype.bytesPerElement=16,xr(E2,"StructArrayLayout2f1f2i16");class T2 extends qi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,o,l){const u=this.length;return this.resize(u+1),this.emplace(u,e,i,o,l)}emplace(e,i,o,l,u){const h=12*e,m=3*e;return this.uint8[h+0]=i,this.uint8[h+1]=o,this.float32[m+1]=l,this.float32[m+2]=u,e}}T2.prototype.bytesPerElement=12,xr(T2,"StructArrayLayout2ub2f12");class Of extends qi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,o){const l=this.length;return this.resize(l+1),this.emplace(l,e,i,o)}emplace(e,i,o,l){const u=3*e;return this.float32[u+0]=i,this.float32[u+1]=o,this.float32[u+2]=l,e}}Of.prototype.bytesPerElement=12,xr(Of,"StructArrayLayout3f12");class Oa extends qi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i,o){const l=this.length;return this.resize(l+1),this.emplace(l,e,i,o)}emplace(e,i,o,l){const u=3*e;return this.uint16[u+0]=i,this.uint16[u+1]=o,this.uint16[u+2]=l,e}}Oa.prototype.bytesPerElement=6,xr(Oa,"StructArrayLayout3ui6");class S2 extends qi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e,i,o,l,u,h,m,_,v,x,w,C,k,P,R,z,B,H,Z,Y,q){const ee=this.length;return this.resize(ee+1),this.emplace(ee,e,i,o,l,u,h,m,_,v,x,w,C,k,P,R,z,B,H,Z,Y,q)}emplace(e,i,o,l,u,h,m,_,v,x,w,C,k,P,R,z,B,H,Z,Y,q,ee){const ce=30*e,de=15*e,ge=60*e;return this.int16[ce+0]=i,this.int16[ce+1]=o,this.int16[ce+2]=l,this.float32[de+2]=u,this.float32[de+3]=h,this.uint16[ce+8]=m,this.uint16[ce+9]=_,this.uint32[de+5]=v,this.uint32[de+6]=x,this.uint32[de+7]=w,this.uint16[ce+16]=C,this.uint16[ce+17]=k,this.uint16[ce+18]=P,this.float32[de+10]=R,this.float32[de+11]=z,this.uint8[ge+48]=B,this.uint8[ge+49]=H,this.uint8[ge+50]=Z,this.uint32[de+13]=Y,this.int16[ce+28]=q,this.uint8[ge+58]=ee,e}}S2.prototype.bytesPerElement=60,xr(S2,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class C2 extends qi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e,i,o,l,u,h,m,_,v,x,w,C,k,P,R,z,B,H,Z,Y,q,ee,ce,de,ge,ve,Re,ke,$e,Ie,Qe,st){const ft=this.length;return this.resize(ft+1),this.emplace(ft,e,i,o,l,u,h,m,_,v,x,w,C,k,P,R,z,B,H,Z,Y,q,ee,ce,de,ge,ve,Re,ke,$e,Ie,Qe,st)}emplace(e,i,o,l,u,h,m,_,v,x,w,C,k,P,R,z,B,H,Z,Y,q,ee,ce,de,ge,ve,Re,ke,$e,Ie,Qe,st,ft){const Je=20*e,tt=40*e,pt=80*e;return this.float32[Je+0]=i,this.float32[Je+1]=o,this.int16[tt+4]=l,this.int16[tt+5]=u,this.int16[tt+6]=h,this.int16[tt+7]=m,this.int16[tt+8]=_,this.int16[tt+9]=v,this.int16[tt+10]=x,this.int16[tt+11]=w,this.int16[tt+12]=C,this.uint16[tt+13]=k,this.uint16[tt+14]=P,this.uint16[tt+15]=R,this.uint16[tt+16]=z,this.uint16[tt+17]=B,this.uint16[tt+18]=H,this.uint16[tt+19]=Z,this.uint16[tt+20]=Y,this.uint16[tt+21]=q,this.uint16[tt+22]=ee,this.uint16[tt+23]=ce,this.uint16[tt+24]=de,this.uint16[tt+25]=ge,this.uint16[tt+26]=ve,this.uint16[tt+27]=Re,this.uint32[Je+14]=ke,this.float32[Je+15]=$e,this.float32[Je+16]=Ie,this.float32[Je+17]=Qe,this.float32[Je+18]=st,this.uint8[pt+76]=ft,e}}C2.prototype.bytesPerElement=80,xr(C2,"StructArrayLayout2f9i15ui1ul4f1ub80");class qm extends qi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e){const i=this.length;return this.resize(i+1),this.emplace(i,e)}emplace(e,i){return this.float32[1*e+0]=i,e}}qm.prototype.bytesPerElement=4,xr(qm,"StructArrayLayout1f4");class rd extends qi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,o,l,u){const h=this.length;return this.resize(h+1),this.emplace(h,e,i,o,l,u)}emplace(e,i,o,l,u,h){const m=5*e;return this.float32[m+0]=i,this.float32[m+1]=o,this.float32[m+2]=l,this.float32[m+3]=u,this.float32[m+4]=h,e}}rd.prototype.bytesPerElement=20,xr(rd,"StructArrayLayout5f20");class A2 extends qi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,o,l,u,h,m){const _=this.length;return this.resize(_+1),this.emplace(_,e,i,o,l,u,h,m)}emplace(e,i,o,l,u,h,m,_){const v=7*e;return this.float32[v+0]=i,this.float32[v+1]=o,this.float32[v+2]=l,this.float32[v+3]=u,this.float32[v+4]=h,this.float32[v+5]=m,this.float32[v+6]=_,e}}A2.prototype.bytesPerElement=28,xr(A2,"StructArrayLayout7f28");class k2 extends qi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i,o,l){const u=this.length;return this.resize(u+1),this.emplace(u,e,i,o,l)}emplace(e,i,o,l,u){const h=6*e;return this.uint32[3*e+0]=i,this.uint16[h+2]=o,this.uint16[h+3]=l,this.uint16[h+4]=u,e}}k2.prototype.bytesPerElement=12,xr(k2,"StructArrayLayout1ul3ui12");class Xm extends qi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e){const i=this.length;return this.resize(i+1),this.emplace(i,e)}emplace(e,i){return this.uint16[1*e+0]=i,e}}Xm.prototype.bytesPerElement=2,xr(Xm,"StructArrayLayout1ui2");class Zm extends qi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i){const o=this.length;return this.resize(o+1),this.emplace(o,e,i)}emplace(e,i,o){const l=2*e;return this.float32[l+0]=i,this.float32[l+1]=o,e}}Zm.prototype.bytesPerElement=8,xr(Zm,"StructArrayLayout2f8");class I2 extends qi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,o,l,u,h,m,_,v,x,w,C,k,P,R,z){const B=this.length;return this.resize(B+1),this.emplace(B,e,i,o,l,u,h,m,_,v,x,w,C,k,P,R,z)}emplace(e,i,o,l,u,h,m,_,v,x,w,C,k,P,R,z,B){const H=16*e;return this.float32[H+0]=i,this.float32[H+1]=o,this.float32[H+2]=l,this.float32[H+3]=u,this.float32[H+4]=h,this.float32[H+5]=m,this.float32[H+6]=_,this.float32[H+7]=v,this.float32[H+8]=x,this.float32[H+9]=w,this.float32[H+10]=C,this.float32[H+11]=k,this.float32[H+12]=P,this.float32[H+13]=R,this.float32[H+14]=z,this.float32[H+15]=B,e}}I2.prototype.bytesPerElement=64,xr(I2,"StructArrayLayout16f64");class s1 extends qi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,o,l,u,h,m){const _=this.length;return this.resize(_+1),this.emplace(_,e,i,o,l,u,h,m)}emplace(e,i,o,l,u,h,m,_){const v=10*e,x=5*e;return this.uint16[v+0]=i,this.uint16[v+1]=o,this.uint16[v+2]=l,this.uint16[v+3]=u,this.float32[x+2]=h,this.float32[x+3]=m,this.float32[x+4]=_,e}}s1.prototype.bytesPerElement=20,xr(s1,"StructArrayLayout4ui3f20");class M2 extends qi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer)}emplaceBack(e){const i=this.length;return this.resize(i+1),this.emplace(i,e)}emplace(e,i){return this.uint8[1*e+0]=i,e}}M2.prototype.bytesPerElement=1,xr(M2,"StructArrayLayout1ub1");class h4 extends r1{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}h4.prototype.size=40;class F2 extends w2{get(e){return new h4(this,e)}}xr(F2,"CollisionBoxArray");class d4 extends r1{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(e){this._structArray.uint8[this._pos1+49]=e}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(e){this._structArray.uint8[this._pos1+50]=e}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(e){this._structArray.uint32[this._pos4+13]=e}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(e){this._structArray.uint8[this._pos1+58]=e}}d4.prototype.size=60;class p4 extends S2{get(e){return new d4(this,e)}}xr(p4,"PlacedSymbolArray");class m4 extends r1{get tileAnchorX(){return this._structArray.float32[this._pos4+0]}get tileAnchorY(){return this._structArray.float32[this._pos4+1]}get projectedAnchorX(){return this._structArray.int16[this._pos2+4]}get projectedAnchorY(){return this._structArray.int16[this._pos2+5]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+6]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+7]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+11]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get key(){return this._structArray.uint16[this._pos2+13]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+14]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+15]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+17]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+19]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+21]}get featureIndex(){return this._structArray.uint16[this._pos2+22]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+23]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numIconVertices(){return this._structArray.uint16[this._pos2+25]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+26]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+27]}get crossTileID(){return this._structArray.uint32[this._pos4+14]}set crossTileID(e){this._structArray.uint32[this._pos4+14]=e}get textOffset0(){return this._structArray.float32[this._pos4+15]}get textOffset1(){return this._structArray.float32[this._pos4+16]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+17]}get zOffset(){return this._structArray.float32[this._pos4+18]}set zOffset(e){this._structArray.float32[this._pos4+18]=e}get hasIconTextFit(){return this._structArray.uint8[this._pos1+76]}}m4.prototype.size=80;class g4 extends C2{get(e){return new m4(this,e)}}xr(g4,"SymbolInstanceArray");class _4 extends qm{getoffsetX(e){return this.float32[1*e+0]}}xr(_4,"GlyphOffsetArray");class v4 extends Es{getx(e){return this.int16[2*e+0]}gety(e){return this.int16[2*e+1]}}xr(v4,"SymbolLineVertexArray");class y4 extends r1{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}y4.prototype.size=12;class x4 extends k2{get(e){return new y4(this,e)}}xr(x4,"FeatureIndexArray");class b4 extends Pf{geta_centroid_pos0(e){return this.uint16[2*e+0]}geta_centroid_pos1(e){return this.uint16[2*e+1]}}xr(b4,"FillExtrusionCentroidArray");const lV=Zn([{name:"a_pos",components:2,type:"Int16"}],4),cV=Zn([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class ui{constructor(e=[]){this.segments=e}_prepareSegment(e,i,o,l){let u=this.segments[this.segments.length-1];return e>ui.MAX_VERTEX_ARRAY_LENGTH&&se(`Max vertices per segment is ${ui.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${e}`),(!u||u.vertexLength+e>ui.MAX_VERTEX_ARRAY_LENGTH||u.sortKey!==l)&&(u={vertexOffset:i,primitiveOffset:o,vertexLength:0,primitiveLength:0},l!==void 0&&(u.sortKey=l),this.segments.push(u)),u}prepareSegment(e,i,o,l){return this._prepareSegment(e,i.length,o.length,l)}get(){return this.segments}destroy(){for(const e of this.segments)for(const i in e.vaos)e.vaos[i].destroy()}static simpleSegment(e,i,o,l){return new ui([{vertexOffset:e,primitiveOffset:i,vertexLength:o,primitiveLength:l,vaos:{},sortKey:0}])}}function w4(r,e){return 256*(r=Oe(Math.floor(r),0,255))+Oe(Math.floor(e),0,255)}ui.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,xr(ui,"SegmentVector");const uV=Zn([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),fV=Zn([{name:"a_dash",components:4,type:"Uint16"}]);var l1={exports:{}},E4={exports:{}};(function(r){r.exports=function(e,i){var o,l,u,h,m,_,v,x;for(l=e.length-(o=3&e.length),u=i,m=3432918353,_=461845907,x=0;x<l;)v=255&e.charCodeAt(x)|(255&e.charCodeAt(++x))<<8|(255&e.charCodeAt(++x))<<16|(255&e.charCodeAt(++x))<<24,++x,u=27492+(65535&(h=5*(65535&(u=(u^=v=(65535&(v=(v=(65535&v)*m+(((v>>>16)*m&65535)<<16)&4294967295)<<15|v>>>17))*_+(((v>>>16)*_&65535)<<16)&4294967295)<<13|u>>>19))+((5*(u>>>16)&65535)<<16)&4294967295))+((58964+(h>>>16)&65535)<<16);switch(v=0,o){case 3:v^=(255&e.charCodeAt(x+2))<<16;case 2:v^=(255&e.charCodeAt(x+1))<<8;case 1:u^=v=(65535&(v=(v=(65535&(v^=255&e.charCodeAt(x)))*m+(((v>>>16)*m&65535)<<16)&4294967295)<<15|v>>>17))*_+(((v>>>16)*_&65535)<<16)&4294967295}return u^=e.length,u=2246822507*(65535&(u^=u>>>16))+((2246822507*(u>>>16)&65535)<<16)&4294967295,u=3266489909*(65535&(u^=u>>>13))+((3266489909*(u>>>16)&65535)<<16)&4294967295,(u^=u>>>16)>>>0}})(E4);var hV=E4.exports,T4={exports:{}};(function(r){r.exports=function(e,i){for(var o,l=e.length,u=i^l,h=0;l>=4;)o=1540483477*(65535&(o=255&e.charCodeAt(h)|(255&e.charCodeAt(++h))<<8|(255&e.charCodeAt(++h))<<16|(255&e.charCodeAt(++h))<<24))+((1540483477*(o>>>16)&65535)<<16),u=1540483477*(65535&u)+((1540483477*(u>>>16)&65535)<<16)^(o=1540483477*(65535&(o^=o>>>24))+((1540483477*(o>>>16)&65535)<<16)),l-=4,++h;switch(l){case 3:u^=(255&e.charCodeAt(h+2))<<16;case 2:u^=(255&e.charCodeAt(h+1))<<8;case 1:u=1540483477*(65535&(u^=255&e.charCodeAt(h)))+((1540483477*(u>>>16)&65535)<<16)}return u=1540483477*(65535&(u^=u>>>13))+((1540483477*(u>>>16)&65535)<<16),(u^=u>>>15)>>>0}})(T4);var S4=hV,dV=T4.exports;l1.exports=S4,l1.exports.murmur3=S4,l1.exports.murmur2=dV;var P2=O(l1.exports);class Km{constructor(){this.ids=[],this.uniqueIds=[],this.positions=[],this.indexed=!1}add(e,i,o,l){this.ids.push(C4(e)),this.positions.push(i,o,l)}eachPosition(e,i){const o=C4(e);let l=0,u=this.ids.length-1;for(;l<u;){const h=l+u>>1;this.ids[h]>=o?u=h:l=h+1}for(;this.ids[l]===o;)i(this.positions[3*l],this.positions[3*l+1],this.positions[3*l+2]),l++}static serialize(e,i){const o=new Float64Array(e.ids),l=new Uint32Array(e.positions);return O2(o,l,0,o.length-1),i&&(i.add(o.buffer),i.add(l.buffer)),{ids:o,positions:l}}static deserialize(e){const i=new Km;let o;i.ids=e.ids,i.positions=e.positions;for(const l of i.ids)l!==o&&i.uniqueIds.push(l),o=l;return i.indexed=!0,i}}function C4(r){const e=+r;return!isNaN(e)&&Number.MIN_SAFE_INTEGER<=e&&e<=Number.MAX_SAFE_INTEGER?e:P2(String(r))}function O2(r,e,i,o){for(;i<o;){const l=r[i+o>>1];let u=i-1,h=o+1;for(;;){do u++;while(r[u]<l);do h--;while(r[h]>l);if(u>=h)break;c1(r,u,h),c1(e,3*u,3*h),c1(e,3*u+1,3*h+1),c1(e,3*u+2,3*h+2)}h-i<o-h?(O2(r,e,i,h),i=h+1):(O2(r,e,h+1,o),o=h)}}function c1(r,e,i){const o=r[e];r[e]=r[i],r[i]=o}xr(Km,"FeaturePositionMap");class wu{constructor(e){this.gl=e.gl,this.initialized=!1}fetchUniformLocation(e,i){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(e,i),this.initialized=!0),!!this.location}}class bn extends wu{constructor(e){super(e),this.current=0}set(e,i,o){this.fetchUniformLocation(e,i)&&this.current!==o&&(this.current=o,this.gl.uniform1i(this.location,o))}}class Zt extends wu{constructor(e){super(e),this.current=0}set(e,i,o){this.fetchUniformLocation(e,i)&&this.current!==o&&(this.current=o,this.gl.uniform1f(this.location,o))}}class An extends wu{constructor(e){super(e),this.current=[0,0]}set(e,i,o){this.fetchUniformLocation(e,i)&&(o[0]===this.current[0]&&o[1]===this.current[1]||(this.current=o,this.gl.uniform2f(this.location,o[0],o[1])))}}class sn extends wu{constructor(e){super(e),this.current=[0,0,0]}set(e,i,o){this.fetchUniformLocation(e,i)&&(o[0]===this.current[0]&&o[1]===this.current[1]&&o[2]===this.current[2]||(this.current=o,this.gl.uniform3f(this.location,o[0],o[1],o[2])))}}class Ts extends wu{constructor(e){super(e),this.current=[0,0,0,0]}set(e,i,o){this.fetchUniformLocation(e,i)&&(o[0]===this.current[0]&&o[1]===this.current[1]&&o[2]===this.current[2]&&o[3]===this.current[3]||(this.current=o,this.gl.uniform4f(this.location,o[0],o[1],o[2],o[3])))}}class Up extends wu{constructor(e){super(e),this.current=hn.transparent}set(e,i,o){this.fetchUniformLocation(e,i)&&(o.r===this.current.r&&o.g===this.current.g&&o.b===this.current.b&&o.a===this.current.a||(this.current=o,this.gl.uniform4f(this.location,o.r,o.g,o.b,o.a)))}}const pV=new Float32Array(16);class an extends wu{constructor(e){super(e),this.current=pV}set(e,i,o){if(this.fetchUniformLocation(e,i)){if(o[12]!==this.current[12]||o[0]!==this.current[0])return this.current=o,void this.gl.uniformMatrix4fv(this.location,!1,o);for(let l=1;l<16;l++)if(o[l]!==this.current[l]){this.current=o,this.gl.uniformMatrix4fv(this.location,!1,o);break}}}}const mV=new Float32Array(9);class A4 extends wu{constructor(e){super(e),this.current=mV}set(e,i,o){if(this.fetchUniformLocation(e,i)){for(let l=0;l<9;l++)if(o[l]!==this.current[l]){this.current=o,this.gl.uniformMatrix3fv(this.location,!1,o);break}}}}const gV=new Float32Array(4);class R2 extends wu{constructor(e){super(e),this.current=gV}set(e,i,o){if(this.fetchUniformLocation(e,i)){for(let l=0;l<4;l++)if(o[l]!==this.current[l]){this.current=o,this.gl.uniformMatrix2fv(this.location,!1,o);break}}}}function L2(r){return[w4(255*r.r,255*r.g),w4(255*r.b,255*r.a)]}class Ym{constructor(e,i,o){this.value=e,this.uniformNames=i.map(l=>`u_${l}`),this.type=o}setUniform(e,i,o,l,u){i.set(e,u,l.constantOr(this.value))}getBinding(e,i){return this.type==="color"?new Up(e):new Zt(e)}}class $p{constructor(e,i){this.uniformNames=i.map(o=>`u_${o}`),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(e){this.pixelRatio=e.pixelRatio||1,this.pattern=e.tl.concat(e.br)}setUniform(e,i,o,l,u){const h=u==="u_pattern"||u==="u_dash"?this.pattern:u==="u_pixel_ratio"?this.pixelRatio:null;h&&i.set(e,u,h)}getBinding(e,i){return i==="u_pattern"||i==="u_dash"?new Ts(e):new Zt(e)}}class Eu{constructor(e,i,o,l){this.expression=e,this.type=o,this.maxValue=0,this.paintVertexAttributes=i.map(u=>({name:`a_${u}`,type:"Float32",components:o==="color"?2:1,offset:0})),this.paintVertexArray=new l}populatePaintArray(e,i,o,l,u,h,m){const _=this.paintVertexArray.length,v=this.expression.evaluate(new Gi(0,{brightness:h}),i,{},u,l,m);this.paintVertexArray.resize(e),this._setPaintValue(_,e,v)}updatePaintArray(e,i,o,l,u,h,m){const _=this.expression.evaluate({zoom:0,brightness:m},o,l,void 0,u);this._setPaintValue(e,i,_)}_setPaintValue(e,i,o){if(this.type==="color"){const l=L2(o);for(let u=e;u<i;u++)this.paintVertexArray.emplace(u,l[0],l[1])}else{for(let l=e;l<i;l++)this.paintVertexArray.emplace(l,o);this.maxValue=Math.max(this.maxValue,Math.abs(o))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Hl{constructor(e,i,o,l,u,h){this.expression=e,this.uniformNames=i.map(m=>`u_${m}_t`),this.type=o,this.useIntegerZoom=l,this.zoom=u,this.maxValue=0,this.paintVertexAttributes=i.map(m=>({name:`a_${m}`,type:"Float32",components:o==="color"?4:2,offset:0})),this.paintVertexArray=new h}populatePaintArray(e,i,o,l,u,h,m){const _=this.expression.evaluate(new Gi(this.zoom,{brightness:h}),i,{},u,l,m),v=this.expression.evaluate(new Gi(this.zoom+1,{brightness:h}),i,{},u,l,m),x=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(x,e,_,v)}updatePaintArray(e,i,o,l,u,h,m){const _=this.expression.evaluate({zoom:this.zoom,brightness:m},o,l,void 0,u),v=this.expression.evaluate({zoom:this.zoom+1,brightness:m},o,l,void 0,u);this._setPaintValue(e,i,_,v)}_setPaintValue(e,i,o,l){if(this.type==="color"){const u=L2(o),h=L2(l);for(let m=e;m<i;m++)this.paintVertexArray.emplace(m,u[0],u[1],h[0],h[1])}else{for(let u=e;u<i;u++)this.paintVertexArray.emplace(u,o,l);this.maxValue=Math.max(this.maxValue,Math.abs(o),Math.abs(l))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(e,i,o,l,u){const h=this.useIntegerZoom?Math.floor(o.zoom):o.zoom,m=Oe(this.expression.interpolationFactor(h,this.zoom,this.zoom+1),0,1);i.set(e,u,m)}getBinding(e,i){return new Zt(e)}}class Rf{constructor(e,i,o,l,u){this.expression=e,this.layerId=u,this.paintVertexAttributes=(o==="array"?fV:uV).members;for(let h=0;h<i.length;++h);this.paintVertexArray=new l}populatePaintArray(e,i,o){const l=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValues(l,e,i.patterns&&i.patterns[this.layerId],o)}updatePaintArray(e,i,o,l,u,h,m){this._setPaintValues(e,i,o.patterns&&o.patterns[this.layerId],h)}_setPaintValues(e,i,o,l){if(!l||!o)return;const u=l[o];if(!u)return;const{tl:h,br:m,pixelRatio:_}=u;for(let v=e;v<i;v++)this.paintVertexArray.emplace(v,h[0],h[1],m[0],m[1],_)}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class nd{constructor(e,i,o=()=>!0){this.binders={},this._buffers=[];const l=[];for(const u in e.paint._values){const h=e.paint.get(u);if(!o(u)||!(h instanceof Np&&Qh(h.property.specification)))continue;const m=vV(u,e.type),_=h.value,v=h.property.specification.type,x=!!h.property.useIntegerZoom,w=u==="line-dasharray"||u.endsWith("pattern"),C=u==="line-dasharray"&&e.layout.get("line-cap").value.kind!=="constant";if(_.kind!=="constant"||C)if(_.kind==="source"||C||w){const k=k4(u,v,"source");this.binders[u]=w?new Rf(_,m,v,k,e.id):new Eu(_,m,v,k),l.push(`/a_${u}`)}else{const k=k4(u,v,"composite");this.binders[u]=new Hl(_,m,v,x,i,k),l.push(`/z_${u}`)}else this.binders[u]=w?new $p(_.value,m):new Ym(_.value,m,v),l.push(`/u_${u}`)}this.cacheKey=l.sort().join("")}getMaxValue(e){const i=this.binders[e];return i instanceof Eu||i instanceof Hl?i.maxValue:0}populatePaintArrays(e,i,o,l,u,h,m){for(const _ in this.binders){const v=this.binders[_];(v instanceof Eu||v instanceof Hl||v instanceof Rf)&&v.populatePaintArray(e,i,o,l,u,h,m)}}setConstantPatternPositions(e){for(const i in this.binders){const o=this.binders[i];o instanceof $p&&o.setConstantPatternPositions(e)}}updatePaintArrays(e,i,o,l,u,h,m,_){let v=!1;const x=Object.keys(e),w=x.length!==0,C=w?x:i.uniqueIds;for(const k in this.binders){const P=this.binders[k];if((P instanceof Eu||P instanceof Hl||P instanceof Rf)&&(P.expression.isStateDependent===!0||P.expression.isLightConstant===!1)){const R=u.paint.get(k);P.expression=R.value;for(const z of C){const B=e[z.toString()];i.eachPosition(z,(H,Z,Y)=>{const q=l.feature(H);P.updatePaintArray(Z,Y,q,B,h,m,_)})}if(!w)for(const z of o.uniqueIds){const B=e[z.toString()];o.eachPosition(z,(H,Z,Y)=>{const q=l.feature(H);P.updatePaintArray(Z,Y,q,B,h,m,_)})}v=!0}}return v}defines(){const e=[];for(const i in this.binders){const o=this.binders[i];(o instanceof Ym||o instanceof $p)&&e.push(...o.uniformNames.map(l=>`#define HAS_UNIFORM_${l}`))}return e}getBinderAttributes(){const e=[];for(const i in this.binders){const o=this.binders[i];if(o instanceof Eu||o instanceof Hl||o instanceof Rf)for(let l=0;l<o.paintVertexAttributes.length;l++)e.push(o.paintVertexAttributes[l].name)}return e}getBinderUniforms(){const e=[];for(const i in this.binders){const o=this.binders[i];if(o instanceof Ym||o instanceof $p||o instanceof Hl)for(const l of o.uniformNames)e.push(l)}return e}getPaintVertexBuffers(){return this._buffers}getUniforms(e){const i=[];for(const o in this.binders){const l=this.binders[o];if(l instanceof Ym||l instanceof $p||l instanceof Hl)for(const u of l.uniformNames)i.push({name:u,property:o,binding:l.getBinding(e,u)})}return i}setUniforms(e,i,o,l,u){for(const{name:h,property:m,binding:_}of o)this.binders[m].setUniform(e,_,u,l.get(m),h)}updatePaintBuffers(){this._buffers=[];for(const e in this.binders){const i=this.binders[e];(i instanceof Eu||i instanceof Hl||i instanceof Rf)&&i.paintVertexBuffer&&this._buffers.push(i.paintVertexBuffer)}}upload(e){for(const i in this.binders){const o=this.binders[i];(o instanceof Eu||o instanceof Hl||o instanceof Rf)&&o.upload(e)}this.updatePaintBuffers()}destroy(){for(const e in this.binders){const i=this.binders[e];(i instanceof Eu||i instanceof Hl||i instanceof Rf)&&i.destroy()}}}class Lf{constructor(e,i,o=()=>!0){this.programConfigurations={};for(const l of e)this.programConfigurations[l.id]=new nd(l,i,o);this.needsUpload=!1,this._featureMap=new Km,this._featureMapWithoutIds=new Km,this._bufferOffset=0,this._idlessCounter=0}populatePaintArrays(e,i,o,l,u,h,m,_){for(const v in this.programConfigurations)this.programConfigurations[v].populatePaintArrays(e,i,l,u,h,m,_);i.id!==void 0?this._featureMap.add(i.id,o,this._bufferOffset,e):(this._featureMapWithoutIds.add(this._idlessCounter,o,this._bufferOffset,e),this._idlessCounter+=1),this._bufferOffset=e,this.needsUpload=!0}updatePaintArrays(e,i,o,l,u,h){for(const m of o)this.needsUpload=this.programConfigurations[m.id].updatePaintArrays(e,this._featureMap,this._featureMapWithoutIds,i,m,l,u,h||0)||this.needsUpload}get(e){return this.programConfigurations[e]}upload(e){if(this.needsUpload){for(const i in this.programConfigurations)this.programConfigurations[i].upload(e);this.needsUpload=!1}}destroy(){for(const e in this.programConfigurations)this.programConfigurations[e].destroy()}}const _V={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-emissive-strength":["emissive_strength"],"icon-emissive-strength":["emissive_strength"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function vV(r,e){return _V[r]||[r.replace(`${e}-`,"").replace(/-/g,"_")]}const yV={"line-pattern":{source:Ff,composite:Ff},"fill-pattern":{source:Ff,composite:Ff},"fill-extrusion-pattern":{source:Ff,composite:Ff},"line-dasharray":{source:i1,composite:i1}},xV={color:{source:Zm,composite:Mf},number:{source:qm,composite:Zm}};function k4(r,e,i){const o=yV[r];return o&&o[i]||xV[e][i]}xr(Ym,"ConstantBinder"),xr($p,"PatternConstantBinder"),xr(Eu,"SourceExpressionBinder"),xr(Rf,"PatternCompositeBinder"),xr(Hl,"CompositeExpressionBinder"),xr(nd,"ProgramConfiguration",{omit:["_buffers"]}),xr(Lf,"ProgramConfigurationSet");class Ks{constructor(e,i){e&&(i?this.setSouthWest(e).setNorthEast(i):e.length===4?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1]))}setNorthEast(e){return this._ne=e instanceof Xr?new Xr(e.lng,e.lat):Xr.convert(e),this}setSouthWest(e){return this._sw=e instanceof Xr?new Xr(e.lng,e.lat):Xr.convert(e),this}extend(e){const i=this._sw,o=this._ne;let l,u;if(e instanceof Xr)l=e,u=e;else{if(!(e instanceof Ks))return Array.isArray(e)?e.length===4||e.every(Array.isArray)?this.extend(Ks.convert(e)):this.extend(Xr.convert(e)):typeof e=="object"&&e!==null&&e.hasOwnProperty("lat")&&(e.hasOwnProperty("lon")||e.hasOwnProperty("lng"))?this.extend(Xr.convert(e)):this;if(l=e._sw,u=e._ne,!l||!u)return this}return i||o?(i.lng=Math.min(l.lng,i.lng),i.lat=Math.min(l.lat,i.lat),o.lng=Math.max(u.lng,o.lng),o.lat=Math.max(u.lat,o.lat)):(this._sw=new Xr(l.lng,l.lat),this._ne=new Xr(u.lng,u.lat)),this}getCenter(){return new Xr((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new Xr(this.getWest(),this.getNorth())}getSouthEast(){return new Xr(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(e){const{lng:i,lat:o}=Xr.convert(e);let l=this._sw.lng<=i&&i<=this._ne.lng;return this._sw.lng>this._ne.lng&&(l=this._sw.lng>=i&&i>=this._ne.lng),this._sw.lat<=o&&o<=this._ne.lat&&l}static convert(e){return!e||e instanceof Ks?e:new Ks(e)}}var za={},Na={};Object.defineProperty(Na,"__esModule",{value:!0}),Na.setMatrixArrayType=function(r){Na.ARRAY_TYPE=M4=r},Na.toRadian=function(r){return r*wV},Na.equals=function(r,e){return Math.abs(r-e)<=I4*Math.max(1,Math.abs(r),Math.abs(e))},Na.RANDOM=Na.ARRAY_TYPE=Na.EPSILON=void 0;var I4=1e-6;Na.EPSILON=I4;var M4=typeof Float32Array<"u"?Float32Array:Array;Na.ARRAY_TYPE=M4;var bV=Math.random;Na.RANDOM=bV;var wV=Math.PI/180;Math.hypot||(Math.hypot=function(){for(var r=0,e=arguments.length;e--;)r+=arguments[e]*arguments[e];return Math.sqrt(r)});var Xi={};function D2(r){return D2=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},D2(r)}Object.defineProperty(Xi,"__esModule",{value:!0}),Xi.create=function(){var r=new Df.ARRAY_TYPE(4);return Df.ARRAY_TYPE!=Float32Array&&(r[1]=0,r[2]=0),r[0]=1,r[3]=1,r},Xi.clone=function(r){var e=new Df.ARRAY_TYPE(4);return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e},Xi.copy=function(r,e){return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r},Xi.identity=function(r){return r[0]=1,r[1]=0,r[2]=0,r[3]=1,r},Xi.fromValues=function(r,e,i,o){var l=new Df.ARRAY_TYPE(4);return l[0]=r,l[1]=e,l[2]=i,l[3]=o,l},Xi.set=function(r,e,i,o,l){return r[0]=e,r[1]=i,r[2]=o,r[3]=l,r},Xi.transpose=function(r,e){if(r===e){var i=e[1];r[1]=e[2],r[2]=i}else r[0]=e[0],r[1]=e[2],r[2]=e[1],r[3]=e[3];return r},Xi.invert=function(r,e){var i=e[0],o=e[1],l=e[2],u=e[3],h=i*u-l*o;return h?(r[0]=u*(h=1/h),r[1]=-o*h,r[2]=-l*h,r[3]=i*h,r):null},Xi.adjoint=function(r,e){var i=e[0];return r[0]=e[3],r[1]=-e[1],r[2]=-e[2],r[3]=i,r},Xi.determinant=function(r){return r[0]*r[3]-r[2]*r[1]},Xi.multiply=P4,Xi.rotate=function(r,e,i){var o=e[0],l=e[1],u=e[2],h=e[3],m=Math.sin(i),_=Math.cos(i);return r[0]=o*_+u*m,r[1]=l*_+h*m,r[2]=o*-m+u*_,r[3]=l*-m+h*_,r},Xi.scale=function(r,e,i){var o=e[1],l=e[2],u=e[3],h=i[0],m=i[1];return r[0]=e[0]*h,r[1]=o*h,r[2]=l*m,r[3]=u*m,r},Xi.fromRotation=function(r,e){var i=Math.sin(e),o=Math.cos(e);return r[0]=o,r[1]=i,r[2]=-i,r[3]=o,r},Xi.fromScaling=function(r,e){return r[0]=e[0],r[1]=0,r[2]=0,r[3]=e[1],r},Xi.str=function(r){return"mat2("+r[0]+", "+r[1]+", "+r[2]+", "+r[3]+")"},Xi.frob=function(r){return Math.hypot(r[0],r[1],r[2],r[3])},Xi.LDU=function(r,e,i,o){return r[2]=o[2]/o[0],i[0]=o[0],i[1]=o[1],i[3]=o[3]-r[2]*i[1],[r,e,i]},Xi.add=function(r,e,i){return r[0]=e[0]+i[0],r[1]=e[1]+i[1],r[2]=e[2]+i[2],r[3]=e[3]+i[3],r},Xi.subtract=O4,Xi.exactEquals=function(r,e){return r[0]===e[0]&&r[1]===e[1]&&r[2]===e[2]&&r[3]===e[3]},Xi.equals=function(r,e){var i=r[0],o=r[1],l=r[2],u=r[3],h=e[0],m=e[1],_=e[2],v=e[3];return Math.abs(i-h)<=Df.EPSILON*Math.max(1,Math.abs(i),Math.abs(h))&&Math.abs(o-m)<=Df.EPSILON*Math.max(1,Math.abs(o),Math.abs(m))&&Math.abs(l-_)<=Df.EPSILON*Math.max(1,Math.abs(l),Math.abs(_))&&Math.abs(u-v)<=Df.EPSILON*Math.max(1,Math.abs(u),Math.abs(v))},Xi.multiplyScalar=function(r,e,i){return r[0]=e[0]*i,r[1]=e[1]*i,r[2]=e[2]*i,r[3]=e[3]*i,r},Xi.multiplyScalarAndAdd=function(r,e,i,o){return r[0]=e[0]+i[0]*o,r[1]=e[1]+i[1]*o,r[2]=e[2]+i[2]*o,r[3]=e[3]+i[3]*o,r},Xi.sub=Xi.mul=void 0;var Df=function(r,e){if(r&&r.__esModule)return r;if(r===null||D2(r)!=="object"&&typeof r!="function")return{default:r};var i=F4(void 0);if(i&&i.has(r))return i.get(r);var o={},l=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in r)if(u!=="default"&&Object.prototype.hasOwnProperty.call(r,u)){var h=l?Object.getOwnPropertyDescriptor(r,u):null;h&&(h.get||h.set)?Object.defineProperty(o,u,h):o[u]=r[u]}return o.default=r,i&&i.set(r,o),o}(Na);function F4(r){if(typeof WeakMap!="function")return null;var e=new WeakMap,i=new WeakMap;return(F4=function(o){return o?i:e})(r)}function P4(r,e,i){var o=e[0],l=e[1],u=e[2],h=e[3],m=i[0],_=i[1],v=i[2],x=i[3];return r[0]=o*m+u*_,r[1]=l*m+h*_,r[2]=o*v+u*x,r[3]=l*v+h*x,r}function O4(r,e,i){return r[0]=e[0]-i[0],r[1]=e[1]-i[1],r[2]=e[2]-i[2],r[3]=e[3]-i[3],r}Xi.mul=P4,Xi.sub=O4;var ta={};function B2(r){return B2=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},B2(r)}Object.defineProperty(ta,"__esModule",{value:!0}),ta.create=function(){var r=new Rc.ARRAY_TYPE(6);return Rc.ARRAY_TYPE!=Float32Array&&(r[1]=0,r[2]=0,r[4]=0,r[5]=0),r[0]=1,r[3]=1,r},ta.clone=function(r){var e=new Rc.ARRAY_TYPE(6);return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e[4]=r[4],e[5]=r[5],e},ta.copy=function(r,e){return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[4]=e[4],r[5]=e[5],r},ta.identity=function(r){return r[0]=1,r[1]=0,r[2]=0,r[3]=1,r[4]=0,r[5]=0,r},ta.fromValues=function(r,e,i,o,l,u){var h=new Rc.ARRAY_TYPE(6);return h[0]=r,h[1]=e,h[2]=i,h[3]=o,h[4]=l,h[5]=u,h},ta.set=function(r,e,i,o,l,u,h){return r[0]=e,r[1]=i,r[2]=o,r[3]=l,r[4]=u,r[5]=h,r},ta.invert=function(r,e){var i=e[0],o=e[1],l=e[2],u=e[3],h=e[4],m=e[5],_=i*u-o*l;return _?(r[0]=u*(_=1/_),r[1]=-o*_,r[2]=-l*_,r[3]=i*_,r[4]=(l*m-u*h)*_,r[5]=(o*h-i*m)*_,r):null},ta.determinant=function(r){return r[0]*r[3]-r[1]*r[2]},ta.multiply=L4,ta.rotate=function(r,e,i){var o=e[0],l=e[1],u=e[2],h=e[3],m=e[4],_=e[5],v=Math.sin(i),x=Math.cos(i);return r[0]=o*x+u*v,r[1]=l*x+h*v,r[2]=o*-v+u*x,r[3]=l*-v+h*x,r[4]=m,r[5]=_,r},ta.scale=function(r,e,i){var o=e[1],l=e[2],u=e[3],h=e[4],m=e[5],_=i[0],v=i[1];return r[0]=e[0]*_,r[1]=o*_,r[2]=l*v,r[3]=u*v,r[4]=h,r[5]=m,r},ta.translate=function(r,e,i){var o=e[0],l=e[1],u=e[2],h=e[3],m=e[4],_=e[5],v=i[0],x=i[1];return r[0]=o,r[1]=l,r[2]=u,r[3]=h,r[4]=o*v+u*x+m,r[5]=l*v+h*x+_,r},ta.fromRotation=function(r,e){var i=Math.sin(e),o=Math.cos(e);return r[0]=o,r[1]=i,r[2]=-i,r[3]=o,r[4]=0,r[5]=0,r},ta.fromScaling=function(r,e){return r[0]=e[0],r[1]=0,r[2]=0,r[3]=e[1],r[4]=0,r[5]=0,r},ta.fromTranslation=function(r,e){return r[0]=1,r[1]=0,r[2]=0,r[3]=1,r[4]=e[0],r[5]=e[1],r},ta.str=function(r){return"mat2d("+r[0]+", "+r[1]+", "+r[2]+", "+r[3]+", "+r[4]+", "+r[5]+")"},ta.frob=function(r){return Math.hypot(r[0],r[1],r[2],r[3],r[4],r[5],1)},ta.add=function(r,e,i){return r[0]=e[0]+i[0],r[1]=e[1]+i[1],r[2]=e[2]+i[2],r[3]=e[3]+i[3],r[4]=e[4]+i[4],r[5]=e[5]+i[5],r},ta.subtract=D4,ta.multiplyScalar=function(r,e,i){return r[0]=e[0]*i,r[1]=e[1]*i,r[2]=e[2]*i,r[3]=e[3]*i,r[4]=e[4]*i,r[5]=e[5]*i,r},ta.multiplyScalarAndAdd=function(r,e,i,o){return r[0]=e[0]+i[0]*o,r[1]=e[1]+i[1]*o,r[2]=e[2]+i[2]*o,r[3]=e[3]+i[3]*o,r[4]=e[4]+i[4]*o,r[5]=e[5]+i[5]*o,r},ta.exactEquals=function(r,e){return r[0]===e[0]&&r[1]===e[1]&&r[2]===e[2]&&r[3]===e[3]&&r[4]===e[4]&&r[5]===e[5]},ta.equals=function(r,e){var i=r[0],o=r[1],l=r[2],u=r[3],h=r[4],m=r[5],_=e[0],v=e[1],x=e[2],w=e[3],C=e[4],k=e[5];return Math.abs(i-_)<=Rc.EPSILON*Math.max(1,Math.abs(i),Math.abs(_))&&Math.abs(o-v)<=Rc.EPSILON*Math.max(1,Math.abs(o),Math.abs(v))&&Math.abs(l-x)<=Rc.EPSILON*Math.max(1,Math.abs(l),Math.abs(x))&&Math.abs(u-w)<=Rc.EPSILON*Math.max(1,Math.abs(u),Math.abs(w))&&Math.abs(h-C)<=Rc.EPSILON*Math.max(1,Math.abs(h),Math.abs(C))&&Math.abs(m-k)<=Rc.EPSILON*Math.max(1,Math.abs(m),Math.abs(k))},ta.sub=ta.mul=void 0;var Rc=function(r,e){if(r&&r.__esModule)return r;if(r===null||B2(r)!=="object"&&typeof r!="function")return{default:r};var i=R4(void 0);if(i&&i.has(r))return i.get(r);var o={},l=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in r)if(u!=="default"&&Object.prototype.hasOwnProperty.call(r,u)){var h=l?Object.getOwnPropertyDescriptor(r,u):null;h&&(h.get||h.set)?Object.defineProperty(o,u,h):o[u]=r[u]}return o.default=r,i&&i.set(r,o),o}(Na);function R4(r){if(typeof WeakMap!="function")return null;var e=new WeakMap,i=new WeakMap;return(R4=function(o){return o?i:e})(r)}function L4(r,e,i){var o=e[0],l=e[1],u=e[2],h=e[3],m=e[4],_=e[5],v=i[0],x=i[1],w=i[2],C=i[3],k=i[4],P=i[5];return r[0]=o*v+u*x,r[1]=l*v+h*x,r[2]=o*w+u*C,r[3]=l*w+h*C,r[4]=o*k+u*P+m,r[5]=l*k+h*P+_,r}function D4(r,e,i){return r[0]=e[0]-i[0],r[1]=e[1]-i[1],r[2]=e[2]-i[2],r[3]=e[3]-i[3],r[4]=e[4]-i[4],r[5]=e[5]-i[5],r}ta.mul=L4,ta.sub=D4;var mi={};function z2(r){return z2=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},z2(r)}Object.defineProperty(mi,"__esModule",{value:!0}),mi.create=function(){var r=new Ys.ARRAY_TYPE(9);return Ys.ARRAY_TYPE!=Float32Array&&(r[1]=0,r[2]=0,r[3]=0,r[5]=0,r[6]=0,r[7]=0),r[0]=1,r[4]=1,r[8]=1,r},mi.fromMat4=function(r,e){return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[4],r[4]=e[5],r[5]=e[6],r[6]=e[8],r[7]=e[9],r[8]=e[10],r},mi.clone=function(r){var e=new Ys.ARRAY_TYPE(9);return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e[4]=r[4],e[5]=r[5],e[6]=r[6],e[7]=r[7],e[8]=r[8],e},mi.copy=function(r,e){return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[4]=e[4],r[5]=e[5],r[6]=e[6],r[7]=e[7],r[8]=e[8],r},mi.fromValues=function(r,e,i,o,l,u,h,m,_){var v=new Ys.ARRAY_TYPE(9);return v[0]=r,v[1]=e,v[2]=i,v[3]=o,v[4]=l,v[5]=u,v[6]=h,v[7]=m,v[8]=_,v},mi.set=function(r,e,i,o,l,u,h,m,_,v){return r[0]=e,r[1]=i,r[2]=o,r[3]=l,r[4]=u,r[5]=h,r[6]=m,r[7]=_,r[8]=v,r},mi.identity=function(r){return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=1,r[5]=0,r[6]=0,r[7]=0,r[8]=1,r},mi.transpose=function(r,e){if(r===e){var i=e[1],o=e[2],l=e[5];r[1]=e[3],r[2]=e[6],r[3]=i,r[5]=e[7],r[6]=o,r[7]=l}else r[0]=e[0],r[1]=e[3],r[2]=e[6],r[3]=e[1],r[4]=e[4],r[5]=e[7],r[6]=e[2],r[7]=e[5],r[8]=e[8];return r},mi.invert=function(r,e){var i=e[0],o=e[1],l=e[2],u=e[3],h=e[4],m=e[5],_=e[6],v=e[7],x=e[8],w=x*h-m*v,C=-x*u+m*_,k=v*u-h*_,P=i*w+o*C+l*k;return P?(r[0]=w*(P=1/P),r[1]=(-x*o+l*v)*P,r[2]=(m*o-l*h)*P,r[3]=C*P,r[4]=(x*i-l*_)*P,r[5]=(-m*i+l*u)*P,r[6]=k*P,r[7]=(-v*i+o*_)*P,r[8]=(h*i-o*u)*P,r):null},mi.adjoint=function(r,e){var i=e[0],o=e[1],l=e[2],u=e[3],h=e[4],m=e[5],_=e[6],v=e[7],x=e[8];return r[0]=h*x-m*v,r[1]=l*v-o*x,r[2]=o*m-l*h,r[3]=m*_-u*x,r[4]=i*x-l*_,r[5]=l*u-i*m,r[6]=u*v-h*_,r[7]=o*_-i*v,r[8]=i*h-o*u,r},mi.determinant=function(r){var e=r[3],i=r[4],o=r[5],l=r[6],u=r[7],h=r[8];return r[0]*(h*i-o*u)+r[1]*(-h*e+o*l)+r[2]*(u*e-i*l)},mi.multiply=z4,mi.translate=function(r,e,i){var o=e[0],l=e[1],u=e[2],h=e[3],m=e[4],_=e[5],v=e[6],x=e[7],w=e[8],C=i[0],k=i[1];return r[0]=o,r[1]=l,r[2]=u,r[3]=h,r[4]=m,r[5]=_,r[6]=C*o+k*h+v,r[7]=C*l+k*m+x,r[8]=C*u+k*_+w,r},mi.rotate=function(r,e,i){var o=e[0],l=e[1],u=e[2],h=e[3],m=e[4],_=e[5],v=e[6],x=e[7],w=e[8],C=Math.sin(i),k=Math.cos(i);return r[0]=k*o+C*h,r[1]=k*l+C*m,r[2]=k*u+C*_,r[3]=k*h-C*o,r[4]=k*m-C*l,r[5]=k*_-C*u,r[6]=v,r[7]=x,r[8]=w,r},mi.scale=function(r,e,i){var o=i[0],l=i[1];return r[0]=o*e[0],r[1]=o*e[1],r[2]=o*e[2],r[3]=l*e[3],r[4]=l*e[4],r[5]=l*e[5],r[6]=e[6],r[7]=e[7],r[8]=e[8],r},mi.fromTranslation=function(r,e){return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=1,r[5]=0,r[6]=e[0],r[7]=e[1],r[8]=1,r},mi.fromRotation=function(r,e){var i=Math.sin(e),o=Math.cos(e);return r[0]=o,r[1]=i,r[2]=0,r[3]=-i,r[4]=o,r[5]=0,r[6]=0,r[7]=0,r[8]=1,r},mi.fromScaling=function(r,e){return r[0]=e[0],r[1]=0,r[2]=0,r[3]=0,r[4]=e[1],r[5]=0,r[6]=0,r[7]=0,r[8]=1,r},mi.fromMat2d=function(r,e){return r[0]=e[0],r[1]=e[1],r[2]=0,r[3]=e[2],r[4]=e[3],r[5]=0,r[6]=e[4],r[7]=e[5],r[8]=1,r},mi.fromQuat=function(r,e){var i=e[0],o=e[1],l=e[2],u=e[3],h=i+i,m=o+o,_=l+l,v=i*h,x=o*h,w=o*m,C=l*h,k=l*m,P=l*_,R=u*h,z=u*m,B=u*_;return r[0]=1-w-P,r[3]=x-B,r[6]=C+z,r[1]=x+B,r[4]=1-v-P,r[7]=k-R,r[2]=C-z,r[5]=k+R,r[8]=1-v-w,r},mi.normalFromMat4=function(r,e){var i=e[0],o=e[1],l=e[2],u=e[3],h=e[4],m=e[5],_=e[6],v=e[7],x=e[8],w=e[9],C=e[10],k=e[11],P=e[12],R=e[13],z=e[14],B=e[15],H=i*m-o*h,Z=i*_-l*h,Y=i*v-u*h,q=o*_-l*m,ee=o*v-u*m,ce=l*v-u*_,de=x*R-w*P,ge=x*z-C*P,ve=x*B-k*P,Re=w*z-C*R,ke=w*B-k*R,$e=C*B-k*z,Ie=H*$e-Z*ke+Y*Re+q*ve-ee*ge+ce*de;return Ie?(r[0]=(m*$e-_*ke+v*Re)*(Ie=1/Ie),r[1]=(_*ve-h*$e-v*ge)*Ie,r[2]=(h*ke-m*ve+v*de)*Ie,r[3]=(l*ke-o*$e-u*Re)*Ie,r[4]=(i*$e-l*ve+u*ge)*Ie,r[5]=(o*ve-i*ke-u*de)*Ie,r[6]=(R*ce-z*ee+B*q)*Ie,r[7]=(z*Y-P*ce-B*Z)*Ie,r[8]=(P*ee-R*Y+B*H)*Ie,r):null},mi.projection=function(r,e,i){return r[0]=2/e,r[1]=0,r[2]=0,r[3]=0,r[4]=-2/i,r[5]=0,r[6]=-1,r[7]=1,r[8]=1,r},mi.str=function(r){return"mat3("+r[0]+", "+r[1]+", "+r[2]+", "+r[3]+", "+r[4]+", "+r[5]+", "+r[6]+", "+r[7]+", "+r[8]+")"},mi.frob=function(r){return Math.hypot(r[0],r[1],r[2],r[3],r[4],r[5],r[6],r[7],r[8])},mi.add=function(r,e,i){return r[0]=e[0]+i[0],r[1]=e[1]+i[1],r[2]=e[2]+i[2],r[3]=e[3]+i[3],r[4]=e[4]+i[4],r[5]=e[5]+i[5],r[6]=e[6]+i[6],r[7]=e[7]+i[7],r[8]=e[8]+i[8],r},mi.subtract=N4,mi.multiplyScalar=function(r,e,i){return r[0]=e[0]*i,r[1]=e[1]*i,r[2]=e[2]*i,r[3]=e[3]*i,r[4]=e[4]*i,r[5]=e[5]*i,r[6]=e[6]*i,r[7]=e[7]*i,r[8]=e[8]*i,r},mi.multiplyScalarAndAdd=function(r,e,i,o){return r[0]=e[0]+i[0]*o,r[1]=e[1]+i[1]*o,r[2]=e[2]+i[2]*o,r[3]=e[3]+i[3]*o,r[4]=e[4]+i[4]*o,r[5]=e[5]+i[5]*o,r[6]=e[6]+i[6]*o,r[7]=e[7]+i[7]*o,r[8]=e[8]+i[8]*o,r},mi.exactEquals=function(r,e){return r[0]===e[0]&&r[1]===e[1]&&r[2]===e[2]&&r[3]===e[3]&&r[4]===e[4]&&r[5]===e[5]&&r[6]===e[6]&&r[7]===e[7]&&r[8]===e[8]},mi.equals=function(r,e){var i=r[0],o=r[1],l=r[2],u=r[3],h=r[4],m=r[5],_=r[6],v=r[7],x=r[8],w=e[0],C=e[1],k=e[2],P=e[3],R=e[4],z=e[5],B=e[6],H=e[7],Z=e[8];return Math.abs(i-w)<=Ys.EPSILON*Math.max(1,Math.abs(i),Math.abs(w))&&Math.abs(o-C)<=Ys.EPSILON*Math.max(1,Math.abs(o),Math.abs(C))&&Math.abs(l-k)<=Ys.EPSILON*Math.max(1,Math.abs(l),Math.abs(k))&&Math.abs(u-P)<=Ys.EPSILON*Math.max(1,Math.abs(u),Math.abs(P))&&Math.abs(h-R)<=Ys.EPSILON*Math.max(1,Math.abs(h),Math.abs(R))&&Math.abs(m-z)<=Ys.EPSILON*Math.max(1,Math.abs(m),Math.abs(z))&&Math.abs(_-B)<=Ys.EPSILON*Math.max(1,Math.abs(_),Math.abs(B))&&Math.abs(v-H)<=Ys.EPSILON*Math.max(1,Math.abs(v),Math.abs(H))&&Math.abs(x-Z)<=Ys.EPSILON*Math.max(1,Math.abs(x),Math.abs(Z))},mi.sub=mi.mul=void 0;var Ys=function(r,e){if(r&&r.__esModule)return r;if(r===null||z2(r)!=="object"&&typeof r!="function")return{default:r};var i=B4(void 0);if(i&&i.has(r))return i.get(r);var o={},l=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in r)if(u!=="default"&&Object.prototype.hasOwnProperty.call(r,u)){var h=l?Object.getOwnPropertyDescriptor(r,u):null;h&&(h.get||h.set)?Object.defineProperty(o,u,h):o[u]=r[u]}return o.default=r,i&&i.set(r,o),o}(Na);function B4(r){if(typeof WeakMap!="function")return null;var e=new WeakMap,i=new WeakMap;return(B4=function(o){return o?i:e})(r)}function z4(r,e,i){var o=e[0],l=e[1],u=e[2],h=e[3],m=e[4],_=e[5],v=e[6],x=e[7],w=e[8],C=i[0],k=i[1],P=i[2],R=i[3],z=i[4],B=i[5],H=i[6],Z=i[7],Y=i[8];return r[0]=C*o+k*h+P*v,r[1]=C*l+k*m+P*x,r[2]=C*u+k*_+P*w,r[3]=R*o+z*h+B*v,r[4]=R*l+z*m+B*x,r[5]=R*u+z*_+B*w,r[6]=H*o+Z*h+Y*v,r[7]=H*l+Z*m+Y*x,r[8]=H*u+Z*_+Y*w,r}function N4(r,e,i){return r[0]=e[0]-i[0],r[1]=e[1]-i[1],r[2]=e[2]-i[2],r[3]=e[3]-i[3],r[4]=e[4]-i[4],r[5]=e[5]-i[5],r[6]=e[6]-i[6],r[7]=e[7]-i[7],r[8]=e[8]-i[8],r}mi.mul=z4,mi.sub=N4;var un={};function N2(r){return N2=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},N2(r)}Object.defineProperty(un,"__esModule",{value:!0}),un.create=function(){var r=new fa.ARRAY_TYPE(16);return fa.ARRAY_TYPE!=Float32Array&&(r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=0,r[12]=0,r[13]=0,r[14]=0),r[0]=1,r[5]=1,r[10]=1,r[15]=1,r},un.clone=function(r){var e=new fa.ARRAY_TYPE(16);return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e[4]=r[4],e[5]=r[5],e[6]=r[6],e[7]=r[7],e[8]=r[8],e[9]=r[9],e[10]=r[10],e[11]=r[11],e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15],e},un.copy=function(r,e){return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[4]=e[4],r[5]=e[5],r[6]=e[6],r[7]=e[7],r[8]=e[8],r[9]=e[9],r[10]=e[10],r[11]=e[11],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15],r},un.fromValues=function(r,e,i,o,l,u,h,m,_,v,x,w,C,k,P,R){var z=new fa.ARRAY_TYPE(16);return z[0]=r,z[1]=e,z[2]=i,z[3]=o,z[4]=l,z[5]=u,z[6]=h,z[7]=m,z[8]=_,z[9]=v,z[10]=x,z[11]=w,z[12]=C,z[13]=k,z[14]=P,z[15]=R,z},un.set=function(r,e,i,o,l,u,h,m,_,v,x,w,C,k,P,R,z){return r[0]=e,r[1]=i,r[2]=o,r[3]=l,r[4]=u,r[5]=h,r[6]=m,r[7]=_,r[8]=v,r[9]=x,r[10]=w,r[11]=C,r[12]=k,r[13]=P,r[14]=R,r[15]=z,r},un.identity=$4,un.transpose=function(r,e){if(r===e){var i=e[1],o=e[2],l=e[3],u=e[6],h=e[7],m=e[11];r[1]=e[4],r[2]=e[8],r[3]=e[12],r[4]=i,r[6]=e[9],r[7]=e[13],r[8]=o,r[9]=u,r[11]=e[14],r[12]=l,r[13]=h,r[14]=m}else r[0]=e[0],r[1]=e[4],r[2]=e[8],r[3]=e[12],r[4]=e[1],r[5]=e[5],r[6]=e[9],r[7]=e[13],r[8]=e[2],r[9]=e[6],r[10]=e[10],r[11]=e[14],r[12]=e[3],r[13]=e[7],r[14]=e[11],r[15]=e[15];return r},un.invert=function(r,e){var i=e[0],o=e[1],l=e[2],u=e[3],h=e[4],m=e[5],_=e[6],v=e[7],x=e[8],w=e[9],C=e[10],k=e[11],P=e[12],R=e[13],z=e[14],B=e[15],H=i*m-o*h,Z=i*_-l*h,Y=i*v-u*h,q=o*_-l*m,ee=o*v-u*m,ce=l*v-u*_,de=x*R-w*P,ge=x*z-C*P,ve=x*B-k*P,Re=w*z-C*R,ke=w*B-k*R,$e=C*B-k*z,Ie=H*$e-Z*ke+Y*Re+q*ve-ee*ge+ce*de;return Ie?(r[0]=(m*$e-_*ke+v*Re)*(Ie=1/Ie),r[1]=(l*ke-o*$e-u*Re)*Ie,r[2]=(R*ce-z*ee+B*q)*Ie,r[3]=(C*ee-w*ce-k*q)*Ie,r[4]=(_*ve-h*$e-v*ge)*Ie,r[5]=(i*$e-l*ve+u*ge)*Ie,r[6]=(z*Y-P*ce-B*Z)*Ie,r[7]=(x*ce-C*Y+k*Z)*Ie,r[8]=(h*ke-m*ve+v*de)*Ie,r[9]=(o*ve-i*ke-u*de)*Ie,r[10]=(P*ee-R*Y+B*H)*Ie,r[11]=(w*Y-x*ee-k*H)*Ie,r[12]=(m*ge-h*Re-_*de)*Ie,r[13]=(i*Re-o*ge+l*de)*Ie,r[14]=(R*Z-P*q-z*H)*Ie,r[15]=(x*q-w*Z+C*H)*Ie,r):null},un.adjoint=function(r,e){var i=e[0],o=e[1],l=e[2],u=e[3],h=e[4],m=e[5],_=e[6],v=e[7],x=e[8],w=e[9],C=e[10],k=e[11],P=e[12],R=e[13],z=e[14],B=e[15];return r[0]=m*(C*B-k*z)-w*(_*B-v*z)+R*(_*k-v*C),r[1]=-(o*(C*B-k*z)-w*(l*B-u*z)+R*(l*k-u*C)),r[2]=o*(_*B-v*z)-m*(l*B-u*z)+R*(l*v-u*_),r[3]=-(o*(_*k-v*C)-m*(l*k-u*C)+w*(l*v-u*_)),r[4]=-(h*(C*B-k*z)-x*(_*B-v*z)+P*(_*k-v*C)),r[5]=i*(C*B-k*z)-x*(l*B-u*z)+P*(l*k-u*C),r[6]=-(i*(_*B-v*z)-h*(l*B-u*z)+P*(l*v-u*_)),r[7]=i*(_*k-v*C)-h*(l*k-u*C)+x*(l*v-u*_),r[8]=h*(w*B-k*R)-x*(m*B-v*R)+P*(m*k-v*w),r[9]=-(i*(w*B-k*R)-x*(o*B-u*R)+P*(o*k-u*w)),r[10]=i*(m*B-v*R)-h*(o*B-u*R)+P*(o*v-u*m),r[11]=-(i*(m*k-v*w)-h*(o*k-u*w)+x*(o*v-u*m)),r[12]=-(h*(w*z-C*R)-x*(m*z-_*R)+P*(m*C-_*w)),r[13]=i*(w*z-C*R)-x*(o*z-l*R)+P*(o*C-l*w),r[14]=-(i*(m*z-_*R)-h*(o*z-l*R)+P*(o*_-l*m)),r[15]=i*(m*C-_*w)-h*(o*C-l*w)+x*(o*_-l*m),r},un.determinant=function(r){var e=r[0],i=r[1],o=r[2],l=r[3],u=r[4],h=r[5],m=r[6],_=r[7],v=r[8],x=r[9],w=r[10],C=r[11],k=r[12],P=r[13],R=r[14],z=r[15];return(e*h-i*u)*(w*z-C*R)-(e*m-o*u)*(x*z-C*P)+(e*_-l*u)*(x*R-w*P)+(i*m-o*h)*(v*z-C*k)-(i*_-l*h)*(v*R-w*k)+(o*_-l*m)*(v*P-x*k)},un.multiply=V4,un.translate=function(r,e,i){var o,l,u,h,m,_,v,x,w,C,k,P,R=i[0],z=i[1],B=i[2];return e===r?(r[12]=e[0]*R+e[4]*z+e[8]*B+e[12],r[13]=e[1]*R+e[5]*z+e[9]*B+e[13],r[14]=e[2]*R+e[6]*z+e[10]*B+e[14],r[15]=e[3]*R+e[7]*z+e[11]*B+e[15]):(l=e[1],u=e[2],h=e[3],m=e[4],_=e[5],v=e[6],x=e[7],w=e[8],C=e[9],k=e[10],P=e[11],r[0]=o=e[0],r[1]=l,r[2]=u,r[3]=h,r[4]=m,r[5]=_,r[6]=v,r[7]=x,r[8]=w,r[9]=C,r[10]=k,r[11]=P,r[12]=o*R+m*z+w*B+e[12],r[13]=l*R+_*z+C*B+e[13],r[14]=u*R+v*z+k*B+e[14],r[15]=h*R+x*z+P*B+e[15]),r},un.scale=function(r,e,i){var o=i[0],l=i[1],u=i[2];return r[0]=e[0]*o,r[1]=e[1]*o,r[2]=e[2]*o,r[3]=e[3]*o,r[4]=e[4]*l,r[5]=e[5]*l,r[6]=e[6]*l,r[7]=e[7]*l,r[8]=e[8]*u,r[9]=e[9]*u,r[10]=e[10]*u,r[11]=e[11]*u,r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15],r},un.rotate=function(r,e,i,o){var l,u,h,m,_,v,x,w,C,k,P,R,z,B,H,Z,Y,q,ee,ce,de,ge,ve,Re,ke=o[0],$e=o[1],Ie=o[2],Qe=Math.hypot(ke,$e,Ie);return Qe<fa.EPSILON?null:(ke*=Qe=1/Qe,$e*=Qe,Ie*=Qe,l=Math.sin(i),u=Math.cos(i),_=e[1],v=e[2],x=e[3],C=e[5],k=e[6],P=e[7],z=e[9],B=e[10],H=e[11],ee=ke*$e*(h=1-u)-Ie*l,ce=$e*$e*h+u,de=Ie*$e*h+ke*l,ge=ke*Ie*h+$e*l,ve=$e*Ie*h-ke*l,Re=Ie*Ie*h+u,r[0]=(m=e[0])*(Z=ke*ke*h+u)+(w=e[4])*(Y=$e*ke*h+Ie*l)+(R=e[8])*(q=Ie*ke*h-$e*l),r[1]=_*Z+C*Y+z*q,r[2]=v*Z+k*Y+B*q,r[3]=x*Z+P*Y+H*q,r[4]=m*ee+w*ce+R*de,r[5]=_*ee+C*ce+z*de,r[6]=v*ee+k*ce+B*de,r[7]=x*ee+P*ce+H*de,r[8]=m*ge+w*ve+R*Re,r[9]=_*ge+C*ve+z*Re,r[10]=v*ge+k*ve+B*Re,r[11]=x*ge+P*ve+H*Re,e!==r&&(r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]),r)},un.rotateX=function(r,e,i){var o=Math.sin(i),l=Math.cos(i),u=e[4],h=e[5],m=e[6],_=e[7],v=e[8],x=e[9],w=e[10],C=e[11];return e!==r&&(r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]),r[4]=u*l+v*o,r[5]=h*l+x*o,r[6]=m*l+w*o,r[7]=_*l+C*o,r[8]=v*l-u*o,r[9]=x*l-h*o,r[10]=w*l-m*o,r[11]=C*l-_*o,r},un.rotateY=function(r,e,i){var o=Math.sin(i),l=Math.cos(i),u=e[0],h=e[1],m=e[2],_=e[3],v=e[8],x=e[9],w=e[10],C=e[11];return e!==r&&(r[4]=e[4],r[5]=e[5],r[6]=e[6],r[7]=e[7],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]),r[0]=u*l-v*o,r[1]=h*l-x*o,r[2]=m*l-w*o,r[3]=_*l-C*o,r[8]=u*o+v*l,r[9]=h*o+x*l,r[10]=m*o+w*l,r[11]=_*o+C*l,r},un.rotateZ=function(r,e,i){var o=Math.sin(i),l=Math.cos(i),u=e[0],h=e[1],m=e[2],_=e[3],v=e[4],x=e[5],w=e[6],C=e[7];return e!==r&&(r[8]=e[8],r[9]=e[9],r[10]=e[10],r[11]=e[11],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]),r[0]=u*l+v*o,r[1]=h*l+x*o,r[2]=m*l+w*o,r[3]=_*l+C*o,r[4]=v*l-u*o,r[5]=x*l-h*o,r[6]=w*l-m*o,r[7]=C*l-_*o,r},un.fromTranslation=function(r,e){return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=e[0],r[13]=e[1],r[14]=e[2],r[15]=1,r},un.fromScaling=function(r,e){return r[0]=e[0],r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=e[1],r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=e[2],r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r},un.fromRotation=function(r,e,i){var o,l,u,h=i[0],m=i[1],_=i[2],v=Math.hypot(h,m,_);return v<fa.EPSILON?null:(h*=v=1/v,m*=v,_*=v,o=Math.sin(e),l=Math.cos(e),r[0]=h*h*(u=1-l)+l,r[1]=m*h*u+_*o,r[2]=_*h*u-m*o,r[3]=0,r[4]=h*m*u-_*o,r[5]=m*m*u+l,r[6]=_*m*u+h*o,r[7]=0,r[8]=h*_*u+m*o,r[9]=m*_*u-h*o,r[10]=_*_*u+l,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r)},un.fromXRotation=function(r,e){var i=Math.sin(e),o=Math.cos(e);return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=o,r[6]=i,r[7]=0,r[8]=0,r[9]=-i,r[10]=o,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r},un.fromYRotation=function(r,e){var i=Math.sin(e),o=Math.cos(e);return r[0]=o,r[1]=0,r[2]=-i,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=i,r[9]=0,r[10]=o,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r},un.fromZRotation=function(r,e){var i=Math.sin(e),o=Math.cos(e);return r[0]=o,r[1]=i,r[2]=0,r[3]=0,r[4]=-i,r[5]=o,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r},un.fromRotationTranslation=j4,un.fromQuat2=function(r,e){var i=new fa.ARRAY_TYPE(3),o=-e[0],l=-e[1],u=-e[2],h=e[3],m=e[4],_=e[5],v=e[6],x=e[7],w=o*o+l*l+u*u+h*h;return w>0?(i[0]=2*(m*h+x*o+_*u-v*l)/w,i[1]=2*(_*h+x*l+v*o-m*u)/w,i[2]=2*(v*h+x*u+m*l-_*o)/w):(i[0]=2*(m*h+x*o+_*u-v*l),i[1]=2*(_*h+x*l+v*o-m*u),i[2]=2*(v*h+x*u+m*l-_*o)),j4(r,e,i),r},un.getTranslation=function(r,e){return r[0]=e[12],r[1]=e[13],r[2]=e[14],r},un.getScaling=W4,un.getRotation=function(r,e){var i=new fa.ARRAY_TYPE(3);W4(i,e);var o=1/i[0],l=1/i[1],u=1/i[2],h=e[0]*o,m=e[1]*l,_=e[2]*u,v=e[4]*o,x=e[5]*l,w=e[6]*u,C=e[8]*o,k=e[9]*l,P=e[10]*u,R=h+x+P,z=0;return R>0?(z=2*Math.sqrt(R+1),r[3]=.25*z,r[0]=(w-k)/z,r[1]=(C-_)/z,r[2]=(m-v)/z):h>x&&h>P?(z=2*Math.sqrt(1+h-x-P),r[3]=(w-k)/z,r[0]=.25*z,r[1]=(m+v)/z,r[2]=(C+_)/z):x>P?(z=2*Math.sqrt(1+x-h-P),r[3]=(C-_)/z,r[0]=(m+v)/z,r[1]=.25*z,r[2]=(w+k)/z):(z=2*Math.sqrt(1+P-h-x),r[3]=(m-v)/z,r[0]=(C+_)/z,r[1]=(w+k)/z,r[2]=.25*z),r},un.fromRotationTranslationScale=function(r,e,i,o){var l=e[0],u=e[1],h=e[2],m=e[3],_=l+l,v=u+u,x=h+h,w=l*_,C=l*v,k=l*x,P=u*v,R=u*x,z=h*x,B=m*_,H=m*v,Z=m*x,Y=o[0],q=o[1],ee=o[2];return r[0]=(1-(P+z))*Y,r[1]=(C+Z)*Y,r[2]=(k-H)*Y,r[3]=0,r[4]=(C-Z)*q,r[5]=(1-(w+z))*q,r[6]=(R+B)*q,r[7]=0,r[8]=(k+H)*ee,r[9]=(R-B)*ee,r[10]=(1-(w+P))*ee,r[11]=0,r[12]=i[0],r[13]=i[1],r[14]=i[2],r[15]=1,r},un.fromRotationTranslationScaleOrigin=function(r,e,i,o,l){var u=e[0],h=e[1],m=e[2],_=e[3],v=u+u,x=h+h,w=m+m,C=u*v,k=u*x,P=u*w,R=h*x,z=h*w,B=m*w,H=_*v,Z=_*x,Y=_*w,q=o[0],ee=o[1],ce=o[2],de=l[0],ge=l[1],ve=l[2],Re=(1-(R+B))*q,ke=(k+Y)*q,$e=(P-Z)*q,Ie=(k-Y)*ee,Qe=(1-(C+B))*ee,st=(z+H)*ee,ft=(P+Z)*ce,Je=(z-H)*ce,tt=(1-(C+R))*ce;return r[0]=Re,r[1]=ke,r[2]=$e,r[3]=0,r[4]=Ie,r[5]=Qe,r[6]=st,r[7]=0,r[8]=ft,r[9]=Je,r[10]=tt,r[11]=0,r[12]=i[0]+de-(Re*de+Ie*ge+ft*ve),r[13]=i[1]+ge-(ke*de+Qe*ge+Je*ve),r[14]=i[2]+ve-($e*de+st*ge+tt*ve),r[15]=1,r},un.fromQuat=function(r,e){var i=e[0],o=e[1],l=e[2],u=e[3],h=i+i,m=o+o,_=l+l,v=i*h,x=o*h,w=o*m,C=l*h,k=l*m,P=l*_,R=u*h,z=u*m,B=u*_;return r[0]=1-w-P,r[1]=x+B,r[2]=C-z,r[3]=0,r[4]=x-B,r[5]=1-v-P,r[6]=k+R,r[7]=0,r[8]=C+z,r[9]=k-R,r[10]=1-v-w,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r},un.frustum=function(r,e,i,o,l,u,h){var m=1/(i-e),_=1/(l-o),v=1/(u-h);return r[0]=2*u*m,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=2*u*_,r[6]=0,r[7]=0,r[8]=(i+e)*m,r[9]=(l+o)*_,r[10]=(h+u)*v,r[11]=-1,r[12]=0,r[13]=0,r[14]=h*u*2*v,r[15]=0,r},un.perspectiveNO=H4,un.perspectiveZO=function(r,e,i,o,l){var u,h=1/Math.tan(e/2);return r[0]=h/i,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=h,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=-1,r[12]=0,r[13]=0,r[15]=0,l!=null&&l!==1/0?(r[10]=l*(u=1/(o-l)),r[14]=l*o*u):(r[10]=-1,r[14]=-o),r},un.perspectiveFromFieldOfView=function(r,e,i,o){var l=Math.tan(e.upDegrees*Math.PI/180),u=Math.tan(e.downDegrees*Math.PI/180),h=Math.tan(e.leftDegrees*Math.PI/180),m=Math.tan(e.rightDegrees*Math.PI/180),_=2/(h+m),v=2/(l+u);return r[0]=_,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=v,r[6]=0,r[7]=0,r[8]=-(h-m)*_*.5,r[9]=(l-u)*v*.5,r[10]=o/(i-o),r[11]=-1,r[12]=0,r[13]=0,r[14]=o*i/(i-o),r[15]=0,r},un.orthoNO=G4,un.orthoZO=function(r,e,i,o,l,u,h){var m=1/(e-i),_=1/(o-l),v=1/(u-h);return r[0]=-2*m,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=-2*_,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=v,r[11]=0,r[12]=(e+i)*m,r[13]=(l+o)*_,r[14]=u*v,r[15]=1,r},un.lookAt=function(r,e,i,o){var l,u,h,m,_,v,x,w,C,k,P=e[0],R=e[1],z=e[2],B=o[0],H=o[1],Z=o[2],Y=i[0],q=i[1],ee=i[2];return Math.abs(P-Y)<fa.EPSILON&&Math.abs(R-q)<fa.EPSILON&&Math.abs(z-ee)<fa.EPSILON?$4(r):(x=P-Y,w=R-q,C=z-ee,l=H*(C*=k=1/Math.hypot(x,w,C))-Z*(w*=k),u=Z*(x*=k)-B*C,h=B*w-H*x,(k=Math.hypot(l,u,h))?(l*=k=1/k,u*=k,h*=k):(l=0,u=0,h=0),m=w*h-C*u,_=C*l-x*h,v=x*u-w*l,(k=Math.hypot(m,_,v))?(m*=k=1/k,_*=k,v*=k):(m=0,_=0,v=0),r[0]=l,r[1]=m,r[2]=x,r[3]=0,r[4]=u,r[5]=_,r[6]=w,r[7]=0,r[8]=h,r[9]=v,r[10]=C,r[11]=0,r[12]=-(l*P+u*R+h*z),r[13]=-(m*P+_*R+v*z),r[14]=-(x*P+w*R+C*z),r[15]=1,r)},un.targetTo=function(r,e,i,o){var l=e[0],u=e[1],h=e[2],m=o[0],_=o[1],v=o[2],x=l-i[0],w=u-i[1],C=h-i[2],k=x*x+w*w+C*C;k>0&&(x*=k=1/Math.sqrt(k),w*=k,C*=k);var P=_*C-v*w,R=v*x-m*C,z=m*w-_*x;return(k=P*P+R*R+z*z)>0&&(P*=k=1/Math.sqrt(k),R*=k,z*=k),r[0]=P,r[1]=R,r[2]=z,r[3]=0,r[4]=w*z-C*R,r[5]=C*P-x*z,r[6]=x*R-w*P,r[7]=0,r[8]=x,r[9]=w,r[10]=C,r[11]=0,r[12]=l,r[13]=u,r[14]=h,r[15]=1,r},un.str=function(r){return"mat4("+r[0]+", "+r[1]+", "+r[2]+", "+r[3]+", "+r[4]+", "+r[5]+", "+r[6]+", "+r[7]+", "+r[8]+", "+r[9]+", "+r[10]+", "+r[11]+", "+r[12]+", "+r[13]+", "+r[14]+", "+r[15]+")"},un.frob=function(r){return Math.hypot(r[0],r[1],r[2],r[3],r[4],r[5],r[6],r[7],r[8],r[9],r[10],r[11],r[12],r[13],r[14],r[15])},un.add=function(r,e,i){return r[0]=e[0]+i[0],r[1]=e[1]+i[1],r[2]=e[2]+i[2],r[3]=e[3]+i[3],r[4]=e[4]+i[4],r[5]=e[5]+i[5],r[6]=e[6]+i[6],r[7]=e[7]+i[7],r[8]=e[8]+i[8],r[9]=e[9]+i[9],r[10]=e[10]+i[10],r[11]=e[11]+i[11],r[12]=e[12]+i[12],r[13]=e[13]+i[13],r[14]=e[14]+i[14],r[15]=e[15]+i[15],r},un.subtract=q4,un.multiplyScalar=function(r,e,i){return r[0]=e[0]*i,r[1]=e[1]*i,r[2]=e[2]*i,r[3]=e[3]*i,r[4]=e[4]*i,r[5]=e[5]*i,r[6]=e[6]*i,r[7]=e[7]*i,r[8]=e[8]*i,r[9]=e[9]*i,r[10]=e[10]*i,r[11]=e[11]*i,r[12]=e[12]*i,r[13]=e[13]*i,r[14]=e[14]*i,r[15]=e[15]*i,r},un.multiplyScalarAndAdd=function(r,e,i,o){return r[0]=e[0]+i[0]*o,r[1]=e[1]+i[1]*o,r[2]=e[2]+i[2]*o,r[3]=e[3]+i[3]*o,r[4]=e[4]+i[4]*o,r[5]=e[5]+i[5]*o,r[6]=e[6]+i[6]*o,r[7]=e[7]+i[7]*o,r[8]=e[8]+i[8]*o,r[9]=e[9]+i[9]*o,r[10]=e[10]+i[10]*o,r[11]=e[11]+i[11]*o,r[12]=e[12]+i[12]*o,r[13]=e[13]+i[13]*o,r[14]=e[14]+i[14]*o,r[15]=e[15]+i[15]*o,r},un.exactEquals=function(r,e){return r[0]===e[0]&&r[1]===e[1]&&r[2]===e[2]&&r[3]===e[3]&&r[4]===e[4]&&r[5]===e[5]&&r[6]===e[6]&&r[7]===e[7]&&r[8]===e[8]&&r[9]===e[9]&&r[10]===e[10]&&r[11]===e[11]&&r[12]===e[12]&&r[13]===e[13]&&r[14]===e[14]&&r[15]===e[15]},un.equals=function(r,e){var i=r[0],o=r[1],l=r[2],u=r[3],h=r[4],m=r[5],_=r[6],v=r[7],x=r[8],w=r[9],C=r[10],k=r[11],P=r[12],R=r[13],z=r[14],B=r[15],H=e[0],Z=e[1],Y=e[2],q=e[3],ee=e[4],ce=e[5],de=e[6],ge=e[7],ve=e[8],Re=e[9],ke=e[10],$e=e[11],Ie=e[12],Qe=e[13],st=e[14],ft=e[15];return Math.abs(i-H)<=fa.EPSILON*Math.max(1,Math.abs(i),Math.abs(H))&&Math.abs(o-Z)<=fa.EPSILON*Math.max(1,Math.abs(o),Math.abs(Z))&&Math.abs(l-Y)<=fa.EPSILON*Math.max(1,Math.abs(l),Math.abs(Y))&&Math.abs(u-q)<=fa.EPSILON*Math.max(1,Math.abs(u),Math.abs(q))&&Math.abs(h-ee)<=fa.EPSILON*Math.max(1,Math.abs(h),Math.abs(ee))&&Math.abs(m-ce)<=fa.EPSILON*Math.max(1,Math.abs(m),Math.abs(ce))&&Math.abs(_-de)<=fa.EPSILON*Math.max(1,Math.abs(_),Math.abs(de))&&Math.abs(v-ge)<=fa.EPSILON*Math.max(1,Math.abs(v),Math.abs(ge))&&Math.abs(x-ve)<=fa.EPSILON*Math.max(1,Math.abs(x),Math.abs(ve))&&Math.abs(w-Re)<=fa.EPSILON*Math.max(1,Math.abs(w),Math.abs(Re))&&Math.abs(C-ke)<=fa.EPSILON*Math.max(1,Math.abs(C),Math.abs(ke))&&Math.abs(k-$e)<=fa.EPSILON*Math.max(1,Math.abs(k),Math.abs($e))&&Math.abs(P-Ie)<=fa.EPSILON*Math.max(1,Math.abs(P),Math.abs(Ie))&&Math.abs(R-Qe)<=fa.EPSILON*Math.max(1,Math.abs(R),Math.abs(Qe))&&Math.abs(z-st)<=fa.EPSILON*Math.max(1,Math.abs(z),Math.abs(st))&&Math.abs(B-ft)<=fa.EPSILON*Math.max(1,Math.abs(B),Math.abs(ft))},un.sub=un.mul=un.ortho=un.perspective=void 0;var fa=function(r,e){if(r&&r.__esModule)return r;if(r===null||N2(r)!=="object"&&typeof r!="function")return{default:r};var i=U4(void 0);if(i&&i.has(r))return i.get(r);var o={},l=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in r)if(u!=="default"&&Object.prototype.hasOwnProperty.call(r,u)){var h=l?Object.getOwnPropertyDescriptor(r,u):null;h&&(h.get||h.set)?Object.defineProperty(o,u,h):o[u]=r[u]}return o.default=r,i&&i.set(r,o),o}(Na);function U4(r){if(typeof WeakMap!="function")return null;var e=new WeakMap,i=new WeakMap;return(U4=function(o){return o?i:e})(r)}function $4(r){return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function V4(r,e,i){var o=e[0],l=e[1],u=e[2],h=e[3],m=e[4],_=e[5],v=e[6],x=e[7],w=e[8],C=e[9],k=e[10],P=e[11],R=e[12],z=e[13],B=e[14],H=e[15],Z=i[0],Y=i[1],q=i[2],ee=i[3];return r[0]=Z*o+Y*m+q*w+ee*R,r[1]=Z*l+Y*_+q*C+ee*z,r[2]=Z*u+Y*v+q*k+ee*B,r[3]=Z*h+Y*x+q*P+ee*H,r[4]=(Z=i[4])*o+(Y=i[5])*m+(q=i[6])*w+(ee=i[7])*R,r[5]=Z*l+Y*_+q*C+ee*z,r[6]=Z*u+Y*v+q*k+ee*B,r[7]=Z*h+Y*x+q*P+ee*H,r[8]=(Z=i[8])*o+(Y=i[9])*m+(q=i[10])*w+(ee=i[11])*R,r[9]=Z*l+Y*_+q*C+ee*z,r[10]=Z*u+Y*v+q*k+ee*B,r[11]=Z*h+Y*x+q*P+ee*H,r[12]=(Z=i[12])*o+(Y=i[13])*m+(q=i[14])*w+(ee=i[15])*R,r[13]=Z*l+Y*_+q*C+ee*z,r[14]=Z*u+Y*v+q*k+ee*B,r[15]=Z*h+Y*x+q*P+ee*H,r}function j4(r,e,i){var o=e[0],l=e[1],u=e[2],h=e[3],m=o+o,_=l+l,v=u+u,x=o*m,w=o*_,C=o*v,k=l*_,P=l*v,R=u*v,z=h*m,B=h*_,H=h*v;return r[0]=1-(k+R),r[1]=w+H,r[2]=C-B,r[3]=0,r[4]=w-H,r[5]=1-(x+R),r[6]=P+z,r[7]=0,r[8]=C+B,r[9]=P-z,r[10]=1-(x+k),r[11]=0,r[12]=i[0],r[13]=i[1],r[14]=i[2],r[15]=1,r}function W4(r,e){var i=e[4],o=e[5],l=e[6],u=e[8],h=e[9],m=e[10];return r[0]=Math.hypot(e[0],e[1],e[2]),r[1]=Math.hypot(i,o,l),r[2]=Math.hypot(u,h,m),r}function H4(r,e,i,o,l){var u,h=1/Math.tan(e/2);return r[0]=h/i,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=h,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=-1,r[12]=0,r[13]=0,r[15]=0,l!=null&&l!==1/0?(r[10]=(l+o)*(u=1/(o-l)),r[14]=2*l*o*u):(r[10]=-1,r[14]=-2*o),r}function G4(r,e,i,o,l,u,h){var m=1/(e-i),_=1/(o-l),v=1/(u-h);return r[0]=-2*m,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=-2*_,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=2*v,r[11]=0,r[12]=(e+i)*m,r[13]=(l+o)*_,r[14]=(h+u)*v,r[15]=1,r}function q4(r,e,i){return r[0]=e[0]-i[0],r[1]=e[1]-i[1],r[2]=e[2]-i[2],r[3]=e[3]-i[3],r[4]=e[4]-i[4],r[5]=e[5]-i[5],r[6]=e[6]-i[6],r[7]=e[7]-i[7],r[8]=e[8]-i[8],r[9]=e[9]-i[9],r[10]=e[10]-i[10],r[11]=e[11]-i[11],r[12]=e[12]-i[12],r[13]=e[13]-i[13],r[14]=e[14]-i[14],r[15]=e[15]-i[15],r}un.perspective=H4,un.ortho=G4,un.mul=V4,un.sub=q4;var tn={},ln={};function U2(r){return U2=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},U2(r)}Object.defineProperty(ln,"__esModule",{value:!0}),ln.create=Z4,ln.clone=function(r){var e=new Tu.ARRAY_TYPE(3);return e[0]=r[0],e[1]=r[1],e[2]=r[2],e},ln.length=K4,ln.fromValues=function(r,e,i){var o=new Tu.ARRAY_TYPE(3);return o[0]=r,o[1]=e,o[2]=i,o},ln.copy=function(r,e){return r[0]=e[0],r[1]=e[1],r[2]=e[2],r},ln.set=function(r,e,i,o){return r[0]=e,r[1]=i,r[2]=o,r},ln.add=function(r,e,i){return r[0]=e[0]+i[0],r[1]=e[1]+i[1],r[2]=e[2]+i[2],r},ln.subtract=Y4,ln.multiply=J4,ln.divide=Q4,ln.ceil=function(r,e){return r[0]=Math.ceil(e[0]),r[1]=Math.ceil(e[1]),r[2]=Math.ceil(e[2]),r},ln.floor=function(r,e){return r[0]=Math.floor(e[0]),r[1]=Math.floor(e[1]),r[2]=Math.floor(e[2]),r},ln.min=function(r,e,i){return r[0]=Math.min(e[0],i[0]),r[1]=Math.min(e[1],i[1]),r[2]=Math.min(e[2],i[2]),r},ln.max=function(r,e,i){return r[0]=Math.max(e[0],i[0]),r[1]=Math.max(e[1],i[1]),r[2]=Math.max(e[2],i[2]),r},ln.round=function(r,e){return r[0]=Math.round(e[0]),r[1]=Math.round(e[1]),r[2]=Math.round(e[2]),r},ln.scale=function(r,e,i){return r[0]=e[0]*i,r[1]=e[1]*i,r[2]=e[2]*i,r},ln.scaleAndAdd=function(r,e,i,o){return r[0]=e[0]+i[0]*o,r[1]=e[1]+i[1]*o,r[2]=e[2]+i[2]*o,r},ln.distance=eI,ln.squaredDistance=tI,ln.squaredLength=rI,ln.negate=function(r,e){return r[0]=-e[0],r[1]=-e[1],r[2]=-e[2],r},ln.inverse=function(r,e){return r[0]=1/e[0],r[1]=1/e[1],r[2]=1/e[2],r},ln.normalize=function(r,e){var i=e[0],o=e[1],l=e[2],u=i*i+o*o+l*l;return u>0&&(u=1/Math.sqrt(u)),r[0]=e[0]*u,r[1]=e[1]*u,r[2]=e[2]*u,r},ln.dot=nI,ln.cross=function(r,e,i){var o=e[0],l=e[1],u=e[2],h=i[0],m=i[1],_=i[2];return r[0]=l*_-u*m,r[1]=u*h-o*_,r[2]=o*m-l*h,r},ln.lerp=function(r,e,i,o){var l=e[0],u=e[1],h=e[2];return r[0]=l+o*(i[0]-l),r[1]=u+o*(i[1]-u),r[2]=h+o*(i[2]-h),r},ln.hermite=function(r,e,i,o,l,u){var h=u*u,m=h*(2*u-3)+1,_=h*(u-2)+u,v=h*(u-1),x=h*(3-2*u);return r[0]=e[0]*m+i[0]*_+o[0]*v+l[0]*x,r[1]=e[1]*m+i[1]*_+o[1]*v+l[1]*x,r[2]=e[2]*m+i[2]*_+o[2]*v+l[2]*x,r},ln.bezier=function(r,e,i,o,l,u){var h=1-u,m=h*h,_=u*u,v=m*h,x=3*u*m,w=3*_*h,C=_*u;return r[0]=e[0]*v+i[0]*x+o[0]*w+l[0]*C,r[1]=e[1]*v+i[1]*x+o[1]*w+l[1]*C,r[2]=e[2]*v+i[2]*x+o[2]*w+l[2]*C,r},ln.random=function(r,e){e=e||1;var i=2*Tu.RANDOM()*Math.PI,o=2*Tu.RANDOM()-1,l=Math.sqrt(1-o*o)*e;return r[0]=Math.cos(i)*l,r[1]=Math.sin(i)*l,r[2]=o*e,r},ln.transformMat4=function(r,e,i){var o=e[0],l=e[1],u=e[2],h=i[3]*o+i[7]*l+i[11]*u+i[15];return r[0]=(i[0]*o+i[4]*l+i[8]*u+i[12])/(h=h||1),r[1]=(i[1]*o+i[5]*l+i[9]*u+i[13])/h,r[2]=(i[2]*o+i[6]*l+i[10]*u+i[14])/h,r},ln.transformMat3=function(r,e,i){var o=e[0],l=e[1],u=e[2];return r[0]=o*i[0]+l*i[3]+u*i[6],r[1]=o*i[1]+l*i[4]+u*i[7],r[2]=o*i[2]+l*i[5]+u*i[8],r},ln.transformQuat=function(r,e,i){var o=i[0],l=i[1],u=i[2],h=e[0],m=e[1],_=e[2],v=l*_-u*m,x=u*h-o*_,w=o*m-l*h,C=l*w-u*x,k=u*v-o*w,P=o*x-l*v,R=2*i[3];return x*=R,w*=R,k*=2,P*=2,r[0]=h+(v*=R)+(C*=2),r[1]=m+x+k,r[2]=_+w+P,r},ln.rotateX=function(r,e,i,o){var l=[],u=[];return l[0]=e[0]-i[0],l[1]=e[1]-i[1],l[2]=e[2]-i[2],u[0]=l[0],u[1]=l[1]*Math.cos(o)-l[2]*Math.sin(o),u[2]=l[1]*Math.sin(o)+l[2]*Math.cos(o),r[0]=u[0]+i[0],r[1]=u[1]+i[1],r[2]=u[2]+i[2],r},ln.rotateY=function(r,e,i,o){var l=[],u=[];return l[0]=e[0]-i[0],l[1]=e[1]-i[1],l[2]=e[2]-i[2],u[0]=l[2]*Math.sin(o)+l[0]*Math.cos(o),u[1]=l[1],u[2]=l[2]*Math.cos(o)-l[0]*Math.sin(o),r[0]=u[0]+i[0],r[1]=u[1]+i[1],r[2]=u[2]+i[2],r},ln.rotateZ=function(r,e,i,o){var l=[],u=[];return l[0]=e[0]-i[0],l[1]=e[1]-i[1],l[2]=e[2]-i[2],u[0]=l[0]*Math.cos(o)-l[1]*Math.sin(o),u[1]=l[0]*Math.sin(o)+l[1]*Math.cos(o),u[2]=l[2],r[0]=u[0]+i[0],r[1]=u[1]+i[1],r[2]=u[2]+i[2],r},ln.angle=function(r,e){var i=r[0],o=r[1],l=r[2],u=e[0],h=e[1],m=e[2],_=Math.sqrt(i*i+o*o+l*l)*Math.sqrt(u*u+h*h+m*m),v=_&&nI(r,e)/_;return Math.acos(Math.min(Math.max(v,-1),1))},ln.zero=function(r){return r[0]=0,r[1]=0,r[2]=0,r},ln.str=function(r){return"vec3("+r[0]+", "+r[1]+", "+r[2]+")"},ln.exactEquals=function(r,e){return r[0]===e[0]&&r[1]===e[1]&&r[2]===e[2]},ln.equals=function(r,e){var i=r[0],o=r[1],l=r[2],u=e[0],h=e[1],m=e[2];return Math.abs(i-u)<=Tu.EPSILON*Math.max(1,Math.abs(i),Math.abs(u))&&Math.abs(o-h)<=Tu.EPSILON*Math.max(1,Math.abs(o),Math.abs(h))&&Math.abs(l-m)<=Tu.EPSILON*Math.max(1,Math.abs(l),Math.abs(m))},ln.forEach=ln.sqrLen=ln.len=ln.sqrDist=ln.dist=ln.div=ln.mul=ln.sub=void 0;var Tu=function(r,e){if(r&&r.__esModule)return r;if(r===null||U2(r)!=="object"&&typeof r!="function")return{default:r};var i=X4(void 0);if(i&&i.has(r))return i.get(r);var o={},l=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in r)if(u!=="default"&&Object.prototype.hasOwnProperty.call(r,u)){var h=l?Object.getOwnPropertyDescriptor(r,u):null;h&&(h.get||h.set)?Object.defineProperty(o,u,h):o[u]=r[u]}return o.default=r,i&&i.set(r,o),o}(Na);function X4(r){if(typeof WeakMap!="function")return null;var e=new WeakMap,i=new WeakMap;return(X4=function(o){return o?i:e})(r)}function Z4(){var r=new Tu.ARRAY_TYPE(3);return Tu.ARRAY_TYPE!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0),r}function K4(r){return Math.hypot(r[0],r[1],r[2])}function Y4(r,e,i){return r[0]=e[0]-i[0],r[1]=e[1]-i[1],r[2]=e[2]-i[2],r}function J4(r,e,i){return r[0]=e[0]*i[0],r[1]=e[1]*i[1],r[2]=e[2]*i[2],r}function Q4(r,e,i){return r[0]=e[0]/i[0],r[1]=e[1]/i[1],r[2]=e[2]/i[2],r}function eI(r,e){return Math.hypot(e[0]-r[0],e[1]-r[1],e[2]-r[2])}function tI(r,e){var i=e[0]-r[0],o=e[1]-r[1],l=e[2]-r[2];return i*i+o*o+l*l}function rI(r){var e=r[0],i=r[1],o=r[2];return e*e+i*i+o*o}function nI(r,e){return r[0]*e[0]+r[1]*e[1]+r[2]*e[2]}ln.sub=Y4,ln.mul=J4,ln.div=Q4,ln.dist=eI,ln.sqrDist=tI,ln.len=K4,ln.sqrLen=rI;var Su,EV=(Su=Z4(),function(r,e,i,o,l,u){var h,m;for(e||(e=3),i||(i=0),m=o?Math.min(o*e+i,r.length):r.length,h=i;h<m;h+=e)Su[0]=r[h],Su[1]=r[h+1],Su[2]=r[h+2],l(Su,Su,u),r[h]=Su[0],r[h+1]=Su[1],r[h+2]=Su[2];return r});ln.forEach=EV;var kn={};function $2(r){return $2=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},$2(r)}Object.defineProperty(kn,"__esModule",{value:!0}),kn.create=aI,kn.clone=function(r){var e=new ml.ARRAY_TYPE(4);return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e},kn.fromValues=function(r,e,i,o){var l=new ml.ARRAY_TYPE(4);return l[0]=r,l[1]=e,l[2]=i,l[3]=o,l},kn.copy=function(r,e){return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r},kn.set=function(r,e,i,o,l){return r[0]=e,r[1]=i,r[2]=o,r[3]=l,r},kn.add=function(r,e,i){return r[0]=e[0]+i[0],r[1]=e[1]+i[1],r[2]=e[2]+i[2],r[3]=e[3]+i[3],r},kn.subtract=oI,kn.multiply=sI,kn.divide=lI,kn.ceil=function(r,e){return r[0]=Math.ceil(e[0]),r[1]=Math.ceil(e[1]),r[2]=Math.ceil(e[2]),r[3]=Math.ceil(e[3]),r},kn.floor=function(r,e){return r[0]=Math.floor(e[0]),r[1]=Math.floor(e[1]),r[2]=Math.floor(e[2]),r[3]=Math.floor(e[3]),r},kn.min=function(r,e,i){return r[0]=Math.min(e[0],i[0]),r[1]=Math.min(e[1],i[1]),r[2]=Math.min(e[2],i[2]),r[3]=Math.min(e[3],i[3]),r},kn.max=function(r,e,i){return r[0]=Math.max(e[0],i[0]),r[1]=Math.max(e[1],i[1]),r[2]=Math.max(e[2],i[2]),r[3]=Math.max(e[3],i[3]),r},kn.round=function(r,e){return r[0]=Math.round(e[0]),r[1]=Math.round(e[1]),r[2]=Math.round(e[2]),r[3]=Math.round(e[3]),r},kn.scale=function(r,e,i){return r[0]=e[0]*i,r[1]=e[1]*i,r[2]=e[2]*i,r[3]=e[3]*i,r},kn.scaleAndAdd=function(r,e,i,o){return r[0]=e[0]+i[0]*o,r[1]=e[1]+i[1]*o,r[2]=e[2]+i[2]*o,r[3]=e[3]+i[3]*o,r},kn.distance=cI,kn.squaredDistance=uI,kn.length=fI,kn.squaredLength=hI,kn.negate=function(r,e){return r[0]=-e[0],r[1]=-e[1],r[2]=-e[2],r[3]=-e[3],r},kn.inverse=function(r,e){return r[0]=1/e[0],r[1]=1/e[1],r[2]=1/e[2],r[3]=1/e[3],r},kn.normalize=function(r,e){var i=e[0],o=e[1],l=e[2],u=e[3],h=i*i+o*o+l*l+u*u;return h>0&&(h=1/Math.sqrt(h)),r[0]=i*h,r[1]=o*h,r[2]=l*h,r[3]=u*h,r},kn.dot=function(r,e){return r[0]*e[0]+r[1]*e[1]+r[2]*e[2]+r[3]*e[3]},kn.cross=function(r,e,i,o){var l=i[0]*o[1]-i[1]*o[0],u=i[0]*o[2]-i[2]*o[0],h=i[0]*o[3]-i[3]*o[0],m=i[1]*o[2]-i[2]*o[1],_=i[1]*o[3]-i[3]*o[1],v=i[2]*o[3]-i[3]*o[2],x=e[0],w=e[1],C=e[2],k=e[3];return r[0]=w*v-C*_+k*m,r[1]=-x*v+C*h-k*u,r[2]=x*_-w*h+k*l,r[3]=-x*m+w*u-C*l,r},kn.lerp=function(r,e,i,o){var l=e[0],u=e[1],h=e[2],m=e[3];return r[0]=l+o*(i[0]-l),r[1]=u+o*(i[1]-u),r[2]=h+o*(i[2]-h),r[3]=m+o*(i[3]-m),r},kn.random=function(r,e){var i,o,l,u,h,m;e=e||1;do h=(i=2*ml.RANDOM()-1)*i+(o=2*ml.RANDOM()-1)*o;while(h>=1);do m=(l=2*ml.RANDOM()-1)*l+(u=2*ml.RANDOM()-1)*u;while(m>=1);var _=Math.sqrt((1-h)/m);return r[0]=e*i,r[1]=e*o,r[2]=e*l*_,r[3]=e*u*_,r},kn.transformMat4=function(r,e,i){var o=e[0],l=e[1],u=e[2],h=e[3];return r[0]=i[0]*o+i[4]*l+i[8]*u+i[12]*h,r[1]=i[1]*o+i[5]*l+i[9]*u+i[13]*h,r[2]=i[2]*o+i[6]*l+i[10]*u+i[14]*h,r[3]=i[3]*o+i[7]*l+i[11]*u+i[15]*h,r},kn.transformQuat=function(r,e,i){var o=e[0],l=e[1],u=e[2],h=i[0],m=i[1],_=i[2],v=i[3],x=v*o+m*u-_*l,w=v*l+_*o-h*u,C=v*u+h*l-m*o,k=-h*o-m*l-_*u;return r[0]=x*v+k*-h+w*-_-C*-m,r[1]=w*v+k*-m+C*-h-x*-_,r[2]=C*v+k*-_+x*-m-w*-h,r[3]=e[3],r},kn.zero=function(r){return r[0]=0,r[1]=0,r[2]=0,r[3]=0,r},kn.str=function(r){return"vec4("+r[0]+", "+r[1]+", "+r[2]+", "+r[3]+")"},kn.exactEquals=function(r,e){return r[0]===e[0]&&r[1]===e[1]&&r[2]===e[2]&&r[3]===e[3]},kn.equals=function(r,e){var i=r[0],o=r[1],l=r[2],u=r[3],h=e[0],m=e[1],_=e[2],v=e[3];return Math.abs(i-h)<=ml.EPSILON*Math.max(1,Math.abs(i),Math.abs(h))&&Math.abs(o-m)<=ml.EPSILON*Math.max(1,Math.abs(o),Math.abs(m))&&Math.abs(l-_)<=ml.EPSILON*Math.max(1,Math.abs(l),Math.abs(_))&&Math.abs(u-v)<=ml.EPSILON*Math.max(1,Math.abs(u),Math.abs(v))},kn.forEach=kn.sqrLen=kn.len=kn.sqrDist=kn.dist=kn.div=kn.mul=kn.sub=void 0;var ml=function(r,e){if(r&&r.__esModule)return r;if(r===null||$2(r)!=="object"&&typeof r!="function")return{default:r};var i=iI(void 0);if(i&&i.has(r))return i.get(r);var o={},l=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in r)if(u!=="default"&&Object.prototype.hasOwnProperty.call(r,u)){var h=l?Object.getOwnPropertyDescriptor(r,u):null;h&&(h.get||h.set)?Object.defineProperty(o,u,h):o[u]=r[u]}return o.default=r,i&&i.set(r,o),o}(Na);function iI(r){if(typeof WeakMap!="function")return null;var e=new WeakMap,i=new WeakMap;return(iI=function(o){return o?i:e})(r)}function aI(){var r=new ml.ARRAY_TYPE(4);return ml.ARRAY_TYPE!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0,r[3]=0),r}function oI(r,e,i){return r[0]=e[0]-i[0],r[1]=e[1]-i[1],r[2]=e[2]-i[2],r[3]=e[3]-i[3],r}function sI(r,e,i){return r[0]=e[0]*i[0],r[1]=e[1]*i[1],r[2]=e[2]*i[2],r[3]=e[3]*i[3],r}function lI(r,e,i){return r[0]=e[0]/i[0],r[1]=e[1]/i[1],r[2]=e[2]/i[2],r[3]=e[3]/i[3],r}function cI(r,e){return Math.hypot(e[0]-r[0],e[1]-r[1],e[2]-r[2],e[3]-r[3])}function uI(r,e){var i=e[0]-r[0],o=e[1]-r[1],l=e[2]-r[2],u=e[3]-r[3];return i*i+o*o+l*l+u*u}function fI(r){return Math.hypot(r[0],r[1],r[2],r[3])}function hI(r){var e=r[0],i=r[1],o=r[2],l=r[3];return e*e+i*i+o*o+l*l}kn.sub=oI,kn.mul=sI,kn.div=lI,kn.dist=cI,kn.sqrDist=uI,kn.len=fI,kn.sqrLen=hI;var TV=function(){var r=aI();return function(e,i,o,l,u,h){var m,_;for(i||(i=4),o||(o=0),_=l?Math.min(l*i+o,e.length):e.length,m=o;m<_;m+=i)r[0]=e[m],r[1]=e[m+1],r[2]=e[m+2],r[3]=e[m+3],u(r,r,h),e[m]=r[0],e[m+1]=r[1],e[m+2]=r[2],e[m+3]=r[3];return e}}();function V2(r){return V2=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},V2(r)}kn.forEach=TV,Object.defineProperty(tn,"__esModule",{value:!0}),tn.create=j2,tn.identity=function(r){return r[0]=0,r[1]=0,r[2]=0,r[3]=1,r},tn.setAxisAngle=pI,tn.getAxisAngle=function(r,e){var i=2*Math.acos(e[3]),o=Math.sin(i/2);return o>id.EPSILON?(r[0]=e[0]/o,r[1]=e[1]/o,r[2]=e[2]/o):(r[0]=1,r[1]=0,r[2]=0),i},tn.getAngle=function(r,e){var i=xI(r,e);return Math.acos(2*i*i-1)},tn.multiply=mI,tn.rotateX=function(r,e,i){i*=.5;var o=e[0],l=e[1],u=e[2],h=e[3],m=Math.sin(i),_=Math.cos(i);return r[0]=o*_+h*m,r[1]=l*_+u*m,r[2]=u*_-l*m,r[3]=h*_-o*m,r},tn.rotateY=function(r,e,i){i*=.5;var o=e[0],l=e[1],u=e[2],h=e[3],m=Math.sin(i),_=Math.cos(i);return r[0]=o*_-u*m,r[1]=l*_+h*m,r[2]=u*_+o*m,r[3]=h*_-l*m,r},tn.rotateZ=function(r,e,i){i*=.5;var o=e[0],l=e[1],u=e[2],h=e[3],m=Math.sin(i),_=Math.cos(i);return r[0]=o*_+l*m,r[1]=l*_-o*m,r[2]=u*_+h*m,r[3]=h*_-u*m,r},tn.calculateW=function(r,e){var i=e[0],o=e[1],l=e[2];return r[0]=i,r[1]=o,r[2]=l,r[3]=Math.sqrt(Math.abs(1-i*i-o*o-l*l)),r},tn.exp=gI,tn.ln=_I,tn.pow=function(r,e,i){return _I(r,e),yI(r,r,i),gI(r,r),r},tn.slerp=f1,tn.random=function(r){var e=id.RANDOM(),i=id.RANDOM(),o=id.RANDOM(),l=Math.sqrt(1-e),u=Math.sqrt(e);return r[0]=l*Math.sin(2*Math.PI*i),r[1]=l*Math.cos(2*Math.PI*i),r[2]=u*Math.sin(2*Math.PI*o),r[3]=u*Math.cos(2*Math.PI*o),r},tn.invert=function(r,e){var i=e[0],o=e[1],l=e[2],u=e[3],h=i*i+o*o+l*l+u*u,m=h?1/h:0;return r[0]=-i*m,r[1]=-o*m,r[2]=-l*m,r[3]=u*m,r},tn.conjugate=function(r,e){return r[0]=-e[0],r[1]=-e[1],r[2]=-e[2],r[3]=e[3],r},tn.fromMat3=vI,tn.fromEuler=function(r,e,i,o){var l=.5*Math.PI/180;e*=l,i*=l,o*=l;var u=Math.sin(e),h=Math.cos(e),m=Math.sin(i),_=Math.cos(i),v=Math.sin(o),x=Math.cos(o);return r[0]=u*_*x-h*m*v,r[1]=h*m*x+u*_*v,r[2]=h*_*v-u*m*x,r[3]=h*_*x+u*m*v,r},tn.str=function(r){return"quat("+r[0]+", "+r[1]+", "+r[2]+", "+r[3]+")"},tn.setAxes=tn.sqlerp=tn.rotationTo=tn.equals=tn.exactEquals=tn.normalize=tn.sqrLen=tn.squaredLength=tn.len=tn.length=tn.lerp=tn.dot=tn.scale=tn.mul=tn.add=tn.set=tn.copy=tn.fromValues=tn.clone=void 0;var id=u1(Na),SV=u1(mi),Cu=u1(ln),Js=u1(kn);function dI(r){if(typeof WeakMap!="function")return null;var e=new WeakMap,i=new WeakMap;return(dI=function(o){return o?i:e})(r)}function u1(r,e){if(!e&&r&&r.__esModule)return r;if(r===null||V2(r)!=="object"&&typeof r!="function")return{default:r};var i=dI(e);if(i&&i.has(r))return i.get(r);var o={},l=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in r)if(u!=="default"&&Object.prototype.hasOwnProperty.call(r,u)){var h=l?Object.getOwnPropertyDescriptor(r,u):null;h&&(h.get||h.set)?Object.defineProperty(o,u,h):o[u]=r[u]}return o.default=r,i&&i.set(r,o),o}function j2(){var r=new id.ARRAY_TYPE(4);return id.ARRAY_TYPE!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0),r[3]=1,r}function pI(r,e,i){i*=.5;var o=Math.sin(i);return r[0]=o*e[0],r[1]=o*e[1],r[2]=o*e[2],r[3]=Math.cos(i),r}function mI(r,e,i){var o=e[0],l=e[1],u=e[2],h=e[3],m=i[0],_=i[1],v=i[2],x=i[3];return r[0]=o*x+h*m+l*v-u*_,r[1]=l*x+h*_+u*m-o*v,r[2]=u*x+h*v+o*_-l*m,r[3]=h*x-o*m-l*_-u*v,r}function gI(r,e){var i=e[0],o=e[1],l=e[2],u=e[3],h=Math.sqrt(i*i+o*o+l*l),m=Math.exp(u),_=h>0?m*Math.sin(h)/h:0;return r[0]=i*_,r[1]=o*_,r[2]=l*_,r[3]=m*Math.cos(h),r}function _I(r,e){var i=e[0],o=e[1],l=e[2],u=e[3],h=Math.sqrt(i*i+o*o+l*l),m=h>0?Math.atan2(h,u)/h:0;return r[0]=i*m,r[1]=o*m,r[2]=l*m,r[3]=.5*Math.log(i*i+o*o+l*l+u*u),r}function f1(r,e,i,o){var l,u,h,m,_,v=e[0],x=e[1],w=e[2],C=e[3],k=i[0],P=i[1],R=i[2],z=i[3];return(u=v*k+x*P+w*R+C*z)<0&&(u=-u,k=-k,P=-P,R=-R,z=-z),1-u>id.EPSILON?(l=Math.acos(u),h=Math.sin(l),m=Math.sin((1-o)*l)/h,_=Math.sin(o*l)/h):(m=1-o,_=o),r[0]=m*v+_*k,r[1]=m*x+_*P,r[2]=m*w+_*R,r[3]=m*C+_*z,r}function vI(r,e){var i,o=e[0]+e[4]+e[8];if(o>0)i=Math.sqrt(o+1),r[3]=.5*i,r[0]=(e[5]-e[7])*(i=.5/i),r[1]=(e[6]-e[2])*i,r[2]=(e[1]-e[3])*i;else{var l=0;e[4]>e[0]&&(l=1),e[8]>e[3*l+l]&&(l=2);var u=(l+1)%3,h=(l+2)%3;i=Math.sqrt(e[3*l+l]-e[3*u+u]-e[3*h+h]+1),r[l]=.5*i,r[3]=(e[3*u+h]-e[3*h+u])*(i=.5/i),r[u]=(e[3*u+l]+e[3*l+u])*i,r[h]=(e[3*h+l]+e[3*l+h])*i}return r}tn.clone=Js.clone,tn.fromValues=Js.fromValues,tn.copy=Js.copy,tn.set=Js.set,tn.add=Js.add,tn.mul=mI;var yI=Js.scale;tn.scale=yI;var xI=Js.dot;tn.dot=xI,tn.lerp=Js.lerp;var bI=Js.length;tn.length=bI,tn.len=bI;var wI=Js.squaredLength;tn.squaredLength=wI,tn.sqrLen=wI;var W2=Js.normalize;tn.normalize=W2,tn.exactEquals=Js.exactEquals,tn.equals=Js.equals;var Gl,EI,TI,CV=(Gl=Cu.create(),EI=Cu.fromValues(1,0,0),TI=Cu.fromValues(0,1,0),function(r,e,i){var o=Cu.dot(e,i);return o<-.999999?(Cu.cross(Gl,EI,e),Cu.len(Gl)<1e-6&&Cu.cross(Gl,TI,e),Cu.normalize(Gl,Gl),pI(r,Gl,Math.PI),r):o>.999999?(r[0]=0,r[1]=0,r[2]=0,r[3]=1,r):(Cu.cross(Gl,e,i),r[0]=Gl[0],r[1]=Gl[1],r[2]=Gl[2],r[3]=1+o,W2(r,r))});tn.rotationTo=CV;var H2,G2,AV=(H2=j2(),G2=j2(),function(r,e,i,o,l,u){return f1(H2,e,l,u),f1(G2,i,o,u),f1(r,H2,G2,2*u*(1-u)),r});tn.sqlerp=AV;var ql,kV=(ql=SV.create(),function(r,e,i,o){return ql[0]=i[0],ql[3]=i[1],ql[6]=i[2],ql[1]=o[0],ql[4]=o[1],ql[7]=o[2],ql[2]=-e[0],ql[5]=-e[1],ql[8]=-e[2],W2(r,vI(r,ql))});tn.setAxes=kV;var Rn={};function q2(r){return q2=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},q2(r)}Object.defineProperty(Rn,"__esModule",{value:!0}),Rn.create=function(){var r=new ts.ARRAY_TYPE(8);return ts.ARRAY_TYPE!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0,r[4]=0,r[5]=0,r[6]=0,r[7]=0),r[3]=1,r},Rn.clone=function(r){var e=new ts.ARRAY_TYPE(8);return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e[4]=r[4],e[5]=r[5],e[6]=r[6],e[7]=r[7],e},Rn.fromValues=function(r,e,i,o,l,u,h,m){var _=new ts.ARRAY_TYPE(8);return _[0]=r,_[1]=e,_[2]=i,_[3]=o,_[4]=l,_[5]=u,_[6]=h,_[7]=m,_},Rn.fromRotationTranslationValues=function(r,e,i,o,l,u,h){var m=new ts.ARRAY_TYPE(8);m[0]=r,m[1]=e,m[2]=i,m[3]=o;var _=.5*l,v=.5*u,x=.5*h;return m[4]=_*o+v*i-x*e,m[5]=v*o+x*r-_*i,m[6]=x*o+_*e-v*r,m[7]=-_*r-v*e-x*i,m},Rn.fromRotationTranslation=AI,Rn.fromTranslation=function(r,e){return r[0]=0,r[1]=0,r[2]=0,r[3]=1,r[4]=.5*e[0],r[5]=.5*e[1],r[6]=.5*e[2],r[7]=0,r},Rn.fromRotation=function(r,e){return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[4]=0,r[5]=0,r[6]=0,r[7]=0,r},Rn.fromMat4=function(r,e){var i=Au.create();SI.getRotation(i,e);var o=new ts.ARRAY_TYPE(3);return SI.getTranslation(o,e),AI(r,i,o),r},Rn.copy=kI,Rn.identity=function(r){return r[0]=0,r[1]=0,r[2]=0,r[3]=1,r[4]=0,r[5]=0,r[6]=0,r[7]=0,r},Rn.set=function(r,e,i,o,l,u,h,m,_){return r[0]=e,r[1]=i,r[2]=o,r[3]=l,r[4]=u,r[5]=h,r[6]=m,r[7]=_,r},Rn.getDual=function(r,e){return r[0]=e[4],r[1]=e[5],r[2]=e[6],r[3]=e[7],r},Rn.setDual=function(r,e){return r[4]=e[0],r[5]=e[1],r[6]=e[2],r[7]=e[3],r},Rn.getTranslation=function(r,e){var i=e[4],o=e[5],l=e[6],u=e[7],h=-e[0],m=-e[1],_=-e[2],v=e[3];return r[0]=2*(i*v+u*h+o*_-l*m),r[1]=2*(o*v+u*m+l*h-i*_),r[2]=2*(l*v+u*_+i*m-o*h),r},Rn.translate=function(r,e,i){var o=e[0],l=e[1],u=e[2],h=e[3],m=.5*i[0],_=.5*i[1],v=.5*i[2],x=e[4],w=e[5],C=e[6],k=e[7];return r[0]=o,r[1]=l,r[2]=u,r[3]=h,r[4]=h*m+l*v-u*_+x,r[5]=h*_+u*m-o*v+w,r[6]=h*v+o*_-l*m+C,r[7]=-o*m-l*_-u*v+k,r},Rn.rotateX=function(r,e,i){var o=-e[0],l=-e[1],u=-e[2],h=e[3],m=e[4],_=e[5],v=e[6],x=e[7],w=m*h+x*o+_*u-v*l,C=_*h+x*l+v*o-m*u,k=v*h+x*u+m*l-_*o,P=x*h-m*o-_*l-v*u;return Au.rotateX(r,e,i),r[4]=w*(h=r[3])+P*(o=r[0])+C*(u=r[2])-k*(l=r[1]),r[5]=C*h+P*l+k*o-w*u,r[6]=k*h+P*u+w*l-C*o,r[7]=P*h-w*o-C*l-k*u,r},Rn.rotateY=function(r,e,i){var o=-e[0],l=-e[1],u=-e[2],h=e[3],m=e[4],_=e[5],v=e[6],x=e[7],w=m*h+x*o+_*u-v*l,C=_*h+x*l+v*o-m*u,k=v*h+x*u+m*l-_*o,P=x*h-m*o-_*l-v*u;return Au.rotateY(r,e,i),r[4]=w*(h=r[3])+P*(o=r[0])+C*(u=r[2])-k*(l=r[1]),r[5]=C*h+P*l+k*o-w*u,r[6]=k*h+P*u+w*l-C*o,r[7]=P*h-w*o-C*l-k*u,r},Rn.rotateZ=function(r,e,i){var o=-e[0],l=-e[1],u=-e[2],h=e[3],m=e[4],_=e[5],v=e[6],x=e[7],w=m*h+x*o+_*u-v*l,C=_*h+x*l+v*o-m*u,k=v*h+x*u+m*l-_*o,P=x*h-m*o-_*l-v*u;return Au.rotateZ(r,e,i),r[4]=w*(h=r[3])+P*(o=r[0])+C*(u=r[2])-k*(l=r[1]),r[5]=C*h+P*l+k*o-w*u,r[6]=k*h+P*u+w*l-C*o,r[7]=P*h-w*o-C*l-k*u,r},Rn.rotateByQuatAppend=function(r,e,i){var o=i[0],l=i[1],u=i[2],h=i[3],m=e[0],_=e[1],v=e[2],x=e[3];return r[0]=m*h+x*o+_*u-v*l,r[1]=_*h+x*l+v*o-m*u,r[2]=v*h+x*u+m*l-_*o,r[3]=x*h-m*o-_*l-v*u,r[4]=(m=e[4])*h+(x=e[7])*o+(_=e[5])*u-(v=e[6])*l,r[5]=_*h+x*l+v*o-m*u,r[6]=v*h+x*u+m*l-_*o,r[7]=x*h-m*o-_*l-v*u,r},Rn.rotateByQuatPrepend=function(r,e,i){var o=e[0],l=e[1],u=e[2],h=e[3],m=i[0],_=i[1],v=i[2],x=i[3];return r[0]=o*x+h*m+l*v-u*_,r[1]=l*x+h*_+u*m-o*v,r[2]=u*x+h*v+o*_-l*m,r[3]=h*x-o*m-l*_-u*v,r[4]=o*(x=i[7])+h*(m=i[4])+l*(v=i[6])-u*(_=i[5]),r[5]=l*x+h*_+u*m-o*v,r[6]=u*x+h*v+o*_-l*m,r[7]=h*x-o*m-l*_-u*v,r},Rn.rotateAroundAxis=function(r,e,i,o){if(Math.abs(o)<ts.EPSILON)return kI(r,e);var l=Math.hypot(i[0],i[1],i[2]);o*=.5;var u=Math.sin(o),h=u*i[0]/l,m=u*i[1]/l,_=u*i[2]/l,v=Math.cos(o),x=e[0],w=e[1],C=e[2],k=e[3];r[0]=x*v+k*h+w*_-C*m,r[1]=w*v+k*m+C*h-x*_,r[2]=C*v+k*_+x*m-w*h,r[3]=k*v-x*h-w*m-C*_;var P=e[4],R=e[5],z=e[6],B=e[7];return r[4]=P*v+B*h+R*_-z*m,r[5]=R*v+B*m+z*h-P*_,r[6]=z*v+B*_+P*m-R*h,r[7]=B*v-P*h-R*m-z*_,r},Rn.add=function(r,e,i){return r[0]=e[0]+i[0],r[1]=e[1]+i[1],r[2]=e[2]+i[2],r[3]=e[3]+i[3],r[4]=e[4]+i[4],r[5]=e[5]+i[5],r[6]=e[6]+i[6],r[7]=e[7]+i[7],r},Rn.multiply=II,Rn.scale=function(r,e,i){return r[0]=e[0]*i,r[1]=e[1]*i,r[2]=e[2]*i,r[3]=e[3]*i,r[4]=e[4]*i,r[5]=e[5]*i,r[6]=e[6]*i,r[7]=e[7]*i,r},Rn.lerp=function(r,e,i,o){var l=1-o;return MI(e,i)<0&&(o=-o),r[0]=e[0]*l+i[0]*o,r[1]=e[1]*l+i[1]*o,r[2]=e[2]*l+i[2]*o,r[3]=e[3]*l+i[3]*o,r[4]=e[4]*l+i[4]*o,r[5]=e[5]*l+i[5]*o,r[6]=e[6]*l+i[6]*o,r[7]=e[7]*l+i[7]*o,r},Rn.invert=function(r,e){var i=h1(e);return r[0]=-e[0]/i,r[1]=-e[1]/i,r[2]=-e[2]/i,r[3]=e[3]/i,r[4]=-e[4]/i,r[5]=-e[5]/i,r[6]=-e[6]/i,r[7]=e[7]/i,r},Rn.conjugate=function(r,e){return r[0]=-e[0],r[1]=-e[1],r[2]=-e[2],r[3]=e[3],r[4]=-e[4],r[5]=-e[5],r[6]=-e[6],r[7]=e[7],r},Rn.normalize=function(r,e){var i=h1(e);if(i>0){i=Math.sqrt(i);var o=e[0]/i,l=e[1]/i,u=e[2]/i,h=e[3]/i,m=e[4],_=e[5],v=e[6],x=e[7],w=o*m+l*_+u*v+h*x;r[0]=o,r[1]=l,r[2]=u,r[3]=h,r[4]=(m-o*w)/i,r[5]=(_-l*w)/i,r[6]=(v-u*w)/i,r[7]=(x-h*w)/i}return r},Rn.str=function(r){return"quat2("+r[0]+", "+r[1]+", "+r[2]+", "+r[3]+", "+r[4]+", "+r[5]+", "+r[6]+", "+r[7]+")"},Rn.exactEquals=function(r,e){return r[0]===e[0]&&r[1]===e[1]&&r[2]===e[2]&&r[3]===e[3]&&r[4]===e[4]&&r[5]===e[5]&&r[6]===e[6]&&r[7]===e[7]},Rn.equals=function(r,e){var i=r[0],o=r[1],l=r[2],u=r[3],h=r[4],m=r[5],_=r[6],v=r[7],x=e[0],w=e[1],C=e[2],k=e[3],P=e[4],R=e[5],z=e[6],B=e[7];return Math.abs(i-x)<=ts.EPSILON*Math.max(1,Math.abs(i),Math.abs(x))&&Math.abs(o-w)<=ts.EPSILON*Math.max(1,Math.abs(o),Math.abs(w))&&Math.abs(l-C)<=ts.EPSILON*Math.max(1,Math.abs(l),Math.abs(C))&&Math.abs(u-k)<=ts.EPSILON*Math.max(1,Math.abs(u),Math.abs(k))&&Math.abs(h-P)<=ts.EPSILON*Math.max(1,Math.abs(h),Math.abs(P))&&Math.abs(m-R)<=ts.EPSILON*Math.max(1,Math.abs(m),Math.abs(R))&&Math.abs(_-z)<=ts.EPSILON*Math.max(1,Math.abs(_),Math.abs(z))&&Math.abs(v-B)<=ts.EPSILON*Math.max(1,Math.abs(v),Math.abs(B))},Rn.sqrLen=Rn.squaredLength=Rn.len=Rn.length=Rn.dot=Rn.mul=Rn.setReal=Rn.getReal=void 0;var ts=X2(Na),Au=X2(tn),SI=X2(un);function CI(r){if(typeof WeakMap!="function")return null;var e=new WeakMap,i=new WeakMap;return(CI=function(o){return o?i:e})(r)}function X2(r,e){if(!e&&r&&r.__esModule)return r;if(r===null||q2(r)!=="object"&&typeof r!="function")return{default:r};var i=CI(e);if(i&&i.has(r))return i.get(r);var o={},l=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in r)if(u!=="default"&&Object.prototype.hasOwnProperty.call(r,u)){var h=l?Object.getOwnPropertyDescriptor(r,u):null;h&&(h.get||h.set)?Object.defineProperty(o,u,h):o[u]=r[u]}return o.default=r,i&&i.set(r,o),o}function AI(r,e,i){var o=.5*i[0],l=.5*i[1],u=.5*i[2],h=e[0],m=e[1],_=e[2],v=e[3];return r[0]=h,r[1]=m,r[2]=_,r[3]=v,r[4]=o*v+l*_-u*m,r[5]=l*v+u*h-o*_,r[6]=u*v+o*m-l*h,r[7]=-o*h-l*m-u*_,r}function kI(r,e){return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[4]=e[4],r[5]=e[5],r[6]=e[6],r[7]=e[7],r}function II(r,e,i){var o=e[0],l=e[1],u=e[2],h=e[3],m=i[4],_=i[5],v=i[6],x=i[7],w=e[4],C=e[5],k=e[6],P=e[7],R=i[0],z=i[1],B=i[2],H=i[3];return r[0]=o*H+h*R+l*B-u*z,r[1]=l*H+h*z+u*R-o*B,r[2]=u*H+h*B+o*z-l*R,r[3]=h*H-o*R-l*z-u*B,r[4]=o*x+h*m+l*v-u*_+w*H+P*R+C*B-k*z,r[5]=l*x+h*_+u*m-o*v+C*H+P*z+k*R-w*B,r[6]=u*x+h*v+o*_-l*m+k*H+P*B+w*z-C*R,r[7]=h*x-o*m-l*_-u*v+P*H-w*R-C*z-k*B,r}Rn.getReal=Au.copy,Rn.setReal=Au.copy,Rn.mul=II;var MI=Au.dot;Rn.dot=MI;var FI=Au.length;Rn.length=FI,Rn.len=FI;var h1=Au.squaredLength;Rn.squaredLength=h1,Rn.sqrLen=h1;var yn={};function Z2(r){return Z2=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Z2(r)}Object.defineProperty(yn,"__esModule",{value:!0}),yn.create=OI,yn.clone=function(r){var e=new ad.ARRAY_TYPE(2);return e[0]=r[0],e[1]=r[1],e},yn.fromValues=function(r,e){var i=new ad.ARRAY_TYPE(2);return i[0]=r,i[1]=e,i},yn.copy=function(r,e){return r[0]=e[0],r[1]=e[1],r},yn.set=function(r,e,i){return r[0]=e,r[1]=i,r},yn.add=function(r,e,i){return r[0]=e[0]+i[0],r[1]=e[1]+i[1],r},yn.subtract=RI,yn.multiply=LI,yn.divide=DI,yn.ceil=function(r,e){return r[0]=Math.ceil(e[0]),r[1]=Math.ceil(e[1]),r},yn.floor=function(r,e){return r[0]=Math.floor(e[0]),r[1]=Math.floor(e[1]),r},yn.min=function(r,e,i){return r[0]=Math.min(e[0],i[0]),r[1]=Math.min(e[1],i[1]),r},yn.max=function(r,e,i){return r[0]=Math.max(e[0],i[0]),r[1]=Math.max(e[1],i[1]),r},yn.round=function(r,e){return r[0]=Math.round(e[0]),r[1]=Math.round(e[1]),r},yn.scale=function(r,e,i){return r[0]=e[0]*i,r[1]=e[1]*i,r},yn.scaleAndAdd=function(r,e,i,o){return r[0]=e[0]+i[0]*o,r[1]=e[1]+i[1]*o,r},yn.distance=BI,yn.squaredDistance=zI,yn.length=NI,yn.squaredLength=UI,yn.negate=function(r,e){return r[0]=-e[0],r[1]=-e[1],r},yn.inverse=function(r,e){return r[0]=1/e[0],r[1]=1/e[1],r},yn.normalize=function(r,e){var i=e[0],o=e[1],l=i*i+o*o;return l>0&&(l=1/Math.sqrt(l)),r[0]=e[0]*l,r[1]=e[1]*l,r},yn.dot=function(r,e){return r[0]*e[0]+r[1]*e[1]},yn.cross=function(r,e,i){var o=e[0]*i[1]-e[1]*i[0];return r[0]=r[1]=0,r[2]=o,r},yn.lerp=function(r,e,i,o){var l=e[0],u=e[1];return r[0]=l+o*(i[0]-l),r[1]=u+o*(i[1]-u),r},yn.random=function(r,e){e=e||1;var i=2*ad.RANDOM()*Math.PI;return r[0]=Math.cos(i)*e,r[1]=Math.sin(i)*e,r},yn.transformMat2=function(r,e,i){var o=e[0],l=e[1];return r[0]=i[0]*o+i[2]*l,r[1]=i[1]*o+i[3]*l,r},yn.transformMat2d=function(r,e,i){var o=e[0],l=e[1];return r[0]=i[0]*o+i[2]*l+i[4],r[1]=i[1]*o+i[3]*l+i[5],r},yn.transformMat3=function(r,e,i){var o=e[0],l=e[1];return r[0]=i[0]*o+i[3]*l+i[6],r[1]=i[1]*o+i[4]*l+i[7],r},yn.transformMat4=function(r,e,i){var o=e[0],l=e[1];return r[0]=i[0]*o+i[4]*l+i[12],r[1]=i[1]*o+i[5]*l+i[13],r},yn.rotate=function(r,e,i,o){var l=e[0]-i[0],u=e[1]-i[1],h=Math.sin(o),m=Math.cos(o);return r[0]=l*m-u*h+i[0],r[1]=l*h+u*m+i[1],r},yn.angle=function(r,e){var i=r[0],o=r[1],l=e[0],u=e[1],h=Math.sqrt(i*i+o*o)*Math.sqrt(l*l+u*u);return Math.acos(Math.min(Math.max(h&&(i*l+o*u)/h,-1),1))},yn.zero=function(r){return r[0]=0,r[1]=0,r},yn.str=function(r){return"vec2("+r[0]+", "+r[1]+")"},yn.exactEquals=function(r,e){return r[0]===e[0]&&r[1]===e[1]},yn.equals=function(r,e){var i=r[0],o=r[1],l=e[0],u=e[1];return Math.abs(i-l)<=ad.EPSILON*Math.max(1,Math.abs(i),Math.abs(l))&&Math.abs(o-u)<=ad.EPSILON*Math.max(1,Math.abs(o),Math.abs(u))},yn.forEach=yn.sqrLen=yn.sqrDist=yn.dist=yn.div=yn.mul=yn.sub=yn.len=void 0;var ad=function(r,e){if(r&&r.__esModule)return r;if(r===null||Z2(r)!=="object"&&typeof r!="function")return{default:r};var i=PI(void 0);if(i&&i.has(r))return i.get(r);var o={},l=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in r)if(u!=="default"&&Object.prototype.hasOwnProperty.call(r,u)){var h=l?Object.getOwnPropertyDescriptor(r,u):null;h&&(h.get||h.set)?Object.defineProperty(o,u,h):o[u]=r[u]}return o.default=r,i&&i.set(r,o),o}(Na);function PI(r){if(typeof WeakMap!="function")return null;var e=new WeakMap,i=new WeakMap;return(PI=function(o){return o?i:e})(r)}function OI(){var r=new ad.ARRAY_TYPE(2);return ad.ARRAY_TYPE!=Float32Array&&(r[0]=0,r[1]=0),r}function RI(r,e,i){return r[0]=e[0]-i[0],r[1]=e[1]-i[1],r}function LI(r,e,i){return r[0]=e[0]*i[0],r[1]=e[1]*i[1],r}function DI(r,e,i){return r[0]=e[0]/i[0],r[1]=e[1]/i[1],r}function BI(r,e){return Math.hypot(e[0]-r[0],e[1]-r[1])}function zI(r,e){var i=e[0]-r[0],o=e[1]-r[1];return i*i+o*o}function NI(r){return Math.hypot(r[0],r[1])}function UI(r){var e=r[0],i=r[1];return e*e+i*i}yn.len=NI,yn.sub=RI,yn.mul=LI,yn.div=DI,yn.dist=BI,yn.sqrDist=zI,yn.sqrLen=UI;var IV=function(){var r=OI();return function(e,i,o,l,u,h){var m,_;for(i||(i=2),o||(o=0),_=l?Math.min(l*i+o,e.length):e.length,m=o;m<_;m+=i)r[0]=e[m],r[1]=e[m+1],u(r,r,h),e[m]=r[0],e[m+1]=r[1];return e}}();function K2(r){return K2=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},K2(r)}yn.forEach=IV,Object.defineProperty(za,"__esModule",{value:!0});var li=za.vec4=We=za.vec3=za.vec2=za.quat2=ao=za.quat=dt=za.mat4=rs=za.mat3=za.mat2d=Vp=za.mat2=za.glMatrix=void 0,MV=Lc(Na);za.glMatrix=MV;var FV=Lc(Xi),Vp=za.mat2=FV,PV=Lc(ta);za.mat2d=PV;var OV=Lc(mi),rs=za.mat3=OV,RV=Lc(un),dt=za.mat4=RV,LV=Lc(tn),ao=za.quat=LV,DV=Lc(Rn);za.quat2=DV;var BV=Lc(yn);za.vec2=BV;var zV=Lc(ln),We=za.vec3=zV,NV=Lc(kn);function $I(r){if(typeof WeakMap!="function")return null;var e=new WeakMap,i=new WeakMap;return($I=function(o){return o?i:e})(r)}function Lc(r,e){if(!e&&r&&r.__esModule)return r;if(r===null||K2(r)!=="object"&&typeof r!="function")return{default:r};var i=$I(e);if(i&&i.has(r))return i.get(r);var o={},l=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in r)if(u!=="default"&&Object.prototype.hasOwnProperty.call(r,u)){var h=l?Object.getOwnPropertyDescriptor(r,u):null;h&&(h.get||h.set)?Object.defineProperty(o,u,h):o[u]=r[u]}return o.default=r,i&&i.set(r,o),o}li=za.vec4=NV;const UV=Zn([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:d1}=UV,VI=Zn([{name:"a_pos_3",components:3,type:"Int16"}]);var Bf=Zn([{name:"a_pos",type:"Int16",components:2}]),jI={};(function(r,e){(function(i){function o(u,h,m){var _=l(256*u,256*(h=Math.pow(2,m)-h-1),m),v=l(256*(u+1),256*(h+1),m);return _[0]+","+_[1]+","+v[0]+","+v[1]}function l(u,h,m){var _=2*Math.PI*6378137/256/Math.pow(2,m);return[u*_-2*Math.PI*6378137/2,h*_-2*Math.PI*6378137/2]}i.getURL=function(u,h,m,_,v,x){return x=x||{},u+"?"+["bbox="+o(m,_,v),"format="+(x.format||"image/png"),"service="+(x.service||"WMS"),"version="+(x.version||"1.1.1"),"request="+(x.request||"GetMap"),"srs="+(x.srs||"EPSG:3857"),"width="+(x.width||256),"height="+(x.height||256),"layers="+h].join("&")},i.getTileBBox=o,i.getMercCoords=l,Object.defineProperty(i,"__esModule",{value:!0})})(e)})(0,jI);var $V=jI;class Dc{constructor(e,i,o){this.z=e,this.x=i,this.y=o,this.key=Jm(0,e,e,i,o)}equals(e){return this.z===e.z&&this.x===e.x&&this.y===e.y}url(e,i){const o=$V.getTileBBox(this.x,this.y,this.z),l=function(u,h,m){let _,v="";for(let x=u;x>0;x--)_=1<<x-1,v+=(h&_?1:0)+(m&_?2:0);return v}(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(i==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",l).replace("{bbox-epsg-3857}",o)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Y2{constructor(e,i){this.wrap=e,this.canonical=i,this.key=Jm(e,i.z,i.z,i.x,i.y)}}class Wn{constructor(e,i,o,l,u){this.overscaledZ=e,this.wrap=i,this.canonical=new Dc(o,+l,+u),this.key=i===0&&e===o?this.canonical.key:Jm(i,e,o,l,u)}equals(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)}scaledTo(e){const i=this.canonical.z-e;return e>this.canonical.z?new Wn(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Wn(e,this.wrap,e,this.canonical.x>>i,this.canonical.y>>i)}calculateScaledKey(e,i=!0){if(this.overscaledZ===e&&i)return this.key;if(e>this.canonical.z)return Jm(this.wrap*+i,e,this.canonical.z,this.canonical.x,this.canonical.y);{const o=this.canonical.z-e;return Jm(this.wrap*+i,e,e,this.canonical.x>>o,this.canonical.y>>o)}}isChildOf(e){if(e.wrap!==this.wrap)return!1;const i=this.canonical.z-e.canonical.z;return e.overscaledZ===0||e.overscaledZ<this.overscaledZ&&e.canonical.z<this.canonical.z&&e.canonical.x===this.canonical.x>>i&&e.canonical.y===this.canonical.y>>i}children(e){if(this.overscaledZ>=e)return[new Wn(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const i=this.canonical.z+1,o=2*this.canonical.x,l=2*this.canonical.y;return[new Wn(i,this.wrap,i,o,l),new Wn(i,this.wrap,i,o+1,l),new Wn(i,this.wrap,i,o,l+1),new Wn(i,this.wrap,i,o+1,l+1)]}isLessThan(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))}wrapped(){return new Wn(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(e){return new Wn(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Y2(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function Jm(r,e,i,o,l){const u=1<<Math.min(i,22);let h=u*(l%u)+o%u;return r&&i<22&&(h+=u*u*((r<0?-2*r-1:2*r)%(1<<2*(22-i)))),16*(32*h+i)+(e-i)}const WI=[r=>{let e=r.canonical.x-1,i=r.wrap;return e<0&&(e=(1<<r.canonical.z)-1,i--),new Wn(r.overscaledZ,i,r.canonical.z,e,r.canonical.y)},r=>{let e=r.canonical.x+1,i=r.wrap;return e===1<<r.canonical.z&&(e=0,i++),new Wn(r.overscaledZ,i,r.canonical.z,e,r.canonical.y)},r=>new Wn(r.overscaledZ,r.wrap,r.canonical.z,r.canonical.x,(r.canonical.y===0?1<<r.canonical.z:r.canonical.y)-1),r=>new Wn(r.overscaledZ,r.wrap,r.canonical.z,r.canonical.x,r.canonical.y===(1<<r.canonical.z)-1?0:r.canonical.y+1)];xr(Dc,"CanonicalTileID"),xr(Wn,"OverscaledTileID",{omit:["projMatrix"]});class p1{constructor(e,i){this.pos=e,this.dir=i}intersectsPlane(e,i,o){const l=We.dot(i,this.dir);if(Math.abs(l)<1e-6)return!1;const u=((e[0]-this.pos[0])*i[0]+(e[1]-this.pos[1])*i[1]+(e[2]-this.pos[2])*i[2])/l;return o[0]=this.pos[0]+this.dir[0]*u,o[1]=this.pos[1]+this.dir[1]*u,o[2]=this.pos[2]+this.dir[2]*u,!0}closestPointOnSphere(e,i,o){if(We.equals(this.pos,e)||i===0)return o[0]=o[1]=o[2]=0,!1;const[l,u,h]=this.dir,m=this.pos[0]-e[0],_=this.pos[1]-e[1],v=this.pos[2]-e[2],x=l*l+u*u+h*h,w=2*(m*l+_*u+v*h),C=w*w-4*x*(m*m+_*_+v*v-i*i);if(C<0){const k=Math.max(-w/2,0),P=m+l*k,R=_+u*k,z=v+h*k,B=Math.hypot(P,R,z);return o[0]=P*i/B,o[1]=R*i/B,o[2]=z*i/B,!1}{const k=(-w-Math.sqrt(C))/(2*x);if(k<0){const P=Math.hypot(m,_,v);return o[0]=m*i/P,o[1]=_*i/P,o[2]=v*i/P,!1}return o[0]=m+l*k,o[1]=_+u*k,o[2]=v+h*k,!0}}}class J2{constructor(e,i,o,l,u){this.TL=e,this.TR=i,this.BR=o,this.BL=l,this.horizon=u}static fromInvProjectionMatrix(e,i,o){const l=[-1,1,1],u=[1,1,1],h=[1,-1,1],m=[-1,-1,1],_=We.transformMat4(l,l,e),v=We.transformMat4(u,u,e),x=We.transformMat4(h,h,e),w=We.transformMat4(m,m,e);return new J2(_,v,x,w,i/o)}}function Qm(r,e,i){let o=1/0,l=-1/0;const u=[];for(const h of r){We.sub(u,h,e);const m=We.dot(u,i);o=Math.min(o,m),l=Math.max(l,m)}return[o,l]}function HI(r,e){let i=!0;for(let o=0;o<r.planes.length;o++){const l=r.planes[o];let u=0;for(let h=0;h<e.length;h++)u+=We.dot(l,e[h])+l[3]>=0;if(u===0)return 0;u!==e.length&&(i=!1)}return i?2:1}function GI(r,e){for(const i of r.projections){const o=Qm(e,r.points[0],i.axis);if(i.projection[1]<o[0]||i.projection[0]>o[1])return 0}return 1}function qI(r,e){let i=0;const o=[0,0,0,0];for(let l=0;l<r.length;l++)o[0]=r[l][0],o[1]=r[l][1],o[2]=r[l][2],o[3]=1,li.dot(o,e)>=0&&i++;return i}class ku{constructor(e,i){this.points=e||new Array(8).fill([0,0,0]),this.planes=i||new Array(6).fill([0,0,0,0]),this.bounds=Oi.fromPoints(this.points),this.projections=[],this.frustumEdges=[We.sub([],this.points[2],this.points[3]),We.sub([],this.points[0],this.points[3]),We.sub([],this.points[4],this.points[0]),We.sub([],this.points[5],this.points[1]),We.sub([],this.points[6],this.points[2]),We.sub([],this.points[7],this.points[3])];for(const o of this.frustumEdges){const l=[0,-o[2],o[1]],u=[o[2],0,-o[0]];this.projections.push({axis:l,projection:Qm(this.points,this.points[0],l)}),this.projections.push({axis:u,projection:Qm(this.points,this.points[0],u)})}}static fromInvProjectionMatrix(e,i,o,l){const u=Math.pow(2,o),h=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(v=>{const x=li.transformMat4([],v,e),w=1/x[3]/i*u;return li.mul(x,x,[w,w,l?1/x[3]:w,w])}),m=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(v=>{const x=We.sub([],h[v[0]],h[v[1]]),w=We.sub([],h[v[2]],h[v[1]]),C=We.normalize([],We.cross([],x,w)),k=-We.dot(C,h[v[1]]);return C.concat(k)}),_=[];for(let v=0;v<h.length;v++)_.push([h[v][0],h[v][1],h[v][2]]);return new ku(_,m)}intersectsPrecise(e,i,o){for(let l=0;l<i.length;l++)if(!qI(e,i[l]))return 0;for(let l=0;l<this.planes.length;l++)if(!qI(e,this.planes[l]))return 0;for(const l of o)for(const u of this.frustumEdges){const h=We.cross([],l,u),m=We.length(h);if(m===0)continue;We.scale(h,h,1/m);const _=Qm(this.points,this.points[0],h),v=Qm(e,this.points[0],h);if(_[0]>v[1]||v[0]>_[1])return 0}return 1}}class Oi{static fromPoints(e){const i=[1/0,1/0,1/0],o=[-1/0,-1/0,-1/0];for(const l of e)We.min(i,i,l),We.max(o,o,l);return new Oi(i,o)}static fromTileIdAndHeight(e,i,o){const l=1<<e.canonical.z,u=e.canonical.x,h=e.canonical.y;return new Oi([u/l,h/l,i],[(u+1)/l,(h+1)/l,o])}static applyTransform(e,i){const o=e.getCorners();for(let l=0;l<o.length;++l)We.transformMat4(o[l],o[l],i);return Oi.fromPoints(o)}static projectAabbCorners(e,i){const o=e.getCorners();for(let l=0;l<o.length;++l)We.transformMat4(o[l],o[l],i);return o}constructor(e,i){this.min=e,this.max=i,this.center=We.scale([],We.add([],this.min,this.max),.5)}quadrant(e){const i=[e%2==0,e<2],o=We.clone(this.min),l=We.clone(this.max);for(let u=0;u<i.length;u++)o[u]=i[u]?this.min[u]:this.center[u],l[u]=i[u]?this.center[u]:this.max[u];return l[2]=this.max[2],new Oi(o,l)}distanceX(e){return Math.max(Math.min(this.max[0],e[0]),this.min[0])-e[0]}distanceY(e){return Math.max(Math.min(this.max[1],e[1]),this.min[1])-e[1]}distanceZ(e){return Math.max(Math.min(this.max[2],e[2]),this.min[2])-e[2]}getCorners(){const e=this.min,i=this.max;return[[e[0],e[1],e[2]],[i[0],e[1],e[2]],[i[0],i[1],e[2]],[e[0],i[1],e[2]],[e[0],e[1],i[2]],[i[0],e[1],i[2]],[i[0],i[1],i[2]],[e[0],i[1],i[2]]]}intersects(e){return this.intersectsAabb(e.bounds)?HI(e,this.getCorners()):0}intersectsFlat(e){return this.intersectsAabb(e.bounds)?HI(e,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsPrecise(e,i){return i||this.intersects(e)?GI(e,this.getCorners()):0}intersectsPreciseFlat(e,i){return i||this.intersectsFlat(e)?GI(e,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsAabb(e){for(let i=0;i<3;++i)if(this.min[i]>e.max[i]||e.min[i]>this.max[i])return!1;return!0}intersectsAabbXY(e){return!(this.min[0]>e.max[0]||e.min[0]>this.max[0]||this.min[1]>e.max[1]||e.min[1]>this.max[1])}encapsulate(e){for(let i=0;i<3;i++)this.min[i]=Math.min(this.min[i],e.min[i]),this.max[i]=Math.max(this.max[i],e.max[i])}encapsulatePoint(e){for(let i=0;i<3;i++)this.min[i]=Math.min(this.min[i],e[i]),this.max[i]=Math.max(this.max[i],e[i])}closestPoint(e){return[Math.max(Math.min(this.max[0],e[0]),this.min[0]),Math.max(Math.min(this.max[1],e[1]),this.min[1]),Math.max(Math.min(this.max[2],e[2]),this.min[2])]}}xr(Oi,"Aabb");const eg=5,zf=6,Fo=Et/Math.PI/2,VV=16383,jp=64,Q2=[jp,32,16],gl=-Fo,_l=Fo,jV=[new Oi([gl,gl,gl],[_l,_l,_l]),new Oi([gl,gl,gl],[0,0,_l]),new Oi([0,gl,gl],[_l,0,_l]),new Oi([gl,0,gl],[0,_l,_l]),new Oi([0,0,gl],[_l,_l,_l])];function m1(r){return r*Fo/Hp}function XI(r,e,i,o=!0){const l=We.scale([],r._camera.position,r.worldSize),u=[e,i,1,1];li.transformMat4(u,u,r.pixelMatrixInverse),li.scale(u,u,1/u[3]);const h=We.sub([],u,l),m=We.normalize([],h),_=r.globeMatrix,v=[_[12],_[13],_[14]],x=We.sub([],v,l),w=We.length(x),C=We.normalize([],x),k=r.worldSize/(2*Math.PI),P=We.dot(C,m),R=Math.asin(k/w);if(R<Math.acos(P)){if(!o)return null;const Re=[],ke=[];We.scale(Re,m,w/P),We.normalize(ke,We.sub(ke,Re,x)),We.normalize(m,We.add(m,x,We.scale(m,ke,Math.tan(R)*w)))}const z=[];new p1(l,m).closestPointOnSphere(v,k,z);const B=We.normalize([],mr(_,0)),H=We.normalize([],mr(_,1)),Z=We.normalize([],mr(_,2)),Y=We.dot(B,z),q=We.dot(H,z),ee=We.dot(Z,z),ce=re(Math.asin(-q/k));let de=re(Math.atan2(Y,ee));de=r.center.lng+function(Re,ke){const $e=(ke-Re+180)%360-180;return $e<-180?$e+360:$e}(r.center.lng,de);const ge=Xa(de),ve=Oe(oo(ce),0,1);return new Pn(ge,ve)}class WV{constructor(e,i,o){this.a=We.sub([],e,o),this.b=We.sub([],i,o),this.center=o;const l=We.normalize([],this.a),u=We.normalize([],this.b);this.angle=Math.acos(We.dot(l,u))}}function eE(r,e){if(r.angle===0)return null;let i;return i=r.a[e]===0?1/r.angle*.5*Math.PI:1/r.angle*Math.atan(r.b[e]/r.a[e]/Math.sin(r.angle)-1/Math.tan(r.angle)),i<0||i>1?null:function(o,l,u,h){const m=Math.sin(u);return o*(Math.sin((1-h)*u)/m)+l*(Math.sin(h*u)/m)}(r.a[e],r.b[e],r.angle,Oe(i,0,1))+r.center[e]}function vl(r){if(r.z<=1)return jV[r.z+2*r.y+r.x];const e=rE(g1(r));return Oi.fromPoints(e)}function Iu(r,e,i){return We.scale(r,r,1-i),We.scaleAndAdd(r,r,e,i)}function ZI(r,e){const i=qa(e.zoom);if(i===0)return vl(r);const o=g1(r),l=rE(o),u=Xa(o.getWest())*e.worldSize,h=Xa(o.getEast())*e.worldSize,m=oo(o.getNorth())*e.worldSize,_=oo(o.getSouth())*e.worldSize,v=[u,m,0],x=[h,m,0],w=[u,_,0],C=[h,_,0],k=dt.invert([],e.globeMatrix);return We.transformMat4(v,v,k),We.transformMat4(x,x,k),We.transformMat4(w,w,k),We.transformMat4(C,C,k),l[0]=Iu(l[0],w,i),l[1]=Iu(l[1],C,i),l[2]=Iu(l[2],x,i),l[3]=Iu(l[3],v,i),Oi.fromPoints(l)}function KI(r,e,i){for(const o of r)We.transformMat4(o,o,e),We.scale(o,o,i)}function tE(r,e,i,o){const l=e/r.worldSize,u=r.globeMatrix;if(i.z<=1){const ge=vl(i).getCorners();return KI(ge,u,l),Oi.fromPoints(ge)}const h=g1(i,o),m=rE(h);KI(m,u,l);const _=Number.MAX_VALUE,v=[-_,-_,-_],x=[_,_,_];if(h.contains(r.center)){for(const Re of m)We.min(x,x,Re),We.max(v,v,Re);v[2]=0;const ge=r.point,ve=[ge.x*l,ge.y*l,0];return We.min(x,x,ve),We.max(v,v,ve),new Oi(x,v)}const w=[u[12]*l,u[13]*l,u[14]*l],C=h.getCenter(),k=Oe(r.center.lat,-ha,ha),P=Oe(C.lat,-ha,ha),R=Xa(r.center.lng),z=oo(k);let B=R-Xa(C.lng);const H=z-oo(P);B>.5?B-=1:B<-.5&&(B+=1);let Z=0;if(Math.abs(B)>Math.abs(H))Z=B>=0?1:3;else{Z=H>=0?0:2;const ge=[u[4]*l,u[5]*l,u[6]*l],ve=-Math.sin(le(H>=0?h.getSouth():h.getNorth()))*Fo;We.scaleAndAdd(w,w,ge,ve)}const Y=m[Z],q=m[(Z+1)%4],ee=new WV(Y,q,w),ce=[eE(ee,0)||Y[0],eE(ee,1)||Y[1],eE(ee,2)||Y[2]],de=qa(r.zoom);if(de>0){const ge=function({x:Re,y:ke,z:$e},Ie,Qe,st,ft){const Je=1/(1<<$e);let tt=Re*Je,pt=tt+Je,bt=ke*Je,St=bt+Je,Pt=0;const Ut=(tt+pt)/2-st;return Ut>.5?Pt=-1:Ut<-.5&&(Pt=1),tt=((tt+Pt)*Ie-(st*=Ie))*Qe+st,pt=((pt+Pt)*Ie-st)*Qe+st,bt=(bt*Ie-(ft*=Ie))*Qe+ft,St=(St*Ie-ft)*Qe+ft,[[tt,St,0],[pt,St,0],[pt,bt,0],[tt,bt,0]]}(i,e,r._pixelsPerMercatorPixel,R,z);for(let Re=0;Re<m.length;Re++)Iu(m[Re],ge[Re],de);const ve=We.add([],ge[Z],ge[(Z+1)%4]);We.scale(ve,ve,.5),Iu(ce,ve,de)}for(const ge of m)We.min(x,x,ge),We.max(v,v,ge);return x[2]=Math.min(Y[2],q[2]),We.min(x,x,ce),We.max(v,v,ce),new Oi(x,v)}function g1({x:r,y:e,z:i},o=!1){const l=1/(1<<i),u=new Xr(Ss(r*l),e===(1<<i)-1&&o?-90:ka((e+1)*l)),h=new Xr(Ss((r+1)*l),e===0&&o?90:ka(e*l));return new Ks(u,h)}function rE(r){const e=le(r.getNorth()),i=le(r.getSouth()),o=Math.cos(e),l=Math.cos(i),u=Math.sin(e),h=Math.sin(i),m=r.getWest(),_=r.getEast();return[Wp(l,h,m),Wp(l,h,_),Wp(o,u,_),Wp(o,u,m)]}function Wp(r,e,i,o=Fo){return i=le(i),[r*Math.sin(i)*o,-e*o,r*Math.cos(i)*o]}function ns(r,e,i){return Wp(Math.cos(le(r)),Math.sin(le(r)),e,i)}function tg(r,e,i,o){const l=1<<i.z,u=(r/Et+i.x)/l;return ns(ka((e/Et+i.y)/l),Ss(u),o)}function _1({min:r,max:e}){return VV/Math.max(e[0]-r[0],e[1]-r[1],e[2]-r[2])}const YI=new Float64Array(16);function od(r){const e=_1(r),i=dt.fromScaling(YI,[e,e,e]);return dt.translate(i,i,We.negate([],r.min))}function nE(r){const e=dt.fromTranslation(YI,r.min),i=1/_1(r);return dt.scale(e,e,[i,i,i])}function iE(r){const e=Et/(2*Math.PI);return r/(2*Math.PI)/e}function JI(r,e){return Et/(512*Math.pow(2,r))*_1(vl(e))}function QI(r,e,i,o,l){const u=iE(i),h=[r,e,-i/(2*Math.PI)],m=dt.identity(new Float64Array(16));return dt.translate(m,m,h),dt.scale(m,m,[u,u,u]),dt.rotateX(m,m,le(-l)),dt.rotateY(m,m,le(-o)),m}function qa(r){return Pe(eg,zf,r)}function eM(r,e,i){const o=dt.identity(new Float64Array(16)),l=(e/(1<<r)-.5)*Math.PI*2;return dt.rotateY(o,i.globeMatrix,l),Float32Array.from(o)}function tM(r,e,i){const o=qa(i.zoom),l=r.style.map._antialias,u=e.extStandardDerivativesForceOff||r.terrain&&r.terrain.exaggeration()>0;return o===0&&!l&&!u}function HV(r,e,i,o){const l=e.getNorth(),u=e.getSouth(),h=e.getWest(),m=e.getEast(),_=1<<r.z,v=m-h,x=l-u,w=v/jp,C=-x/Q2[i],k=[0,w,0,C,0,0,l,h,0];if(r.z>0){const P=180/o;rs.multiply(k,k,[P/v+1,0,0,0,P/x+1,0,-.5*P/w,.5*P/C,1])}return k[2]=_,k[5]=r.x,k[8]=r.y,k}function GV(r){const e=ha-5;r=Oe(r,-e,e)/e*90;const i=Math.pow(Math.abs(Math.sin(le(r))),3);return Math.round(i*(Q2.length-1))}function rM(r){const e=[0,0,0],i=dt.identity(new Float64Array(16));return dt.multiply(i,r.pixelMatrix,r.globeMatrix),We.transformMat4(e,e,i),new D(e[0],e[1])}function nM(r,e){const i=ns(e.lat,e.lng),o=function(u){const h=ns(u._center.lat,u._center.lng),m=We.fromValues(0,1,0);let _=We.cross([],m,h);const v=dt.fromRotation([],-u.angle,h);_=We.transformMat4(_,_,v),dt.fromRotation(v,-u._pitch,_);const x=We.normalize([],h);return We.scale(x,x,m1(u.cameraToCenterDistance/u.pixelsPerMeter)),We.transformMat4(x,x,v),We.add([],h,x)}(r),l=We.subtract([],o,i);return We.angle(l,i)}function v1(r,e){return nM(r,e)>Math.PI/2*1.01}const iM=le(85),qV=Math.cos(iM),XV=Math.sin(iM);class ZV{constructor(e){this._createGrid(e),this._createPoles(e)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const e of this._poleSegments)e.destroy();for(const e of this._gridSegments)e.withSkirts.destroy(),e.withoutSkirts.destroy()}_fillGridMeshWithLods(e,i){const o=new Es,l=new Oa,u=[],h=e+1+2,m=i[0]+1,_=i[0]+1+(1+i.length),v=(x,w,C)=>{let k=x===h-1?x-2:x===0?x:x-1;return k+=C?24575:0,[k,w]};for(let x=0;x<h;++x)o.emplaceBack(...v(x,0,!0));for(let x=0;x<m;++x)for(let w=0;w<h;++w)o.emplaceBack(...v(w,x,(w===0||w===h-1)&&!0));for(let x=0;x<i.length;++x){const w=i[x];for(let C=0;C<h;++C)o.emplaceBack(...v(C,w,!0))}for(let x=0;x<i.length;++x){const w=l.length,C=i[x]+1+2,k=new Oa;for(let z=0;z<C-1;z++){const B=z===C-2,H=B?h*(_-i.length+x-z):h;for(let Z=0;Z<h-1;Z++){const Y=z*h+Z;z===0||B||Z===0||Z===h-2?(k.emplaceBack(Y+1,Y,Y+H),k.emplaceBack(Y+H,Y+H+1,Y+1)):(l.emplaceBack(Y+1,Y,Y+H),l.emplaceBack(Y+H,Y+H+1,Y+1))}}const P=ui.simpleSegment(0,w,o.length,l.length-w);for(let z=0;z<k.uint16.length;z+=3)l.emplaceBack(k.uint16[z],k.uint16[z+1],k.uint16[z+2]);const R=ui.simpleSegment(0,w,o.length,l.length-w);u.push({withoutSkirts:P,withSkirts:R})}return{vertices:o,indices:l,segments:u}}_createGrid(e){const i=this._fillGridMeshWithLods(jp,Q2);this._gridSegments=i.segments,this._gridBuffer=e.createVertexBuffer(i.vertices,Bf.members),this._gridIndexBuffer=e.createIndexBuffer(i.indices,!0)}_createPoles(e){const i=new Oa;for(let m=0;m<=jp;m++)i.emplaceBack(0,m+1,m+2);this._poleIndexBuffer=e.createIndexBuffer(i,!0);const o=new rd,l=new rd,u=new rd,h=new rd;this._poleSegments=[];for(let m=0,_=0;m<eg;m++){const v=360/(1<<m);o.emplaceBack(0,-Fo,0,.5,0),l.emplaceBack(0,-Fo,0,.5,1),u.emplaceBack(0,-Fo,0,.5,.5),h.emplaceBack(0,-Fo,0,.5,.5);for(let x=0;x<=jp;x++){let w=x/jp,C=0;const k=$r(0,v,w),[P,R,z]=Wp(qV,XV,k,Fo);o.emplaceBack(P,R,z,w,C),l.emplaceBack(P,R,z,w,1-C);const B=le(k);w=.5+.5*Math.sin(B),C=.5+.5*Math.cos(B),u.emplaceBack(P,R,z,w,C),h.emplaceBack(P,R,z,w,1-C)}this._poleSegments.push(ui.simpleSegment(_,0,66,64)),_+=66}this._poleNorthVertexBuffer=e.createVertexBuffer(o,d1,!1),this._poleSouthVertexBuffer=e.createVertexBuffer(l,d1,!1),this._texturedPoleNorthVertexBuffer=e.createVertexBuffer(u,d1,!1),this._texturedPoleSouthVertexBuffer=e.createVertexBuffer(h,d1,!1)}getGridBuffers(e,i){return[this._gridBuffer,this._gridIndexBuffer,i?this._gridSegments[e].withSkirts:this._gridSegments[e].withoutSkirts]}getPoleBuffers(e,i){return[i?this._texturedPoleNorthVertexBuffer:this._poleNorthVertexBuffer,i?this._texturedPoleSouthVertexBuffer:this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[e]]}}const Hp=63710088e-1,aE=2*Math.PI*Hp;class Nf{constructor(e,i){if(isNaN(e)||isNaN(i))throw new Error(`Invalid LngLat object: (${e}, ${i})`);if(this.lng=+e,this.lat=+i,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Nf(rt(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(e){const i=Math.PI/180,o=this.lat*i,l=e.lat*i,u=Math.sin(o)*Math.sin(l)+Math.cos(o)*Math.cos(l)*Math.cos((e.lng-this.lng)*i);return Hp*Math.acos(Math.min(u,1))}toBounds(e=0){const i=360*e/40075017,o=i/Math.cos(Math.PI/180*this.lat);return new Ks(new Nf(this.lng-o,this.lat-i),new Nf(this.lng+o,this.lat+i))}toEcef(e){const i=m1(e);return ns(this.lat,this.lng,Fo+i)}static convert(e){if(e instanceof Nf)return e;if(Array.isArray(e)&&(e.length===2||e.length===3))return new Nf(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&typeof e=="object"&&e!==null)return new Nf(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}var Xr=Nf;const KV=0,YV=25.5;function y1(r){return aE*Math.cos(r*Math.PI/180)}function Xa(r){return(180+r)/360}function oo(r){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+r*Math.PI/360)))/360}function fi(r,e){return r/y1(e)}function Ss(r){return 360*r-180}function ka(r){return 360/Math.PI*Math.atan(Math.exp((180-360*r)*Math.PI/180))-90}function aM(r,e){return r*y1(ka(e))}const ha=85.051129;function oM(r){return Math.cos(le(Oe(r,-ha,ha)))}function Uf(r,e){const i=Oe(e,KV,YV),o=Math.pow(2,i);return oM(r)*aE/(512*o)}function oE(r){return 1/Math.cos(r*Math.PI/180)}function rg(r,e=0){const i=Math.exp(Math.PI*(1-(r.y+e/Et)/(1<<r.z)*2));return 80150034*i/(i*i+1)/Et/(1<<r.z)}class Pn{constructor(e,i,o=0){this.x=+e,this.y=+i,this.z=+o}static fromLngLat(e,i=0){const o=Xr.convert(e);return new Pn(Xa(o.lng),oo(o.lat),fi(i,o.lat))}toLngLat(){return new Xr(Ss(this.x),ka(this.y))}toAltitude(){return aM(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/aE*oE(ka(this.y))}}function sE(r,e,i,o,l,u,h,m,_){const v=(e+o)/2,x=(i+l)/2,w=new D(v,x);m(w),function(C,k,P,R,z,B){const H=P-z,Z=R-B;return Math.abs((R-k)*H-(P-C)*Z)/Math.hypot(H,Z)}(w.x,w.y,u.x,u.y,h.x,h.y)>=_?(sE(r,e,i,v,x,u,w,m,_),sE(r,v,x,o,l,w,h,m,_)):r.push(h)}function sM(r,e,i){let o=r[0],l=o.x,u=o.y;e(o);const h=[o];for(let m=1;m<r.length;m++){const _=r[m],{x:v,y:x}=_;e(_),sE(h,l,u,v,x,o,_,e,i),l=v,u=x,o=_}return h}function lE(r,e,i,o){if(o(e,i)){const l=e.add(i)._mult(.5);lE(r,e,l,o),lE(r,l,i,o)}else r.push(i)}function JV(r,e){let i=r[0];const o=[i];for(let l=1;l<r.length;l++){const u=r[l];lE(o,i,u,e),i=u}return o}const cE=Math.pow(2,14)-1,lM=-cE-1;function QV(r,e){const i=Math.round(r.x*e),o=Math.round(r.y*e);return r.x=Oe(i,lM,cE),r.y=Oe(o,lM,cE),(i<r.x||i>r.x+1||o<r.y||o>r.y+1)&&se("Geometry exceeds allowed extent, reduce your vector tile buffer size"),r}function Bc(r,e,i){const o=r.loadGeometry(),l=r.extent,u=Et/l;if(e&&i&&i.projection.isReprojectedInTileSpace){const h=1<<e.z,{scale:m,x:_,y:v,projection:x}=i,w=C=>{const k=Ss((e.x+C.x/l)/h),P=ka((e.y+C.y/l)/h),R=x.project(k,P);C.x=(R.x*m-_)*l,C.y=(R.y*m-v)*l};for(let C=0;C<o.length;C++)if(r.type!==1)o[C]=sM(o[C],w,1);else{const k=[];for(const P of o[C])P.x<0||P.x>=l||P.y<0||P.y>=l||(w(P),k.push(P));o[C]=k}}for(const h of o)for(const m of h)QV(m,u);return o}function $f(r,e){return{type:r.type,id:r.id,properties:r.properties,geometry:e?Bc(r):[]}}function x1(r,e,i,o,l){r.emplaceBack(2*e+(o+1)/2,2*i+(l+1)/2)}function b1(r,e,i){r.emplaceBack(e.x,e.y,e.z,i[0]*16384,i[1]*16384,i[2]*16384)}class uE{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(i=>i.fqid),this.index=e.index,this.hasPattern=!1,this.projection=e.projection,this.layoutVertexArray=new Es,this.indexArray=new Oa,this.segments=new ui,this.programConfigurations=new Lf(e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter(i=>i.isStateDependent()).map(i=>i.id)}populate(e,i,o,l){const u=this.layers[0],h=[];let m=null;u.type==="circle"&&(m=u.layout.get("circle-sort-key"));for(const{feature:v,id:x,index:w,sourceLayerIndex:C}of e){const k=this.layers[0]._featureFilter.needGeometry,P=$f(v,k);if(!this.layers[0]._featureFilter.filter(new Gi(this.zoom),P,o))continue;const R=m?m.evaluate(P,{},o):void 0,z={id:x,properties:v.properties,type:v.type,sourceLayerIndex:C,index:w,geometry:k?P.geometry:Bc(v,o,l),patterns:{},sortKey:R};h.push(z)}m&&h.sort((v,x)=>v.sortKey-x.sortKey);let _=null;l.projection.name==="globe"&&(this.globeExtVertexArray=new a1,_=l.projection);for(const v of h){const{geometry:x,index:w,sourceLayerIndex:C}=v,k=e[w].feature;this.addFeature(v,x,w,i.availableImages,o,_,i.brightness),i.featureIndex.insert(k,x,w,C,this.index)}}update(e,i,o,l,u){const h=Object.keys(e).length!==0;h&&!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(e,i,h?this.stateDependentLayers:this.layers,o,l,u)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,lV.members),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=e.createVertexBuffer(this.globeExtVertexArray,cV.members))),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(e,i,o,l,u,h,m){for(const _ of i)for(const v of _){const x=v.x,w=v.y;if(x<0||x>=Et||w<0||w>=Et)continue;if(h){const P=h.projectTilePoint(x,w,u),R=h.upVector(u,x,w),z=this.globeExtVertexArray;b1(z,P,R),b1(z,P,R),b1(z,P,R),b1(z,P,R)}const C=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),k=C.vertexLength;x1(this.layoutVertexArray,x,w,-1,-1),x1(this.layoutVertexArray,x,w,1,-1),x1(this.layoutVertexArray,x,w,1,1),x1(this.layoutVertexArray,x,w,-1,1),this.indexArray.emplaceBack(k,k+1,k+2),this.indexArray.emplaceBack(k,k+2,k+3),C.vertexLength+=4,C.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,o,{},l,u,m)}}function cM(r,e){for(let i=0;i<r.length;i++)if(Vf(e,r[i]))return!0;for(let i=0;i<e.length;i++)if(Vf(r,e[i]))return!0;return!!fE(r,e)}function ej(r,e,i){return!!Vf(r,e)||!!hE(e,r,i)}function uM(r,e){if(r.length===1)return hM(e,r[0]);for(let i=0;i<e.length;i++){const o=e[i];for(let l=0;l<o.length;l++)if(Vf(r,o[l]))return!0}for(let i=0;i<r.length;i++)if(hM(e,r[i]))return!0;for(let i=0;i<e.length;i++)if(fE(r,e[i]))return!0;return!1}function tj(r,e,i){if(r.length>1){if(fE(r,e))return!0;for(let o=0;o<e.length;o++)if(hE(e[o],r,i))return!0}for(let o=0;o<r.length;o++)if(hE(r[o],e,i))return!0;return!1}function fE(r,e){if(r.length===0||e.length===0)return!1;for(let i=0;i<r.length-1;i++){const o=r[i],l=r[i+1];for(let u=0;u<e.length-1;u++)if(rj(o,l,e[u],e[u+1]))return!0}return!1}function rj(r,e,i,o){return Ae(r,i,o)!==Ae(e,i,o)&&Ae(r,e,i)!==Ae(r,e,o)}function hE(r,e,i){const o=i*i;if(e.length===1)return r.distSqr(e[0])<o;for(let l=1;l<e.length;l++)if(fM(r,e[l-1],e[l])<o)return!0;return!1}function fM(r,e,i){const o=e.distSqr(i);if(o===0)return r.distSqr(e);const l=((r.x-e.x)*(i.x-e.x)+(r.y-e.y)*(i.y-e.y))/o;return r.distSqr(l<0?e:l>1?i:i.sub(e)._mult(l)._add(e))}function hM(r,e){let i,o,l,u=!1;for(let h=0;h<r.length;h++){i=r[h];for(let m=0,_=i.length-1;m<i.length;_=m++)o=i[m],l=i[_],o.y>e.y!=l.y>e.y&&e.x<(l.x-o.x)*(e.y-o.y)/(l.y-o.y)+o.x&&(u=!u)}return u}function Vf(r,e){let i=!1;for(let o=0,l=r.length-1;o<r.length;l=o++){const u=r[o],h=r[l];u.y>e.y!=h.y>e.y&&e.x<(h.x-u.x)*(e.y-u.y)/(h.y-u.y)+u.x&&(i=!i)}return i}function dM(r,e,i,o,l){for(const h of r)if(e<=h.x&&i<=h.y&&o>=h.x&&l>=h.y)return!0;const u=[new D(e,i),new D(e,l),new D(o,l),new D(o,i)];if(r.length>2){for(const h of u)if(Vf(r,h))return!0}for(let h=0;h<r.length-1;h++)if(nj(r[h],r[h+1],u))return!0;return!1}function nj(r,e,i){const o=i[0],l=i[2];if(r.x<o.x&&e.x<o.x||r.x>l.x&&e.x>l.x||r.y<o.y&&e.y<o.y||r.y>l.y&&e.y>l.y)return!1;const u=Ae(r,e,i[0]);return u!==Ae(r,e,i[1])||u!==Ae(r,e,i[2])||u!==Ae(r,e,i[3])}function Gp(r,e,i,o,l,u){let h=e.y-r.y,m=r.x-e.x;if(u=u||0){const _=h*h+m*m;if(_===0)return!0;const v=Math.sqrt(_);h/=v,m/=v}return!((i.x-r.x)*h+(i.y-r.y)*m-u<0||(o.x-r.x)*h+(o.y-r.y)*m-u<0||(l.x-r.x)*h+(l.y-r.y)*m-u<0)}function dE(r,e,i,o,l,u,h){return!(Gp(r,e,o,l,u,h)||Gp(e,i,o,l,u,h)||Gp(i,r,o,l,u,h)||Gp(o,l,r,e,i,h)||Gp(l,u,r,e,i,h)||Gp(u,o,r,e,i,h))}function qp(r,e,i){const o=e.paint.get(r).value;return o.kind==="constant"?o.value:i.programConfigurations.get(e.id).getMaxValue(r)}function w1(r){return Math.sqrt(r[0]*r[0]+r[1]*r[1])}function pM(r,e,i,o,l){if(!e[0]&&!e[1])return r;const u=D.convert(e)._mult(l);i==="viewport"&&u._rotate(-o);const h=[];for(let m=0;m<r.length;m++)h.push(r[m].sub(u));return h}function mM(r,e,i,o){const l=D.convert(r)._mult(o);return e==="viewport"&&l._rotate(-i),l}xr(uE,"CircleBucket",{omit:["layers"]});const ij=new sa({"circle-sort-key":new Pr(at.layout_circle["circle-sort-key"]),visibility:new Yt(at.layout_circle.visibility)});var aj={paint:new sa({"circle-radius":new Pr(at.paint_circle["circle-radius"]),"circle-color":new Pr(at.paint_circle["circle-color"]),"circle-blur":new Pr(at.paint_circle["circle-blur"]),"circle-opacity":new Pr(at.paint_circle["circle-opacity"]),"circle-translate":new Yt(at.paint_circle["circle-translate"]),"circle-translate-anchor":new Yt(at.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Yt(at.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Yt(at.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Pr(at.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Pr(at.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Pr(at.paint_circle["circle-stroke-opacity"]),"circle-emissive-strength":new Yt(at.paint_circle["circle-emissive-strength"])}),layout:ij};const oj=dt.create(),sj=(r,e,i,o,l,u)=>{const h=r.transform,m=h.projection.name==="globe";let _;if(u.paint.get("circle-pitch-alignment")==="map")if(m){const x=JI(h.zoom,e.canonical)*h._pixelsPerMercatorPixel;_=Float32Array.from([x,0,0,x])}else _=h.calculatePixelsToTileUnitsMatrix(i);else _=new Float32Array([h.pixelsToGLUnits[0],0,0,h.pixelsToGLUnits[1]]);const v={u_camera_to_center_distance:r.transform.getCameraToCenterDistance(h.projection),u_matrix:r.translatePosMatrix(e.projMatrix,i,u.paint.get("circle-translate"),u.paint.get("circle-translate-anchor")),u_device_pixel_ratio:Jr.devicePixelRatio,u_extrude_scale:_,u_inv_rot_matrix:oj,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0],u_emissive_strength:u.paint.get("circle-emissive-strength")};if(m){v.u_inv_rot_matrix=o,v.u_merc_center=l,v.u_tile_id=[e.canonical.x,e.canonical.y,1<<e.canonical.z],v.u_zoom_transition=qa(h.zoom);const x=l[0]*Et,w=l[1]*Et;v.u_up_dir=h.projection.upVector(new Dc(0,0,0),x,w)}return v},gM=r=>{const e=[];return r.paint.get("circle-pitch-alignment")==="map"&&e.push("PITCH_WITH_MAP"),r.paint.get("circle-pitch-scale")==="map"&&e.push("SCALE_WITH_MAP"),e};function _M(r,e,i,o,l,u,h,m,_){if(u&&r.queryGeometry.isAboveHorizon)return!1;u&&(_*=r.pixelToTileUnitsFactor);const v=r.tileID.canonical,x=i.projection.upVectorScale(v,i.center.lat,i.worldSize).metersToTile;for(const w of e)for(const C of w){const k=C.add(m),P=l&&i.elevation?i.elevation.exaggeration()*l.getElevationAt(k.x,k.y,!0):0,R=i.projection.projectTilePoint(k.x,k.y,v);if(P>0){const Z=i.projection.upVector(v,k.x,k.y);R.x+=Z[0]*x*P,R.y+=Z[1]*x*P,R.z+=Z[2]*x*P}const z=u?k:lj(R.x,R.y,R.z,o),B=u?r.tilespaceRays.map(Z=>uj(Z,P)):r.queryGeometry.screenGeometry,H=li.transformMat4([],[R.x,R.y,R.z,1],o);if(!h&&u?_*=H[3]/i.cameraToCenterDistance:h&&!u&&(_*=i.cameraToCenterDistance/H[3]),u){const Z=ka((C.y/Et+v.y)/(1<<v.z));_/=i.projection.pixelsPerMeter(Z,1)/fi(1,Z)}if(ej(B,z,_))return!0}return!1}function lj(r,e,i,o){const l=li.transformMat4([],[r,e,i,1],o);return new D(l[0]/l[3],l[1]/l[3])}const vM=We.fromValues(0,0,0),cj=We.fromValues(0,0,1);function uj(r,e){const i=We.create();return vM[2]=e,r.intersectsPlane(vM,cj,i),new D(i[0],i[1])}class yM extends uE{}function xM(r,{width:e,height:i},o,l){if(l){if(l instanceof Uint8ClampedArray)l=new Uint8Array(l.buffer);else if(l.length!==e*i*o)throw new RangeError("mismatched image size")}else l=new Uint8Array(e*i*o);return r.width=e,r.height=i,r.data=l,r}function bM(r,e,i){const{width:o,height:l}=e;o===r.width&&l===r.height||(pE(r,e,{x:0,y:0},{x:0,y:0},{width:Math.min(r.width,o),height:Math.min(r.height,l)},i),r.width=o,r.height=l,r.data=e.data)}function pE(r,e,i,o,l,u){if(l.width===0||l.height===0)return e;if(l.width>r.width||l.height>r.height||i.x>r.width-l.width||i.y>r.height-l.height)throw new RangeError("out of range source coordinates for image copy");if(l.width>e.width||l.height>e.height||o.x>e.width-l.width||o.y>e.height-l.height)throw new RangeError("out of range destination coordinates for image copy");const h=r.data,m=e.data;for(let _=0;_<l.height;_++){const v=((i.y+_)*r.width+i.x)*u,x=((o.y+_)*e.width+o.x)*u;for(let w=0;w<l.width*u;w++)m[x+w]=h[v+w]}return e}xr(yM,"HeatmapBucket",{omit:["layers"]});class Mu{constructor(e,i){xM(this,e,1,i)}resize(e){bM(this,new Mu(e),1)}clone(){return new Mu({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,i,o,l,u){pE(e,i,o,l,u,1)}}class da{constructor(e,i){xM(this,e,4,i)}resize(e){bM(this,new da(e),4)}replace(e,i){i?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e}clone(){return new da({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,i,o,l,u){pE(e,i,o,l,u,4)}}class wM{constructor(e,i){this.width=e.width,this.height=e.height,this.data=i instanceof Uint8Array?new Float32Array(i.buffer):i}}xr(Mu,"AlphaImage"),xr(da,"RGBAImage");const fj=new sa({visibility:new Yt(at.layout_heatmap.visibility)});var hj={paint:new sa({"heatmap-radius":new Pr(at.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Pr(at.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Yt(at.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Gm(at.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Yt(at.paint_heatmap["heatmap-opacity"])}),layout:fj};function E1(r){const e={},i=r.resolution||256,o=r.clips?r.clips.length:1,l=r.image||new da({width:i,height:o}),u=(h,m,_)=>{e[r.evaluationKey]=_;const v=r.expression.evaluate(e);v&&(l.data[h+m+0]=Math.floor(255*v.r/v.a),l.data[h+m+1]=Math.floor(255*v.g/v.a),l.data[h+m+2]=Math.floor(255*v.b/v.a),l.data[h+m+3]=Math.floor(255*v.a))};if(r.clips)for(let h=0,m=0;h<o;++h,m+=4*i)for(let _=0,v=0;_<i;_++,v+=4){const x=_/(i-1),{start:w,end:C}=r.clips[h];u(m,v,w*(1-x)+C*x)}else for(let h=0,m=0;h<i;h++,m+=4)u(0,m,h/(i-1));return l}const dj=new sa({visibility:new Yt(at.layout_hillshade.visibility)});var pj={paint:new sa({"hillshade-illumination-direction":new Yt(at.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Yt(at.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Yt(at.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Yt(at.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Yt(at.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Yt(at.paint_hillshade["hillshade-accent-color"]),"hillshade-emissive-strength":new Yt(at.paint_hillshade["hillshade-emissive-strength"])}),layout:dj};const mj=Zn([{name:"a_pos",components:2,type:"Int16"}],4),{members:gj}=mj;var mE={exports:{}};function T1(r,e,i){i=i||2;var o,l,u,h,m,_,v,x=e&&e.length,w=x?e[0]*i:r.length,C=EM(r,0,w,i,!0),k=[];if(!C||C.next===C.prev)return k;if(x&&(C=function(R,z,B,H){var Z,Y,q,ee=[];for(Z=0,Y=z.length;Z<Y;Z++)(q=EM(R,z[Z]*H,Z<Y-1?z[Z+1]*H:R.length,H,!1))===q.next&&(q.steiner=!0),ee.push(Tj(q));for(ee.sort(bj),Z=0;Z<ee.length;Z++)B=wj(ee[Z],B);return B}(r,e,C,i)),r.length>80*i){o=u=r[0],l=h=r[1];for(var P=i;P<w;P+=i)(m=r[P])<o&&(o=m),(_=r[P+1])<l&&(l=_),m>u&&(u=m),_>h&&(h=_);v=(v=Math.max(u-o,h-l))!==0?32767/v:0}return ng(C,k,i,o,l,v,0),k}function EM(r,e,i,o,l){var u,h;if(l===vE(r,e,i,o)>0)for(u=e;u<i;u+=o)h=CM(u,r[u],r[u+1],h);else for(u=i-o;u>=e;u-=o)h=CM(u,r[u],r[u+1],h);return h&&S1(h,h.next)&&(ag(h),h=h.next),h}function sd(r,e){if(!r)return r;e||(e=r);var i,o=r;do if(i=!1,o.steiner||!S1(o,o.next)&&Ra(o.prev,o,o.next)!==0)o=o.next;else{if(ag(o),(o=e=o.prev)===o.next)break;i=!0}while(i||o!==e);return e}function ng(r,e,i,o,l,u,h){if(r){!h&&u&&function(x,w,C,k){var P=x;do P.z===0&&(P.z=gE(P.x,P.y,w,C,k)),P.prevZ=P.prev,P.nextZ=P.next,P=P.next;while(P!==x);P.prevZ.nextZ=null,P.prevZ=null,function(R){var z,B,H,Z,Y,q,ee,ce,de=1;do{for(B=R,R=null,Y=null,q=0;B;){for(q++,H=B,ee=0,z=0;z<de&&(ee++,H=H.nextZ);z++);for(ce=de;ee>0||ce>0&&H;)ee!==0&&(ce===0||!H||B.z<=H.z)?(Z=B,B=B.nextZ,ee--):(Z=H,H=H.nextZ,ce--),Y?Y.nextZ=Z:R=Z,Z.prevZ=Y,Y=Z;B=H}Y.nextZ=null,de*=2}while(q>1)}(P)}(r,o,l,u);for(var m,_,v=r;r.prev!==r.next;)if(m=r.prev,_=r.next,u?vj(r,o,l,u):_j(r))e.push(m.i/i|0),e.push(r.i/i|0),e.push(_.i/i|0),ag(r),r=_.next,v=_.next;else if((r=_)===v){h?h===1?ng(r=yj(sd(r),e,i),e,i,o,l,u,2):h===2&&xj(r,e,i,o,l,u):ng(sd(r),e,i,o,l,u,1);break}}}function _j(r){var e=r.prev,i=r,o=r.next;if(Ra(e,i,o)>=0)return!1;for(var l=e.x,u=i.x,h=o.x,m=e.y,_=i.y,v=o.y,x=l<u?l<h?l:h:u<h?u:h,w=m<_?m<v?m:v:_<v?_:v,C=l>u?l>h?l:h:u>h?u:h,k=m>_?m>v?m:v:_>v?_:v,P=o.next;P!==e;){if(P.x>=x&&P.x<=C&&P.y>=w&&P.y<=k&&Xp(l,m,u,_,h,v,P.x,P.y)&&Ra(P.prev,P,P.next)>=0)return!1;P=P.next}return!0}function vj(r,e,i,o){var l=r.prev,u=r,h=r.next;if(Ra(l,u,h)>=0)return!1;for(var m=l.x,_=u.x,v=h.x,x=l.y,w=u.y,C=h.y,k=m<_?m<v?m:v:_<v?_:v,P=x<w?x<C?x:C:w<C?w:C,R=m>_?m>v?m:v:_>v?_:v,z=x>w?x>C?x:C:w>C?w:C,B=gE(k,P,e,i,o),H=gE(R,z,e,i,o),Z=r.prevZ,Y=r.nextZ;Z&&Z.z>=B&&Y&&Y.z<=H;){if(Z.x>=k&&Z.x<=R&&Z.y>=P&&Z.y<=z&&Z!==l&&Z!==h&&Xp(m,x,_,w,v,C,Z.x,Z.y)&&Ra(Z.prev,Z,Z.next)>=0||(Z=Z.prevZ,Y.x>=k&&Y.x<=R&&Y.y>=P&&Y.y<=z&&Y!==l&&Y!==h&&Xp(m,x,_,w,v,C,Y.x,Y.y)&&Ra(Y.prev,Y,Y.next)>=0))return!1;Y=Y.nextZ}for(;Z&&Z.z>=B;){if(Z.x>=k&&Z.x<=R&&Z.y>=P&&Z.y<=z&&Z!==l&&Z!==h&&Xp(m,x,_,w,v,C,Z.x,Z.y)&&Ra(Z.prev,Z,Z.next)>=0)return!1;Z=Z.prevZ}for(;Y&&Y.z<=H;){if(Y.x>=k&&Y.x<=R&&Y.y>=P&&Y.y<=z&&Y!==l&&Y!==h&&Xp(m,x,_,w,v,C,Y.x,Y.y)&&Ra(Y.prev,Y,Y.next)>=0)return!1;Y=Y.nextZ}return!0}function yj(r,e,i){var o=r;do{var l=o.prev,u=o.next.next;!S1(l,u)&&TM(l,o,o.next,u)&&ig(l,u)&&ig(u,l)&&(e.push(l.i/i|0),e.push(o.i/i|0),e.push(u.i/i|0),ag(o),ag(o.next),o=r=u),o=o.next}while(o!==r);return sd(o)}function xj(r,e,i,o,l,u){var h=r;do{for(var m=h.next.next;m!==h.prev;){if(h.i!==m.i&&Sj(h,m)){var _=SM(h,m);return h=sd(h,h.next),_=sd(_,_.next),ng(h,e,i,o,l,u,0),void ng(_,e,i,o,l,u,0)}m=m.next}h=h.next}while(h!==r)}function bj(r,e){return r.x-e.x}function wj(r,e){var i=function(l,u){var h,m=u,_=l.x,v=l.y,x=-1/0;do{if(v<=m.y&&v>=m.next.y&&m.next.y!==m.y){var w=m.x+(v-m.y)*(m.next.x-m.x)/(m.next.y-m.y);if(w<=_&&w>x&&(x=w,h=m.x<m.next.x?m:m.next,w===_))return h}m=m.next}while(m!==u);if(!h)return null;var C,k=h,P=h.x,R=h.y,z=1/0;m=h;do _>=m.x&&m.x>=P&&_!==m.x&&Xp(v<R?_:x,v,P,R,v<R?x:_,v,m.x,m.y)&&(C=Math.abs(v-m.y)/(_-m.x),ig(m,l)&&(C<z||C===z&&(m.x>h.x||m.x===h.x&&Ej(h,m)))&&(h=m,z=C)),m=m.next;while(m!==k);return h}(r,e);if(!i)return e;var o=SM(i,r);return sd(o,o.next),sd(i,i.next)}function Ej(r,e){return Ra(r.prev,r,e.prev)<0&&Ra(e.next,r,r.next)<0}function gE(r,e,i,o,l){return(r=1431655765&((r=858993459&((r=252645135&((r=16711935&((r=(r-i)*l|0)|r<<8))|r<<4))|r<<2))|r<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-o)*l|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function Tj(r){var e=r,i=r;do(e.x<i.x||e.x===i.x&&e.y<i.y)&&(i=e),e=e.next;while(e!==r);return i}function Xp(r,e,i,o,l,u,h,m){return(l-h)*(e-m)>=(r-h)*(u-m)&&(r-h)*(o-m)>=(i-h)*(e-m)&&(i-h)*(u-m)>=(l-h)*(o-m)}function Sj(r,e){return r.next.i!==e.i&&r.prev.i!==e.i&&!function(i,o){var l=i;do{if(l.i!==i.i&&l.next.i!==i.i&&l.i!==o.i&&l.next.i!==o.i&&TM(l,l.next,i,o))return!0;l=l.next}while(l!==i);return!1}(r,e)&&(ig(r,e)&&ig(e,r)&&function(i,o){var l=i,u=!1,h=(i.x+o.x)/2,m=(i.y+o.y)/2;do l.y>m!=l.next.y>m&&l.next.y!==l.y&&h<(l.next.x-l.x)*(m-l.y)/(l.next.y-l.y)+l.x&&(u=!u),l=l.next;while(l!==i);return u}(r,e)&&(Ra(r.prev,r,e.prev)||Ra(r,e.prev,e))||S1(r,e)&&Ra(r.prev,r,r.next)>0&&Ra(e.prev,e,e.next)>0)}function Ra(r,e,i){return(e.y-r.y)*(i.x-e.x)-(e.x-r.x)*(i.y-e.y)}function S1(r,e){return r.x===e.x&&r.y===e.y}function TM(r,e,i,o){var l=A1(Ra(r,e,i)),u=A1(Ra(r,e,o)),h=A1(Ra(i,o,r)),m=A1(Ra(i,o,e));return l!==u&&h!==m||!(l!==0||!C1(r,i,e))||!(u!==0||!C1(r,o,e))||!(h!==0||!C1(i,r,o))||!(m!==0||!C1(i,e,o))}function C1(r,e,i){return e.x<=Math.max(r.x,i.x)&&e.x>=Math.min(r.x,i.x)&&e.y<=Math.max(r.y,i.y)&&e.y>=Math.min(r.y,i.y)}function A1(r){return r>0?1:r<0?-1:0}function ig(r,e){return Ra(r.prev,r,r.next)<0?Ra(r,e,r.next)>=0&&Ra(r,r.prev,e)>=0:Ra(r,e,r.prev)<0||Ra(r,r.next,e)<0}function SM(r,e){var i=new _E(r.i,r.x,r.y),o=new _E(e.i,e.x,e.y),l=r.next,u=e.prev;return r.next=e,e.prev=r,i.next=l,l.prev=i,o.next=i,i.prev=o,u.next=o,o.prev=u,o}function CM(r,e,i,o){var l=new _E(r,e,i);return o?(l.next=o.next,l.prev=o,o.next.prev=l,o.next=l):(l.prev=l,l.next=l),l}function ag(r){r.next.prev=r.prev,r.prev.next=r.next,r.prevZ&&(r.prevZ.nextZ=r.nextZ),r.nextZ&&(r.nextZ.prevZ=r.prevZ)}function _E(r,e,i){this.i=r,this.x=e,this.y=i,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function vE(r,e,i,o){for(var l=0,u=e,h=i-o;u<i;u+=o)l+=(r[h]-r[u])*(r[u+1]+r[h+1]),h=u;return l}mE.exports=T1,mE.exports.default=T1,T1.deviation=function(r,e,i,o){var l=e&&e.length,u=Math.abs(vE(r,0,l?e[0]*i:r.length,i));if(l)for(var h=0,m=e.length;h<m;h++)u-=Math.abs(vE(r,e[h]*i,h<m-1?e[h+1]*i:r.length,i));var _=0;for(h=0;h<o.length;h+=3){var v=o[h]*i,x=o[h+1]*i,w=o[h+2]*i;_+=Math.abs((r[v]-r[w])*(r[x+1]-r[v+1])-(r[v]-r[x])*(r[w+1]-r[v+1]))}return u===0&&_===0?0:Math.abs((_-u)/u)},T1.flatten=function(r){for(var e=r[0][0].length,i={vertices:[],holes:[],dimensions:e},o=0,l=0;l<r.length;l++){for(var u=0;u<r[l].length;u++)for(var h=0;h<e;h++)i.vertices.push(r[l][u][h]);l>0&&i.holes.push(o+=r[l-1].length)}return i};var k1=O(mE.exports);function yE(r,e){const i=r.length;if(i<=1)return[r];const o=[];let l,u;for(let h=0;h<i;h++){const m=Se(r[h]);m!==0&&(r[h].area=Math.abs(m),u===void 0&&(u=m<0),u===m<0?(l&&o.push(l),l=[r[h]]):l.push(r[h]))}if(l&&o.push(l),e>1)for(let h=0;h<o.length;h++)o[h].length<=e||(Ac(o[h],e,1,o[h].length-1,Cj),o[h]=o[h].slice(0,e));return o}function Cj(r,e){return e.area-r.area}function xE(r,e,i){const o=i.patternDependencies;let l=!1;for(const u of e){const h=u.paint.get(`${r}-pattern`);h.isConstant()||(l=!0);const m=h.constantOr(null);m&&(l=!0,o[m]=!0)}return l}function bE(r,e,i,o,l){const u=l.patternDependencies;for(const h of e){const m=h.paint.get(`${r}-pattern`).value;if(m.kind!=="constant"){let _=m.evaluate({zoom:o},i,{},l.availableImages);_=_&&_.name?_.name:_,u[_]=!0,i.patterns[h.id]=_}}return i}class I1{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(i=>i.fqid),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Es,this.indexArray=new Oa,this.indexArray2=new Pf,this.programConfigurations=new Lf(e.layers,e.zoom),this.segments=new ui,this.segments2=new ui,this.stateDependentLayerIds=this.layers.filter(i=>i.isStateDependent()).map(i=>i.id),this.projection=e.projection}populate(e,i,o,l){this.hasPattern=xE("fill",this.layers,i);const u=this.layers[0].layout.get("fill-sort-key"),h=[];for(const{feature:m,id:_,index:v,sourceLayerIndex:x}of e){const w=this.layers[0]._featureFilter.needGeometry,C=$f(m,w);if(!this.layers[0]._featureFilter.filter(new Gi(this.zoom),C,o))continue;const k=u?u.evaluate(C,{},o,i.availableImages):void 0,P={id:_,properties:m.properties,type:m.type,sourceLayerIndex:x,index:v,geometry:w?C.geometry:Bc(m,o,l),patterns:{},sortKey:k};h.push(P)}u&&h.sort((m,_)=>m.sortKey-_.sortKey);for(const m of h){const{geometry:_,index:v,sourceLayerIndex:x}=m;if(this.hasPattern){const w=bE("fill",this.layers,m,this.zoom,i);this.patternFeatures.push(w)}else this.addFeature(m,_,v,o,{},i.availableImages,i.brightness);i.featureIndex.insert(e[v].feature,_,v,x,this.index)}}update(e,i,o,l,u){const h=Object.keys(e).length!==0;h&&!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(e,i,h?this.stateDependentLayers:this.layers,o,l,u)}addFeatures(e,i,o,l,u,h){for(const m of this.patternFeatures)this.addFeature(m,m.geometry,m.index,i,o,l,h)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,gj),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(e,i,o,l,u,h=[],m){for(const _ of yE(i,500)){let v=0;for(const R of _)v+=R.length;const x=this.segments.prepareSegment(v,this.layoutVertexArray,this.indexArray),w=x.vertexLength,C=[],k=[];for(const R of _){if(R.length===0)continue;R!==_[0]&&k.push(C.length/2);const z=this.segments2.prepareSegment(R.length,this.layoutVertexArray,this.indexArray2),B=z.vertexLength;this.layoutVertexArray.emplaceBack(R[0].x,R[0].y),this.indexArray2.emplaceBack(B+R.length-1,B),C.push(R[0].x),C.push(R[0].y);for(let H=1;H<R.length;H++)this.layoutVertexArray.emplaceBack(R[H].x,R[H].y),this.indexArray2.emplaceBack(B+H-1,B+H),C.push(R[H].x),C.push(R[H].y);z.vertexLength+=R.length,z.primitiveLength+=R.length}const P=k1(C,k);for(let R=0;R<P.length;R+=3)this.indexArray.emplaceBack(w+P[R],w+P[R+1],w+P[R+2]);x.vertexLength+=v,x.primitiveLength+=P.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,o,u,h,l,m)}}xr(I1,"FillBucket",{omit:["layers","patternFeatures"]});const Aj=new sa({"fill-sort-key":new Pr(at.layout_fill["fill-sort-key"]),visibility:new Yt(at.layout_fill.visibility)});var kj={paint:new sa({"fill-antialias":new Yt(at.paint_fill["fill-antialias"]),"fill-opacity":new Pr(at.paint_fill["fill-opacity"]),"fill-color":new Pr(at.paint_fill["fill-color"]),"fill-outline-color":new Pr(at.paint_fill["fill-outline-color"]),"fill-translate":new Yt(at.paint_fill["fill-translate"]),"fill-translate-anchor":new Yt(at.paint_fill["fill-translate-anchor"]),"fill-pattern":new Pr(at.paint_fill["fill-pattern"]),"fill-emissive-strength":new Yt(at.paint_fill["fill-emissive-strength"])}),layout:Aj};const Ij=Zn([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),Mj=Zn([{name:"a_pos_end",components:4,type:"Int16"},{name:"a_angular_offset_factor",components:1,type:"Int16"}]),Fj=Zn([{name:"a_centroid_pos",components:2,type:"Uint16"}]),Pj=Zn([{name:"a_hidden_by_landmark",components:1,type:"Uint8"}]),Oj=Zn([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:Rj}=Ij;var M1={},Lj=j,AM=Zp;function Zp(r,e,i,o,l){this.properties={},this.extent=i,this.type=0,this._pbf=r,this._geometry=-1,this._keys=o,this._values=l,r.readFields(Dj,this,e)}function Dj(r,e,i){r==1?e.id=i.readVarint():r==2?function(o,l){for(var u=o.readVarint()+o.pos;o.pos<u;){var h=l._keys[o.readVarint()],m=l._values[o.readVarint()];l.properties[h]=m}}(i,e):r==3?e.type=i.readVarint():r==4&&(e._geometry=i.pos)}function Bj(r){for(var e,i,o=0,l=0,u=r.length,h=u-1;l<u;h=l++)o+=((i=r[h]).x-(e=r[l]).x)*(e.y+i.y);return o}Zp.types=["Unknown","Point","LineString","Polygon"],Zp.prototype.loadGeometry=function(){var r=this._pbf;r.pos=this._geometry;for(var e,i=r.readVarint()+r.pos,o=1,l=0,u=0,h=0,m=[];r.pos<i;){if(l<=0){var _=r.readVarint();o=7&_,l=_>>3}if(l--,o===1||o===2)u+=r.readSVarint(),h+=r.readSVarint(),o===1&&(e&&m.push(e),e=[]),e.push(new Lj(u,h));else{if(o!==7)throw new Error("unknown command "+o);e&&e.push(e[0].clone())}}return e&&m.push(e),m},Zp.prototype.bbox=function(){var r=this._pbf;r.pos=this._geometry;for(var e=r.readVarint()+r.pos,i=1,o=0,l=0,u=0,h=1/0,m=-1/0,_=1/0,v=-1/0;r.pos<e;){if(o<=0){var x=r.readVarint();i=7&x,o=x>>3}if(o--,i===1||i===2)(l+=r.readSVarint())<h&&(h=l),l>m&&(m=l),(u+=r.readSVarint())<_&&(_=u),u>v&&(v=u);else if(i!==7)throw new Error("unknown command "+i)}return[h,_,m,v]},Zp.prototype.toGeoJSON=function(r,e,i){var o,l,u=this.extent*Math.pow(2,i),h=this.extent*r,m=this.extent*e,_=this.loadGeometry(),v=Zp.types[this.type];function x(k){for(var P=0;P<k.length;P++){var R=k[P];k[P]=[360*(R.x+h)/u-180,360/Math.PI*Math.atan(Math.exp((180-360*(R.y+m)/u)*Math.PI/180))-90]}}switch(this.type){case 1:var w=[];for(o=0;o<_.length;o++)w[o]=_[o][0];x(_=w);break;case 2:for(o=0;o<_.length;o++)x(_[o]);break;case 3:for(_=function(k){var P=k.length;if(P<=1)return[k];for(var R,z,B=[],H=0;H<P;H++){var Z=Bj(k[H]);Z!==0&&(z===void 0&&(z=Z<0),z===Z<0?(R&&B.push(R),R=[k[H]]):R.push(k[H]))}return R&&B.push(R),B}(_),o=0;o<_.length;o++)for(l=0;l<_[o].length;l++)x(_[o][l])}_.length===1?_=_[0]:v="Multi"+v;var C={type:"Feature",geometry:{type:v,coordinates:_},properties:this.properties};return"id"in this&&(C.id=this.id),C};var zj=AM,kM=IM;function IM(r,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=r,this._keys=[],this._values=[],this._features=[],r.readFields(Nj,this,e),this.length=this._features.length}function Nj(r,e,i){r===15?e.version=i.readVarint():r===1?e.name=i.readString():r===5?e.extent=i.readVarint():r===2?e._features.push(i.pos):r===3?e._keys.push(i.readString()):r===4&&e._values.push(function(o){for(var l=null,u=o.readVarint()+o.pos;o.pos<u;){var h=o.readVarint()>>3;l=h===1?o.readString():h===2?o.readFloat():h===3?o.readDouble():h===4?o.readVarint64():h===5?o.readVarint():h===6?o.readSVarint():h===7?o.readBoolean():null}return l}(i))}IM.prototype.feature=function(r){if(r<0||r>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[r];var e=this._pbf.readVarint()+this._pbf.pos;return new zj(this._pbf,e,this.extent,this._keys,this._values)};var Uj=kM;function $j(r,e,i){if(r===3){var o=new Uj(i,i.readVarint()+i.pos);o.length&&(e[o.name]=o)}}var wE=M1.VectorTile=function(r,e){this.layers=r.readFields($j,{},e)},F1=M1.VectorTileFeature=AM;function P1(r,e,i,o){const l=[],u=o===0?(h,m,_,v,x,w)=>{h.push(new D(w,_+(w-m)/(v-m)*(x-_)))}:(h,m,_,v,x,w)=>{h.push(new D(m+(w-_)/(x-_)*(v-m),w))};for(const h of r){const m=[];for(const _ of h){if(_.length<=2)continue;const v=[];for(let C=0;C<_.length-1;C++){const k=_[C].x,P=_[C].y,R=_[C+1].x,z=_[C+1].y,B=o===0?k:P,H=o===0?R:z;B<e?H>e&&u(v,k,P,R,z,e):B>i?H<i&&u(v,k,P,R,z,i):v.push(_[C]),H<e&&B>=e&&u(v,k,P,R,z,e),H>i&&B<=i&&u(v,k,P,R,z,i)}let x=_[_.length-1];const w=o===0?x.x:x.y;w>=e&&w<=i&&v.push(x),v.length&&(x=v[v.length-1],v[0].x===x.x&&v[0].y===x.y||v.push(v[0]),m.push(v))}m.length&&l.push(m)}return l}M1.VectorTileLayer=kM;class MM{constructor(e){this._stringToNumber={},this._numberToString=[];for(let i=0;i<e.length;i++){const o=e[i];this._stringToNumber[o]=i,this._numberToString[i]=o}}encode(e){return this._stringToNumber[e]}decode(e){return this._numberToString[e]}}var Vj={read:function(r,e,i,o,l){var u,h,m=8*l-o-1,_=(1<<m)-1,v=_>>1,x=-7,w=i?l-1:0,C=i?-1:1,k=r[e+w];for(w+=C,u=k&(1<<-x)-1,k>>=-x,x+=m;x>0;u=256*u+r[e+w],w+=C,x-=8);for(h=u&(1<<-x)-1,u>>=-x,x+=o;x>0;h=256*h+r[e+w],w+=C,x-=8);if(u===0)u=1-v;else{if(u===_)return h?NaN:1/0*(k?-1:1);h+=Math.pow(2,o),u-=v}return(k?-1:1)*h*Math.pow(2,u-o)},write:function(r,e,i,o,l,u){var h,m,_,v=8*u-l-1,x=(1<<v)-1,w=x>>1,C=l===23?Math.pow(2,-24)-Math.pow(2,-77):0,k=o?0:u-1,P=o?1:-1,R=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(m=isNaN(e)?1:0,h=x):(h=Math.floor(Math.log(e)/Math.LN2),e*(_=Math.pow(2,-h))<1&&(h--,_*=2),(e+=h+w>=1?C/_:C*Math.pow(2,1-w))*_>=2&&(h++,_/=2),h+w>=x?(m=0,h=x):h+w>=1?(m=(e*_-1)*Math.pow(2,l),h+=w):(m=e*Math.pow(2,w-1)*Math.pow(2,l),h=0));l>=8;r[i+k]=255&m,k+=P,m/=256,l-=8);for(h=h<<l|m,v+=l;v>0;r[i+k]=255&h,k+=P,h/=256,v-=8);r[i+k-P]|=128*R}},FM=Bi,O1=Vj;function Bi(r){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(r)?r:new Uint8Array(r||0),this.pos=0,this.type=0,this.length=this.buf.length}Bi.Varint=0,Bi.Fixed64=1,Bi.Bytes=2,Bi.Fixed32=5;var EE=4294967296,PM=1/EE,OM=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function Fu(r){return r.type===Bi.Bytes?r.readVarint()+r.pos:r.pos+1}function Kp(r,e,i){return i?4294967296*e+(r>>>0):4294967296*(e>>>0)+(r>>>0)}function RM(r,e,i){var o=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));i.realloc(o);for(var l=i.pos-1;l>=r;l--)i.buf[l+o]=i.buf[l]}function jj(r,e){for(var i=0;i<r.length;i++)e.writeVarint(r[i])}function Wj(r,e){for(var i=0;i<r.length;i++)e.writeSVarint(r[i])}function Hj(r,e){for(var i=0;i<r.length;i++)e.writeFloat(r[i])}function Gj(r,e){for(var i=0;i<r.length;i++)e.writeDouble(r[i])}function qj(r,e){for(var i=0;i<r.length;i++)e.writeBoolean(r[i])}function Xj(r,e){for(var i=0;i<r.length;i++)e.writeFixed32(r[i])}function Zj(r,e){for(var i=0;i<r.length;i++)e.writeSFixed32(r[i])}function Kj(r,e){for(var i=0;i<r.length;i++)e.writeFixed64(r[i])}function Yj(r,e){for(var i=0;i<r.length;i++)e.writeSFixed64(r[i])}function R1(r,e){return(r[e]|r[e+1]<<8|r[e+2]<<16)+16777216*r[e+3]}function Yp(r,e,i){r[i]=e,r[i+1]=e>>>8,r[i+2]=e>>>16,r[i+3]=e>>>24}function LM(r,e){return(r[e]|r[e+1]<<8|r[e+2]<<16)+(r[e+3]<<24)}Bi.prototype={destroy:function(){this.buf=null},readFields:function(r,e,i){for(i=i||this.length;this.pos<i;){var o=this.readVarint(),l=o>>3,u=this.pos;this.type=7&o,r(l,e,this),this.pos===u&&this.skip(o)}return e},readMessage:function(r,e){return this.readFields(r,e,this.readVarint()+this.pos)},readFixed32:function(){var r=R1(this.buf,this.pos);return this.pos+=4,r},readSFixed32:function(){var r=LM(this.buf,this.pos);return this.pos+=4,r},readFixed64:function(){var r=R1(this.buf,this.pos)+R1(this.buf,this.pos+4)*EE;return this.pos+=8,r},readSFixed64:function(){var r=R1(this.buf,this.pos)+LM(this.buf,this.pos+4)*EE;return this.pos+=8,r},readFloat:function(){var r=O1.read(this.buf,this.pos,!0,23,4);return this.pos+=4,r},readDouble:function(){var r=O1.read(this.buf,this.pos,!0,52,8);return this.pos+=8,r},readVarint:function(r){var e,i,o=this.buf;return e=127&(i=o[this.pos++]),i<128?e:(e|=(127&(i=o[this.pos++]))<<7,i<128?e:(e|=(127&(i=o[this.pos++]))<<14,i<128?e:(e|=(127&(i=o[this.pos++]))<<21,i<128?e:function(l,u,h){var m,_,v=h.buf;if(m=(112&(_=v[h.pos++]))>>4,_<128||(m|=(127&(_=v[h.pos++]))<<3,_<128)||(m|=(127&(_=v[h.pos++]))<<10,_<128)||(m|=(127&(_=v[h.pos++]))<<17,_<128)||(m|=(127&(_=v[h.pos++]))<<24,_<128)||(m|=(1&(_=v[h.pos++]))<<31,_<128))return Kp(l,m,u);throw new Error("Expected varint not more than 10 bytes")}(e|=(15&(i=o[this.pos]))<<28,r,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var r=this.readVarint();return r%2==1?(r+1)/-2:r/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var r=this.readVarint()+this.pos,e=this.pos;return this.pos=r,r-e>=12&&OM?function(i,o,l){return OM.decode(i.subarray(o,l))}(this.buf,e,r):function(i,o,l){for(var u="",h=o;h<l;){var m,_,v,x=i[h],w=null,C=x>239?4:x>223?3:x>191?2:1;if(h+C>l)break;C===1?x<128&&(w=x):C===2?(192&(m=i[h+1]))==128&&(w=(31&x)<<6|63&m)<=127&&(w=null):C===3?(_=i[h+2],(192&(m=i[h+1]))==128&&(192&_)==128&&((w=(15&x)<<12|(63&m)<<6|63&_)<=2047||w>=55296&&w<=57343)&&(w=null)):C===4&&(_=i[h+2],v=i[h+3],(192&(m=i[h+1]))==128&&(192&_)==128&&(192&v)==128&&((w=(15&x)<<18|(63&m)<<12|(63&_)<<6|63&v)<=65535||w>=1114112)&&(w=null)),w===null?(w=65533,C=1):w>65535&&(w-=65536,u+=String.fromCharCode(w>>>10&1023|55296),w=56320|1023&w),u+=String.fromCharCode(w),h+=C}return u}(this.buf,e,r)},readBytes:function(){var r=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,r);return this.pos=r,e},readPackedVarint:function(r,e){if(this.type!==Bi.Bytes)return r.push(this.readVarint(e));var i=Fu(this);for(r=r||[];this.pos<i;)r.push(this.readVarint(e));return r},readPackedSVarint:function(r){if(this.type!==Bi.Bytes)return r.push(this.readSVarint());var e=Fu(this);for(r=r||[];this.pos<e;)r.push(this.readSVarint());return r},readPackedBoolean:function(r){if(this.type!==Bi.Bytes)return r.push(this.readBoolean());var e=Fu(this);for(r=r||[];this.pos<e;)r.push(this.readBoolean());return r},readPackedFloat:function(r){if(this.type!==Bi.Bytes)return r.push(this.readFloat());var e=Fu(this);for(r=r||[];this.pos<e;)r.push(this.readFloat());return r},readPackedDouble:function(r){if(this.type!==Bi.Bytes)return r.push(this.readDouble());var e=Fu(this);for(r=r||[];this.pos<e;)r.push(this.readDouble());return r},readPackedFixed32:function(r){if(this.type!==Bi.Bytes)return r.push(this.readFixed32());var e=Fu(this);for(r=r||[];this.pos<e;)r.push(this.readFixed32());return r},readPackedSFixed32:function(r){if(this.type!==Bi.Bytes)return r.push(this.readSFixed32());var e=Fu(this);for(r=r||[];this.pos<e;)r.push(this.readSFixed32());return r},readPackedFixed64:function(r){if(this.type!==Bi.Bytes)return r.push(this.readFixed64());var e=Fu(this);for(r=r||[];this.pos<e;)r.push(this.readFixed64());return r},readPackedSFixed64:function(r){if(this.type!==Bi.Bytes)return r.push(this.readSFixed64());var e=Fu(this);for(r=r||[];this.pos<e;)r.push(this.readSFixed64());return r},skip:function(r){var e=7&r;if(e===Bi.Varint)for(;this.buf[this.pos++]>127;);else if(e===Bi.Bytes)this.pos=this.readVarint()+this.pos;else if(e===Bi.Fixed32)this.pos+=4;else{if(e!==Bi.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(r,e){this.writeVarint(r<<3|e)},realloc:function(r){for(var e=this.length||16;e<this.pos+r;)e*=2;if(e!==this.length){var i=new Uint8Array(e);i.set(this.buf),this.buf=i,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(r){this.realloc(4),Yp(this.buf,r,this.pos),this.pos+=4},writeSFixed32:function(r){this.realloc(4),Yp(this.buf,r,this.pos),this.pos+=4},writeFixed64:function(r){this.realloc(8),Yp(this.buf,-1&r,this.pos),Yp(this.buf,Math.floor(r*PM),this.pos+4),this.pos+=8},writeSFixed64:function(r){this.realloc(8),Yp(this.buf,-1&r,this.pos),Yp(this.buf,Math.floor(r*PM),this.pos+4),this.pos+=8},writeVarint:function(r){(r=+r||0)>268435455||r<0?function(e,i){var o,l;if(e>=0?(o=e%4294967296|0,l=e/4294967296|0):(l=~(-e/4294967296),4294967295^(o=~(-e%4294967296))?o=o+1|0:(o=0,l=l+1|0)),e>=18446744073709552e3||e<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");i.realloc(10),function(u,h,m){m.buf[m.pos++]=127&u|128,u>>>=7,m.buf[m.pos++]=127&u|128,u>>>=7,m.buf[m.pos++]=127&u|128,u>>>=7,m.buf[m.pos++]=127&u|128,m.buf[m.pos]=127&(u>>>=7)}(o,0,i),function(u,h){var m=(7&u)<<4;h.buf[h.pos++]|=m|((u>>>=3)?128:0),u&&(h.buf[h.pos++]=127&u|((u>>>=7)?128:0),u&&(h.buf[h.pos++]=127&u|((u>>>=7)?128:0),u&&(h.buf[h.pos++]=127&u|((u>>>=7)?128:0),u&&(h.buf[h.pos++]=127&u|((u>>>=7)?128:0),u&&(h.buf[h.pos++]=127&u)))))}(l,i)}(r,this):(this.realloc(4),this.buf[this.pos++]=127&r|(r>127?128:0),r<=127||(this.buf[this.pos++]=127&(r>>>=7)|(r>127?128:0),r<=127||(this.buf[this.pos++]=127&(r>>>=7)|(r>127?128:0),r<=127||(this.buf[this.pos++]=r>>>7&127))))},writeSVarint:function(r){this.writeVarint(r<0?2*-r-1:2*r)},writeBoolean:function(r){this.writeVarint(!!r)},writeString:function(r){r=String(r),this.realloc(4*r.length),this.pos++;var e=this.pos;this.pos=function(o,l,u){for(var h,m,_=0;_<l.length;_++){if((h=l.charCodeAt(_))>55295&&h<57344){if(!m){h>56319||_+1===l.length?(o[u++]=239,o[u++]=191,o[u++]=189):m=h;continue}if(h<56320){o[u++]=239,o[u++]=191,o[u++]=189,m=h;continue}h=m-55296<<10|h-56320|65536,m=null}else m&&(o[u++]=239,o[u++]=191,o[u++]=189,m=null);h<128?o[u++]=h:(h<2048?o[u++]=h>>6|192:(h<65536?o[u++]=h>>12|224:(o[u++]=h>>18|240,o[u++]=h>>12&63|128),o[u++]=h>>6&63|128),o[u++]=63&h|128)}return u}(this.buf,r,this.pos);var i=this.pos-e;i>=128&&RM(e,i,this),this.pos=e-1,this.writeVarint(i),this.pos+=i},writeFloat:function(r){this.realloc(4),O1.write(this.buf,r,this.pos,!0,23,4),this.pos+=4},writeDouble:function(r){this.realloc(8),O1.write(this.buf,r,this.pos,!0,52,8),this.pos+=8},writeBytes:function(r){var e=r.length;this.writeVarint(e),this.realloc(e);for(var i=0;i<e;i++)this.buf[this.pos++]=r[i]},writeRawMessage:function(r,e){this.pos++;var i=this.pos;r(e,this);var o=this.pos-i;o>=128&&RM(i,o,this),this.pos=i-1,this.writeVarint(o),this.pos+=o},writeMessage:function(r,e,i){this.writeTag(r,Bi.Bytes),this.writeRawMessage(e,i)},writePackedVarint:function(r,e){e.length&&this.writeMessage(r,jj,e)},writePackedSVarint:function(r,e){e.length&&this.writeMessage(r,Wj,e)},writePackedBoolean:function(r,e){e.length&&this.writeMessage(r,qj,e)},writePackedFloat:function(r,e){e.length&&this.writeMessage(r,Hj,e)},writePackedDouble:function(r,e){e.length&&this.writeMessage(r,Gj,e)},writePackedFixed32:function(r,e){e.length&&this.writeMessage(r,Xj,e)},writePackedSFixed32:function(r,e){e.length&&this.writeMessage(r,Zj,e)},writePackedFixed64:function(r,e){e.length&&this.writeMessage(r,Kj,e)},writePackedSFixed64:function(r,e){e.length&&this.writeMessage(r,Yj,e)},writeBytesField:function(r,e){this.writeTag(r,Bi.Bytes),this.writeBytes(e)},writeFixed32Field:function(r,e){this.writeTag(r,Bi.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(r,e){this.writeTag(r,Bi.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(r,e){this.writeTag(r,Bi.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(r,e){this.writeTag(r,Bi.Fixed64),this.writeSFixed64(e)},writeVarintField:function(r,e){this.writeTag(r,Bi.Varint),this.writeVarint(e)},writeSVarintField:function(r,e){this.writeTag(r,Bi.Varint),this.writeSVarint(e)},writeStringField:function(r,e){this.writeTag(r,Bi.Bytes),this.writeString(e)},writeFloatField:function(r,e){this.writeTag(r,Bi.Fixed32),this.writeFloat(e)},writeDoubleField:function(r,e){this.writeTag(r,Bi.Fixed64),this.writeDouble(e)},writeBooleanField:function(r,e){this.writeVarintField(r,!!e)}};var L1=O(FM);const Jj=["tile","layer","source","sourceLayer","state"];class DM{constructor(e,i,o,l,u){this.type="Feature",this._vectorTileFeature=e,this._z=i,this._x=o,this._y=l,this.properties=e.properties,this.id=u}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(e){this._geometry=e}toJSON(){const e={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};this.id!==void 0&&(e.id=this.id);for(const i of Jj)this[i]!==void 0&&(e[i]=this[i]);return e}}class Qj{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(e,i,o){const l=String(i);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][l]=this.stateChanges[e][l]||{},ze(this.stateChanges[e][l],o),this.deletedStates[e]===null){this.deletedStates[e]={};for(const u in this.state[e])u!==l&&(this.deletedStates[e][u]=null)}else if(this.deletedStates[e]&&this.deletedStates[e][l]===null){this.deletedStates[e][l]={};for(const u in this.state[e][l])o[u]||(this.deletedStates[e][l][u]=null)}else for(const u in o)this.deletedStates[e]&&this.deletedStates[e][l]&&this.deletedStates[e][l][u]===null&&delete this.deletedStates[e][l][u]}removeFeatureState(e,i,o){if(this.deletedStates[e]===null)return;const l=String(i);if(this.deletedStates[e]=this.deletedStates[e]||{},o&&i!==void 0)this.deletedStates[e][l]!==null&&(this.deletedStates[e][l]=this.deletedStates[e][l]||{},this.deletedStates[e][l][o]=null);else if(i!==void 0)if(this.stateChanges[e]&&this.stateChanges[e][l])for(o in this.deletedStates[e][l]={},this.stateChanges[e][l])this.deletedStates[e][l][o]=null;else this.deletedStates[e][l]=null;else this.deletedStates[e]=null}getState(e,i){const o=String(i),l=ze({},(this.state[e]||{})[o],(this.stateChanges[e]||{})[o]);if(this.deletedStates[e]===null)return{};if(this.deletedStates[e]){const u=this.deletedStates[e][i];if(u===null)return{};for(const h in u)delete l[h]}return l}initializeTileState(e,i){e.setFeatureState(this.state,i)}coalesceChanges(e,i){const o={};for(const l in this.stateChanges){this.state[l]=this.state[l]||{};const u={};for(const h in this.stateChanges[l])this.state[l][h]||(this.state[l][h]={}),ze(this.state[l][h],this.stateChanges[l][h]),u[h]=this.state[l][h];o[l]=u}for(const l in this.deletedStates){this.state[l]=this.state[l]||{};const u={};if(this.deletedStates[l]===null)for(const h in this.state[l])u[h]={},this.state[l][h]={};else for(const h in this.deletedStates[l]){if(this.deletedStates[l][h]===null)this.state[l][h]={};else if(this.state[l][h])for(const m of Object.keys(this.deletedStates[l][h]))delete this.state[l][h][m];u[h]=this.state[l][h]}o[l]=o[l]||{},ze(o[l],u)}if(this.stateChanges={},this.deletedStates={},Object.keys(o).length!==0)for(const l in e)e[l].setFeatureState(o,i)}}class BM{constructor(e){this.size=e,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(e,i){const o=this.toIdx(e,i);return{min:this.minimums[o],max:this.maximums[o]}}isLeaf(e,i){return this.leaves[this.toIdx(e,i)]}toIdx(e,i){return i*this.size+e}}function zM(r,e,i,o){let l=0,u=Number.MAX_VALUE;for(let h=0;h<3;h++)if(Math.abs(o[h])<1e-15){if(i[h]<r[h]||i[h]>e[h])return null}else{const m=1/o[h];let _=(r[h]-i[h])*m,v=(e[h]-i[h])*m;if(_>v){const x=_;_=v,v=x}if(_>l&&(l=_),v<u&&(u=v),l>u)return null}return l}function NM(r,e,i,o,l,u,h,m,_,v,x){const w=o-r,C=l-e,k=u-i,P=h-r,R=m-e,z=_-i,B=x[1]*z-x[2]*R,H=x[2]*P-x[0]*z,Z=x[0]*R-x[1]*P,Y=w*B+C*H+k*Z;if(Math.abs(Y)<1e-15)return null;const q=1/Y,ee=v[0]-r,ce=v[1]-e,de=v[2]-i,ge=(ee*B+ce*H+de*Z)*q;if(ge<0||ge>1)return null;const ve=ce*k-de*C,Re=de*w-ee*k,ke=ee*C-ce*w,$e=(x[0]*ve+x[1]*Re+x[2]*ke)*q;return $e<0||ge+$e>1?null:(P*ve+R*Re+z*ke)*q}function UM(r,e,i){return(r-e)/(i-e)}function $M(r,e,i,o,l,u,h,m,_){const v=1<<i,x=u-o,w=h-l,C=(r+1)/v*x+o,k=(e+0)/v*w+l,P=(e+1)/v*w+l;m[0]=(r+0)/v*x+o,m[1]=k,_[0]=C,_[1]=P}class VM{constructor(e){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=e,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const i=function(u){const h=Math.ceil(Math.log2(u.dim/8)),m=[];let _=Math.ceil(Math.pow(2,h));const v=1/_,x=(k,P,R,z,B)=>{const H=z?1:0,Z=(k+1)*R-H,Y=P*R,q=(P+1)*R-H;B[0]=k*R,B[1]=Y,B[2]=Z,B[3]=q};let w=new BM(_);const C=[];for(let k=0;k<_*_;k++){x(k%_,Math.floor(k/_),v,!1,C);const P=jf(C[0],C[1],u),R=jf(C[2],C[1],u),z=jf(C[2],C[3],u),B=jf(C[0],C[3],u);w.minimums.push(Math.min(P,R,z,B)),w.maximums.push(Math.max(P,R,z,B)),w.leaves.push(1)}for(m.push(w),_/=2;_>=1;_/=2){const k=m[m.length-1];w=new BM(_);for(let P=0;P<_*_;P++){x(P%_,Math.floor(P/_),2,!0,C);const R=k.getElevation(C[0],C[1]),z=k.getElevation(C[2],C[1]),B=k.getElevation(C[2],C[3]),H=k.getElevation(C[0],C[3]),Z=k.isLeaf(C[0],C[1]),Y=k.isLeaf(C[2],C[1]),q=k.isLeaf(C[2],C[3]),ee=k.isLeaf(C[0],C[3]),ce=Math.min(R.min,z.min,B.min,H.min),de=Math.max(R.max,z.max,B.max,H.max),ge=Z&&Y&&q&&ee;w.maximums.push(de),w.minimums.push(ce),w.leaves.push(de-ce<=5&&ge?1:0)}m.push(w)}return m}(this.dem),o=i.length-1,l=i[o];this._addNode(l.minimums[0],l.maximums[0],l.leaves[0]),this._construct(i,0,0,o,0)}raycastRoot(e,i,o,l,u,h,m=1){return zM([e,i,-100],[o,l,this.maximums[0]*m],u,h)}raycast(e,i,o,l,u,h,m=1){if(!this.nodeCount)return null;const _=this.raycastRoot(e,i,o,l,u,h,m);if(_==null)return null;const v=[],x=[],w=[],C=[],k=[{idx:0,t:_,nodex:0,nodey:0,depth:0}];for(;k.length>0;){const{idx:P,t:R,nodex:z,nodey:B,depth:H}=k.pop();if(this.leaves[P]){$M(z,B,H,e,i,o,l,w,C);const Y=1<<H,q=(z+0)/Y,ee=(z+1)/Y,ce=(B+0)/Y,de=(B+1)/Y,ge=jf(q,ce,this.dem)*m,ve=jf(ee,ce,this.dem)*m,Re=jf(ee,de,this.dem)*m,ke=jf(q,de,this.dem)*m,$e=NM(w[0],w[1],ge,C[0],w[1],ve,C[0],C[1],Re,u,h),Ie=NM(C[0],C[1],Re,w[0],C[1],ke,w[0],w[1],ge,u,h),Qe=Math.min($e!==null?$e:Number.MAX_VALUE,Ie!==null?Ie:Number.MAX_VALUE);if(Qe!==Number.MAX_VALUE)return Qe;{const st=We.scaleAndAdd([],u,h,R);if(jM(ge,ve,ke,Re,UM(st[0],w[0],C[0]),UM(st[1],w[1],C[1]))>=st[2])return R}continue}let Z=0;for(let Y=0;Y<this._siblingOffset.length;Y++){$M((z<<1)+this._siblingOffset[Y][0],(B<<1)+this._siblingOffset[Y][1],H+1,e,i,o,l,w,C),w[2]=-100,C[2]=this.maximums[this.childOffsets[P]+Y]*m;const q=zM(w,C,u,h);if(q!=null){const ee=q;v[Y]=ee;let ce=!1;for(let de=0;de<Z&&!ce;de++)ee>=v[x[de]]&&(x.splice(de,0,Y),ce=!0);ce||(x[Z]=Y),Z++}}for(let Y=0;Y<Z;Y++){const q=x[Y];k.push({idx:this.childOffsets[P]+q,t:v[q],nodex:(z<<1)+this._siblingOffset[q][0],nodey:(B<<1)+this._siblingOffset[q][1],depth:H+1})}}return null}_addNode(e,i,o){return this.minimums.push(e),this.maximums.push(i),this.leaves.push(o),this.childOffsets.push(0),this.nodeCount++}_construct(e,i,o,l,u){if(e[l].isLeaf(i,o)===1)return;this.childOffsets[u]||(this.childOffsets[u]=this.nodeCount);const h=l-1,m=e[h];let _=0,v=0;for(let x=0;x<this._siblingOffset.length;x++){const w=2*i+this._siblingOffset[x][0],C=2*o+this._siblingOffset[x][1],k=m.getElevation(w,C),P=m.isLeaf(w,C),R=this._addNode(k.min,k.max,P);P&&(_|=1<<x),v||(v=R)}for(let x=0;x<this._siblingOffset.length;x++)_&1<<x||this._construct(e,2*i+this._siblingOffset[x][0],2*o+this._siblingOffset[x][1],h,v+x)}}function jM(r,e,i,o,l,u){return $r($r(r,i,u),$r(e,o,u),l)}function jf(r,e,i){const o=i.dim,l=Oe(r*o-.5,0,o-1),u=Oe(e*o-.5,0,o-1),h=Math.floor(l),m=Math.floor(u),_=Math.min(h+1,o-1),v=Math.min(m+1,o-1);return jM(i.get(h,m),i.get(_,m),i.get(h,v),i.get(_,v),l-h,u-m)}const WM={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768],float:[1,1,1,1]};function TE(r,e,i){return(256*r*256+256*e+i)/10-1e4}function SE(r,e,i){return 256*r+e+i/256-32768}class ld{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(e,i,o,l,u=!1){if(this.uid=e,i.height!==i.width)throw new RangeError("DEM tiles must be square");if(o&&o!=="mapbox"&&o!=="terrarium")return se(`"${o}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=i.height;const h=this.dim=i.height-2,m=new Uint32Array(i.data.buffer);if(this.pixels=new Uint8Array(i.data.buffer),this.encoding=o||"mapbox",this.borderReady=u,this._modifiedForSources={},!u){for(let _=0;_<h;_++)m[this._idx(-1,_)]=m[this._idx(0,_)],m[this._idx(h,_)]=m[this._idx(h-1,_)],m[this._idx(_,-1)]=m[this._idx(_,0)],m[this._idx(_,h)]=m[this._idx(_,h-1)];m[this._idx(-1,-1)]=m[this._idx(0,0)],m[this._idx(h,-1)]=m[this._idx(h-1,0)],m[this._idx(-1,h)]=m[this._idx(0,h-1)],m[this._idx(h,h)]=m[this._idx(h-1,h-1)]}if(l){const _=new Float32Array(i.data.buffer),v=this.encoding==="terrarium"?SE:TE;for(let x=0;x<m.length;++x){const w=4*x;_[x]=v(this.pixels[w],this.pixels[w+1],this.pixels[w+2])}this.encoding="float"}this._timestamp=Jr.now()}_buildQuadTree(){this._tree=new VM(this)}get(e,i,o=!1){o&&(e=Oe(e,-1,this.dim),i=Oe(i,-1,this.dim));const l=this._idx(e,i);if(this.encoding==="float")return this.floatView||(this.floatView=new Float32Array(this.pixels.buffer)),this.floatView[l];const u=4*l;return(this.encoding==="terrarium"?SE:TE)(this.pixels[u],this.pixels[u+1],this.pixels[u+2])}set(e,i,o){const l=this._idx(e,i);if(this.encoding==="float"){this.floatView||(this.floatView=new Float32Array(this.pixels.buffer));const _=this.floatView[l];return this.floatView[l]=o,o-_}const u=4*l,h=(this.encoding==="terrarium"?SE:TE)(this.pixels[u],this.pixels[u+1],this.pixels[u+2]),m=ld.pack(o,this.encoding==="terrarium"?"terrarium":"mapbox");return this.pixels[u]=m[0],this.pixels[u+1]=m[1],this.pixels[u+2]=m[2],o-h}static getUnpackVector(e){return WM[e]}get unpackVector(){return WM[this.encoding]}_idx(e,i){if(e<-1||e>=this.dim+1||i<-1||i>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(i+1)*this.stride+(e+1)}static pack(e,i){const o=[0,0,0,0],l=ld.getUnpackVector(i);let u=Math.floor((e+l[3])/l[2]);return o[2]=u%256,u=Math.floor(u/256),o[1]=u%256,u=Math.floor(u/256),o[0]=u,o}getPixels(){return this.encoding==="float"?new wM({width:this.stride,height:this.stride},this.pixels):new da({width:this.stride,height:this.stride},this.pixels)}backfillBorder(e,i,o){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");let l=i*this.dim,u=i*this.dim+this.dim,h=o*this.dim,m=o*this.dim+this.dim;switch(i){case-1:l=u-1;break;case 1:u=l+1}switch(o){case-1:h=m-1;break;case 1:m=h+1}const _=-i*this.dim,v=-o*this.dim;for(let x=h;x<m;x++)for(let w=l;w<u;w++){const C=4*this._idx(w,x),k=4*this._idx(w+_,x+v);this.pixels[C+0]=e.pixels[k+0],this.pixels[C+1]=e.pixels[k+1],this.pixels[C+2]=e.pixels[k+2],this.pixels[C+3]=e.pixels[k+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}xr(ld,"DEMData"),xr(VM,"DemMinMaxQuadTree",{omit:["dem"]});class eW{isDataAvailableAtPoint(e){const i=this._source();if(this.isUsingMockSource()||!i||e.y<0||e.y>1)return!1;const o=i.getSource().maxzoom,l=1<<o,u=Math.floor(e.x),h=Math.floor((e.x-u)*l),m=Math.floor(e.y*l),_=this.findDEMTileFor(new Wn(o,u,o,h,m));return!(!_||!_.dem)}getAtPointOrZero(e,i=0){return this.getAtPoint(e,i)||0}getAtPoint(e,i,o=!0){if(this.isUsingMockSource())return null;i==null&&(i=null);const l=this._source();if(!l||e.y<0||e.y>1)return i;const u=l.getSource().maxzoom,h=1<<u,m=Math.floor(e.x),_=e.x-m,v=new Wn(u,m,u,Math.floor(_*h),Math.floor(e.y*h)),x=this.findDEMTileFor(v);if(!x||!x.dem)return i;const w=x.dem,C=1<<x.tileID.canonical.z,k=(_*C-x.tileID.canonical.x)*w.dim,P=(e.y*C-x.tileID.canonical.y)*w.dim,R=Math.floor(k),z=Math.floor(P);return(o?this.exaggeration():1)*$r($r(w.get(R,z),w.get(R,z+1),P-z),$r(w.get(R+1,z),w.get(R+1,z+1),P-z),k-R)}getAtTileOffset(e,i,o){const l=1<<e.canonical.z;return this.getAtPointOrZero(new Pn(e.wrap+(e.canonical.x+i/Et)/l,(e.canonical.y+o/Et)/l))}getAtTileOffsetFunc(e,i,o,l){return u=>{const h=this.getAtTileOffset(e,u.x,u.y),m=l.upVector(e.canonical,u.x,u.y),_=l.upVectorScale(e.canonical,i,o).metersToTile;return We.scale(m,m,h*_),m}}getForTilePoints(e,i,o,l){if(this.isUsingMockSource())return!1;const u=Jp.create(this,e,l);return!!u&&(i.forEach(h=>{h[2]=this.exaggeration()*u.getElevationAt(h[0],h[1],o)}),!0)}getMinMaxForTile(e){if(this.isUsingMockSource())return null;const i=this.findDEMTileFor(e);if(!i||!i.dem)return null;const o=i.dem.tree,l=i.tileID,u=1<<e.canonical.z-l.canonical.z;let h=e.canonical.x/u-l.canonical.x,m=e.canonical.y/u-l.canonical.y,_=0;for(let v=0;v<e.canonical.z-l.canonical.z&&!o.leaves[_];v++){h*=2,m*=2;const x=2*Math.floor(m)+Math.floor(h);_=o.childOffsets[_]+x,h%=1,m%=1}return{min:this.exaggeration()*o.minimums[_],max:this.exaggeration()*o.maximums[_]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(e,i,o){throw new Error("Pure virtual method called.")}pointCoordinate(e){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(e){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}}class Jp{constructor(e,i,o){this._demTile=e,this._dem=this._demTile.dem,this._scale=i,this._offset=o}static create(e,i,o){const l=o||e.findDEMTileFor(i);if(!l||!l.dem)return;const u=l.dem,h=l.tileID,m=1<<i.canonical.z-h.canonical.z;return new Jp(l,u.dim/Et/m,[(i.canonical.x/m-h.canonical.x)*u.dim,(i.canonical.y/m-h.canonical.y)*u.dim])}tileCoordToPixel(e,i){const o=i*this._scale+this._offset[1],l=Math.floor(e*this._scale+this._offset[0]),u=Math.floor(o);return new D(l,u)}getElevationAt(e,i,o,l){const u=e*this._scale+this._offset[0],h=i*this._scale+this._offset[1],m=Math.floor(u),_=Math.floor(h),v=this._dem;return l=!!l,o?$r($r(v.get(m,_,l),v.get(m,_+1,l),h-_),$r(v.get(m+1,_,l),v.get(m+1,_+1,l),h-_),u-m):v.get(m,_,l)}getElevationAtPixel(e,i,o){return this._dem.get(e,i,!!o)}getMeterToDEM(e){return(1<<this._demTile.tileID.canonical.z)*fi(1,e)*this._dem.stride}}class CE{constructor(e,i){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new Dp(Et,16,0),this.featureIndexArray=new x4,this.promoteId=i}insert(e,i,o,l,u,h=0){const m=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(o,l,u,h);const _=this.grid;for(let v=0;v<i.length;v++){const x=i[v],w=[1/0,1/0,-1/0,-1/0];for(let C=0;C<x.length;C++){const k=x[C];w[0]=Math.min(w[0],k.x),w[1]=Math.min(w[1],k.y),w[2]=Math.max(w[2],k.x),w[3]=Math.max(w[3],k.y)}w[0]<Et&&w[1]<Et&&w[2]>=0&&w[3]>=0&&_.insert(m,w[0],w[1],w[2],w[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new wE(new L1(this.rawTileData)).layers,this.sourceLayerCoder=new MM(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const e in this.vtLayers)this.vtFeatures[e]=[]}return this.vtLayers}query(e,i,o,l){this.loadVTLayers();const u=e.params||{},h=Kv(u.filter),m=e.tileResult,_=e.transform,v=m.bufferedTilespaceBounds,x=this.grid.query(v.min.x,v.min.y,v.max.x,v.max.y,(P,R,z,B)=>dM(m.bufferedTilespaceGeometry,P,R,z,B));x.sort(tW);let w=null;_.elevation&&x.length>0&&(w=Jp.create(_.elevation,this.tileID));const C={};let k;for(let P=0;P<x.length;P++){const R=x[P];if(R===k)continue;k=R;const z=this.featureIndexArray.get(R);let B=null;this.loadMatchingFeature(C,z,h,u.layers,u.availableImages,i,o,l,(H,Z,Y,q=0)=>(B||(B=Bc(H,this.tileID.canonical,e.tileTransform)),Z.queryIntersectsFeature(m,H,Y,B,this.z,e.transform,e.pixelPosMatrix,w,q)))}return C}loadMatchingFeature(e,i,o,l,u,h,m,_,v){const{featureIndex:x,bucketIndex:w,sourceLayerIndex:C,layoutVertexArrayOffset:k}=i,P=this.bucketLayerIDs[w];if(l&&!function(H,Z){for(let Y=0;Y<H.length;Y++)if(Z.indexOf(H[Y])>=0)return!0;return!1}(l,P))return;const R=this.sourceLayerCoder.decode(C),z=this.vtLayers[R].feature(x);if(o.needGeometry){const H=$f(z,!0);if(!o.filter(new Gi(this.tileID.overscaledZ),H,this.tileID.canonical))return}else if(!o.filter(new Gi(this.tileID.overscaledZ),z))return;const B=this.getId(z,R);for(let H=0;H<P.length;H++){const Z=P[H];if(l&&l.indexOf(Z)<0)continue;const Y=h[Z];if(!Y)continue;let q={};B!==void 0&&_&&(q=_.getState(Y.sourceLayer||"_geojsonTileLayer",B));const ee=ze({},m[Z]);ee.paint=HM(ee.paint,Y.paint,z,q,u),ee.layout=HM(ee.layout,Y.layout,z,q,u);const ce=!v||v(z,Y,q,k);if(!ce)continue;const de=new DM(z,this.z,this.x,this.y,B);de.layer=ee;let ge=e[Z];ge===void 0&&(ge=e[Z]=[]),ge.push({featureIndex:x,feature:de,intersectionZ:ce})}}lookupSymbolFeatures(e,i,o,l,u,h,m,_){const v={};this.loadVTLayers();const x=Kv(u);for(const w of e)this.loadMatchingFeature(v,{bucketIndex:o,sourceLayerIndex:l,featureIndex:w,layoutVertexArrayOffset:0},x,h,m,_,i);return v}loadFeature(e){const{featureIndex:i,sourceLayerIndex:o}=e;this.loadVTLayers();const l=this.sourceLayerCoder.decode(o),u=this.vtFeatures[l];if(u[i])return u[i];const h=this.vtLayers[l].feature(i);return u[i]=h,h}hasLayer(e){for(const i of this.bucketLayerIDs)for(const o of i)if(e===o)return!0;return!1}getId(e,i){let o=e.id;if(this.promoteId){const l=typeof this.promoteId=="string"?this.promoteId:this.promoteId[i];l!=null&&(o=e.properties[l]),typeof o=="boolean"&&(o=Number(o))}return o}}function HM(r,e,i,o,l){return Ce(r,(u,h)=>{const m=e instanceof Hm?e.get(h):null;return m&&m.evaluate?m.evaluate(i,o,l):m})}function tW(r,e){return e-r}xr(CE,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});const rW=Zn([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),nW=Zn([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),iW=Zn([{name:"a_projected_pos",components:4,type:"Float32"}],4);Zn([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const aW=Zn([{name:"a_z_offset",components:1,type:"Float32"}],4),oW=Zn([{name:"a_texb",components:2,type:"Uint16"}]),sW=Zn([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),lW=Zn([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"}]);Zn([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const GM=Zn([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),cW=Zn([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);Zn([{name:"triangle",components:3,type:"Uint16"}]),Zn([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),Zn([{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Float32",name:"zOffset"},{type:"Uint8",name:"hasIconTextFit"}]),Zn([{type:"Float32",name:"offsetX"}]),Zn([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var Ua=24;const Xl=128;function AE(r,e){const{expression:i}=e;if(i.kind==="constant")return{kind:"constant",layoutSize:i.evaluate(new Gi(r+1))};if(i.kind==="source")return{kind:"source"};{const{zoomStops:o,interpolationType:l}=i;let u=0;for(;u<o.length&&o[u]<=r;)u++;u=Math.max(0,u-1);let h=u;for(;h<o.length&&o[h]<r+1;)h++;h=Math.min(o.length-1,h);const m=o[u],_=o[h];return i.kind==="composite"?{kind:"composite",minZoom:m,maxZoom:_,interpolationType:l}:{kind:"camera",minZoom:m,maxZoom:_,minSize:i.evaluate(new Gi(m)),maxSize:i.evaluate(new Gi(_)),interpolationType:l}}}function og(r,{uSize:e,uSizeT:i},{lowerSize:o,upperSize:l}){return r.kind==="source"?o/Xl:r.kind==="composite"?$r(o/Xl,l/Xl,i):e}function zc(r,e){let i=0,o=0;if(r.kind==="constant")o=r.layoutSize;else if(r.kind!=="source"){const{interpolationType:l,minZoom:u,maxZoom:h}=r,m=l?Oe(Pc.interpolationFactor(l,e,u,h),0,1):0;r.kind==="camera"?o=$r(r.minSize,r.maxSize,m):i=m}return{uSizeT:i,uSize:o}}var uW=Object.freeze({__proto__:null,SIZE_PACK_FACTOR:Xl,evaluateSizeForFeature:og,evaluateSizeForZoom:zc,getSizeData:AE});function fW(r,e,i){return r.sections.forEach(o=>{o.text=function(l,u,h){const m=u.layout.get("text-transform").evaluate(h,{});return m==="uppercase"?l=l.toLocaleUpperCase():m==="lowercase"&&(l=l.toLocaleLowerCase()),pl.applyArabicShaping&&(l=pl.applyArabicShaping(l)),l}(o.text,e,i)}),r}const sg={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂","←":"↑","→":"↓"};function hW(r){return r==="︶"||r==="﹈"||r==="︸"||r==="﹄"||r==="﹂"||r==="︾"||r==="︼"||r==="︺"||r==="︘"||r==="﹀"||r==="︐"||r==="︓"||r==="︔"||r==="｀"||r==="￣"||r==="︑"||r==="︒"}function dW(r){return r==="︵"||r==="﹇"||r==="︷"||r==="﹃"||r==="﹁"||r==="︽"||r==="︻"||r==="︹"||r==="︗"||r==="︿"}const kE=3;function pW(r,e,i){e.glyphs=[],r===1&&i.readMessage(mW,e)}function mW(r,e,i){if(r===3){const{id:o,bitmap:l,width:u,height:h,left:m,top:_,advance:v}=i.readMessage(gW,{});e.glyphs.push({id:o,bitmap:new Mu({width:u+2*kE,height:h+2*kE},l),metrics:{width:u,height:h,left:m,top:_,advance:v}})}else r===4?e.ascender=i.readSVarint():r===5&&(e.descender=i.readSVarint())}function gW(r,e,i){r===1?e.id=i.readVarint():r===2?e.bitmap=i.readBytes():r===3?e.width=i.readVarint():r===4?e.height=i.readVarint():r===5?e.left=i.readSVarint():r===6?e.top=i.readSVarint():r===7&&(e.advance=i.readVarint())}const qM=kE;function IE(r){let e=0,i=0;for(const h of r)e+=h.w*h.h,i=Math.max(i,h.w);r.sort((h,m)=>m.h-h.h);const o=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),i),h:1/0}];let l=0,u=0;for(const h of r)for(let m=o.length-1;m>=0;m--){const _=o[m];if(!(h.w>_.w||h.h>_.h)){if(h.x=_.x,h.y=_.y,u=Math.max(u,h.y+h.h),l=Math.max(l,h.x+h.w),h.w===_.w&&h.h===_.h){const v=o.pop();m<o.length&&(o[m]=v)}else h.h===_.h?(_.x+=h.w,_.w-=h.w):h.w===_.w?(_.y+=h.h,_.h-=h.h):(o.push({x:_.x+h.w,y:_.y,w:_.w-h.w,h:h.h}),_.y+=h.h,_.h-=h.h);break}}return{w:l,h:u,fill:e/(l*u)||0}}const is=1;class ME{constructor(e,{pixelRatio:i,version:o,stretchX:l,stretchY:u,content:h}){this.paddedRect=e,this.pixelRatio=i,this.stretchX=l,this.stretchY=u,this.content=h,this.version=o}get tl(){return[this.paddedRect.x+is,this.paddedRect.y+is]}get br(){return[this.paddedRect.x+this.paddedRect.w-is,this.paddedRect.y+this.paddedRect.h-is]}get displaySize(){return[(this.paddedRect.w-2*is)/this.pixelRatio,(this.paddedRect.h-2*is)/this.pixelRatio]}}class XM{constructor(e,i){const o={},l={};this.haveRenderCallbacks=[];const u=[];this.addImages(e,o,u),this.addImages(i,l,u);const{w:h,h:m}=IE(u),_=new da({width:h||1,height:m||1});for(const v in e){const x=e[v],w=o[v].paddedRect;da.copy(x.data,_,{x:0,y:0},{x:w.x+is,y:w.y+is},x.data)}for(const v in i){const x=i[v],w=l[v].paddedRect,C=w.x+is,k=w.y+is,P=x.data.width,R=x.data.height;da.copy(x.data,_,{x:0,y:0},{x:C,y:k},x.data),da.copy(x.data,_,{x:0,y:R-1},{x:C,y:k-1},{width:P,height:1}),da.copy(x.data,_,{x:0,y:0},{x:C,y:k+R},{width:P,height:1}),da.copy(x.data,_,{x:P-1,y:0},{x:C-1,y:k},{width:1,height:R}),da.copy(x.data,_,{x:0,y:0},{x:C+P,y:k},{width:1,height:R})}this.image=_,this.iconPositions=o,this.patternPositions=l}addImages(e,i,o){for(const l in e){const u=e[l],h={x:0,y:0,w:u.data.width+2*is,h:u.data.height+2*is};o.push(h),i[l]=new ME(h,u),u.hasRenderCallback&&this.haveRenderCallbacks.push(l)}}patchUpdatedImages(e,i,o){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(l=>e.hasImage(l,o)),e.dispatchRenderCallbacks(this.haveRenderCallbacks,o);for(const l in e.getUpdatedImages(o))this.patchUpdatedImage(this.iconPositions[l],e.getImage(l,o),i),this.patchUpdatedImage(this.patternPositions[l],e.getImage(l,o),i)}patchUpdatedImage(e,i,o){if(!e||!i||e.version===i.version)return;e.version=i.version;const[l,u]=e.tl;o.update(i.data,void 0,{x:l,y:u})}}xr(ME,"ImagePosition"),xr(XM,"ImageAtlas");const zi={horizontal:1,vertical:2,horizontalOnly:3},ZM=-17;class lg{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(e,i){const o=new lg;return o.scale=e||1,o.fontStack=i,o}static forImage(e){const i=new lg;return i.imageName=e,i}}class Qp{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(e,i){const o=new Qp;for(let l=0;l<e.sections.length;l++){const u=e.sections[l];u.image?o.addImageSection(u):o.addTextSection(u,i)}return o}length(){return this.text.length}getSection(e){return this.sections[this.sectionIndex[e]]}getSections(){return this.sections}getSectionIndex(e){return this.sectionIndex[e]}getCodePoint(e){return this.text.codePointAt(e)}verticalizePunctuation(e){this.text=function(i,o){let l="";for(let u=0;u<i.length;u++){const h=i.charCodeAt(u+1)||null,m=i.charCodeAt(u-1)||null;l+=!o&&(h&&i4(h)&&!sg[i[u+1]]||m&&i4(m)&&!sg[i[u-1]])||!sg[i[u]]?i[u]:sg[i[u]]}return l}(this.text,e)}trim(){let e=0;for(let o=0;o<this.text.length&&D1[this.text.charCodeAt(o)];o++)e++;let i=this.text.length;for(let o=this.text.length-1;o>=0&&o>=e&&D1[this.text.charCodeAt(o)];o--)i--;this.text=this.text.substring(e,i),this.sectionIndex=this.sectionIndex.slice(e,i)}substring(e,i){const o=new Qp;return o.text=this.text.substring(e,i),o.sectionIndex=this.sectionIndex.slice(e,i),o.sections=this.sections,o}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((e,i)=>Math.max(e,this.sections[i].scale),0)}addTextSection(e,i){this.text+=e.text,this.sections.push(lg.forText(e.scale,e.fontStack||i));const o=this.sections.length-1;for(let l=0;l<e.text.length;++l)this.sectionIndex.push(o)}addImageSection(e){const i=e.image?e.image.namePrimary:"";if(i.length===0)return void se("Can't add FormattedSection with an empty image.");const o=this.getNextImageSectionCharCode();o?(this.text+=String.fromCodePoint(o),this.sections.push(lg.forImage(i)),this.sectionIndex.push(this.sections.length-1)):se("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function FE(r,e,i,o,l,u,h,m,_,v,x,w,C,k,P){const R=Qp.fromFeature(r,l);w===zi.vertical&&R.verticalizePunctuation(C);let z=[];const B=function(ee,ce,de,ge,ve,Re){if(!ee)return[];const ke=[],$e=function(ft,Je,tt,pt,bt,St){let Pt=0;for(let Ut=0;Ut<ft.length();Ut++){const Tt=ft.getSection(Ut);Pt+=KM(ft.getCodePoint(Ut),Tt,pt,bt,Je,St)}return Pt/Math.max(1,Math.ceil(Pt/tt))}(ee,ce,de,ge,ve,Re),Ie=ee.text.indexOf("​")>=0;let Qe=0;for(let ft=0;ft<ee.length();ft++){const Je=ee.getSection(ft),tt=ee.getCodePoint(ft);if(D1[tt]||(Qe+=KM(tt,Je,ge,ve,ce,Re)),ft<ee.length()-1){const pt=!((st=tt)<11904||!(Ar["Bopomofo Extended"](st)||Ar.Bopomofo(st)||Ar["CJK Compatibility Forms"](st)||Ar["CJK Compatibility Ideographs"](st)||Ar["CJK Compatibility"](st)||Ar["CJK Radicals Supplement"](st)||Ar["CJK Strokes"](st)||Ar["CJK Symbols and Punctuation"](st)||Ar["CJK Unified Ideographs Extension A"](st)||Ar["CJK Unified Ideographs"](st)||Ar["Enclosed CJK Letters and Months"](st)||Ar["Halfwidth and Fullwidth Forms"](st)||Ar.Hiragana(st)||Ar["Ideographic Description Characters"](st)||Ar["Kangxi Radicals"](st)||Ar["Katakana Phonetic Extensions"](st)||Ar.Katakana(st)||Ar["Vertical Forms"](st)||Ar["Yi Radicals"](st)||Ar["Yi Syllables"](st)));(_W[tt]||pt||Je.imageName)&&ke.push(JM(ft+1,Qe,$e,ke,vW(tt,ee.getCodePoint(ft+1),pt&&Ie),!1))}}var st;return QM(JM(ee.length(),Qe,$e,ke,0,!0))}(R,v,u,e,o,k),{processBidirectionalText:H,processStyledBidirectionalText:Z}=pl;if(H&&R.sections.length===1){const ee=H(R.toString(),B);for(const ce of ee){const de=new Qp;de.text=ce,de.sections=R.sections;for(let ge=0;ge<ce.length;ge++)de.sectionIndex.push(0);z.push(de)}}else if(Z){const ee=Z(R.text,R.sectionIndex,B);for(const ce of ee){const de=new Qp;de.text=ce[0],de.sectionIndex=ce[1],de.sections=R.sections,z.push(de)}}else z=function(ee,ce){const de=[],ge=ee.text;let ve=0;for(const Re of ce)de.push(ee.substring(ve,Re)),ve=Re;return ve<ge.length&&de.push(ee.substring(ve,ge.length)),de}(R,B);const Y=[],q={positionedLines:Y,text:R.toString(),top:x[1],bottom:x[1],left:x[0],right:x[0],writingMode:w,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(ee,ce,de,ge,ve,Re,ke,$e,Ie,Qe,st,ft){let Je=0,tt=0,pt=0;const bt=$e==="right"?1:$e==="left"?0:.5;let St=!1;for(const ur of ve){const cr=ur.getSections();for(const hr of cr){if(hr.imageName)continue;const Mr=ce[hr.fontStack];if(Mr&&(St=Mr.ascender!==void 0&&Mr.descender!==void 0,!St))break}if(!St)break}let Pt=0;for(const ur of ve){ur.trim();const cr=ur.getMaxScale(),hr=(cr-1)*Ua,Mr={positionedGlyphs:[],lineOffset:0};ee.positionedLines[Pt]=Mr;const jr=Mr.positionedGlyphs;let gn=0;if(!ur.length()){tt+=Re,++Pt;continue}let Bn=0,on=0;for(let Vr=0;Vr<ur.length();Vr++){const Dr=ur.getSection(Vr),In=ur.getSectionIndex(Vr),Un=ur.getCodePoint(Vr);let dn=Dr.scale,gi=null,Ni=null,Ii=null,Ti=Ua,ba=0;const Ui=!(Ie===zi.horizontal||!st&&!s2(Un)||st&&(D1[Un]||(Ut=Un,Ar.Arabic(Ut)||Ar["Arabic Supplement"](Ut)||Ar["Arabic Extended-A"](Ut)||Ar["Arabic Presentation Forms-A"](Ut)||Ar["Arabic Presentation Forms-B"](Ut))));if(Dr.imageName){const ra=ge[Dr.imageName];if(!ra)continue;Ii=Dr.imageName,ee.iconsInText=ee.iconsInText||!0,Ni=ra.paddedRect;const _i=ra.displaySize;dn=dn*Ua/ft,gi={width:_i[0],height:_i[1],left:is,top:-qM,advance:Ui?_i[1]:_i[0],localGlyph:!1},ba=St?-gi.height*dn:ZM+cr*Ua-_i[1]*dn,Ti=gi.advance;const Po=(Ui?_i[0]:_i[1])*dn-Ua*cr;Po>0&&Po>gn&&(gn=Po)}else{const ra=de[Dr.fontStack];if(!ra)continue;ra[Un]&&(Ni=ra[Un]);const _i=ce[Dr.fontStack];if(!_i)continue;const Po=_i.glyphs[Un];if(!Po)continue;if(gi=Po.metrics,Ti=Un!==8203?Ua:0,St){const Hc=_i.ascender!==void 0?Math.abs(_i.ascender):0,Ou=_i.descender!==void 0?Math.abs(_i.descender):0,Ru=(Hc+Ou)*dn;Bn<Ru&&(Bn=Ru,on=(Hc-Ou)/2*dn),ba=-Hc*dn}else ba=ZM+(cr-dn)*Ua}Ui?(ee.verticalizable=!0,jr.push({glyph:Un,imageName:Ii,x:Je,y:tt+ba,vertical:Ui,scale:dn,localGlyph:gi.localGlyph,fontStack:Dr.fontStack,sectionIndex:In,metrics:gi,rect:Ni}),Je+=Ti*dn+Qe):(jr.push({glyph:Un,imageName:Ii,x:Je,y:tt+ba,vertical:Ui,scale:dn,localGlyph:gi.localGlyph,fontStack:Dr.fontStack,sectionIndex:In,metrics:gi,rect:Ni}),Je+=gi.advance*dn+Qe)}jr.length!==0&&(pt=Math.max(Je-Qe,pt),St?eF(jr,bt,gn,on,Re*cr/2):eF(jr,bt,gn,0,Re/2)),Je=0;const Qr=Re*cr+gn;Mr.lineOffset=Math.max(gn,hr),tt+=Qr,++Pt}var Ut;const Tt=tt,{horizontalAlign:Mt,verticalAlign:tr}=B1(ke);(function(ur,cr,hr,Mr,jr,gn){const Bn=(cr-hr)*jr,on=-gn*Mr;for(const Qr of ur)for(const Vr of Qr.positionedGlyphs)Vr.x+=Bn,Vr.y+=on})(ee.positionedLines,bt,Mt,tr,pt,Tt),ee.top+=-tr*Tt,ee.bottom=ee.top+Tt,ee.left+=-Mt*pt,ee.right=ee.left+pt,ee.hasBaseline=St}(q,e,i,o,z,h,m,_,w,v,C,P),!function(ee){for(const ce of ee)if(ce.positionedGlyphs.length!==0)return!1;return!0}(Y)&&q}const D1={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},_W={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function KM(r,e,i,o,l,u){if(e.imageName){const h=o[e.imageName];return h?h.displaySize[0]*e.scale*Ua/u+l:0}{const h=i[e.fontStack],m=h&&h.glyphs[r];return m?m.metrics.advance*e.scale+l:0}}function YM(r,e,i,o){const l=Math.pow(r-e,2);return o?r<e?l/2:2*l:l+Math.abs(i)*i}function vW(r,e,i){let o=0;return r===10&&(o-=1e4),i&&(o+=150),r!==40&&r!==65288||(o+=50),e!==41&&e!==65289||(o+=50),o}function JM(r,e,i,o,l,u){let h=null,m=YM(e,i,l,u);for(const _ of o){const v=YM(e-_.x,i,l,u)+_.badness;v<=m&&(h=_,m=v)}return{index:r,x:e,priorBreak:h,badness:m}}function QM(r){return r?QM(r.priorBreak).concat(r.index):[]}function B1(r){let e=.5,i=.5;switch(r){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0}switch(r){case"bottom":case"bottom-right":case"bottom-left":i=1;break;case"top":case"top-right":case"top-left":i=0}return{horizontalAlign:e,verticalAlign:i}}function eF(r,e,i,o,l){if(!(e||i||o||l))return;const u=r.length-1,h=r[u],m=(h.x+h.metrics.advance*h.scale)*e;for(let _=0;_<=u;_++)r[_].x-=m,r[_].y+=i+o+l}function yW(r,e,i,o){const{horizontalAlign:l,verticalAlign:u}=B1(o),h=i[0]-r.displaySize[0]*l,m=i[1]-r.displaySize[1]*u;return{imagePrimary:r,imageSecondary:e,top:m,bottom:m+r.displaySize[1],left:h,right:h+r.displaySize[0]}}function tF(r,e,i,o,l,u){const h=r.imagePrimary;let m;if(h.content){const z=h.content,B=h.pixelRatio||1;m=[z[0]/B,z[1]/B,h.displaySize[0]-z[2]/B,h.displaySize[1]-z[3]/B]}const _=e.left*u,v=e.right*u;let x,w,C,k;i==="width"||i==="both"?(k=l[0]+_-o[3],w=l[0]+v+o[1]):(k=l[0]+(_+v-h.displaySize[0])/2,w=k+h.displaySize[0]);const P=e.top*u,R=e.bottom*u;return i==="height"||i==="both"?(x=l[1]+P-o[0],C=l[1]+R+o[2]):(x=l[1]+(P+R-h.displaySize[1])/2,C=x+h.displaySize[1]),{imagePrimary:h,imageSecondary:void 0,top:x,right:w,bottom:C,left:k,collisionPadding:m}}class Pu extends D{constructor(e,i,o,l,u){super(e,i),this.angle=l,this.z=o,u!==void 0&&(this.segment=u)}clone(){return new Pu(this.x,this.y,this.z,this.angle,this.segment)}}function rF(r,e,i,o,l){if(e.segment===void 0)return!0;let u=e,h=e.segment+1,m=0;for(;m>-i/2;){if(h--,h<0)return!1;m-=r[h].dist(u),u=r[h]}m+=r[h].dist(r[h+1]),h++;const _=[];let v=0;for(;m<i/2;){const x=r[h],w=r[h+1];if(!w)return!1;let C=r[h-1].angleTo(x)-x.angleTo(w);for(C=Math.abs((C+3*Math.PI)%(2*Math.PI)-Math.PI),_.push({distance:m,angleDelta:C}),v+=C;m-_[0].distance>o;)v-=_.shift().angleDelta;if(v>l)return!1;h++,m+=x.dist(w)}return!0}function nF(r){let e=0;for(let i=0;i<r.length-1;i++)e+=r[i].dist(r[i+1]);return e}function iF(r,e,i){return r?.6*e*i:0}function aF(r,e){return Math.max(r?r.right-r.left:0,e?e.right-e.left:0)}function xW(r,e,i,o,l,u){const h=iF(i,l,u),m=aF(i,o)*u;let _=0;const v=nF(r)/2;for(let x=0;x<r.length-1;x++){const w=r[x],C=r[x+1],k=w.dist(C);if(_+k>v){const P=(v-_)/k,R=$r(w.x,C.x,P),z=$r(w.y,C.y,P),B=new Pu(R,z,0,C.angleTo(w),x);return!h||rF(r,B,m,h,e)?B:void 0}_+=k}}function bW(r,e,i,o,l,u,h,m,_){const v=iF(o,u,h),x=aF(o,l),w=x*h,C=r[0].x===0||r[0].x===_||r[0].y===0||r[0].y===_;return e-w<e/4&&(e=w+e/4),oF(r,C?e/2*m%e:(x/2+2*u)*h*m%e,e,v,i,w,C,!1,_)}function oF(r,e,i,o,l,u,h,m,_){const v=u/2,x=nF(r);let w=0,C=e-i,k=[];for(let P=0;P<r.length-1;P++){const R=r[P],z=r[P+1],B=R.dist(z),H=z.angleTo(R);for(;C+i<w+B;){C+=i;const Z=(C-w)/B,Y=$r(R.x,z.x,Z),q=$r(R.y,z.y,Z);if(Y>=0&&Y<_&&q>=0&&q<_&&C-v>=0&&C+v<=x){const ee=new Pu(Y,q,0,H,P);o&&!rF(r,ee,u,o,l)||k.push(ee)}}w+=B}return m||k.length||h||(k=oF(r,w/2,i,o,l,u,h,!0,_)),k}function sF(r,e,i,o,l){const u=[];for(let h=0;h<r.length;h++){const m=r[h];let _;for(let v=0;v<m.length-1;v++){let x=m[v],w=m[v+1];x.x<e&&w.x<e||(x.x<e?x=new D(e,x.y+(e-x.x)/(w.x-x.x)*(w.y-x.y))._round():w.x<e&&(w=new D(e,x.y+(e-x.x)/(w.x-x.x)*(w.y-x.y))._round()),x.y<i&&w.y<i||(x.y<i?x=new D(x.x+(i-x.y)/(w.y-x.y)*(w.x-x.x),i)._round():w.y<i&&(w=new D(x.x+(i-x.y)/(w.y-x.y)*(w.x-x.x),i)._round()),x.x>=o&&w.x>=o||(x.x>=o?x=new D(o,x.y+(o-x.x)/(w.x-x.x)*(w.y-x.y))._round():w.x>=o&&(w=new D(o,x.y+(o-x.x)/(w.x-x.x)*(w.y-x.y))._round()),x.y>=l&&w.y>=l||(x.y>=l?x=new D(x.x+(l-x.y)/(w.y-x.y)*(w.x-x.x),l)._round():w.y>=l&&(w=new D(x.x+(l-x.y)/(w.y-x.y)*(w.x-x.x),l)._round()),_&&x.equals(_[_.length-1])||(_=[x],u.push(_)),_.push(w)))))}}return u}xr(Pu,"Anchor");const cg=1e20;function lF(r,e,i,o,l,u,h,m,_){for(let v=e;v<e+o;v++)cF(r,i*u+v,u,l,h,m,_);for(let v=i;v<i+l;v++)cF(r,v*u+e,1,o,h,m,_)}function cF(r,e,i,o,l,u,h){u[0]=0,h[0]=-cg,h[1]=cg,l[0]=r[e];for(let m=1,_=0,v=0;m<o;m++){l[m]=r[e+m*i];const x=m*m;do{const w=u[_];v=(l[m]-l[w]+x-w*w)/(m-w)/2}while(v<=h[_]&&--_>-1);_++,u[_]=m,h[_]=v,h[_+1]=cg}for(let m=0,_=0;m<o;m++){for(;h[_+1]<m;)_++;const v=u[_],x=m-v;r[e+m*i]=l[v]+x*x}}const Zl=2;class e0{constructor(e,i,o){this.requestManager=e,this.localGlyphMode=i,this.localFontFamily=o,this.urls={},this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(e,i){this.urls[i]=e}getGlyphs(e,i,o){const l=[],u=this.urls[i]||E.GLYPHS_URL;for(const h in e)for(const m of e[h])l.push({stack:h,id:m});et(l,({stack:h,id:m},_)=>{let v=this.entries[h];v||(v=this.entries[h]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let x=v.glyphs[m];if(x!==void 0)return void _(null,{stack:h,id:m,glyph:x});if(x=this._tinySDF(v,h,m),x)return v.glyphs[m]=x,void _(null,{stack:h,id:m,glyph:x});const w=Math.floor(m/256);if(256*w>65535)return void _(new Error("glyphs > 65535 not supported"));if(v.ranges[w])return void _(null,{stack:h,id:m,glyph:x});let C=v.requests[w];C||(C=v.requests[w]=[],e0.loadGlyphRange(h,w,u,this.requestManager,(k,P)=>{if(P){v.ascender=P.ascender,v.descender=P.descender;for(const R in P.glyphs)this._doesCharSupportLocalGlyph(+R)||(v.glyphs[+R]=P.glyphs[+R]);v.ranges[w]=!0}for(const R of C)R(k,P);delete v.requests[w]})),C.push((k,P)=>{k?_(k):P&&_(null,{stack:h,id:m,glyph:P.glyphs[m]||null})})},(h,m)=>{if(h)o(h);else if(m){const _={};for(const{stack:v,id:x,glyph:w}of m)_[v]===void 0&&(_[v]={}),_[v].glyphs===void 0&&(_[v].glyphs={}),_[v].glyphs[x]=w&&{id:w.id,bitmap:w.bitmap.clone(),metrics:w.metrics},_[v].ascender=this.entries[v].ascender,_[v].descender=this.entries[v].descender;o(null,_)}})}_doesCharSupportLocalGlyph(e){return this.localGlyphMode!==0&&(this.localGlyphMode===2?!!this.localFontFamily:!!this.localFontFamily&&(Ar["CJK Unified Ideographs"](e)||Ar["Hangul Syllables"](e)||Ar.Hiragana(e)||Ar.Katakana(e)||Ar["CJK Symbols and Punctuation"](e)||Ar["CJK Unified Ideographs Extension A"](e)||Ar["CJK Unified Ideographs Extension B"](e)))}_tinySDF(e,i,o){const l=this.localFontFamily;if(!l||!this._doesCharSupportLocalGlyph(o))return;let u=e.tinySDF;if(!u){let R="400";/bold/i.test(i)?R="900":/medium/i.test(i)?R="500":/light/i.test(i)&&(R="200"),u=e.tinySDF=new e0.TinySDF({fontFamily:l,fontWeight:R,fontSize:24*Zl,buffer:3*Zl,radius:8*Zl}),u.fontWeight=R}if(this.localGlyphs[u.fontWeight][o])return this.localGlyphs[u.fontWeight][o];const h=String.fromCodePoint(o),{data:m,width:_,height:v,glyphWidth:x,glyphHeight:w,glyphLeft:C,glyphTop:k,glyphAdvance:P}=u.draw(h);return this.localGlyphs[u.fontWeight][o]={id:o,bitmap:new Mu({width:_,height:v},m),metrics:{width:x/Zl,height:w/Zl,left:C/Zl,top:k/Zl-27,advance:P/Zl,localGlyph:!0}}}}e0.loadGlyphRange=function(r,e,i,o,l){const u=256*e,h=u+255,m=o.transformRequest(o.normalizeGlyphsURL(i).replace("{fontstack}",r).replace("{range}",`${u}-${h}`),Le.Glyphs);qt(m,(_,v)=>{if(_)l(_);else if(v){const x={},w=function(C){return new L1(C).readFields(pW,{})}(v);for(const C of w.glyphs)x[C.id]=C;l(null,{glyphs:x,ascender:w.ascender,descender:w.descender})}})},e0.TinySDF=class{constructor({fontSize:r=24,buffer:e=3,radius:i=8,cutoff:o=.25,fontFamily:l="sans-serif",fontWeight:u="normal",fontStyle:h="normal"}={}){this.buffer=e,this.cutoff=o,this.radius=i;const m=this.size=r+4*e,_=this._createCanvas(m),v=this.ctx=_.getContext("2d",{willReadFrequently:!0});v.font=`${h} ${u} ${r}px ${l}`,v.textBaseline="alphabetic",v.textAlign="left",v.fillStyle="black",this.gridOuter=new Float64Array(m*m),this.gridInner=new Float64Array(m*m),this.f=new Float64Array(m),this.z=new Float64Array(m+1),this.v=new Uint16Array(m)}_createCanvas(r){const e=document.createElement("canvas");return e.width=e.height=r,e}draw(r){const{width:e,actualBoundingBoxAscent:i,actualBoundingBoxDescent:o,actualBoundingBoxLeft:l,actualBoundingBoxRight:u}=this.ctx.measureText(r),h=Math.ceil(i),m=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(u-l))),_=Math.min(this.size-this.buffer,h+Math.ceil(o)),v=m+2*this.buffer,x=_+2*this.buffer,w=Math.max(v*x,0),C=new Uint8ClampedArray(w),k={data:C,width:v,height:x,glyphWidth:m,glyphHeight:_,glyphTop:h,glyphLeft:0,glyphAdvance:e};if(m===0||_===0)return k;const{ctx:P,buffer:R,gridInner:z,gridOuter:B}=this;P.clearRect(R,R,m,_),P.fillText(r,R,R+h);const H=P.getImageData(R,R,m,_);B.fill(cg,0,w),z.fill(0,0,w);for(let Z=0;Z<_;Z++)for(let Y=0;Y<m;Y++){const q=H.data[4*(Z*m+Y)+3]/255;if(q===0)continue;const ee=(Z+R)*v+Y+R;if(q===1)B[ee]=0,z[ee]=cg;else{const ce=.5-q;B[ee]=ce>0?ce*ce:0,z[ee]=ce<0?ce*ce:0}}lF(B,0,0,v,x,v,this.f,this.v,this.z),lF(z,R,R,m,_,v,this.f,this.v,this.z);for(let Z=0;Z<w;Z++){const Y=Math.sqrt(B[Z])-Math.sqrt(z[Z]);C[Z]=Math.round(255-255*(Y/this.radius+this.cutoff))}return k}};const Wf=is;function uF(r,e,i,o){const l=[],u=r.imagePrimary,h=u.pixelRatio,m=u.paddedRect.w-2*Wf,_=u.paddedRect.h-2*Wf,v=r.right-r.left,x=r.bottom-r.top,w=u.stretchX||[[0,m]],C=u.stretchY||[[0,_]],k=(Re,ke)=>Re+ke[1]-ke[0],P=w.reduce(k,0),R=C.reduce(k,0),z=m-P,B=_-R;let H=0,Z=P,Y=0,q=R,ee=0,ce=z,de=0,ge=B;if(u.content&&o){const Re=u.content;H=z1(w,0,Re[0]),Y=z1(C,0,Re[1]),Z=z1(w,Re[0],Re[2]),q=z1(C,Re[1],Re[3]),ee=Re[0]-H,de=Re[1]-Y,ce=Re[2]-Re[0]-Z,ge=Re[3]-Re[1]-q}const ve=(Re,ke,$e,Ie)=>{const Qe=N1(Re.stretch-H,Z,v,r.left),st=U1(Re.fixed-ee,ce,Re.stretch,P),ft=N1(ke.stretch-Y,q,x,r.top),Je=U1(ke.fixed-de,ge,ke.stretch,R),tt=N1($e.stretch-H,Z,v,r.left),pt=U1($e.fixed-ee,ce,$e.stretch,P),bt=N1(Ie.stretch-Y,q,x,r.top),St=U1(Ie.fixed-de,ge,Ie.stretch,R),Pt=new D(Qe,ft),Ut=new D(tt,ft),Tt=new D(tt,bt),Mt=new D(Qe,bt),tr=new D(st/h,Je/h),ur=new D(pt/h,St/h),cr=e*Math.PI/180;if(cr){const on=Math.sin(cr),Qr=Math.cos(cr),Vr=[Qr,-on,on,Qr];Pt._matMult(Vr),Ut._matMult(Vr),Mt._matMult(Vr),Tt._matMult(Vr)}const hr=Re.stretch+Re.fixed,Mr=$e.stretch+$e.fixed,jr=ke.stretch+ke.fixed,gn=Ie.stretch+Ie.fixed,Bn=r.imageSecondary;return{tl:Pt,tr:Ut,bl:Mt,br:Tt,texPrimary:{x:u.paddedRect.x+Wf+hr,y:u.paddedRect.y+Wf+jr,w:Mr-hr,h:gn-jr},texSecondary:Bn?{x:Bn.paddedRect.x+Wf+hr,y:Bn.paddedRect.y+Wf+jr,w:Mr-hr,h:gn-jr}:void 0,writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:tr,pixelOffsetBR:ur,minFontScaleX:ce/h/v,minFontScaleY:ge/h/x,isSDF:i}};if(o&&(u.stretchX||u.stretchY)){const Re=fF(w,z,P),ke=fF(C,B,R);for(let $e=0;$e<Re.length-1;$e++){const Ie=Re[$e],Qe=Re[$e+1];for(let st=0;st<ke.length-1;st++)l.push(ve(Ie,ke[st],Qe,ke[st+1]))}}else l.push(ve({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:m+1},{fixed:0,stretch:_+1}));return l}function z1(r,e,i){let o=0;for(const l of r)o+=Math.max(e,Math.min(i,l[1]))-Math.max(e,Math.min(i,l[0]));return o}function fF(r,e,i){const o=[{fixed:-Wf,stretch:0}];for(const[l,u]of r){const h=o[o.length-1];o.push({fixed:l-h.stretch,stretch:h.stretch}),o.push({fixed:l-h.stretch,stretch:h.stretch+(u-l)})}return o.push({fixed:e+Wf,stretch:i}),o}function N1(r,e,i,o){return r/e*i+o}function U1(r,e,i,o){return r-e*i/o}function wW(r,e,i,o){const l=e+r.positionedLines[o].lineOffset;return o===0?i+l/2:i+(l+(e+r.positionedLines[o-1].lineOffset))/2}function EW(r,e=1,i=!1){let o=1/0,l=1/0,u=-1/0,h=-1/0;const m=r[0];for(let k=0;k<m.length;k++){const P=m[k];(!k||P.x<o)&&(o=P.x),(!k||P.y<l)&&(l=P.y),(!k||P.x>u)&&(u=P.x),(!k||P.y>h)&&(h=P.y)}const _=Math.min(u-o,h-l);let v=_/2;const x=new Cp([],TW);if(_===0)return new D(o,l);for(let k=o;k<u;k+=_)for(let P=l;P<h;P+=_)x.push(new t0(k+v,P+v,v,r));let w=function(k){let P=0,R=0,z=0;const B=k[0];for(let H=0,Z=B.length,Y=Z-1;H<Z;Y=H++){const q=B[H],ee=B[Y],ce=q.x*ee.y-ee.x*q.y;R+=(q.x+ee.x)*ce,z+=(q.y+ee.y)*ce,P+=3*ce}return new t0(R/P,z/P,0,k)}(r),C=x.length;for(;x.length;){const k=x.pop();(k.d>w.d||!w.d)&&(w=k,i&&console.log("found best %d after %d probes",Math.round(1e4*k.d)/1e4,C)),k.max-w.d<=e||(v=k.h/2,x.push(new t0(k.p.x-v,k.p.y-v,v,r)),x.push(new t0(k.p.x+v,k.p.y-v,v,r)),x.push(new t0(k.p.x-v,k.p.y+v,v,r)),x.push(new t0(k.p.x+v,k.p.y+v,v,r)),C+=4)}return i&&(console.log(`num probes: ${C}`),console.log(`best distance: ${w.d}`)),w.p}function TW(r,e){return e.max-r.max}class t0{constructor(e,i,o,l){this.p=new D(e,i),this.h=o,this.d=function(u,h){let m=!1,_=1/0;for(let v=0;v<h.length;v++){const x=h[v];for(let w=0,C=x.length,k=C-1;w<C;k=w++){const P=x[w],R=x[k];P.y>u.y!=R.y>u.y&&u.x<(R.x-P.x)*(u.y-P.y)/(R.y-P.y)+P.x&&(m=!m),_=Math.min(_,fM(u,P,R))}}return(m?1:-1)*Math.sqrt(_)}(this.p,l),this.max=this.d+this.h*Math.SQRT2}}const r0=7,PE=Number.POSITIVE_INFINITY,SW=Math.sqrt(2);function OE(r,[e,i]){let o=0,l=0;if(i===PE){e<0&&(e=0);const u=e/SW;switch(r){case"top-right":case"top-left":l=u-r0;break;case"bottom-right":case"bottom-left":l=-u+r0;break;case"bottom":l=-e+r0;break;case"top":l=e-r0}switch(r){case"top-right":case"bottom-right":o=-u;break;case"top-left":case"bottom-left":o=u;break;case"left":o=e;break;case"right":o=-e}}else{switch(e=Math.abs(e),i=Math.abs(i),r){case"top-right":case"top-left":case"top":l=i-r0;break;case"bottom-right":case"bottom-left":case"bottom":l=-i+r0}switch(r){case"top-right":case"bottom-right":case"right":o=-e;break;case"top-left":case"bottom-left":case"left":o=e}}return[o,l]}function CW(r,e,i,o,l,u,h,m,_,v,x){r.createArrays(),r.tilePixelRatio=Et/(512*r.overscaling),r.compareText={},r.iconsNeedLinear=!1;const w=r.layers[0].layout,C=r.layers[0]._unevaluatedLayout._values,k={};if(r.textSizeData.kind==="composite"){const{minZoom:B,maxZoom:H}=r.textSizeData;k.compositeTextSizes=[C["text-size"].possiblyEvaluate(new Gi(B),m),C["text-size"].possiblyEvaluate(new Gi(H),m)]}if(r.iconSizeData.kind==="composite"){const{minZoom:B,maxZoom:H}=r.iconSizeData;k.compositeIconSizes=[C["icon-size"].possiblyEvaluate(new Gi(B),m),C["icon-size"].possiblyEvaluate(new Gi(H),m)]}k.layoutTextSize=C["text-size"].possiblyEvaluate(new Gi(_+1),m),k.layoutIconSize=C["icon-size"].possiblyEvaluate(new Gi(_+1),m),k.textMaxSize=C["text-size"].possiblyEvaluate(new Gi(18),m);const P=w.get("text-rotation-alignment")==="map"&&w.get("symbol-placement")!=="point",R=w.get("text-size");let z=!1;for(const B of r.features)if(B.icon&&B.icon.nameSecondary){z=!0;break}for(const B of r.features){const H=w.get("text-font").evaluate(B,{},m).join(","),Z=R.evaluate(B,{},m),Y=k.layoutTextSize.evaluate(B,{},m),q=(k.layoutIconSize.evaluate(B,{},m),{horizontal:{},vertical:void 0}),ee=B.text;let ce,de=[0,0];if(ee){const Re=ee.toString(),ke=w.get("text-letter-spacing").evaluate(B,{},m)*Ua,$e=w.get("text-line-height").evaluate(B,{},m)*Ua,Ie=tV(Re)?ke:0,Qe=w.get("text-anchor").evaluate(B,{},m),st=w.get("text-variable-anchor");if(!st){const bt=w.get("text-radial-offset").evaluate(B,{},m);de=bt?OE(Qe,[bt*Ua,PE]):w.get("text-offset").evaluate(B,{},m).map(St=>St*Ua)}let ft=P?"center":w.get("text-justify").evaluate(B,{},m);const Je=w.get("symbol-placement")==="point",tt=Je?w.get("text-max-width").evaluate(B,{},m)*Ua:1/0,pt=bt=>{r.allowVerticalPlacement&&o2(Re)&&(q.vertical=FE(ee,e,i,l,H,tt,$e,Qe,bt,Ie,de,zi.vertical,!0,Y,Z))};if(!P&&st){const bt=ft==="auto"?st.map(Pt=>RE(Pt)):[ft];let St=!1;for(let Pt=0;Pt<bt.length;Pt++){const Ut=bt[Pt];if(!q.horizontal[Ut])if(St)q.horizontal[Ut]=q.horizontal[0];else{const Tt=FE(ee,e,i,l,H,tt,$e,"center",Ut,Ie,de,zi.horizontal,!1,Y,Z);Tt&&(q.horizontal[Ut]=Tt,St=Tt.positionedLines.length===1)}}pt("left")}else{if(ft==="auto"&&(ft=RE(Qe)),Je||w.get("text-writing-mode").indexOf("horizontal")>=0||!o2(Re)){const bt=FE(ee,e,i,l,H,tt,$e,Qe,ft,Ie,de,zi.horizontal,!1,Y,Z);bt&&(q.horizontal[ft]=bt)}pt(Je?"left":ft)}}let ge=!1;if(B.icon&&B.icon.namePrimary){const Re=o[B.icon.namePrimary];Re&&(ce=yW(l[B.icon.namePrimary],B.icon.nameSecondary?l[B.icon.nameSecondary]:void 0,w.get("icon-offset").evaluate(B,{},m),w.get("icon-anchor").evaluate(B,{},m)),ge=Re.sdf,r.sdfIcons===void 0?r.sdfIcons=Re.sdf:r.sdfIcons!==Re.sdf&&se("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Re.pixelRatio!==r.pixelRatio||w.get("icon-rotate").constantOr(1)!==0)&&(r.iconsNeedLinear=!0))}const ve=dF(q.horizontal)||q.vertical;r.iconsInText||(r.iconsInText=!!ve&&ve.iconsInText),(ve||ce)&&AW(r,B,q,ce,o,k,Y,0,de,ge,h,m,v,x,z)}u&&r.generateCollisionDebugBuffers(_,r.collisionBoxArray)}function RE(r){switch(r){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function AW(r,e,i,o,l,u,h,m,_,v,x,w,C,k,P){let R=u.textMaxSize.evaluate(e,{},w);R===void 0&&(R=h);const z=r.layers[0].layout,B=z.get("icon-offset").evaluate(e,{},w),H=dF(i.horizontal)||i.vertical,Z=C.name==="globe",Y=Ua,q=h/Y,ee=r.tilePixelRatio*R/Y,ce=(Qe=r.overscaling,r.zoom>18&&Qe>2&&(Qe>>=1),Math.max(Et/(512*Qe),1)*z.get("symbol-spacing")),de=z.get("text-padding")*r.tilePixelRatio,ge=z.get("icon-padding")*r.tilePixelRatio,ve=le(z.get("text-max-angle")),Re=z.get("text-rotation-alignment")==="map"&&z.get("symbol-placement")!=="point",ke=z.get("icon-rotation-alignment")==="map"&&z.get("symbol-placement")!=="point",$e=z.get("symbol-placement"),Ie=ce/2;var Qe;const st=z.get("icon-text-fit").evaluate(e,{},w),ft=z.get("icon-text-fit-padding").evaluate(e,{},w),Je=st!=="none";let tt;r.hasAnyIconTextFit===!1&&Je&&(r.hasAnyIconTextFit=!0),o&&Je&&(r.allowVerticalPlacement&&i.vertical&&(tt=tF(o,i.vertical,st,ft,B,q)),H&&(o=tF(o,H,st,ft,B,q)));const pt=(bt,St,Pt)=>{if(St.x<0||St.x>=Et||St.y<0||St.y>=Et)return;let Ut=null;if(Z){const{x:Tt,y:Mt,z:tr}=C.projectTilePoint(St.x,St.y,Pt);Ut={anchor:new Pu(Tt,Mt,tr,0,void 0),up:C.upVector(Pt,St.x,St.y)}}(function(Tt,Mt,tr,ur,cr,hr,Mr,jr,gn,Bn,on,Qr,Vr,Dr,In,Un,dn,gi,Ni,Ii,Ti,ba,Ui,ra,_i,Po,Hc){const Ou=Tt.addToLineVertexArray(Mt,ur);let Ru,Pg,Og,Ly,vR,yR,xR,bR=0,wR=0,ER=0,TR=0,RT=-1,LT=-1;const Gc={};let SR=P2("");const _d=tr?tr.anchor:Mt,DT=gn.layout.get("icon-text-fit").evaluate(Ti,{},_i)!=="none";let BT=0,zT=0;if(gn._unevaluatedLayout.getValue("text-radial-offset")===void 0?[BT,zT]=gn.layout.get("text-offset").evaluate(Ti,{},_i).map(As=>As*Ua):(BT=gn.layout.get("text-radial-offset").evaluate(Ti,{},_i)*Ua,zT=PE),Tt.allowVerticalPlacement&&cr.vertical){const As=cr.vertical;if(In)yR=LE(As),jr&&(xR=LE(jr));else{const ks=gn.layout.get("text-rotate").evaluate(Ti,{},_i)+90;Og=$1(Bn,_d,Mt,on,Qr,Vr,As,Dr,ks,Un),jr&&(Ly=$1(Bn,_d,Mt,on,Qr,Vr,jr,gi,ks))}}if(hr){const As=gn.layout.get("icon-rotate").evaluate(Ti,{},_i),ks=uF(hr,As,Ui,DT),d0=jr?uF(jr,As,Ui,DT):void 0;Pg=$1(Bn,_d,Mt,on,Qr,Vr,hr,gi,As),bR=4*ks.length;const CR=Tt.iconSizeData;let vd=null;CR.kind==="source"?(vd=[Xl*gn.layout.get("icon-size").evaluate(Ti,{},_i)],vd[0]>Hf&&se(`${Tt.layerIds[0]}: Value for "icon-size" is >= ${ug}. Reduce your "icon-size".`)):CR.kind==="composite"&&(vd=[Xl*ba.compositeIconSizes[0].evaluate(Ti,{},_i),Xl*ba.compositeIconSizes[1].evaluate(Ti,{},_i)],(vd[0]>Hf||vd[1]>Hf)&&se(`${Tt.layerIds[0]}: Value for "icon-size" is >= ${ug}. Reduce your "icon-size".`)),Tt.addSymbols(Tt.icon,ks,vd,Ii,Ni,Ti,!1,tr,Mt,Ou.lineStartIndex,Ou.lineLength,-1,ra,_i,Po,Hc),RT=Tt.icon.placedSymbolArray.length-1,d0&&(wR=4*d0.length,Tt.addSymbols(Tt.icon,d0,vd,Ii,Ni,Ti,zi.vertical,tr,Mt,Ou.lineStartIndex,Ou.lineLength,-1,ra,_i,Po,Hc),LT=Tt.icon.placedSymbolArray.length-1)}for(const As in cr.horizontal){const ks=cr.horizontal[As];Ru||(SR=P2(ks.text),In?vR=LE(ks):Ru=$1(Bn,_d,Mt,on,Qr,Vr,ks,Dr,gn.layout.get("text-rotate").evaluate(Ti,{},_i),Un));const d0=ks.positionedLines.length===1;if(ER+=hF(Tt,tr,Mt,ks,Mr,gn,In,Ti,Un,Ou,cr.vertical?zi.horizontal:zi.horizontalOnly,d0?Object.keys(cr.horizontal):[As],Gc,RT,ba,ra,_i,Po),d0)break}cr.vertical&&(TR+=hF(Tt,tr,Mt,cr.vertical,Mr,gn,In,Ti,Un,Ou,zi.vertical,["vertical"],Gc,LT,ba,ra,_i,Po));let Qf=-1;const NT=(As,ks)=>As?Math.max(As,ks):ks;Qf=NT(vR,Qf),Qf=NT(yR,Qf),Qf=NT(xR,Qf);const cZ=Qf>-1?1:0;Tt.glyphOffsetArray.length>=mg.MAX_GLYPHS&&se("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Ti.sortKey!==void 0&&Tt.addToSortKeyRanges(Tt.symbolInstances.length,Ti.sortKey),Tt.symbolInstances.emplaceBack(Mt.x,Mt.y,_d.x,_d.y,_d.z,Gc.right>=0?Gc.right:-1,Gc.center>=0?Gc.center:-1,Gc.left>=0?Gc.left:-1,Gc.vertical>=0?Gc.vertical:-1,RT,LT,SR,Ru!==void 0?Ru:Tt.collisionBoxArray.length,Ru!==void 0?Ru+1:Tt.collisionBoxArray.length,Og!==void 0?Og:Tt.collisionBoxArray.length,Og!==void 0?Og+1:Tt.collisionBoxArray.length,Pg!==void 0?Pg:Tt.collisionBoxArray.length,Pg!==void 0?Pg+1:Tt.collisionBoxArray.length,Ly||Tt.collisionBoxArray.length,Ly?Ly+1:Tt.collisionBoxArray.length,on,ER,TR,bR,wR,cZ,0,BT,zT,Qf,0,DT?1:0)})(r,St,Ut,bt,i,o,l,tt,r.layers[0],r.collisionBoxArray,e.index,e.sourceLayerIndex,r.index,de,Re,_,0,ge,ke,B,e,u,v,x,w,k,P)};if($e==="line")for(const bt of sF(e.geometry,0,0,Et,Et)){const St=bW(bt,ce,ve,i.vertical||H,o,Y,ee,r.overscaling,Et);for(const Pt of St)H&&kW(r,H.text,Ie,Pt)||pt(bt,Pt,w)}else if($e==="line-center"){for(const bt of e.geometry)if(bt.length>1){const St=xW(bt,ve,i.vertical||H,o,Y,ee);St&&pt(bt,St,w)}}else if(e.type==="Polygon")for(const bt of yE(e.geometry,0)){const St=EW(bt,16);pt(bt[0],new Pu(St.x,St.y,0,0,void 0),w)}else if(e.type==="LineString")for(const bt of e.geometry)pt(bt,new Pu(bt[0].x,bt[0].y,0,0,void 0),w);else if(e.type==="Point")for(const bt of e.geometry)for(const St of bt)pt([St],new Pu(St.x,St.y,0,0,void 0),w)}const ug=255,Hf=ug*Xl;function hF(r,e,i,o,l,u,h,m,_,v,x,w,C,k,P,R,z,B){const H=function(q,ee,ce,de,ge,ve,Re,ke){const $e=[];if(ee.positionedLines.length===0)return $e;const Ie=de.layout.get("text-rotate").evaluate(ve,{})*Math.PI/180,Qe=function(pt){const bt=pt[0],St=pt[1],Pt=bt*St;return Pt>0?[bt,-St]:Pt<0?[-bt,St]:bt===0?[St,bt]:[St,-bt]}(ce);let st=Math.abs(ee.top-ee.bottom);for(const pt of ee.positionedLines)st-=pt.lineOffset;const ft=ee.positionedLines.length,Je=st/ft;let tt=ee.top-ce[1];for(let pt=0;pt<ft;++pt){const bt=ee.positionedLines[pt];tt=wW(ee,Je,tt,pt);for(const St of bt.positionedGlyphs){if(!St.rect)continue;const Pt=St.rect||{};let Ut=qM+1,Tt=!0,Mt=1,tr=0;if(St.imageName){const Ii=Re[St.imageName];if(!Ii)continue;if(Ii.sdf){se("SDF images are not supported in formatted text and will be ignored.");continue}Tt=!1,Mt=Ii.pixelRatio,Ut=is/Mt}const ur=(ge||ke)&&St.vertical,cr=St.metrics.advance*St.scale/2,hr=St.metrics,Mr=St.rect;if(Mr===null)continue;ke&&ee.verticalizable&&(tr=St.imageName?cr-St.metrics.width*St.scale/2:0);const jr=ge?[St.x+cr,St.y]:[0,0];let gn=[0,0],Bn=[0,0],on=!1;ge||(ur?(Bn=[St.x+cr+Qe[0],St.y+Qe[1]-tr],on=!0):gn=[St.x+cr+ce[0],St.y+ce[1]-tr]);const Qr=Mr.w*St.scale/(Mt*(St.localGlyph?Zl:1)),Vr=Mr.h*St.scale/(Mt*(St.localGlyph?Zl:1));let Dr,In,Un,dn;if(ur){const Ii=St.y-tt,Ti=new D(-cr,cr-Ii),ba=-Math.PI/2,Ui=new D(...Bn);Dr=new D(-cr+gn[0],gn[1]),Dr._rotateAround(ba,Ti)._add(Ui),Dr.x+=-Ii+cr,Dr.y-=(hr.left-Ut)*St.scale;const ra=St.imageName?hr.advance*St.scale:Ua*St.scale,_i=String.fromCodePoint(St.glyph);hW(_i)?Dr.x+=(1-Ut)*St.scale:dW(_i)?Dr.x+=ra-hr.height*St.scale+(-Ut-1)*St.scale:Dr.x+=St.imageName||hr.width+2*Ut===Mr.w&&hr.height+2*Ut===Mr.h?(ra-Vr)/2:(ra-(hr.height+2*Ut)*St.scale)/2,In=new D(Dr.x,Dr.y-Qr),Un=new D(Dr.x+Vr,Dr.y),dn=new D(Dr.x+Vr,Dr.y-Qr)}else{const Ii=(hr.left-Ut)*St.scale-cr+gn[0],Ti=(-hr.top-Ut)*St.scale+gn[1],ba=Ii+Qr,Ui=Ti+Vr;Dr=new D(Ii,Ti),In=new D(ba,Ti),Un=new D(Ii,Ui),dn=new D(ba,Ui)}if(Ie){let Ii;Ii=ge?new D(0,0):on?new D(Qe[0],Qe[1]):new D(ce[0],ce[1]),Dr._rotateAround(Ie,Ii),In._rotateAround(Ie,Ii),Un._rotateAround(Ie,Ii),dn._rotateAround(Ie,Ii)}const gi=new D(0,0),Ni=new D(0,0);$e.push({tl:Dr,tr:In,bl:Un,br:dn,texPrimary:Pt,texSecondary:void 0,writingMode:ee.writingMode,glyphOffset:jr,sectionIndex:St.sectionIndex,isSDF:Tt,pixelOffsetTL:gi,pixelOffsetBR:Ni,minFontScaleX:0,minFontScaleY:0})}}return $e}(0,o,_,u,h,m,l,r.allowVerticalPlacement),Z=r.textSizeData;let Y=null;Z.kind==="source"?(Y=[Xl*u.layout.get("text-size").evaluate(m,{},z)],Y[0]>Hf&&se(`${r.layerIds[0]}: Value for "text-size" is >= ${ug}. Reduce your "text-size".`)):Z.kind==="composite"&&(Y=[Xl*P.compositeTextSizes[0].evaluate(m,{},z),Xl*P.compositeTextSizes[1].evaluate(m,{},z)],(Y[0]>Hf||Y[1]>Hf)&&se(`${r.layerIds[0]}: Value for "text-size" is >= ${ug}. Reduce your "text-size".`)),r.addSymbols(r.text,H,Y,_,h,m,x,e,i,v.lineStartIndex,v.lineLength,k,R,z,B,!1);for(const q of w)C[q]=r.text.placedSymbolArray.length-1;return 4*H.length}function dF(r){for(const e in r)return r[e];return null}function $1(r,e,i,o,l,u,h,m,_,v){let x=h.top,w=h.bottom,C=h.left,k=h.right;const P=h.collisionPadding;if(P&&(C-=P[0],x-=P[1],k+=P[2],w+=P[3]),_){const R=new D(C,x),z=new D(k,x),B=new D(C,w),H=new D(k,w),Z=le(_);let Y=new D(0,0);v&&(Y=new D(v[0],v[1])),R._rotateAround(Z,Y),z._rotateAround(Z,Y),B._rotateAround(Z,Y),H._rotateAround(Z,Y),C=Math.min(R.x,z.x,B.x,H.x),k=Math.max(R.x,z.x,B.x,H.x),x=Math.min(R.y,z.y,B.y,H.y),w=Math.max(R.y,z.y,B.y,H.y)}return r.emplaceBack(e.x,e.y,e.z,i.x,i.y,C,x,k,w,m,o,l,u),r.length-1}function LE(r){r.collisionPadding&&(r.top-=r.collisionPadding[1],r.bottom+=r.collisionPadding[3]);const e=r.bottom-r.top;return e>0?Math.max(10,e):null}function kW(r,e,i,o){const l=r.compareText;if(e in l){const u=l[e];for(let h=u.length-1;h>=0;h--)if(o.dist(u[h])<i)return!0}else l[e]=[];return l[e].push(o),!1}function pF(r,e){const i=r.fovAboveCenter,o=r.elevation?r.elevation.getMinElevationBelowMSL()*e:0,l=(r._camera.position[2]*r.worldSize-o)/Math.cos(r._pitch),u=Math.sin(i)*l/Math.sin(Math.max(Math.PI/2-r._pitch-i,.01)),h=Math.sin(r._pitch)*u+l;return Math.min(1.01*h,l*(1/r._horizonShift))}function cd(r,e){if(!e.isReprojectedInTileSpace)return{scale:1<<r.z,x:r.x,y:r.y,x2:r.x+1,y2:r.y+1,projection:e};const i=Math.pow(2,-r.z),o=r.x*i,l=(r.x+1)*i,u=r.y*i,h=(r.y+1)*i,m=Ss(o),_=Ss(l),v=ka(u),x=ka(h),w=e.project(m,v),C=e.project(_,v),k=e.project(_,x),P=e.project(m,x);let R=Math.min(w.x,C.x,k.x,P.x),z=Math.min(w.y,C.y,k.y,P.y),B=Math.max(w.x,C.x,k.x,P.x),H=Math.max(w.y,C.y,k.y,P.y);const Z=i/16;function Y(ee,ce,de,ge,ve,Re){const ke=(de+ve)/2,$e=(ge+Re)/2,Ie=e.project(Ss(ke),ka($e)),Qe=Math.max(0,R-Ie.x,z-Ie.y,Ie.x-B,Ie.y-H);R=Math.min(R,Ie.x),B=Math.max(B,Ie.x),z=Math.min(z,Ie.y),H=Math.max(H,Ie.y),Qe>Z&&(Y(ee,Ie,de,ge,ke,$e),Y(Ie,ce,ke,$e,ve,Re))}Y(w,C,o,u,l,u),Y(C,k,l,u,l,h),Y(k,P,l,h,o,h),Y(P,w,o,h,o,u),R-=Z,z-=Z,B+=Z,H+=Z;const q=1/Math.max(B-R,H-z);return{scale:q,x:R*q,y:z*q,x2:B*q,y2:H*q,projection:e}}function mF(r,e,i,o,l,u,h,m,_){if(_.name==="globe")return tE(r,e,new Dc(i,o,l),!1);const v=cd({z:i,x:o,y:l},_);return new Oi([(u+v.x/v.scale)*e,e*(v.y/v.scale),h],[(u+v.x2/v.scale)*e,e*(v.y2/v.scale),m])}function gF(r,{x:e,y:i},o=0){return new D(((e-o)*r.scale-r.x)*Et,(i*r.scale-r.y)*Et)}function _F(r,e,i=0){return We.fromValues(((e.x-i)*r.scale-r.x)*Et,(e.y*r.scale-r.y)*Et,aM(e.z,e.y))}const IW=dt.identity(new Float32Array(16));class Gf{constructor(e){this.spec=e,this.name=e.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(e,i){return{x:0,y:0,z:0}}unproject(e,i){return new Xr(0,0)}projectTilePoint(e,i,o){return{x:e,y:i,z:0}}locationPoint(e,i,o=!0){return e._coordinatePoint(e.locationCoordinate(i),o)}pixelsPerMeter(e,i){return fi(1,e)*i}pixelSpaceConversion(e,i,o){return 1}farthestPixelDistance(e){return pF(e,e.pixelsPerMeter)}pointCoordinate(e,i,o,l){const u=e.horizonLineFromTop(!1),h=new D(i,Math.max(u,o));return e.rayIntersectionCoordinate(e.pointRayIntersection(h,l))}pointCoordinate3D(e,i,o){const l=new D(i,o);if(e.elevation)return e.elevation.pointCoordinate(l);{const u=this.pointCoordinate(e,l.x,l.y,0);return[u.x,u.y,u.z]}}isPointAboveHorizon(e,i){if(e.elevation)return!this.pointCoordinate3D(e,i.x,i.y);const o=e.horizonLineFromTop();return i.y<o}createInversionMatrix(e,i){return IW}createTileMatrix(e,i,o){let l,u,h;const m=o.canonical,_=dt.identity(new Float64Array(16));if(this.isReprojectedInTileSpace){const v=cd(m,this);l=1,u=v.x+o.wrap*v.scale,h=v.y,dt.scale(_,_,[l/v.scale,l/v.scale,e.pixelsPerMeter/i])}else l=i/e.zoomScale(m.z),u=(m.x+Math.pow(2,m.z)*o.wrap)*l,h=m.y*l;return dt.translate(_,_,[u,h,0]),dt.scale(_,_,[l/Et,l/Et,1]),_}upVector(e,i,o){return[0,0,1]}upVectorScale(e,i,o){return{metersToTile:1}}}class MW extends Gf{constructor(e){super(e),this.range=[4,7],this.center=e.center||[-96,37.5];const[i,o]=this.parallels=e.parallels||[29.5,45.5],l=Math.sin(le(i));this.n=(l+Math.sin(le(o)))/2,this.c=1+l*(2*this.n-l),this.r0=Math.sqrt(this.c)/this.n}project(e,i){const{n:o,c:l,r0:u}=this,h=le(e-this.center[0]),m=le(i),_=Math.sqrt(l-2*o*Math.sin(m))/o;return{x:_*Math.sin(h*o),y:_*Math.cos(h*o)-u,z:0}}unproject(e,i){const{n:o,c:l,r0:u}=this,h=u+i;let m=Math.atan2(e,Math.abs(h))*Math.sign(h);h*o<0&&(m-=Math.PI*Math.sign(e)*Math.sign(h));const _=le(this.center[0])*o;m=rt(m,-Math.PI-_,Math.PI-_);const v=Oe(re(m/o)+this.center[0],-180,180),x=Math.asin(Oe((l-(e*e+h*h)*o*o)/(2*o),-1,1)),w=Oe(re(x),-ha,ha);return new Xr(v,w)}}const fg=1.340264,hg=-.081106,dg=893e-6,pg=.003796,V1=Math.sqrt(3)/2;class FW extends Gf{project(e,i){i=i/180*Math.PI,e=e/180*Math.PI;const o=Math.asin(V1*Math.sin(i)),l=o*o,u=l*l*l;return{x:.5*(e*Math.cos(o)/(V1*(fg+3*hg*l+u*(7*dg+9*pg*l)))/Math.PI+.5),y:1-.5*(o*(fg+hg*l+u*(dg+pg*l))/Math.PI+1),z:0}}unproject(e,i){e=(2*e-.5)*Math.PI;let o=i=(2*(1-i)-1)*Math.PI,l=o*o,u=l*l*l;for(let x,w,C,k=0;k<12&&(w=o*(fg+hg*l+u*(dg+pg*l))-i,C=fg+3*hg*l+u*(7*dg+9*pg*l),x=w/C,o=Oe(o-x,-Math.PI/3,Math.PI/3),l=o*o,u=l*l*l,!(Math.abs(x)<1e-12));++k);const h=V1*e*(fg+3*hg*l+u*(7*dg+9*pg*l))/Math.cos(o),m=Math.asin(Math.sin(o)/V1),_=Oe(180*h/Math.PI,-180,180),v=Oe(180*m/Math.PI,-ha,ha);return new Xr(_,v)}}class PW extends Gf{constructor(e){super(e),this.wrap=!0,this.supportsWorldCopies=!0}project(e,i){return{x:.5+e/360,y:.5-i/360,z:0}}unproject(e,i){const o=360*(e-.5),l=Oe(360*(.5-i),-ha,ha);return new Xr(o,l)}}const n0=Math.PI/2;function j1(r){return Math.tan((n0+r)/2)}class OW extends Gf{constructor(e){super(e),this.center=e.center||[0,30];const[i,o]=this.parallels=e.parallels||[30,30];let l=le(i),u=le(o);this.southernCenter=l+u<0,this.southernCenter&&(l=-l,u=-u);const h=Math.cos(l),m=j1(l);this.n=l===u?Math.sin(l):Math.log(h/Math.cos(u))/Math.log(j1(u)/m),this.f=h*Math.pow(j1(l),this.n)/this.n}project(e,i){i=le(i),this.southernCenter&&(i=-i),e=le(e-this.center[0]);const o=1e-6,{n:l,f:u}=this;u>0?i<-n0+o&&(i=-n0+o):i>n0-o&&(i=n0-o);const h=u/Math.pow(j1(i),l);let m=h*Math.sin(l*e),_=u-h*Math.cos(l*e);return m=.5*(m/Math.PI+.5),_=.5*(_/Math.PI+.5),{x:m,y:this.southernCenter?_:1-_,z:0}}unproject(e,i){e=(2*e-.5)*Math.PI,this.southernCenter&&(i=1-i),i=(2*(1-i)-.5)*Math.PI;const{n:o,f:l}=this,u=l-i,h=Math.sign(u),m=Math.sign(o)*Math.sqrt(e*e+u*u);let _=Math.atan2(e,Math.abs(u))*h;u*o<0&&(_-=Math.PI*Math.sign(e)*h);const v=Oe(re(_/o)+this.center[0],-180,180),x=Oe(re(2*Math.atan(Math.pow(l/m,1/o))-n0),-ha,ha);return new Xr(v,this.southernCenter?-x:x)}}class vF extends Gf{constructor(e){super(e),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(e,i){return{x:Xa(e),y:oo(i),z:0}}unproject(e,i){const o=Ss(e),l=ka(i);return new Xr(o,l)}}const yF=le(ha);class RW extends Gf{project(e,i){const o=(i=le(i))*i,l=o*o;return{x:.5*((e=le(e))*(.8707-.131979*o+l*(l*(.003971*o-.001529*l)-.013791))/Math.PI+.5),y:1-.5*(i*(1.007226+o*(.015085+l*(.028874*o-.044475-.005916*l)))/Math.PI+1),z:0}}unproject(e,i){e=(2*e-.5)*Math.PI;let o=i=(2*(1-i)-1)*Math.PI,l=25,u=0,h=o*o;do{h=o*o;const v=h*h;u=(o*(1.007226+h*(.015085+v*(.028874*h-.044475-.005916*v)))-i)/(1.007226+h*(.045255+v*(.259866*h-.311325-.005916*11*v))),o=Oe(o-u,-yF,yF)}while(Math.abs(u)>1e-6&&--l>0);h=o*o;const m=Oe(re(e/(.8707+h*(h*(h*h*h*(.003971-.001529*h)-.013791)-.131979))),-180,180),_=re(o);return new Xr(m,_)}}const xF=le(ha);class LW extends Gf{project(e,i){i=le(i),e=le(e);const o=Math.cos(i),l=2/Math.PI,u=Math.acos(o*Math.cos(e/2)),h=Math.sin(u)/u,m=.5*(e*l+2*o*Math.sin(e/2)/h)||0,_=.5*(i+Math.sin(i)/h)||0;return{x:.5*(m/Math.PI+.5),y:1-.5*(_/Math.PI+1),z:0}}unproject(e,i){let o=e=(2*e-.5)*Math.PI,l=i=(2*(1-i)-1)*Math.PI,u=25;const h=1e-6;let m=0,_=0;do{const v=Math.cos(l),x=Math.sin(l),w=2*x*v,C=x*x,k=v*v,P=Math.cos(o/2),R=Math.sin(o/2),z=2*P*R,B=R*R,H=1-k*P*P,Z=H?1/H:0,Y=H?Math.acos(v*P)*Math.sqrt(1/H):0,q=.5*(2*Y*v*R+2*o/Math.PI)-e,ee=.5*(Y*x+l)-i,ce=.5*Z*(k*B+Y*v*P*C)+1/Math.PI,de=Z*(z*w/4-Y*x*R),ge=.125*Z*(w*R-Y*x*k*z),ve=.5*Z*(C*P+Y*B*v)+.5,Re=de*ge-ve*ce;m=(ee*de-q*ve)/Re,_=(q*ge-ee*ce)/Re,o=Oe(o-m,-Math.PI,Math.PI),l=Oe(l-_,-xF,xF)}while((Math.abs(m)>h||Math.abs(_)>h)&&--u>0);return new Xr(re(o),re(l))}}class bF extends Gf{constructor(e){super(e),this.center=e.center||[0,0],this.parallels=e.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(le(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(e,i){const{scale:o,cosPhi:l}=this;return{x:le(e)*l*o+.5,y:-Math.sin(le(i))/l*o+.5,z:0}}unproject(e,i){const{scale:o,cosPhi:l}=this,u=-(i-.5)/o,h=Oe(re((e-.5)/o)/l,-180,180),m=Math.asin(Oe(u*l,-1,1)),_=Oe(re(m),-ha,ha);return new Xr(h,_)}}class DW extends vF{constructor(e){super(e),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(e,i,o){const l=tg(e,i,o),u=od(vl(o));return We.transformMat4(l,l,u),{x:l[0],y:l[1],z:l[2]}}locationPoint(e,i){const o=ns(i.lat,i.lng),l=We.normalize([],o),u=e.elevation?e.elevation.getAtPointOrZero(e.locationCoordinate(i),e._centerAltitude):e._centerAltitude,h=fi(1,0)*Et*u;We.scaleAndAdd(o,o,l,h);const m=dt.identity(new Float64Array(16));return dt.multiply(m,e.pixelMatrix,e.globeMatrix),We.transformMat4(o,o,m),new D(o[0],o[1])}pixelsPerMeter(e,i){return fi(1,0)*i}pixelSpaceConversion(e,i,o){const l=fi(1,e)*i,u=$r(fi(1,45)*i,l,o);return this.pixelsPerMeter(e,i)/u}createTileMatrix(e,i,o){const l=nE(vl(o.canonical));return dt.multiply(new Float64Array(16),e.globeMatrix,l)}createInversionMatrix(e,i){const{center:o}=e,l=od(vl(i));return dt.rotateY(l,l,le(o.lng)),dt.rotateX(l,l,le(o.lat)),dt.scale(l,l,[e._pixelsPerMercatorPixel,e._pixelsPerMercatorPixel,1]),Float32Array.from(l)}pointCoordinate(e,i,o,l){return XI(e,i,o,!0)||new Pn(0,0)}pointCoordinate3D(e,i,o){const l=this.pointCoordinate(e,i,o,0);return[l.x,l.y,l.z]}isPointAboveHorizon(e,i){return!XI(e,i.x,i.y,!1)}farthestPixelDistance(e){const i=function(l,u){const h=l.cameraToCenterDistance,m=l._centerAltitude*u,_=l._camera,v=l._camera.forward(),x=We.add([],We.scale([],v,-h),[0,0,m]),w=l.worldSize/(2*Math.PI),C=[0,0,-w],k=l.width/l.height,P=Math.tan(l.fovAboveCenter),R=We.scale([],_.up(),P),z=We.scale([],_.right(),P*k),B=We.normalize([],We.add([],We.add([],v,R),z)),H=[];let Z;if(new p1(x,B).closestPointOnSphere(C,w,H)){const Y=We.add([],H,C),q=We.sub([],Y,x);Z=Math.cos(l.fovAboveCenter)*We.length(q)}else{const Y=We.sub([],x,C),q=We.sub([],C,x);We.normalize(q,q);const ee=We.length(Y)-w;Z=Math.sqrt(ee*(ee+2*w));const ce=Math.acos(Z/(w+ee))-Math.acos(We.dot(v,q));Z*=Math.cos(ce)}return 1.01*Z}(e,this.pixelsPerMeter(e.center.lat,e.worldSize)),o=qa(e.zoom);if(o>0){const l=pF(e,fi(1,e.center.lat)*e.worldSize),u=e.worldSize/(2*Math.PI),h=Math.max(e.width,e.height)/e.worldSize*Math.PI;return $r(i,l+u*(1-Math.cos(h)),Math.pow(o,10))}return i}upVector(e,i,o){return tg(i,o,e,1)}upVectorScale(e){return{metersToTile:m1(_1(vl(e)))}}}function W1(r){const e=r.parallels,i=!!e&&Math.abs(e[0]+e[1])<.01;switch(r.name){case"mercator":return new vF(r);case"equirectangular":return new PW(r);case"naturalEarth":return new RW(r);case"equalEarth":return new FW(r);case"winkelTripel":return new LW(r);case"albers":return i?new bF(r):new MW(r);case"lambertConformalConic":return i?new bF(r):new OW(r);case"globe":return new DW(r)}throw new Error(`Invalid projection name: ${r.name}`)}const BW=new sa({"symbol-placement":new Yt(at.layout_symbol["symbol-placement"]),"symbol-spacing":new Yt(at.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Yt(at.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Pr(at.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Yt(at.layout_symbol["symbol-z-order"]),"symbol-z-elevate":new Yt(at.layout_symbol["symbol-z-elevate"]),"icon-allow-overlap":new Yt(at.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Yt(at.layout_symbol["icon-ignore-placement"]),"icon-optional":new Yt(at.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Yt(at.layout_symbol["icon-rotation-alignment"]),"icon-size":new Pr(at.layout_symbol["icon-size"]),"icon-text-fit":new Pr(at.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Pr(at.layout_symbol["icon-text-fit-padding"]),"icon-image":new Pr(at.layout_symbol["icon-image"]),"icon-rotate":new Pr(at.layout_symbol["icon-rotate"]),"icon-padding":new Yt(at.layout_symbol["icon-padding"]),"icon-keep-upright":new Yt(at.layout_symbol["icon-keep-upright"]),"icon-offset":new Pr(at.layout_symbol["icon-offset"]),"icon-anchor":new Pr(at.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Yt(at.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Yt(at.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Yt(at.layout_symbol["text-rotation-alignment"]),"text-field":new Pr(at.layout_symbol["text-field"]),"text-font":new Pr(at.layout_symbol["text-font"]),"text-size":new Pr(at.layout_symbol["text-size"]),"text-max-width":new Pr(at.layout_symbol["text-max-width"]),"text-line-height":new Pr(at.layout_symbol["text-line-height"]),"text-letter-spacing":new Pr(at.layout_symbol["text-letter-spacing"]),"text-justify":new Pr(at.layout_symbol["text-justify"]),"text-radial-offset":new Pr(at.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Yt(at.layout_symbol["text-variable-anchor"]),"text-anchor":new Pr(at.layout_symbol["text-anchor"]),"text-max-angle":new Yt(at.layout_symbol["text-max-angle"]),"text-writing-mode":new Yt(at.layout_symbol["text-writing-mode"]),"text-rotate":new Pr(at.layout_symbol["text-rotate"]),"text-padding":new Yt(at.layout_symbol["text-padding"]),"text-keep-upright":new Yt(at.layout_symbol["text-keep-upright"]),"text-transform":new Pr(at.layout_symbol["text-transform"]),"text-offset":new Pr(at.layout_symbol["text-offset"]),"text-allow-overlap":new Yt(at.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Yt(at.layout_symbol["text-ignore-placement"]),"text-optional":new Yt(at.layout_symbol["text-optional"]),visibility:new Yt(at.layout_symbol.visibility)});var DE={paint:new sa({"icon-opacity":new Pr(at.paint_symbol["icon-opacity"]),"icon-emissive-strength":new Pr(at.paint_symbol["icon-emissive-strength"]),"text-emissive-strength":new Pr(at.paint_symbol["text-emissive-strength"]),"icon-color":new Pr(at.paint_symbol["icon-color"]),"icon-halo-color":new Pr(at.paint_symbol["icon-halo-color"]),"icon-halo-width":new Pr(at.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Pr(at.paint_symbol["icon-halo-blur"]),"icon-translate":new Yt(at.paint_symbol["icon-translate"]),"icon-translate-anchor":new Yt(at.paint_symbol["icon-translate-anchor"]),"icon-image-cross-fade":new Pr(at.paint_symbol["icon-image-cross-fade"]),"text-opacity":new Pr(at.paint_symbol["text-opacity"]),"text-color":new Pr(at.paint_symbol["text-color"],{runtimeType:Jo,getOverride:r=>r.textColor,hasOverride:r=>!!r.textColor}),"text-halo-color":new Pr(at.paint_symbol["text-halo-color"]),"text-halo-width":new Pr(at.paint_symbol["text-halo-width"]),"text-halo-blur":new Pr(at.paint_symbol["text-halo-blur"]),"text-translate":new Yt(at.paint_symbol["text-translate"]),"text-translate-anchor":new Yt(at.paint_symbol["text-translate-anchor"])}),layout:BW};class wF{constructor(e){this.type=e.property.overrides?e.property.overrides.runtimeType:mu,this.defaultValue=e}evaluate(e){if(e.formattedSection){const i=this.defaultValue.property.overrides;if(i&&i.hasOverride(e.formattedSection))return i.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default}eachChild(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}xr(wF,"FormatSectionOverride",{omit:["defaultValue"]});class H1 extends Zs{constructor(e,i){super(e,DE,i)}recalculate(e,i){super.recalculate(e,i),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const o=this.layout.get("text-writing-mode");if(o){const l=[];for(const u of o)l.indexOf(u)<0&&l.push(u);this.layout._values["text-writing-mode"]=l}else this.layout._values["text-writing-mode"]=this.layout.get("symbol-placement")==="point"?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getValueAndResolveTokens(e,i,o,l){const u=this.layout.get(e).evaluate(i,{},o,l),h=this._unevaluatedLayout._values[e];return h.isDataDriven()||Gv(h.value)||!u?u:function(m,_){return _.replace(/{([^{}]+)}/g,(v,x)=>x in m?String(m[x]):"")}(i.properties,u)}createBucket(e){return new mg(e)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const e of DE.paint.overridableProperties){if(!H1.hasPaintOverride(this.layout,e))continue;const i=this.paint.get(e),o=new wF(i),l=new Qw(o,i.property.specification);let u=null;u=i.value.kind==="constant"||i.value.kind==="source"?new e2("source",l):new Af("composite",l,i.value.zoomStops,i.value._interpolationType),this.paint._values[e]=new Np(i.property,u,i.parameters)}}_handleOverridablePaintPropertyUpdate(e,i,o){return!(!this.layout||i.isDataDriven()||o.isDataDriven())&&H1.hasPaintOverride(this.layout,e)}static hasPaintOverride(e,i){const o=e.get("text-field"),l=DE.paint.properties[i];let u=!1;const h=m=>{for(const _ of m)if(l.overrides&&l.overrides.hasOverride(_))return void(u=!0)};if(o.value.kind==="constant"&&o.value.value instanceof Eo)h(o.value.value.sections);else if(o.value.kind==="source"){const m=v=>{u||(v instanceof _u&&Aa(v.value)===df?h(v.value.sections):v instanceof Ul?h(v.sections):v.eachChild(m))},_=o.value;_._styleExpression&&m(_._styleExpression.expression)}return u}getProgramIds(){const e=this.paint.get("icon-opacity").constantOr(1)!==0,i=this.paint.get("text-opacity").constantOr(1)!==0,o=[];return e&&o.push("symbolIcon"),i&&o.push("symbolSDF"),o}getDefaultProgramParams(e,i){return{config:new nd(this,i),overrideFog:!1}}}const zW=F1.types,NW=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function G1(r,e,i,o,l,u,h,m,_,v,x,w,C){const k=m?Math.min(Hf,Math.round(m[0])):0,P=m?Math.min(Hf,Math.round(m[1])):0;r.emplaceBack(e,i,Math.round(32*o),Math.round(32*l),u,h,(k<<1)+(_?1:0),P,16*v,16*x,256*w,256*C)}function q1(r,e,i){r.emplaceBack(e,i)}function X1(r,e,i,o,l,u,h){r.emplaceBack(e,i,o,l,u,h)}function Z1(r,e,i,o,l){const u=5*e+2;r.float32[u+0]=i,r.float32[u+1]=o,r.float32[u+2]=l}function i0(r,e,i,o,l){r.emplaceBack(e,i,o,l),r.emplaceBack(e,i,o,l),r.emplaceBack(e,i,o,l),r.emplaceBack(e,i,o,l)}function UW(r){for(const e of r.sections)if(iV(e.text))return!0;return!1}class BE{constructor(e){this.layoutVertexArray=new y2,this.indexArray=new Oa,this.programConfigurations=e,this.segments=new ui,this.dynamicLayoutVertexArray=new Mf,this.opacityVertexArray=new b2,this.placedSymbolArray=new p4,this.iconTransitioningVertexArray=new Pf,this.globeExtVertexArray=new x2,this.zOffsetVertexArray=new qm}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0&&this.iconTransitioningVertexArray.length===0}upload(e,i,o,l,u){this.isEmpty()||(o&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,rW.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,i),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,iW.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,NW,!0),this.iconTransitioningVertexArray.length>0&&(this.iconTransitioningVertexBuffer=e.createVertexBuffer(this.iconTransitioningVertexArray,oW.members,!0)),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=e.createVertexBuffer(this.globeExtVertexArray,nW.members,!0)),!this.zOffsetVertexBuffer&&(this.zOffsetVertexArray.length>0||u)&&(this.zOffsetVertexBuffer=e.createVertexBuffer(this.zOffsetVertexArray,aW.members,!0)),this.opacityVertexBuffer.itemSize=1),(o||l)&&this.programConfigurations.upload(e))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.iconTransitioningVertexBuffer&&this.iconTransitioningVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy(),this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy())}}xr(BE,"SymbolBuffers");class zE{constructor(e,i,o){this.layoutVertexArray=new e,this.layoutAttributes=i,this.indexArray=new o,this.segments=new ui,this.collisionVertexArray=new T2,this.collisionVertexArrayExt=new Of}upload(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,sW.members,!0),this.collisionVertexBufferExt=e.createVertexBuffer(this.collisionVertexArrayExt,lW.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}xr(zE,"CollisionBuffers");class K1{constructor(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(h=>h.fqid),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.hasAnyIconTextFit=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=dt.identity([]),this.placementViewportMatrix=dt.identity([]);const i=this.layers[0]._unevaluatedLayout._values;this.textSizeData=AE(this.zoom,i["text-size"]),this.iconSizeData=AE(this.zoom,i["icon-size"]);const o=this.layers[0].layout,l=o.get("symbol-sort-key"),u=o.get("symbol-z-order");this.canOverlap=o.get("text-allow-overlap")||o.get("icon-allow-overlap")||o.get("text-ignore-placement")||o.get("icon-ignore-placement"),this.sortFeaturesByKey=u!=="viewport-y"&&l.constantOr(1)!==void 0,this.sortFeaturesByY=(u==="viewport-y"||u==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=o.get("text-writing-mode").map(h=>zi[h]),this.stateDependentLayerIds=this.layers.filter(h=>h.isStateDependent()).map(h=>h.id),this.sourceID=e.sourceID,this.projection=e.projection,this.hasAnyZOffset=!1,this.zOffsetSortDirty=!1,this.zOffsetBuffersNeedUpload=o.get("symbol-z-elevate")}createArrays(){this.text=new BE(new Lf(this.layers,this.zoom,e=>/^text/.test(e))),this.icon=new BE(new Lf(this.layers,this.zoom,e=>/^icon/.test(e))),this.glyphOffsetArray=new _4,this.lineVertexArray=new v4,this.symbolInstances=new g4}calculateGlyphDependencies(e,i,o,l,u){for(let h=0;h<e.length;h++){const m=e.codePointAt(h);if(m===void 0)break;if(i[m]=!0,l&&u&&m<=65535){const _=sg[e.charAt(h)];_&&(i[_.charCodeAt(0)]=!0)}}}populate(e,i,o,l){const u=this.layers[0],h=u.layout,m=this.projection.name==="globe",_=h.get("text-font"),v=h.get("text-field"),x=h.get("icon-image"),w=(v.value.kind!=="constant"||v.value.value instanceof Eo&&!v.value.value.isEmpty()||v.value.value.toString().length>0)&&(_.value.kind!=="constant"||_.value.value.length>0),C=x.value.kind!=="constant"||!!x.value.value||Object.keys(x.parameters).length>0,k=h.get("symbol-sort-key");if(this.features=[],!w&&!C)return;const P=i.iconDependencies,R=i.glyphDependencies,z=i.availableImages,B=new Gi(this.zoom);for(const{feature:H,id:Z,index:Y,sourceLayerIndex:q}of e){const ee=u._featureFilter.needGeometry,ce=$f(H,ee);if(!u._featureFilter.filter(B,ce,o))continue;if(ee||(ce.geometry=Bc(H,o,l)),m&&H.type!==1&&o.z<=5){const Re=ce.geometry,ke=.98078528056,$e=(Ie,Qe)=>{const st=tg(Ie.x,Ie.y,o,1),ft=tg(Qe.x,Qe.y,o,1);return We.dot(st,ft)<ke};for(let Ie=0;Ie<Re.length;Ie++)Re[Ie]=JV(Re[Ie],$e)}let de,ge;if(w){const Re=u.getValueAndResolveTokens("text-field",ce,o,z),ke=Eo.factory(Re);UW(ke)&&(this.hasRTLText=!0),(!this.hasRTLText||p2()==="unavailable"||this.hasRTLText&&pl.isParsed())&&(de=fW(ke,u,ce))}if(C){const Re=u.getValueAndResolveTokens("icon-image",ce,o,z);ge=Re instanceof es?Re:es.fromString(Re)}if(!de&&!ge)continue;const ve=this.sortFeaturesByKey?k.evaluate(ce,{},o):void 0;if(this.features.push({id:Z,text:de,icon:ge,index:Y,sourceLayerIndex:q,geometry:ce.geometry,properties:H.properties,type:zW[H.type],sortKey:ve}),ge&&(P[ge.namePrimary]=!0,ge.nameSecondary&&(P[ge.nameSecondary]=!0)),de){const Re=_.evaluate(ce,{},o).join(","),ke=h.get("text-rotation-alignment")==="map"&&h.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(zi.vertical)>=0;for(const $e of de.sections)if($e.image)P[$e.image.namePrimary]=!0;else{const Ie=o2(de.toString()),Qe=$e.fontStack||Re,st=R[Qe]=R[Qe]||{};this.calculateGlyphDependencies($e.text,st,ke,this.allowVerticalPlacement,Ie)}}}h.get("symbol-placement")==="line"&&(this.features=function(H){const Z={},Y={},q=[];let ee=0;function ce(Re){q.push(H[Re]),ee++}function de(Re,ke,$e){const Ie=Y[Re];return delete Y[Re],Y[ke]=Ie,q[Ie].geometry[0].pop(),q[Ie].geometry[0]=q[Ie].geometry[0].concat($e[0]),Ie}function ge(Re,ke,$e){const Ie=Z[ke];return delete Z[ke],Z[Re]=Ie,q[Ie].geometry[0].shift(),q[Ie].geometry[0]=$e[0].concat(q[Ie].geometry[0]),Ie}function ve(Re,ke,$e){const Ie=$e?ke[0][ke[0].length-1]:ke[0][0];return`${Re}:${Ie.x}:${Ie.y}`}for(let Re=0;Re<H.length;Re++){const ke=H[Re],$e=ke.geometry,Ie=ke.text?ke.text.toString():null;if(!Ie){ce(Re);continue}const Qe=ve(Ie,$e),st=ve(Ie,$e,!0);if(Qe in Y&&st in Z&&Y[Qe]!==Z[st]){const ft=ge(Qe,st,$e),Je=de(Qe,st,q[ft].geometry);delete Z[Qe],delete Y[st],Y[ve(Ie,q[Je].geometry,!0)]=Je,q[ft].geometry=null}else Qe in Y?de(Qe,st,$e):st in Z?ge(Qe,st,$e):(ce(Re),Z[Qe]=ee-1,Y[st]=ee-1)}return q.filter(Re=>Re.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((H,Z)=>H.sortKey-Z.sortKey)}update(e,i,o,l,u){const h=Object.keys(e).length!==0;if(h&&!this.stateDependentLayers.length)return;const m=h?this.stateDependentLayers:this.layers;this.text.programConfigurations.updatePaintArrays(e,i,m,o,l,u),this.icon.programConfigurations.updatePaintArrays(e,i,m,o,l,u)}updateZOffset(){const e=(u,h,m)=>{o+=h,o>u.length&&u.resize(o);for(let _=-h;_<0;_++)u.emplace(_+o,m)},i=(u,h,m)=>{l+=h,l>u.length&&u.resize(l);for(let _=-h;_<0;_++)u.emplace(_+l,m)};if(!this.zOffsetBuffersNeedUpload)return;this.zOffsetBuffersNeedUpload=!1;let o=0,l=0;for(let u=0;u<this.symbolInstances.length;u++){const h=this.symbolInstances.get(u),{numHorizontalGlyphVertices:m,numVerticalGlyphVertices:_,numIconVertices:v}=h,x=h.zOffset,w=v>0;if((m>0||_>0)&&(e(this.text.zOffsetVertexArray,m,x),e(this.text.zOffsetVertexArray,_,x)),w){const{placedIconSymbolIndex:C,verticalPlacedIconSymbolIndex:k}=h;C>=0&&i(this.icon.zOffsetVertexArray,v,x),k>=0&&i(this.icon.zOffsetVertexArray,h.numVerticalIconVertices,x)}}this.text.zOffsetVertexBuffer&&this.text.zOffsetVertexBuffer.updateData(this.text.zOffsetVertexArray),this.icon.zOffsetVertexBuffer&&this.icon.zOffsetVertexBuffer.updateData(this.icon.zOffsetVertexArray)}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=W1(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(e,i){const o=this.lineVertexArray.length;if(e.segment!==void 0)for(const{x:l,y:u}of i)this.lineVertexArray.emplaceBack(l,u);return{lineStartIndex:o,lineLength:this.lineVertexArray.length-o}}addSymbols(e,i,o,l,u,h,m,_,v,x,w,C,k,P,R,z){const B=e.indexArray,H=e.layoutVertexArray,Z=e.globeExtVertexArray,Y=e.segments.prepareSegment(4*i.length,H,B,this.canOverlap?h.sortKey:void 0),q=this.glyphOffsetArray.length,ee=Y.vertexLength,ce=this.allowVerticalPlacement&&m===zi.vertical?Math.PI/2:0,de=h.text&&h.text.sections;for(let ve=0;ve<i.length;ve++){const{tl:Re,tr:ke,bl:$e,br:Ie,texPrimary:Qe,texSecondary:st,pixelOffsetTL:ft,pixelOffsetBR:Je,minFontScaleX:tt,minFontScaleY:pt,glyphOffset:bt,isSDF:St,sectionIndex:Pt}=i[ve],Ut=Y.vertexLength,Tt=bt[1];if(G1(H,v.x,v.y,Re.x,Tt+Re.y,Qe.x,Qe.y,o,St,ft.x,ft.y,tt,pt),G1(H,v.x,v.y,ke.x,Tt+ke.y,Qe.x+Qe.w,Qe.y,o,St,Je.x,ft.y,tt,pt),G1(H,v.x,v.y,$e.x,Tt+$e.y,Qe.x,Qe.y+Qe.h,o,St,ft.x,Je.y,tt,pt),G1(H,v.x,v.y,Ie.x,Tt+Ie.y,Qe.x+Qe.w,Qe.y+Qe.h,o,St,Je.x,Je.y,tt,pt),_){const{x:Mt,y:tr,z:ur}=_.anchor,[cr,hr,Mr]=_.up;X1(Z,Mt,tr,ur,cr,hr,Mr),X1(Z,Mt,tr,ur,cr,hr,Mr),X1(Z,Mt,tr,ur,cr,hr,Mr),X1(Z,Mt,tr,ur,cr,hr,Mr),i0(e.dynamicLayoutVertexArray,Mt,tr,ur,ce)}else i0(e.dynamicLayoutVertexArray,v.x,v.y,v.z,ce);if(z){const Mt=st||Qe;q1(e.iconTransitioningVertexArray,Mt.x,Mt.y),q1(e.iconTransitioningVertexArray,Mt.x+Mt.w,Mt.y),q1(e.iconTransitioningVertexArray,Mt.x,Mt.y+Mt.h),q1(e.iconTransitioningVertexArray,Mt.x+Mt.w,Mt.y+Mt.h)}B.emplaceBack(Ut,Ut+1,Ut+2),B.emplaceBack(Ut+1,Ut+2,Ut+3),Y.vertexLength+=4,Y.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(bt[0]),ve!==i.length-1&&Pt===i[ve+1].sectionIndex||e.programConfigurations.populatePaintArrays(H.length,h,h.index,{},k,P,R,de&&de[Pt])}const ge=_?_.anchor:v;e.placedSymbolArray.emplaceBack(ge.x,ge.y,ge.z,v.x,v.y,q,this.glyphOffsetArray.length-q,ee,x,w,v.segment,o?o[0]:0,o?o[1]:0,l[0],l[1],m,0,!1,0,C,0)}_commitLayoutVertex(e,i,o,l,u,h,m){e.emplaceBack(i,o,l,u,h,Math.round(m.x),Math.round(m.y))}_addCollisionDebugVertices(e,i,o,l,u,h,m){const _=o.segments.prepareSegment(4,o.layoutVertexArray,o.indexArray),v=_.vertexLength,x=m.tileAnchorX,w=m.tileAnchorY;for(let k=0;k<4;k++)o.collisionVertexArray.emplaceBack(0,0,0,0);o.collisionVertexArrayExt.emplaceBack(i,-e.padding,-e.padding),o.collisionVertexArrayExt.emplaceBack(i,e.padding,-e.padding),o.collisionVertexArrayExt.emplaceBack(i,e.padding,e.padding),o.collisionVertexArrayExt.emplaceBack(i,-e.padding,e.padding),this._commitLayoutVertex(o.layoutVertexArray,l,u,h,x,w,new D(e.x1,e.y1)),this._commitLayoutVertex(o.layoutVertexArray,l,u,h,x,w,new D(e.x2,e.y1)),this._commitLayoutVertex(o.layoutVertexArray,l,u,h,x,w,new D(e.x2,e.y2)),this._commitLayoutVertex(o.layoutVertexArray,l,u,h,x,w,new D(e.x1,e.y2)),_.vertexLength+=4;const C=o.indexArray;C.emplaceBack(v,v+1),C.emplaceBack(v+1,v+2),C.emplaceBack(v+2,v+3),C.emplaceBack(v+3,v),_.primitiveLength+=4}_addTextDebugCollisionBoxes(e,i,o,l,u,h){for(let m=l;m<u;m++){const _=o.get(m),v=this.getSymbolInstanceTextSize(e,h,i,m);this._addCollisionDebugVertices(_,v,this.textCollisionBox,_.projectedAnchorX,_.projectedAnchorY,_.projectedAnchorZ,h)}}_addIconDebugCollisionBoxes(e,i,o,l,u,h){for(let m=l;m<u;m++){const _=o.get(m),v=this.getSymbolInstanceIconSize(e,i,h.placedIconSymbolIndex);this._addCollisionDebugVertices(_,v,this.iconCollisionBox,_.projectedAnchorX,_.projectedAnchorY,_.projectedAnchorZ,h)}}generateCollisionDebugBuffers(e,i){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new zE(o1,GM.members,Pf),this.iconCollisionBox=new zE(o1,GM.members,Pf);const o=zc(this.iconSizeData,e),l=zc(this.textSizeData,e);for(let u=0;u<this.symbolInstances.length;u++){const h=this.symbolInstances.get(u);this._addTextDebugCollisionBoxes(l,e,i,h.textBoxStartIndex,h.textBoxEndIndex,h),this._addTextDebugCollisionBoxes(l,e,i,h.verticalTextBoxStartIndex,h.verticalTextBoxEndIndex,h),this._addIconDebugCollisionBoxes(o,e,i,h.iconBoxStartIndex,h.iconBoxEndIndex,h),this._addIconDebugCollisionBoxes(o,e,i,h.verticalIconBoxStartIndex,h.verticalIconBoxEndIndex,h)}}getSymbolInstanceTextSize(e,i,o,l){const u=this.text.placedSymbolArray.get(i.rightJustifiedTextSymbolIndex>=0?i.rightJustifiedTextSymbolIndex:i.centerJustifiedTextSymbolIndex>=0?i.centerJustifiedTextSymbolIndex:i.leftJustifiedTextSymbolIndex>=0?i.leftJustifiedTextSymbolIndex:i.verticalPlacedTextSymbolIndex>=0?i.verticalPlacedTextSymbolIndex:l),h=og(this.textSizeData,e,u)/Ua;return this.tilePixelRatio*h}getSymbolInstanceIconSize(e,i,o){const l=this.icon.placedSymbolArray.get(o),u=og(this.iconSizeData,e,l);return this.tilePixelRatio*u}_commitDebugCollisionVertexUpdate(e,i,o){e.emplaceBack(i,-o,-o),e.emplaceBack(i,o,-o),e.emplaceBack(i,o,o),e.emplaceBack(i,-o,o)}_updateTextDebugCollisionBoxes(e,i,o,l,u,h){for(let m=l;m<u;m++){const _=o.get(m),v=this.getSymbolInstanceTextSize(e,h,i,m);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,v,_.padding)}}_updateIconDebugCollisionBoxes(e,i,o,l,u,h){for(let m=l;m<u;m++){const _=o.get(m),v=this.getSymbolInstanceIconSize(e,i,h);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,v,_.padding)}}updateCollisionDebugBuffers(e,i){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const o=zc(this.iconSizeData,e),l=zc(this.textSizeData,e);for(let u=0;u<this.symbolInstances.length;u++){const h=this.symbolInstances.get(u);this._updateTextDebugCollisionBoxes(l,e,i,h.textBoxStartIndex,h.textBoxEndIndex,h),this._updateTextDebugCollisionBoxes(l,e,i,h.verticalTextBoxStartIndex,h.verticalTextBoxEndIndex,h),this._updateIconDebugCollisionBoxes(o,e,i,h.iconBoxStartIndex,h.iconBoxEndIndex,h.placedIconSymbolIndex),this._updateIconDebugCollisionBoxes(o,e,i,h.verticalIconBoxStartIndex,h.verticalIconBoxEndIndex,h.placedIconSymbolIndex)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(e,i,o,l,u,h,m,_,v){const x={};if(i<o){const{x1:w,y1:C,x2:k,y2:P,padding:R,projectedAnchorX:z,projectedAnchorY:B,projectedAnchorZ:H,tileAnchorX:Z,tileAnchorY:Y,featureIndex:q}=e.get(i);x.textBox={x1:w,y1:C,x2:k,y2:P,padding:R,projectedAnchorX:z,projectedAnchorY:B,projectedAnchorZ:H,tileAnchorX:Z,tileAnchorY:Y},x.textFeatureIndex=q}if(l<u){const{x1:w,y1:C,x2:k,y2:P,padding:R,projectedAnchorX:z,projectedAnchorY:B,projectedAnchorZ:H,tileAnchorX:Z,tileAnchorY:Y,featureIndex:q}=e.get(l);x.verticalTextBox={x1:w,y1:C,x2:k,y2:P,padding:R,projectedAnchorX:z,projectedAnchorY:B,projectedAnchorZ:H,tileAnchorX:Z,tileAnchorY:Y},x.verticalTextFeatureIndex=q}if(h<m){const{x1:w,y1:C,x2:k,y2:P,padding:R,projectedAnchorX:z,projectedAnchorY:B,projectedAnchorZ:H,tileAnchorX:Z,tileAnchorY:Y,featureIndex:q}=e.get(h);x.iconBox={x1:w,y1:C,x2:k,y2:P,padding:R,projectedAnchorX:z,projectedAnchorY:B,projectedAnchorZ:H,tileAnchorX:Z,tileAnchorY:Y},x.iconFeatureIndex=q}if(_<v){const{x1:w,y1:C,x2:k,y2:P,padding:R,projectedAnchorX:z,projectedAnchorY:B,projectedAnchorZ:H,tileAnchorX:Z,tileAnchorY:Y,featureIndex:q}=e.get(_);x.verticalIconBox={x1:w,y1:C,x2:k,y2:P,padding:R,projectedAnchorX:z,projectedAnchorY:B,projectedAnchorZ:H,tileAnchorX:Z,tileAnchorY:Y},x.verticalIconFeatureIndex=q}return x}deserializeCollisionBoxes(e){this.collisionArrays=[];for(let i=0;i<this.symbolInstances.length;i++){const o=this.symbolInstances.get(i);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,o.textBoxStartIndex,o.textBoxEndIndex,o.verticalTextBoxStartIndex,o.verticalTextBoxEndIndex,o.iconBoxStartIndex,o.iconBoxEndIndex,o.verticalIconBoxStartIndex,o.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}hasIconTextFit(){return this.hasAnyIconTextFit}addIndicesForPlacedSymbol(e,i){const o=e.placedSymbolArray.get(i),l=o.vertexStartIndex+4*o.numGlyphs;for(let u=o.vertexStartIndex;u<l;u+=4)e.indexArray.emplaceBack(u,u+1,u+2),e.indexArray.emplaceBack(u+1,u+2,u+3)}getSortedSymbolIndexes(e){if(this.sortedAngle===e&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const i=Math.sin(e),o=Math.cos(e),l=[],u=[],h=[];for(let m=0;m<this.symbolInstances.length;++m){h.push(m);const _=this.symbolInstances.get(m);l.push(0|Math.round(i*_.tileAnchorX+o*_.tileAnchorY)),u.push(_.featureIndex)}return h.sort((m,_)=>l[m]-l[_]||u[_]-u[m]),h}getSortedIndexesByZOffset(){if(!this.zOffsetSortDirty)return this.symbolInstanceIndexesSortedZOffset;if(!this.symbolInstanceIndexesSortedZOffset){this.symbolInstanceIndexesSortedZOffset=[];for(let e=0;e<this.symbolInstances.length;++e)this.symbolInstanceIndexesSortedZOffset.push(e)}return this.zOffsetSortDirty=!1,this.symbolInstanceIndexesSortedZOffset.sort((e,i)=>this.symbolInstances.get(i).zOffset-this.symbolInstances.get(e).zOffset)}addToSortKeyRanges(e,i){const o=this.sortKeyRanges[this.sortKeyRanges.length-1];o&&o.sortKey===i?o.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:i,symbolInstanceStart:e,symbolInstanceEnd:e+1})}sortFeatures(e){if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const i of this.symbolInstanceIndexes){const o=this.symbolInstances.get(i);this.featureSortOrder.push(o.featureIndex);const{rightJustifiedTextSymbolIndex:l,centerJustifiedTextSymbolIndex:u,leftJustifiedTextSymbolIndex:h,verticalPlacedTextSymbolIndex:m,placedIconSymbolIndex:_,verticalPlacedIconSymbolIndex:v}=o;l>=0&&this.addIndicesForPlacedSymbol(this.text,l),u>=0&&u!==l&&this.addIndicesForPlacedSymbol(this.text,u),h>=0&&h!==u&&h!==l&&this.addIndicesForPlacedSymbol(this.text,h),m>=0&&this.addIndicesForPlacedSymbol(this.text,m),_>=0&&this.addIndicesForPlacedSymbol(this.icon,_),v>=0&&this.addIndicesForPlacedSymbol(this.icon,v)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}xr(K1,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),K1.MAX_GLYPHS=65535,K1.addDynamicAttributes=i0;var mg=K1;const $W=Zn([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:VW}=$W,jW=Zn([{name:"a_packed",components:4,type:"Float32"}]),{members:WW}=jW,HW=F1.types,GW=Math.cos(Math.PI/180*37.5);class Y1{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(i=>i.fqid),this.index=e.index,this.projection=e.projection,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(i=>{this.gradients[i.id]={}}),this.layoutVertexArray=new v2,this.layoutVertexArray2=new Mf,this.indexArray=new Oa,this.programConfigurations=new Lf(e.layers,e.zoom),this.segments=new ui,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(i=>i.isStateDependent()).map(i=>i.id)}populate(e,i,o,l){this.hasPattern=xE("line",this.layers,i);const u=this.layers[0].layout.get("line-sort-key"),h=[];for(const{feature:x,id:w,index:C,sourceLayerIndex:k}of e){const P=this.layers[0]._featureFilter.needGeometry,R=$f(x,P);if(!this.layers[0]._featureFilter.filter(new Gi(this.zoom),R,o))continue;const z=u?u.evaluate(R,{},o):void 0,B={id:w,properties:x.properties,type:x.type,sourceLayerIndex:k,index:C,geometry:P?R.geometry:Bc(x,o,l),patterns:{},sortKey:z};h.push(B)}u&&h.sort((x,w)=>x.sortKey-w.sortKey);const{lineAtlas:m,featureIndex:_}=i,v=this.addConstantDashes(m);for(const x of h){const{geometry:w,index:C,sourceLayerIndex:k}=x;if(v&&this.addFeatureDashes(x,m),this.hasPattern){const P=bE("line",this.layers,x,this.zoom,i);this.patternFeatures.push(P)}else this.addFeature(x,w,C,o,m.positions,i.availableImages,i.brightness);_.insert(e[C].feature,w,C,k,this.index)}}addConstantDashes(e){let i=!1;for(const o of this.layers){const l=o.paint.get("line-dasharray").value,u=o.layout.get("line-cap").value;if(l.kind!=="constant"||u.kind!=="constant")i=!0;else{const h=u.value,m=l.value;if(!m)continue;e.addDash(m,h)}}return i}addFeatureDashes(e,i){const o=this.zoom;for(const l of this.layers){const u=l.paint.get("line-dasharray").value,h=l.layout.get("line-cap").value;if(u.kind==="constant"&&h.kind==="constant")continue;let m,_;if(u.kind==="constant"){if(m=u.value,!m)continue}else m=u.evaluate({zoom:o},e);_=h.kind==="constant"?h.value:h.evaluate({zoom:o},e),i.addDash(m,_),e.patterns[l.id]=i.getKey(m,_)}}update(e,i,o,l,u){const h=Object.keys(e).length!==0;h&&!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(e,i,h?this.stateDependentLayers:this.layers,o,l,u)}addFeatures(e,i,o,l,u,h){for(const m of this.patternFeatures)this.addFeature(m,m.geometry,m.index,i,o,l,h)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,WW)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,VW),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(e){if(e.properties&&e.properties.hasOwnProperty("mapbox_clip_start")&&e.properties.hasOwnProperty("mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}}addFeature(e,i,o,l,u,h,m){const _=this.layers[0].layout,v=_.get("line-join").evaluate(e,{}),x=_.get("line-cap").evaluate(e,{}),w=_.get("line-miter-limit"),C=_.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(const k of i)this.addLine(k,e,v,x,w,C);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,o,u,h,l,m)}addLine(e,i,o,l,u,h){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let B=0;B<e.length-1;B++)this.totalDistance+=e[B].dist(e[B+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const m=HW[i.type]==="Polygon";let _=e.length;for(;_>=2&&e[_-1].equals(e[_-2]);)_--;let v=0;for(;v<_-1&&e[v].equals(e[v+1]);)v++;if(_<(m?3:2))return;o==="bevel"&&(u=1.05);const x=this.overscaling<=16?15*Et/(512*this.overscaling):0,w=this.segments.prepareSegment(10*_,this.layoutVertexArray,this.indexArray);let C,k,P,R,z;this.e1=this.e2=-1,m&&(C=e[_-2],z=e[v].sub(C)._unit()._perp());for(let B=v;B<_;B++){if(P=B===_-1?m?e[v+1]:void 0:e[B+1],P&&e[B].equals(P))continue;z&&(R=z),C&&(k=C),C=e[B],z=P?P.sub(C)._unit()._perp():R,R=R||z;let H=R.add(z);H.x===0&&H.y===0||H._unit();const Z=R.x*z.x+R.y*z.y,Y=H.x*z.x+H.y*z.y,q=Y!==0?1/Y:1/0,ee=2*Math.sqrt(2-2*Y),ce=Y<GW&&k&&P,de=R.x*z.y-R.y*z.x>0;if(ce&&B>v){const Re=C.dist(k);if(Re>2*x){const ke=C.sub(C.sub(k)._mult(x/Re)._round());this.updateDistance(k,ke),this.addCurrentVertex(ke,R,0,0,w),k=ke}}const ge=k&&P;let ve=ge?o:m?"butt":l;if(ge&&ve==="round"&&(q<h?ve="miter":q<=2&&(ve="fakeround")),ve==="miter"&&q>u&&(ve="bevel"),ve==="bevel"&&(q>2&&(ve="flipbevel"),q<u&&(ve="miter")),k&&this.updateDistance(k,C),ve==="miter")H._mult(q),this.addCurrentVertex(C,H,0,0,w);else if(ve==="flipbevel"){if(q>100)H=z.mult(-1);else{const Re=q*R.add(z).mag()/R.sub(z).mag();H._perp()._mult(Re*(de?-1:1))}this.addCurrentVertex(C,H,0,0,w),this.addCurrentVertex(C,H.mult(-1),0,0,w)}else if(ve==="bevel"||ve==="fakeround"){const Re=-Math.sqrt(q*q-1),ke=de?Re:0,$e=de?0:Re;if(k&&this.addCurrentVertex(C,R,ke,$e,w),ve==="fakeround"){const Ie=Math.round(180*ee/Math.PI/20);for(let Qe=1;Qe<Ie;Qe++){let st=Qe/Ie;if(st!==.5){const Je=st-.5;st+=st*Je*(st-1)*((1.0904+Z*(Z*(3.55645-1.43519*Z)-3.2452))*Je*Je+(.848013+Z*(.215638*Z-1.06021)))}const ft=z.sub(R)._mult(st)._add(R)._unit()._mult(de?-1:1);this.addHalfVertex(C,ft.x,ft.y,!1,de,0,w)}}P&&this.addCurrentVertex(C,z,-ke,-$e,w)}else if(ve==="butt")this.addCurrentVertex(C,H,0,0,w);else if(ve==="square"){const Re=k?1:-1;k||this.addCurrentVertex(C,H,Re,Re,w),this.addCurrentVertex(C,H,0,0,w),k&&this.addCurrentVertex(C,H,Re,Re,w)}else ve==="round"&&(k&&(this.addCurrentVertex(C,R,0,0,w),this.addCurrentVertex(C,R,1,1,w,!0)),P&&(this.addCurrentVertex(C,z,-1,-1,w,!0),this.addCurrentVertex(C,z,0,0,w)));if(ce&&B<_-1){const Re=C.dist(P);if(Re>2*x){const ke=C.add(P.sub(C)._mult(x/Re)._round());this.updateDistance(C,ke),this.addCurrentVertex(ke,z,0,0,w),C=ke}}}}addCurrentVertex(e,i,o,l,u,h=!1){const m=i.y*l-i.x,_=-i.y-i.x*l;this.addHalfVertex(e,i.x+i.y*o,i.y-i.x*o,h,!1,o,u),this.addHalfVertex(e,m,_,h,!0,-l,u)}addHalfVertex({x:e,y:i},o,l,u,h,m,_){this.layoutVertexArray.emplaceBack((e<<1)+(u?1:0),(i<<1)+(h?1:0),Math.round(63*o)+128,Math.round(63*l)+128,1+(m===0?0:m<0?-1:1),0,this.lineSoFar),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);const v=_.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,v),_.primitiveLength++),h?this.e2=v:this.e1=v}updateScaledDistance(){if(this.lineClips){const e=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=e*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(e,i){this.distance+=e.dist(i),this.updateScaledDistance()}}xr(Y1,"LineBucket",{omit:["layers","patternFeatures"]});class Ia{constructor(e,i,o,l){this.context=e,this.format=o,this.texture=e.gl.createTexture(),this.update(i,l)}update(e,i,o){const{width:l,height:u}=e,{context:h}=this,{gl:m}=h,{HTMLImageElement:_,HTMLCanvasElement:v,HTMLVideoElement:x,ImageData:w,ImageBitmap:C}=g;if(m.bindTexture(m.TEXTURE_2D,this.texture),h.pixelStoreUnpackFlipY.set(!1),h.pixelStoreUnpack.set(1),h.pixelStoreUnpackPremultiplyAlpha.set(this.format===m.RGBA&&(!i||i.premultiply!==!1)),o||this.size&&this.size[0]===l&&this.size[1]===u){const{x:k,y:P}=o||{x:0,y:0};if(e instanceof _||e instanceof v||e instanceof x||e instanceof w||C&&e instanceof C)m.texSubImage2D(m.TEXTURE_2D,0,k,P,m.RGBA,m.UNSIGNED_BYTE,e);else{let R=this.format,z=m.UNSIGNED_BYTE;this.format===m.R32F&&(R=m.RED,z=m.FLOAT),m.texSubImage2D(m.TEXTURE_2D,0,k,P,l,u,R,z,e.data)}}else if(this.size=[l,u],e instanceof _||e instanceof v||e instanceof x||e instanceof w||C&&e instanceof C){let k=this.format;this.format===m.R8&&(k=m.RED),m.texImage2D(m.TEXTURE_2D,0,this.format,k,m.UNSIGNED_BYTE,e)}else{let k=this.format,P=this.format,R=m.UNSIGNED_BYTE;this.format===m.DEPTH_COMPONENT&&(k=m.DEPTH_COMPONENT16,R=m.UNSIGNED_SHORT),this.format===m.R32F&&(R=m.FLOAT,P=m.RED),m.texImage2D(m.TEXTURE_2D,0,k,l,u,0,P,R,e.data)}this.useMipmap=!!(i&&i.useMipmap),this.useMipmap&&m.generateMipmap(m.TEXTURE_2D)}bind(e,i){const{context:o}=this,{gl:l}=o;l.bindTexture(l.TEXTURE_2D,this.texture),e!==this.minFilter&&(l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MAG_FILTER,e),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MIN_FILTER,this.useMipmap?e===l.NEAREST?l.NEAREST_MIPMAP_NEAREST:l.LINEAR_MIPMAP_NEAREST:e),this.minFilter=e),i!==this.wrapS&&(l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_S,i),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_T,i),this.wrapS=i)}bindExtraParam(e,i,o,l){const{context:u}=this,{gl:h}=u;h.bindTexture(h.TEXTURE_2D,this.texture),i!==this.magFilter&&(h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MAG_FILTER,i),this.magFilter=i),e!==this.minFilter&&(h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MIN_FILTER,this.useMipmap?e===h.NEAREST?h.NEAREST_MIPMAP_NEAREST:h.LINEAR_MIPMAP_NEAREST:e),this.minFilter=e),o!==this.wrapS&&(h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_S,o),this.wrapS=o),l!==this.wrapT&&(h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_T,l),this.wrapT=l)}destroy(){const{gl:e}=this.context;e.deleteTexture(this.texture),this.texture=null}}class J1{constructor(e,i){this.context=e,this.texture=i}bind(e,i){const{context:o}=this,{gl:l}=o;l.bindTexture(l.TEXTURE_2D,this.texture),e!==this.minFilter&&(l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MAG_FILTER,e),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MIN_FILTER,e),this.minFilter=e),i!==this.wrapS&&(l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_S,i),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_T,i),this.wrapS=i)}}const yl=32,Nc=33,qf=new Uint16Array(8184);for(let r=0;r<2046;r++){let e=r+2,i=0,o=0,l=0,u=0,h=0,m=0;for(1&e?l=u=h=yl:i=o=m=yl;(e>>=1)>1;){const v=i+l>>1,x=o+u>>1;1&e?(l=i,u=o,i=h,o=m):(i=l,o=u,l=h,u=m),h=v,m=x}const _=4*r;qf[_+0]=i,qf[_+1]=o,qf[_+2]=l,qf[_+3]=u}const Uc=new Uint16Array(2178),Xf=new Uint8Array(1089),Q1=new Uint16Array(1089);function EF(r){return r===0?-.03125:r===32?.03125:0}var NE=Zn([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);const TF={type:2,extent:Et,loadGeometry:()=>[[new D(0,0),new D(Et+1,0),new D(Et+1,Et+1),new D(0,Et+1),new D(0,0)]]};class gg{constructor(e,i,o,l,u){this.tileID=e,this.uid=fe(),this.uses=0,this.tileSize=i,this.tileZoom=o,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=u,l&&l.style&&(this._lastUpdatedBrightness=l.style.getBrightness()),this.expiredRequestCount=0,this.state="loading",l&&l.transform&&(this.projection=l.transform.projection)}registerFadeDuration(e){const i=e+this.timeAdded;i<Jr.now()||this.fadeEndTime&&i<this.fadeEndTime||(this.fadeEndTime=i)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}get tileTransform(){return this._tileTransform||(this._tileTransform=cd(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(e,i,o){if(this.unloadVectorData(),this.state="loaded",e){e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(l,u){const h={};if(!u)return h;for(const m of l){const _=m.layerIds.map(v=>u.getLayer(v)).filter(Boolean);if(_.length!==0){m.layers=_,m.stateDependentLayerIds&&(m.stateDependentLayers=m.stateDependentLayerIds.map(v=>_.filter(x=>x.id===v)[0]));for(const v of _)h[v.fqid]=m}}return h}(e.buckets,i.style),this.hasSymbolBuckets=!1;for(const l in this.buckets){const u=this.buckets[l];if(u instanceof mg){if(this.hasSymbolBuckets=!0,!o)break;u.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const l in this.buckets){const u=this.buckets[l];if(u instanceof mg&&u.hasRTLText){this.hasRTLText=!0,pl.isLoading()||pl.isLoaded()||p2()!=="deferred"||s4();break}}this.queryPadding=0;for(const l in this.buckets){const u=this.buckets[l],h=i.style.getOwnLayer(l);if(!h)continue;const m=h.queryRadius(u);this.queryPadding=Math.max(this.queryPadding,m)}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage),e.lineAtlas&&(this.lineAtlas=e.lineAtlas),this._lastUpdatedBrightness=e.brightness}else this.collisionBoxArray=new F2}unloadVectorData(){if(this.hasData()){for(const e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(e){return this.buckets[e.fqid]}upload(e){for(const o in this.buckets){const l=this.buckets[o];l.uploadPending()&&l.upload(e)}const i=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Ia(e,this.imageAtlas.image,i.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Ia(e,this.glyphAtlasImage,i.ALPHA),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new Ia(e,this.lineAtlas.image,i.ALPHA),this.lineAtlas.uploaded=!0)}prepare(e,i,o){if(this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture,o),!i||!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData)return;const l=i.style.getBrightness();(this._lastUpdatedBrightness||l)&&(this._lastUpdatedBrightness&&l&&Math.abs(this._lastUpdatedBrightness-l)<.001||(this._lastUpdatedBrightness=l,this.updateBuckets(void 0,i)))}queryRenderedFeatures(e,i,o,l,u,h,m,_){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({tileResult:l,pixelPosMatrix:m,transform:h,params:u,tileTransform:this.tileTransform},e,i,o):{}}querySourceFeatures(e,i){const o=this.latestFeatureIndex;if(!o||!o.rawTileData)return;const l=o.loadVTLayers(),u=i?i.sourceLayer:"",h=l._geojsonTileLayer||l[u];if(!h)return;const m=Kv(i&&i.filter),{z:_,x:v,y:x}=this.tileID.canonical,w={z:_,x:v,y:x};for(let C=0;C<h.length;C++){const k=h.feature(C);if(m.needGeometry){const z=$f(k,!0);if(!m.filter(new Gi(this.tileID.overscaledZ),z,this.tileID.canonical))continue}else if(!m.filter(new Gi(this.tileID.overscaledZ),k))continue;const P=o.getId(k,u),R=new DM(k,_,v,x,P);R.tile=w,e.push(R)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}bucketsLoaded(){for(const e in this.buckets)if(this.buckets[e].uploadPending())return!1;return!0}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(e){const i=this.expirationTime;if(e.cacheControl){const o=Be(e.cacheControl);o["max-age"]&&(this.expirationTime=Date.now()+1e3*o["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){const o=Date.now();let l=!1;if(this.expirationTime>o)l=!1;else if(i)if(this.expirationTime<i)l=!0;else{const u=this.expirationTime-i;u?this.expirationTime=o+Math.max(u,3e4):l=!0}else l=!0;l?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(e,i){this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&Object.keys(e).length!==0&&i&&this.updateBuckets(e,i)}updateBuckets(e,i){if(!this.latestFeatureIndex)return;const o=this.latestFeatureIndex.loadVTLayers(),l=i.style.listImages(),u=i.style.getBrightness();for(const h in this.buckets){if(!i.style.hasLayer(h))continue;const m=this.buckets[h],_=m.layers[0].sourceLayer||"_geojsonTileLayer",v=o[_];let x={};if(e&&(x=e[_],!v||!x||Object.keys(x).length===0))continue;if(m.update(x,v,l,this.imageAtlas&&this.imageAtlas.patternPositions||{},u),m instanceof Y1||m instanceof I1){const C=i.style.getOwnSourceCache(m.layers[0].source);i._terrain&&i._terrain.enabled&&C&&m.programConfigurations.needsUpload&&i._terrain._clearRenderCacheForTile(C.id,this.tileID)}const w=i&&i.style&&i.style.getOwnLayer(h);w&&(this.queryPadding=Math.max(this.queryPadding,w.queryRadius(m)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<Jr.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(e){this.symbolFadeHoldUntil=Jr.now()+e}setTexture(e,i){const o=i.context,l=o.gl;this.texture=this.texture||i.getTileTexture(e.width),this.texture?this.texture.update(e,{useMipmap:!0}):(this.texture=new Ia(o,e,l.RGBA,{useMipmap:!0}),this.texture.bind(l.LINEAR,l.CLAMP_TO_EDGE))}setDependencies(e,i){const o={};for(const l of i)o[l]=!0;this.dependencies[e]=o}hasDependency(e,i){for(const o of e){const l=this.dependencies[o];if(l){for(const u of i)if(l[u])return!0}}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(e,i){if(!i||i.name==="mercator"||this._tileDebugBuffer)return;const o=Bc(TF,this.tileID.canonical,this.tileTransform)[0],l=new Es,u=new Xm;for(let h=0;h<o.length;h++){const{x:m,y:_}=o[h];l.emplaceBack(m,_),u.emplaceBack(h)}u.emplaceBack(0),this._tileDebugIndexBuffer=e.createIndexBuffer(u),this._tileDebugBuffer=e.createVertexBuffer(l,Bf.members),this._tileDebugSegments=ui.simpleSegment(0,0,l.length,u.length)}_makeTileBoundsBuffers(e,i){if(this._tileBoundsBuffer||!i||i.name==="mercator")return;const o=Bc(TF,this.tileID.canonical,this.tileTransform)[0];let l,u;if(this.isRaster){const h=function(m,_){const v=cd(m,_),x=Math.pow(2,m.z);for(let z=0;z<Nc;z++)for(let B=0;B<Nc;B++){const H=Ss((m.x+(B+EF(B))/yl)/x),Z=ka((m.y+(z+EF(z))/yl)/x),Y=_.project(H,Z),q=z*Nc+B;Uc[2*q+0]=Math.round((Y.x*v.scale-v.x)*Et),Uc[2*q+1]=Math.round((Y.y*v.scale-v.y)*Et)}Xf.fill(0),Q1.fill(0);for(let z=2045;z>=0;z--){const B=4*z,H=qf[B+0],Z=qf[B+1],Y=qf[B+2],q=qf[B+3],ee=H+Y>>1,ce=Z+q>>1,de=ee+ce-Z,ge=ce+H-ee,ve=Z*Nc+H,Re=q*Nc+Y,ke=ce*Nc+ee,$e=Math.hypot((Uc[2*ve+0]+Uc[2*Re+0])/2-Uc[2*ke+0],(Uc[2*ve+1]+Uc[2*Re+1])/2-Uc[2*ke+1])>=16;Xf[ke]=Xf[ke]||($e?1:0),z<1022&&(Xf[ke]=Xf[ke]||Xf[(Z+ge>>1)*Nc+(H+de>>1)]||Xf[(q+ge>>1)*Nc+(Y+de>>1)])}const w=new td,C=new Oa;let k=0;function P(z,B){const H=B*Nc+z;return Q1[H]===0&&(w.emplaceBack(Uc[2*H+0],Uc[2*H+1],z*Et/yl,B*Et/yl),Q1[H]=++k),Q1[H]-1}function R(z,B,H,Z,Y,q){const ee=z+H>>1,ce=B+Z>>1;if(Math.abs(z-Y)+Math.abs(B-q)>1&&Xf[ce*Nc+ee])R(Y,q,z,B,ee,ce),R(H,Z,Y,q,ee,ce);else{const de=P(z,B),ge=P(H,Z),ve=P(Y,q);C.emplaceBack(de,ge,ve)}}return R(0,0,yl,yl,yl,0),R(yl,yl,0,0,0,yl),{vertices:w,indices:C}}(this.tileID.canonical,i);l=h.vertices,u=h.indices}else{l=new td,u=new Oa;for(const{x:m,y:_}of o)l.emplaceBack(m,_,0,0);const h=k1(l.int16,void 0,4);for(let m=0;m<h.length;m+=3)u.emplaceBack(h[m],h[m+1],h[m+2])}this._tileBoundsBuffer=e.createVertexBuffer(l,NE.members),this._tileBoundsIndexBuffer=e.createIndexBuffer(u),this._tileBoundsSegments=ui.simpleSegment(0,0,l.length,u.length)}_makeGlobeTileDebugBuffers(e,i){const o=i.projection;if(!o||o.name!=="globe"||i.freezeTileCoverage)return;const l=this.tileID.canonical,u=od(ZI(l,i)),h=qa(i.zoom);let m;h>0&&(m=dt.invert(new Float64Array(16),i.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(e,l,i,u,m,h),this._makeGlobeTileDebugTextBuffer(e,l,i,u,m,h)}_globePoint(e,i,o,l,u,h,m){let _=tg(e,i,o);if(h){const v=1<<o.z,x=Xa(l.center.lng),w=oo(l.center.lat),C=(o.x+.5)/v-x;let k=0;C>.5?k=-1:C<-.5&&(k=1);let P=(e/Et+o.x)/v+k,R=(i/Et+o.y)/v;P=(P-x)*l._pixelsPerMercatorPixel+x,R=(R-w)*l._pixelsPerMercatorPixel+w;const z=[P*l.worldSize,R*l.worldSize,0];We.transformMat4(z,z,h),_=Iu(_,z,m)}return We.transformMat4(_,_,u)}_makeGlobeTileDebugBorderBuffer(e,i,o,l,u,h){const m=new Es,_=new Xm,v=new n1,x=(C,k,P,R,z)=>{const B=(P-C)/(z-1),H=(R-k)/(z-1),Z=m.length;for(let Y=0;Y<z;Y++){const q=C+Y*B,ee=k+Y*H;m.emplaceBack(q,ee);const ce=this._globePoint(q,ee,i,o,l,u,h);v.emplaceBack(ce[0],ce[1],ce[2]),_.emplaceBack(Z+Y)}},w=Et;x(0,0,w,0,16),x(w,0,w,w,16),x(w,w,0,w,16),x(0,w,0,0,16),this._tileDebugIndexBuffer=e.createIndexBuffer(_),this._tileDebugBuffer=e.createVertexBuffer(m,Bf.members),this._globeTileDebugBorderBuffer=e.createVertexBuffer(v,VI.members),this._tileDebugSegments=ui.simpleSegment(0,0,m.length,_.length)}_makeGlobeTileDebugTextBuffer(e,i,o,l,u,h){const m=Et/4,_=new Es,v=new Oa,x=new n1,w=25;v.reserve(32),_.reserve(w),x.reserve(w);const C=(k,P)=>w*k+P;for(let k=0;k<w;k++){const P=k*m;for(let R=0;R<w;R++){const z=R*m;_.emplaceBack(z,P);const B=this._globePoint(z,P,i,o,l,u,h);x.emplaceBack(B[0],B[1],B[2])}}for(let k=0;k<4;k++)for(let P=0;P<4;P++){const R=C(k,P),z=C(k,P+1),B=C(k+1,P),H=C(k+1,P+1);v.emplaceBack(R,z,B),v.emplaceBack(B,z,H)}this._tileDebugTextIndexBuffer=e.createIndexBuffer(v),this._tileDebugTextBuffer=e.createVertexBuffer(_,Bf.members),this._globeTileDebugTextBuffer=e.createVertexBuffer(x,VI.members),this._tileDebugTextSegments=ui.simpleSegment(0,0,w,32)}}class qW{constructor(e,i){this.max=e,this.onRemove=i,this.reset()}reset(){for(const e in this.data)for(const i of this.data[e])i.timeout&&clearTimeout(i.timeout),this.onRemove(i.value);return this.data={},this.order=[],this}add(e,i,o){const l=e.wrapped().key;this.data[l]===void 0&&(this.data[l]=[]);const u={value:i,timeout:void 0};if(o!==void 0&&(u.timeout=setTimeout(()=>{this.remove(e,u)},o)),this.data[l].push(u),this.order.push(l),this.order.length>this.max){const h=this._getAndRemoveByKey(this.order[0]);h&&this.onRemove(h)}return this}has(e){return e.wrapped().key in this.data}getAndRemove(e){return this.has(e)?this._getAndRemoveByKey(e.wrapped().key):null}_getAndRemoveByKey(e){const i=this.data[e].shift();return i.timeout&&clearTimeout(i.timeout),this.data[e].length===0&&delete this.data[e],this.order.splice(this.order.indexOf(e),1),i.value}getByKey(e){const i=this.data[e];return i?i[0].value:null}get(e){return this.has(e)?this.data[e.wrapped().key][0].value:null}remove(e,i){if(!this.has(e))return this;const o=e.wrapped().key,l=i===void 0?0:this.data[o].indexOf(i),u=this.data[o][l];return this.data[o].splice(l,1),u.timeout&&clearTimeout(u.timeout),this.data[o].length===0&&delete this.data[o],this.onRemove(u.value),this.order.splice(this.order.indexOf(o),1),this}setMaxSize(e){for(this.max=e;this.order.length>this.max;){const i=this._getAndRemoveByKey(this.order[0]);i&&this.onRemove(i)}return this}filter(e){const i=[];for(const o in this.data)for(const l of this.data[o])e(l.value)||i.push(l);for(const o of i)this.remove(o.value.tileID,o)}}class Zf{constructor(e,i,o,l){this.id=Zf.uniqueIdxCounter,Zf.uniqueIdxCounter++,this.context=e;const u=e.gl;this.buffer=u.createBuffer(),this.dynamicDraw=!!o,this.context.unbindVAO(),e.bindElementBuffer.set(this.buffer),u.bufferData(u.ELEMENT_ARRAY_BUFFER,i.arrayBuffer,this.dynamicDraw?u.DYNAMIC_DRAW:u.STATIC_DRAW),this.dynamicDraw||l||i.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(e){this.id=Zf.uniqueIdxCounter,Zf.uniqueIdxCounter++;const i=this.context.gl;this.context.unbindVAO(),this.bind(),i.bufferSubData(i.ELEMENT_ARRAY_BUFFER,0,e.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}Zf.uniqueIdxCounter=0;const XW={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class ZW{constructor(e,i,o,l,u,h){this.length=i.length,this.attributes=o,this.itemSize=i.bytesPerElement,this.dynamicDraw=l,this.instanceCount=h,this.context=e;const m=e.gl;this.buffer=m.createBuffer(),e.bindVertexBuffer.set(this.buffer),m.bufferData(m.ARRAY_BUFFER,i.arrayBuffer,this.dynamicDraw?m.DYNAMIC_DRAW:m.STATIC_DRAW),this.dynamicDraw||u||i.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(e){const i=this.context.gl;this.bind(),i.bufferSubData(i.ARRAY_BUFFER,0,e.arrayBuffer)}enableAttributes(e,i){for(let o=0;o<this.attributes.length;o++){const l=i.attributes[this.attributes[o].name];l!==void 0&&e.enableVertexAttribArray(l)}}setVertexAttribPointers(e,i,o){for(let l=0;l<this.attributes.length;l++){const u=this.attributes[l],h=i.attributes[u.name];h!==void 0&&e.vertexAttribPointer(h,u.components,e[XW[u.type]],!1,this.itemSize,u.offset+this.itemSize*(o||0))}}setVertexAttribDivisor(e,i,o){for(let l=0;l<this.attributes.length;l++){const u=i.attributes[this.attributes[l].name];u!==void 0&&this.instanceCount&&this.instanceCount>0&&e.vertexAttribDivisor(u,o)}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class Ri{constructor(e){this.gl=e.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(e){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class KW extends Ri{getDefault(){return hn.transparent}set(e){const i=this.current;(e.r!==i.r||e.g!==i.g||e.b!==i.b||e.a!==i.a||this.dirty)&&(this.gl.clearColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}}class YW extends Ri{getDefault(){return 1}set(e){(e!==this.current||this.dirty)&&(this.gl.clearDepth(e),this.current=e,this.dirty=!1)}}class JW extends Ri{getDefault(){return 0}set(e){(e!==this.current||this.dirty)&&(this.gl.clearStencil(e),this.current=e,this.dirty=!1)}}class QW extends Ri{getDefault(){return[!0,!0,!0,!0]}set(e){const i=this.current;(e[0]!==i[0]||e[1]!==i[1]||e[2]!==i[2]||e[3]!==i[3]||this.dirty)&&(this.gl.colorMask(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}class eH extends Ri{getDefault(){return!0}set(e){(e!==this.current||this.dirty)&&(this.gl.depthMask(e),this.current=e,this.dirty=!1)}}class tH extends Ri{getDefault(){return 255}set(e){(e!==this.current||this.dirty)&&(this.gl.stencilMask(e),this.current=e,this.dirty=!1)}}class rH extends Ri{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(e){const i=this.current;(e.func!==i.func||e.ref!==i.ref||e.mask!==i.mask||this.dirty)&&(this.gl.stencilFunc(e.func,e.ref,e.mask),this.current=e,this.dirty=!1)}}class nH extends Ri{getDefault(){const e=this.gl;return[e.KEEP,e.KEEP,e.KEEP]}set(e){const i=this.current;(e[0]!==i[0]||e[1]!==i[1]||e[2]!==i[2]||this.dirty)&&(this.gl.stencilOp(e[0],e[1],e[2]),this.current=e,this.dirty=!1)}}class iH extends Ri{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const i=this.gl;e?i.enable(i.STENCIL_TEST):i.disable(i.STENCIL_TEST),this.current=e,this.dirty=!1}}class aH extends Ri{getDefault(){return[0,1]}set(e){const i=this.current;(e[0]!==i[0]||e[1]!==i[1]||this.dirty)&&(this.gl.depthRange(e[0],e[1]),this.current=e,this.dirty=!1)}}class oH extends Ri{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const i=this.gl;e?i.enable(i.DEPTH_TEST):i.disable(i.DEPTH_TEST),this.current=e,this.dirty=!1}}class sH extends Ri{getDefault(){return this.gl.LESS}set(e){(e!==this.current||this.dirty)&&(this.gl.depthFunc(e),this.current=e,this.dirty=!1)}}class lH extends Ri{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const i=this.gl;e?i.enable(i.BLEND):i.disable(i.BLEND),this.current=e,this.dirty=!1}}class cH extends Ri{getDefault(){const e=this.gl;return[e.ONE,e.ZERO,e.ONE,e.ZERO]}set(e){const i=this.current;(e[0]!==i[0]||e[1]!==i[1]||e[2]!==i[2]||e[3]!==i[3]||this.dirty)&&(this.gl.blendFuncSeparate(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}class uH extends Ri{getDefault(){return hn.transparent}set(e){const i=this.current;(e.r!==i.r||e.g!==i.g||e.b!==i.b||e.a!==i.a||this.dirty)&&(this.gl.blendColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}}class fH extends Ri{getDefault(){return this.gl.FUNC_ADD}set(e){(e!==this.current||this.dirty)&&(this.gl.blendEquationSeparate(e,e),this.current=e,this.dirty=!1)}}class hH extends Ri{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const i=this.gl;e?i.enable(i.CULL_FACE):i.disable(i.CULL_FACE),this.current=e,this.dirty=!1}}class dH extends Ri{getDefault(){return this.gl.BACK}set(e){(e!==this.current||this.dirty)&&(this.gl.cullFace(e),this.current=e,this.dirty=!1)}}class pH extends Ri{getDefault(){return this.gl.CCW}set(e){(e!==this.current||this.dirty)&&(this.gl.frontFace(e),this.current=e,this.dirty=!1)}}let mH=class extends Ri{getDefault(){return null}set(r){(r!==this.current||this.dirty)&&(this.gl.useProgram(r),this.current=r,this.dirty=!1)}};class gH extends Ri{getDefault(){return this.gl.TEXTURE0}set(e){(e!==this.current||this.dirty)&&(this.gl.activeTexture(e),this.current=e,this.dirty=!1)}}class _H extends Ri{getDefault(){const e=this.gl;return[0,0,e.drawingBufferWidth,e.drawingBufferHeight]}set(e){const i=this.current;(e[0]!==i[0]||e[1]!==i[1]||e[2]!==i[2]||e[3]!==i[3]||this.dirty)&&(this.gl.viewport(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}class vH extends Ri{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const i=this.gl;i.bindFramebuffer(i.FRAMEBUFFER,e),this.current=e,this.dirty=!1}}class yH extends Ri{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const i=this.gl;i.bindRenderbuffer(i.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class xH extends Ri{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const i=this.gl;i.bindTexture(i.TEXTURE_2D,e),this.current=e,this.dirty=!1}}class bH extends Ri{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const i=this.gl;i.bindBuffer(i.ARRAY_BUFFER,e),this.current=e,this.dirty=!1}}class wH extends Ri{getDefault(){return null}set(e){const i=this.gl;i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,e),this.current=e,this.dirty=!1}}class EH extends Ri{getDefault(){return null}set(e){this.gl&&(e!==this.current||this.dirty)&&(this.gl.bindVertexArray(e),this.current=e,this.dirty=!1)}}class TH extends Ri{getDefault(){return 4}set(e){if(e===this.current&&!this.dirty)return;const i=this.gl;i.pixelStorei(i.UNPACK_ALIGNMENT,e),this.current=e,this.dirty=!1}}class SH extends Ri{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const i=this.gl;i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e),this.current=e,this.dirty=!1}}class CH extends Ri{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const i=this.gl;i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,e),this.current=e,this.dirty=!1}}class UE extends Ri{constructor(e,i){super(e),this.context=e,this.parent=i}getDefault(){return null}}class AH extends UE{setDirty(){this.dirty=!0}set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const i=this.gl;i.framebufferTexture2D(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,e,0),this.current=e,this.dirty=!1}}class SF extends UE{attachment(){return this.gl.DEPTH_ATTACHMENT}set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const i=this.gl;i.framebufferRenderbuffer(i.FRAMEBUFFER,this.attachment(),i.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class kH extends UE{attachment(){return this.gl.DEPTH_ATTACHMENT}set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const i=this.gl;i.framebufferTexture2D(i.FRAMEBUFFER,this.attachment(),i.TEXTURE_2D,e,0),this.current=e,this.dirty=!1}}class IH extends SF{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class MH{constructor(e,i,o,l,u){this.context=e,this.width=i,this.height=o;const h=this.framebuffer=e.gl.createFramebuffer();l&&(this.colorAttachment=new AH(e,h)),u&&(this.depthAttachmentType=u,this.depthAttachment=u==="renderbuffer"?new SF(e,h):new kH(e,h))}destroy(){const e=this.context.gl;if(this.colorAttachment){const i=this.colorAttachment.get();i&&e.deleteTexture(i)}if(this.depthAttachment&&this.depthAttachmentType)if(this.depthAttachmentType==="renderbuffer"){const i=this.depthAttachment.get();i&&e.deleteRenderbuffer(i)}else{const i=this.depthAttachment.get();i&&e.deleteTexture(i)}e.deleteFramebuffer(this.framebuffer)}}class Zr{constructor(e,i,o){this.func=e,this.mask=i,this.range=o}}Zr.ReadOnly=!1,Zr.ReadWrite=!0,Zr.disabled=new Zr(519,Zr.ReadOnly,[0,1]);const $E=7680;class wn{constructor(e,i,o,l,u,h){this.test=e,this.ref=i,this.mask=o,this.fail=l,this.depthFail=u,this.pass=h}}wn.disabled=new wn({func:519,mask:0},0,0,$E,$E,$E);const ey=771;class Nn{constructor(e,i,o,l){this.blendFunction=e,this.blendColor=i,this.mask=o,this.blendEquation=l}}Nn.Replace=[1,0,1,0],Nn.disabled=new Nn(Nn.Replace,hn.transparent,[!1,!1,!1,!1]),Nn.unblended=new Nn(Nn.Replace,hn.transparent,[!0,!0,!0,!0]),Nn.alphaBlended=new Nn([1,ey,1,ey],hn.transparent,[!0,!0,!0,!0]),Nn.multiply=new Nn([774,0,774,0],hn.transparent,[!0,!0,!0,!0]);const VE=1029,jE=2305;class Cn{constructor(e,i,o){this.enable=e,this.mode=i,this.frontFace=o}}Cn.disabled=new Cn(!1,VE,jE),Cn.backCCW=new Cn(!0,VE,jE),Cn.backCW=new Cn(!0,VE,2304),Cn.frontCW=new Cn(!0,1028,2304),Cn.frontCCW=new Cn(!0,1028,jE);class FH{constructor(e){this.gl=e,this.clearColor=new KW(this),this.clearDepth=new YW(this),this.clearStencil=new JW(this),this.colorMask=new QW(this),this.depthMask=new eH(this),this.stencilMask=new tH(this),this.stencilFunc=new rH(this),this.stencilOp=new nH(this),this.stencilTest=new iH(this),this.depthRange=new aH(this),this.depthTest=new oH(this),this.depthFunc=new sH(this),this.blend=new lH(this),this.blendFunc=new cH(this),this.blendColor=new uH(this),this.blendEquation=new fH(this),this.cullFace=new hH(this),this.cullFaceSide=new dH(this),this.frontFace=new pH(this),this.program=new mH(this),this.activeTexture=new gH(this),this.viewport=new _H(this),this.bindFramebuffer=new vH(this),this.bindRenderbuffer=new yH(this),this.bindTexture=new xH(this),this.bindVertexBuffer=new bH(this),this.bindElementBuffer=new wH(this),this.bindVertexArrayOES=new EH(this),this.pixelStoreUnpack=new TH(this),this.pixelStoreUnpackPremultiplyAlpha=new SH(this),this.pixelStoreUnpackFlipY=new CH(this),this.extTextureFilterAnisotropic=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=e.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureFilterAnisotropicForceOff=!1,this.extStandardDerivativesForceOff=!1,this.extDebugRendererInfo=e.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=e.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=e.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),this.extTextureFloatLinear=e.getExtension("OES_texture_float_linear"),this.extRenderToTextureHalfFloat=e.getExtension("EXT_color_buffer_half_float"),this.extTimerQuery=e.getExtension("EXT_disjoint_timer_query_webgl2"),this.maxTextureSize=e.getParameter(e.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArrayOES.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(e,i,o){return new Zf(this,e,i,o)}createVertexBuffer(e,i,o,l,u){return new ZW(this,e,i,o,l,u)}createRenderbuffer(e,i,o){const l=this.gl,u=l.createRenderbuffer();return this.bindRenderbuffer.set(u),l.renderbufferStorage(l.RENDERBUFFER,e,i,o),this.bindRenderbuffer.set(null),u}createFramebuffer(e,i,o,l){return new MH(this,e,i,o,l)}clear({color:e,depth:i,stencil:o,colorMask:l}){const u=this.gl;let h=0;e&&(h|=u.COLOR_BUFFER_BIT,this.clearColor.set(e),this.colorMask.set(l||[!0,!0,!0,!0])),i!==void 0&&(h|=u.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(i),this.depthMask.set(!0)),o!==void 0&&(h|=u.STENCIL_BUFFER_BIT,this.clearStencil.set(o),this.stencilMask.set(255)),u.clear(h)}setCullFace(e){e.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(e.mode),this.frontFace.set(e.frontFace))}setDepthMode(e){e.func!==this.gl.ALWAYS||e.mask?(this.depthTest.set(!0),this.depthFunc.set(e.func),this.depthMask.set(e.mask),this.depthRange.set(e.range)):this.depthTest.set(!1)}setStencilMode(e){e.test.func!==this.gl.ALWAYS||e.mask?(this.stencilTest.set(!0),this.stencilMask.set(e.mask),this.stencilOp.set([e.fail,e.depthFail,e.pass]),this.stencilFunc.set({func:e.test.func,ref:e.ref,mask:e.test.mask})):this.stencilTest.set(!1)}setColorMode(e){te(e.blendFunction,Nn.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(e.blendFunction),this.blendColor.set(e.blendColor),e.blendEquation?this.blendEquation.set(e.blendEquation):this.blendEquation.setDefault()),this.colorMask.set(e.mask)}unbindVAO(){this.bindVertexArrayOES.set(null)}}class Kl extends Ln{constructor(e,i,o){super(),this.id=e,this._onlySymbols=o,i.on("data",l=>{l.dataType==="source"&&l.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&l.dataType==="source"&&l.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))}),i.on("error",()=>{this._sourceErrored=!0}),this._source=i,this._tiles={},this._cache=new qW(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=i.minTileCacheSize,this._maxTileCacheSize=i.maxTileCacheSize,this._loadedParentTiles={},this.castsShadows=!1,this._coveredTiles={},this._shadowCasterTiles={},this._state=new Qj,this._isRaster=this._source.type==="raster"||this._source.type==="raster-dem"||this._source.type==="custom"&&this._source._dataType==="raster"}onAdd(e){this.map=e,this._minTileCacheSize=this._minTileCacheSize===void 0&&e?e._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=this._maxTileCacheSize===void 0&&e?e._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const e in this._tiles){const i=this._tiles[e];if(i.state!=="errored"&&(i.state!=="loaded"||!i.bucketsLoaded()))return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const e=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,e&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(e,i){return e.isSymbolTile=this._onlySymbols,e.isExtraShadowCaster=this._shadowCasterTiles[e.tileID.key],this._source.loadTile(e,i)}_unloadTile(e){if(this._source.unloadTile)return this._source.unloadTile(e,()=>{})}_abortTile(e){if(this._source.abortTile)return this._source.abortTile(e,()=>{})}serialize(){return this._source.serialize()}prepare(e){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const i in this._tiles){const o=this._tiles[i];o.upload(e),o.prepare(this.map.style.imageManager,this.map?this.map.painter:null,this._source.scope)}}getIds(){return Ge(this._tiles).map(e=>e.tileID).sort(CF).map(e=>e.key)}getRenderableIds(e,i){const o=[];for(const l in this._tiles)this._isIdRenderable(+l,e,i)&&o.push(this._tiles[l]);return e?o.sort((l,u)=>{const h=l.tileID,m=u.tileID,_=new D(h.canonical.x,h.canonical.y)._rotate(this.transform.angle),v=new D(m.canonical.x,m.canonical.y)._rotate(this.transform.angle);return h.overscaledZ-m.overscaledZ||v.y-_.y||v.x-_.x}).map(l=>l.tileID.key):o.map(l=>l.tileID).sort(CF).map(l=>l.key)}hasRenderableParent(e){const i=this.findLoadedParent(e,0);return!!i&&this._isIdRenderable(i.tileID.key)}_isIdRenderable(e,i,o){return this._tiles[e]&&this._tiles[e].hasData()&&!this._coveredTiles[e]&&(i||!this._tiles[e].holdingForFade())&&(o||!this._shadowCasterTiles[e])}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const e in this._tiles)this._tiles[e].state!=="errored"&&this._reloadTile(+e,"reloading")}}_reloadTile(e,i){const o=this._tiles[e];o&&(o.state!=="loading"&&(o.state=i),this._loadTile(o,this._tileLoaded.bind(this,o,e,i)))}_tileLoaded(e,i,o,l){if(l)if(e.state="errored",l.status!==404)this._source.fire(new ar(l,{tile:e}));else if(this._source.type==="raster-dem"&&this.usedForTerrain&&this.map.painter.terrain){const u=this.map.painter.terrain;this.update(this.transform,u.getScaledDemTileSize(),!0),u.resetTileLookupCache(this.id)}else this.update(this.transform);else e.timeAdded=Jr.now(),o==="expired"&&(e.refreshedUponExpiration=!0),this._setTileReloadTimer(i,e),this._source.type==="raster-dem"&&e.dem&&this._backfillDEM(e),this._state.initializeTileState(e,this.map?this.map.painter:null),this._source.fire(new _t("data",{dataType:"source",tile:e,coord:e.tileID,sourceCacheId:this.id}))}_backfillDEM(e){const i=this.getRenderableIds();for(let l=0;l<i.length;l++){const u=i[l];if(e.neighboringTiles&&e.neighboringTiles[u]){const h=this.getTileByID(u);o(e,h),o(h,e)}}function o(l,u){if(!l.dem||l.dem.borderReady)return;l.needsHillshadePrepare=!0,l.needsDEMTextureUpload=!0;let h=u.tileID.canonical.x-l.tileID.canonical.x;const m=u.tileID.canonical.y-l.tileID.canonical.y,_=Math.pow(2,l.tileID.canonical.z),v=u.tileID.key;h===0&&m===0||Math.abs(m)>1||(Math.abs(h)>1&&(Math.abs(h+_)===1?h+=_:Math.abs(h-_)===1&&(h-=_)),u.dem&&l.dem&&(l.dem.backfillBorder(u.dem,h,m),l.neighboringTiles&&l.neighboringTiles[v]&&(l.neighboringTiles[v].backfilled=!0)))}}getTile(e){return this.getTileByID(e.key)}getTileByID(e){return this._tiles[e]}_retainLoadedChildren(e,i,o,l){for(const u in this._tiles){let h=this._tiles[u];if(l[u]||!h.hasData()||h.tileID.overscaledZ<=i||h.tileID.overscaledZ>o)continue;let m=h.tileID;for(;h&&h.tileID.overscaledZ>i+1;){const v=h.tileID.scaledTo(h.tileID.overscaledZ-1);h=this._tiles[v.key],h&&h.hasData()&&(m=v)}let _=m;for(;_.overscaledZ>i;)if(_=_.scaledTo(_.overscaledZ-1),e[_.key]){l[m.key]=m;break}}}findLoadedParent(e,i){if(e.key in this._loadedParentTiles){const o=this._loadedParentTiles[e.key];return o&&o.tileID.overscaledZ>=i?o:null}for(let o=e.overscaledZ-1;o>=i;o--){const l=e.scaledTo(o),u=this._getLoadedTile(l);if(u)return u}}_getLoadedTile(e){const i=this._tiles[e.key];return i&&i.hasData()?i:this._cache.getByKey(this._source.reparseOverscaled?e.wrapped().key:e.canonical.key)}updateCacheSize(e,i){i=i||this._source.tileSize;const o=Math.ceil(e.width/i)+1,l=Math.ceil(e.height/i)+1,u=Math.floor(o*l*5),h=typeof this._minTileCacheSize=="number"?Math.max(this._minTileCacheSize,u):u,m=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,h):h;this._cache.setMaxSize(m)}handleWrapJump(e){const i=Math.round((e-(this._prevLng===void 0?e:this._prevLng))/360);if(this._prevLng=e,i){const o={};for(const l in this._tiles){const u=this._tiles[l];u.tileID=u.tileID.unwrapTo(u.tileID.wrap+i),o[u.tileID.key]=u}this._tiles=o;for(const l in this._timers)clearTimeout(this._timers[l]),delete this._timers[l];for(const l in this._tiles)this._setTileReloadTimer(+l,this._tiles[l])}}update(e,i,o,l){if(this.transform=e,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!o)return;let u;if(this.updateCacheSize(e,i),this.transform.projection.name!=="globe"&&this.handleWrapJump(this.transform.center.lng),this._shadowCasterTiles={},this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?u=e.getVisibleUnwrappedCoordinates(this._source.tileID).map(_=>new Wn(_.canonical.z,_.wrap,_.canonical.z,_.canonical.x,_.canonical.y)):(u=e.coveringTiles({tileSize:i||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!o,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile&&(u=u.filter(_=>this._source.hasTile(_)))):u=[],u.length>0&&this.castsShadows&&l&&this.transform.projection.name!=="globe"&&!this.usedForTerrain&&!WE(this._source.type)){const _=e.coveringZoomLevel({tileSize:i||this._source.tileSize,roundZoom:this._source.roundZoom&&!o}),v=Math.min(_,this._source.maxzoom),x=e.extendTileCoverForShadows(u,l,v);for(const w of x)this._shadowCasterTiles[w.key]=!0,u.push(w)}const h=this._updateRetainedTiles(u);if(WE(this._source.type)&&u.length!==0){const _={},v={},x=Object.keys(h);for(const C of x){const k=h[C],P=this._tiles[C];if(!P||P.fadeEndTime&&P.fadeEndTime<=Jr.now())continue;const R=this.findLoadedParent(k,Math.max(k.overscaledZ-Kl.maxOverzooming,this._source.minzoom));R&&(this._addTile(R.tileID),_[R.tileID.key]=R.tileID),v[C]=k}const w=u[u.length-1].overscaledZ;for(const C in this._tiles){const k=this._tiles[C];if(h[C]||!k.hasData())continue;let P=k.tileID;for(;P.overscaledZ>w;){P=P.scaledTo(P.overscaledZ-1);const R=this._tiles[P.key];if(R&&R.hasData()&&v[P.key]){h[C]=k.tileID;break}}}for(const C in _)h[C]||(this._coveredTiles[C]=!0,h[C]=_[C])}for(const _ in h)this._tiles[_].clearFadeHold();const m=function(_,v){const x=[];for(const w in _)w in v||x.push(w);return x}(this._tiles,h);for(const _ of m){const v=this._tiles[_];v.hasSymbolBuckets&&!v.holdingForFade()?v.setHoldDuration(this.map._fadeDuration):v.hasSymbolBuckets&&!v.symbolFadeFinished()||this._removeTile(+_)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const e in this._tiles)this._tiles[e].holdingForFade()&&this._removeTile(+e)}_updateRetainedTiles(e){const i={};if(e.length===0)return i;const o={},l=e.reduce((v,x)=>Math.min(v,x.overscaledZ),1/0),u=e[0].overscaledZ,h=Math.max(u-Kl.maxOverzooming,this._source.minzoom),m=Math.max(u+Kl.maxUnderzooming,this._source.minzoom),_={};for(const v of e){const x=this._addTile(v);i[v.key]=v,x.hasData()||l<this._source.maxzoom&&(_[v.key]=v)}this._retainLoadedChildren(_,l,m,i);for(const v of e){let x=this._tiles[v.key];if(x.hasData())continue;if(v.canonical.z>=this._source.maxzoom){const C=v.children(this._source.maxzoom)[0],k=this.getTile(C);if(k&&k.hasData()){i[C.key]=C;continue}}else{const C=v.children(this._source.maxzoom);if(i[C[0].key]&&i[C[1].key]&&i[C[2].key]&&i[C[3].key])continue}let w=x.wasRequested();for(let C=v.overscaledZ-1;C>=h;--C){const k=v.scaledTo(C);if(o[k.key]||(o[k.key]=!0,x=this.getTile(k),!x&&w&&(x=this._addTile(k)),x&&(i[k.key]=k,w=x.wasRequested(),x.hasData())))break}}return i}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const e in this._tiles){const i=[];let o,l=this._tiles[e].tileID;for(;l.overscaledZ>0;){if(l.key in this._loadedParentTiles){o=this._loadedParentTiles[l.key];break}i.push(l.key);const u=l.scaledTo(l.overscaledZ-1);if(o=this._getLoadedTile(u),o)break;l=u}for(const u of i)this._loadedParentTiles[u]=o}}_addTile(e){let i=this._tiles[e.key];if(i)return i.isExtraShadowCaster!==!0||this._shadowCasterTiles[e.key]||this._reloadTile(e.key,"reloading"),i;i=this._cache.getAndRemove(e),i&&(this._setTileReloadTimer(e.key,i),i.tileID=e,this._state.initializeTileState(i,this.map?this.map.painter:null),this._cacheTimers[e.key]&&(clearTimeout(this._cacheTimers[e.key]),delete this._cacheTimers[e.key],this._setTileReloadTimer(e.key,i)));const o=!!i;if(!o){const l=this.map?this.map.painter:null;i=new gg(e,this._source.tileSize*e.overscaleFactor(),this.transform.tileZoom,l,this._isRaster),this._loadTile(i,this._tileLoaded.bind(this,i,e.key,i.state))}return i?(i.uses++,this._tiles[e.key]=i,o||this._source.fire(new _t("dataloading",{tile:i,coord:i.tileID,dataType:"source"})),i):null}_setTileReloadTimer(e,i){e in this._timers&&(clearTimeout(this._timers[e]),delete this._timers[e]);const o=i.getExpiryTimeout();o&&(this._timers[e]=setTimeout(()=>{this._reloadTile(e,"expired"),delete this._timers[e]},o))}_removeTile(e){const i=this._tiles[e];i&&(i.uses--,delete this._tiles[e],this._timers[e]&&(clearTimeout(this._timers[e]),delete this._timers[e]),i.uses>0||(i.hasData()&&i.state!=="reloading"?this._cache.add(i.tileID,i,i.getExpiryTimeout()):(i.aborted=!0,this._abortTile(i),this._unloadTile(i))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const e in this._tiles)this._removeTile(+e);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(e,i,o){const l=[],u=this.transform;if(!u)return l;const h=u.projection.name==="globe",m=Xa(u.center.lng);for(const _ in this._tiles){const v=this._tiles[_];if(o&&v.clearQueryDebugViz(),v.holdingForFade())continue;let x;if(h){const w=v.tileID.canonical;if(w.z===0){const C=[Math.abs(Oe(m,..._g(w,-1))-m),Math.abs(Oe(m,..._g(w,1))-m)];x=[0,2*C.indexOf(Math.min(...C))-1]}else{const C=[Math.abs(Oe(m,..._g(w,-1))-m),Math.abs(Oe(m,..._g(w,0))-m),Math.abs(Oe(m,..._g(w,1))-m)];x=[C.indexOf(Math.min(...C))-1]}}else x=[0];for(const w of x){const C=e.containsTile(v,u,i,w);C&&l.push(C)}}return l}getShadowCasterCoordinates(){return this._getRenderableCoordinates(!1,!0)}getVisibleCoordinates(e){return this._getRenderableCoordinates(e)}_getRenderableCoordinates(e,i){const o=this.getRenderableIds(e,i).map(l=>this._tiles[l].tileID);for(const l of o)l.projMatrix=this.transform.calculateProjMatrix(l.toUnwrapped());return o}sortCoordinatesByDistance(e){const i=e.slice(),o=this.transform._camera.position,l=this.transform._camera.forward(),u={};for(const h of i){const m=1/(1<<h.canonical.z);u[h.key]=((h.canonical.x+.5)*m+h.wrap-o[0])*l[0]+((h.canonical.y+.5)*m-o[1])*l[1]-o[2]*l[2]}return i.sort((h,m)=>u[h.key]-u[m.key]),i}hasTransition(){if(this._source.hasTransition())return!0;if(WE(this._source.type))for(const e in this._tiles){const i=this._tiles[e];if(i.fadeEndTime!==void 0&&i.fadeEndTime>=Jr.now())return!0}return!1}setFeatureState(e,i,o){this._state.updateState(e=e||"_geojsonTileLayer",i,o)}removeFeatureState(e,i,o){this._state.removeFeatureState(e=e||"_geojsonTileLayer",i,o)}getFeatureState(e,i){return this._state.getState(e=e||"_geojsonTileLayer",i)}setDependencies(e,i,o){const l=this._tiles[e];l&&l.setDependencies(i,o)}reloadTilesForDependencies(e,i){for(const o in this._tiles)this._tiles[o].hasDependency(e,i)&&this._reloadTile(+o,"reloading");this._cache.filter(o=>!o.hasDependency(e,i))}_preloadTiles(e,i){if(!this._sourceLoaded){const m=()=>{this._sourceLoaded&&(this._source.off("data",m),this._preloadTiles(e,i))};return void this._source.on("data",m)}const o=new Map,l=Array.isArray(e)?e:[e],u=this.map.painter.terrain,h=this.usedForTerrain&&u?u.getScaledDemTileSize():this._source.tileSize;for(const m of l){const _=m.coveringTiles({tileSize:h,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const v of _)o.set(v.key,v);this.usedForTerrain&&m.updateElevation(!1)}et(Array.from(o.values()),(m,_)=>{const v=new gg(m,this._source.tileSize*m.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(v,x=>{this._source.type==="raster-dem"&&v.dem&&this._backfillDEM(v),_(x,v)})},i)}}function CF(r,e){const i=Math.abs(2*r.wrap)-+(r.wrap<0),o=Math.abs(2*e.wrap)-+(e.wrap<0);return r.overscaledZ-e.overscaledZ||o-i||e.canonical.y-r.canonical.y||e.canonical.x-r.canonical.x}function WE(r){return r==="raster"||r==="image"||r==="video"||r==="custom"}function _g(r,e){const i=1<<r.z;return[r.x/i+e,(r.x+1)/i+e]}Kl.maxOverzooming=10,Kl.maxUnderzooming=3;const PH=Zn([{name:"a_pos_3f",components:3,type:"Float32"}]),OH=Zn([{name:"a_color_3f",components:3,type:"Float32"}]),RH=Zn([{name:"a_color_4f",components:4,type:"Float32"}]),LH=Zn([{name:"a_uv_2f",components:2,type:"Float32"}]),DH=Zn([{name:"a_normal_3f",components:3,type:"Float32"}]),BH=Zn([{name:"a_normal_matrix0",components:4,type:"Float32"},{name:"a_normal_matrix1",components:4,type:"Float32"},{name:"a_normal_matrix2",components:4,type:"Float32"},{name:"a_normal_matrix3",components:4,type:"Float32"}]),zH=Zn([{name:"a_pbr",components:4,type:"Uint16"},{name:"a_heightBasedEmissiveStrength",components:3,type:"Float32"}]);class HE{constructor(e=0,i=0,o=0,l=0){if(isNaN(e)||e<0||isNaN(i)||i<0||isNaN(o)||o<0||isNaN(l)||l<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=e,this.bottom=i,this.left=o,this.right=l}interpolate(e,i,o){return i.top!=null&&e.top!=null&&(this.top=$r(e.top,i.top,o)),i.bottom!=null&&e.bottom!=null&&(this.bottom=$r(e.bottom,i.bottom,o)),i.left!=null&&e.left!=null&&(this.left=$r(e.left,i.left,o)),i.right!=null&&e.right!=null&&(this.right=$r(e.right,i.right,o)),this}getCenter(e,i){const o=Oe((this.left+e-this.right)/2,0,e),l=Oe((this.top+i-this.bottom)/2,0,i);return new D(o,l)}equals(e){return this.top===e.top&&this.bottom===e.bottom&&this.left===e.left&&this.right===e.right}clone(){return new HE(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function AF(r,e){const i=mr(r,3);dt.fromQuat(r,e),Nt(r,3,i)}function GE(r,e){const i=ao.identity([]);return ao.rotateZ(i,i,-e),ao.rotateX(i,i,-r),i}function kF(r,e){const i=[r[0],r[1],0],o=[e[0],e[1],0];if(We.length(i)>=1e-15){const h=We.normalize([],i);We.scale(o,h,We.dot(o,h)),e[0]=o[0],e[1]=o[1]}const l=We.cross([],e,r);if(We.len(l)<1e-15)return null;const u=Math.atan2(-l[1],l[0]);return GE(Math.atan2(Math.sqrt(r[0]*r[0]+r[1]*r[1]),-r[2]),u)}class IF{constructor(e,i){this.position=e,this.orientation=i}get position(){return this._position}set position(e){if(e){const i=e instanceof Pn?e:new Pn(e[0],e[1],e[2]);this._renderWorldCopies&&(i.x=rt(i.x,0,1)),this._position=i}else this._position=null}lookAtPoint(e,i){if(this.orientation=null,!this.position)return;const o=this.position,l=this._elevation?this._elevation.getAtPointOrZero(Pn.fromLngLat(e)):0,u=Pn.fromLngLat(e,l),h=[u.x-o.x,u.y-o.y,u.z-o.z];i||(i=[0,0,1]),i[2]=Math.abs(i[2]),this.orientation=kF(h,i)}setPitchBearing(e,i){this.orientation=GE(le(e),le(-i))}}class ty{constructor(e,i){this._transform=dt.identity([]),this.orientation=i,this.position=e}get mercatorPosition(){const e=this.position;return new Pn(e[0],e[1],e[2])}get position(){const e=mr(this._transform,3);return[e[0],e[1],e[2]]}set position(e){var i;e&&Nt(this._transform,3,[(i=e)[0],i[1],i[2],1])}get orientation(){return this._orientation}set orientation(e){this._orientation=e||ao.identity([]),e&&AF(this._transform,this._orientation)}getPitchBearing(){const e=this.forward(),i=this.right();return{bearing:Math.atan2(-i[1],i[0]),pitch:Math.atan2(Math.sqrt(e[0]*e[0]+e[1]*e[1]),-e[2])}}setPitchBearing(e,i){this._orientation=GE(e,i),AF(this._transform,this._orientation)}forward(){const e=mr(this._transform,2);return[-e[0],-e[1],-e[2]]}up(){const e=mr(this._transform,1);return[-e[0],-e[1],-e[2]]}right(){const e=mr(this._transform,0);return[e[0],e[1],e[2]]}getCameraToWorld(e,i){const o=new Float64Array(16);return dt.invert(o,this.getWorldToCamera(e,i)),o}getCameraToWorldMercator(){return this._transform}getWorldToCameraPosition(e,i,o){const l=this.position;We.scale(l,l,-e);const u=new Float64Array(16);return dt.fromScaling(u,[o,o,o]),dt.translate(u,u,l),u[10]*=i,u}getWorldToCamera(e,i){const o=new Float64Array(16),l=new Float64Array(4),u=this.position;return ao.conjugate(l,this._orientation),We.scale(u,u,-e),dt.fromQuat(o,l),dt.translate(o,o,u),o[1]*=-1,o[5]*=-1,o[9]*=-1,o[13]*=-1,o[8]*=i,o[9]*=i,o[10]*=i,o[11]*=i,o}getCameraToClipPerspective(e,i,o,l){const u=new Float64Array(16);return dt.perspective(u,e,i,o,l),u}getCameraToClipOrthographic(e,i,o,l,u,h){const m=new Float64Array(16);return dt.ortho(m,e,i,o,l,u,h),m}getDistanceToElevation(e,i=!1){const o=e===0?0:fi(e,i?ka(this.position[1]):this.position[1]),l=this.forward();return(o-this.position[2])/l[2]}clone(){return new ty([...this.position],[...this.orientation])}}function MF(r,e){const i=vg(r.projection,r.zoom,r.width,r.height),o=function(u,h,m,_,v){const x=new Xr(m.lng-180*Kf,m.lat),w=new Xr(m.lng+180*Kf,m.lat),C=u.project(x.lng,x.lat),k=u.project(w.lng,w.lat),P=-Math.atan2(k.y-C.y,k.x-C.x),R=Pn.fromLngLat(m);R.y=Oe(R.y,-1+Kf,1-Kf);const z=R.toLngLat(),B=u.project(z.lng,z.lat),H=Pn.fromLngLat(z);H.x+=Kf;const Z=H.toLngLat(),Y=u.project(Z.lng,Z.lat),q=OF(Y.x-B.x,Y.y-B.y,P),ee=Pn.fromLngLat(z);ee.y+=Kf;const ce=ee.toLngLat(),de=u.project(ce.lng,ce.lat),ge=OF(de.x-B.x,de.y-B.y,P),ve=Math.abs(q.x)/Math.abs(ge.y),Re=dt.identity([]);dt.rotateZ(Re,Re,-P*(1-(v?0:_)));const ke=dt.identity([]);return dt.scale(ke,ke,[1,1-(1-ve)*_,1]),ke[4]=-ge.x/ge.y*_,dt.rotateZ(ke,ke,P),dt.multiply(ke,Re,ke),ke}(r.projection,0,r.center,i,e),l=FF(r);return dt.scale(o,o,[l,l,1]),o}function FF(r){const e=r.projection,i=vg(r.projection,r.zoom,r.width,r.height),o=PF(e,r.center),l=PF(e,Xr.convert(e.center));return Math.pow(2,o*i+(1-i)*l)}function vg(r,e,i,o,l=1/0){const u=r.range;if(!u)return 0;const h=Math.min(l,Math.max(i,o)),m=Math.log(h/1024)/Math.LN2;return Pe(u[0]+m,u[1]+m,e)}const Kf=1/4e4;function PF(r,e){const i=Oe(e.lat,-ha,ha),o=new Xr(e.lng-180*Kf,i),l=new Xr(e.lng+180*Kf,i),u=r.project(o.lng,i),h=r.project(l.lng,i),m=Pn.fromLngLat(o),_=Pn.fromLngLat(l),v=h.x-u.x,x=h.y-u.y,w=_.x-m.x,C=_.y-m.y,k=Math.sqrt((w*w+C*C)/(v*v+x*x));return Math.log(k)/Math.LN2}function OF(r,e,i){const o=Math.cos(i),l=Math.sin(i);return{x:r*o-e*l,y:r*l+e*o}}function ud(r,e,i){return e*(Et/(r.tileSize*Math.pow(2,i-r.tileID.overscaledZ)))}const a0={unknown:0,flipRequired:1,flipNotRequired:2},NH=Math.tan(85*Math.PI/180);function ry(r,e,i,o,l,u,h){const m=dt.create();if(i)if(u.name==="globe"){const _=function(v,x){const{x:w,y:C}=v.point,k=QI(w,C,v.worldSize/v._pixelsPerMercatorPixel,0,0);return dt.multiply(k,k,nE(vl(x)))}(l,e);dt.multiply(m,m,_)}else{const _=Vp.invert([],h);m[0]=_[0],m[1]=_[1],m[4]=_[2],m[5]=_[3],o||dt.rotateZ(m,m,l.angle)}else dt.multiply(m,l.labelPlaneMatrix,r);return m}function RF(r,e,i,o,l,u,h){const m=ry(r,e,i,o,l,u,h);return u.name==="globe"&&i||(m[2]=m[6]=m[10]=m[14]=0),m}function LF(r,e,i,o,l,u,h){if(i){if(u.name==="globe"){const m=ry(r,e,i,o,l,u,h);return dt.invert(m,m),dt.multiply(m,r,m),m}{const m=dt.clone(r),_=dt.identity([]);return _[0]=h[0],_[1]=h[1],_[4]=h[2],_[5]=h[3],dt.multiply(m,m,_),o||dt.rotateZ(m,m,-l.angle),m}}return l.glCoordMatrix}function Yl(r,e,i,o){const l=[r,e,i,1];i?li.transformMat4(l,l,o):VF(l,l,o);const u=l[3];return l[0]/=u,l[1]/=u,l[2]/=u,l}function DF(r,e){return Math.min(.5+r/e*.5,1.5)}function UH(r,e){const i=r[0]/r[3],o=r[1]/r[3];return i>=-e[0]&&i<=e[0]&&o>=-e[1]&&o<=e[1]}function $H(r,e,i,o,l,u,h,m,_,v){const x=i.transform,w=o?r.textSizeData:r.iconSizeData,C=zc(w,i.transform.zoom),k=x.projection.name==="globe",P=[256/i.width*2+1,256/i.height*2+1],R=o?r.text.dynamicLayoutVertexArray:r.icon.dynamicLayoutVertexArray;R.clear();let z=null;k&&(z=o?r.text.globeExtVertexArray:r.icon.globeExtVertexArray);const B=r.lineVertexArray,H=o?r.text.placedSymbolArray:r.icon.placedSymbolArray,Z=i.transform.width/i.transform.height;let Y,q=!1;for(let ee=0;ee<H.length;ee++){const ce=H.get(ee),{numGlyphs:de,writingMode:ge}=ce;if(ge!==zi.vertical||q||Y===zi.horizontal||(q=!0),Y=ge,(ce.hidden||ge===zi.vertical)&&!q){o0(de,R);continue}q=!1;const ve=new D(ce.tileAnchorX,ce.tileAnchorY);let{x:Re,y:ke,z:$e}=x.projection.projectTilePoint(ve.x,ve.y,v.canonical);if(_){const[Pt,Ut,Tt]=_(ve);Re+=Pt,ke+=Ut,$e+=Tt}const Ie=[Re,ke,$e,1];if(li.transformMat4(Ie,Ie,e),!UH(Ie,P)){o0(de,R);continue}const Qe=Ie[3],st=DF(i.transform.getCameraToCenterDistance(x.projection),Qe),ft=og(w,C,ce),Je=h?ft/st:ft*st,tt=Yl(Re,ke,$e,l);if(tt[3]<=0){o0(de,R);continue}let pt={};const bt=h?null:_,St=NF(ce,Je,!1,m,e,l,u,r.glyphOffsetArray,B,R,z,tt,ve,pt,Z,bt,x.projection,v,h);q=St.useVertical,bt&&St.needsFlipping&&(pt={}),(St.notEnoughRoom||q||St.needsFlipping&&NF(ce,Je,!0,m,e,l,u,r.glyphOffsetArray,B,R,z,tt,ve,pt,Z,bt,x.projection,v,h).notEnoughRoom)&&o0(de,R)}o?(r.text.dynamicLayoutVertexBuffer.updateData(R),z&&r.text.globeExtVertexBuffer&&r.text.globeExtVertexBuffer.updateData(z)):(r.icon.dynamicLayoutVertexBuffer.updateData(R),z&&r.icon.globeExtVertexBuffer&&r.icon.globeExtVertexBuffer.updateData(z))}function BF(r,e,i,o,l,u,h,m,_,v,x,w,C,k,P,R){const{lineStartIndex:z,glyphStartIndex:B,segment:H}=m,Z=B+m.numGlyphs,Y=z+m.lineLength,q=e.getoffsetX(B),ee=e.getoffsetX(Z-1),ce=ny(r*q,i,o,l,u,h,H,z,Y,_,v,x,w,C,!0,k,P,R);if(!ce)return null;const de=ny(r*ee,i,o,l,u,h,H,z,Y,_,v,x,w,C,!0,k,P,R);return de?{first:ce,last:de}:null}function zF(r,e,i,o){return r===zi.horizontal&&Math.abs(o)>Math.abs(i)?{useVertical:!0}:r===zi.vertical?o>0?{needsFlipping:!0}:null:e!==a0.unknown&&function(l,u){return l===0||Math.abs(u/l)>NH}(i,o)?e===a0.flipRequired?{needsFlipping:!0}:null:i<0?{needsFlipping:!0}:null}function NF(r,e,i,o,l,u,h,m,_,v,x,w,C,k,P,R,z,B,H){const Z=e/24,Y=r.lineOffsetX*Z,q=r.lineOffsetY*Z,{lineStartIndex:ee,glyphStartIndex:ce,numGlyphs:de,segment:ge,writingMode:ve,flipState:Re}=r,ke=ee+r.lineLength,$e=Ie=>{if(x){const[Je,tt,pt]=Ie.up,bt=v.length;Z1(x,bt+0,Je,tt,pt),Z1(x,bt+1,Je,tt,pt),Z1(x,bt+2,Je,tt,pt),Z1(x,bt+3,Je,tt,pt)}const[Qe,st,ft]=Ie.point;i0(v,Qe,st,ft,Ie.angle)};if(de>1){const Ie=BF(Z,m,Y,q,i,w,C,r,_,u,k,R,!1,z,B,H);if(!Ie)return{notEnoughRoom:!0};if(o&&!i){let[Qe,st,ft]=Ie.first.point,[Je,tt,pt]=Ie.last.point;[Qe,st]=Yl(Qe,st,ft,h),[Je,tt]=Yl(Je,tt,pt,h);const bt=zF(ve,Re,(Je-Qe)*P,tt-st);if(r.flipState=bt&&bt.needsFlipping?a0.flipRequired:a0.flipNotRequired,bt)return bt}$e(Ie.first);for(let Qe=ce+1;Qe<ce+de-1;Qe++){const st=ny(Z*m.getoffsetX(Qe),Y,q,i,w,C,ge,ee,ke,_,u,k,R,!1,!1,z,B,H);if(!st)return v.length-=4*(Qe-ce),{notEnoughRoom:!0};$e(st)}$e(Ie.last)}else{if(o&&!i){const Qe=Yl(C.x,C.y,0,l),st=ee+ge+1,ft=new D(_.getx(st),_.gety(st)),Je=Yl(ft.x,ft.y,0,l),tt=Je[3]>0?Je:$F(C,ft,Qe,1,l,void 0,z,B.canonical),pt=zF(ve,Re,(tt[0]-Qe[0])*P,tt[1]-Qe[1]);if(r.flipState=pt&&pt.needsFlipping?a0.flipRequired:a0.flipNotRequired,pt)return pt}const Ie=ny(Z*m.getoffsetX(ce),Y,q,i,w,C,ge,ee,ke,_,u,k,R,!1,!1,z,B,H);if(!Ie)return{notEnoughRoom:!0};$e(Ie)}return{}}function UF(r,e,i,o,l){const{x:u,y:h,z:m}=o.projectTilePoint(r.x,r.y,e);if(!l)return Yl(u,h,m,i);const[_,v,x]=l(r);return Yl(u+_,h+v,m+x,i)}function $F(r,e,i,o,l,u,h,m){const _=UF(r.sub(e)._unit()._add(r),m,l,h,u);return We.sub(_,i,_),We.normalize(_,_),We.scaleAndAdd(_,i,_,o)}function ny(r,e,i,o,l,u,h,m,_,v,x,w,C,k,P,R,z,B){const H=o?r-e:r+e;let Z=H>0?1:-1,Y=0;o&&(Z*=-1,Y=Math.PI),Z<0&&(Y+=Math.PI);let q=m+h+(Z>0?0:1)|0,ee=l,ce=l,de=0,ge=0;const ve=Math.abs(H),Re=[],ke=[];let $e=u,Ie=$e;const Qe=()=>$F(Ie,$e,ce,ve-de+1,x,C,R,z.canonical);for(;de+ge<=ve;){if(q+=Z,q<m||q>=_)return null;if(ce=ee,Ie=$e,Re.push(ce),k&&ke.push(Ie),$e=new D(v.getx(q),v.gety(q)),ee=w[q],!ee){const Ut=UF($e,z.canonical,x,R,C);ee=Ut[3]>0?w[q]=Ut:Qe()}de+=ge,ge=We.distance(ce,ee)}P&&C&&(w[q]&&(ee=Qe(),ge=We.distance(ce,ee)),w[q]=ee);const st=(ve-de)/ge,ft=$e.sub(Ie)._mult(st)._add(Ie),Je=We.sub([],ee,ce),tt=We.scaleAndAdd([],ce,Je,st);let pt=[0,0,1],bt=Je[0],St=Je[1];if(B&&(pt=R.upVector(z.canonical,ft.x,ft.y),pt[0]!==0||pt[1]!==0||pt[2]!==1)){const Ut=[pt[2],0,-pt[0]],Tt=We.cross([],pt,Ut);We.normalize(Ut,Ut),We.normalize(Tt,Tt),bt=We.dot(Je,Ut),St=We.dot(Je,Tt)}if(i){const Ut=We.cross([],pt,Je);We.normalize(Ut,Ut),We.scaleAndAdd(tt,tt,Ut,i*Z)}const Pt=Y+Math.atan2(St,bt);return Re.push(tt),k&&ke.push(ft),{point:tt,angle:Pt,path:Re,tilePath:ke,up:pt}}function o0(r,e){const i=e.length,o=i+4*r;e.resize(o),e.float32.fill(-1/0,4*i,4*o)}function VF(r,e,i){const o=e[0],l=e[1];return r[0]=i[0]*o+i[4]*l+i[12],r[1]=i[1]*o+i[5]*l+i[13],r[3]=i[3]*o+i[7]*l+i[15],r}const jF=(r,e,i)=>(1-i)*r+i*e,WF=r=>r*r*r*r*r;class qE{constructor(e,i,o,l,u,h,m){this.tileSize=512,this._renderWorldCopies=u===void 0||u,this._minZoom=e||0,this._maxZoom=i||22,this._minPitch=o??0,this._maxPitch=l??60,this.setProjection(h),this.setMaxBounds(m),this.width=0,this.height=0,this._center=new Xr(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new HE,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._distanceTileDataCache={},this._camera=new ty,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._horizonShift=.1,this._orthographicProjectionAtLowPitch=!1}clone(){const e=new qE(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return e._elevation=this._elevation,e._centerAltitude=this._centerAltitude,e._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,e.tileSize=this.tileSize,e.mercatorFromTransition=this.mercatorFromTransition,e.width=this.width,e.height=this.height,e.cameraElevationReference=this.cameraElevationReference,e._center=this._center,e._setZoom(this.zoom),e._seaLevelZoom=this._seaLevelZoom,e.angle=this.angle,e._fov=this._fov,e._pitch=this._pitch,e._nearZ=this._nearZ,e._farZ=this._farZ,e._averageElevation=this._averageElevation,e._unmodified=this._unmodified,e._edgeInsets=this._edgeInsets.clone(),e._camera=this._camera.clone(),e._calcMatrices(),e.freezeTileCoverage=this.freezeTileCoverage,e.frustumCorners=this.frustumCorners,e}get isOrthographic(){return this.projection.name!=="globe"&&this._orthographicProjectionAtLowPitch&&this.pitch<15}get elevation(){return this._elevation}set elevation(e){this._elevation!==e&&(this._elevation=e,this._updateCameraOnTerrain(),this._calcMatrices())}get depthOcclusionForSymbolsAndCircles(){return this.projection.name!=="globe"&&!this.isOrthographic}updateElevation(e,i=!1){const o=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(this._seaLevelZoom==null||o)&&this._updateCameraOnTerrain(),(e||o)&&this._constrainCamera(i),this._calcMatrices()}getProjection(){return oe(this.projection,["name","center","parallels"])}setProjection(e){this.projectionOptions=e||{name:"mercator"};const i=this.projection?this.getProjection():void 0;this.projection=W1(this.projectionOptions);const o=!te(i,this.getProjection());return o&&this._calcMatrices(),this.mercatorFromTransition=!1,o}setOrthographicProjectionAtLowPitch(e){return this._orthographicProjectionAtLowPitch!==e&&(this._orthographicProjectionAtLowPitch=e,this._calcMatrices(),!0)}setMercatorFromTransition(){const e=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=W1({name:"mercator"});const i=e!==this.projection.name;return i&&this._calcMatrices(),i}get minZoom(){return this._minZoom}set minZoom(e){this._minZoom!==e&&(this._minZoom=e,this.zoom=Math.max(this.zoom,e))}get maxZoom(){return this._maxZoom}set maxZoom(e){this._maxZoom!==e&&(this._maxZoom=e,this.zoom=Math.min(this.zoom,e))}get minPitch(){return this._minPitch}set minPitch(e){this._minPitch!==e&&(this._minPitch=e,this.pitch=Math.max(this.pitch,e))}get maxPitch(){return this._maxPitch}set maxPitch(e){this._maxPitch!==e&&(this._maxPitch=e,this.pitch=Math.min(this.pitch,e))}get renderWorldCopies(){return this._renderWorldCopies&&this.projection.supportsWorldCopies===!0}set renderWorldCopies(e){e===void 0?e=!0:e===null&&(e=!1),this._renderWorldCopies=e}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const e=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(e))}get cameraWorldSize(){const e=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(e))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return fi(1,this.center.lat)*this.cameraWorldSizeForFog}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new D(this.width,this.height)}get bearing(){return rt(this.rotation,-180,180)}set bearing(e){this.rotation=e}get rotation(){return-this.angle/Math.PI*180}set rotation(e){const i=-e*Math.PI/180;this.angle!==i&&(this._unmodified=!1,this.angle=i,this._calcMatrices(),this.rotationMatrix=Vp.create(),Vp.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(e){const i=Oe(e,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==i&&(this._unmodified=!1,this._pitch=i,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}get fovX(){return this._fov}get fovY(){const e=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/e)}set fov(e){e=Math.max(.01,Math.min(60,e)),this._fov!==e&&(this._unmodified=!1,this._fov=le(e),this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(e){this._averageElevation=e,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(e){const i=Math.min(Math.max(e,this.minZoom),this.maxZoom);this._zoom!==i&&(this._unmodified=!1,this._setZoom(i),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(e){this._zoom=e,this.scale=this.zoomScale(e),this.tileZoom=Math.floor(e),this.zoomFraction=e-this.tileZoom}_updateCameraOnTerrain(){const e=this.elevation?this.elevation.getAtPoint(this.locationCoordinate(this.center),Number.NEGATIVE_INFINITY):Number.NEGATIVE_INFINITY,i=this.elevation&&e===Number.NEGATIVE_INFINITY&&this.elevation.visibleDemTiles.length>0&&this.elevation.exaggeration()>0&&this._centerAltitudeValidForExaggeration;if(!this._elevation||e===Number.NEGATIVE_INFINITY&&(!i||!this._centerAltitude))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const o=this._elevation;i||this._centerAltitude&&this._centerAltitudeValidForExaggeration&&o.exaggeration()&&this._centerAltitudeValidForExaggeration!==o.exaggeration()?(this._centerAltitude=this._centerAltitude/this._centerAltitudeValidForExaggeration*o.exaggeration(),this._centerAltitudeValidForExaggeration=o.exaggeration()):(this._centerAltitude=e||0,this._centerAltitudeValidForExaggeration=o.exaggeration()),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){this._centerAltitudeValidForExaggeration!==void 0&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const e=this._elevation,i=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],o=this.horizonLineFromTop();let l=0,u=0;for(let h=0;h<i.length;h++){const m=new D(i[h][0]*this.width,o+i[h][1]*(this.height-o)),_=e.pointCoordinate(m);if(!_)continue;const v=1/Math.hypot(_[0]-this._camera.position[0],_[1]-this._camera.position[1]);l+=_[3]*v,u+=v}return u===0?NaN:l/u}get center(){return this._center}set center(e){e.lat===this._center.lat&&e.lng===this._center.lng||(this._unmodified=!1,this._center=e,this._terrainEnabled()&&(this.cameraElevationReference==="ground"?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(this._seaLevelZoom==null||!this._elevation)return;const e=this._seaLevelZoom,i=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),o=this.pixelsPerMeter/this.worldSize*i,l=this._mercatorZfromZoom(e),u=this._mercatorZfromZoom(this._maxZoom),h=Math.max(l-o,u);this._setZoom(this._zoomFromMercatorZ(h))}get padding(){return this._edgeInsets.toJSON()}set padding(e){this._edgeInsets.equals(e)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,e,1),this._calcMatrices())}computeZoomRelativeTo(e){const i=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,e.toAltitude()));let o;o=e.z<this._camera.position[2]?[i.x,i.y,i.z]:[e.x,e.y,e.z];const l=We.length(We.sub([],this._camera.position,o));return Oe(this._zoomFromMercatorZ(l),this._minZoom,this._maxZoom)}setFreeCameraOptions(e){if(!this.height||!e.position&&!e.orientation)return;this._updateCameraState();let i=!1;if(e.orientation&&!ao.exactEquals(e.orientation,this._camera.orientation)&&(i=this._setCameraOrientation(e.orientation)),e.position){const o=[e.position.x,e.position.y,e.position.z];We.exactEquals(o,this._camera.position)||(this._setCameraPosition(o),i=!0)}i&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const e=this._camera.position,i=new IF;return i.position=new Pn(e[0],e[1],e[2]),i.orientation=this._camera.orientation,i._elevation=this.elevation,i._renderWorldCopies=this.renderWorldCopies,i}_setCameraOrientation(e){if(!ao.length(e))return!1;ao.normalize(e,e);const i=We.transformQuat([],[0,0,-1],e),o=We.transformQuat([],[0,-1,0],e);if(o[2]<0)return!1;const l=kF(i,o);return!!l&&(this._camera.orientation=l,!0)}_setCameraPosition(e){const i=this.zoomScale(this.minZoom)*this.tileSize,o=this.zoomScale(this.maxZoom)*this.tileSize,l=this.cameraToCenterDistance;e[2]=Oe(e[2],l/o,l/i),this._camera.position=e}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(e){return this._edgeInsets.equals(e)}interpolatePadding(e,i,o){this._unmodified=!1,this._edgeInsets.interpolate(e,i,o),this._constrain(),this._calcMatrices()}coveringZoomLevel(e){const i=(e.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/e.tileSize));return Math.max(0,i)}getVisibleUnwrappedCoordinates(e){const i=[new Y2(0,e)];if(this.renderWorldCopies){const o=this.pointCoordinate(new D(0,0)),l=this.pointCoordinate(new D(this.width,0)),u=this.pointCoordinate(new D(this.width,this.height)),h=this.pointCoordinate(new D(0,this.height)),m=Math.floor(Math.min(o.x,l.x,u.x,h.x)),_=Math.floor(Math.max(o.x,l.x,u.x,h.x)),v=1;for(let x=m-v;x<=_+v;x++)x!==0&&i.push(new Y2(x,e))}return i}isLODDisabled(e){return(!e||this.pitch<=60)&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace}extendTileCoverForShadows(e,i,o){let l=[];if(i[0]===0&&i[1]===0)return l;for(const h of e){const m=h.canonical,_=h.overscaledZ,v=h.wrap,x=1<<m.z,w=m.x+1<x,C=m.x>0,k=m.y+1<x,P=m.y>0,R=h.wrap-(C?0:1),z=h.wrap+(w?0:1),B=C?m.x-1:x-1,H=w?m.x+1:0;i[0]<0?(l.push(new Wn(_,z,m.z,H,m.y)),i[1]<0&&k&&(l.push(new Wn(_,v,m.z,m.x,m.y+1)),l.push(new Wn(_,z,m.z,H,m.y+1))),i[1]>0&&P&&(l.push(new Wn(_,v,m.z,m.x,m.y-1)),l.push(new Wn(_,z,m.z,H,m.y-1)))):i[0]>0?(l.push(new Wn(_,R,m.z,B,m.y)),i[1]<0&&k&&(l.push(new Wn(_,v,m.z,m.x,m.y+1)),l.push(new Wn(_,R,m.z,B,m.y+1))),i[1]>0&&P&&(l.push(new Wn(_,v,m.z,m.x,m.y-1)),l.push(new Wn(_,R,m.z,B,m.y-1)))):i[1]<0&&k?l.push(new Wn(_,v,m.z,m.x,m.y+1)):P&&l.push(new Wn(_,v,m.z,m.x,m.y-1))}if(l.length>1){l.sort((_,v)=>_.overscaledZ-v.overscaledZ||_.wrap-v.wrap||_.canonical.z-v.canonical.z||_.canonical.x-v.canonical.x||_.canonical.y-v.canonical.y);let h=0,m=0;for(;m<l.length;)l[m].equals(l[h])?++m:l[++h]=l[m++];l.length=h+1}const u=[];for(const h of l)l.some(m=>h.isChildOf(m))||u.push(h);return l=u.filter(h=>!e.some(m=>!!(h.overscaledZ<o&&m.isChildOf(h))||h.equals(m)||h.isChildOf(m))),l}coveringTiles(e){let i=this.coveringZoomLevel(e);const o=i,l=this.elevation&&this.elevation.exaggeration(),u=l&&!e.isTerrainDEM,h=this.projection.name==="mercator";if(e.minzoom!==void 0&&i<e.minzoom)return[];e.maxzoom!==void 0&&i>e.maxzoom&&(i=e.maxzoom);const m=this.locationCoordinate(this.center),_=this.center.lat,v=1<<i,x=[v*m.x,v*m.y,0],w=this.projection.name==="globe",C=!w,k=ku.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,i,C),P=w?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),R=v*fi(1,this.center.lat),z=this._camera.position[2]/fi(1,this.center.lat),B=[v*P.x,v*P.y,z*(C?1:R)],H=w||l,Z=this.cameraToCenterDistance/e.tileSize*(e.roundZoom?1:.502),Y=this.isLODDisabled(!0)?i:0,q=e.isTerrainDEM&&this._elevation?1e4*this._elevation.exaggeration():this._centerAltitude,ee=e.isTerrainDEM?-q:this._elevation?this._elevation.getMinElevationBelowMSL():0,ce=this.projection.isReprojectedInTileSpace?FF(this):1,de=Je=>{const pt=new Pn(Je.x+25e-6,Je.y,Je.z),bt=new Pn(Je.x,Je.y+25e-6,Je.z),St=Je.toLngLat(),Pt=pt.toLngLat(),Ut=bt.toLngLat(),Tt=this.locationCoordinate(St),Mt=this.locationCoordinate(Pt),tr=this.locationCoordinate(Ut),ur=Math.hypot(Mt.x-Tt.x,Mt.y-Tt.y),cr=Math.hypot(tr.x-Tt.x,tr.y-Tt.y);return Math.sqrt(ur*cr)*ce/25e-6},ge=Je=>{const tt=q,pt=ee;return{aabb:mF(this,v,0,0,0,Je,pt,tt,this.projection),zoom:0,x:0,y:0,minZ:pt,maxZ:tt,wrap:Je,fullyVisible:!1}},ve=[];let Re=[];const ke=i,$e=e.reparseOverscaled?o:i,Ie=Je=>Je*Je,Qe=Ie((z-this._centerAltitude)*R),st=Je=>{if(!this._elevation||!Je.tileID||!h)return;const tt=this._elevation.getMinMaxForTile(Je.tileID),pt=Je.aabb;tt?(pt.min[2]=tt.min,pt.max[2]=tt.max,pt.center[2]=(pt.min[2]+pt.max[2])/2):(Je.shouldSplit=ft(Je),Je.shouldSplit||(pt.min[2]=pt.max[2]=pt.center[2]=this._centerAltitude))},ft=Je=>{if(Je.zoom<Y)return!0;if(Je.zoom===ke)return!1;if(Je.shouldSplit!=null)return Je.shouldSplit;const tt=Je.aabb.distanceX(B),pt=Je.aabb.distanceY(B);let bt=Qe,St=1;if(w){bt=Ie(Je.aabb.distanceZ(B));const Tt=Math.pow(2,Je.zoom),Mt=ka((Je.y+1)/Tt),tr=ka(Je.y/Tt),ur=Math.min(Math.max(_,Mt),tr),cr=y1(ur)/y1(_);if(St=ur===_?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,cr/this._mercatorScaleRatio),this.zoom<=eg&&Je.zoom===ke-1&&cr>=.9)return!0}else if(u&&(bt=Ie(Je.aabb.distanceZ(B)*R)),this.projection.isReprojectedInTileSpace&&o<=5){const Tt=Math.pow(2,Je.zoom),Mt=de(new Pn((Je.x+.5)/Tt,(Je.y+.5)/Tt));St=Mt>.85?1:Mt}const Pt=tt*tt+pt*pt+bt,Ut=Ie((1<<ke-Je.zoom)*Z*St*((Tt,Mt)=>{if(Mt*Ie(.707)<Tt)return 1;const tr=Math.sqrt(Mt/Tt);return tr/(1.4144271570014144+(Math.pow(1.1,tr-1.4144271570014144+1)-1)/(1.1-1)-1)})(Math.max(bt,Qe),Pt));return Pt<Ut};if(this.renderWorldCopies)for(let Je=1;Je<=3;Je++)ve.push(ge(-Je)),ve.push(ge(Je));for(ve.push(ge(0));ve.length>0;){const Je=ve.pop(),tt=Je.x,pt=Je.y;let bt=Je.fullyVisible;const St=()=>this.projection.name==="globe"&&(Je.y===0||Je.y===(1<<Je.zoom)-1);if(!bt){let Pt=H?Je.aabb.intersects(k):Je.aabb.intersectsFlat(k);if(Pt===0&&St()){const Ut=new Dc(Je.zoom,tt,pt);Pt=tE(this,v,Ut,!0).intersects(k)}if(Pt===0)continue;bt=Pt===2}if(Je.zoom!==ke&&ft(Je))for(let Pt=0;Pt<4;Pt++){const Ut=(tt<<1)+Pt%2,Tt=(pt<<1)+(Pt>>1),Mt={aabb:h?Je.aabb.quadrant(Pt):mF(this,v,Je.zoom+1,Ut,Tt,Je.wrap,Je.minZ,Je.maxZ,this.projection),zoom:Je.zoom+1,x:Ut,y:Tt,wrap:Je.wrap,fullyVisible:bt,tileID:void 0,shouldSplit:void 0,minZ:Je.minZ,maxZ:Je.maxZ};u&&!w&&(Mt.tileID=new Wn(Je.zoom+1===ke?$e:Je.zoom+1,Je.wrap,Je.zoom+1,Ut,Tt),st(Mt)),ve.push(Mt)}else{const Pt=Je.zoom===ke?$e:Je.zoom;if(e.minzoom&&e.minzoom>Pt)continue;if(!bt){let tr=H?Je.aabb.intersectsPrecise(k):Je.aabb.intersectsPreciseFlat(k);if(tr===0&&St()){const ur=new Dc(Je.zoom,tt,pt);tr=tE(this,v,ur,!0).intersectsPrecise(k)}if(tr===0)continue}const Ut=x[0]-(.5+tt+(Je.wrap<<Je.zoom))*(1<<i-Je.zoom),Tt=x[1]-.5-pt,Mt=Je.tileID?Je.tileID:new Wn(Pt,Je.wrap,Je.zoom,tt,pt);Re.push({tileID:Mt,distanceSq:Ut*Ut+Tt*Tt})}}if(this.fogCullDistSq){const Je=this.fogCullDistSq,tt=this.horizonLineFromTop();Re=Re.filter(pt=>{const bt=[0,0,0,1],St=[Et,Et,0,1],Pt=this.calculateFogTileMatrix(pt.tileID.toUnwrapped());li.transformMat4(bt,bt,Pt),li.transformMat4(St,St,Pt);const Ut=function(tr,ur,cr){let hr=0;for(let Mr=0;Mr<2;++Mr)tr[Mr]>0&&(hr+=(tr[Mr]-0)*(tr[Mr]-0)),ur[Mr]<0&&(hr+=(0-ur[Mr])*(0-ur[Mr]));return hr}(li.min([],bt,St),li.max([],bt,St));if(Ut===0)return!0;let Tt=!1;const Mt=this._elevation;if(Mt&&Ut>Je&&tt!==0){const tr=this.calculateProjMatrix(pt.tileID.toUnwrapped());let ur;e.isTerrainDEM||(ur=Mt.getMinMaxForTile(pt.tileID)),ur||(ur={min:ee,max:q});const cr=function(Mr){const jr=Math.round((Mr+45+360)%360/90)%4;return Fe[jr]}(this.rotation),hr=[cr[0]*Et,cr[1]*Et,ur.max];We.transformMat4(hr,hr,tr),Tt=(1-hr[1])*this.height*.5<tt}return Ut<Je||Tt})}return Re.sort((Je,tt)=>Je.distanceSq-tt.distanceSq).map(Je=>Je.tileID)}resize(e,i){this.width=e,this.height=i,this.pixelsToGLUnits=[2/e,-2/i],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(e){return Math.pow(2,e)}scaleZoom(e){return Math.log(e)/Math.LN2}project(e){const i=Oe(e.lat,-ha,ha),o=this.projection.project(e.lng,i);return new D(o.x*this.worldSize,o.y*this.worldSize)}unproject(e){return this.projection.unproject(e.x/this.worldSize,e.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/fi(1,this.center.lat)/this.worldSize}setLocationAtPoint(e,i){let o,l;const u=this.centerPoint;if(this.projection.name==="globe"){const m=this.worldSize;o=(i.x-u.x)/m,l=(i.y-u.y)/m}else{const m=this.pointCoordinate(i),_=this.pointCoordinate(u);o=m.x-_.x,l=m.y-_.y}const h=this.locationCoordinate(e);this.setLocation(new Pn(h.x-o,h.y-l))}setLocation(e){this.center=this.coordinateLocation(e),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(e){return this.projection.locationPoint(this,e)}locationPoint3D(e){return this.projection.locationPoint(this,e,!0)}pointLocation(e){return this.coordinateLocation(this.pointCoordinate(e))}pointLocation3D(e){return this.coordinateLocation(this.pointCoordinate3D(e))}locationCoordinate(e,i){const o=i?fi(i,e.lat):void 0,l=this.projection.project(e.lng,e.lat);return new Pn(l.x,l.y,o)}coordinateLocation(e){return this.projection.unproject(e.x,e.y)}pointRayIntersection(e,i){const o=i??this._centerAltitude,l=[e.x,e.y,0,1],u=[e.x,e.y,1,1];li.transformMat4(l,l,this.pixelMatrixInverse),li.transformMat4(u,u,this.pixelMatrixInverse);const h=u[3];li.scale(l,l,1/l[3]),li.scale(u,u,1/h);const m=l[2],_=u[2];return{p0:l,p1:u,t:m===_?0:(o-m)/(_-m)}}screenPointToMercatorRay(e){const i=[e.x,e.y,0,1],o=[e.x,e.y,1,1];return li.transformMat4(i,i,this.pixelMatrixInverse),li.transformMat4(o,o,this.pixelMatrixInverse),li.scale(i,i,1/i[3]),li.scale(o,o,1/o[3]),i[2]=fi(i[2],this._center.lat)*this.worldSize,o[2]=fi(o[2],this._center.lat)*this.worldSize,li.scale(i,i,1/this.worldSize),li.scale(o,o,1/this.worldSize),new p1([i[0],i[1],i[2]],We.normalize([],We.sub([],o,i)))}rayIntersectionCoordinate(e){const{p0:i,p1:o,t:l}=e,u=fi(i[2],this._center.lat),h=fi(o[2],this._center.lat);return new Pn($r(i[0],o[0],l)/this.worldSize,$r(i[1],o[1],l)/this.worldSize,$r(u,h,l))}pointCoordinate(e,i=this._centerAltitude){return this.projection.pointCoordinate(this,e.x,e.y,i)}pointCoordinate3D(e){if(!this.elevation)return this.pointCoordinate(e);let i=this.projection.pointCoordinate3D(this,e.x,e.y);if(i)return new Pn(i[0],i[1],i[2]);let o=0,l=this.horizonLineFromTop();if(e.y>l)return this.pointCoordinate(e);const u=.02*l,h=e.clone();for(let m=0;m<10&&l-o>u;m++){h.y=$r(o,l,.66);const _=this.projection.pointCoordinate3D(this,h.x,h.y);_?(l=h.y,i=_):o=h.y}return i?new Pn(i[0],i[1],i[2]):this.pointCoordinate(e)}isPointAboveHorizon(e){return this.projection.isPointAboveHorizon(this,e)}isPointOnSurface(e){if(e.y<0||e.y>this.height||e.x<0||e.x>this.width)return!1;if(this.elevation||this.zoom>=zf)return!this.isPointAboveHorizon(e);const i=this.pointCoordinate(e);return i.y>=0&&i.y<=1}_coordinatePoint(e,i){const o=i&&this.elevation?this.elevation.getAtPointOrZero(e,this._centerAltitude):this._centerAltitude,l=[e.x*this.worldSize,e.y*this.worldSize,o+e.toAltitude(),1];return li.transformMat4(l,l,this.pixelMatrix),l[3]>0?new D(l[0]/l[3],l[1]/l[3]):new D(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:e,left:i}=this._edgeInsets,o=this.height-this._edgeInsets.bottom,l=this.width-this._edgeInsets.right,u=this.pointLocation3D(new D(i,e)),h=this.pointLocation3D(new D(l,e)),m=this.pointLocation3D(new D(l,o)),_=this.pointLocation3D(new D(i,o));let v=Math.min(u.lng,h.lng,m.lng,_.lng),x=Math.max(u.lng,h.lng,m.lng,_.lng),w=Math.min(u.lat,h.lat,m.lat,_.lat),C=Math.max(u.lat,h.lat,m.lat,_.lat);const k=Math.pow(2,-this.zoom)/16*270,P=this.projection.name==="globe"?1:4,R=(z,B,H,Z,Y)=>{const q=(z+H)/2,ee=(B+Z)/2,ce=new D(q,ee),{lng:de,lat:ge}=this.pointLocation3D(ce),ve=Math.max(0,v-de,w-ge,de-x,ge-C);v=Math.min(v,de),x=Math.max(x,de),w=Math.min(w,ge),C=Math.max(C,ge),(Y<P||ve>k)&&(R(z,B,q,ee,Y+1),R(q,ee,H,Z,Y+1))};if(R(i,e,l,e,1),R(l,e,l,o,1),R(l,o,i,o,1),R(i,o,i,e,1),this.projection.name==="globe"){const[z,B]=function(H){const Z=dt.identity(new Float64Array(16));dt.multiply(Z,H.pixelMatrix,H.globeMatrix);const Y=[0,gl,0],q=[0,_l,0];return We.transformMat4(Y,Y,Z),We.transformMat4(q,q,Z),[Y[0]>0&&Y[0]<=H.width&&Y[1]>0&&Y[1]<=H.height&&!v1(H,new Xr(H.center.lat,90)),q[0]>0&&q[0]<=H.width&&q[1]>0&&q[1]<=H.height&&!v1(H,new Xr(H.center.lat,-90))]}(this);z?(C=90,x=180,v=-180):B&&(w=-90,x=180,v=-180)}return new Ks(new Xr(v,w),new Xr(x,C))}_getBoundsRectangular(e,i){const{top:o,left:l}=this._edgeInsets,u=this.height-this._edgeInsets.bottom,h=this.width-this._edgeInsets.right,m=new D(l,o),_=new D(h,o),v=new D(h,u),x=new D(l,u);let w=this.pointCoordinate(m,e),C=this.pointCoordinate(_,e);const k=this.pointCoordinate(v,i),P=this.pointCoordinate(x,i),R=(z,B)=>(B.y-z.y)/(B.x-z.x);return w.y>1&&C.y>=0?w=new Pn((1-P.y)/R(P,w)+P.x,1):w.y<0&&C.y<=1&&(w=new Pn(-P.y/R(P,w)+P.x,0)),C.y>1&&w.y>=0?C=new Pn((1-k.y)/R(k,C)+k.x,1):C.y<0&&w.y<=1&&(C=new Pn(-k.y/R(k,C)+k.x,0)),new Ks().extend(this.coordinateLocation(w)).extend(this.coordinateLocation(C)).extend(this.coordinateLocation(P)).extend(this.coordinateLocation(k))}_getBoundsRectangularTerrain(){const e=this.elevation;if(!e.visibleDemTiles.length||e.isUsingMockSource())return this._getBoundsRectangular(0,0);const i=e.visibleDemTiles.reduce((o,l)=>{if(l.dem){const u=l.dem.tree;o.min=Math.min(o.min,u.minimums[0]),o.max=Math.max(o.max,u.maximums[0])}return o},{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(i.min*e.exaggeration(),i.max*e.exaggeration())}getBounds(){return this.projection.name==="mercator"||this.projection.name==="equirectangular"?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(e=!0){const i=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))-this.centerOffset.y,o=this.height/2-i*(1-this._horizonShift);return e?Math.max(0,o):o}getMaxBounds(){return this.maxBounds}setMaxBounds(e){this.maxBounds=e,this.minLat=-ha,this.maxLat=ha,this.minLng=-180,this.maxLng=180,e&&(this.minLat=e.getSouth(),this.maxLat=e.getNorth(),this.minLng=e.getWest(),this.maxLng=e.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=Xa(this.minLng)*this.tileSize,this.worldMaxX=Xa(this.maxLng)*this.tileSize,this.worldMinY=oo(this.maxLat)*this.tileSize,this.worldMaxY=oo(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(e,i){return this.projection.createTileMatrix(this,i,e)}calculateDistanceTileData(e){const i=e.key,o=this._distanceTileDataCache;if(o[i])return o[i];const l=e.canonical,u=1/this.height,h=this.cameraWorldSize,m=h/this.zoomScale(l.z),_=(l.x+Math.pow(2,l.z)*e.wrap)*m,v=l.y*m,x=this.point;x.x*=h/this.worldSize,x.y*=h/this.worldSize;const w=this.angle,C=Math.sin(-w),k=-Math.cos(-w);return o[i]={bearing:[C,k],center:[(x.x-_)*u,(x.y-v)*u],scale:m/Et*u},o[i]}calculateFogTileMatrix(e){const i=e.key,o=this._fogTileMatrixCache;if(o[i])return o[i];const l=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,e);return dt.multiply(l,this.worldToFogMatrix,l),o[i]=new Float32Array(l),o[i]}calculateProjMatrix(e,i=!1){const o=e.key,l=i?this._alignedProjMatrixCache:this._projMatrixCache;if(l[o])return l[o];const u=this.calculatePosMatrix(e,this.worldSize);return dt.multiply(u,this.projection.isReprojectedInTileSpace?this.mercatorMatrix:i?this.alignedProjMatrix:this.projMatrix,u),l[o]=new Float32Array(u),l[o]}calculatePixelsToTileUnitsMatrix(e){const i=e.tileID.key,o=this._pixelsToTileUnitsCache;if(o[i])return o[i];const l=function(u,h){const{scale:m}=u.tileTransform,_=m*Et/(u.tileSize*Math.pow(2,h.zoom-u.tileID.overscaledZ+u.tileID.canonical.z));return Vp.scale(new Float32Array(4),h.inverseAdjustmentMatrix,[_,_])}(e,this);return o[i]=l,o[i]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if(this.projection.name==="globe"){const e=1/this.worldSize,i=dt.fromScaling([],[e,e,e]);return dt.multiply(i,i,this.globeMatrix),i}}recenterOnTerrain(){if(!this._elevation||this.projection.name==="globe")return;const e=this._elevation;this._updateCameraState();const i=fi(1,this._center.lat)*this.worldSize,o=this._computeCameraPosition(i),l=this._camera.forward(),u=fi(1,this._center.lat);o[2]/=u,l[2]/=u,We.normalize(l,l);const h=e.raycast(o,l,e.exaggeration());if(h){const m=We.scaleAndAdd([],o,l,h),_=new Pn(m[0],m[1],fi(m[2],ka(m[1]))),v=(_.z+We.length([_.x-o[0],_.y-o[1],_.z-o[2]*u]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(v),this._centerAltitude=_.toAltitude(),this._center=this.coordinateLocation(_),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(e=!1){if(!this._elevation)return;const i=this._elevation,o=fi(1,this._center.lat)*this.worldSize,l=this._computeCameraPosition(o),u=i.getAtPointOrZero(new Pn(...l)),h=this.pixelsPerMeter/this.worldSize*u,m=this._minimumHeightOverTerrain(),_=l[2]-h;if(_<=m)if(_<0||e){const v=this.locationCoordinate(this._center,this._centerAltitude),x=[l[0],l[1],v.z-l[2]],w=We.length(x);x[2]-=(m-_)/this._pixelsPerMercatorPixel;const C=We.length(x);if(C===0)return;We.scale(x,x,w/C*this._pixelsPerMercatorPixel),this._camera.position=[l[0],l[1],v.z*this._pixelsPerMercatorPixel-x[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const e=this.projection.name==="globe"||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||e){const C=this.center;return C.lat=Oe(C.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!e)&&(C.lng=Oe(C.lng,this.minLng,this.maxLng)),this.center=C,void(this._constraining=!1)}const i=this._unmodified,{x:o,y:l}=this.point;let u=0,h=o,m=l;const _=this.width/2,v=this.height/2,x=this.worldMinY*this.scale,w=this.worldMaxY*this.scale;if(l-v<x&&(m=x+v),l+v>w&&(m=w-v),w-x<this.height&&(u=Math.max(u,this.height/(w-x)),m=(w+x)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const C=this.worldMinX*this.scale,k=this.worldMaxX*this.scale,P=this.worldSize/2-(C+k)/2;h=(o+P+this.worldSize)%this.worldSize-P,h-_<C&&(h=C+_),h+_>k&&(h=k-_),k-C<this.width&&(u=Math.max(u,this.width/(k-C)),h=(k+C)/2)}h===o&&m===l||(this.center=this.unproject(new D(h,m))),u&&(this.zoom+=this.scaleZoom(u)),this._constrainCamera(),this._unmodified=i,this._constraining=!1}_minZoomForBounds(){let e=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(e=Math.max(e,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),e}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const e=this.centerOffset,i=this.projection.name==="globe",o=this.pixelsPerMeter;this.projection.name==="globe"&&(this._mercatorScaleRatio=fi(1,this.center.lat)/fi(1,45));const l=vg(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,l),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const u=this.projection.zAxisUnit==="meters"?o:1,h=this._camera.getWorldToCamera(this.worldSize,u);let m;const _=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);if(_[8]=2*-e.x/this.width,_[9]=2*e.y/this.height,this.isOrthographic){let ge=.5*this.height/Math.tan(this._fov/2)*1*Math.tan(.5*this._fov),ve=ge*this.aspect,Re=-ve,ke=-ge;ve-=e.x,Re-=e.x,ge+=e.y,ke+=e.y,m=this._camera.getCameraToClipOrthographic(Re,ve,ke,ge,this._nearZ,this._farZ),(($e,Ie,Qe,st)=>{for(let ft=0;ft<16;ft++)$e[ft]=jF(Ie[ft],Qe[ft],st)})(m,m,_,WF(this.pitch>=15?1:this.pitch/15))}else m=_;const v=dt.mul([],_,h);let x=dt.mul([],m,h);if(this.projection.isReprojectedInTileSpace){const ge=this.locationCoordinate(this.center),ve=dt.identity([]);dt.translate(ve,ve,[ge.x*this.worldSize,ge.y*this.worldSize,0]),dt.multiply(ve,ve,MF(this)),dt.translate(ve,ve,[-ge.x*this.worldSize,-ge.y*this.worldSize,0]),dt.multiply(x,x,ve),dt.multiply(v,v,ve),this.inverseAdjustmentMatrix=function(Re){const ke=MF(Re,!0);return Vp.invert([],[ke[0],ke[1],ke[4],ke[5]])}(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];this.mercatorMatrix=dt.scale([],x,[this.worldSize,this.worldSize,this.worldSize/u,1]),this.projMatrix=x,this.invProjMatrix=dt.invert(new Float64Array(16),this.projMatrix);const w=dt.invert([],m);this.frustumCorners=J2.fromInvProjectionMatrix(w,this.horizonLineFromTop(),this.height),this.cameraFrustum=ku.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,0,!i);const C=new Float32Array(16);dt.identity(C),dt.scale(C,C,[1,-1,1]),dt.rotateX(C,C,this._pitch),dt.rotateZ(C,C,this.angle);const k=dt.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ);this.starsProjMatrix=dt.clone(k);const P=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;k[8]=2*-e.x/this.width,k[9]=2*(e.y+P)/this.height,this.skyboxMatrix=dt.multiply(C,k,C);const R=this.point,z=R.x,B=R.y,H=this.width%2/2,Z=this.height%2/2,Y=Math.cos(this.angle),q=Math.sin(this.angle),ee=z-Math.round(z)+Y*H+q*Z,ce=B-Math.round(B)+Y*Z+q*H,de=new Float64Array(x);if(dt.translate(de,de,[ee>.5?ee-1:ee,ce>.5?ce-1:ce,0]),this.alignedProjMatrix=de,x=dt.create(),dt.scale(x,x,[this.width/2,-this.height/2,1]),dt.translate(x,x,[1,-1,0]),this.labelPlaneMatrix=x,x=dt.create(),dt.scale(x,x,[1,-1,1]),dt.translate(x,x,[-1,-1,0]),dt.scale(x,x,[2/this.width,2/this.height,1]),this.glCoordMatrix=x,this.pixelMatrix=dt.multiply(new Float64Array(16),this.labelPlaneMatrix,v),this._calcFogMatrices(),this._distanceTileDataCache={},x=dt.invert(new Float64Array(16),this.pixelMatrix),!x)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=x,this.projection.name==="globe"||this.mercatorFromTransition){this.globeMatrix=function(ve){const{x:Re,y:ke}=ve.point,{lng:$e,lat:Ie}=ve._center;return QI(Re,ke,ve.worldSize,$e,Ie)}(this);const ge=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=We.transformMat4(ge,ge,h),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=x;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const e=this.cameraWorldSizeForFog,i=this.cameraPixelsPerMeter,o=this._camera.position,l=1/this.height/this._pixelsPerMercatorPixel,u=[e,e,i];We.scale(u,u,l),We.scale(o,o,-1),We.multiply(o,o,u);const h=dt.create();dt.translate(h,h,o),dt.scale(h,h,u),this.mercatorFogMatrix=h,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(e,i,l)}_computeCameraPosition(e){const i=(e=e||this.pixelsPerMeter)/this.pixelsPerMeter,o=this._camera.forward(),l=this.point,u=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*i-e/this.worldSize*this._centerAltitude;return[l.x/this.worldSize-o[0]*u,l.y/this.worldSize-o[1]*u,e/this.worldSize*this._centerAltitude-o[2]*u]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(e){const i=this._maxCameraBoundsDistance()*Math.cos(this._pitch),o=this._camera.position[2],l=e[2];let u=1;this.projection.wrap&&(this.center=this.center.wrap()),l>0&&(u=Math.min((i-o)/l,1)),this._camera.position=We.scaleAndAdd([],this._camera.position,e,u),this._updateStateFromCamera()}_updateStateFromCamera(){const e=this._camera.position,i=this._camera.forward(),{pitch:o,bearing:l}=this._camera.getPitchBearing(),u=fi(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,h=this._mercatorZfromZoom(this._maxZoom)*Math.cos(le(this._maxPitch)),m=Math.max((e[2]-u)/Math.cos(o),h),_=this._zoomFromMercatorZ(m);We.scaleAndAdd(e,e,i,m),this._pitch=Oe(o,le(this.minPitch),le(this.maxPitch)),this.angle=rt(l,-Math.PI,Math.PI),this._setZoom(Oe(_,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new Pn(e[0],e[1],e[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(e){return Math.pow(2,e)*this.tileSize}_mercatorZfromZoom(e){return this.cameraToCenterDistance/this._worldSizeFromZoom(e)}_minimumHeightOverTerrain(){const e=Math.min((this._seaLevelZoom!=null?this._seaLevelZoom:this._zoom)+4,this._maxZoom);return this._mercatorZfromZoom(e)}_zoomFromMercatorZ(e){return this.scaleZoom(this.cameraToCenterDistance/(e*this.tileSize))}zoomFromMercatorZAdjusted(e){let i=0,o=zf,l=0,u=1/0;for(;o-i>1e-6&&o>i;){const h=i+.5*(o-i),m=this.tileSize*Math.pow(2,h),_=this.getCameraToCenterDistance(this.projection,h,m),v=this.scaleZoom(_/(e*this.tileSize)),x=Math.abs(h-v);x<u&&(u=x,l=h),h<v?i=h:o=h}return l}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(se("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(e,i){const o=Math.min(e.x,i.x),l=Math.max(e.x,i.x),u=Math.min(e.y,i.y),h=Math.max(e.y,i.y);if(u<this.horizonLineFromTop(!1))return!0;if(this.projection.name!=="mercator")return!1;const m=[new D(o,u),new D(l,h),new D(o,h),new D(l,u)],_=this.renderWorldCopies?-3:0,v=this.renderWorldCopies?4:1;for(const x of m){const w=this.pointRayIntersection(x);if(w.t<0)return!0;const C=this.rayIntersectionCoordinate(w);if(C.x<_||C.y<0||C.x>v||C.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+re(this.fovAboveCenter)>88||this.anyCornerOffEdge(new D(0,0),new D(this.width,this.height))}zoomDeltaToMovement(e,i){const o=We.length(We.sub([],this._camera.position,e)),l=this._zoomFromMercatorZ(o)+i;return o-this._mercatorZfromZoom(l)}getCameraPoint(){if(this.projection.name==="globe"){const e=function([i,o,l],u){const h=[i,o,l,1];li.transformMat4(h,h,u);const m=h[3]=Math.max(h[3],1e-6);return h[0]/=m,h[1]/=m,h[2]/=m,h}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new D(e[0],e[1])}{const e=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new D(0,e))}}getCameraToCenterDistance(e,i=this.zoom,o=this.worldSize){const l=vg(e,i,this.width,this.height,1024),u=e.pixelSpaceConversion(this.center.lat,o,l);let h=.5/Math.tan(.5*this._fov)*this.height*u;return this.isOrthographic&&(h=jF(1,h,WF(this.pitch>=15?1:this.pitch/15))),h}getWorldToCameraMatrix(){const e=this._camera.getWorldToCamera(this.worldSize,this.projection.zAxisUnit==="meters"?this.pixelsPerMeter:1);return this.projection.name==="globe"&&dt.multiply(e,e,this.globeMatrix),e}getFrustum(e){return ku.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,e,this.projection.zAxisUnit==="meters")}}function HF(r,e,i){dt.identity(r),dt.rotateZ(r,r,le(e[2])),dt.rotateX(r,r,le(e[0])),dt.rotateY(r,r,le(e[1])),dt.scale(r,r,i),dt.multiply(r,r,[1,0,0,0,0,0,1,0,0,1,0,0,0,0,0,1])}function iy(r,e,i,o,l,u,h,m){const _=[i[0]-e[0],i[1]-e[1],0],v=[o[0]-e[0],o[1]-e[1],0];if(We.length(_)<1e-12||We.length(v)<1e-12)return ao.identity(r);const x=We.cross([],_,v);We.normalize(x,x),We.subtract(v,o,e),_[2]=(u-l)*m,v[2]=(h-l)*m;const w=_;return We.cross(w,_,v),We.normalize(w,w),ao.rotationTo(r,x,w)}function GF(r,e,i=!1){const o=qa(e.zoom),l=function(u,h,m){const _=h.worldSize,v=[u[12],u[13],u[14]],x=ka(v[1]/_),w=Ss(v[0]/_),C=dt.identity([]),k=fi(1,x)*_,P=fi(1,0)*_*Uf(x,h.zoom),R=1/iE(_);let z=P*R;if(m){const Y=vg(h.projection,h.zoom,h.width,h.height,1024);z=R*h.projection.pixelSpaceConversion(h.center.lat,_,Y)}const B=ns(x,w);We.add(B,B,We.scale([],We.normalize([],B),k*z*v[2]));const H=function(Y){const q=[Y[0],Y[1],Y[2]];let ee=[0,1,0];const ce=We.cross([],ee,q);return We.cross(ee,q,ce),We.squaredLength(ee)===0&&(ee=[0,1,0],We.cross(ce,q,ee)),We.normalize(ce,ce),We.normalize(ee,ee),We.normalize(q,q),[ce[0],ce[1],ce[2],0,ee[0],ee[1],ee[2],0,q[0],q[1],q[2],0,Y[0],Y[1],Y[2],1]}(B);dt.scale(C,C,[z,z,z*k]),dt.translate(C,C,[-v[0],-v[1],-v[2]]);const Z=dt.multiply([],h.globeMatrix,H);return dt.multiply(Z,Z,C),dt.multiply(Z,Z,u),Z}(r,e,i);if(o>0){const u=function(h,m){const _=m.worldSize,v=fi(1,0)*_*Uf(m.center.lat,m.zoom)/iE(_),x=fi(1,m.center.lat)*_,w=dt.identity([]);return dt.rotateY(w,w,le(m.center.lng)),dt.rotateX(w,w,le(m.center.lat)),dt.translate(w,w,[0,0,Fo]),dt.scale(w,w,[v,v,v*x]),dt.translate(w,w,[m.point.x-.5*_,m.point.y-.5*_,0]),dt.multiply(w,w,h),dt.multiply(w,m.globeMatrix,w)}(r,e);return function(h,m,_){const v=(P,R,z)=>{const B=We.length(P),H=We.length(R),Z=Iu(P,R,z);return We.scale(Z,Z,1/We.length(Z)*$r(B,H,z))},x=v([h[0],h[1],h[2]],[m[0],m[1],m[2]],_),w=v([h[4],h[5],h[6]],[m[4],m[5],m[6]],_),C=v([h[8],h[9],h[10]],[m[8],m[9],m[10]],_),k=Iu([h[12],h[13],h[14]],[m[12],m[13],m[14]],_);return[x[0],x[1],x[2],0,w[0],w[1],w[2],0,C[0],C[1],C[2],0,k[0],k[1],k[2],1]}(l,u,o)}return l}const fd=64,VH=[1,1,1];class qF{constructor(e,i,o,l){this.id=e,this.position=i!=null?new Xr(i[0],i[1]):new Xr(0,0),this.orientation=o??[0,0,0],this.nodes=l,this.uploaded=!1,this.aabb=new Oi([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),this.matrix=[]}_applyTransformations(e,i){if(dt.multiply(e.matrix,i,e.matrix),e.meshes)for(const o of e.meshes){const l=Oi.applyTransform(o.aabb,e.matrix);this.aabb.encapsulate(l)}if(e.children)for(const o of e.children)this._applyTransformations(o,e.matrix)}computeBoundsAndApplyParent(){const e=dt.identity([]);for(const i of this.nodes)this._applyTransformations(i,e)}_positionModelOnTerrain(e,i){const o=e.elevation;if(!o)return 0;const l=Oi.projectAabbCorners(this.aabb,this.matrix),u=fi(1,this.position.lat)*e.worldSize,h=function(B,H){const Z=[0,0,1],Y=[{corners:[0,1,3,2],dotProductWithUp:0},{corners:[1,5,2,6],dotProductWithUp:0},{corners:[0,4,1,5],dotProductWithUp:0},{corners:[2,6,3,7],dotProductWithUp:0},{corners:[4,7,5,6],dotProductWithUp:0},{corners:[0,3,4,7],dotProductWithUp:0}];for(const q of Y){const ee=B[q.corners[0]],ce=B[q.corners[1]],de=B[q.corners[2]],ge=[ce[0]-ee[0],ce[1]-ee[1],H*(ce[2]-ee[2])],ve=We.cross(ge,ge,[de[0]-ee[0],de[1]-ee[1],H*(de[2]-ee[2])]);We.normalize(ve,ve),q.dotProductWithUp=We.dot(ve,Z)}return Y.sort((q,ee)=>q.dotProductWithUp-ee.dotProductWithUp),Y[0].corners}(l,u),m=l[h[0]],_=l[h[1]],v=l[h[2]],x=l[h[3]],w=o.getAtPointOrZero(new Pn(m[0]/e.worldSize,m[1]/e.worldSize),0),C=o.getAtPointOrZero(new Pn(_[0]/e.worldSize,_[1]/e.worldSize),0),k=o.getAtPointOrZero(new Pn(v[0]/e.worldSize,v[1]/e.worldSize),0),P=o.getAtPointOrZero(new Pn(x[0]/e.worldSize,x[1]/e.worldSize),0),R=(w+P)/2,z=(C+k)/2;return R>z?C<k?iy(i,_,x,m,C,P,w,u):iy(i,v,m,x,k,w,P,u):w<P?iy(i,m,_,v,w,C,k,u):iy(i,x,v,_,P,k,C,u),Math.max(R,z)}computeModelMatrix(e,i,o,l,u,h,m=!1){const _=e.transform,v=_.zoom,x=_.project(this.position),w=Uf(this.position.lat,v),C=1/w;dt.identity(this.matrix),dt.translate(this.matrix,this.matrix,[x.x+l[0]*C,x.y+l[1]*C,l[2]]);let k=1,P=1;const R=_.worldSize;if(m){if(_.projection.name==="mercator"){let Z=0;_.elevation&&(Z=_.elevation.getAtPointOrZero(new Pn(x.x/R,x.y/R),0));const Y=li.transformMat4([],[x.x,x.y,Z,1],_.projMatrix)[3]/_.cameraToCenterDistance;k=Y,P=Y*Uf(_.center.lat,v)}else if(_.projection.name==="globe"){const Z=GF(this.matrix,_),Y=dt.multiply([],_.projMatrix,Z),q=[0,0,0,1];li.transformMat4(q,q,Y);const ee=q[3]/_.cameraToCenterDistance,ce=qa(v),de=_.projection.pixelsPerMeter(this.position.lat,R)*Uf(this.position.lat,v),ge=_.projection.pixelsPerMeter(_.center.lat,R)*Uf(_.center.lat,v);k=ee/$r(de,oM(_.center.lat),ce),P=ee*w/de,k*=ge,P*=ge}}else k=C;dt.scale(this.matrix,this.matrix,[k,k,P]);const z=[...this.matrix],B=this.orientation,H=[];if(HF(H,[B[0]+i[0],B[1]+i[1],B[2]+i[2]],o),dt.multiply(this.matrix,z,H),u&&_.elevation){let Z=0;const Y=[];if(h&&_.elevation){Z=this._positionModelOnTerrain(_,Y);const q=dt.fromQuat([],Y),ee=dt.multiply([],q,H);dt.multiply(this.matrix,z,ee)}else Z=_.elevation.getAtPointOrZero(new Pn(x.x/R,x.y/R),0);Z!==0&&(this.matrix[14]+=Z)}}upload(e){if(!this.uploaded){for(const i of this.nodes)XE(i,e);for(const i of this.nodes)ay(i);this.uploaded=!0}}destroy(){for(const e of this.nodes)oy(e)}}function yg(r,e,i=!1){r.uploaded||(r.gfxTexture=new Ia(e,r.image,i?e.gl.R8:e.gl.RGBA,{useMipmap:r.sampler.minFilter>=e.gl.NEAREST_MIPMAP_NEAREST}),r.uploaded=!0,r.image=null)}function jH(r,e,i){r.indexBuffer=e.createIndexBuffer(r.indexArray,!1,!0),r.vertexBuffer=e.createVertexBuffer(r.vertexArray,PH.members,!1,!0),r.normalArray&&(r.normalBuffer=e.createVertexBuffer(r.normalArray,DH.members,!1,!0)),r.texcoordArray&&(r.texcoordBuffer=e.createVertexBuffer(r.texcoordArray,LH.members,!1,!0)),r.colorArray&&(r.colorBuffer=e.createVertexBuffer(r.colorArray,(r.colorArray.bytesPerElement===12?OH:RH).members,!1,!0)),r.featureArray&&(r.pbrBuffer=e.createVertexBuffer(r.featureArray,zH.members,!0)),r.segments=ui.simpleSegment(0,0,r.vertexArray.length,r.indexArray.length);const o=r.material;o.pbrMetallicRoughness.baseColorTexture&&yg(o.pbrMetallicRoughness.baseColorTexture,e),o.pbrMetallicRoughness.metallicRoughnessTexture&&yg(o.pbrMetallicRoughness.metallicRoughnessTexture,e),o.normalTexture&&yg(o.normalTexture,e),o.occlusionTexture&&yg(o.occlusionTexture,e,i),o.emissionTexture&&yg(o.emissionTexture,e)}function XE(r,e,i){if(r.meshes)for(const o of r.meshes)jH(o,e,i);if(r.children)for(const o of r.children)XE(o,e,i)}function ay(r){if(r.meshes)for(const e of r.meshes)e.indexArray.destroy(),e.vertexArray.destroy(),e.colorArray&&e.colorArray.destroy(),e.normalArray&&e.normalArray.destroy(),e.texcoordArray&&e.texcoordArray.destroy(),e.featureArray&&e.featureArray.destroy();if(r.children)for(const e of r.children)ay(e)}function oy(r){if(r.meshes)for(const i of r.meshes)i.vertexBuffer&&(i.vertexBuffer.destroy(),i.indexBuffer.destroy(),i.normalBuffer&&i.normalBuffer.destroy(),i.texcoordBuffer&&i.texcoordBuffer.destroy(),i.colorBuffer&&i.colorBuffer.destroy(),i.pbrBuffer&&i.pbrBuffer.destroy(),i.segments.destroy(),i.material&&((e=i.material).pbrMetallicRoughness.baseColorTexture&&e.pbrMetallicRoughness.baseColorTexture.gfxTexture&&e.pbrMetallicRoughness.baseColorTexture.gfxTexture.destroy(),e.pbrMetallicRoughness.metallicRoughnessTexture&&e.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture&&e.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture.destroy(),e.normalTexture&&e.normalTexture.gfxTexture&&e.normalTexture.gfxTexture.destroy(),e.emissionTexture&&e.emissionTexture.gfxTexture&&e.emissionTexture.gfxTexture.destroy(),e.occlusionTexture&&e.occlusionTexture.gfxTexture&&e.occlusionTexture.gfxTexture.destroy()));var e;if(r.children)for(const i of r.children)oy(i)}class XF{constructor(e,i){this.feature=e,this.instancedDataOffset=i,this.instancedDataCount=0,this.rotation=[0,0,0],this.scale=[1,1,1],this.translation=[0,0,0]}}class ZF{constructor(){this.instancedDataArray=new I2,this.instancesEvaluatedElevation=[],this.features=[],this.idToFeaturesIndex={}}}class KF{constructor(e){this.zoom=e.zoom,this.canonical=e.canonical,this.layers=e.layers,this.layerIds=this.layers.map(i=>i.fqid),this.projection=e.projection,this.index=e.index,this.hasZoomDependentProperties=this.layers[0].isZoomDependent(),this.stateDependentLayerIds=this.layers.filter(i=>i.isStateDependent()).map(i=>i.id),this.hasPattern=!1,this.instancesPerModel={},this.validForExaggeration=0,this.maxVerticalOffset=0,this.maxScale=0,this.maxHeight=0,this.lookupDim=this.zoom>this.canonical.z?256:this.zoom>15?75:100,this.instanceCount=0,this.terrainElevationMin=0,this.terrainElevationMax=0,this.validForDEMTile={id:null,timestamp:0}}populate(e,i,o,l){this.tileToMeter=rg(o);const u=this.layers[0]._featureFilter.needGeometry;this.lookup=new Uint8Array(this.lookupDim*this.lookupDim);for(const{feature:h,id:m,index:_,sourceLayerIndex:v}of e){const x=$f(h,u);if(!this.layers[0]._featureFilter.filter(new Gi(this.zoom),x,o))continue;const w={id:m,sourceLayerIndex:v,index:_,geometry:u?x.geometry:Bc(h,o,l),properties:h.properties,type:h.type,patterns:{}},C=this.addFeature(w,w.geometry,x);C&&i.featureIndex.insert(h,w.geometry,_,v,this.index,this.instancesPerModel[C].instancedDataArray.length)}this.lookup=null}update(e,i,o,l){for(const u in this.instancesPerModel){const h=this.instancesPerModel[u];for(const m in e)h.idToFeaturesIndex.hasOwnProperty(m)&&this.evaluate(h.features[h.idToFeaturesIndex[m]],e[m],h,!0)}this.maxHeight=0}updateZoomBasedPaintProperties(){if(!this.hasZoomDependentProperties)return!1;let e=!1;for(const i in this.instancesPerModel){const o=this.instancesPerModel[i];for(const l of o.features){const u=this.layers[0],h=l.feature,m=this.canonical,_=u.paint.get("model-rotation").evaluate(h,{},m),v=u.paint.get("model-scale").evaluate(h,{},m),x=u.paint.get("model-translation").evaluate(h,{},m);We.exactEquals(l.rotation,_)&&We.exactEquals(l.scale,v)&&We.exactEquals(l.translation,x)||(this.evaluate(l,l.featureStates,o,!0),e=!0)}}return e}isEmpty(){for(const e in this.instancesPerModel)if(this.instancesPerModel[e].instancedDataArray.length!==0)return!1;return!0}uploadPending(){return!this.uploaded}upload(e){if(!this.uploaded)for(const i in this.instancesPerModel){const o=this.instancesPerModel[i];o.instancedDataArray.length<0||o.instancedDataArray.length===0||(o.instancedDataBuffer?o.instancedDataBuffer.updateData(o.instancedDataArray):o.instancedDataBuffer=e.createVertexBuffer(o.instancedDataArray,BH.members,!0,void 0,this.instanceCount))}this.uploaded=!0}destroy(){for(const e in this.instancesPerModel){const i=this.instancesPerModel[e];i.instancedDataArray.length!==0&&i.instancedDataBuffer&&i.instancedDataBuffer.destroy()}}addFeature(e,i,o){const l=this.layers[0],u=l.layout.get("model-id").evaluate(o,{},this.canonical);if(!u)return se(`modelId is not evaluated for layer ${l.id} and it is not going to get rendered.`),u;this.instancesPerModel[u]||(this.instancesPerModel[u]=new ZF);const h=this.instancesPerModel[u],m=h.instancedDataArray,_=new XF(o,m.length);for(const v of i)for(const x of v){if(x.x<0||x.x>=Et||x.y<0||x.y>=Et)continue;const w=(this.lookupDim-1)/Et,C=this.lookupDim*(x.y*w|0)+x.x*w|0;if(this.lookup){if(this.lookup[C]!==0)continue;this.lookup[C]=1}this.instanceCount++;const k=m.length;m.resize(k+1),h.instancesEvaluatedElevation.push(0),m.float32[16*k]=x.x,m.float32[16*k+1]=x.y}return _.instancedDataCount=h.instancedDataArray.length-_.instancedDataOffset,_.instancedDataCount>0&&(e.id&&(h.idToFeaturesIndex[e.id]=h.features.length),h.features.push(_),this.evaluate(_,{},h,!1)),u}evaluate(e,i,o,l){const u=this.layers[0],h=e.feature,m=this.canonical,_=e.rotation=u.paint.get("model-rotation").evaluate(h,i,m),v=e.scale=u.paint.get("model-scale").evaluate(h,i,m),x=e.translation=u.paint.get("model-translation").evaluate(h,i,m),w=u.paint.get("model-color").evaluate(h,i,m);w.a=u.paint.get("model-color-mix-intensity").evaluate(h,i,m);const C=[];this.maxVerticalOffset<x[2]&&(this.maxVerticalOffset=x[2]),this.maxScale=Math.max(Math.max(this.maxScale,v[0]),Math.max(v[1],v[2])),HF(C,_,v);const k=Math.round(100*w.a)+w.b/1.05;for(let P=0;P<e.instancedDataCount;++P){const R=e.instancedDataOffset+P,z=16*R,B=o.instancedDataArray.float32;let H=0;l&&(H=B[z+6]-o.instancesEvaluatedElevation[R]);const Z=0|B[z+1];B[z]=(0|B[z])+w.r/1.05,B[z+1]=Z+w.g/1.05,B[z+2]=k,B[z+3]=1/(m.z>10?this.tileToMeter:rg(m,Z)),B[z+4]=x[0],B[z+5]=x[1],B[z+6]=x[2]+H,B[z+7]=C[0],B[z+8]=C[1],B[z+9]=C[2],B[z+10]=C[4],B[z+11]=C[5],B[z+12]=C[6],B[z+13]=C[8],B[z+14]=C[9],B[z+15]=C[10],o.instancesEvaluatedElevation[R]=x[2]}}}xr(KF,"ModelBucket",{omit:["layers"]}),xr(ZF,"PerModelAttributes"),xr(XF,"ModelFeature");const WH=new sa({visibility:new Yt(at.layout_model.visibility),"model-id":new Pr(at.layout_model["model-id"])});var HH={paint:new sa({"model-opacity":new Yt(at.paint_model["model-opacity"]),"model-rotation":new Pr(at.paint_model["model-rotation"]),"model-scale":new Pr(at.paint_model["model-scale"]),"model-translation":new Pr(at.paint_model["model-translation"]),"model-color":new Pr(at.paint_model["model-color"]),"model-color-mix-intensity":new Pr(at.paint_model["model-color-mix-intensity"]),"model-type":new Yt(at.paint_model["model-type"]),"model-cast-shadows":new Yt(at.paint_model["model-cast-shadows"]),"model-receive-shadows":new Yt(at.paint_model["model-receive-shadows"]),"model-ambient-occlusion-intensity":new Yt(at.paint_model["model-ambient-occlusion-intensity"]),"model-emissive-strength":new Pr(at.paint_model["model-emissive-strength"]),"model-roughness":new Pr(at.paint_model["model-roughness"]),"model-height-based-emissive-strength-multiplier":new Pr(at.paint_model["model-height-based-emissive-strength-multiplier"]),"model-cutoff-fade-range":new Yt(at.paint_model["model-cutoff-fade-range"])}),layout:WH};const ZE=new Float32Array(262144),hd=new Uint8Array(262144);function YF(r){let e=0;if(r.meshes)for(const i of r.meshes)e=Math.max(e,i.aabb.max[2]);if(r.children)for(const i of r.children)e=Math.max(e,YF(i));return e}const JF=["","wall","door","roof","window","lamp","logo"];class QF{constructor(e){this.node=e,this.evaluatedRMEA=[[1,0,0,1],[1,0,0,1],[1,0,0,1],[1,0,0,1],[.4,1,0,1],[1,0,0,1],[1,0,0,1]],this.hiddenByReplacement=!1,this.evaluatedScale=[1,1,1],this.evaluatedColor=[],this.emissionHeightBasedParams=[],this.feature={type:"Point",id:e.id,geometry:[],properties:{height:YF(e)}}}}class eP{constructor(e,i,o,l){this.nodes=e,this.id=i,this.modelTraits|=1,this.uploaded=!1,this.hasPattern=!1,o&&(this.modelTraits|=4),this.zoom=-1,this.terrainExaggeration=1,this.projection={name:"mercator"},this.replacementUpdateTime=0,this.elevationReadFromZ=255,this.brightness=l,this.dirty=!0,this.needsUpload=!1}update(){console.log("Update 3D model bucket")}populate(){console.log("populate 3D model bucket")}uploadPending(){return!this.uploaded||this.needsUpload}upload(e){if(!this.needsUpload)return;const i=this.getNodesInfo();for(const o of i){const l=o.node;this.uploaded?this.updatePbrBuffer(l):XE(l,e,!0)}for(const o of i)ay(o.node);this.uploaded=!0,this.needsUpload=!1}updatePbrBuffer(e){let i=!1;if(!e.meshes)return i;for(const o of e.meshes)o.pbrBuffer&&(o.pbrBuffer.updateData(o.featureArray),i=!0);return i}needsReEvaluation(e,i,o){const l=e.transform.projectionOptions,u=e.style.getBrightness(),h=this.brightness!==u;return!!(!this.uploaded||this.dirty||l.name!==this.projection.name||xg(o.paint.get("model-color").value,h)||xg(o.paint.get("model-color-mix-intensity").value,h)||xg(o.paint.get("model-roughness").value,h)||xg(o.paint.get("model-emissive-strength").value,h)||xg(o.paint.get("model-height-based-emissive-strength-multiplier").value,h))&&(this.projection=l,this.brightness=u,!0)}evaluateScale(e,i){if(e.transform.zoom===this.zoom)return;this.zoom=e.transform.zoom;const o=this.getNodesInfo(),l=this.id.canonical;for(const u of o){const h=u.feature;u.evaluatedScale=i.paint.get("model-scale").evaluate(h,{},l)}}evaluate(e){const i=this.getNodesInfo();for(const o of i){if(!o.node.meshes)continue;const l=o.feature,u=o.node.meshes&&o.node.meshes[0].featureData,h=o.evaluatedColor[2],m=o.evaluatedRMEA[2],_=this.id.canonical;if(o.hasTranslucentParts=!1,u){for(let v=0;v<JF.length;v++){const x=JF[v];x.length&&(l.properties.part=x);const w=e.paint.get("model-color").evaluate(l,{},_),C=e.paint.get("model-color-mix-intensity").evaluate(l,{},_);o.evaluatedColor[v]=[w.r,w.g,w.b,C],o.evaluatedRMEA[v][0]=e.paint.get("model-roughness").evaluate(l,{},_),o.evaluatedRMEA[v][2]=e.paint.get("model-emissive-strength").evaluate(l,{},_),o.evaluatedRMEA[v][3]=w.a,o.emissionHeightBasedParams[v]=e.paint.get("model-height-based-emissive-strength-multiplier").evaluate(l,{},_),!o.hasTranslucentParts&&w.a<1&&(o.hasTranslucentParts=!0)}delete l.properties.part,qH(o,h!==o.evaluatedColor[2]||m!==o.evaluatedRMEA[2])}o.evaluatedScale=e.paint.get("model-scale").evaluate(l,{},_),this.updatePbrBuffer(o.node)||(this.needsUpload=!0)}this.dirty=!1}elevationUpdate(e,i,o,l){const u=e.findDEMTileFor(o);if(u&&(u.tileID.canonical!==this.terrainTile||i!==this.terrainExaggeration)){if(u.dem&&u.tileID.overscaledZ!==this.elevationReadFromZ){this.elevationReadFromZ=u.tileID.overscaledZ;const h=Jp.create(e,o,u);if(!h)return;4&this.modelTraits&&this.updateDEM(e,h,o,l);for(const m of this.getNodesInfo()){const _=m.node;if(!_.footprint||!_.footprint.vertices||!_.footprint.vertices.length)continue;const v=_.footprint.vertices;let x=h.getElevationAt(v[0].x,v[0].y,!0,!0);for(let w=1;w<v.length;w++)x=Math.min(x,h.getElevationAt(v[w].x,v[w].y,!0,!0));_.elevation=x}}this.terrainTile=u.tileID.canonical,this.terrainExaggeration=i}}updateDEM(e,i,o,l){let u=i._dem._modifiedForSources[l];if(u===void 0&&(i._dem._modifiedForSources[l]=[],u=i._dem._modifiedForSources[l]),u.includes(o.canonical))return;const h=i._dem.dim;u.push(o.canonical);let m=!1;for(const _ of this.getNodesInfo()){const v=_.node;if(!v.footprint||!v.footprint.grid)continue;const x=v.footprint.grid,w=i.tileCoordToPixel(x.min.x,x.min.y),C=i.tileCoordToPixel(x.max.x,x.max.y),k=Math.min(Math.min(h-C.y,w.x),Math.min(w.y,h-C.x));if(k<0)continue;const P=Oe(k,2,5);let R=Math.max(0,w.x-P),z=Math.max(0,w.y-P),B=Math.min(C.x+P,h-1),H=Math.min(C.y+P,h-1);for(let ee=z;ee<=H;++ee)for(let ce=R;ce<=B;++ce)hd[ee*h+ce]=255;let Z=0,Y=0;for(let ee=0;ee<x.cellsY;++ee)for(let ce=0;ce<x.cellsX;++ce){if(!x.cells[ee*x.cellsX+ce])continue;const de=i.tileCoordToPixel(x.min.x+ce/x.xScale,x.min.y+ee/x.yScale),ge=i.tileCoordToPixel(x.min.x+(ce+1)/x.xScale,x.min.y+(ee+1)/x.yScale);for(let ve=de.y;ve<=Math.min(ge.y+1,h-1);++ve)for(let Re=de.x;Re<=Math.min(ge.x+1,h-1);++Re)hd[ve*h+Re]===255&&(hd[ve*h+Re]=0,Z+=i.getElevationAtPixel(Re,ve),Y++)}const q=Z/Y;R=Math.max(1,w.x-P),z=Math.max(1,w.y-P),B=Math.min(C.x+P,h-2),H=Math.min(C.y+P,h-2),m=!0;for(let ee=z;ee<=H;++ee)for(let ce=R;ce<=B;++ce)hd[ee*h+ce]===0&&(ZE[ee*h+ce]=i._dem.set(ce,ee,q));for(let ee=1;ee<P;++ee){R=Math.max(1,w.x-ee),z=Math.max(1,w.y-ee),B=Math.min(C.x+ee,h-2),H=Math.min(C.y+ee,h-2);for(let ce=z;ce<=H;++ce)for(let de=R;de<=B;++de){const ge=ce*h+de;if(hd[ge]===255){let ve=0,Re=0,ke=-1,$e=-1;for(let Ie=-1;Ie<=1;++Ie)for(let Qe=-1;Qe<=1;++Qe){const st=(ce+Ie)*h+de+Qe;if(hd[st]>=ee)continue;const ft=ZE[st],Je=Math.abs(ft);Je>Re&&(ve=ft,Re=Je,ke=Qe,$e=Ie)}if(Re>.1){const Ie=1-(ee+.5*Math.abs(ke*$e))/P;let Qe=i._dem.get(de,ce)+ve*Ie;const st=i._dem.get(de+ke,ce+$e),ft=i._dem.get(de-ke,ce-$e,!0);(Qe-st)*(Qe-ft)>0&&(Qe=(st+ft)/2),ZE[ge]=i._dem.set(de,ce,Qe),hd[ge]=ee}}}}}m&&(i._demTile.needsDEMTextureUpload=!0,i._dem._timestamp=Jr.now())}getNodesInfo(){if(!this.nodesInfo){this.nodesInfo=[];for(const e of this.nodes)this.nodesInfo.push(new QF(e));this.freeNodes()}return this.nodesInfo}freeNodes(){if(this.nodes){for(const e of this.nodes)oy(e);this.nodes.splice(0,this.nodes.length)}}destroy(){this.freeNodes();const e=this.getNodesInfo();for(const i of e)ay(i.node),oy(i.node)}isEmpty(){return!this.nodes.length}updateReplacement(e,i){if(i.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=i.updateTime;const o=i.getReplacementRegionsForTile(e.toUnwrapped()),l=this.getNodesInfo();for(let u=0;u<this.nodesInfo.length;u++){const h=l[u].node;l[u].hiddenByReplacement=!!h.footprint&&!o.find(m=>m.footprint===h.footprint)}}getHeightAtTileCoord(e,i){const o=this.getNodesInfo(),l=[];for(let u=0;u<this.nodesInfo.length;u++){const h=o[u],m=h.node.meshes[0];if(e<m.aabb.min[0]||i<m.aabb.min[1]||e>m.aabb.max[0]||i>m.aabb.max[1])continue;const _=(e-m.aabb.min[0])/(m.aabb.max[0]-m.aabb.min[0])*fd|0,v=Math.min(63,(i-m.aabb.min[1])/(m.aabb.max[1]-m.aabb.min[1])*fd|0)*fd+Math.min(63,_);if(!(m.heightmap[v]<0&&h.node.footprint))return h.hiddenByReplacement?void 0:{height:m.heightmap[v],maxHeight:h.feature.properties.height,hidden:!1,verticalScale:h.evaluatedScale[2]};if(h.node.footprint.grid.query(new D(e,i),new D(e,i),l),l.length>0)return{height:void 0,maxHeight:h.feature.properties.height,hidden:h.hiddenByReplacement,verticalScale:h.evaluatedScale[2]}}}}function xg(r,e){return!r.isLightConstant&&e}function GH(r,e,i,o,l,u,h,m){let _=(61440&e|(61440&e)>>4)>>8,v=(3840&e|(3840&e)>>4)>>4,x=240&e|(240&e)>>4;i[3]>0&&(_=$r(_,255*i[0],i[3]),v=$r(v,255*i[1],i[3]),x=$r(x,255*i[2],i[3]));const w=_<<8|v,C=x<<8|Math.floor(255*o[3]),k=function(ee){const ce=Oe(ee,0,2);return Math.min(Math.round(.5*ce*255),255)}(o[2])<<8|15*o[0]<<4|15*o[1],P=Oe(l[0],0,1),R=Oe(l[1],0,1),z=Oe(l[2],0,1),B=Oe(l[3],0,1);let H,Z,Y,q;if(P!==R&&h!==u&&R!==P){const ee=h-u;Z=1/(ee*(R-P)),Y=-(u+ee*P)/(ee*(R-P));const ce=Oe(l[4],-1,1);q=Math.pow(10,ce),H=255*z<<8|255*B}else H=65535,Z=0,Y=1,q=1;if(r.emplaceBack(w,C,k,H,Z,Y,q),m){const ee=m.length;m.clear();for(let ce=0;ce<ee;ce++)m.emplaceBack(w,C,k,H,Z,Y,q)}}function qH(r,e){const i=r.node;let o=0;for(const l of i.meshes){if(i.lights&&i.lightMeshIndex===o||!l.featureData)continue;l.featureArray=new s1,l.featureArray.reserve(l.featureData.length);let u=e;for(const h of l.featureData){let m;const _=65535&h,v=(15&_)<8?15&_:0,x=h>>16&65535,w=r.evaluatedRMEA[v],C=r.evaluatedColor[v],k=r.emissionHeightBasedParams[v];if(u&&v===2&&i.lights&&(m=new s1,m.resize(10*i.lights.length)),GH(l.featureArray,x,C,w,k,l.aabb.min[2],l.aabb.max[2],m),m&&u){u=!1;const P=i.meshes[i.lightMeshIndex];P.featureArray=m,P.featureArray._trim()}}l.featureArray._trim(),o++}}xr(eP,"Tiled3dModelBucket",{omit:["layers"]}),xr(QF,"Tiled3dModelFeature");class XH{constructor(){this._updateTime=0,this._sourceIds=[],this._activeRegions=[],this._prevRegions=[]}clear(){this._activeRegions.length>0&&++this._updateTime,this._activeRegions=[],this._prevRegions=[]}get updateTime(){return this._updateTime}getReplacementRegionsForTile(e){const i=nP(new D(0,0),new D(Et,Et),e),o=[];for(const l of this._activeRegions){if(l.hiddenByOverlap||!rP(i,l))continue;const u=ZH(l.min,l.max,e);o.push({min:u.min,max:u.max,sourceId:this._sourceIds[l.priority],footprint:l.footprint,footprintTileId:l.tileId})}return o}setSources(e){this._setSources(e.map(i=>({getSourceId:()=>i.cache.id,getFootprints:()=>{const o=[];for(const l of i.cache.getVisibleCoordinates()){const u=i.cache.getTile(l).buckets[i.layer];if(u)for(const h of u.getNodesInfo()){const m=h.node;m.footprint&&o.push({footprint:m.footprint,id:l.toUnwrapped()})}}return o}})))}_addSource(e){const i=e.getFootprints();if(i.length!==0){for(const o of i){if(!o.footprint)continue;const l=nP(o.footprint.min,o.footprint.max,o.id);this._activeRegions.push({min:l.min,max:l.max,hiddenByOverlap:!1,priority:this._sourceIds.length,tileId:o.id,footprint:o.footprint})}this._sourceIds.push(e.getSourceId())}}_computeReplacement(){this._activeRegions.sort((i,o)=>i.priority-o.priority||sy(i.min,o.min)||sy(i.max,o.max));let e=this._activeRegions.length!==this._prevRegions.length;if(!e){let i=0,o=0;for(;!e&&i!==this._activeRegions.length;){const l=this._activeRegions[i],u=this._prevRegions[o];e=l.priority!==u.priority||!tP(l,u),++i,++o}}if(e){++this._updateTime;const i=o=>{const l=this._activeRegions;if(o>=l.length)return o;const u=l[o].priority;for(;o<l.length&&l[o].priority===u;)++o;return o};if(this._sourceIds.length>1){let o=0,l=i(o);for(;o!==l;){let u=o;const h=o;for(;u!==l;){const m=this._activeRegions[u];m.hiddenByOverlap=!1;for(let _=0;_<h;_++){const v=this._activeRegions[_];if(!v.hiddenByOverlap&&rP(m,v)&&(m.hiddenByOverlap=aP(m.footprint,m.tileId,v.footprint,v.tileId),m.hiddenByOverlap))break}++u}o=l,l=i(o)}}}}_setSources(e){[this._prevRegions,this._activeRegions]=[this._activeRegions,[]],this._sourceIds=[];for(let i=e.length-1;i>=0;i--)this._addSource(e[i]);this._computeReplacement()}}function sy(r,e){return r.x-e.x||r.y-e.y}function tP(r,e){return sy(r.min,e.min)===0&&sy(r.max,e.max)===0}function rP(r,e){return!(r.min.x>e.max.x||r.max.x<e.min.x||r.min.y>e.max.y||r.max.y<e.min.y)}function nP(r,e,i){const o=1/Et,l=1/(1<<i.canonical.z),u=(e.x*o+i.canonical.x)*l+i.wrap,h=(e.y*o+i.canonical.y)*l;return{min:new D((r.x*o+i.canonical.x)*l+i.wrap,(r.y*o+i.canonical.y)*l),max:new D(u,h)}}function ZH(r,e,i){const o=1<<i.canonical.z,l=((e.x-i.wrap)*o-i.canonical.x)*Et,u=(e.y*o-i.canonical.y)*Et;return{min:new D(((r.x-i.wrap)*o-i.canonical.x)*Et,(r.y*o-i.canonical.y)*Et),max:new D(l,u)}}function iP(r,e,i,o,l,u,h){const m=r.indices,_=r.vertices,v=[];for(let x=o;x<o+l;x+=3){const w=e[i[x+0]+u],C=e[i[x+1]+u],k=e[i[x+2]+u],P=Math.min(w.x,C.x,k.x),R=Math.max(w.x,C.x,k.x),z=Math.min(w.y,C.y,k.y),B=Math.max(w.y,C.y,k.y);v.length=0,r.grid.query(new D(P,z),new D(R,B),v);for(let H=0;H<v.length;H++){const Z=v[H];if(dE(_[m[3*Z+0]],_[m[3*Z+1]],_[m[3*Z+2]],w,C,k,h))return!0}}return!1}function aP(r,e,i,o){if(!r||!i)return!1;let l=r.vertices;if(!e.canonical.equals(o.canonical)||e.wrap!==o.wrap){if(i.vertices.length<r.vertices.length)return aP(i,o,r,e);const u=e.canonical,h=o.canonical,m=Math.pow(2,h.z-u.z);l=r.vertices.map(_=>new D(_.x*u.x*Et*m-h.x*Et,_.y*u.y*Et*m-h.y*Et))}return iP(i,l,r.indices,0,r.indices.length,0,0)}const KH=F1.types,YH=["fill-extrusion-base","fill-extrusion-height","fill-extrusion-color","fill-extrusion-pattern","fill-extrusion-flood-light-wall-radius"],JH=["fill-extrusion-flood-light-ground-radius"],QH=Math.pow(2,13),eG=Math.pow(2,15)-1,oP=new D(0,1),$c=2147483648;function bg(r,e,i,o,l,u,h,m){r.emplaceBack((e<<1)+h,(i<<1)+u,(Math.floor(o*QH)<<1)+l,Math.round(m))}function ly(r,e,i,o,l,u){r.emplaceBack(e.x,e.y,(i.x<<1)+o,(i.y<<1)+l,u)}function wg(r,e,i){r.emplaceBack(e.x,e.y,e.z,i[0]*16384,i[1]*16384,i[2]*16384)}class sP{constructor(){this.vertexOffset=0,this.vertexCount=0,this.indexOffset=0,this.indexCount=0}}class lP{constructor(){this.centroidXY=new D(0,0),this.vertexArrayOffset=0,this.vertexCount=0,this.groundVertexArrayOffset=0,this.groundVertexCount=0,this.flags=0,this.footprintSegIdx=-1,this.footprintSegLen=0,this.min=new D(Number.MAX_VALUE,Number.MAX_VALUE),this.max=new D(-Number.MAX_VALUE,-Number.MAX_VALUE),this.height=0}span(){return new D(this.max.x-this.min.x,this.max.y-this.min.y)}}class cP{constructor(){this.acc=new D(0,0),this.accCount=0,this.centroidDataIndex=0}startRing(e,i){e.min.x===Number.MAX_VALUE&&(e.min.x=e.max.x=i.x,e.min.y=e.max.y=i.y)}appendEdge(e,i,o){this.accCount++,this.acc._add(i);let l=!!this.borders;i.x<e.min.x?(e.min.x=i.x,l=!0):i.x>e.max.x&&(e.max.x=i.x,l=!0),i.y<e.min.y?(e.min.y=i.y,l=!0):i.y>e.max.y&&(e.max.y=i.y,l=!0),((i.x===0||i.x===Et)&&i.x===o.x)!=((i.y===0||i.y===Et)&&i.y===o.y)&&this.processBorderOverlap(i,o),l&&this.checkBorderIntersection(i,o)}checkBorderIntersection(e,i){i.x<0!=e.x<0&&this.addBorderIntersection(0,$r(i.y,e.y,(0-i.x)/(e.x-i.x))),i.x>Et!=e.x>Et&&this.addBorderIntersection(1,$r(i.y,e.y,(Et-i.x)/(e.x-i.x))),i.y<0!=e.y<0&&this.addBorderIntersection(2,$r(i.x,e.x,(0-i.y)/(e.y-i.y))),i.y>Et!=e.y>Et&&this.addBorderIntersection(3,$r(i.x,e.x,(Et-i.y)/(e.y-i.y)))}addBorderIntersection(e,i){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const o=this.borders[e];i<o[0]&&(o[0]=i),i>o[1]&&(o[1]=i)}processBorderOverlap(e,i){if(e.x===i.x){if(e.y===i.y)return;const o=e.x===0?0:1;this.addBorderIntersection(o,i.y),this.addBorderIntersection(o,e.y)}else{const o=e.y===0?2:3;this.addBorderIntersection(o,i.x),this.addBorderIntersection(o,e.x)}}centroid(){return this.accCount===0?new D(0,0):new D(Math.floor(Math.max(0,this.acc.x)/this.accCount),Math.floor(Math.max(0,this.acc.y)/this.accCount))}intersectsCount(){return this.borders?this.borders.reduce((e,i)=>e+ +(i[0]!==Number.MAX_VALUE),0):0}}function uP(r,e){const i=r.add(e)._unit(),o=Oe(r.x*i.x+r.y*i.y,-1,1);var l,u,h;return l=Math.acos(o),Math.min(4,Math.max(-4,Math.tan(l)))/4*eG*((u=r).x*(h=e).y-u.y*h.x<0?-1:1)}const tG=[r=>r.x<0,r=>r.x>Et,r=>r.y<0,r=>r.y>Et];function rG(r,e,i,o){const l=[4];if(o===0)return l;i._mult(o);const u=r.sub(i),h=e.sub(i),m=[r,e,u,h];for(let _=0;_<4;_++)for(const v of m)if(tG[_](v)){l.push(_);break}return l}class fP{constructor(e){this.vertexArray=new _2,this.indexArray=new Oa,this.programConfigurations=new Lf(e.layers,e.zoom,i=>JH.includes(i)),this._segments=new ui,this.hiddenByLandmarkVertexArray=new M2,this._segmentToGroundQuads={},this._segmentToGroundQuads[0]=[],this._segmentToRegionTriCounts={},this._segmentToRegionTriCounts[0]=[0,0,0,0,0],this.regionSegments={},this.regionSegments[4]=new ui}getDefaultSegment(){return this.regionSegments[4]}hasData(){return this.vertexArray.length!==0}addData(e,i,o,l=!1){const u=e.length;if(u>2){let h=Math.max(0,this._segments.get().length-1);const m=this._segments._prepareSegment(4*u,this.vertexArray.length,2*this._segmentToGroundQuads[h].length);let _;h!==this._segments.get().length-1&&(h++,this._segmentToGroundQuads[h]=[],this._segmentToRegionTriCounts[h]=[0,0,0,0,0]);{const v=e[0],x=e[1];_=uP(v.sub(e[u-1])._perp()._unit(),x.sub(v)._perp()._unit())}for(let v=0;v<u;v++){const x=v===u-1?0:v+1,w=e[v],C=e[x],k=e[x===u-1?0:x+1],P=C.sub(w)._perp()._unit(),R=uP(P,k.sub(C)._perp()._unit()),z=_,B=R;if(KE(w,C,i)||l&&pP(w,i)&&pP(C,i)){_=R;continue}const H=m.vertexLength;ly(this.vertexArray,w,C,1,1,z),ly(this.vertexArray,w,C,1,0,z),ly(this.vertexArray,w,C,0,1,B),ly(this.vertexArray,w,C,0,0,B),m.vertexLength+=4;const Z=rG(w,C,P,o);for(const Y of Z)this._segmentToGroundQuads[h].push({id:H,region:Y}),this._segmentToRegionTriCounts[h][Y]+=2,m.primitiveLength+=2;_=R}}}prepareBorderSegments(){if(!this.hasData())return;const e=this._segments.get(),i=e.length;for(let o=0;o<i;o++)this._segmentToGroundQuads[o].sort((l,u)=>l.region-u.region);for(let o=0;o<i;o++){const l=this._segmentToGroundQuads[o],u=e[o],h=this._segmentToRegionTriCounts[o];h.reduce((_,v)=>_+v,0);let m=0;for(let _=0;_<=4;_++){const v=h[_];if(v!==0){let x=this.regionSegments[_];x||(x=this.regionSegments[_]=new ui);const w={vertexOffset:u.vertexOffset,primitiveOffset:u.primitiveOffset+m,vertexLength:u.vertexLength,primitiveLength:v};x.get().push(w)}m+=v}for(let _=0;_<l.length;_++){const v=l[_].id;this.indexArray.emplaceBack(v,v+1,v+3),this.indexArray.emplaceBack(v,v+3,v+2)}}this._segmentToGroundQuads=null,this._segmentToRegionTriCounts=null,this._segments.destroy(),this._segments=null}addPaintPropertiesData(e,i,o,l,u,h){this.hasData()&&this.programConfigurations.populatePaintArrays(this.vertexArray.length,e,i,o,l,u,h)}upload(e){this.hasData()&&(this.vertexBuffer=e.createVertexBuffer(this.vertexArray,Mj.members),this.indexBuffer=e.createIndexBuffer(this.indexArray))}uploadPaintProperties(e){this.hasData()&&this.programConfigurations.upload(e)}update(e,i,o,l,u,h){this.hasData()&&this.programConfigurations.updatePaintArrays(e,i,o,l,u,h)}updateHiddenByLandmark(e){if(!this.hasData())return;const i=e.groundVertexCount+e.groundVertexArrayOffset;if(e.groundVertexCount===0)return;const o=e.flags&$c?1:0;for(let l=e.groundVertexArrayOffset;l<i;++l)this.hiddenByLandmarkVertexArray.emplace(l,o);this._needsHiddenByLandmarkUpdate=!0}uploadHiddenByLandmark(e){this.hasData()&&this._needsHiddenByLandmarkUpdate&&(!this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexArray.length>0?this.hiddenByLandmarkVertexBuffer=e.createVertexBuffer(this.hiddenByLandmarkVertexArray,Pj.members,!0):this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.updateData(this.hiddenByLandmarkVertexArray),this._needsHiddenByLandmarkUpdate=!1)}destroy(){if(this.vertexBuffer){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.destroy(),this._segments&&this._segments.destroy(),this.programConfigurations.destroy();for(let e=0;e<=4;e++){const i=this.regionSegments[e];i&&i.destroy()}}}}class Eg{constructor(e){this.zoom=e.zoom,this.canonical=e.canonical,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(i=>i.fqid),this.index=e.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=e.projection,this.activeReplacements=[],this.replacementUpdateTime=0,this.centroidData=[],this.footprintIndices=new Oa,this.footprintVertices=new Es,this.footprintSegments=[],this.layoutVertexArray=new td,this.centroidVertexArray=new b4,this.indexArray=new Oa,this.programConfigurations=new Lf(e.layers,e.zoom,i=>YH.includes(i)),this.segments=new ui,this.stateDependentLayerIds=this.layers.filter(i=>i.isStateDependent()).map(i=>i.id),this.groundEffect=new fP(e),this.maxHeight=0,this.partLookup={}}populate(e,i,o,l){this.features=[],this.hasPattern=xE("fill-extrusion",this.layers,i),this.featuresOnBorder=[],this.borderFeatureIndices=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=rg(o),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter;for(const{feature:u,id:h,index:m,sourceLayerIndex:_}of e){const v=this.layers[0]._featureFilter.needGeometry,x=$f(u,v);if(!this.layers[0]._featureFilter.filter(new Gi(this.zoom),x,o))continue;const w={id:h,sourceLayerIndex:_,index:m,geometry:v?x.geometry:Bc(u,o,l),properties:u.properties,type:u.type,patterns:{}},C=this.layoutVertexArray.length;this.hasPattern?this.features.push(bE("fill-extrusion",this.layers,w,this.zoom,i)):this.addFeature(w,w.geometry,m,o,{},i.availableImages,l,i.brightness),i.featureIndex.insert(u,w.geometry,m,_,this.index,C)}this.sortBorders(),this.groundEffect.prepareBorderSegments()}addFeatures(e,i,o,l,u,h){for(const m of this.features){const{geometry:_}=m;this.addFeature(m,_,m.index,i,o,l,u,h)}this.sortBorders()}update(e,i,o,l,u){const h=Object.keys(e).length!==0;if(h&&!this.stateDependentLayers.length)return;const m=h?this.stateDependentLayers:this.layers;this.programConfigurations.updatePaintArrays(e,i,m,o,l,u),this.groundEffect.update(e,i,m,o,l,u)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload||this.groundEffect.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Rj),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=e.createVertexBuffer(this.layoutVertexExtArray,Oj.members,!0)),this.groundEffect.upload(e)),this.groundEffect.uploadPaintProperties(e),this.programConfigurations.upload(e),this.uploaded=!0}uploadCentroid(e){this.groundEffect.uploadHiddenByLandmark(e),this.needsCentroidUpdate&&(!this.centroidVertexBuffer&&this.centroidVertexArray.length>0?this.centroidVertexBuffer=e.createVertexBuffer(this.centroidVertexArray,Fj.members,!0):this.centroidVertexBuffer&&this.centroidVertexBuffer.updateData(this.centroidVertexArray),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.groundEffect.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(e,i,o,l,u,h,m,_){const v=this.layers[0].paint.get("fill-extrusion-flood-light-ground-radius").evaluate(e,{})/this.tileToMeter,x=[new D(0,0),new D(Et,Et)],w=m.projection,C=w.name==="globe",k=KH[e.type]==="Polygon",P=new cP;P.centroidDataIndex=this.centroidData.length;const R=new lP,z=this.layers[0].paint.get("fill-extrusion-base").evaluate(e,{},l)<=0,B=this.layers[0].paint.get("fill-extrusion-height").evaluate(e,{},l);R.height=B,R.vertexArrayOffset=this.layoutVertexArray.length,R.groundVertexArrayOffset=this.groundEffect.vertexArray.length,C&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new a1);const H=yE(i,500);for(let de=H.length-1;de>=0;de--){const ge=H[de];(ge.length===0||(Z=ge[0]).every(ve=>ve.x<=0)||Z.every(ve=>ve.x>=Et)||Z.every(ve=>ve.y<=0)||Z.every(ve=>ve.y>=Et))&&H.splice(de,1)}var Z;let Y;if(C)Y=vP(H,x,l);else{Y=[];for(const de of H)Y.push({polygon:de,bounds:x})}const q=k?this.edgeRadius:0,ee=q>0&&this.zoom<17,ce=(de,ge)=>{if(de.length===0)return!1;const ve=de[de.length-1];return ge.x===ve.x&&ge.y===ve.y};for(const{polygon:de,bounds:ge}of Y){let ve=0,Re=0;for(const Ie of de)k&&!Ie[0].equals(Ie[Ie.length-1])&&Ie.push(Ie[0]),Re+=k?Ie.length-1:Ie.length;const ke=this.segments.prepareSegment((k?5:4)*Re,this.layoutVertexArray,this.indexArray);R.footprintSegIdx<0&&(R.footprintSegIdx=this.footprintSegments.length);const $e=new sP;if($e.vertexOffset=this.footprintVertices.length,$e.indexOffset=3*this.footprintIndices.length,$e.ringIndices=[],k){const Ie=[],Qe=[];ve=ke.vertexLength;for(let ft=0;ft<de.length;ft++){const Je=de[ft];Je.length&&ft!==0&&Qe.push(Ie.length/2);const tt=[];let pt,bt;pt=Je[1].sub(Je[0])._perp()._unit(),$e.ringIndices.push(Je.length-1);for(let St=1;St<Je.length;St++){const Pt=Je[St],Ut=Je[St===Je.length-1?1:St+1],Tt=Pt.clone();if(q){bt=Ut.sub(Pt)._perp()._unit();const Mt=pt.add(bt)._unit(),tr=q*Math.min(4,1/(pt.x*Mt.x+pt.y*Mt.y));Tt.x+=tr*Mt.x,Tt.y+=tr*Mt.y,Tt.x=Math.round(Tt.x),Tt.y=Math.round(Tt.y),pt=bt}!z||q!==0&&!ee||ce(tt,Tt)||tt.push(Tt),bg(this.layoutVertexArray,Tt.x,Tt.y,0,0,1,1,0),ke.vertexLength++,this.footprintVertices.emplaceBack(Pt.x,Pt.y),Ie.push(Pt.x,Pt.y),C&&wg(this.layoutVertexExtArray,w.projectTilePoint(Tt.x,Tt.y,l),w.upVector(l,Tt.x,Tt.y))}z&&(q===0||ee)&&(tt.length!==0&&ce(tt,tt[0])&&tt.pop(),this.groundEffect.addData(tt,ge,v))}const st=k1(Ie,Qe);for(let ft=0;ft<st.length;ft+=3)this.footprintIndices.emplaceBack($e.vertexOffset+st[ft+0],$e.vertexOffset+st[ft+1],$e.vertexOffset+st[ft+2]),this.indexArray.emplaceBack(ve+st[ft],ve+st[ft+2],ve+st[ft+1]),ke.primitiveLength++;$e.indexCount+=st.length,$e.vertexCount+=this.footprintVertices.length-$e.vertexOffset}for(let Ie=0;Ie<de.length;Ie++){const Qe=de[Ie];P.startRing(R,Qe[0]);let st=Qe.length>4&&mP(Qe[Qe.length-2],Qe[0],Qe[1]),ft=q?nG(Qe[Qe.length-2],Qe[0],Qe[1],q):0;const Je=[];let tt,pt,bt;pt=Qe[1].sub(Qe[0])._perp()._unit();let St=!0;for(let Pt=1,Ut=0;Pt<Qe.length;Pt++){let Tt=Qe[Pt-1],Mt=Qe[Pt];const tr=Qe[Pt===Qe.length-1?1:Pt+1];if(P.appendEdge(R,Mt,Tt),KE(Mt,Tt,ge)){q&&(pt=tr.sub(Mt)._perp()._unit(),St=!St);continue}const ur=Mt.sub(Tt)._perp(),cr=ur.x/(Math.abs(ur.x)+Math.abs(ur.y)),hr=ur.y>0?1:0,Mr=Tt.dist(Mt);if(Ut+Mr>32768&&(Ut=0),q){bt=tr.sub(Mt)._perp()._unit();let on=dP(Tt,Mt,tr,hP(pt,bt),q);isNaN(on)&&(on=0);const Qr=Mt.sub(Tt)._unit();Tt=Tt.add(Qr.mult(ft))._round(),Mt=Mt.add(Qr.mult(-on))._round(),ft=on,pt=bt,z&&this.zoom>=17&&(ce(Je,Tt)||Je.push(Tt),ce(Je,Mt)||Je.push(Mt))}const jr=ke.vertexLength,gn=Qe.length>4&&mP(Tt,Mt,tr);let Bn=gP(Ut,st,St);if(bg(this.layoutVertexArray,Tt.x,Tt.y,cr,hr,0,0,Bn),bg(this.layoutVertexArray,Tt.x,Tt.y,cr,hr,0,1,Bn),Ut+=Mr,Bn=gP(Ut,gn,!St),st=gn,bg(this.layoutVertexArray,Mt.x,Mt.y,cr,hr,0,0,Bn),bg(this.layoutVertexArray,Mt.x,Mt.y,cr,hr,0,1,Bn),ke.vertexLength+=4,this.indexArray.emplaceBack(jr+0,jr+1,jr+2),this.indexArray.emplaceBack(jr+1,jr+3,jr+2),ke.primitiveLength+=2,q){const on=ve+(Pt===1?Qe.length-2:Pt-2),Qr=Pt===1?ve:on+1;if(this.indexArray.emplaceBack(jr+1,on,jr+3),this.indexArray.emplaceBack(on,Qr,jr+3),ke.primitiveLength+=2,tt===void 0&&(tt=jr),!KE(tr,Qe[Pt],ge)){const Vr=Pt===Qe.length-1?tt:ke.vertexLength;this.indexArray.emplaceBack(jr+2,jr+3,Vr),this.indexArray.emplaceBack(jr+3,Vr+1,Vr),this.indexArray.emplaceBack(jr+3,Qr,Vr+1),ke.primitiveLength+=3}St=!St}if(C){const on=this.layoutVertexExtArray,Qr=w.projectTilePoint(Tt.x,Tt.y,l),Vr=w.projectTilePoint(Mt.x,Mt.y,l),Dr=w.upVector(l,Tt.x,Tt.y),In=w.upVector(l,Mt.x,Mt.y);wg(on,Qr,Dr),wg(on,Qr,Dr),wg(on,Vr,In),wg(on,Vr,In)}}k&&(ve+=Qe.length-1),z&&q&&this.zoom>=17&&(Je.length!==0&&ce(Je,Je[0])&&Je.pop(),this.groundEffect.addData(Je,ge,v,q>0))}this.footprintSegments.push($e),++R.footprintSegLen}if(R.vertexCount=this.layoutVertexArray.length-R.vertexArrayOffset,R.groundVertexCount=this.groundEffect.vertexArray.length-R.groundVertexArrayOffset,R.vertexCount!==0){if(R.centroidXY=P.borders?oP:this.encodeCentroid(P,R),this.centroidData.push(R),P.borders){this.featuresOnBorder.push(P);const de=this.featuresOnBorder.length-1;for(let ge=0;ge<P.borders.length;ge++)P.borders[ge][0]!==Number.MAX_VALUE&&this.borderFeatureIndices[ge].push(de)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,o,u,h,l,_),this.groundEffect.addPaintPropertiesData(e,o,u,h,l,_),this.maxHeight=Math.max(this.maxHeight,B)}}sortBorders(){for(let e=0;e<this.borderFeatureIndices.length;e++)this.borderFeatureIndices[e].sort((i,o)=>this.featuresOnBorder[i].borders[e][0]-this.featuresOnBorder[o].borders[e][0])}encodeCentroid(e,i){const o=e.centroid(),l=i.span(),u=Math.min(7,Math.round(l.x*this.tileToMeter/10)),h=Math.min(7,Math.round(l.y*this.tileToMeter/10));return new D(Oe(o.x,1,Et-1)<<3|u,Oe(o.y,1,Et-1)<<3|h)}showCentroid(e){const i=this.centroidData[e.centroidDataIndex];i.flags&=$c,i.centroidXY.x=0,i.centroidXY.y=0,this.writeCentroidToBuffer(i)}writeCentroidToBuffer(e){this.groundEffect.updateHiddenByLandmark(e);const i=e.vertexArrayOffset,o=e.vertexCount+e.vertexArrayOffset,l=e.flags&$c?oP:e.centroidXY,u=this.centroidVertexArray.geta_centroid_pos0(i);if(this.centroidVertexArray.geta_centroid_pos1(i)!==l.y||u!==l.x){for(let h=i;h<o;++h)this.centroidVertexArray.emplace(h,l.x,l.y);this.needsCentroidUpdate=!0}}createCentroidsBuffer(){this.centroidVertexArray.resize(this.layoutVertexArray.length),this.groundEffect.hiddenByLandmarkVertexArray.resize(this.groundEffect.vertexArray.length);for(const e of this.centroidData)this.writeCentroidToBuffer(e)}updateReplacement(e,i){if(i.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=i.updateTime;const o=i.getReplacementRegionsForTile(e.toUnwrapped());if(function(u,h){if(u.length!==h.length)return!1;for(let m=0;m<u.length;m++)if(u[m].sourceId!==h[m].sourceId||!tP(u[m],h[m]))return!1;return!0}(this.activeReplacements,o))return;if(this.activeReplacements=o,this.centroidVertexArray.length===0)this.createCentroidsBuffer();else for(const u of this.centroidData)u.flags&=2147483647;const l=[];for(const u of this.activeReplacements){const h=Math.pow(2,u.footprintTileId.canonical.z-e.canonical.z);for(const m of this.centroidData)if(!(m.flags&$c||u.min.x>m.max.x||m.min.x>u.max.x||u.min.y>m.max.y||m.min.y>u.max.y))for(let _=0;_<m.footprintSegLen;_++){const v=this.footprintSegments[m.footprintSegIdx+_];if(l.length=0,iG(this.footprintVertices,v.vertexOffset,v.vertexCount,u.footprintTileId.canonical,e.canonical,l),iP(u.footprint,l,this.footprintIndices.uint16,v.indexOffset,v.indexCount,-v.vertexOffset,-h)){m.flags|=$c;break}}}for(const u of this.centroidData)this.writeCentroidToBuffer(u);this.borderDoneWithNeighborZ=[-1,-1,-1,-1]}footprintContainsPoint(e,i,o){let l=!1;for(let u=0;u<o.footprintSegLen;u++){const h=this.footprintSegments[o.footprintSegIdx+u];let m=0;for(const _ of h.ringIndices){for(let v=m,x=_+m-1;v<_+m;x=v++){const w=this.footprintVertices.int16[2*(v+h.vertexOffset)+0],C=this.footprintVertices.int16[2*(v+h.vertexOffset)+1],k=this.footprintVertices.int16[2*(x+h.vertexOffset)+1];C>i!=k>i&&e<(this.footprintVertices.int16[2*(x+h.vertexOffset)+0]-w)*(i-C)/(k-C)+w&&(l=!l)}m=_}}return l}getHeightAtTileCoord(e,i){let o=Number.NEGATIVE_INFINITY,l=!0;const u=4*(e+Et)*Et+(i+Et);if(this.partLookup.hasOwnProperty(u)){const h=this.partLookup[u];return h?{height:h.height,hidden:!!(h.flags&$c)}:void 0}for(const h of this.centroidData)e>h.max.x||h.min.x>e||i>h.max.y||h.min.y>i||this.footprintContainsPoint(e,i,h)&&h&&h.height>o&&(o=h.height,this.partLookup[u]=h,l=!!(h.flags&$c));if(o!==Number.NEGATIVE_INFINITY)return{height:o,hidden:l};this.partLookup[u]=void 0}}function hP(r,e){const i=r.add(e)._unit();return r.x*i.x+r.y*i.y}function nG(r,e,i,o){const l=e.sub(r)._perp()._unit(),u=i.sub(e)._perp()._unit();return dP(r,e,i,hP(l,u),o)}function dP(r,e,i,o,l){const u=Math.sqrt(1-o*o);return Math.min(r.dist(e)/3,e.dist(i)/3,l*u/o)}function KE(r,e,i){return r.x<i[0].x&&e.x<i[0].x||r.x>i[1].x&&e.x>i[1].x||r.y<i[0].y&&e.y<i[0].y||r.y>i[1].y&&e.y>i[1].y}function pP(r,e){return r.x<e[0].x||r.x>e[1].x||r.y<e[0].y||r.y>e[1].y}function mP(r,e,i){if(r.x<0||r.x>=Et||e.x<0||e.x>=Et||i.x<0||i.x>=Et)return!1;const o=i.sub(e),l=o.perp(),u=r.sub(e);return(o.x*u.x+o.y*u.y)/Math.sqrt((o.x*o.x+o.y*o.y)*(u.x*u.x+u.y*u.y))>-.866&&l.x*u.x+l.y*u.y<0}function gP(r,e,i){const o=e?2|r:-3&r;return i?1|o:-2&o}function _P(){const r=Math.PI/32,e=Math.tan(r),i=Hp;return i*Math.sqrt(1+2*e*e)-i}function vP(r,e,i){const o=1<<i.z,l=Ss(i.x/o),u=Ss((i.x+1)/o),h=ka(i.y/o),m=ka((i.y+1)/o);return function(_,v,x,w,C=0,k){const P=[];if(!_.length||!x||!w)return P;const R=(ee,ce)=>{for(const de of ee)P.push({polygon:de,bounds:ce})},z=Math.ceil(Math.log2(x)),B=Math.ceil(Math.log2(w)),H=z-B,Z=[];for(let ee=0;ee<Math.abs(H);ee++)Z.push(H>0?0:1);for(let ee=0;ee<Math.min(z,B);ee++)Z.push(0),Z.push(1);let Y=_;if(Y=P1(Y,v[0].y-C,v[1].y+C,1),Y=P1(Y,v[0].x-C,v[1].x+C,0),!Y.length)return P;const q=[];for(Z.length?q.push({polygons:Y,bounds:v,depth:0}):R(Y,v);q.length;){const ee=q.pop(),ce=ee.depth,de=Z[ce],ge=ee.bounds[0],ve=ee.bounds[1],Re=de===0?ge.x:ge.y,ke=de===0?ve.x:ve.y,$e=k?k(de,Re,ke):.5*(Re+ke),Ie=P1(ee.polygons,Re-C,$e+C,de),Qe=P1(ee.polygons,$e-C,ke+C,de);if(Ie.length){const st=[ge,new D(de===0?$e:ve.x,de===1?$e:ve.y)];Z.length>ce+1?q.push({polygons:Ie,bounds:st,depth:ce+1}):R(Ie,st)}if(Qe.length){const st=[new D(de===0?$e:ge.x,de===1?$e:ge.y),ve];Z.length>ce+1?q.push({polygons:Qe,bounds:st,depth:ce+1}):R(Qe,st)}}return P}(r,e,Math.ceil((u-l)/11.25),Math.ceil((h-m)/11.25),1,(_,v,x)=>{if(_===0)return .5*(v+x);{const w=ka((i.y+v/Et)/o);return(oo(.5*(ka((i.y+x/Et)/o)+w))*o-i.y)*Et}})}function iG(r,e,i,o,l,u){const h=Math.pow(2,o.z-l.z);for(let m=0;m<i;m++){let _=r.int16[2*(m+e)+0],v=r.int16[2*(m+e)+1];_=(_+l.x*Et)*h-o.x*Et,v=(v+l.y*Et)*h-o.y*Et,u.push(new D(_,v))}}xr(Eg,"FillExtrusionBucket",{omit:["layers","features"]}),xr(lP,"PartData"),xr(sP,"FootprintSegment"),xr(cP,"BorderCentroidData"),xr(fP,"GroundEffect");const aG=new sa({visibility:new Yt(at["layout_fill-extrusion"].visibility),"fill-extrusion-edge-radius":new Yt(at["layout_fill-extrusion"]["fill-extrusion-edge-radius"])});var oG={paint:new sa({"fill-extrusion-opacity":new Yt(at["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Pr(at["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Yt(at["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Yt(at["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Pr(at["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Pr(at["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Pr(at["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Yt(at["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new Yt(at["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new Yt(at["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"]),"fill-extrusion-ambient-occlusion-wall-radius":new Yt(at["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-wall-radius"]),"fill-extrusion-ambient-occlusion-ground-radius":new Yt(at["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-radius"]),"fill-extrusion-ambient-occlusion-ground-attenuation":new Yt(at["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-attenuation"]),"fill-extrusion-flood-light-color":new Yt(at["paint_fill-extrusion"]["fill-extrusion-flood-light-color"]),"fill-extrusion-flood-light-intensity":new Yt(at["paint_fill-extrusion"]["fill-extrusion-flood-light-intensity"]),"fill-extrusion-flood-light-wall-radius":new Pr(at["paint_fill-extrusion"]["fill-extrusion-flood-light-wall-radius"]),"fill-extrusion-flood-light-ground-radius":new Pr(at["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-radius"]),"fill-extrusion-flood-light-ground-attenuation":new Yt(at["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-attenuation"]),"fill-extrusion-vertical-scale":new Yt(at["paint_fill-extrusion"]["fill-extrusion-vertical-scale"]),"fill-extrusion-rounded-roof":new Yt(at["paint_fill-extrusion"]["fill-extrusion-rounded-roof"]),"fill-extrusion-cutoff-fade-range":new Yt(at["paint_fill-extrusion"]["fill-extrusion-cutoff-fade-range"])}),layout:aG};class s0 extends D{constructor(e,i,o){super(e,i),this.z=o}}function Tg(r,e){return r.x*e.x+r.y*e.y}function yP(r,e){if(r.length===1){let i=0;const o=e[i++];let l;for(;!l||o.equals(l);)if(l=e[i++],!l)return 1/0;for(;i<e.length;i++){const u=e[i],h=r[0],m=l.sub(o),_=u.sub(o),v=h.sub(o),x=Tg(m,m),w=Tg(m,_),C=Tg(_,_),k=Tg(v,m),P=Tg(v,_),R=x*C-w*w,z=(C*k-w*P)/R,B=(x*P-w*k)/R,H=o.z*(1-z-B)+l.z*z+u.z*B;if(isFinite(H))return H}return 1/0}{let i=1/0;for(const o of e)i=Math.min(i,o.z);return i}}function xP(r,e,i,o,l,u,h,m){const _=h*l.getElevationAt(r,e,!0,!0),v=u[0]!==0,x=v?u[1]===0?h*(u[0]/7-450):h*function(w,C,k){const P=Math.floor(C[0]/8),R=Math.floor(C[1]/8),z=10*(C[0]-8*P),B=10*(C[1]-8*R),H=w.getElevationAt(P,R,!0,!0),Z=w.getMeterToDEM(k),Y=Math.floor(.5*(z*Z-1)),q=Math.floor(.5*(B*Z-1)),ee=w.tileCoordToPixel(P,R),ce=2*Y+1,de=2*q+1,ge=function(Qe,st,ft,Je,tt){return[Qe.getElevationAtPixel(st,ft,!0),Qe.getElevationAtPixel(st+tt,ft,!0),Qe.getElevationAtPixel(st,ft+tt,!0),Qe.getElevationAtPixel(st+Je,ft+tt,!0)]}(w,ee.x-Y,ee.y-q,ce,de),ve=Math.abs(ge[0]-ge[1]),Re=Math.abs(ge[2]-ge[3]),ke=Math.abs(ge[0]-ge[2])+Math.abs(ge[1]-ge[3]),$e=Math.min(.25,.5*Z*(ve+Re)/ce),Ie=Math.min(.25,.5*Z*ke/de);return H+Math.max($e*z,Ie*B)}(l,u,m):_;return{base:_+(i===0)?-1:i,top:v?Math.max(x+o,_+i+2):_+o}}const sG=new sa({"line-cap":new Pr(at.layout_line["line-cap"]),"line-join":new Pr(at.layout_line["line-join"]),"line-miter-limit":new Yt(at.layout_line["line-miter-limit"]),"line-round-limit":new Yt(at.layout_line["line-round-limit"]),"line-sort-key":new Pr(at.layout_line["line-sort-key"]),visibility:new Yt(at.layout_line.visibility)});var bP={paint:new sa({"line-opacity":new Pr(at.paint_line["line-opacity"]),"line-color":new Pr(at.paint_line["line-color"]),"line-translate":new Yt(at.paint_line["line-translate"]),"line-translate-anchor":new Yt(at.paint_line["line-translate-anchor"]),"line-width":new Pr(at.paint_line["line-width"]),"line-gap-width":new Pr(at.paint_line["line-gap-width"]),"line-offset":new Pr(at.paint_line["line-offset"]),"line-blur":new Pr(at.paint_line["line-blur"]),"line-dasharray":new Pr(at.paint_line["line-dasharray"]),"line-pattern":new Pr(at.paint_line["line-pattern"]),"line-gradient":new Gm(at.paint_line["line-gradient"]),"line-trim-offset":new Yt(at.paint_line["line-trim-offset"]),"line-emissive-strength":new Yt(at.paint_line["line-emissive-strength"]),"line-border-width":new Pr(at.paint_line["line-border-width"]),"line-border-color":new Pr(at.paint_line["line-border-color"])}),layout:sG};const lG=(r,e,i,o,l,u,h)=>{const m=r.transform,_=m.calculatePixelsToTileUnitsMatrix(e);return{u_matrix:EP(r,e,i,o),u_pixels_to_tile_units:_,u_device_pixel_ratio:u,u_units_to_pixels:[1/m.pixelsToGLUnits[0],1/m.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:l,u_texsize:SP(i)?e.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:wP(e,r.transform),u_alpha_discard_threshold:0,u_trim_offset:h,u_emissive_strength:i.paint.get("line-emissive-strength")}},cG=(r,e,i,o,l)=>{const u=r.transform;return{u_matrix:EP(r,e,i,o),u_texsize:e.imageAtlasTexture.size,u_pixels_to_tile_units:u.calculatePixelsToTileUnitsMatrix(e),u_device_pixel_ratio:l,u_image:0,u_tile_units_to_pixels:wP(e,u),u_units_to_pixels:[1/u.pixelsToGLUnits[0],1/u.pixelsToGLUnits[1]],u_alpha_discard_threshold:0}};function wP(r,e){return 1/ud(r,1,e.tileZoom)}function EP(r,e,i,o){return r.translatePosMatrix(o||e.tileID.projMatrix,e,i.paint.get("line-translate"),i.paint.get("line-translate-anchor"))}const TP=r=>{const e=[];SP(r)&&e.push("RENDER_LINE_DASH"),r.paint.get("line-gradient")&&e.push("RENDER_LINE_GRADIENT");const i=r.paint.get("line-trim-offset");return i[0]===0&&i[1]===0||e.push("RENDER_LINE_TRIM_OFFSET"),r.paint.get("line-border-width").constantOr(1)!==0&&e.push("RENDER_LINE_BORDER"),e};function SP(r){const e=r.paint.get("line-dasharray").value;return e.value||e.kind!=="constant"}const CP=new class extends Pr{possiblyEvaluate(r,e){return e=new Gi(Math.floor(e.zoom),{now:e.now,fadeDuration:e.fadeDuration,transition:e.transition}),super.possiblyEvaluate(r,e)}evaluate(r,e,i,o){return e=ze({},e,{zoom:Math.floor(e.zoom)}),super.evaluate(r,e,i,o)}}(bP.paint.properties["line-width"].specification);function AP(r,e){return e>0?e+2*r:r}CP.useIntegerZoom=!0;const uG=new sa({visibility:new Yt(at.layout_background.visibility)});var fG={paint:new sa({"background-color":new Yt(at.paint_background["background-color"]),"background-pattern":new Yt(at.paint_background["background-pattern"]),"background-opacity":new Yt(at.paint_background["background-opacity"]),"background-emissive-strength":new Yt(at.paint_background["background-emissive-strength"])}),layout:uG};const hG=new sa({visibility:new Yt(at.layout_raster.visibility)});var dG={paint:new sa({"raster-opacity":new Yt(at.paint_raster["raster-opacity"]),"raster-color":new Gm(at.paint_raster["raster-color"]),"raster-color-mix":new Yt(at.paint_raster["raster-color-mix"]),"raster-color-range":new Yt(at.paint_raster["raster-color-range"]),"raster-hue-rotate":new Yt(at.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Yt(at.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Yt(at.paint_raster["raster-brightness-max"]),"raster-saturation":new Yt(at.paint_raster["raster-saturation"]),"raster-contrast":new Yt(at.paint_raster["raster-contrast"]),"raster-resampling":new Yt(at.paint_raster["raster-resampling"]),"raster-fade-duration":new Yt(at.paint_raster["raster-fade-duration"])}),layout:hG};function kP(r,e,i,o,l,u,h,m){const _=[r,i,l,e,o,u,1,1,1],v=[h,m,1],x=rs.adjoint([],_),[w,C,k]=We.transformMat3(v,v,rs.transpose(x,x));return rs.multiply(_,[w,0,0,0,C,0,0,0,k],_)}class Vc extends Ln{constructor(e,i,o,l){super(),this.id=e,this.dispatcher=o,this.coordinates=i.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.onNorthPole=!1,this.onSouthPole=!1,this.setEventedParent(l),this.options=i,this._dirty=!1}load(e,i){if(this._loaded=i||!1,this.fire(new _t("dataloading",{dataType:"source"})),this.url=this.options.url,!this.url)return e&&(this.coordinates=e),this._loaded=!0,void this._finishLoading();this._imageRequest=Ur(this.map._requestManager.transformRequest(this.url,Le.Image),(o,l)=>{if(this._imageRequest=null,this._loaded=!0,o)this.fire(new ar(o));else if(l){const{HTMLImageElement:u}=g;this.image=l instanceof u?Jr.getImageData(l):l,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,e&&(this.coordinates=e),this._finishLoading()}})}loaded(){return this._loaded}updateImage(e){return this.image&&e.url?(this._imageRequest&&e.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=e.url,this.load(e.coordinates,this._loaded),this):this}setTexture(e){if(!(e.handle instanceof WebGLTexture))throw new Error("The provided handle is not a WebGLTexture instance");return this.texture=new J1(this.map.painter.context,e.handle),this.width=e.dimensions[0],this.height=e.dimensions[1],this._dirty=!1,this._loaded=!0,this._finishLoading(),this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new _t("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(e){this.map=e,this.load()}onRemove(){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),!this.texture||this.texture instanceof J1||this.texture.destroy()}setCoordinates(e){if(this.coordinates=e,this._boundsArray=void 0,!e.length)return this;this.onNorthPole=!1,this.onSouthPole=!1;let i=e[0][1],o=e[0][1];for(const u of e)u[1]>o&&(o=u[1]),u[1]<i&&(i=u[1]);const l=(o+i)/2;if(l>ha?this.onNorthPole=!0:l<-ha&&(this.onSouthPole=!0),!this.onNorthPole&&!this.onSouthPole){const u=e.map(Pn.fromLngLat);this.tileID=function(h){let m=1/0,_=1/0,v=-1/0,x=-1/0;for(const P of h)m=Math.min(m,P.x),_=Math.min(_,P.y),v=Math.max(v,P.x),x=Math.max(x,P.y);const w=Math.max(v-m,x-_),C=Math.max(0,Math.floor(-Math.log(w)/Math.LN2)),k=Math.pow(2,C);return new Dc(C,Math.floor((m+v)/2*k),Math.floor((_+x)/2*k))}(u),this.minzoom=this.maxzoom=this.tileID.z}return this.fire(new _t("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0}_prepareData(e){for(const _ in this.tiles){const v=this.tiles[_];v.state!=="loaded"&&(v.state="loaded",v.texture=this.texture)}if(this._boundsArray)return;const i=cd(this.tileID,this.map.transform.projection),[o,l,u,h]=this.coordinates.map(_=>{const v=i.projection.project(_[0],_[1]);return gF(i,v)._round()});this.perspectiveTransform=function(_,v,x,w,C,k,P,R,z,B){const H=kP(0,0,_,0,0,v,_,v),Z=kP(x,w,C,k,P,R,z,B);return rs.multiply(Z,rs.adjoint(H,H),Z),[Z[6]/Z[8]*_/Et,Z[7]/Z[8]*v/Et]}(this.width,this.height,o.x,o.y,l.x,l.y,h.x,h.y,u.x,u.y);const m=this._boundsArray=new td;m.emplaceBack(o.x,o.y,0,0),m.emplaceBack(l.x,l.y,Et,0),m.emplaceBack(h.x,h.y,0,Et),m.emplaceBack(u.x,u.y,Et,Et),this.boundsBuffer&&this.boundsBuffer.destroy(),this.boundsBuffer=e.createVertexBuffer(m,NE.members),this.boundsSegments=ui.simpleSegment(0,0,4,2)}prepare(){const e=Object.keys(this.tiles).length!==0;if(this.tileID&&!e)return;const i=this.map.painter.context,o=i.gl;!this._dirty||this.texture instanceof J1||(this.texture?this.texture.update(this.image):(this.texture=new Ia(i,this.image,o.RGBA),this.texture.bind(o.LINEAR,o.CLAMP_TO_EDGE)),this._dirty=!1),e&&this._prepareData(i)}loadTile(e,i){this.tileID&&this.tileID.equals(e.tileID.canonical)?(this.tiles[String(e.tileID.wrap)]=e,e.buckets={},i(null)):(e.state="errored",i(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}class pG extends Zs{constructor(e){super(e,{}),this.implementation=e,e.slot&&(this.slot=e.slot)}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}isLayerDraped(e){return this.implementation.renderToTile!==void 0}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(e){this.implementation.onAdd&&this.implementation.onAdd(e,e.painter.context.gl)}onRemove(e){this.implementation.onRemove&&this.implementation.onRemove(e,e.painter.context.gl)}}const mG=new sa({visibility:new Yt(at.layout_sky.visibility)});var gG={paint:new sa({"sky-type":new Yt(at.paint_sky["sky-type"]),"sky-atmosphere-sun":new Yt(at.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new Yt(at.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new Yt(at.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new Yt(at.paint_sky["sky-gradient-radius"]),"sky-gradient":new Gm(at.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new Yt(at.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new Yt(at.paint_sky["sky-atmosphere-color"]),"sky-opacity":new Yt(at.paint_sky["sky-opacity"])}),layout:mG};function YE(r,e,i){const o=[0,0,1],l=ao.identity([]);return ao.rotateY(l,l,i?-le(r)+Math.PI:le(r)),ao.rotateX(l,l,-le(e)),We.transformQuat(o,o,l),We.normalize(o,o)}var _G={paint:new sa({})};const vG={circle:class extends Zs{constructor(r,e){super(r,aj,e)}createBucket(r){return new uE(r)}queryRadius(r){const e=r;return qp("circle-radius",this,e)+qp("circle-stroke-width",this,e)+w1(this.paint.get("circle-translate"))}queryIntersectsFeature(r,e,i,o,l,u,h,m){const _=mM(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),u.angle,r.pixelToTileUnitsFactor),v=this.paint.get("circle-radius").evaluate(e,i)+this.paint.get("circle-stroke-width").evaluate(e,i);return _M(r,o,u,h,m,this.paint.get("circle-pitch-alignment")==="map",this.paint.get("circle-pitch-scale")==="map",_,v)}getProgramIds(){return["circle"]}getDefaultProgramParams(r,e){const i=gM(this);return{config:new nd(this,e),defines:i,overrideFog:!1}}},heatmap:class extends Zs{createBucket(r){return new yM(r)}constructor(r,e){super(r,hj,e),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(r){r==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=E1({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(r){return qp("heatmap-radius",this,r)}queryIntersectsFeature(r,e,i,o,l,u,h,m){const _=this.paint.get("heatmap-radius").evaluate(e,i);return _M(r,o,u,h,m,!0,!0,new D(0,0),_)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}getProgramIds(){return["heatmap","heatmapTexture"]}getDefaultProgramParams(r,e){return r==="heatmap"?{config:new nd(this,e),overrideFog:!1}:{}}},hillshade:class extends Zs{constructor(r,e){super(r,pj,e)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}getProgramIds(){return["hillshade","hillshadePrepare"]}getDefaultProgramParams(r,e){return{overrideFog:!1}}},fill:class extends Zs{constructor(r,e){super(r,kj,e)}getProgramIds(){const r=this.paint.get("fill-pattern"),e=r&&r.constantOr(1),i=[e?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&i.push(e&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),i}getDefaultProgramParams(r,e){return{config:new nd(this,e),overrideFog:!1}}recalculate(r,e){super.recalculate(r,e);const i=this.paint._values["fill-outline-color"];i.value.kind==="constant"&&i.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(r){return new I1(r)}queryRadius(){return w1(this.paint.get("fill-translate"))}queryIntersectsFeature(r,e,i,o,l,u){return!r.queryGeometry.isAboveHorizon&&uM(pM(r.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),u.angle,r.pixelToTileUnitsFactor),o)}isTileClipped(){return!0}},"fill-extrusion":class extends Zs{constructor(r,e){super(r,oG,e)}createBucket(r){return new Eg(r)}queryRadius(){return w1(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}hasShadowPass(){return!0}cutoffRange(){return this.paint.get("fill-extrusion-cutoff-fade-range")}canCastShadows(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}queryIntersectsFeature(r,e,i,o,l,u,h,m,_){const v=mM(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),u.angle,r.pixelToTileUnitsFactor),x=this.paint.get("fill-extrusion-height").evaluate(e,i),w=this.paint.get("fill-extrusion-base").evaluate(e,i),C=[0,0],k=m&&u.elevation,P=u.elevation?u.elevation.exaggeration():1,R=r.tile.getBucket(this);if(k&&R instanceof Eg){const Y=R.centroidVertexArray,q=_+1;q<Y.length&&(C[0]=Y.geta_centroid_pos0(q),C[1]=Y.geta_centroid_pos1(q))}if(C[0]===0&&C[1]===1)return!1;u.projection.name==="globe"&&(o=vP([o],[new D(0,0),new D(Et,Et)],r.tileID.canonical).map(Y=>Y.polygon).flat());const z=k?m:null,[B,H]=function(Y,q,ee,ce,de,ge,ve,Re,ke,$e,Ie){return Y.projection.name==="globe"?function(Qe,st,ft,Je,tt,pt,bt,St,Pt,Ut,Tt){const Mt=[],tr=[],ur=Qe.projection.upVectorScale(Tt,Qe.center.lat,Qe.worldSize).metersToTile,cr=[0,0,0,1],hr=[0,0,0,1],Mr=(gn,Bn,on,Qr)=>{gn[0]=Bn,gn[1]=on,gn[2]=Qr,gn[3]=1},jr=_P();ft>0&&(ft+=jr),Je+=jr;for(const gn of st){const Bn=[],on=[];for(const Qr of gn){const Vr=Qr.x+tt.x,Dr=Qr.y+tt.y,In=Qe.projection.projectTilePoint(Vr,Dr,Tt),Un=Qe.projection.upVector(Tt,Qr.x,Qr.y);let dn=ft,gi=Je;if(bt){const Ni=xP(Vr,Dr,ft,Je,bt,St,Pt,Ut);dn+=Ni.base,gi+=Ni.top}ft!==0?Mr(cr,In.x+Un[0]*ur*dn,In.y+Un[1]*ur*dn,In.z+Un[2]*ur*dn):Mr(cr,In.x,In.y,In.z),Mr(hr,In.x+Un[0]*ur*gi,In.y+Un[1]*ur*gi,In.z+Un[2]*ur*gi),We.transformMat4(cr,cr,pt),We.transformMat4(hr,hr,pt),Bn.push(new s0(cr[0],cr[1],cr[2])),on.push(new s0(hr[0],hr[1],hr[2]))}Mt.push(Bn),tr.push(on)}return[Mt,tr]}(Y,q,ee,ce,de,ge,ve,Re,ke,$e,Ie):ve?function(Qe,st,ft,Je,tt,pt,bt,St,Pt){const Ut=[],Tt=[],Mt=[0,0,0,1];for(const tr of Qe){const ur=[],cr=[];for(const hr of tr){const Mr=hr.x+Je.x,jr=hr.y+Je.y,gn=xP(Mr,jr,st,ft,pt,bt,St,Pt);Mt[0]=Mr,Mt[1]=jr,Mt[2]=gn.base,Mt[3]=1,li.transformMat4(Mt,Mt,tt),Mt[3]=Math.max(Mt[3],1e-5);const Bn=new s0(Mt[0]/Mt[3],Mt[1]/Mt[3],Mt[2]/Mt[3]);Mt[0]=Mr,Mt[1]=jr,Mt[2]=gn.top,Mt[3]=1,li.transformMat4(Mt,Mt,tt),Mt[3]=Math.max(Mt[3],1e-5);const on=new s0(Mt[0]/Mt[3],Mt[1]/Mt[3],Mt[2]/Mt[3]);ur.push(Bn),cr.push(on)}Ut.push(ur),Tt.push(cr)}return[Ut,Tt]}(q,ee,ce,de,ge,ve,Re,ke,$e):function(Qe,st,ft,Je,tt){const pt=[],bt=[],St=tt[8]*st,Pt=tt[9]*st,Ut=tt[10]*st,Tt=tt[11]*st,Mt=tt[8]*ft,tr=tt[9]*ft,ur=tt[10]*ft,cr=tt[11]*ft;for(const hr of Qe){const Mr=[],jr=[];for(const gn of hr){const Bn=gn.x+Je.x,on=gn.y+Je.y,Qr=tt[0]*Bn+tt[4]*on+tt[12],Vr=tt[1]*Bn+tt[5]*on+tt[13],Dr=tt[2]*Bn+tt[6]*on+tt[14],In=tt[3]*Bn+tt[7]*on+tt[15],Un=Qr+St,dn=Vr+Pt,gi=Dr+Ut,Ni=Math.max(In+Tt,1e-5),Ii=Qr+Mt,Ti=Vr+tr,ba=Dr+ur,Ui=Math.max(In+cr,1e-5);Mr.push(new s0(Un/Ni,dn/Ni,gi/Ni)),jr.push(new s0(Ii/Ui,Ti/Ui,ba/Ui))}pt.push(Mr),bt.push(jr)}return[pt,bt]}(q,ee,ce,de,ge)}(u,o,w,x,v,h,z,C,P,u.center.lat,r.tileID.canonical),Z=r.queryGeometry;return function(Y,q,ee){let ce=1/0;uM(ee,q)&&(ce=yP(ee,q[0]));for(let de=0;de<q.length;de++){const ge=q[de],ve=Y[de];for(let Re=0;Re<ge.length-1;Re++){const ke=ge[Re],$e=[ke,ge[Re+1],ve[Re+1],ve[Re],ke];cM(ee,$e)&&(ce=Math.min(ce,yP(ee,$e)))}}return ce!==1/0&&ce}(B,H,Z.isPointQuery()?Z.screenBounds:Z.screenGeometry)}},line:class extends Zs{constructor(r,e){super(r,bP,e),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(r){if(r==="line-gradient"){const e=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=e._styleExpression&&e._styleExpression.expression instanceof Sf,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(r,e){super.recalculate(r,e),this.paint._values["line-floorwidth"]=CP.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,r)}createBucket(r){return new Y1(r)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getDefaultProgramParams(r,e){const i=TP(this);return{config:new nd(this,e),defines:i,overrideFog:!1}}queryRadius(r){const e=r,i=AP(qp("line-width",this,e),qp("line-gap-width",this,e)),o=qp("line-offset",this,e);return i/2+Math.abs(o)+w1(this.paint.get("line-translate"))}queryIntersectsFeature(r,e,i,o,l,u){if(r.queryGeometry.isAboveHorizon)return!1;const h=pM(r.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),u.angle,r.pixelToTileUnitsFactor),m=r.pixelToTileUnitsFactor/2*AP(this.paint.get("line-width").evaluate(e,i),this.paint.get("line-gap-width").evaluate(e,i)),_=this.paint.get("line-offset").evaluate(e,i);return _&&(o=function(v,x){const w=[],C=new D(0,0);for(let k=0;k<v.length;k++){const P=v[k],R=[];for(let z=0;z<P.length;z++){const B=P[z],H=P[z+1],Z=z===0?C:B.sub(P[z-1])._unit()._perp(),Y=z===P.length-1?C:H.sub(B)._unit()._perp(),q=Z._add(Y)._unit();q._mult(1/(q.x*Y.x+q.y*Y.y)),R.push(q._mult(x)._add(B))}w.push(R)}return w}(o,_*r.pixelToTileUnitsFactor)),function(v,x,w){for(let C=0;C<x.length;C++){const k=x[C];if(v.length>=3){for(let P=0;P<k.length;P++)if(Vf(v,k[P]))return!0}if(tj(v,k,w))return!0}return!1}(h,o,m)}isTileClipped(){return!0}},symbol:H1,background:class extends Zs{constructor(r,e){super(r,fG,e)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}getDefaultProgramParams(r,e){return{overrideFog:!1}}},raster:class extends Zs{constructor(r,e){super(r,dG,e),this._updateColorRamp()}getProgramIds(){return["raster"]}hasColorMap(){return!!this._transitionablePaint._values["raster-color"].value.value}isLayerDraped(r){return!(r&&r._source instanceof Vc&&(r._source.onNorthPole||r._source.onSouthPole))}_handleSpecialPaintPropertyUpdate(r){r!=="raster-color"&&r!=="raster-color-range"||this._updateColorRamp()}_updateColorRamp(){if(!this.hasColorMap())return;const r=this._transitionablePaint._values["raster-color"].value.expression,[e,i]=this._transitionablePaint._values["raster-color-range"].value.expression.evaluate({zoom:0});this.colorRamp=E1({expression:r,evaluationKey:"rasterValue",image:this.colorRamp,clips:[{start:e,end:i}],resolution:256}),this.colorRampTexture=null}},sky:class extends Zs{constructor(r,e){super(r,gG,e),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(r){r==="sky-gradient"?this._updateColorRamp():r!=="sky-atmosphere-sun"&&r!=="sky-atmosphere-halo-color"&&r!=="sky-atmosphere-color"&&r!=="sky-atmosphere-sun-intensity"||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=E1({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(r){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const e=r.style.light.properties.get("position");return this._lightPosition.azimuthal!==e.azimuthal||this._lightPosition.polar!==e.polar}return!1}getCenter(r,e){if(this.paint.get("sky-type")==="atmosphere"){const o=this.paint.get("sky-atmosphere-sun"),l=!o,u=r.style.light,h=u.properties.get("position");return l&&u.properties.get("anchor")==="viewport"&&se("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),l?YE(h.azimuthal,90-h.polar,e):YE(o[0],90-o[1],e)}const i=this.paint.get("sky-gradient-center");return YE(i[0],90-i[1],e)}isSky(){return!0}markSkyboxValid(r){this._skyboxInvalidated=!1,this._lightPosition=r.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const r=this.paint.get("sky-type");return r==="atmosphere"?["skyboxCapture","skybox"]:r==="gradient"?["skyboxGradient"]:null}},slot:class extends Zs{constructor(r,e){super(r,_G)}},model:class extends Zs{constructor(r,e){super(r,HH,e)}createBucket(r){return new KF(r)}getProgramIds(){return["model"]}is3D(){return!0}hasShadowPass(){return!0}canCastShadows(){return!0}hasLightBeamPass(){return!0}cutoffRange(){return this.paint.get("model-cutoff-fade-range")}queryRadius(){return 0}queryIntersectsFeature(){return!1}_handleOverridablePaintPropertyUpdate(r,e,i){return!(!this.layout||e.isDataDriven()||i.isDataDriven()||r!=="model-color"&&r!=="model-color-mix-intensity"&&r!=="model-rotation"&&r!=="model-scale"&&r!=="model-translation"&&r!=="model-emissive-strength")}_isPropertyZoomDependent(r){const e=this._transitionablePaint._values[r];return e!=null&&e.value!=null&&e.value.expression!=null&&e.value.expression instanceof Af}isZoomDependent(){return this._isPropertyZoomDependent("model-scale")||this._isPropertyZoomDependent("model-rotation")||this._isPropertyZoomDependent("model-translation")}}};function cy(r,e){return r.type==="custom"?new pG(r):new vG[r.type](r,e)}function yG(r){const{userImage:e}=r;return!!(e&&e.render&&e.render())&&(r.data.replace(new Uint8Array(e.data.buffer)),!0)}class xG extends Ln{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded={},this.requestors=[],this.patterns={},this.atlasImage={},this.atlasTexture={},this.dirty=!0}createScope(e){this.images[e]={},this.loaded[e]=!1,this.updatedImages[e]={},this.patterns[e]={},this.callbackDispatchedThisFrame[e]={},this.atlasImage[e]=new da({width:1,height:1})}isLoaded(){for(const e in this.loaded)if(!this.loaded[e])return!1;return!0}setLoaded(e,i){if(this.loaded[i]!==e&&(this.loaded[i]=e,e)){for(const{ids:o,callback:l}of this.requestors)this._notify(o,i,l);this.requestors=[]}}hasImage(e,i){return!!this.getImage(e,i)}getImage(e,i){return this.images[i][e]}addImage(e,i,o){this._validate(e,o)&&(this.images[i][e]=o)}_validate(e,i){let o=!0;return this._validateStretch(i.stretchX,i.data&&i.data.width)||(this.fire(new ar(new Error(`Image "${e}" has invalid "stretchX" value`))),o=!1),this._validateStretch(i.stretchY,i.data&&i.data.height)||(this.fire(new ar(new Error(`Image "${e}" has invalid "stretchY" value`))),o=!1),this._validateContent(i.content,i)||(this.fire(new ar(new Error(`Image "${e}" has invalid "content" value`))),o=!1),o}_validateStretch(e,i){if(!e)return!0;let o=0;for(const l of e){if(l[0]<o||l[1]<l[0]||i<l[1])return!1;o=l[1]}return!0}_validateContent(e,i){return!(e&&(e.length!==4||e[0]<0||i.data.width<e[0]||e[1]<0||i.data.height<e[1]||e[2]<0||i.data.width<e[2]||e[3]<0||i.data.height<e[3]||e[2]<e[0]||e[3]<e[1]))}updateImage(e,i,o){o.version=this.images[i][e].version+1,this.images[i][e]=o,this.updatedImages[i][e]=!0}removeImage(e,i){const o=this.images[i][e];delete this.images[i][e],delete this.patterns[i][e],o.userImage&&o.userImage.onRemove&&o.userImage.onRemove()}listImages(e){return Object.keys(this.images[e])}getImages(e,i,o){let l=!0;const u=!!this.loaded[i];if(!u)for(const h of e)this.images[i][h]||(l=!1);u||l?this._notify(e,i,o):this.requestors.push({ids:e,scope:i,callback:o})}getUpdatedImages(e){return this.updatedImages[e]}_notify(e,i,o){const l={};for(const u of e){this.images[i][u]||this.fire(new _t("styleimagemissing",{id:u}));const h=this.images[i][u];h?l[u]={data:h.data.clone(),pixelRatio:h.pixelRatio,sdf:h.sdf,version:h.version,stretchX:h.stretchX,stretchY:h.stretchY,content:h.content,hasRenderCallback:!!(h.userImage&&h.userImage.render)}:se(`Image "${u}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}o(null,l)}getPixelSize(e){const{width:i,height:o}=this.atlasImage[e];return{width:i,height:o}}getPattern(e,i){const o=this.patterns[i][e],l=this.getImage(e,i);if(!l)return null;if(o&&o.position.version===l.version)return o.position;if(o)o.position.version=l.version;else{const u={w:l.data.width+2,h:l.data.height+2,x:0,y:0},h=new ME(u,l);this.patterns[i][e]={bin:u,position:h}}return this._updatePatternAtlas(i),this.patterns[i][e].position}bind(e,i){const o=e.gl;let l=this.atlasTexture[i];l?this.dirty&&(l.update(this.atlasImage[i]),this.dirty=!1):(l=new Ia(e,this.atlasImage[i],o.RGBA),this.atlasTexture[i]=l),l.bind(o.LINEAR,o.CLAMP_TO_EDGE)}_updatePatternAtlas(e){const i=[];for(const h in this.patterns[e])i.push(this.patterns[e][h].bin);const{w:o,h:l}=IE(i),u=this.atlasImage[e];u.resize({width:o||1,height:l||1});for(const h in this.patterns[e]){const{bin:m}=this.patterns[e][h],_=m.x+1,v=m.y+1,x=this.images[e][h].data,w=x.width,C=x.height;da.copy(x,u,{x:0,y:0},{x:_,y:v},{width:w,height:C}),da.copy(x,u,{x:0,y:C-1},{x:_,y:v-1},{width:w,height:1}),da.copy(x,u,{x:0,y:0},{x:_,y:v+C},{width:w,height:1}),da.copy(x,u,{x:w-1,y:0},{x:_-1,y:v},{width:1,height:C}),da.copy(x,u,{x:0,y:0},{x:_+w,y:v},{width:1,height:C})}this.dirty=!0}beginFrame(){for(const e in this.images)this.callbackDispatchedThisFrame[e]={}}dispatchRenderCallbacks(e,i){for(const o of e){if(this.callbackDispatchedThisFrame[i][o])continue;this.callbackDispatchedThisFrame[i][o]=!0;const l=this.images[i][o];yG(l)&&this.updateImage(o,i,l)}}}const bG=new sa({anchor:new Yt(at.light.anchor),position:new class{constructor(r){this.specification=r}possiblyEvaluate(r,e){return ye(r.expression.evaluate(e))}interpolate(r,e,i){return{x:$r(r.x,e.x,i),y:$r(r.y,e.y,i),z:$r(r.z,e.z,i),azimuthal:$r(r.azimuthal,e.azimuthal,i),polar:$r(r.polar,e.polar,i)}}}(at.light.position),color:new Yt(at.light.color),intensity:new Yt(at.light.intensity)});class IP extends Ln{constructor(e,i="flat"){super(),this._transitionable=new Wm(bG),this.setLight(e,i),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(e,i,o={}){this._validate(G$,e,o)||(this._transitionable.setTransitionOrValue(e),this.id=i)}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}_validate(e,i,o){return(!o||o.validate!==!1)&&Qv(this,e.call(Lp,ze({value:i,style:{glyphs:!0,sprite:!0},styleSpec:at})))}}const wG=new sa({source:new Yt(at.terrain.source),exaggeration:new Yt(at.terrain.exaggeration)});let EG=class extends Ln{constructor(r,e){super(),this._transitionable=new Wm(wG),this.set(r),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=e}setScope(r){this.scope=r}get(){return this._transitionable.serialize()}set(r){this._transitionable.setTransitionOrValue(r)}updateTransitions(r){this._transitioning=this._transitionable.transitioned(r,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(r){this.properties=this._transitioning.possiblyEvaluate(r)}getExaggeration(r){return this._transitioning.possiblyEvaluate(new Gi(r)).get("exaggeration")}isZoomDependent(){const r=this._transitionable._values.exaggeration;return r!=null&&r.value!=null&&r.value.expression!=null&&r.value.expression instanceof Af}};const MP=45,FP=65,dd=.05;function uy(r,e,i,o){const l=Pe(MP,FP,i),[u,h]=PP(r,o);let m=1-Math.min(1,Math.exp((e-u)/(h-u)*-6));return m*=m*m,m=Math.min(1,1.00747*m),m*l*r.alpha}function PP(r,e){const i=.5/Math.tan(.5*e);return[r.range[0]+i,r.range[1]+i]}function OP(r,e,i,o,l){const u=We.transformMat4([],[e,i,o],l.mercatorFogMatrix);return uy(r,We.length(u),l.pitch,l._fov)}function RP(r,e,i,o,l,u,h){const m=[[i,o,0],[l,o,0],[l,u,0],[i,u,0]];let _=Number.MAX_VALUE,v=-Number.MAX_VALUE;for(const x of m){const w=We.transformMat4([],x,e),C=We.length(w);_=Math.min(_,C),v=Math.max(v,C)}return[uy(r,_,h.pitch,h._fov),uy(r,v,h.pitch,h._fov)]}const TG=new sa({range:new Yt(at.fog.range),color:new Yt(at.fog.color),"high-color":new Yt(at.fog["high-color"]),"space-color":new Yt(at.fog["space-color"]),"horizon-blend":new Yt(at.fog["horizon-blend"]),"star-intensity":new Yt(at.fog["star-intensity"]),"vertical-range":new Yt(at.fog["vertical-range"])});class SG extends Ln{constructor(e,i){super(),this._transitionable=new Wm(TG),this.set(e),this._transitioning=this._transitionable.untransitioned(),this._transform=i}get state(){const e=this._transform,i=e.projection.name==="globe",o=qa(e.zoom),l=this.properties.get("range"),u=[.5,3];return{range:i?[$r(u[0],l[0],o),$r(u[1],l[1],o)]:l,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(e,i={}){if(this._validate(Z$,e,i))return;const o=ze({},e);for(const l of Object.keys(at.fog))o[l]===void 0&&(o[l]=at.fog[l].default);this._transitionable.setTransitionOrValue(o)}getOpacity(e){if(!this._transform.projection.supportsFog)return 0;const i=this.properties&&this.properties.get("color")||1;return(this._transform.projection.name==="globe"?1:Pe(MP,FP,e))*i.a}getOpacityAtLatLng(e,i){return this._transform.projection.supportsFog?function(o,l,u){const h=Pn.fromLngLat(l),m=u.elevation?u.elevation.getAtPointOrZero(h):0;return OP(o,h.x,h.y,m,u)}(this.state,e,i):0}getOpacityForTile(e){if(!this._transform.projection.supportsFog)return[1,1];const i=this._transform.calculateFogTileMatrix(e.toUnwrapped());return RP(this.state,i,0,0,Et,Et,this._transform)}getOpacityForBounds(e,i,o,l,u){return this._transform.projection.supportsFog?RP(this.state,e,i,o,l,u,this._transform):[1,1]}getFovAdjustedRange(e){return this._transform.projection.supportsFog?PP(this.state,e):[0,1]}isVisibleOnFrustum(e){if(!this._transform.projection.supportsFog)return!1;const i=[4,5,6,7];for(const o of i){const l=e.points[o];let u;if(l[2]>=0)u=l;else{const h=e.points[o-4];u=f3(h,l,h[2]/(h[2]-l[2]))}if(OP(this.state,u[0],u[1],0,this._transform)>=dd)return!0}return!1}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}_validate(e,i,o){return(!o||o.validate!==!1)&&Qv(this,e.call(Lp,ze({value:i,style:{glyphs:!0,sprite:!0},styleSpec:at})))}}class CG{constructor(e){this._callback=e,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class AG{constructor(){this.tasks={},this.taskQueue=[],ae(["process"],this),this.invoker=new CG(this.process),this.nextId=0}add(e,i){const o=this.nextId++,l=function({type:u,isSymbolTile:h,zoom:m}){return m=m||0,u==="message"?0:u!=="maybePrepare"||h?u!=="parseTile"||h?u==="parseTile"&&h?300-m:u==="maybePrepare"&&h?400-m:500:200-m:100-m}(i);if(l===0){be();try{e()}finally{}return{cancel:()=>{}}}return this.tasks[o]={fn:e,metadata:i,priority:l,id:o},this.taskQueue.push(o),this.invoker.trigger(),{cancel:()=>{delete this.tasks[o]}}}process(){be();try{if(this.taskQueue=this.taskQueue.filter(o=>!!this.tasks[o]),!this.taskQueue.length)return;const e=this.pick();if(e===null)return;const i=this.tasks[e];if(delete this.tasks[e],this.taskQueue.length&&this.invoker.trigger(),!i)return;i.fn()}finally{}}pick(){let e=null,i=1/0;for(let l=0;l<this.taskQueue.length;l++){const u=this.tasks[this.taskQueue[l]];u.priority<i&&(i=u.priority,e=l)}if(e===null)return null;const o=this.taskQueue[e];return this.taskQueue.splice(e,1),o}remove(){this.invoker.remove()}}class LP{constructor(e,i,o){this.target=e,this.parent=i,this.mapId=o,this.callbacks={},this.cancelCallbacks={},ae(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.scheduler=new AG}send(e,i,o,l,u=!1,h){const m=Math.round(1e18*Math.random()).toString(36).substring(0,10);o&&(o.metadata=h,this.callbacks[m]=o);const _=new Set;return this.target.postMessage({id:m,type:e,hasCallback:!!o,targetMapId:l,mustQueue:u,sourceMapId:this.mapId,data:Bp(i,_)},_),{cancel:()=>{o&&delete this.callbacks[m],this.target.postMessage({id:m,type:"<cancel>",targetMapId:l,sourceMapId:this.mapId})}}}receive(e){const i=e.data,o=i.id;if(o&&(!i.targetMapId||this.mapId===i.targetMapId))if(i.type==="<cancel>"){const l=this.cancelCallbacks[o];delete this.cancelCallbacks[o],l&&l.cancel()}else if(i.mustQueue||be()){const l=this.callbacks[o];this.cancelCallbacks[o]=this.scheduler.add(()=>this.processTask(o,i),l&&l.metadata||{type:"message"})}else this.processTask(o,i)}processTask(e,i){if(i.type==="<response>"){const o=this.callbacks[e];delete this.callbacks[e],o&&(i.error?o(zp(i.error)):o(null,zp(i.data)))}else{const o=new Set,l=i.hasCallback?(h,m)=>{delete this.cancelCallbacks[e],this.target.postMessage({id:e,type:"<response>",sourceMapId:this.mapId,error:h?Bp(h):null,data:Bp(m,o)},o)}:h=>{},u=zp(i.data);if(this.parent[i.type])this.parent[i.type](i.sourceMapId,u,l);else if(this.parent.getWorkerSource){const h=i.type.split(".");this.parent.getWorkerSource(i.sourceMapId,h[0],u.source,u.scope)[h[1]](u,l)}else l(new Error(`Could not find function ${i.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}}class pd{constructor(e,i){this.workerPool=e,this.actors=[],this.currentActor=0,this.id=fe();const o=this.workerPool.acquire(this.id);for(let l=0;l<o.length;l++){const u=new pd.Actor(o[l],i,this.id);u.name=`Worker ${l}`,this.actors.push(u)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(e,i,o){et(this.actors,(l,u)=>{l.send(e,i,u)},o=o||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(e=>{e.remove()}),this.actors=[],this.workerPool.release(this.id)}}pd.Actor=LP;class DP extends Ln{constructor(e,i,o,l){super(),this.scope=o,this._options=e,this.properties=new Hm(i),this._transitionable=new Wm(i,new Map(l)),this._transitionable.setTransitionOrValue(e.properties),this._transitioning=this._transitionable.untransitioned()}updateConfig(e){this._transitionable.setTransitionOrValue(this._options.properties,new Map(e))}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}get(){return this._options.properties=this._transitionable.serialize(),this._options}set(e,i){this._options=e,this._transitionable.setTransitionOrValue(e.properties,i)}shadowsEnabled(){return!!this.properties&&this.properties.get("cast-shadows")===!0}}const kG=new sa({color:new Yt(at.properties_light_ambient.color),intensity:new Yt(at.properties_light_ambient.intensity)}),IG=new sa({direction:new class{constructor(r){this.specification=r}possiblyEvaluate(r,e){return function([i,o]){const l=ye([1,i,o]);return{x:l.x,y:l.y,z:l.z}}(r.expression.evaluate(e))}interpolate(r,e,i){return{x:$r(r.x,e.x,i),y:$r(r.y,e.y,i),z:$r(r.z,e.z,i)}}}(at.properties_light_directional.direction),color:new Yt(at.properties_light_directional.color),intensity:new Yt(at.properties_light_directional.intensity),"cast-shadows":new Yt(at.properties_light_directional["cast-shadows"]),"shadow-intensity":new Yt(at.properties_light_directional["shadow-intensity"])});class JE{constructor(e,i,o,l){this.screenBounds=e,this.cameraPoint=i,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=o,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,l)}static createFromScreenPoints(e,i){let o,l;if(e instanceof D||typeof e[0]=="number"){const u=D.convert(e);o=[u],l=i.isPointAboveHorizon(u)}else{const u=D.convert(e[0]),h=D.convert(e[1]);o=[u,h],l=ut(u,h).every(m=>i.isPointAboveHorizon(m))}return new JE(o,i.getCameraPoint(),l,i)}isPointQuery(){return this.screenBounds.length===1}bufferedScreenGeometry(e){return ut(this.screenBounds[0],this.screenBounds.length===1?this.screenBounds[0]:this.screenBounds[1],e)}bufferedCameraGeometry(e){const i=this.screenBounds[0],o=this.screenBounds.length===1?this.screenBounds[0].add(new D(1,1)):this.screenBounds[1],l=ut(i,o,0,!1);return this.cameraPoint.y>o.y&&(this.cameraPoint.x>i.x&&this.cameraPoint.x<o.x?l.splice(3,0,this.cameraPoint):this.cameraPoint.x>=o.x?l[2]=this.cameraPoint:this.cameraPoint.x<=i.x&&(l[3]=this.cameraPoint)),function(u,h){const m=[];for(let _=0;_<u.length;_++){const v=rt(_-1,-1,u.length-1),x=rt(_+1,-1,u.length-1),w=u[_],C=u[x],k=u[v].sub(w).unit(),P=C.sub(w).unit(),R=P.angleWithSep(k.x,k.y),z=k.add(P).unit().mult(-1*h/Math.sin(R/2));m.push(w.add(z))}return m}(l,e)}bufferedCameraGeometryGlobe(e){const i=this.screenBounds[0],o=this.screenBounds.length===1?this.screenBounds[0].add(new D(1,1)):this.screenBounds[1],l=ut(i,o,e),u=this.cameraPoint.clone();switch(3*((u.y>i.y)+(u.y>o.y))+((u.x>i.x)+(u.x>o.x))){case 0:l[0]=u,l[4]=u.clone();break;case 1:l.splice(1,0,u);break;case 2:l[1]=u;break;case 3:l.splice(4,0,u);break;case 5:l.splice(2,0,u);break;case 6:l[3]=u;break;case 7:l.splice(3,0,u);break;case 8:l[2]=u}return l}containsTile(e,i,o,l=0){const u=e.queryPadding/i._pixelsPerMercatorPixel+1,h=o?this._bufferedCameraMercator(u,i):this._bufferedScreenMercator(u,i);let m=e.tileID.wrap+(h.unwrapped?l:0);const _=h.polygon.map(z=>gF(e.tileTransform,z,m));if(!dM(_,0,0,Et,Et))return;m=e.tileID.wrap+(this.screenGeometryMercator.unwrapped?l:0);const v=this.screenGeometryMercator.polygon.map(z=>_F(e.tileTransform,z,m)),x=v.map(z=>new D(z[0],z[1])),w=i.getFreeCameraOptions().position||new Pn(0,0,0),C=_F(e.tileTransform,w,m),k=v.map(z=>{const B=We.sub(z,z,C);return We.normalize(B,B),new p1(C,B)}),P=ud(e,1,i.zoom)*i._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:x,tilespaceRays:k,bufferedTilespaceGeometry:_,bufferedTilespaceBounds:(R=Ee(_),R.min.x=Oe(R.min.x,0,Et),R.min.y=Oe(R.min.y,0,Et),R.max.x=Oe(R.max.x,0,Et),R.max.y=Oe(R.max.y,0,Et),R),tile:e,tileID:e.tileID,pixelToTileUnitsFactor:P};var R}_bufferedScreenMercator(e,i){const o=BP(e);if(this._screenRaycastCache[o])return this._screenRaycastCache[o];{let l;return l=i.projection.name==="globe"?this._projectAndResample(this.bufferedScreenGeometry(e),i):{polygon:this.bufferedScreenGeometry(e).map(u=>i.pointCoordinate3D(u)),unwrapped:!0},this._screenRaycastCache[o]=l,l}}_bufferedCameraMercator(e,i){const o=BP(e);if(this._cameraRaycastCache[o])return this._cameraRaycastCache[o];{let l;return l=i.projection.name==="globe"?this._projectAndResample(this.bufferedCameraGeometryGlobe(e),i):{polygon:this.bufferedCameraGeometry(e).map(u=>i.pointCoordinate3D(u)),unwrapped:!0},this._cameraRaycastCache[o]=l,l}}_projectAndResample(e,i){const o=function(u,h){const m=dt.multiply([],h.pixelMatrix,h.globeMatrix),_=[0,-Fo,0,1],v=[0,Fo,0,1],x=[0,0,0,1];li.transformMat4(_,_,m),li.transformMat4(v,v,m),li.transformMat4(x,x,m);const w=new D(_[0]/_[3],_[1]/_[3]),C=new D(v[0]/v[3],v[1]/v[3]),k=Vf(u,w)&&_[3]<x[3],P=Vf(u,C)&&v[3]<x[3];if(!k&&!P)return null;const R=function(ce,de,ge){for(let ve=1;ve<ce.length;ve++){const Re=Sg(de.pointCoordinate3D(ce[ve-1]).x),ke=Sg(de.pointCoordinate3D(ce[ve]).x);if(ge<0){if(Re<ke)return{idx:ve,t:-Re/(ke-1-Re)}}else if(ke<Re)return{idx:ve,t:(1-Re)/(ke+1-Re)}}return null}(u,h,k?-1:1);if(!R)return null;const{idx:z,t:B}=R;let H=z>1?QE(u.slice(0,z),h):[],Z=z<u.length?QE(u.slice(z),h):[];H=H.map(ce=>new D(Sg(ce.x),ce.y)),Z=Z.map(ce=>new D(Sg(ce.x),ce.y));const Y=[...H];Y.length===0&&Y.push(Z[Z.length-1]);const q=$r(Y[Y.length-1].y,(Z.length===0?H[0]:Z[0]).y,B);let ee;return ee=k?[new D(0,q),new D(0,0),new D(1,0),new D(1,q)]:[new D(1,q),new D(1,1),new D(0,1),new D(0,q)],Y.push(...ee),Z.length===0?Y.push(H[0]):Y.push(...Z),{polygon:Y.map(ce=>new Pn(ce.x,ce.y)),unwrapped:!1}}(e,i);if(o)return o;const l=function(u,h){let m=!1,_=-1/0,v=0;for(let w=0;w<u.length-1;w++)u[w].x>_&&(_=u[w].x,v=w);for(let w=0;w<u.length-1;w++){const C=(v+w)%(u.length-1),k=u[C],P=u[C+1];Math.abs(k.x-P.x)>.5&&(k.x<P.x?(k.x+=1,C===0&&(u[u.length-1].x+=1)):(P.x+=1,C+1===u.length-1&&(u[0].x+=1)),m=!0)}const x=Xa(h.center.lng);return m&&x<Math.abs(x-1)&&u.forEach(w=>{w.x-=1}),{polygon:u,unwrapped:m}}(QE(e,i).map(u=>new D(Sg(u.x),u.y)),i);return{polygon:l.polygon.map(u=>new Pn(u.x,u.y)),unwrapped:l.unwrapped}}}function QE(r,e){return sM(r,i=>{const o=e.pointCoordinate3D(i);i.x=o.x,i.y=o.y},1/256)}function Sg(r){return r<0?1+r%1:r%1}function BP(r){return 100*r|0}function eT(r,e,i,o,l){const u=function(h,m){if(h)return l(h);if(m){r.url&&m.tiles&&r.tiles&&delete r.tiles;const _=oe(ze(m,r),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);m.vector_layers&&(_.vectorLayers=m.vector_layers,_.vectorLayerIds=_.vectorLayers.map(v=>v.id)),_.tiles=e.canonicalizeTileset(_,r.url),l(null,_)}};return r.url?jt(e.transformRequest(e.normalizeSourceURL(r.url,null,i,o),Le.Source),u):Jr.frame(()=>u(null,r))}class fy{constructor(e,i,o){this.bounds=Ks.convert(this.validateBounds(e)),this.minzoom=i||0,this.maxzoom=o||24}validateBounds(e){return Array.isArray(e)&&e.length===4?[Math.max(-180,e[0]),Math.max(-90,e[1]),Math.min(180,e[2]),Math.min(90,e[3])]:[-180,-90,180,90]}contains(e){const i=Math.pow(2,e.z),o=Math.floor(Xa(this.bounds.getWest())*i),l=Math.floor(oo(this.bounds.getNorth())*i),u=Math.ceil(Xa(this.bounds.getEast())*i),h=Math.ceil(oo(this.bounds.getSouth())*i);return e.x>=o&&e.x<u&&e.y>=l&&e.y<h}}class zP{constructor(e,i){this.width=e,this.height=i,this.nextRow=0,this.image=new Mu({width:e,height:i}),this.positions={},this.uploaded=!1}getDash(e,i){const o=this.getKey(e,i);return this.positions[o]}trim(){const e=this.width,i=this.height=ot(this.nextRow);this.image.resize({width:e,height:i})}getKey(e,i){return e.join(",")+i}getDashRanges(e,i,o){const l=[];let u=e.length%2==1?-e[e.length-1]*o:0,h=e[0]*o,m=!0;l.push({left:u,right:h,isDash:m,zeroLength:e[0]===0});let _=e[0];for(let v=1;v<e.length;v++){m=!m;const x=e[v];u=_*o,_+=x,h=_*o,l.push({left:u,right:h,isDash:m,zeroLength:x===0})}return l}addRoundDash(e,i,o){const l=i/2;for(let u=-o;u<=o;u++){const h=this.width*(this.nextRow+o+u);let m=0,_=e[m];for(let v=0;v<this.width;v++){v/_.right>1&&(_=e[++m]);const x=Math.abs(v-_.left),w=Math.abs(v-_.right),C=Math.min(x,w);let k;const P=u/o*(l+1);if(_.isDash){const R=l-Math.abs(P);k=Math.sqrt(C*C+R*R)}else k=l-Math.sqrt(C*C+P*P);this.image.data[h+v]=Math.max(0,Math.min(255,k+128))}}}addRegularDash(e,i){for(let _=e.length-1;_>=0;--_){const v=e[_],x=e[_+1];v.zeroLength?e.splice(_,1):x&&x.isDash===v.isDash&&(x.left=v.left,e.splice(_,1))}const o=e[0],l=e[e.length-1];o.isDash===l.isDash&&(o.left=l.left-this.width,l.right=o.right+this.width);const u=this.width*this.nextRow;let h=0,m=e[h];for(let _=0;_<this.width;_++){_/m.right>1&&(m=e[++h]);const v=Math.abs(_-m.left),x=Math.abs(_-m.right),w=Math.min(v,x);this.image.data[u+_]=Math.max(0,Math.min(255,(m.isDash?w:-w)+i+128))}}addDash(e,i){const o=this.getKey(e,i);if(this.positions[o])return this.positions[o];const l=i==="round",u=l?7:0,h=2*u+1;if(this.nextRow+h>this.height)return se("LineAtlas out of space"),null;e.length===0&&e.push(1);let m=0;for(let x=0;x<e.length;x++)e[x]<0&&(se("Negative value is found in line dasharray, replacing values with 0"),e[x]=0),m+=e[x];if(m!==0){const x=this.width/m,w=this.getDashRanges(e,this.width,x);l?this.addRoundDash(w,x,u):this.addRegularDash(w,i==="square"?.5*x:0)}const _=this.nextRow+u;this.nextRow+=h;const v={tl:[_,u],br:[m,0]};return this.positions[o]=v,v}}xr(zP,"LineAtlas");const NP=1*Zl;class UP{constructor(e){const i={},o=[];for(const m in e){const _=e[m],v=i[m]={};for(const x in _.glyphs){const w=_.glyphs[+x];if(!w||w.bitmap.width===0||w.bitmap.height===0)continue;const C=w.metrics.localGlyph?NP:1,k={x:0,y:0,w:w.bitmap.width+2*C,h:w.bitmap.height+2*C};o.push(k),v[x]=k}}const{w:l,h:u}=IE(o),h=new Mu({width:l||1,height:u||1});for(const m in e){const _=e[m];for(const v in _.glyphs){const x=_.glyphs[+v];if(!x||x.bitmap.width===0||x.bitmap.height===0)continue;const w=i[m][v],C=x.metrics.localGlyph?NP:1;Mu.copy(x.bitmap,h,{x:0,y:0},{x:w.x+C,y:w.y+C},x.bitmap)}}this.image=h,this.positions=i}}xr(UP,"GlyphAtlas");class MG{constructor(e){this.tileID=new Wn(e.tileID.overscaledZ,e.tileID.wrap,e.tileID.canonical.z,e.tileID.canonical.x,e.tileID.canonical.y),this.tileZoom=e.tileZoom,this.uid=e.uid,this.zoom=e.zoom,this.canonical=e.tileID.canonical,this.pixelRatio=e.pixelRatio,this.tileSize=e.tileSize,this.source=e.source,this.scope=e.scope,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=e.showCollisionBoxes,this.collectResourceTiming=!!e.collectResourceTiming,this.promoteId=e.promoteId,this.isSymbolTile=e.isSymbolTile,this.tileTransform=cd(e.tileID.canonical,e.projection),this.projection=e.projection,this.brightness=e.brightness,this.extraShadowCaster=!!e.extraShadowCaster}parse(e,i,o,l,u){this.status="parsing",this.data=e,this.collisionBoxArray=new F2;const h=new MM(Object.keys(e.layers).sort()),m=new CE(this.tileID,this.promoteId);m.bucketLayerIDs=[];const _={},v=new zP(256,256),x={featureIndex:m,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:v,availableImages:o,brightness:this.brightness},w=i.familiesBySource[this.source];for(const H in w){const Z=e.layers[H];if(!Z)continue;let Y=!1,q=!1,ee=!1;for(const ge of w[H])ge[0].type==="symbol"?Y=!0:q=!0,ge[0].is3D()&&ge[0].type!=="model"&&(ee=!0);if(this.extraShadowCaster&&!ee||this.isSymbolTile===!0&&!Y||this.isSymbolTile===!1&&!q)continue;Z.version===1&&se(`Vector tile source "${this.source}" layer "${H}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const ce=h.encode(H),de=[];for(let ge=0;ge<Z.length;ge++){const ve=Z.feature(ge),Re=m.getId(ve,H);de.push({feature:ve,id:Re,index:ge,sourceLayerIndex:ce})}for(const ge of w[H]){const ve=ge[0];(!this.extraShadowCaster||ve.is3D()&&ve.type!=="model")&&(this.isSymbolTile!==void 0&&ve.type==="symbol"!==this.isSymbolTile||ve.minzoom&&this.zoom<Math.floor(ve.minzoom)||ve.maxzoom&&this.zoom>=ve.maxzoom||ve.visibility!=="none"&&(tT(ge,this.zoom,x.brightness,o),(_[ve.id]=ve.createBucket({index:m.bucketLayerIDs.length,layers:ge,zoom:this.zoom,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:ce,sourceID:this.source,projection:this.projection.spec})).populate(de,x,this.tileID.canonical,this.tileTransform),m.bucketLayerIDs.push(ge.map(Re=>Re.id))))}}let C,k,P,R;v.trim();const z={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},B=()=>{if(C)return u(C);if(this.extraShadowCaster)this.status="done",u(null,{buckets:Ge(_).filter(H=>!H.isEmpty()),featureIndex:m,collisionBoxArray:null,glyphAtlasImage:null,lineAtlas:null,imageAtlas:null,brightness:x.brightness,glyphMap:null,iconMap:null,glyphPositions:null});else if(k&&P&&R){const H=new UP(k),Z=new XM(P,R);for(const Y in _){const q=_[Y];q instanceof mg?(tT(q.layers,this.zoom,x.brightness,o),CW(q,k,H.positions,P,Z.iconPositions,this.showCollisionBoxes,o,this.tileID.canonical,this.tileZoom,this.projection,this.brightness)):q.hasPattern&&(q instanceof Y1||q instanceof I1||q instanceof Eg)&&(tT(q.layers,this.zoom,x.brightness,o),q.addFeatures(x,this.tileID.canonical,Z.patternPositions,o,this.tileTransform,this.brightness))}this.status="done",u(null,{buckets:Ge(_).filter(Y=>!Y.isEmpty()),featureIndex:m,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:H.image,lineAtlas:v,imageAtlas:Z,brightness:x.brightness})}};if(!this.extraShadowCaster){const H=Ce(x.glyphDependencies,q=>Object.keys(q).map(Number));Object.keys(H).length?l.send("getGlyphs",{uid:this.uid,stacks:H,scope:this.scope},(q,ee)=>{C||(C=q,k=ee,B())},void 0,!1,z):k={};const Z=Object.keys(x.iconDependencies);Z.length?l.send("getImages",{icons:Z,source:this.source,scope:this.scope,tileID:this.tileID,type:"icons"},(q,ee)=>{C||(C=q,P=ee,B())},void 0,!1,z):P={};const Y=Object.keys(x.patternDependencies);Y.length?l.send("getImages",{icons:Y,source:this.source,scope:this.scope,tileID:this.tileID,type:"patterns"},(q,ee)=>{C||(C=q,R=ee,B())},void 0,!1,z):R={}}B()}}function tT(r,e,i,o){const l=new Gi(e,{brightness:i});for(const u of r)u.recalculate(l,o)}class $P{constructor(e){this.entries={},this.scheduler=e}request(e,i,o,l){const u=this.entries[e]=this.entries[e]||{callbacks:[]};if(u.result){const[h,m]=u.result;return this.scheduler?this.scheduler.add(()=>{l(h,m)},i):l(h,m),()=>{}}return u.callbacks.push(l),u.cancel||(u.cancel=o((h,m)=>{u.result=[h,m];for(const _ of u.callbacks)this.scheduler?this.scheduler.add(()=>{_(h,m)},i):_(h,m);setTimeout(()=>delete this.entries[e],3e3)})),()=>{u.result||(u.callbacks=u.callbacks.filter(h=>h!==l),u.callbacks.length||(u.cancel(),delete this.entries[e]))}}}function VP(r,e,i){const o=JSON.stringify(r.request);return r.data&&(this.deduped.entries[o]={result:[null,r.data]}),this.deduped.request(o,{type:"parseTile",isSymbolTile:r.isSymbolTile,zoom:r.tileZoom},l=>{const u=qt(r.request,(h,m,_,v)=>{h?l(h):m&&l(null,{vectorTile:i?void 0:new wE(new L1(m)),rawData:m,cacheControl:_,expires:v})});return()=>{u.cancel(),l()}},e)}class jP extends Ln{constructor(e,i,o,l){if(super(),this.id=e,this.dispatcher=o,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,ze(this,oe(i,["url","scheme","tileSize","promoteId"])),this._options=ze({type:"vector"},i),this._collectResourceTiming=!!i.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(l),this._tileWorkers={},this._deduped=new $P}load(e){this._loaded=!1,this.fire(new _t("dataloading",{dataType:"source"}));const i=Array.isArray(this.map._language)?this.map._language.join():this.map._language,o=this.map._worldview;this._tileJSONRequest=eT(this._options,this.map._requestManager,i,o,(l,u)=>{this._tileJSONRequest=null,this._loaded=!0,l?(i&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${i}`),o&&o.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${o}`),this.fire(new ar(l))):u&&(ze(this,u),u.bounds&&(this.tileBounds=new fy(u.bounds,this.minzoom,this.maxzoom)),Tr(u.tiles,this.map._requestManager._customAccessToken),this.fire(new _t("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new _t("data",{dataType:"source",sourceDataType:"content"}))),e&&e(l)})}loaded(){return this._loaded}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}onAdd(e){this.map=e,this.load()}reload(){this.cancelTileJSONRequest();const e=To(this.id,this.scope);this.load(()=>this.map.style.clearSource(e))}setTiles(e){return this._options.tiles=e,this.reload(),this}setUrl(e){return this.url=e,this._options.url=e,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return ze({},this._options)}loadTile(e,i){const o=this.map._requestManager.normalizeTileURL(e.tileID.canonical.url(this.tiles,this.scheme)),l={request:this.map._requestManager.transformRequest(o,Le.Tile),data:void 0,uid:e.uid,tileID:e.tileID,tileZoom:e.tileZoom,zoom:e.tileID.overscaledZ,tileSize:this.tileSize*e.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,pixelRatio:Jr.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:e.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0,extraShadowCaster:e.isExtraShadowCaster};if(l.request.collectResourceTiming=this._collectResourceTiming,e.actor&&e.state!=="expired")e.state==="loading"?e.reloadCallback=i:e.request=e.actor.send("reloadTile",l,u.bind(this));else if(e.actor=this._tileWorkers[o]=this._tileWorkers[o]||this.dispatcher.getActor(),this.dispatcher.ready)e.request=e.actor.send("loadTile",l,u.bind(this),void 0,!0);else{const h=VP.call({deduped:this._deduped},l,(m,_)=>{m||!_?u.call(this,m):(l.data={cacheControl:_.cacheControl,expires:_.expires,rawData:_.rawData.slice(0)},e.actor&&e.actor.send("loadTile",l,u.bind(this),void 0,!0))},!0);e.request={cancel:h}}function u(h,m){return delete e.request,e.aborted?i(null):h&&h.status!==404?i(h):(m&&m.resourceTiming&&(e.resourceTiming=m.resourceTiming),this.map._refreshExpiredTiles&&m&&e.setExpiryData(m),e.loadVectorData(m,this.map.painter),Ai(this.dispatcher),i(null),void(e.reloadCallback&&(this.loadTile(e,e.reloadCallback),e.reloadCallback=null)))}}abortTile(e){e.request&&(e.request.cancel(),delete e.request),e.actor&&e.actor.send("abortTile",{uid:e.uid,type:this.type,source:this.id,scope:this.scope})}unloadTile(e){e.unloadVectorData(),e.actor&&e.actor.send("removeTile",{uid:e.uid,type:this.type,source:this.id,scope:this.scope})}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class Cg extends Ln{constructor(e,i,o,l){super(),this.id=e,this.dispatcher=o,this.setEventedParent(l),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=ze({type:"raster"},i),ze(this,oe(i,["url","scheme","tileSize"]))}load(e){this._loaded=!1,this.fire(new _t("dataloading",{dataType:"source"})),this._tileJSONRequest=eT(this._options,this.map._requestManager,null,null,(i,o)=>{this._tileJSONRequest=null,this._loaded=!0,i?this.fire(new ar(i)):o&&(ze(this,o),o.bounds&&(this.tileBounds=new fy(o.bounds,this.minzoom,this.maxzoom)),Tr(o.tiles),this.fire(new _t("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new _t("data",{dataType:"source",sourceDataType:"content"}))),e&&e(i)})}loaded(){return this._loaded}onAdd(e){this.map=e,this.load()}reload(){this.cancelTileJSONRequest();const e=To(this.id,this.scope);this.load(()=>this.map.style.clearSource(e))}setTiles(e){return this._options.tiles=e,this.reload(),this}setUrl(e){return this.url=e,this._options.url=e,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return ze({},this._options)}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}loadTile(e,i){const o=Jr.devicePixelRatio>=2,l=this.map._requestManager.normalizeTileURL(e.tileID.canonical.url(this.tiles,this.scheme),o,this.tileSize);e.request=Ur(this.map._requestManager.transformRequest(l,Le.Tile),(u,h,m,_)=>(delete e.request,e.aborted?(e.state="unloaded",i(null)):u?(e.state="errored",i(u)):h?(this.map._refreshExpiredTiles&&e.setExpiryData({cacheControl:m,expires:_}),e.setTexture(h,this.map.painter),e.state="loaded",Ai(this.dispatcher),void i(null)):i(null)))}static loadTileData(e,i,o){e.setTexture(i,o)}static unloadTileData(e,i){e.texture&&i.saveTileTexture(e.texture)}abortTile(e,i){e.request&&(e.request.cancel(),delete e.request),i()}unloadTile(e,i){e.texture&&this.map.painter.saveTileTexture(e.texture),i()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}let rT;function FG(){return Ry.workerClass!=null?new Ry.workerClass:new g.Worker(Ry.workerUrl)}const nT="mapboxgl_preloaded_worker_pool";class l0{constructor(){this.active={}}acquire(e){if(!this.workers)for(this.workers=[];this.workers.length<l0.workerCount;)this.workers.push(new FG);return this.active[e]=!0,this.workers.slice()}release(e){delete this.active[e],this.workers&&this.numActive()===0&&(this.workers.forEach(i=>{i.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[nT]}numActive(){return Object.keys(this.active).length}}let Ag;function kg(){return Ag||(Ag=new l0),Ag}l0.workerCount=2;let hy,iT,Jl,aT=null;function WP(){return be()&&self.worker&&self.worker.dracoUrl?self.worker.dracoUrl:iT||E.DRACO_URL}const oT=5123,sT=5126,lT={5120:Int8Array,5121:Uint8Array,5122:Int16Array,[oT]:Uint16Array,5125:Uint32Array,[sT]:Float32Array},PG={5120:"DT_INT8",5121:"DT_UINT8",5122:"DT_INT16",[oT]:"DT_UINT16",5125:"DT_UINT32",[sT]:"DT_FLOAT32"},cT={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16};function HP(r,e,i){const o=i.json.bufferViews.length,l=i.buffers.length;e.bufferView=o,i.json.bufferViews[o]={buffer:l,byteLength:r.byteLength},i.buffers[l]=r}const uT="KHR_draco_mesh_compression";function OG(r,e){const i=r.extensions&&r.extensions[uT];if(!i)return;const o=new Jl.Decoder,l=ZP(e,i.bufferView),u=new Jl.Mesh;if(!o.DecodeArrayToMesh(l,l.byteLength,u))throw new Error("Failed to decode Draco mesh");const h=e.json.accessors[r.indices],m=lT[h.componentType],_=h.count*m.BYTES_PER_ELEMENT,v=Jl._malloc(_);m===Uint16Array?o.GetTrianglesUInt16Array(u,_,v):o.GetTrianglesUInt32Array(u,_,v),HP(Jl.memory.buffer.slice(v,v+_),h,e),Jl._free(v);for(const x of Object.keys(i.attributes)){const w=o.GetAttributeByUniqueId(u,i.attributes[x]),C=e.json.accessors[r.attributes[x]],k=PG[C.componentType],P=C.count*cT[C.type]*lT[C.componentType].BYTES_PER_ELEMENT,R=Jl._malloc(P);o.GetAttributeDataArrayForAllPoints(u,w,Jl[k],P,R),HP(Jl.memory.buffer.slice(R,R+P),C,e),Jl._free(R)}o.destroy(),u.destroy(),delete r.extensions[uT]}const GP=1179937895,qP=new TextDecoder("utf8");function XP(r,e){return new URL(r,e).href}function RG(r,e,i,o){return fetch(XP(r.uri,o)).then(l=>l.arrayBuffer()).then(l=>{e.buffers[i]=l})}function ZP(r,e){const i=r.json.bufferViews[e];return new Uint8Array(r.buffers[i.buffer],i.byteOffset||0,i.byteLength)}function LG(r,e,i,o){if(r.uri){const l=XP(r.uri,o);return fetch(l).then(u=>u.blob()).then(u=>g.createImageBitmap(u)).then(u=>{e.images[i]=u})}if(r.bufferView!==void 0){const l=ZP(e,r.bufferView),u=new g.Blob([l],{type:r.mimeType});return g.createImageBitmap(u).then(h=>{e.images[i]=h})}}function KP(r,e=0,i){const o={json:null,images:[],buffers:[]};if(new Uint32Array(r,e,1)[0]===GP){const v=new Uint32Array(r,e);let x=2;const w=(v[x++]>>2)-3,C=v[x++]>>2;if(x++,o.json=JSON.parse(qP.decode(v.subarray(x,x+C))),x+=C,x<w){const k=v[x++];x++;const P=e+(x<<2);o.buffers[0]=r.slice(P,P+k)}}else o.json=JSON.parse(qP.decode(new Uint8Array(r,e)));const{buffers:l,images:u,meshes:h,extensionsUsed:m}=o.json;let _=Promise.resolve();if(l){const v=[];for(let x=0;x<l.length;x++){const w=l[x];w.uri?v.push(RG(w,o,x,i)):o.buffers[x]||(o.buffers[x]=null)}_=Promise.all(v)}return _.then(()=>{const v=[],x=m&&m.includes(uT);if(x&&v.push(function(){if(!Jl)return hy||(hy=function(w){let C,k=null;function P(){C=new Uint8Array(k.buffer)}function R(){throw new Error("Unexpected Draco error.")}const z={a:{a:R,d:function(B,H,Z){return C.copyWithin(B,H,H+Z)},c:function(B){const H=C.length,Z=Math.max(B>>>0,Math.ceil(1.2*H)),Y=Math.ceil((Z-H)/65536);try{return k.grow(Y),P(),!0}catch{return!1}},b:R}};return(WebAssembly.instantiateStreaming?WebAssembly.instantiateStreaming(w,z):w.then(B=>B.arrayBuffer()).then(B=>WebAssembly.instantiate(B,z))).then(B=>{const{Rb:H,Qb:Z,P:Y,T:q,X:ee,Ja:ce,La:de,Qa:ge,Va:ve,Wa:Re,eb:ke,jb:$e,f:Ie,e:Qe,yb:st,zb:ft,Ab:Je,Bb:tt,Db:pt,Gb:bt}=B.instance.exports;k=Qe;const St=(()=>{let Pt=0,Ut=0,Tt=0,Mt=0;return tr=>{Tt&&(H(Mt),H(Pt),Ut+=Tt,Tt=Pt=0),Pt||(Ut+=128,Pt=Z(Ut));const ur=tr.length+7&-8;let cr=Pt;ur>=Ut&&(Tt=ur,cr=Mt=Z(ur));for(let hr=0;hr<tr.length;hr++)C[cr+hr]=tr[hr];return cr}})();return P(),Ie(),{memory:Qe,_free:H,_malloc:Z,Mesh:class{constructor(){this.ptr=Y()}destroy(){q(this.ptr)}},Decoder:class{constructor(){this.ptr=ce()}destroy(){$e(this.ptr)}DecodeArrayToMesh(Pt,Ut,Tt){const Mt=St(Pt),tr=de(this.ptr,Mt,Ut,Tt.ptr);return!!ee(tr)}GetAttributeByUniqueId(Pt,Ut){return{ptr:ge(this.ptr,Pt.ptr,Ut)}}GetTrianglesUInt16Array(Pt,Ut,Tt){ve(this.ptr,Pt.ptr,Ut,Tt)}GetTrianglesUInt32Array(Pt,Ut,Tt){Re(this.ptr,Pt.ptr,Ut,Tt)}GetAttributeDataArrayForAllPoints(Pt,Ut,Tt,Mt,tr){ke(this.ptr,Pt.ptr,Ut.ptr,Tt,Mt,tr)}},DT_INT8:st(),DT_UINT8:ft(),DT_INT16:Je(),DT_UINT16:tt(),DT_UINT32:pt(),DT_FLOAT32:bt()}})}(fetch(WP())),hy.then(w=>{Jl=w,hy=void 0}))}()),u)for(let w=0;w<u.length;w++)v.push(LG(u[w],o,w,i));return(v.length?Promise.all(v):Promise.resolve()).then(()=>{if(x&&h)for(const{primitives:w}of h)for(const C of w)OG(C,o);return o})})}function YP(r){return fetch(r).then(e=>e.arrayBuffer()).then(e=>KP(e,0,r))}class JP{constructor(e,i,o){if(this.triangleCount=i.length/3,this.min=new D(0,0),this.max=new D(0,0),this.xScale=0,this.yScale=0,this.cellsX=0,this.cellsY=0,this.cells=[],this.payload=[],this.triangleCount===0||e.length===0||o===0)return;const l=e.map(x=>x.x),u=e.map(x=>x.y);this.min=new D(Math.min(...l),Math.min(...u)),this.max=new D(Math.max(...l),Math.max(...u));const h=this.max.sub(this.min);h.x=Math.max(h.x,1),h.y=Math.max(h.y,1);const m=Math.max(h.x,h.y)/o;this.cellsX=Math.max(1,Math.ceil(h.x/m)),this.cellsY=Math.max(1,Math.ceil(h.y/m)),this.xScale=1/m,this.yScale=1/m;const _=[];for(let x=0;x<this.triangleCount;x++){const w=e[i[3*x+0]].sub(this.min),C=e[i[3*x+1]].sub(this.min),k=e[i[3*x+2]].sub(this.min),P=Yf(Math.floor(Math.min(w.x,C.x,k.x)),this.xScale,this.cellsX),R=Yf(Math.floor(Math.max(w.x,C.x,k.x)),this.xScale,this.cellsX),z=Yf(Math.floor(Math.min(w.y,C.y,k.y)),this.yScale,this.cellsY),B=Yf(Math.floor(Math.max(w.y,C.y,k.y)),this.yScale,this.cellsY),H=new D(0,0),Z=new D(0,0),Y=new D(0,0),q=new D(0,0);for(let ee=z;ee<=B;++ee){H.y=Z.y=ee*m,Y.y=q.y=(ee+1)*m;for(let ce=P;ce<=R;++ce)H.x=Y.x=ce*m,Z.x=q.x=(ce+1)*m,(dE(w,C,k,H,Z,q)||dE(w,C,k,H,q,Y))&&_.push({cellIdx:ee*this.cellsX+ce,triIdx:x})}}if(_.length===0)return;_.sort((x,w)=>x.cellIdx-w.cellIdx||x.triIdx-w.triIdx);let v=0;for(;v<_.length;){const x=_[v].cellIdx,w={start:this.payload.length,len:0};for(;v<_.length&&_[v].cellIdx===x;)++w.len,this.payload.push(_[v++].triIdx);this.cells[x]=w}}query(e,i,o){if(this.triangleCount===0||this.cells.length===0||e.x>this.max.x||this.min.x>i.x||e.y>this.max.y||this.min.y>i.y)return;this.lookup||(this.lookup=new Uint8Array(Math.ceil(this.triangleCount/8)));for(let _=0;_<this.lookup.length;_++)this.lookup[_]=0;const l=Yf(e.x-this.min.x,this.xScale,this.cellsX),u=Yf(i.x-this.min.x,this.xScale,this.cellsX),h=Yf(e.y-this.min.y,this.yScale,this.cellsY),m=Yf(i.y-this.min.y,this.yScale,this.cellsY);for(let _=h;_<=m;_++)for(let v=l;v<=u;v++){const x=this.cells[_*this.cellsX+v];if(x)for(let w=0;w<x.len;w++){const C=this.payload[x.start+w],k=Math.floor(C/8),P=1<<C%8;if(!(this.lookup[k]&P)&&(this.lookup[k]|=P,o.push(C),o.length===this.triangleCount))return}}}}function Yf(r,e,i){return Math.max(0,Math.min(i-1,Math.floor(r*e)))}function md(r,e){const i=r.json.bufferViews[e.bufferView];return new lT[e.componentType](r.buffers[i.buffer],(e.byteOffset||0)+(i.byteOffset||0),e.count*cT[e.type])}function DG(r,e,i){const o=r.indices,l=r.attributes,u={};u.indexArray=new Oa;const h=e.json.accessors[o],m=h.count/3;u.indexArray.reserve(m);const _=md(e,h);for(let C=0;C<m;C++)u.indexArray.emplaceBack(_[3*C],_[3*C+1],_[3*C+2]);u.indexArray._trim(),u.vertexArray=new Of;const v=e.json.accessors[l.POSITION];u.vertexArray.reserve(v.count);const x=md(e,v);for(let C=0;C<v.count;C++)u.vertexArray.emplaceBack(x[3*C],x[3*C+1],x[3*C+2]);if(u.vertexArray._trim(),u.aabb=new Oi(v.min,v.max),u.centroid=function(C,k){const P=[0,0,0],R=C.length;if(R>0){for(let z=0;z<R;z++){const B=3*C[z];P[0]+=k[B],P[1]+=k[B+1],P[2]+=k[B+2]}P[0]/=R,P[1]/=R,P[2]/=R}return P}(_,x),l.COLOR_0!==void 0){const C=e.json.accessors[l.COLOR_0],k=cT[C.type];if(C.componentType===sT){u.colorArray=k===3?new Of:new Mf,u.colorArray.reserve(C.count);const P=md(e,C);if(k===3)for(let R=0;R<C.count;R++)u.colorArray.emplaceBack(P[3*R],P[3*R+1],P[3*R+2]);else for(let R=0;R<C.count;R++)u.colorArray.emplaceBack(P[4*R],P[4*R+1],P[4*R+2],P[4*R+3]);u.colorArray._trim()}else if(C.componentType===oT&&k===4){u.colorArray=new Mf,u.colorArray.resize(C.count);const P=md(e,C),R=1/65535,z=u.colorArray.float32;for(let B=0;B<4*P.length;++B)z[B]=P[B]*R}else se(`glTF color buffer parsing for accessor ${JSON.stringify(C)} is not supported`)}if(l.NORMAL!==void 0){u.normalArray=new Of;const C=e.json.accessors[l.NORMAL];u.normalArray.reserve(C.count);const k=md(e,C);for(let P=0;P<C.count;P++)u.normalArray.emplaceBack(k[3*P],k[3*P+1],k[3*P+2]);u.normalArray._trim()}if(l.TEXCOORD_0!==void 0&&i.length>0){u.texcoordArray=new Zm;const C=e.json.accessors[l.TEXCOORD_0];u.texcoordArray.reserve(C.count);const k=md(e,C);for(let P=0;P<C.count;P++)u.texcoordArray.emplaceBack(k[2*P],k[2*P+1]);u.texcoordArray._trim()}const w=r.material;return u.material=function(C,k){const{emissiveFactor:P=[0,0,0],alphaMode:R="OPAQUE",alphaCutoff:z=.5,normalTexture:B,occlusionTexture:H,emissiveTexture:Z,doubleSided:Y}=C,{baseColorFactor:q=[1,1,1,1],metallicFactor:ee=1,roughnessFactor:ce=1,baseColorTexture:de,metallicRoughnessTexture:ge}=C.pbrMetallicRoughness||{};return{pbrMetallicRoughness:{baseColorFactor:new hn(...q),metallicFactor:ee,roughnessFactor:ce,baseColorTexture:de?k[de.index]:void 0,metallicRoughnessTexture:ge?k[ge.index]:void 0},doubleSided:Y,emissiveFactor:P,alphaMode:R,alphaCutoff:z,normalTexture:B?k[B.index]:void 0,occlusionTexture:H?k[H.index]:void 0,emissionTexture:Z?k[Z.index]:void 0,defined:C.defined===void 0}}(w!==void 0?e.json.materials[w]:{defined:!1},i),l._FEATURE_RGBA4444!==void 0&&(u.featureData=new Uint32Array(md(e,e.json.accessors[l._FEATURE_RGBA4444]).buffer)),u}function QP(r,e,i){const{matrix:o,rotation:l,translation:u,scale:h,mesh:m,extras:_,children:v}=r,x={};if(x.matrix=o||dt.fromRotationTranslationScale([],l||[0,0,0,1],u||[0,0,0],h||[1,1,1]),m!==void 0){x.meshes=i[m];const w=x.anchor=[0,0];for(const C of x.meshes){const{min:k,max:P}=C.aabb;w[0]+=k[0]+P[0],w[1]+=k[1]+P[1]}w[0]=Math.floor(w[0]/x.meshes.length/2),w[1]=Math.floor(w[1]/x.meshes.length/2)}if(_&&(_.id&&(x.id=_.id),_.lights&&(x.lights=function(w){if(!w.length)return[];const C=function(B){const H=atob(B),Z=new Uint8Array(H.length);for(let Y=0;Y<H.length;Y++)Z[Y]=H.codePointAt(Y);return Z}(w),k=[],P=C.length/24,R=new Uint16Array(C.buffer),z=new Float32Array(C.buffer);for(let B=0;B<P;B++){const H=R[2*B*6]/30,Z=R[2*B*6+1]/30,Y=R[2*B*6+10]/100,q=z[6*B+1],ee=z[6*B+2],ce=z[6*B+3],de=z[6*B+4],ge=ce-q,ve=de-ee,Re=Math.hypot(ge,ve);k.push({pos:[q+.5*ge,ee+.5*ve,Z],normal:[ve/Re,-ge/Re,0],width:Re,height:H,depth:Y,points:[q,ee,ce,de]})}return k}(_.lights))),v){const w=[];for(const C of v)w.push(QP(e.json.nodes[C],e,i));x.children=w}return x}function BG(r){if(r.vertices.length===0||r.indices.length===0)return null;const[e,i]=[r.vertices[0].clone(),r.vertices[0].clone()];for(let h=1;h<r.vertices.length;++h){const m=r.vertices[h];e.x=Math.min(e.x,m.x),e.y=Math.min(e.y,m.y),i.x=Math.max(i.x,m.x),i.y=Math.max(i.y,m.y)}const o=Math.ceil(Math.max(i.x-e.x,i.y-e.y)/256),l=Math.max(8,o),u=new JP(r.vertices,r.indices,l);return{vertices:r.vertices,indices:r.indices,grid:u,min:e,max:i}}function zG(r){if(!r.extras||!r.extras.ground)return null;const e=r.extras.ground;if(!e||!Array.isArray(e)||e.length===0)return null;const i=e[0];if(!i||!Array.isArray(i)||i.length===0)return null;const o=[];for(const h of i){if(!Array.isArray(h)||h.length!==2)continue;const m=h[0],_=h[1];typeof m=="number"&&typeof _=="number"&&o.push(new D(m,_))}if(o.length<3)return null;o.length>1&&o[o.length-1].equals(o[0])&&o.pop();let l=0;for(let h=0;h<o.length;h++){const m=o[h],_=o[(h+1)%o.length],v=o[(h+2)%o.length];l+=(m.x-_.x)*(v.y-_.y)-(v.x-_.x)*(m.y-_.y)}l>0&&o.reverse();const u=k1(o.flatMap(h=>[h.x,h.y]),[]);return u.length===0?null:{vertices:o,indices:u}}function NG(r){const e=[],i=[];let o=0;for(const l of r){o=e.length;const u=l.vertexArray.float32,h=l.indexArray.uint16;for(let m=0;m<l.vertexArray.length;m++)e.push(new D(u[3*m+0],u[3*m+1]));for(let m=0;m<3*l.indexArray.length;m++)i.push(h[m]+o)}if(i.length%3!=0)return null;for(let l=0;l<i.length;l+=3){const u=e[i[l+0]],h=e[i[l+1]],m=e[i[l+2]];(u.x-h.x)*(m.y-h.y)-(m.x-h.x)*(u.y-h.y)>0&&([i[l+1],i[l+2]]=[i[l+2],i[l+1]])}return{vertices:e,indices:i}}function fT(r){const e=function(_,v){const x=[],w=g.WebGL2RenderingContext;if(_.json.textures)for(const C of _.json.textures){const k={magFilter:w.LINEAR,minFilter:w.NEAREST,wrapS:w.REPEAT,wrapT:w.REPEAT};C.sampler!==void 0&&Object.assign(k,_.json.samplers[C.sampler]),x.push({image:v[C.source],sampler:k,uploaded:!1})}return x}(r,r.images),i=function(_,v){const x=[];for(const w of _.json.meshes){const C=[];for(const k of w.primitives)C.push(DG(k,_,v));x.push(C)}return x}(r,e),{scenes:o,scene:l,nodes:u}=r.json,h=o?o[l||0].nodes:u,m=[];for(const _ of h)m.push(QP(u[_],r,i));return function(_,v,x){const w={},C=new Set;for(let k=0;k<_.length;k++){const P=x[v[k]];if(!P.extras)continue;const R=P.extras["mapbox:footprint:version"],z=P.extras["mapbox:footprint:id"];(R||z)&&C.add(k),R==="1.0.0"&&z&&(w[z]=k)}for(let k=0;k<_.length;k++){if(C.has(k))continue;const P=_[k],R=x[v[k]];if(!R.extras)continue;let z=null;P.id in w&&(z=NG(_[w[P.id]].meshes)),z||(z=zG(R)),z&&(P.footprint=BG(z))}if(C.size>0){const k=Array.from(C.values()).sort((P,R)=>P-R);for(let P=k.length-1;P>=0;P--)_.splice(k[P],1)}}(m,h,r.json.nodes),m}function UG(r){r.heightmap=new Float32Array(4096),r.heightmap.fill(-1);const e=r.vertexArray.float32,i=r.aabb.min[0]-1,o=r.aabb.min[1]-1,l=fd/(r.aabb.max[0]-i+2),u=fd/(r.aabb.max[1]-o+2);for(let h=0;h<e.length;h+=3){const m=e[h+2],_=(e[h+0]-i)*l|0,v=(e[h+1]-o)*u|0;m>r.heightmap[v*fd+_]&&(r.heightmap[v*fd+_]=m)}}function $G(r,e){const i={};i.indexArray=new Oa,i.indexArray.reserve(4*r.length),i.vertexArray=new Of,i.vertexArray.reserve(10*r.length),i.colorArray=new Mf,i.vertexArray.reserve(10*r.length);let o=0;for(const h of r){const m=Math.min(10,Math.max(4,1.3*h.height))*e,_=[-h.normal[1],h.normal[0],0],v=Math.min(.29,.1*h.width/h.depth),x=h.width-2*h.depth*e*(v+.01),w=We.scaleAndAdd([],h.pos,_,x/2),C=We.scaleAndAdd([],h.pos,_,-x/2),k=[w[0],w[1],w[2]+h.height],P=[C[0],C[1],C[2]+h.height],R=We.scaleAndAdd([],h.normal,_,v);We.scale(R,R,m);const z=We.scaleAndAdd([],h.normal,_,-v);We.scale(z,z,m),We.add(R,w,R),We.add(z,C,z),w[2]+=.1,C[2]+=.1,i.vertexArray.emplaceBack(R[0],R[1],R[2]),i.vertexArray.emplaceBack(z[0],z[1],z[2]),i.vertexArray.emplaceBack(w[0],w[1],w[2]),i.vertexArray.emplaceBack(C[0],C[1],C[2]),i.vertexArray.emplaceBack(k[0],k[1],k[2]),i.vertexArray.emplaceBack(P[0],P[1],P[2]),i.vertexArray.emplaceBack(w[0],w[1],w[2]),i.vertexArray.emplaceBack(C[0],C[1],C[2]),i.vertexArray.emplaceBack(R[0],R[1],R[2]),i.vertexArray.emplaceBack(z[0],z[1],z[2]);const B=x/m/2;i.colorArray.emplaceBack(-B-v,-1,B,.8),i.colorArray.emplaceBack(B+v,-1,B,.8),i.colorArray.emplaceBack(-B,0,B,1.3),i.colorArray.emplaceBack(B,0,B,1.3),i.colorArray.emplaceBack(B+v,-.8,B,.7),i.colorArray.emplaceBack(B+v,-.8,B,.7),i.colorArray.emplaceBack(0,0,B,1.3),i.colorArray.emplaceBack(0,0,B,1.3),i.colorArray.emplaceBack(B+v,-1.2,B,.8),i.colorArray.emplaceBack(B+v,-1.2,B,.8),i.indexArray.emplaceBack(6+o,4+o,8+o),i.indexArray.emplaceBack(7+o,9+o,5+o),i.indexArray.emplaceBack(0+o,1+o,2+o),i.indexArray.emplaceBack(1+o,3+o,2+o),o+=10}const l={defined:!0,emissiveFactor:[0,0,0]},u={};return u.baseColorFactor=hn.white,l.pbrMetallicRoughness=u,i.material=l,i.aabb=new Oi([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),i}xr(JP,"TriangleGridIndex");const hT={vector:jP,raster:Cg,"raster-dem":class extends Cg{constructor(r,e,i,o){super(r,e,i,o),this.type="raster-dem",this.maxzoom=22,this._options=ze({type:"raster-dem"},e),this.encoding=e.encoding||"mapbox"}loadTile(r,e){var u,h;const i=this.map._requestManager.normalizeTileURL(r.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);r.request=Ur(this.map._requestManager.transformRequest(i,Le.Tile),(function(m,_,v,x){if(delete r.request,r.aborted)r.state="unloaded",e(null);else if(m)r.state="errored",e(m);else if(_){this.map._refreshExpiredTiles&&r.setExpiryData({cacheControl:v,expires:x});const C=g.ImageBitmap&&_ instanceof g.ImageBitmap&&(rT==null&&(rT=g.OffscreenCanvas&&new g.OffscreenCanvas(1,1).getContext("2d")&&typeof g.createImageBitmap=="function"),rT),k=1-(_.width-((w=_.width)<=1?1:Math.pow(2,Math.floor(Math.log(w)/Math.LN2))))/2;k<1||r.neighboringTiles||(r.neighboringTiles=this._getNeighboringTiles(r.tileID));const P=C?_:Jr.getImageData(_,k),R={uid:r.uid,coord:r.tileID,source:this.id,scope:this.scope,rawImageData:P,encoding:this.encoding,padding:k,convertToFloat:o};r.actor&&r.state!=="expired"||(r.actor=this.dispatcher.getActor(),r.actor.send("loadDEMTile",R,l.bind(this),void 0,!0))}var w}).bind(this));const o=(h=(u=this.map)==null?void 0:u.painter)==null?void 0:h.terrainUseFloatDEM();function l(m,_){m&&(r.state="errored",e(m)),_&&(r.dem=_,r.dem.onDeserialize(),r.needsHillshadePrepare=!0,r.needsDEMTextureUpload=!0,r.state="loaded",e(null))}}_getNeighboringTiles(r){const e=r.canonical,i=Math.pow(2,e.z),o=(e.x-1+i)%i,l=e.x===0?r.wrap-1:r.wrap,u=(e.x+1+i)%i,h=e.x+1===i?r.wrap+1:r.wrap,m={};return m[new Wn(r.overscaledZ,l,e.z,o,e.y).key]={backfilled:!1},m[new Wn(r.overscaledZ,h,e.z,u,e.y).key]={backfilled:!1},e.y>0&&(m[new Wn(r.overscaledZ,l,e.z,o,e.y-1).key]={backfilled:!1},m[new Wn(r.overscaledZ,r.wrap,e.z,e.x,e.y-1).key]={backfilled:!1},m[new Wn(r.overscaledZ,h,e.z,u,e.y-1).key]={backfilled:!1}),e.y+1<i&&(m[new Wn(r.overscaledZ,l,e.z,o,e.y+1).key]={backfilled:!1},m[new Wn(r.overscaledZ,r.wrap,e.z,e.x,e.y+1).key]={backfilled:!1},m[new Wn(r.overscaledZ,h,e.z,u,e.y+1).key]={backfilled:!1}),m}unloadTile(r){r.demTexture&&this.map.painter.saveTileTexture(r.demTexture),r.hillshadeFBO&&(r.hillshadeFBO.destroy(),delete r.hillshadeFBO),r.dem&&delete r.dem,delete r.neighboringTiles,r.state="unloaded"}},geojson:class extends Ln{constructor(r,e,i,o){super(),this.id=r,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=i.getActor(),this.setEventedParent(o),this._data=e.data,this._options=ze({},e),this._collectResourceTiming=e.collectResourceTiming,e.maxzoom!==void 0&&(this.maxzoom=e.maxzoom),e.type&&(this.type=e.type),e.attribution&&(this.attribution=e.attribution),this.promoteId=e.promoteId;const l=Et/this.tileSize;this.workerOptions=ze({source:this.id,scope:this.scope,cluster:e.cluster||!1,geojsonVtOptions:{buffer:(e.buffer!==void 0?e.buffer:128)*l,tolerance:(e.tolerance!==void 0?e.tolerance:.375)*l,extent:Et,maxZoom:this.maxzoom,lineMetrics:e.lineMetrics||!1,generateId:e.generateId||!1},superclusterOptions:{maxZoom:e.clusterMaxZoom!==void 0?e.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,e.clusterMinPoints||2),extent:Et,radius:(e.clusterRadius!==void 0?e.clusterRadius:50)*l,log:!1,generateId:e.generateId||!1},clusterProperties:e.clusterProperties,filter:e.filter},e.workerOptions)}onAdd(r){this.map=r,this.setData(this._data)}setData(r){return this._data=r,this._updateWorkerData(),this}getClusterExpansionZoom(r,e){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:r,source:this.id,scope:this.scope},e),this}getClusterChildren(r,e){return this.actor.send("geojson.getClusterChildren",{clusterId:r,source:this.id,scope:this.scope},e),this}getClusterLeaves(r,e,i,o){return this.actor.send("geojson.getClusterLeaves",{source:this.id,scope:this.scope,clusterId:r,limit:e,offset:i},o),this}_updateWorkerData(){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new _t("dataloading",{dataType:"source"})),this._loaded=!1;const r=ze({},this.workerOptions);r.scope=this.scope;const e=this._data;typeof e=="string"?(r.request=this.map._requestManager.transformRequest(Jr.resolveURL(e),Le.Source),r.request.collectResourceTiming=this._collectResourceTiming):r.data=JSON.stringify(e),this._pendingLoad=this.actor.send(`${this.type}.loadData`,r,(i,o)=>{if(this._loaded=!0,this._pendingLoad=null,i)this.fire(new ar(i));else{const l={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&o&&o.resourceTiming&&o.resourceTiming[this.id]&&(l.resourceTiming=o.resourceTiming[this.id]),this.fire(new _t("data",l)),this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(r,e){const i=r.actor?"reloadTile":"loadTile";r.actor=this.actor;const o={type:this.type,uid:r.uid,tileID:r.tileID,tileZoom:r.tileZoom,zoom:r.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,scope:this.scope,pixelRatio:Jr.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,brightness:this.map.style&&this.map.style.getBrightness()||0};r.request=this.actor.send(i,o,(l,u)=>(delete r.request,r.unloadVectorData(),r.aborted?e(null):l?e(l):(r.loadVectorData(u,this.map.painter,i==="reloadTile"),e(null))),void 0,i==="loadTile")}abortTile(r){r.request&&(r.request.cancel(),delete r.request),r.aborted=!0}unloadTile(r){r.unloadVectorData(),this.actor.send("removeTile",{uid:r.uid,type:this.type,source:this.id,scope:this.scope})}onRemove(){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return ze({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends Vc{constructor(r,e,i,o){super(r,e,i,o),this.roundZoom=!0,this.type="video",this.options=e}load(){this._loaded=!1;const r=this.options;this.urls=[];for(const e of r.urls)this.urls.push(this.map._requestManager.transformRequest(e,Le.Source).url);(function(e,i){const o=g.document.createElement("video");o.muted=!0,o.onloadstart=function(){i(null,o)};for(let l=0;l<e.length;l++){const u=g.document.createElement("source");Jt(e[l])||(o.crossOrigin="Anonymous"),u.src=e[l],o.appendChild(u)}})(this.urls,(e,i)=>{this._loaded=!0,e?this.fire(new ar(e)):i&&(this.video=i,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(r){if(this.video){const e=this.video.seekable;r<e.start(0)||r>e.end(0)?this.fire(new ar(new nr(`sources.${this.id}`,null,`Playback for this video can be set only between the ${e.start(0)} and ${e.end(0)}-second mark.`))):this.video.currentTime=r}}getVideo(){return this.video}onAdd(r){this.map||(this.map=r,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const r=this.map.painter.context,e=r.gl;this.texture?this.video.paused||(this.texture.bind(e.LINEAR,e.CLAMP_TO_EDGE),e.texSubImage2D(e.TEXTURE_2D,0,0,0,e.RGBA,e.UNSIGNED_BYTE,this.video)):(this.texture=new Ia(r,this.video,e.RGBA),this.texture.bind(e.LINEAR,e.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(r)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:Vc,model:class extends Ln{constructor(r,e,i,o){super(),this.id=r,this.type="model",this.models=[],this._loaded=!1,this._options=e}load(){const r=[];for(const e in this._options.models){const i=this._options.models[e],o=YP(this.map._requestManager.transformRequest(i.uri,Le.Model).url).then(l=>{if(!l)return;const u=fT(l),h=new qF(e,i.position,i.orientation,u);h.computeBoundsAndApplyParent(),this.models.push(h)}).catch(l=>{this.fire(new ar(new Error(`Could not load model ${e} from ${i.uri}: ${l.message}`)))});r.push(o)}return Promise.allSettled(r).then(()=>{this._loaded=!0,this.fire(new _t("data",{dataType:"source",sourceDataType:"metadata"}))}).catch(e=>{this.fire(new ar(new Error(`Could not load models: ${e.message}`)))})}onAdd(r){this.map=r,this.load()}hasTransition(){return!1}loaded(){return this._loaded}getModels(){return this.models}loadTile(r,e){}serialize(){return{type:"model"}}},"batched-model":class extends Ln{constructor(r,e,i,o){super(),this.type="batched-model",this.id=r,this.tileSize=512,this._options=e,this.tiles=this._options.tiles,this.maxzoom=e.maxzoom||19,this.minzoom=e.minzoom||0,this.roundZoom=!0,this.usedInConflation=!0,this.dispatcher=i,this.reparseOverscaled=!1,this.scheme="xyz",this._loaded=!1,this.setEventedParent(o)}onAdd(r){this.map=r,this.load()}load(r){this._loaded=!1,this.fire(new _t("dataloading",{dataType:"source"}));const e=Array.isArray(this.map._language)?this.map._language.join():this.map._language,i=this.map._worldview;this._tileJSONRequest=eT(this._options,this.map._requestManager,e,i,(o,l)=>{this._tileJSONRequest=null,this._loaded=!0,o?(e&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${e}`),i&&i.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${i}`),this.fire(new ar(o))):l&&(ze(this,l),l.bounds&&(this.tileBounds=new fy(l.bounds,this.minzoom,this.maxzoom)),Tr(l.tiles,this.map._requestManager._customAccessToken),this.fire(new _t("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new _t("data",{dataType:"source",sourceDataType:"content"}))),r&&r(o)})}hasTransition(){return!1}hasTile(r){return!this.tileBounds||this.tileBounds.contains(r.canonical)}loaded(){return this._loaded}loadTile(r,e){const i=this.map._requestManager.normalizeTileURL(r.tileID.canonical.url(this.tiles,this.scheme)),o={request:this.map._requestManager.transformRequest(i,Le.Tile),data:void 0,uid:r.uid,tileID:r.tileID,tileZoom:r.tileZoom,zoom:r.tileID.overscaledZ,tileSize:this.tileSize*r.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,showCollisionBoxes:this.map.showCollisionBoxes,isSymbolTile:r.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0};if(r.actor&&r.state!=="expired")if(r.state==="loading")r.reloadCallback=e;else{if(r.buckets){const u=Object.values(r.buckets);for(const h of u)h.dirty=!0;return void(r.state="loaded")}r.request=r.actor.send("reloadTile",o,l.bind(this))}else r.actor=this.dispatcher.getActor(),r.request=r.actor.send("loadTile",o,l.bind(this),void 0,!0);function l(u,h){return r.aborted?e(null):u&&u.status!==404?e(u):(h&&(h.resourceTiming&&(r.resourceTiming=h.resourceTiming),this.map._refreshExpiredTiles&&r.setExpiryData(h),r.buckets={...r.buckets,...h.buckets}),r.state="loaded",void e(null))}}serialize(){return ze({},this._options)}},canvas:class extends Vc{constructor(r,e,i,o){super(r,e,i,o),e.coordinates?Array.isArray(e.coordinates)&&e.coordinates.length===4&&!e.coordinates.some(l=>!Array.isArray(l)||l.length!==2||l.some(u=>typeof u!="number"))||this.fire(new ar(new nr(`sources.${r}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new ar(new nr(`sources.${r}`,null,'missing required property "coordinates"'))),e.animate&&typeof e.animate!="boolean"&&this.fire(new ar(new nr(`sources.${r}`,null,'optional "animate" property must be a boolean value'))),e.canvas?typeof e.canvas=="string"||e.canvas instanceof g.HTMLCanvasElement||this.fire(new ar(new nr(`sources.${r}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new ar(new nr(`sources.${r}`,null,'missing required property "canvas"'))),this.options=e,this.animate=e.animate===void 0||e.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof g.HTMLCanvasElement?this.options.canvas:g.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new ar(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(r){this.map=r,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let r=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,r=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,r=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const e=this.map.painter.context;this.texture?!r&&!this._playing||this.texture instanceof J1||this.texture.update(this.canvas,{premultiply:!0}):this.texture=new Ia(e,this.canvas,e.gl.RGBA,{premultiply:!0}),this._prepareData(e)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const r of[this.canvas.width,this.canvas.height])if(isNaN(r)||r<=0)return!0;return!1}},custom:class extends Ln{constructor(r,e,i,o){super(),this.id=r,this.type="custom",this._dataType="raster",this._dispatcher=i,this._implementation=e,this.setEventedParent(o),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new ar(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new ar(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new fy(this._implementation.bounds,this.minzoom,this.maxzoom)),e.update=this._update.bind(this),e.clearTiles=this._clearTiles.bind(this),e.coveringTiles=this._coveringTiles.bind(this),ze(this,oe(e,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return oe(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new _t("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new _t("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(r){this._map=r,this._loaded=!1,this.fire(new _t("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(r),this.load()}onRemove(r){this._implementation.onRemove&&this._implementation.onRemove(r)}hasTile(r){if(this._implementation.hasTile){const{x:e,y:i,z:o}=r.canonical;return this._implementation.hasTile({x:e,y:i,z:o})}return!this.tileBounds||this.tileBounds.contains(r.canonical)}loadTile(r,e){const{x:i,y:o,z:l}=r.tileID.canonical,u=new g.AbortController;r.request=Promise.resolve(this._implementation.loadTile({x:i,y:o,z:l},{signal:u.signal})).then((function(h){return delete r.request,r.aborted?(r.state="unloaded",e(null)):h===void 0?(r.state="errored",e(null)):h===null?(this.loadTileData(r,{width:this.tileSize,height:this.tileSize,data:null}),r.state="loaded",e(null)):function(m){return m instanceof g.ImageData||m instanceof g.HTMLCanvasElement||m instanceof g.ImageBitmap||m instanceof g.HTMLImageElement}(h)?(this.loadTileData(r,h),r.state="loaded",void e(null)):(r.state="errored",e(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)))}).bind(this)).catch(h=>{h.code!==20&&(r.state="errored",e(h))}),r.request.cancel=()=>u.abort()}loadTileData(r,e){Cg.loadTileData(r,e,this._map.painter)}unloadTileData(r){Cg.unloadTileData(r,this._map.painter)}unloadTile(r,e){if(this.unloadTileData(r),this._implementation.unloadTile){const{x:i,y:o,z:l}=r.tileID.canonical;this._implementation.unloadTile({x:i,y:o,z:l})}e()}abortTile(r,e){r.request&&r.request.cancel&&(r.request.cancel(),delete r.request),e()}hasTransition(){return!1}_coveringTiles(){return this._map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(r=>({x:r.canonical.x,y:r.canonical.y,z:r.canonical.z}))}_clearTiles(){const r=To(this.id,this.scope);this._map.style.clearSource(r)}_update(){this.fire(new _t("data",{dataType:"source",sourceDataType:"content"}))}}},dT=function(r,e,i,o){const l=new hT[e.type](r,e,i,o);if(l.id!==r)throw new Error(`Expected Source id to be ${r} instead of ${l.id}`);return ae(["load","abort","unload","serialize","prepare"],l),l};function VG(r,e){const i=dt.identity([]);return dt.scale(i,i,[.5*r.width,.5*-r.height,1]),dt.translate(i,i,[1,-1,0]),dt.multiply(i,i,r.calculateProjMatrix(e.toUnwrapped())),Float32Array.from(i)}function jG(r,e,i,o,l,u,h,m=!1){const _=r.tilesIn(o,h,m);_.sort(eO);const v=[];for(const w of _)v.push({wrappedTileID:w.tile.tileID.wrapped().key,queryResults:w.tile.queryRenderedFeatures(e,i,r._state,w,l,u,VG(r.transform,w.tile.tileID),m)});const x=function(w){const C={},k={};for(const P of w){const R=P.queryResults,z=P.wrappedTileID,B=k[z]=k[z]||{};for(const H in R){const Z=R[H],Y=B[H]=B[H]||{},q=C[H]=C[H]||[];for(const ee of Z)Y[ee.featureIndex]||(Y[ee.featureIndex]=!0,q.push(ee))}}return C}(v);for(const w in x)x[w].forEach(C=>{const k=C.feature,P=k.layer;P&&P.type!=="background"&&P.type!=="sky"&&P.type!=="slot"&&(k.source=P.source,P["source-layer"]&&(k.sourceLayer=P["source-layer"]),k.state=k.id!==void 0?r.getFeatureState(P["source-layer"],k.id):{})});return x}function WG(r,e){const i=r.getRenderableIds().map(u=>r.getTileByID(u)),o=[],l={};for(let u=0;u<i.length;u++){const h=i[u],m=h.tileID.canonical.key;l[m]||(l[m]=!0,h.querySourceFeatures(o,e))}return o}function eO(r,e){const i=r.tileID,o=e.tileID;return i.overscaledZ-o.overscaledZ||i.canonical.y-o.canonical.y||i.wrap-o.wrap||i.canonical.x-o.canonical.x}class HG{constructor(e){this.style=e}processLayersChanged(){this.layers=[];for(const e in this.style._mergedLayers){const i=this.style._mergedLayers[e];if(i.type==="fill-extrusion")this.layers.push(i);else if(i.type==="model"){const o=this.style.getLayerSource(i);o&&o.type==="batched-model"&&this.layers.push(i)}}}updateZOffset(e,i){this.currentBuildingBuckets=[];for(let l=0;l<this.layers.length;++l){const u=this.layers[l],h=this.style.getLayerSourceCache(u);let m=1;u.type==="fill-extrusion"&&(m=u.paint.get("fill-extrusion-opacity")>0?u.paint.get("fill-extrusion-vertical-scale"):0);let _=h?h.getTile(i):null;if(!_&&h&&i.canonical.z>h.getSource().minzoom){let v=i.scaledTo(Math.min(h.getSource().maxzoom,i.overscaledZ-1));for(;v.overscaledZ>=h.getSource().minzoom&&(_=h.getTile(v),!_&&v.overscaledZ!==0);)v=v.scaledTo(v.overscaledZ-1)}this.currentBuildingBuckets.push({bucket:_?_.getBucket(u):null,tileID:_?_.tileID:i,verticalScale:m})}e.hasAnyZOffset=!1;let o=!1;for(let l=0;l<e.symbolInstances.length;l++){const u=e.symbolInstances.get(l),h=u.zOffset,m=this._getHeightAtTileOffset(i,u.tileAnchorX,u.tileAnchorY);u.zOffset=m!==-1?m:h,o||h===u.zOffset||(o=!0),e.hasAnyZOffset||u.zOffset===0||(e.hasAnyZOffset=!0)}o&&(e.zOffsetBuffersNeedUpload=!0,e.zOffsetSortDirty=!0)}_mapCoordToOverlappingTile(e,i,o,l){let u=i,h=o;if(e.canonical.z!==l.canonical.z){const m=l.canonical,_=1/(1<<e.canonical.z-m.z);u=(i+e.canonical.x*Et)*_-m.x*Et|0,h=(o+e.canonical.y*Et)*_-m.y*Et|0}return{tileX:u,tileY:h}}_getHeightAtTileOffset(e,i,o){let l;for(let u=0;u<this.layers.length;++u){if(this.layers[u].type!=="fill-extrusion")continue;const{bucket:h,tileID:m,verticalScale:_}=this.currentBuildingBuckets[u];if(!h)continue;const{tileX:v,tileY:x}=this._mapCoordToOverlappingTile(e,i,o,m),w=h.getHeightAtTileCoord(v,x);if(w&&w.height!==void 0){if(!w.hidden)return w.height*_;l=w.height}}for(let u=0;u<this.layers.length;++u){if(this.layers[u].type!=="model")continue;const{bucket:h,tileID:m}=this.currentBuildingBuckets[u];if(!h)continue;const{tileX:_,tileY:v}=this._mapCoordToOverlappingTile(e,i,o,m),x=h.getHeightAtTileCoord(_,v);if(x&&!x.hidden)return x.height===void 0&&l!==void 0?Math.min(x.maxHeight,l)*x.verticalScale:(x.height||0)*x.verticalScale}return-1}}var tO=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function GG(r,e){const i={};for(const o in r)o!=="ref"&&(i[o]=r[o]);return tO.forEach(o=>{o in e&&(i[o]=e[o])}),i}function rO(r){r=r.slice();const e=Object.create(null);for(let i=0;i<r.length;i++)e[r[i].id]=r[i];for(let i=0;i<r.length;i++)"ref"in r[i]&&(r[i]=GG(r[i],e[r[i].ref]));return r}const Gn={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setSlot:"setSlot",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setCamera:"setCamera",setLights:"setLights",setProjection:"setProjection",addImport:"addImport",removeImport:"removeImport",setImportUrl:"setImportUrl",setImportData:"setImportData",setImportConfig:"setImportConfig"};function nO(r,e,i){i.push({command:Gn.addSource,args:[r,e[r]]})}function iO(r,e,i){e.push({command:Gn.removeSource,args:[r]}),i[r]=!0}function qG(r,e,i,o){iO(r,i,o),nO(r,e,i)}function XG(r,e,i){let o;for(o in r[i])if(r[i].hasOwnProperty(o)&&o!=="data"&&!te(r[i][o],e[i][o]))return!1;for(o in e[i])if(e[i].hasOwnProperty(o)&&o!=="data"&&!te(r[i][o],e[i][o]))return!1;return!0}function dy(r,e,i,o,l,u){let h;for(h in e=e||{},r=r||{})r.hasOwnProperty(h)&&(te(r[h],e[h])||i.push({command:u,args:[o,h,e[h],l]}));for(h in e)e.hasOwnProperty(h)&&!r.hasOwnProperty(h)&&(te(r[h],e[h])||i.push({command:u,args:[o,h,e[h],l]}))}function py(r){return r.id}function my(r,e){return r[e.id]=e,r}class ZG{constructor(e,i){this.reset(e,i)}reset(e,i){this.points=e||[],this._distances=[0];for(let o=1;o<this.points.length;o++)this._distances[o]=this._distances[o-1]+this.points[o].dist(this.points[o-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(i||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(e){if(this.points.length===1)return this.points[0];e=Oe(e,0,1);let i=1,o=this._distances[i];const l=e*this.paddedLength+this.padding;for(;o<l&&i<this._distances.length;)o=this._distances[++i];const u=i-1,h=this._distances[u],m=o-h,_=m>0?(l-h)/m:0;return this.points[u].mult(1-_).add(this.points[i].mult(_))}}class aO{constructor(e,i,o){const l=this.boxCells=[],u=this.circleCells=[];this.xCellCount=Math.ceil(e/o),this.yCellCount=Math.ceil(i/o);for(let h=0;h<this.xCellCount*this.yCellCount;h++)l.push([]),u.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=e,this.height=i,this.xScale=this.xCellCount/e,this.yScale=this.yCellCount/i,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(e,i,o,l,u){this._forEachCell(i,o,l,u,this._insertBoxCell,this.boxUid++),this.boxKeys.push(e),this.bboxes.push(i),this.bboxes.push(o),this.bboxes.push(l),this.bboxes.push(u)}insertCircle(e,i,o,l){this._forEachCell(i-l,o-l,i+l,o+l,this._insertCircleCell,this.circleUid++),this.circleKeys.push(e),this.circles.push(i),this.circles.push(o),this.circles.push(l)}_insertBoxCell(e,i,o,l,u,h){this.boxCells[u].push(h)}_insertCircleCell(e,i,o,l,u,h){this.circleCells[u].push(h)}_query(e,i,o,l,u,h){if(o<0||e>this.width||l<0||i>this.height)return!u&&[];const m=[];if(e<=0&&i<=0&&this.width<=o&&this.height<=l){if(u)return!0;for(let _=0;_<this.boxKeys.length;_++)m.push({key:this.boxKeys[_],x1:this.bboxes[4*_],y1:this.bboxes[4*_+1],x2:this.bboxes[4*_+2],y2:this.bboxes[4*_+3]});for(let _=0;_<this.circleKeys.length;_++){const v=this.circles[3*_],x=this.circles[3*_+1],w=this.circles[3*_+2];m.push({key:this.circleKeys[_],x1:v-w,y1:x-w,x2:v+w,y2:x+w})}return h?m.filter(h):m}return this._forEachCell(e,i,o,l,this._queryCell,m,{hitTest:u,seenUids:{box:{},circle:{}}},h),u?m.length>0:m}_queryCircle(e,i,o,l,u){const h=e-o,m=e+o,_=i-o,v=i+o;if(m<0||h>this.width||v<0||_>this.height)return!l&&[];const x=[];return this._forEachCell(h,_,m,v,this._queryCellCircle,x,{hitTest:l,circle:{x:e,y:i,radius:o},seenUids:{box:{},circle:{}}},u),l?x.length>0:x}query(e,i,o,l,u){return this._query(e,i,o,l,!1,u)}hitTest(e,i,o,l,u){return this._query(e,i,o,l,!0,u)}hitTestCircle(e,i,o,l){return this._queryCircle(e,i,o,!0,l)}_queryCell(e,i,o,l,u,h,m,_){const v=m.seenUids,x=this.boxCells[u];if(x!==null){const C=this.bboxes;for(const k of x)if(!v.box[k]){v.box[k]=!0;const P=4*k;if(e<=C[P+2]&&i<=C[P+3]&&o>=C[P+0]&&l>=C[P+1]&&(!_||_(this.boxKeys[k]))){if(m.hitTest)return h.push(!0),!0;h.push({key:this.boxKeys[k],x1:C[P],y1:C[P+1],x2:C[P+2],y2:C[P+3]})}}}const w=this.circleCells[u];if(w!==null){const C=this.circles;for(const k of w)if(!v.circle[k]){v.circle[k]=!0;const P=3*k;if(this._circleAndRectCollide(C[P],C[P+1],C[P+2],e,i,o,l)&&(!_||_(this.circleKeys[k]))){if(m.hitTest)return h.push(!0),!0;{const R=C[P],z=C[P+1],B=C[P+2];h.push({key:this.circleKeys[k],x1:R-B,y1:z-B,x2:R+B,y2:z+B})}}}}}_queryCellCircle(e,i,o,l,u,h,m,_){const v=m.circle,x=m.seenUids,w=this.boxCells[u];if(w!==null){const k=this.bboxes;for(const P of w)if(!x.box[P]){x.box[P]=!0;const R=4*P;if(this._circleAndRectCollide(v.x,v.y,v.radius,k[R+0],k[R+1],k[R+2],k[R+3])&&(!_||_(this.boxKeys[P])))return h.push(!0),!0}}const C=this.circleCells[u];if(C!==null){const k=this.circles;for(const P of C)if(!x.circle[P]){x.circle[P]=!0;const R=3*P;if(this._circlesCollide(k[R],k[R+1],k[R+2],v.x,v.y,v.radius)&&(!_||_(this.circleKeys[P])))return h.push(!0),!0}}}_forEachCell(e,i,o,l,u,h,m,_){const v=this._convertToXCellCoord(e),x=this._convertToYCellCoord(i),w=this._convertToXCellCoord(o),C=this._convertToYCellCoord(l);for(let k=v;k<=w;k++)for(let P=x;P<=C;P++)if(u.call(this,e,i,o,l,this.xCellCount*P+k,h,m,_))return}_convertToXCellCoord(e){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(e*this.xScale)))}_convertToYCellCoord(e){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(e*this.yScale)))}_circlesCollide(e,i,o,l,u,h){const m=l-e,_=u-i,v=o+h;return v*v>m*m+_*_}_circleAndRectCollide(e,i,o,l,u,h,m){const _=(h-l)/2,v=Math.abs(e-(l+_));if(v>_+o)return!1;const x=(m-u)/2,w=Math.abs(i-(u+x));if(w>x+o)return!1;if(v<=_||w<=x)return!0;const C=v-_,k=w-x;return C*C+k*k<=o*o}}const jc=100;class KG{constructor(e,i,o=new aO(e.width+200,e.height+200,25),l=new aO(e.width+200,e.height+200,25)){this.transform=e,this.grid=o,this.ignoredGrid=l,this.pitchfactor=Math.cos(e._pitch)*e.cameraToCenterDistance,this.screenRightBoundary=e.width+jc,this.screenBottomBoundary=e.height+jc,this.gridRightBoundary=e.width+200,this.gridBottomBoundary=e.height+200,this.fogState=i}placeCollisionBox(e,i,o,l,u,h,m,_){let v=o.projectedAnchorX,x=o.projectedAnchorY,w=o.projectedAnchorZ;const C=o.elevation,k=o.tileID,P=e.getProjection();if(C&&k){const[ee,ce,de]=P.upVector(k.canonical,o.tileAnchorX,o.tileAnchorY),ge=P.upVectorScale(k.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;v+=ee*C*ge,x+=ce*C*ge,w+=de*C*ge}const R=this.projectAndGetPerspectiveRatio(m,v,x,w,o.tileID,P.name==="globe"||!!C||this.transform.pitch>0,P),z=h*R.perspectiveRatio,B=(o.x1*i+l.x-o.padding)*z+R.point.x,H=(o.y1*i+l.y-o.padding)*z+R.point.y,Z=(o.x2*i+l.x+o.padding)*z+R.point.x,Y=(o.y2*i+l.y+o.padding)*z+R.point.y,q=R.perspectiveRatio<=.55||R.occluded;return!this.isInsideGrid(B,H,Z,Y)||!u&&this.grid.hitTest(B,H,Z,Y,_)||q?{box:[],offscreen:!1,occluded:R.occluded}:{box:[B,H,Z,Y],offscreen:this.isOffscreen(B,H,Z,Y),occluded:!1}}placeCollisionCircles(e,i,o,l,u,h,m,_,v,x,w,C,k,P,R){const z=[],B=this.transform.elevation,H=e.getProjection(),Z=B?B.getAtTileOffsetFunc(R,this.transform.center.lat,this.transform.worldSize,H):null,Y=new D(o.tileAnchorX,o.tileAnchorY);let{x:q,y:ee,z:ce}=H.projectTilePoint(Y.x,Y.y,R.canonical);if(Z){const[ft,Je,tt]=Z(Y);q+=ft,ee+=Je,ce+=tt}const de=H.name==="globe",ge=this.projectAndGetPerspectiveRatio(m,q,ee,ce,R,de||!!B||this.transform.pitch>0,H),{perspectiveRatio:ve}=ge,Re=(w?h/ve:h*ve)/Ua,ke=Yl(q,ee,ce,_),$e=ge.signedDistanceFromCamera>0?BF(Re,u,o.lineOffsetX*Re,o.lineOffsetY*Re,!1,ke,Y,o,l,_,{},B&&!w?Z:null,w&&!!B,H,R,w):null;let Ie=!1,Qe=!1,st=!0;if($e&&!ge.occluded){const ft=.5*k*ve+P,Je=new D(-100,-100),tt=new D(this.screenRightBoundary,this.screenBottomBoundary),pt=new ZG,{first:bt,last:St}=$e,Pt=bt.path.length;let Ut=[];for(let tr=Pt-1;tr>=1;tr--)Ut.push(bt.path[tr]);for(let tr=1;tr<St.path.length;tr++)Ut.push(St.path[tr]);const Tt=2.5*ft;v&&(Ut=Ut.map(([tr,ur,cr],hr)=>(Z&&!de&&(cr=Z(hr<Pt-1?bt.tilePath[Pt-1-hr]:St.tilePath[hr-Pt+2])[2]),Yl(tr,ur,cr,v))),Ut.some(tr=>tr[3]<=0)&&(Ut=[]));let Mt=[];if(Ut.length>0){let tr=1/0,ur=-1/0,cr=1/0,hr=-1/0;for(const Mr of Ut)tr=Math.min(tr,Mr[0]),cr=Math.min(cr,Mr[1]),ur=Math.max(ur,Mr[0]),hr=Math.max(hr,Mr[1]);ur>=Je.x&&tr<=tt.x&&hr>=Je.y&&cr<=tt.y&&(Mt=[Ut.map(Mr=>new D(Mr[0],Mr[1]))],(tr<Je.x||ur>tt.x||cr<Je.y||hr>tt.y)&&(Mt=sF(Mt,Je.x,Je.y,tt.x,tt.y)))}for(const tr of Mt){pt.reset(tr,.25*ft);let ur=0;ur=pt.length<=.5*ft?1:Math.ceil(pt.paddedLength/Tt)+1;for(let cr=0;cr<ur;cr++){const hr=cr/Math.max(ur-1,1),Mr=pt.lerp(hr),jr=Mr.x+jc,gn=Mr.y+jc;z.push(jr,gn,ft,0);const Bn=jr-ft,on=gn-ft,Qr=jr+ft,Vr=gn+ft;if(st=st&&this.isOffscreen(Bn,on,Qr,Vr),Qe=Qe||this.isInsideGrid(Bn,on,Qr,Vr),!i&&this.grid.hitTestCircle(jr,gn,ft,C)&&(Ie=!0,!x))return{circles:[],offscreen:!1,collisionDetected:Ie,occluded:!1}}}}return{circles:!x&&Ie||!Qe?[]:z,offscreen:st,collisionDetected:Ie,occluded:ge.occluded}}queryRenderedSymbols(e){if(e.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const i=[];let o=1/0,l=1/0,u=-1/0,h=-1/0;for(const x of e){const w=new D(x.x+jc,x.y+jc);o=Math.min(o,w.x),l=Math.min(l,w.y),u=Math.max(u,w.x),h=Math.max(h,w.y),i.push(w)}const m=this.grid.query(o,l,u,h).concat(this.ignoredGrid.query(o,l,u,h)),_={},v={};for(const x of m){const w=x.key;_[w.bucketInstanceId]===void 0&&(_[w.bucketInstanceId]={}),_[w.bucketInstanceId][w.featureIndex]||cM(i,[new D(x.x1,x.y1),new D(x.x2,x.y1),new D(x.x2,x.y2),new D(x.x1,x.y2)])&&(_[w.bucketInstanceId][w.featureIndex]=!0,v[w.bucketInstanceId]===void 0&&(v[w.bucketInstanceId]=[]),v[w.bucketInstanceId].push(w.featureIndex))}return v}insertCollisionBox(e,i,o,l,u){(i?this.ignoredGrid:this.grid).insert({bucketInstanceId:o,featureIndex:l,collisionGroupID:u},e[0],e[1],e[2],e[3])}insertCollisionCircles(e,i,o,l,u){const h=i?this.ignoredGrid:this.grid,m={bucketInstanceId:o,featureIndex:l,collisionGroupID:u};for(let _=0;_<e.length;_+=4)h.insertCircle(m,e[_],e[_+1],e[_+2])}projectAndGetPerspectiveRatio(e,i,o,l,u,h,m){const _=[i,o,l,1];let v=!1;l||this.transform.pitch>0?(li.transformMat4(_,_,e),this.fogState&&u&&m.name!=="globe"&&(v=function(C,k,P,R,z,B){const H=B.calculateFogTileMatrix(z),Z=[k,P,R];return We.transformMat4(Z,Z,H),uy(C,We.length(Z),B.pitch,B._fov)}(this.fogState,i,o,l,u.toUnwrapped(),this.transform)>.9)):VF(_,_,e);const x=_[3];return{point:new D((_[0]/x+1)/2*this.transform.width+jc,(-_[1]/x+1)/2*this.transform.height+jc),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(m)/x*.5,1.5),signedDistanceFromCamera:x,occluded:h&&_[2]>x||v}}isOffscreen(e,i,o,l){return o<jc||e>=this.screenRightBoundary||l<jc||i>this.screenBottomBoundary}isInsideGrid(e,i,o,l){return o>=0&&e<this.gridRightBoundary&&l>=0&&i<this.gridBottomBoundary}getViewportMatrix(){const e=dt.identity([]);return dt.translate(e,e,[-100,-100,0]),e}}function pT(r,e,i){const o=e.createTileMatrix(r,r.worldSize,i.toUnwrapped());return dt.multiply(new Float32Array(16),r.projMatrix,o)}function YG(r,e,i){if(e.projection.name===i.projection.name)return r.projMatrix;const o=i.clone();return o.setProjection(e.projection),pT(o,e.getProjection(),r)}function mT(r,e,i){return e.name===i.projection.name?r.projMatrix:pT(i,e,r)}class oO{constructor(e,i,o,l){this.opacity=e?Math.max(0,Math.min(1,e.opacity+(e.placed?i:-i))):l&&o?1:0,this.placed=o}isHidden(){return this.opacity===0&&!this.placed}}class Ig{constructor(e,i,o,l,u,h=!1){this.text=new oO(e?e.text:null,i,o,u),this.icon=new oO(e?e.icon:null,i,l,u),this.clipped=h}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class gT{constructor(e,i,o,l=!1){this.text=e,this.icon=i,this.skipFade=o,this.clipped=l}}class JG{constructor(){this.invProjMatrix=dt.create(),this.viewportMatrix=dt.create(),this.circles=[]}}class QG{constructor(e,i,o,l,u){this.bucketInstanceId=e,this.featureIndex=i,this.sourceLayerIndex=o,this.bucketIndex=l,this.tileID=u}}class eq{constructor(e){this.crossSourceCollisions=e,this.maxGroupID=0,this.collisionGroups={}}get(e){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[e]){const i=++this.maxGroupID;this.collisionGroups[e]={ID:i,predicate:o=>o.collisionGroupID===i}}return this.collisionGroups[e]}}function sO(r,e,i,o,l){const{horizontalAlign:u,verticalAlign:h}=B1(r),m=-(u-.5)*e,_=-(h-.5)*i,v=OE(r,o);return new D(m+v[0]*l,_+v[1]*l)}function _T(r,e,i,o,l){const u=new D(r,e);return i&&u._rotate(o?l:-l),u}class tq{constructor(e,i,o,l,u,h){this.transform=e.clone(),this.projection=e.projection.name,this.collisionIndex=new KG(this.transform,u),this.buildingIndex=h,this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=i,this.retainedQueryData={},this.collisionGroups=new eq(o),this.collisionCircleArrays={},this.prevPlacement=l,l&&(l.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(e,i,o,l){const u=o.getBucket(i),h=o.latestFeatureIndex;if(!u||!h||i.fqid!==u.layerIds[0])return;const m=u.layers[0].layout,_=o.collisionBoxArray,v=Math.pow(2,this.transform.zoom-o.tileID.overscaledZ),x=o.tileSize/Et,w=o.tileID.toUnwrapped();this.transform.setProjection(u.projection);const C=(k=o.tileID,P=u.getProjection(),R=this.transform,P.name===this.projection?R.calculateProjMatrix(k.toUnwrapped()):pT(R,P,k));var k,P,R;const z=m.get("text-pitch-alignment")==="map",B=m.get("text-rotation-alignment")==="map";i.compileFilter();const H=i.dynamicFilter(),Z=i.dynamicFilterNeedsFeature(),Y=this.transform.calculatePixelsToTileUnitsMatrix(o),q=RF(C,o.tileID.canonical,z,B,this.transform,u.getProjection(),Y);let ee=null;if(z){const ge=LF(C,o.tileID.canonical,z,B,this.transform,u.getProjection(),Y);ee=dt.multiply([],this.transform.labelPlaneMatrix,ge)}let ce=null;H&&o.latestFeatureIndex&&(ce={unwrappedTileID:w,dynamicFilter:H,dynamicFilterNeedsFeature:Z,featureIndex:o.latestFeatureIndex}),this.retainedQueryData[u.bucketInstanceId]=new QG(u.bucketInstanceId,h,u.sourceLayerIndex,u.index,o.tileID);const de={bucket:u,layout:m,posMatrix:C,textLabelPlaneMatrix:q,labelToScreenMatrix:ee,clippingData:ce,scale:v,textPixelRatio:x,holdingForFade:o.holdingForFade(),collisionBoxArray:_,partiallyEvaluatedTextSize:zc(u.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:zc(u.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(u.sourceID)};if(l)for(const ge of u.sortKeyRanges){const{sortKey:ve,symbolInstanceStart:Re,symbolInstanceEnd:ke}=ge;e.push({sortKey:ve,symbolInstanceStart:Re,symbolInstanceEnd:ke,parameters:de})}else e.push({symbolInstanceStart:0,symbolInstanceEnd:u.symbolInstances.length,parameters:de})}attemptAnchorPlacement(e,i,o,l,u,h,m,_,v,x,w,C,k,P,R,z,B,H){const{textOffset0:Z,textOffset1:Y,crossTileID:q}=C,ee=[Z,Y],ce=sO(e,o,l,ee,u),de=this.collisionIndex.placeCollisionBox(P,u,i,_T(ce.x,ce.y,h,m,this.transform.angle),w,_,v,x.predicate);if(z){const ge=P.getSymbolInstanceIconSize(H,this.transform.zoom,C.placedIconSymbolIndex);if(this.collisionIndex.placeCollisionBox(P,ge,z,_T(ce.x,ce.y,h,m,this.transform.angle),w,_,v,x.predicate).box.length===0)return}if(de.box.length>0){let ge;return this.prevPlacement&&this.prevPlacement.variableOffsets[q]&&this.prevPlacement.placements[q]&&this.prevPlacement.placements[q].text&&(ge=this.prevPlacement.variableOffsets[q].anchor),this.variableOffsets[q]={textOffset:ee,width:o,height:l,anchor:e,textScale:u,prevAnchor:ge},this.markUsedJustification(P,e,C,R),P.allowVerticalPlacement&&(this.markUsedOrientation(P,R,C),this.placedOrientations[q]=R),{shift:ce,placedGlyphBoxes:de}}}placeLayerBucketPart(e,i,o,l){const{bucket:u,layout:h,posMatrix:m,textLabelPlaneMatrix:_,labelToScreenMatrix:v,clippingData:x,textPixelRatio:w,holdingForFade:C,collisionBoxArray:k,partiallyEvaluatedTextSize:P,partiallyEvaluatedIconSize:R,collisionGroup:z}=e.parameters,B=h.get("text-optional"),H=h.get("icon-optional"),Z=h.get("text-allow-overlap"),Y=h.get("icon-allow-overlap"),q=h.get("text-rotation-alignment")==="map",ee=h.get("text-pitch-alignment")==="map",ce=h.get("symbol-z-order")==="viewport-y",de=h.get("symbol-z-elevate");this.transform.setProjection(u.projection);let ge=Z&&(Y||!u.hasIconData()||H),ve=Y&&(Z||!u.hasTextData()||B);!u.collisionArrays&&k&&u.deserializeCollisionBoxes(k),o&&l&&u.updateCollisionDebugBuffers(this.transform.zoom,k);const Re=(ke,$e,Ie)=>{const{crossTileID:Qe,numVerticalGlyphVertices:st}=ke;if(x){const Qr={zoom:this.transform.zoom,pitch:this.transform.pitch};let Vr=null;if(x.dynamicFilterNeedsFeature){const Dr=this.retainedQueryData[u.bucketInstanceId];Vr=x.featureIndex.loadFeature({featureIndex:ke.featureIndex,bucketIndex:Dr.bucketIndex,sourceLayerIndex:Dr.sourceLayerIndex,layoutVertexArrayOffset:0})}if(!(0,x.dynamicFilter)(Qr,Vr,this.retainedQueryData[u.bucketInstanceId].tileID.canonical,new D(ke.tileAnchorX,ke.tileAnchorY),this.transform.calculateDistanceTileData(x.unwrappedTileID)))return this.placements[Qe]=new gT(!1,!1,!1,!0),void i.add(Qe)}if(i.has(Qe))return;if(C)return void(this.placements[Qe]=new gT(!1,!1,!1));let ft=!1,Je=!1,tt=!0,pt=!1,bt=!1,St=null,Pt={box:null,offscreen:null,occluded:null},Ut={box:null,offscreen:null,occluded:null},Tt=null,Mt=null,tr=null,ur=0,cr=0,hr=0;Ie.textFeatureIndex?ur=Ie.textFeatureIndex:ke.useRuntimeCollisionCircles&&(ur=ke.featureIndex),Ie.verticalTextFeatureIndex&&(cr=Ie.verticalTextFeatureIndex);const Mr=Qr=>{Qr.tileID=this.retainedQueryData[u.bucketInstanceId].tileID;const Vr=this.transform.elevation;Qr.elevation=ke.zOffset+(Vr?Vr.getAtTileOffset(Qr.tileID,Qr.tileAnchorX,Qr.tileAnchorY):0)},jr=Ie.textBox;if(jr){Mr(jr);const Qr=Dr=>{let In=zi.horizontal;if(u.allowVerticalPlacement&&!Dr&&this.prevPlacement){const Un=this.prevPlacement.placedOrientations[Qe];Un&&(this.placedOrientations[Qe]=Un,In=Un,this.markUsedOrientation(u,In,ke))}return In},Vr=(Dr,In)=>{if(u.allowVerticalPlacement&&st>0&&Ie.verticalTextBox){for(const Un of u.writingModes)if(Un===zi.vertical?(Pt=In(),Ut=Pt):Pt=Dr(),Pt&&Pt.box&&Pt.box.length)break}else Pt=Dr()};if(h.get("text-variable-anchor")){let Dr=h.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[Qe]){const dn=this.prevPlacement.variableOffsets[Qe];Dr.indexOf(dn.anchor)>0&&(Dr=Dr.filter(gi=>gi!==dn.anchor),Dr.unshift(dn.anchor))}const In=(dn,gi,Ni)=>{const Ii=u.getSymbolInstanceTextSize(P,ke,this.transform.zoom,$e),Ti=(dn.x2-dn.x1)*Ii+2*dn.padding,ba=(dn.y2-dn.y1)*Ii+2*dn.padding,Ui=ke.hasIconTextFit&&!Y?gi:null;Ui&&Mr(Ui);let ra={box:[],offscreen:!1,occluded:!1};const _i=Z?2*Dr.length:Dr.length;for(let Po=0;Po<_i;++Po){const Hc=this.attemptAnchorPlacement(Dr[Po%Dr.length],dn,Ti,ba,Ii,q,ee,w,m,z,Po>=Dr.length,ke,$e,u,Ni,Ui,P,R);if(Hc&&(ra=Hc.placedGlyphBoxes,ra&&ra.box&&ra.box.length)){ft=!0,St=Hc.shift;break}}return ra};Vr(()=>In(jr,Ie.iconBox,zi.horizontal),()=>{const dn=Ie.verticalTextBox;return dn&&Mr(dn),u.allowVerticalPlacement&&!(Pt&&Pt.box&&Pt.box.length)&&st>0&&dn?In(dn,Ie.verticalIconBox,zi.vertical):{box:null,offscreen:null,occluded:null}}),Pt&&(ft=Pt.box,tt=Pt.offscreen,pt=Pt.occluded);const Un=Qr(!(!Pt||!Pt.box));if(!ft&&this.prevPlacement){const dn=this.prevPlacement.variableOffsets[Qe];dn&&(this.variableOffsets[Qe]=dn,this.markUsedJustification(u,dn.anchor,ke,Un))}}else{const Dr=(In,Un)=>{const dn=u.getSymbolInstanceTextSize(P,ke,this.transform.zoom,$e),gi=this.collisionIndex.placeCollisionBox(u,dn,In,new D(0,0),Z,w,m,z.predicate);return gi&&gi.box&&gi.box.length&&(this.markUsedOrientation(u,Un,ke),this.placedOrientations[Qe]=Un),gi};Vr(()=>Dr(jr,zi.horizontal),()=>{const In=Ie.verticalTextBox;return u.allowVerticalPlacement&&st>0&&In?(Mr(In),Dr(In,zi.vertical)):{box:null,offscreen:null,occluded:null}}),Qr(!!(Pt&&Pt.box&&Pt.box.length))}}if(Tt=Pt,ft=Tt&&Tt.box&&Tt.box.length>0,tt=Tt&&Tt.offscreen,pt=Tt&&Tt.occluded,ke.useRuntimeCollisionCircles){const Qr=u.text.placedSymbolArray.get(ke.centerJustifiedTextSymbolIndex>=0?ke.centerJustifiedTextSymbolIndex:ke.verticalPlacedTextSymbolIndex),Vr=og(u.textSizeData,P,Qr),Dr=h.get("text-padding");Mt=this.collisionIndex.placeCollisionCircles(u,Z,Qr,u.lineVertexArray,u.glyphOffsetArray,Vr,m,_,v,o,ee,z.predicate,ke.collisionCircleDiameter*Vr/Ua,Dr,this.retainedQueryData[u.bucketInstanceId].tileID),ft=Z||Mt.circles.length>0&&!Mt.collisionDetected,tt=tt&&Mt.offscreen,pt=Mt.occluded}if(Ie.iconFeatureIndex&&(hr=Ie.iconFeatureIndex),Ie.iconBox){const Qr=Vr=>{Mr(Vr);const Dr=ke.hasIconTextFit&&St?_T(St.x,St.y,q,ee,this.transform.angle):new D(0,0),In=u.getSymbolInstanceIconSize(R,this.transform.zoom,ke.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(u,In,Vr,Dr,Y,w,m,z.predicate)};Ut&&Ut.box&&Ut.box.length&&Ie.verticalIconBox?(tr=Qr(Ie.verticalIconBox),Je=tr.box.length>0):(tr=Qr(Ie.iconBox),Je=tr.box.length>0),tt=tt&&tr.offscreen,bt=tr.occluded}const gn=B||ke.numHorizontalGlyphVertices===0&&st===0,Bn=H||ke.numIconVertices===0;if(gn||Bn?Bn?gn||(Je=Je&&ft):ft=Je&&ft:Je=ft=Je&&ft,ft&&Tt&&Tt.box&&this.collisionIndex.insertCollisionBox(Tt.box,h.get("text-ignore-placement"),u.bucketInstanceId,Ut&&Ut.box&&cr?cr:ur,z.ID),Je&&tr&&this.collisionIndex.insertCollisionBox(tr.box,h.get("icon-ignore-placement"),u.bucketInstanceId,hr,z.ID),Mt&&(ft&&this.collisionIndex.insertCollisionCircles(Mt.circles,h.get("text-ignore-placement"),u.bucketInstanceId,ur,z.ID),o)){const Qr=u.bucketInstanceId;let Vr=this.collisionCircleArrays[Qr];Vr===void 0&&(Vr=this.collisionCircleArrays[Qr]=new JG);for(let Dr=0;Dr<Mt.circles.length;Dr+=4)Vr.circles.push(Mt.circles[Dr+0]),Vr.circles.push(Mt.circles[Dr+1]),Vr.circles.push(Mt.circles[Dr+2]),Vr.circles.push(Mt.collisionDetected?1:0)}const on=u.projection.name!=="globe";ge=ge&&(on||!pt),ve=ve&&(on||!bt),this.placements[Qe]=new gT(ft||ge,Je||ve,tt||u.justReloaded),i.add(Qe)};if(de&&this.buildingIndex&&(this.buildingIndex.updateZOffset(u,this.retainedQueryData[u.bucketInstanceId].tileID),u.updateZOffset()),ce){const ke=u.getSortedSymbolIndexes(this.transform.angle);for(let $e=ke.length-1;$e>=0;--$e){const Ie=ke[$e];Re(u.symbolInstances.get(Ie),Ie,u.collisionArrays[Ie])}u.hasAnyZOffset&&se(`${u.layerIds[0]} layer symbol-z-elevate: symbols are not sorted by elevation if symbol-z-order is evaluated to viewport-y`)}else if(u.hasAnyZOffset){const ke=u.getSortedIndexesByZOffset();for(let $e=0;$e<ke.length;++$e){const Ie=ke[$e];Re(u.symbolInstances.get(Ie),Ie,u.collisionArrays[Ie])}}else for(let ke=e.symbolInstanceStart;ke<e.symbolInstanceEnd;ke++)Re(u.symbolInstances.get(ke),ke,u.collisionArrays[ke]);if(o&&u.bucketInstanceId in this.collisionCircleArrays){const ke=this.collisionCircleArrays[u.bucketInstanceId];dt.invert(ke.invProjMatrix,m),ke.viewportMatrix=this.collisionIndex.getViewportMatrix()}u.justReloaded=!1}markUsedJustification(e,i,o,l){const{leftJustifiedTextSymbolIndex:u,centerJustifiedTextSymbolIndex:h,rightJustifiedTextSymbolIndex:m,verticalPlacedTextSymbolIndex:_,crossTileID:v}=o,x=RE(i),w=l===zi.vertical?_:x==="left"?u:x==="center"?h:x==="right"?m:-1;u>=0&&(e.text.placedSymbolArray.get(u).crossTileID=w>=0&&u!==w?0:v),h>=0&&(e.text.placedSymbolArray.get(h).crossTileID=w>=0&&h!==w?0:v),m>=0&&(e.text.placedSymbolArray.get(m).crossTileID=w>=0&&m!==w?0:v),_>=0&&(e.text.placedSymbolArray.get(_).crossTileID=w>=0&&_!==w?0:v)}markUsedOrientation(e,i,o){const l=i===zi.horizontal||i===zi.horizontalOnly?i:0,u=i===zi.vertical?i:0,{leftJustifiedTextSymbolIndex:h,centerJustifiedTextSymbolIndex:m,rightJustifiedTextSymbolIndex:_,verticalPlacedTextSymbolIndex:v}=o,x=e.text.placedSymbolArray;h>=0&&(x.get(h).placedOrientation=l),m>=0&&(x.get(m).placedOrientation=l),_>=0&&(x.get(_).placedOrientation=l),v>=0&&(x.get(v).placedOrientation=u)}commit(e){this.commitTime=e,this.zoomAtLastRecencyCheck=this.transform.zoom;const i=this.prevPlacement;let o=!1;this.prevZoomAdjustment=i?i.zoomAdjustment(this.transform.zoom):0;const l=i?i.symbolFadeChange(e):1,u=i?i.opacities:{},h=i?i.variableOffsets:{},m=i?i.placedOrientations:{};for(const _ in this.placements){const v=this.placements[_],x=u[_];x?(this.opacities[_]=new Ig(x,l,v.text,v.icon,null,v.clipped),o=o||v.text!==x.text.placed||v.icon!==x.icon.placed):(this.opacities[_]=new Ig(null,l,v.text,v.icon,v.skipFade,v.clipped),o=o||v.text||v.icon)}for(const _ in u){const v=u[_];if(!this.opacities[_]){const x=new Ig(v,l,!1,!1);x.isHidden()||(this.opacities[_]=x,o=o||v.text.placed||v.icon.placed)}}for(const _ in h)this.variableOffsets[_]||!this.opacities[_]||this.opacities[_].isHidden()||(this.variableOffsets[_]=h[_]);for(const _ in m)this.placedOrientations[_]||!this.opacities[_]||this.opacities[_].isHidden()||(this.placedOrientations[_]=m[_]);o?this.lastPlacementChangeTime=e:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=i?i.lastPlacementChangeTime:e)}updateLayerOpacities(e,i){const o=new Set;for(const l of i){const u=l.getBucket(e);u&&l.latestFeatureIndex&&e.fqid===u.layerIds[0]&&(this.updateBucketOpacities(u,o,l.collisionBoxArray),u.layers[0].layout.get("symbol-z-elevate")&&this.buildingIndex&&(this.buildingIndex.updateZOffset(u,l.tileID),u.updateZOffset()))}}updateBucketOpacities(e,i,o){e.hasTextData()&&e.text.opacityVertexArray.clear(),e.hasIconData()&&e.icon.opacityVertexArray.clear(),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexArray.clear(),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexArray.clear();const l=e.layers[0].layout,u=!!e.layers[0].dynamicFilter(),h=new Ig(null,0,!1,!1,!0),m=l.get("text-allow-overlap"),_=l.get("icon-allow-overlap"),v=l.get("text-variable-anchor"),x=l.get("text-rotation-alignment")==="map",w=l.get("text-pitch-alignment")==="map",C=new Ig(null,0,m&&(_||!e.hasIconData()||l.get("icon-optional")),_&&(m||!e.hasTextData()||l.get("text-optional")),!0);!e.collisionArrays&&o&&(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData())&&e.deserializeCollisionBoxes(o);const k=(R,z,B)=>{for(let H=0;H<z/4;H++)R.opacityVertexArray.emplaceBack(B)};let P=0;for(let R=0;R<e.symbolInstances.length;R++){const z=e.symbolInstances.get(R),{numHorizontalGlyphVertices:B,numVerticalGlyphVertices:H,crossTileID:Z,numIconVertices:Y}=z,q=i.has(Z);let ee=this.opacities[Z];q?ee=h:ee||(ee=C,this.opacities[Z]=ee),i.add(Z);const ce=B>0||H>0,de=Y>0,ge=this.placedOrientations[Z],ve=ge===zi.vertical,Re=ge===zi.horizontal||ge===zi.horizontalOnly;if(!ce&&!de||ee.isHidden()||P++,ce){const ke=lO(ee.text);k(e.text,B,ve?_y:ke),k(e.text,H,Re?_y:ke);const $e=ee.text.isHidden(),{leftJustifiedTextSymbolIndex:Ie,centerJustifiedTextSymbolIndex:Qe,rightJustifiedTextSymbolIndex:st,verticalPlacedTextSymbolIndex:ft}=z,Je=e.text.placedSymbolArray,tt=$e||ve?1:0;Ie>=0&&(Je.get(Ie).hidden=tt),Qe>=0&&(Je.get(Qe).hidden=tt),st>=0&&(Je.get(st).hidden=tt),ft>=0&&(Je.get(ft).hidden=$e||Re?1:0);const pt=this.variableOffsets[Z];pt&&this.markUsedJustification(e,pt.anchor,z,ge);const bt=this.placedOrientations[Z];bt&&(this.markUsedJustification(e,"left",z,bt),this.markUsedOrientation(e,bt,z))}if(de){const ke=lO(ee.icon),{placedIconSymbolIndex:$e,verticalPlacedIconSymbolIndex:Ie}=z,Qe=e.icon.placedSymbolArray,st=ee.icon.isHidden()?1:0;$e>=0&&(k(e.icon,Y,ve?_y:ke),Qe.get($e).hidden=st),Ie>=0&&(k(e.icon,z.numVerticalIconVertices,Re?_y:ke),Qe.get(Ie).hidden=st)}if(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData()){const ke=e.collisionArrays[R];if(ke){let $e=new D(0,0),Ie=!0;if(ke.textBox||ke.verticalTextBox){if(v){const st=this.variableOffsets[Z];st?($e=sO(st.anchor,st.width,st.height,st.textOffset,st.textScale),x&&$e._rotate(w?this.transform.angle:-this.transform.angle)):Ie=!1}u&&(Ie=!ee.clipped),ke.textBox&&gy(e.textCollisionBox.collisionVertexArray,ee.text.placed,!Ie||ve,$e.x,$e.y),ke.verticalTextBox&&gy(e.textCollisionBox.collisionVertexArray,ee.text.placed,!Ie||Re,$e.x,$e.y)}const Qe=Ie&&!!(!Re&&ke.verticalIconBox);ke.iconBox&&gy(e.iconCollisionBox.collisionVertexArray,ee.icon.placed,Qe,z.hasIconTextFit?$e.x:0,z.hasIconTextFit?$e.y:0),ke.verticalIconBox&&gy(e.iconCollisionBox.collisionVertexArray,ee.icon.placed,!Qe,z.hasIconTextFit?$e.x:0,z.hasIconTextFit?$e.y:0)}}}if(e.fullyClipped=P===0,e.sortFeatures(this.transform.angle),this.retainedQueryData[e.bucketInstanceId]&&(this.retainedQueryData[e.bucketInstanceId].featureSortOrder=e.featureSortOrder),e.hasTextData()&&e.text.opacityVertexBuffer&&e.text.opacityVertexBuffer.updateData(e.text.opacityVertexArray),e.hasIconData()&&e.icon.opacityVertexBuffer&&e.icon.opacityVertexBuffer.updateData(e.icon.opacityVertexArray),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexBuffer&&e.iconCollisionBox.collisionVertexBuffer.updateData(e.iconCollisionBox.collisionVertexArray),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexBuffer&&e.textCollisionBox.collisionVertexBuffer.updateData(e.textCollisionBox.collisionVertexArray),e.bucketInstanceId in this.collisionCircleArrays){const R=this.collisionCircleArrays[e.bucketInstanceId];e.placementInvProjMatrix=R.invProjMatrix,e.placementViewportMatrix=R.viewportMatrix,e.collisionCircleArray=R.circles,delete this.collisionCircleArrays[e.bucketInstanceId]}}symbolFadeChange(e){return this.fadeDuration===0?1:(e-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(e){return Math.max(0,(this.transform.zoom-e)/1.5)}hasTransitions(e){return this.stale||e-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(e,i){const o=this.zoomAtLastRecencyCheck===i?1-this.zoomAdjustment(i):1;return this.zoomAtLastRecencyCheck=i,this.commitTime+this.fadeDuration*o>e}setStale(){this.stale=!0}}function gy(r,e,i,o,l){r.emplaceBack(e?1:0,i?1:0,o||0,l||0),r.emplaceBack(e?1:0,i?1:0,o||0,l||0),r.emplaceBack(e?1:0,i?1:0,o||0,l||0),r.emplaceBack(e?1:0,i?1:0,o||0,l||0)}const rq=Math.pow(2,25),nq=Math.pow(2,24),iq=Math.pow(2,17),aq=Math.pow(2,16),oq=Math.pow(2,9),sq=Math.pow(2,8),lq=Math.pow(2,1);function lO(r){if(r.opacity===0&&!r.placed)return 0;if(r.opacity===1&&r.placed)return 4294967295;const e=r.placed?1:0,i=Math.floor(127*r.opacity);return i*rq+e*nq+i*iq+e*aq+i*oq+e*sq+i*lq+e}const _y=0;class cq{constructor(e){this._sortAcrossTiles=e.layout.get("symbol-z-order")!=="viewport-y"&&e.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs=new Set,this._bucketParts=[]}continuePlacement(e,i,o,l,u){const h=this._bucketParts;for(;this._currentTileIndex<e.length;)if(i.getBucketParts(h,l,e[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,u())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,h.sort((m,_)=>m.sortKey-_.sortKey));this._currentPartIndex<h.length;){const m=h[this._currentPartIndex];if(i.placeLayerBucketPart(m,this._seenCrossTileIDs,o,m.symbolInstanceStart===0),this._currentPartIndex++,u())return!0}return!1}}class uq{constructor(e,i,o,l,u,h,m,_,v){this.placement=new tq(e,u,h,m,_,v),this._currentPlacementIndex=i.length-1,this._forceFullPlacement=o,this._showCollisionBoxes=l,this._done=!1}isDone(){return this._done}continuePlacement(e,i,o,l){const u=Jr.now(),h=()=>{const m=Jr.now()-u;return!this._forceFullPlacement&&m>2};for(;this._currentPlacementIndex>=0;){const m=i[e[this._currentPlacementIndex]],_=this.placement.collisionIndex.transform.zoom;if(m.type==="symbol"&&(!m.minzoom||m.minzoom<=_)&&(!m.maxzoom||m.maxzoom>_)){const v=m,x=v.layout.get("symbol-z-elevate"),w=this._inProgressLayer=this._inProgressLayer||new cq(v),C=To(m.source,m.scope);if(w.continuePlacement(x?l[C]:o[C],this.placement,this._showCollisionBoxes,m,h))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(e){return this.placement.commit(e),this.placement}}const cO=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class vy{static from(e){if(!(e instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[i,o]=new Uint8Array(e,0,2);if(i!==219)throw new Error("Data does not appear to be in a KDBush format.");const l=o>>4;if(l!==1)throw new Error(`Got v${l} data when expected v1.`);const u=cO[15&o];if(!u)throw new Error("Unrecognized array type.");const[h]=new Uint16Array(e,2,1),[m]=new Uint32Array(e,4,1);return new vy(m,h,u,e)}constructor(e,i=64,o=Float64Array,l){if(isNaN(e)||e<0)throw new Error(`Unpexpected numItems value: ${e}.`);this.numItems=+e,this.nodeSize=Math.min(Math.max(+i,2),65535),this.ArrayType=o,this.IndexArrayType=e<65536?Uint16Array:Uint32Array;const u=cO.indexOf(this.ArrayType),h=2*e*this.ArrayType.BYTES_PER_ELEMENT,m=e*this.IndexArrayType.BYTES_PER_ELEMENT,_=(8-m%8)%8;if(u<0)throw new Error(`Unexpected typed array class: ${o}.`);l&&l instanceof ArrayBuffer?(this.data=l,this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+m+_,2*e),this._pos=2*e,this._finished=!0):(this.data=new ArrayBuffer(8+h+m+_),this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+m+_,2*e),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+u]),new Uint16Array(this.data,2,1)[0]=i,new Uint32Array(this.data,4,1)[0]=e)}add(e,i){const o=this._pos>>1;return this.ids[o]=o,this.coords[this._pos++]=e,this.coords[this._pos++]=i,o}finish(){const e=this._pos>>1;if(e!==this.numItems)throw new Error(`Added ${e} items when expected ${this.numItems}.`);return vT(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(e,i,o,l){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:u,coords:h,nodeSize:m}=this,_=[0,u.length-1,0],v=[];for(;_.length;){const x=_.pop()||0,w=_.pop()||0,C=_.pop()||0;if(w-C<=m){for(let z=C;z<=w;z++){const B=h[2*z],H=h[2*z+1];B>=e&&B<=o&&H>=i&&H<=l&&v.push(u[z])}continue}const k=C+w>>1,P=h[2*k],R=h[2*k+1];P>=e&&P<=o&&R>=i&&R<=l&&v.push(u[k]),(x===0?e<=P:i<=R)&&(_.push(C),_.push(k-1),_.push(1-x)),(x===0?o>=P:l>=R)&&(_.push(k+1),_.push(w),_.push(1-x))}return v}within(e,i,o){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:l,coords:u,nodeSize:h}=this,m=[0,l.length-1,0],_=[],v=o*o;for(;m.length;){const x=m.pop()||0,w=m.pop()||0,C=m.pop()||0;if(w-C<=h){for(let z=C;z<=w;z++)fO(u[2*z],u[2*z+1],e,i)<=v&&_.push(l[z]);continue}const k=C+w>>1,P=u[2*k],R=u[2*k+1];fO(P,R,e,i)<=v&&_.push(l[k]),(x===0?e-o<=P:i-o<=R)&&(m.push(C),m.push(k-1),m.push(1-x)),(x===0?e+o>=P:i+o>=R)&&(m.push(k+1),m.push(w),m.push(1-x))}return _}}function vT(r,e,i,o,l,u){if(l-o<=i)return;const h=o+l>>1;uO(r,e,h,o,l,u),vT(r,e,i,o,h-1,1-u),vT(r,e,i,h+1,l,1-u)}function uO(r,e,i,o,l,u){for(;l>o;){if(l-o>600){const v=l-o+1,x=i-o+1,w=Math.log(v),C=.5*Math.exp(2*w/3),k=.5*Math.sqrt(w*C*(v-C)/v)*(x-v/2<0?-1:1);uO(r,e,i,Math.max(o,Math.floor(i-x*C/v+k)),Math.min(l,Math.floor(i+(v-x)*C/v+k)),u)}const h=e[2*i+u];let m=o,_=l;for(Mg(r,e,o,i),e[2*l+u]>h&&Mg(r,e,o,l);m<_;){for(Mg(r,e,m,_),m++,_--;e[2*m+u]<h;)m++;for(;e[2*_+u]>h;)_--}e[2*o+u]===h?Mg(r,e,o,_):(_++,Mg(r,e,_,l)),_<=i&&(o=_+1),i<=_&&(l=_-1)}}function Mg(r,e,i,o){yT(r,i,o),yT(e,2*i,2*o),yT(e,2*i+1,2*o+1)}function yT(r,e,i){const o=r[e];r[e]=r[i],r[i]=o}function fO(r,e,i,o){const l=r-i,u=e-o;return l*l+u*u}const xT=512/Et/2;class fq{constructor(e,i,o){this.tileID=e,this.bucketInstanceId=o,this.index=new vy(i.length,16,Int32Array),this.keys=[],this.crossTileIDs=[];const l=e.canonical.x*Et,u=e.canonical.y*Et;for(let h=0;h<i.length;h++){const{key:m,crossTileID:_,tileAnchorX:v,tileAnchorY:x}=i.get(h),w=Math.floor((l+v)*xT),C=Math.floor((u+x)*xT);this.index.add(w,C),this.keys.push(m),this.crossTileIDs.push(_)}this.index.finish()}findMatches(e,i,o){const l=this.tileID.canonical.z<i.canonical.z?1:Math.pow(2,this.tileID.canonical.z-i.canonical.z),u=xT/Math.pow(2,i.canonical.z-this.tileID.canonical.z),h=i.canonical.x*Et,m=i.canonical.y*Et;for(let _=0;_<e.length;_++){const v=e.get(_);if(v.crossTileID)continue;const{key:x,tileAnchorX:w,tileAnchorY:C}=v,k=Math.floor((h+w)*u),P=Math.floor((m+C)*u),R=this.index.range(k-l,P-l,k+l,P+l);for(const z of R){const B=this.crossTileIDs[z];if(this.keys[z]===x&&!o.has(B)){o.add(B),v.crossTileID=B;break}}}}}class hq{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class dq{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(e){const i=Math.round((e-this.lng)/360);if(i!==0)for(const o in this.indexes){const l=this.indexes[o],u={};for(const h in l){const m=l[h];m.tileID=m.tileID.unwrapTo(m.tileID.wrap+i),u[m.tileID.key]=m}this.indexes[o]=u}this.lng=e}addBucket(e,i,o){if(this.indexes[e.overscaledZ]&&this.indexes[e.overscaledZ][e.key]){if(this.indexes[e.overscaledZ][e.key].bucketInstanceId===i.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(e.overscaledZ,this.indexes[e.overscaledZ][e.key])}for(let u=0;u<i.symbolInstances.length;u++)i.symbolInstances.get(u).crossTileID=0;this.usedCrossTileIDs[e.overscaledZ]||(this.usedCrossTileIDs[e.overscaledZ]=new Set);const l=this.usedCrossTileIDs[e.overscaledZ];for(const u in this.indexes){const h=this.indexes[u];if(Number(u)>e.overscaledZ)for(const m in h){const _=h[m];_.tileID.isChildOf(e)&&_.findMatches(i.symbolInstances,e,l)}else{const m=h[e.scaledTo(Number(u)).key];m&&m.findMatches(i.symbolInstances,e,l)}}for(let u=0;u<i.symbolInstances.length;u++){const h=i.symbolInstances.get(u);h.crossTileID||(h.crossTileID=o.generate(),l.add(h.crossTileID))}return this.indexes[e.overscaledZ]===void 0&&(this.indexes[e.overscaledZ]={}),this.indexes[e.overscaledZ][e.key]=new fq(e,i.symbolInstances,i.bucketInstanceId),!0}removeBucketCrossTileIDs(e,i){for(const o of i.crossTileIDs)this.usedCrossTileIDs[e].delete(o)}removeStaleBuckets(e){let i=!1;for(const o in this.indexes){const l=this.indexes[o];for(const u in l)e[l[u].bucketInstanceId]||(this.removeBucketCrossTileIDs(o,l[u]),delete l[u],i=!0)}return i}}class pq{constructor(){this.layerIndexes={},this.crossTileIDs=new hq,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(e,i,o,l){let u=this.layerIndexes[e.fqid];u===void 0&&(u=this.layerIndexes[e.fqid]=new dq);let h=!1;const m={};l.name!=="globe"&&u.handleWrapJump(o);for(const _ of i){const v=_.getBucket(e);v&&e.fqid===v.layerIds[0]&&(v.bucketInstanceId||(v.bucketInstanceId=++this.maxBucketInstanceId),u.addBucket(_.tileID,v,this.crossTileIDs)&&(h=!0),m[v.bucketInstanceId]=!0)}return u.removeStaleBuckets(m)&&(h=!0),h}pruneUnusedLayers(e){const i={};e.forEach(o=>{i[o]=!0});for(const o in this.layerIndexes)i[o]||delete this.layerIndexes[o]}}var hO=`
#define EPSILON 0.0000001
#define PI 3.141592653589793
#define EXTENT 8192.0
#define HALF_PI PI/2.0
#define QUARTER_PI PI/4.0
#define RAD_TO_DEG 180.0/PI
#define DEG_TO_RAD PI/180.0
#define GLOBE_RADIUS EXTENT/PI/2.0
vec3 linearTosRGB(vec3 color)
{return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn)
{return pow(srgbIn,vec3(2.2));}vec3 linearProduct(vec3 srgbIn,vec3 k)
{return srgbIn*pow(k,vec3(1./2.2));}
#if __VERSION__ >=300
#define _HANDLE_WIREFRAME_DEPTH gl_FragDepth=gl_FragCoord.z-0.0001;
#else
#define _HANDLE_WIREFRAME_DEPTH
#endif
#ifdef DEBUG_WIREFRAME
#define HANDLE_WIREFRAME_DEBUG \\
gl_FragColor=vec4(0.7,0.0,0.0,0.7); \\
_HANDLE_WIREFRAME_DEPTH;
#else
#define HANDLE_WIREFRAME_DEBUG
#endif
#ifdef RENDER_CUTOFF
float cutoff_opacity(vec4 cutoff_params,float depth) {float near=cutoff_params.x;float far=cutoff_params.y;float cutoffStart=cutoff_params.z;float cutoffEnd=cutoff_params.w-0.0001;float linearDepth=(depth-near)/(far-near);return clamp((linearDepth-cutoffStart)/(cutoffEnd-cutoffStart),0.0,1.0);}
#endif`,dO="attribute highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;varying highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",pO=`
#define ELEVATION_SCALE 7.0
#define ELEVATION_OFFSET 450.0
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(
mix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}
#else
vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }
#endif
const float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)
{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}
#ifdef TERRAIN
#ifdef TERRAIN_DEM_FLOAT_FORMAT
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;
#else
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;
#endif
uniform vec4 u_dem_unpack;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float decodeElevation(vec4 v) {return dot(vec4(v.xyz*255.0,-1.0),u_dem_unpack);}float currentElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem,pos));float tr=decodeElevation(texture2D(u_dem,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}float prevElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem_prev,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem_prev,pos));float tr=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem_prev,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}
#ifdef TERRAIN_VERTEX_MORPHING
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}
#else
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
return currentElevation(apos);}
#endif
highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture2D(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(
unpack_depth(texture2D(u_depth,uv-df.xz)),unpack_depth(texture2D(u_depth,uv+df.xz)),unpack_depth(texture2D(u_depth,uv-df.zy)),unpack_depth(texture2D(u_depth,uv+df.zy))
);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(off.x,0.0)).r;float bl=texture(u_dem,pos+vec2(0.0,off.y)).r;float br=texture(u_dem,pos+off).r;
#else
vec4 demtl=vec4(texture2D(u_dem,pos).xyz*255.0,-1.0);float tl=dot(demtl,u_dem_unpack);vec4 demtr=vec4(texture2D(u_dem,pos+vec2(off.x,0.0)).xyz*255.0,-1.0);float tr=dot(demtr,u_dem_unpack);vec4 dembl=vec4(texture2D(u_dem,pos+vec2(0.0,off.y)).xyz*255.0,-1.0);float bl=dot(dembl,u_dem_unpack);vec4 dembr=vec4(texture2D(u_dem,pos+off).xyz*255.0,-1.0);float br=dot(dembr,u_dem_unpack);
#endif
return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}
#else
float elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }
#endif`,mO=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;varying vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}
#endif`,gO=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump vec2 u_fog_vertical_limit;uniform mediump float u_fog_temporal_offset;varying vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,opacity);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec4 fog_apply_premultiplied(vec4 color,vec3 pos,float heightMeters) {float verticalProgress=(u_fog_vertical_limit.x > 0.0 || u_fog_vertical_limit.y > 0.0) ? smoothstep(u_fog_vertical_limit.x,u_fog_vertical_limit.y,heightMeters) : 0.0;float opacityLimit=1.0-smoothstep(0.9,1.0,fog_opacity(pos));return mix(fog_apply_premultiplied(color,pos),color,min(verticalProgress,opacityLimit));}vec3 fog_dither(vec3 color) {
#ifdef FOG_DITHERING
vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);
#else
return color;
#endif
}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}
#endif`,_O=`#ifdef RENDER_SHADOWS
uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_normal_offset;vec3 shadow_normal_offset(vec3 normal) {float tileInMeters=u_shadow_normal_offset[0];vec3 n=vec3(-normal.xy,tileInMeters*normal.z);float dotScale=min(1.0-dot(normal,u_shadow_direction),1.0)*0.5+0.5;return n*dotScale;}vec3 shadow_normal_offset_model(vec3 normal) {float dotScale=min(1.0-dot(normal,u_shadow_direction),1.0)*0.5+0.5;return normal*dotScale;}float shadow_normal_offset_multiplier0() {return u_shadow_normal_offset[1];}float shadow_normal_offset_multiplier1() {return u_shadow_normal_offset[2];}
#endif//RENDER_SHADOWS`,vO=`#ifdef RENDER_SHADOWS
#if defined(NATIVE) && __VERSION__ >=300
#define TEXTURE_GATHER
#endif
#ifdef DEPTH_TEXTURE
uniform highp sampler2D u_shadowmap_0;uniform highp sampler2D u_shadowmap_1;
#else
uniform sampler2D u_shadowmap_0;uniform sampler2D u_shadowmap_1;
#endif
uniform float u_shadow_intensity;uniform float u_shadow_map_resolution;uniform float u_shadow_texel_size;uniform highp vec3 u_shadow_normal_offset;uniform vec2 u_fade_range;uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_bias;highp float shadow_sample_1(highp vec2 uv,highp float compare) {highp float shadow_depth;
#ifdef DEPTH_TEXTURE
shadow_depth=texture2D(u_shadowmap_1,uv).r;
#else
shadow_depth=unpack_depth(texture2D(u_shadowmap_1,uv))*0.5+0.5;
#endif
return step(shadow_depth,compare);}highp float shadow_sample_0(highp vec2 uv,highp float compare) {highp float shadow_depth;
#ifdef DEPTH_TEXTURE
shadow_depth=texture2D(u_shadowmap_0,uv).r;
#else
shadow_depth=unpack_depth(texture2D(u_shadowmap_0,uv))*0.5+0.5;
#endif
return step(shadow_depth,compare);}float shadow_occlusion_1(highp vec4 pos,highp float bias) {highp vec2 uv=pos.xy;return shadow_sample_1(uv,pos.z-bias);}float shadow_occlusion_0(highp vec4 pos,highp float bias) {highp float compare0=pos.z-bias;
#ifdef TEXTURE_GATHER
highp vec2 uv=pos.xy;highp vec4 samples=textureGather(u_shadowmap_0,uv,0);lowp vec4 stepSamples=step(samples,vec4(compare0));
#else
highp vec2 uv00=pos.xy-vec2(0.5*u_shadow_texel_size);highp vec2 uv10=uv00+vec2(u_shadow_texel_size,0.0);highp vec2 uv01=uv00+vec2(0.0,u_shadow_texel_size);highp vec2 uv11=uv01+vec2(u_shadow_texel_size,0.0);lowp vec4 stepSamples=vec4(
shadow_sample_0(uv01,compare0),shadow_sample_0(uv11,compare0),shadow_sample_0(uv10,compare0),shadow_sample_0(uv00,compare0)
);
#endif
vec2 f=fract(pos.xy*u_shadow_map_resolution-vec2(0.5));lowp vec2 lerpx=mix(stepSamples.wx,stepSamples.zy,f.xx);return mix(lerpx.x,lerpx.y,f.y);}float shadow_occlusion(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,highp float bias) {
#ifdef SHADOWS_SINGLE_CASCADE
light_view_pos0.xyz=light_view_pos0.xyz/light_view_pos0.w*0.5+0.5;return shadow_occlusion_0(light_view_pos0,bias);
#else
light_view_pos0.xyz/=light_view_pos0.w;light_view_pos1.xyz/=light_view_pos1.w;vec4 uv=vec4(light_view_pos0.xy,light_view_pos1.xy);vec4 abs_bounds=abs(uv);if (abs_bounds.x < 1.0 && abs_bounds.y < 1.0) {light_view_pos0.xyz=light_view_pos0.xyz*0.5+0.5;return shadow_occlusion_0(light_view_pos0,bias);}if (abs_bounds.z >=1.0 || abs_bounds.w >=1.0) {return 0.0;}light_view_pos1.xyz=light_view_pos1.xyz*0.5+0.5;float occlusion1=shadow_occlusion_1(light_view_pos1,bias);return mix(occlusion1,0.0,smoothstep(u_fade_range.x,u_fade_range.y,view_depth));
#endif
}highp float calculate_shadow_bias(float NDotL) {
#ifdef NORMAL_OFFSET
return 0.5*u_shadow_bias.x;
#else
return 0.5*(u_shadow_bias.x+clamp(u_shadow_bias.y*tan(acos(NDotL)),0.0,u_shadow_bias.z));
#endif
}float shadowed_light_factor_normal(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_unbiased(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return 1.0-(u_shadow_intensity*occlusion);}float shadow_occlusion(float ndotl,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=calculate_shadow_bias(ndotl);return shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);}
#endif`;const yO=[];by(hO,yO);const yy={"_prelude_fog.vertex.glsl":mO,"_prelude_terrain.vertex.glsl":pO,"_prelude_shadow.vertex.glsl":_O,"_prelude_fog.fragment.glsl":gO,"_prelude_shadow.fragment.glsl":vO,"_prelude_lighting.glsl":`
#ifdef LIGHTING_3D_MODE
uniform mediump vec3 u_lighting_ambient_color;uniform mediump vec3 u_lighting_directional_dir;uniform mediump vec3 u_lighting_directional_color;uniform mediump vec3 u_ground_radiance;float calculate_ambient_directional_factor(vec3 normal) {float NdotL=dot(normal,u_lighting_directional_dir);const float factor_reduction_max=0.3;float dir_luminance=dot(u_lighting_directional_color,vec3(0.2126,0.7152,0.0722));float directional_factor_min=1.0-factor_reduction_max*min(dir_luminance,1.0);float ambient_directional_factor=mix(directional_factor_min,1.0,min((NdotL+1.0),1.0));const float vertical_factor_min=0.92;float vertical_factor=mix(vertical_factor_min,1.0,normal.z*0.5+0.5);return vertical_factor*ambient_directional_factor;}vec3 apply_lighting(vec3 color,vec3 normal,float dir_factor) {float ambient_directional_factor=calculate_ambient_directional_factor(normal);vec3 ambient_contrib=ambient_directional_factor*u_lighting_ambient_color;vec3 directional_contrib=u_lighting_directional_color*dir_factor;return linearProduct(color,ambient_contrib+directional_contrib);}vec4 apply_lighting(vec4 color,vec3 normal,float dir_factor) {return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting(vec3 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return apply_lighting(color.rgb,normal,dir_factor);}vec4 apply_lighting(vec4 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting_ground(vec3 color) {return color*u_ground_radiance;}vec4 apply_lighting_ground(vec4 color) {return vec4(apply_lighting_ground(color.rgb),color.a);}float calculate_NdotL(vec3 normal) {const float ext=0.70710678118;return (clamp(dot(normal,u_lighting_directional_dir),-ext,1.0)+ext)/(1.0+ext);}vec4 apply_lighting_with_emission_ground(vec4 color,float emissive_strength) {return mix(apply_lighting_ground(color),color,emissive_strength);}vec3 compute_flood_lighting(vec3 flood_light_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=flood_light_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);float occlusion_ramp=smoothstep(0.0,0.2,1.0-occlusion);return mix(fully_occluded_color,flood_light_color,occlusion_ramp);}vec3 compute_emissive_draped(vec3 unlit_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=unlit_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);return mix(fully_occluded_color,unlit_color,1.0-occlusion);}
#endif//LIGHTING_3D_MODE`},xy={};ri("",pO),ri(gO,mO),ri(vO,_O);const xO=ri(`
#if __VERSION__ >=300
#define varying in
#define gl_FragColor glFragColor
#define texture2D texture
#define textureCube texture
out vec4 glFragColor;
#endif
highp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}
#ifdef INDICATOR_CUTOUT
uniform vec2 u_indicator_cutout_centers;uniform vec4 u_indicator_cutout_params;
#endif
vec4 applyCutout(vec4 color) {
#ifdef INDICATOR_CUTOUT
float holeMinOpacity=u_indicator_cutout_params.x;float holeRadius=max(u_indicator_cutout_params.y,0.0);float holeAspectRatio=u_indicator_cutout_params.z;float fadeStart=u_indicator_cutout_params.w;float distA=distance(vec2(gl_FragCoord.x,gl_FragCoord.y*holeAspectRatio),vec2(u_indicator_cutout_centers[0],u_indicator_cutout_centers[1]*holeAspectRatio));return color*min(smoothstep(fadeStart,holeRadius,distA)+holeMinOpacity,1.0);
#else
return color;
#endif
}
#ifdef RENDER_CUTOFF
uniform highp vec4 u_cutoff_params;varying float v_cutoff_opacity;
#endif`,`
#if __VERSION__ >=300
#define attribute in
#define varying out
#define texture2D texture
#endif
float wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {
#ifndef PROJECTED_POS_ON_VIEWPORT
float tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;
#else
return vec3(0.0);
#endif
}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(
unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}
#ifdef RENDER_CUTOFF
uniform vec4 u_cutoff_params;varying float v_cutoff_opacity;
#endif
const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);//Normalized device coordinate that is not rendered.`),bO=hO;var wO={background:ri(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec4 u_color;uniform float u_opacity;
#ifdef LIGHTING_3D_MODE
varying vec4 v_color;
#endif
void main() {vec4 out_color;
#ifdef LIGHTING_3D_MODE
out_color=v_color;
#else
out_color=u_color;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_lighting.glsl"
attribute vec2 a_pos;uniform mat4 u_matrix;
#ifdef LIGHTING_3D_MODE
uniform mediump vec4 u_color;varying vec4 v_color;uniform float u_emissive_strength;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting_with_emission_ground(u_color,u_emissive_strength);
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),backgroundPattern:ri(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform float u_emissive_strength;uniform sampler2D u_image;varying vec2 v_pos;void main() {vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),circle:ri(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
uniform float u_emissive_strength;void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(
antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)
);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_apply_premultiplied(out_color,v_fog_pos);
#endif
gl_FragColor=out_color*(v_visibility*opacity_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define NUM_VISIBILITY_RINGS 2
#define INV_SQRT2 0.70710678
#define ELEVATION_BIAS 0.0001
#define NUM_SAMPLES_PER_RING 16
uniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
vec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {
#if defined(TERRAIN)
return elevation(pos)+ELEVATION_BIAS;
#else
return 0.0;
#endif
}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);
#ifdef PITCH_WITH_MAP
#ifdef PROJECTION_GLOBE_VIEW
return u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );
#else
return u_matrix*( world_center+vec4(sample_offset,0,0) );
#endif
#else
return projected_center+vec4(sample_offset,0,0);
#endif
}float get_sample_step() {
#ifdef PITCH_WITH_MAP
return 2.0*PI/float(NUM_SAMPLES_PER_RING);
#else
return PI/float(NUM_SAMPLES_PER_RING);
#endif
}void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);
#else 
surface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);
#endif
vec4 projected_center=u_matrix*world_center;float view_scale=0.0;
#ifdef PITCH_WITH_MAP
#ifdef SCALE_WITH_MAP
view_scale=1.0;
#else
view_scale=projected_center.w/u_camera_to_center_distance;
#endif
#else
#ifdef SCALE_WITH_MAP
view_scale=u_camera_to_center_distance;
#else
view_scale=projected_center.w;
#endif
#endif
gl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;
#ifdef TERRAIN
float step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;
#ifdef PITCH_WITH_MAP
float cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;
#else
occlusion_world_center=world_center;occlusion_projected_center=projected_center;
#endif
for(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);
#else
visibility=1.0;
#endif
#ifdef PROJECTION_GLOBE_VIEW
visibility=1.0;
#endif
v_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);
#ifdef FOG
v_fog_pos=fog_position(world_center.xyz);
#endif
}`),clippingMask:ri("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:ri(`#include "_prelude_fog.fragment.glsl"
uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef FOG
if (u_is_globe==0) {gl_FragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#else
pos=vec3(tilePos+extrude,elevation(tilePos));
#endif
gl_Position=u_matrix*vec4(pos,1);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),heatmapTexture:ri(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,"attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:ri("varying float v_placed;varying float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);gl_FragColor =mix(red,blue,step(0.5,v_placed))*0.5;gl_FragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",`#include "_prelude_terrain.vertex.glsl"
attribute vec3 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;attribute float a_size_scale;attribute vec2 a_padding;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*elevation(a_anchor_pos),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}`),collisionCircle:ri("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}",`attribute vec2 a_pos_2f;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(
mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}`),debug:ri("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}",`#include "_prelude_terrain.vertex.glsl"
attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;
#endif
varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
gl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);
#else
gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);
#endif
}`),fill:ri(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
uniform float u_emissive_strength;void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
vec4 out_color=color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutline:ri(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
varying vec2 v_pos;uniform float u_emissive_strength;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutlinePattern:ri(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_emissive_strength;varying vec2 v_pos;varying vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;varying vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillPattern:ri(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;uniform float u_emissive_strength;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillExtrusion:ri(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
varying vec4 v_color;
#ifdef RENDER_SHADOWS
varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;
#endif
uniform lowp float u_opacity;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec2 v_ao;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
varying vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
varying highp vec3 v_normal;
#endif
uniform vec3 u_flood_light_color;uniform highp float u_vertical_scale;uniform float u_flood_light_intensity;uniform vec3 u_ground_shadow_factor;
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
varying float v_flood_radius;varying float v_has_floodlight;
#endif
varying float v_height;void main() {
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
vec3 normal=normalize(v_normal);
#endif
float z;vec4 color=v_color;
#ifdef ZERO_ROOF_RADIUS
z=float(normal.z > 0.00001);
#ifdef LIGHTING_3D_MODE
normal=mix(normal,vec3(0.0,0.0,1.0),z);
#else
color=mix(v_color,v_roof_color,z);
#endif
#endif
float h=max(0.0,v_height);float ao_shade=1.0;
#ifdef FAUX_AO
float intensity=u_ao[0];float h_floors=h/(u_ao[1]*u_vertical_scale);float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);ao_shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;
#ifdef ZERO_ROOF_RADIUS
concave*=(1.0-z);
#endif
float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);ao_shade*=mix(1.0,x_shade*x_shade*x_shade,concave);
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
color.rgb*=mix(ao_shade,1.0,v_has_floodlight);
#else
color.rgb*=ao_shade;
#endif
#else
color.rgb*=ao_shade;
#endif
#endif
#ifdef LIGHTING_3D_MODE
float flood_radiance=0.0;
#ifdef FLOOD_LIGHT
flood_radiance=(1.0-min(h/v_flood_radius,1.0))*u_flood_light_intensity*v_has_floodlight;
#endif
#ifdef RENDER_SHADOWS
#ifdef FLOOD_LIGHT
float ndotl_unclamped=dot(normal,u_shadow_direction);float ndotl=max(0.0,ndotl_unclamped);float occlusion=ndotl_unclamped < 0.0 ? 1.0 : shadow_occlusion(ndotl,v_pos_light_view_0,v_pos_light_view_1,v_depth);vec3 litColor=apply_lighting(color.rgb,normal,(1.0-u_shadow_intensity*occlusion)*ndotl);vec3 floodLitColor=compute_flood_lighting(u_flood_light_color*u_opacity,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=mix(litColor,floodLitColor,flood_radiance);
#else
float shadowed_lighting_factor=shadowed_light_factor_normal(normal,v_pos_light_view_0,v_pos_light_view_1,v_depth);color.rgb=apply_lighting(color.rgb,normal,shadowed_lighting_factor);
#endif
#else
color.rgb=apply_lighting(color.rgb,normal);
#ifdef FLOOD_LIGHT
color.rgb=mix(color.rgb,u_flood_light_color*u_opacity,flood_radiance);
#endif
#endif
color*=u_opacity;
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos,h));
#endif
#ifdef RENDER_CUTOFF
color*=v_cutoff_opacity;
#endif
#ifdef INDICATOR_CUTOUT
color=applyCutout(color);
#endif
gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_lighting.glsl"
#if __VERSION__ >=300
#ifdef RENDER_CUTOFF
invariant gl_Position;
#endif
#endif
uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
uniform highp float u_vertical_scale;varying vec4 v_color;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
varying vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
varying highp vec3 v_normal;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec2 v_ao;
#endif
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
varying float v_flood_radius;varying float v_has_floodlight;
#endif
varying float v_height;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
#pragma mapbox: define highp float flood_light_wall_radius
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize highp float flood_light_wall_radius
base*=u_vertical_scale;height*=u_vertical_scale;vec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
v_normal=normal;
#endif
base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=0.0;float c_ele;vec3 pos;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);pos=vec3(pos_nx.xy,h);
#else
h=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);h=h-ele;v_height=h;
#ifdef RENDER_SHADOWS
vec3 shd_pos0=pos;vec3 shd_pos1=pos;
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(normal);shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
float NdotL=0.0;float colorvalue=0.0;
#ifndef LIGHTING_3D_MODE
colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);if (normal.y !=0.0) {float r=0.84;r=mix(0.7,0.98,1.0-u_lightintensity);NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#endif
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec2(mix(concave,-concave,start),y_ground);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
float is_wall=1.0-float(t > 0.0 && top_up_ny.y > 0.0);v_has_floodlight=float(flood_light_wall_radius > 0.0 && is_wall > 0.0);v_flood_radius=flood_light_wall_radius*u_vertical_scale;
#endif
v_color=vec4(color.rgb,1.0);
#else
v_color=vec4(0.0,0.0,0.0,1.0);v_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_color*=u_opacity;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
float roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color=vec4(0.0,0.0,0.0,1.0);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_roof_color*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
}`),fillExtrusionDepth:ri(`varying highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
gl_FragColor=pack_depth(v_depth);
#endif
}`,`#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;uniform float u_edge_radius;uniform float u_vertical_scale;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
varying highp float v_depth;void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
base*=u_vertical_scale;height*=u_vertical_scale;vec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
vec3 pos;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;float ele=elevation(pos_nx.xy);float c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;float h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base);pos=vec3(pos_nx.xy,h);
#else
pos=vec3(pos_nx.xy,t > 0.0 ? height : base);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);v_depth=gl_Position.z/gl_Position.w;}`),fillExtrusionPattern:ri(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
varying vec3 v_normal;
#endif
varying vec2 v_pos;varying vec4 v_lighting;uniform lowp float u_opacity;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define highp float pixel_ratio
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize highp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color,normalize(v_normal))*u_opacity;
#else
out_color=out_color*v_lighting;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color);
#endif
gl_FragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_lighting.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
varying vec2 v_pos;varying vec4 v_lighting;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
varying vec3 v_normal;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define highp float pixel_ratio
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize highp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=z;vec3 p;float c_ele;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);p=vec3(pos_nx.xy,h);
#else
p=vec3(pos_nx.xy,z);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0
? pos_nx.xy
: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_normal=normal;
#else
v_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;
#endif 
#ifdef FOG
v_fog_pos=fog_position(p);
#endif
}`),groundShadow:ri(`#include "_prelude_shadow.fragment.glsl"
#ifdef GL_ES
precision highp float;
#endif
uniform vec3 u_ground_shadow_factor;varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;
#ifdef FOG
varying float v_fog_opacity;
#endif
void main() {float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);vec3 shadow=mix(u_ground_shadow_factor,vec3(1.0),light);
#ifdef RENDER_CUTOFF
shadow=mix(vec3(1.0),shadow,cutoff_opacity(u_cutoff_params,v_depth));
#endif
#ifdef FOG
shadow=mix(shadow,vec3(1.0),v_fog_opacity);
#endif
#ifdef INDICATOR_CUTOUT
shadow=mix(shadow,vec3(1.0),1.0-applyCutout(vec4(1.0)).r);
#endif
gl_FragColor=vec4(shadow,1.0);}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;attribute vec2 a_pos;varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;
#ifdef FOG
varying float v_fog_opacity;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0.0,1.0);v_pos_light_view_0=u_light_matrix_0*vec4(a_pos,0.0,1.0);v_pos_light_view_1=u_light_matrix_1*vec4(a_pos,0.0,1.0);v_depth=gl_Position.w;
#ifdef FOG
v_fog_pos=fog_position(a_pos);v_fog_opacity=fog(v_fog_pos);
#endif
}`),fillExtrusionGroundEffect:ri(`uniform highp float u_ao_pass;uniform highp float u_opacity;uniform highp float u_flood_light_intensity;uniform highp vec3 u_flood_light_color;uniform highp float u_attenuation;uniform sampler2D u_fb;uniform float u_fb_size;
#ifdef SDF_SUBPASS
varying highp vec2 v_pos;varying highp vec4 v_line_segment;varying highp float v_flood_light_radius_tile;varying highp vec2 v_ao;float line_df(highp vec2 a,highp vec2 b,highp vec2 p) {highp vec2 ba=b-a;highp vec2 pa=p-a;highp float r=clamp(dot(pa,ba)/dot(ba,ba),0.0,1.0);return length(pa-r*ba);}
#ifdef FOG
varying highp float v_fog;
#endif
#endif
void main() {
#ifdef CLEAR_SUBPASS
vec4 color=vec4(1.0);
#ifdef CLEAR_FROM_TEXTURE
color=texture2D(u_fb,gl_FragCoord.xy/vec2(u_fb_size));
#endif
gl_FragColor=color;
#else
#ifdef SDF_SUBPASS
highp float d=line_df(v_line_segment.xy,v_line_segment.zw,v_pos);highp float effect_radius=mix(v_flood_light_radius_tile,v_ao.y,u_ao_pass);d/=effect_radius;d=min(d,1.0);d=1.0-pow(1.0-d,u_attenuation);highp float effect_intensity=mix(u_flood_light_intensity,v_ao.x,u_ao_pass);highp float fog=1.0;
#ifdef FOG
fog=v_fog;
#endif
#ifdef RENDER_CUTOFF
fog*=v_cutoff_opacity;
#endif
gl_FragColor=vec4(vec3(0.0),mix(1.0,d,effect_intensity*u_opacity*fog));
#else
vec4 color=mix(vec4(u_flood_light_color,1.0),vec4(vec3(0.0),1.0),u_ao_pass);
#ifdef OVERDRAW_INSPECTOR
color=vec4(1.0);
#endif
gl_FragColor=color;HANDLE_WIREFRAME_DEBUG;
#endif
#endif
}`,`#include "_prelude_fog.vertex.glsl"
attribute highp vec4 a_pos_end;attribute highp float a_angular_offset_factor;attribute highp float a_hidden_by_landmark;
#ifdef SDF_SUBPASS
varying highp vec2 v_pos;varying highp vec4 v_line_segment;varying highp float v_flood_light_radius_tile;varying highp vec2 v_ao;
#ifdef FOG
varying highp float v_fog;
#endif
#endif
uniform highp float u_flood_light_intensity;uniform highp mat4 u_matrix;uniform highp float u_ao_pass;uniform highp float u_meter_to_tile;uniform highp float u_edge_radius;uniform highp vec2 u_ao;
#pragma mapbox: define highp float flood_light_ground_radius
const float TANGENT_CUTOFF=4.0;const float NORM=32767.0;void main() {
#pragma mapbox: initialize highp float flood_light_ground_radius
vec2 p=a_pos_end.xy;vec2 q=floor(a_pos_end.zw*0.5);vec2 start_bottom=a_pos_end.zw-q*2.0;float fl_ground_radius=flood_light_ground_radius;
#ifdef FORCE_ABS_FL_GROUND_RADIUS
fl_ground_radius=abs(flood_light_ground_radius);
#endif
float flood_radius_tile=fl_ground_radius*u_meter_to_tile;vec2 v=normalize(q-p);float ao_radius=u_ao.y/3.5;float effect_radius=mix(flood_radius_tile,ao_radius,u_ao_pass)+u_edge_radius;float angular_offset_factor=a_angular_offset_factor/NORM*TANGENT_CUTOFF;float angular_offset=angular_offset_factor*effect_radius;float top=1.0-start_bottom.y;float side=(0.5-start_bottom.x)*2.0;vec2 extrusion_parallel=v*side*mix(1.0,angular_offset,top);vec2 perp=vec2(v.y,-v.x);vec2 extrusion_perp=perp*effect_radius*top;vec3 pos=vec3(mix(q,p,start_bottom.x),0.0);pos.xy+=extrusion_parallel+extrusion_perp;
#ifdef SDF_SUBPASS
v_pos=pos.xy;v_line_segment=vec4(p,q)+perp.xyxy*u_edge_radius;v_flood_light_radius_tile=flood_radius_tile;v_ao=vec2(u_ao.x,ao_radius);
#ifdef FOG
v_fog_pos=fog_position(pos);v_fog=1.0-fog(v_fog_pos);
#endif
#endif
float hidden_by_landmark=0.0;
#ifdef HAS_CENTROID
hidden_by_landmark=a_hidden_by_landmark;
#endif
float isFloodlit=float(fl_ground_radius > 0.0 && u_flood_light_intensity > 0.0);float hidden=mix(1.0-isFloodlit,isFloodlit,u_ao_pass);hidden+=hidden_by_landmark;gl_Position=mix(u_matrix*vec4(pos,1.0),AWAY,float(hidden > 0.0));
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
}`),hillshadePrepare:ri(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
return texture(u_image,coord).r/4.0;
#else
vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;
#endif
}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(
(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)
)/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(
deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:ri(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;uniform float u_emissive_strength;void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef LIGHTING_3D_MODE
gl_FragColor=apply_lighting_with_emission_ground(gl_FragColor,u_emissive_strength);
#endif
#ifdef FOG
gl_FragColor=fog_dither(fog_apply_premultiplied(gl_FragColor,v_fog_pos));
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),line:ri(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform sampler2D u_dash_image;varying vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform sampler2D u_gradient_image;
#endif
float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}uniform float u_emissive_strength;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
float linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);
#ifdef RENDER_LINE_DASH
float sdfdist=texture2D(u_dash_image,v_tex).a;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;alpha*=linearstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);
#endif
highp vec4 out_color;
#ifdef RENDER_LINE_GRADIENT
out_color=texture2D(u_gradient_image,v_uv.xy);
#else
out_color=color;
#endif
float trimmed=1.0;
#ifdef RENDER_LINE_TRIM_OFFSET
highp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {out_color=vec4(0,0,0,0);trimmed=0.0;}}
#endif
if (u_alpha_discard_threshold !=0.0) {if (alpha < u_alpha_discard_threshold) {discard;}}
#ifdef RENDER_LINE_BORDER
float edgeBlur=(border_width+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);if (border_color.a==0.0) {    
float Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}} else {out_color.rgb=mix(border_color.rgb*border_color.a*trimmed,out_color.rgb,smoothAlpha);}}
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
out_color*=(alpha*opacity);
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color);
#endif
gl_FragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#define EXTRUDE_SCALE 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
attribute highp vec4 a_packed;
#endif
#ifdef RENDER_LINE_DASH
attribute float a_linesofar;
#endif
uniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;varying vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform float u_image_height;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
float a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];
#ifdef RENDER_LINE_GRADIENT
highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);
#else
v_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);
#endif
#endif
#ifdef RENDER_LINE_DASH
float scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/floorwidth,(-normal.y*height+dash.x+0.5)/u_texsize.y);
#endif
v_width2=vec2(outset,inset);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),linePattern:ri(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;vec2 pattern_size=vec2(display_size.x/u_tile_units_to_pixels,display_size.y);float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x=mod(v_linesofar/pattern_size.x*aspect,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));vec4 color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
color=apply_lighting_ground(color);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
color*=(alpha*opacity);
#ifdef INDICATOR_CUTOUT
color=applyCutout(color);
#endif
gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),raster:ri(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;
#ifdef RASTER_COLOR
uniform sampler2D u_color_ramp;uniform highp vec2 u_colorization_scale;uniform highp vec4 u_colorization_mix;highp vec4 colormap (highp float value) {highp float scaled_value=value*u_colorization_scale.y+u_colorization_scale.x;highp vec2 coords=vec2(scaled_value,0.5);return texture2D(u_color_ramp,coords);}
#endif
void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);vec4 color;
#ifdef RASTER_COLOR
highp vec4 fadedColor=mix(color0,color1,u_fade_t);color=colormap(dot(vec4(fadedColor.rgb,1),u_colorization_mix));color.a*=fadedColor.a;if (color.a > 0.0) {color.rgb/=color.a;}
#else
if (color0.a > 0.0) {color0.rgb/=color0.a;}if (color1.a > 0.0) {color1.rgb/=color1.a;}color=mix(color0,color1,u_fade_t);
#endif
color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(
dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_ground(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply(out_color,v_fog_pos));
#endif
gl_FragColor=vec4(out_color*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_pos;attribute vec2 a_uv;
#else
attribute vec2 a_pos;attribute vec2 a_texture_pos;
#endif
varying vec2 v_pos0;varying vec2 v_pos1;void main() {vec2 uv;
#ifdef PROJECTION_GLOBE_VIEW
gl_Position=u_matrix*u_globe_matrix*vec4(a_globe_pos,1.0);uv=a_uv;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(a_globe_pos,1.0)).xyz);
#endif
#else
float w=1.0+dot(a_texture_pos,u_perspective_transform);gl_Position=u_matrix*vec4(a_pos*w,0,w);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
uv=a_texture_pos/8192.0;
#endif
v_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),symbolIcon:ri(`#include "_prelude_lighting.glsl"
uniform sampler2D u_texture;
#ifdef ICON_TRANSITION
uniform float u_icon_transition;
#endif
varying float v_fade_opacity;varying vec2 v_tex_a;
#ifdef ICON_TRANSITION
varying vec2 v_tex_b;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float emissive_strength
lowp float alpha=opacity*v_fade_opacity;vec4 out_color;
#ifdef ICON_TRANSITION
vec4 a=texture2D(u_texture,v_tex_a)*(1.0-u_icon_transition);vec4 b=texture2D(u_texture,v_tex_b)*u_icon_transition;out_color=(a+b)*alpha;
#else
out_color=texture2D(u_texture,v_tex_a)*alpha;
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,emissive_strength);
#endif
gl_FragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef Z_OFFSET
attribute float a_z_offset;
#endif
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
#ifdef ICON_TRANSITION
attribute vec2 a_texb;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform vec3 u_up_vector;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec2 v_tex_a;
#ifdef ICON_TRANSITION
varying vec2 v_tex_b;
#endif
varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float emissive_strength
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;float e=elevation(tile_anchor);
#ifdef Z_OFFSET
e+=a_z_offset;
#endif
vec3 h=elevationVector(tile_anchor)*e;float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjected_point;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetProjected_point=u_matrix*vec4(a_globe_anchor+displacement,1);
#else
offsetProjected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);
#endif
vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetProjected_point.xy/offsetProjected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float out_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change))*projection_transition_fade;float alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,hidden);
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,hidden);
#endif
v_tex_a=a_tex/u_texsize;
#ifdef ICON_TRANSITION
v_tex_b=a_texb/u_texsize;
#endif
v_fade_opacity=out_fade_opacity;}`),symbolSDF:ri(`#include "_prelude_lighting.glsl"
#define SDF_PX 8.0
uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;uniform bool u_is_halo;
#if __VERSION__ >=300
flat varying float v_draw_halo;
#endif
varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;bool draw_halo;
#if __VERSION__ >=300
draw_halo=v_draw_halo > 0.0;
#else
draw_halo=u_is_halo;
#endif
if (draw_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);vec4 out_color=color*(alpha*opacity*fade_opacity);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,emissive_strength);
#endif
gl_FragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef Z_OFFSET
attribute float a_z_offset;
#endif
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform bool u_is_halo;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
#if __VERSION__ >=300
flat varying float v_draw_halo;
#endif
varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;float e=elevation(tile_anchor);
#ifdef Z_OFFSET
e+=a_z_offset;
#endif
vec3 h=elevationVector(tile_anchor)*e;float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);
#else
offsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);
#endif
vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float out_fade_opacity=interpolated_fade_opacity*projection_transition_fade;float alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,hidden);
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,hidden);
#endif
float gamma_scale=gl_Position.w;
#if __VERSION__ >=300
v_draw_halo=(u_is_halo && float(gl_InstanceID)==0.0) ? 1.0 : 0.0;
#endif
v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,out_fade_opacity);}`),symbolTextAndIcon:ri(`#include "_prelude_lighting.glsl"
#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_halo;
#if __VERSION__ >=300
flat varying float v_draw_halo;
#endif
varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;bool draw_halo;
#if __VERSION__ >=300
draw_halo=v_draw_halo > 0.0;
#else
draw_halo=u_is_halo;
#endif
if (draw_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);vec4 out_color=color*(alpha*opacity*fade_opacity);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,emissive_strength);
#endif
gl_FragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef Z_OFFSET
attribute float a_z_offset;
#endif
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;uniform bool u_is_halo;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
#if __VERSION__ >=300
flat varying float v_draw_halo;
#endif
varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;float e=elevation(tile_anchor);
#ifdef Z_OFFSET
e+=a_z_offset;
#endif
vec3 h=elevationVector(tile_anchor)*e;float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offset_projected_point=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projected_point.xy/projected_point.w;vec2 b=offset_projected_point.xy/offset_projected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*font_scale);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
float out_fade_opacity=interpolated_fade_opacity*projection_transition_fade;float alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,hidden);
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,hidden);
#endif
float gamma_scale=gl_Position.w;
#if __VERSION__ >=300
v_draw_halo=(u_is_halo && float(gl_InstanceID)==0.0) ? 1.0 : 0.0;
#endif
v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,out_fade_opacity,is_sdf);}`),terrainRaster:ri(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;
#endif
uniform vec3 u_ground_shadow_factor;void main() {vec4 image_color=texture2D(u_image0,v_pos0);vec4 color;
#ifdef LIGHTING_3D_MODE
const vec3 normal=vec3(0.0,0.0,1.0);
#ifdef RENDER_SHADOWS
float cutoffOpacity=1.0;
#ifdef RENDER_CUTOFF
cutoffOpacity=cutoff_opacity(u_cutoff_params,v_depth);
#endif
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
vec3 unlit_base=image_color.rgb*(1.0-image_color.a);vec3 emissive_base=image_color.rgb*image_color.a;float ndotl=u_shadow_direction.z;float occlusion=ndotl < 0.0 ? 1.0 : shadow_occlusion(v_pos_light_view_0,v_pos_light_view_1,v_depth,0.0);ndotl=max(0.0,ndotl);vec3 lit=apply_lighting(unlit_base,normal,mix(1.0,(1.0-(u_shadow_intensity*occlusion))*ndotl,cutoffOpacity));vec3 emissive=compute_emissive_draped(emissive_base,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=lit+emissive;color.a=1.0;
#else
float lighting_factor=shadowed_light_factor_normal_unbiased(normal,v_pos_light_view_0,v_pos_light_view_1,v_depth);color=apply_lighting(image_color,normal,mix(1.0,lighting_factor,cutoffOpacity));
#endif
#else
float lighting_factor=u_lighting_directional_dir.z;color=apply_lighting(image_color,normal,lighting_factor);
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color.rgb=mix(color.rgb,image_color.rgb,image_color.a);color.a=1.0;
#endif
#endif
#else
color=image_color;
#endif
#ifdef FOG
#ifdef ZERO_EXAGGERATION
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#else
color=fog_dither(fog_apply_from_vert(color,v_fog_opacity));
#endif
#endif
gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;uniform float u_skirt_height;attribute vec2 a_pos;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;
#endif
void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;v_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);
#ifdef FOG
#ifdef ZERO_EXAGGERATION
v_fog_pos=fog_position(decodedPos);
#else
v_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));
#endif
#endif
#ifdef RENDER_SHADOWS
vec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);v_depth=gl_Position.w;
#endif
}`),terrainDepth:ri(`#ifdef GL_ES
precision highp float;
#endif
varying float v_depth;void main() {gl_FragColor=pack_depth(v_depth);}`,`#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;attribute vec2 a_pos;varying float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}`),skybox:ri(`#include "_prelude_fog.fragment.glsl"
varying lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(
cos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=textureCube(u_cubemap,uv).rgb;
#ifdef FOG
sky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);
#endif
sky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);gl_FragColor=vec4(sky_color*u_opacity,u_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,dO),skyboxGradient:ri(`#include "_prelude_fog.fragment.glsl"
varying highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture2D(u_color_ramp,vec2(progress,0.5));
#ifdef FOG
color.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;
#endif
color*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,dO),skyboxCapture:ri(`
varying highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;
#ifdef GL_ES
precision highp float;
#endif
#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)
#define BETA_M                  vec3(21e-6,21e-6,21e-6)
#define MIE_G                   0.76
#define DENSITY_HEIGHT_SCALE_R  8000.0
#define DENSITY_HEIGHT_SCALE_M  1200.0
#define PLANET_RADIUS           6360e3
#define ATMOSPHERE_RADIUS       6420e3
#define SAMPLE_STEPS            10
#define DENSITY_STEPS           4
float ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;gl_FragColor=vec4(color,1.0);}`,"attribute highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;varying highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:ri(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;varying vec2 v_pos0;
#ifndef FOG
uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;
#endif
void main() {vec4 color;
#ifdef CUSTOM_ANTIALIASING
vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture2D(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
raster=apply_lighting_with_emission_ground(raster,raster.a);color=vec4(raster.rgb*antialias,antialias);
#else
raster=apply_lighting_ground(raster);color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=texture2D(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color=apply_lighting_with_emission_ground(color,color.a);color.a=1.0;
#else
color=apply_lighting_ground(color);
#endif
#endif
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;
#ifdef GLOBE_POLES
attribute vec3 a_globe_pos;attribute vec2 a_uv;
#else
attribute vec2 a_pos;
#endif
varying vec2 v_pos0;float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(QUARTER_PI+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}void main() {
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;vec2 uv=a_uv;
#else
float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);
#endif
v_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;
#ifdef GLOBE_POLES
vec3 up_vector=globe_derived_up_vector;
#else
vec3 up_vector=elevationVector(tile_pos);
#endif
float height=elevation(tile_pos);globe_pos+=up_vector*height;
#ifndef GLOBE_POLES
globe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;
#endif
#ifdef GLOBE_POLES
vec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);
#else
vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);
#endif
gl_Position=u_proj_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
}`),globeAtmosphere:ri(`#include "_prelude_fog.fragment.glsl"
uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec4 u_color;uniform vec4 u_high_color;uniform vec4 u_space_color;uniform float u_horizon_angle;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;
#ifdef PROJECTION_GLOBE_VIEW
globe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {
#ifdef ALPHA_PASS
gl_FragColor=vec4(0,0,0,0);return;
#else
#ifdef NATIVE
gl_FragColor=vec4(1,1,1,1);
#else
gl_FragColor=vec4(0,0,0,1);
#endif
return;
#endif
}
#endif
highp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?
0.0 : max(acos(clamp(dot(dir,horizon_dir),-1.0,1.0)),0.0);float horizon_angle;
#ifdef PROJECTION_GLOBE_VIEW
highp vec3 closest_point=globe_pos_dot_dir*dir;highp float closest_point_to_center=length(closest_point-u_globe_pos);highp float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?
PI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);
#else
horizon_angle=horizon_angle_mercator;
#endif
horizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;
#ifdef ALPHA_PASS
float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);gl_FragColor=vec4(1.0,1.0,1.0,a);
#else
vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c=c2;
#ifndef NATIVE
c=dither(c,gl_FragCoord.xy+u_temporal_offset);
#endif
gl_FragColor=vec4(c*t,t);
#endif
}`,`attribute vec3 a_pos;attribute vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(
mix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}`),model:ri(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform float u_opacity;uniform vec3 u_lightcolor;uniform vec3 u_lightpos;uniform float u_lightintensity;uniform vec4 u_baseColorFactor;uniform vec4 u_emissiveFactor;uniform float u_metallicFactor;uniform float u_roughnessFactor;uniform float u_emissive_strength;varying highp vec4 v_position_height;varying lowp vec4 v_color_mix;
#ifdef RENDER_SHADOWS
varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth_shadows;
#endif
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#ifdef HAS_ATTRIBUTE_a_pbr
varying lowp vec4 v_roughness_metallic_emissive_alpha;varying mediump vec4 v_height_based_emission_params;
#endif
#ifdef HAS_TEXTURE_u_baseColorTexture
uniform sampler2D u_baseColorTexture;uniform bool u_baseTextureIsAlpha;uniform bool u_alphaMask;uniform float u_alphaCutoff;
#endif
#ifdef HAS_TEXTURE_u_metallicRoughnessTexture
uniform sampler2D u_metallicRoughnessTexture;
#endif
#ifdef HAS_TEXTURE_u_occlusionTexture
uniform sampler2D u_occlusionTexture;uniform float u_aoIntensity;
#endif
#ifdef HAS_TEXTURE_u_normalTexture
uniform sampler2D u_normalTexture;
#endif
#ifdef HAS_TEXTURE_u_emissionTexture
uniform sampler2D u_emissionTexture;
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
varying highp float v_depth;uniform sampler2D u_depthTexture;uniform vec2 u_inv_depth_size;bool isOccluded() {vec2 coord=gl_FragCoord.xy*u_inv_depth_size;highp float depth=unpack_depth(texture2D(u_depthTexture,coord));return v_depth > depth+0.0005;}
#endif
const float M_PI=3.141592653589793;
#define saturate(_x) clamp(_x,0.,1.)
float calculate_NdotL(vec3 normal,vec3 lightDir) {const float ext=0.70710678118;return (clamp(dot(normal,lightDir),-ext,1.0)+ext)/(1.0+ext);}vec3 getDiffuseShadedColor(vec3 albedo,vec3 normal,vec3 lightDir,vec3 lightColor)
{
#ifdef LIGHTING_3D_MODE
vec3 transformed_normal=vec3(-normal.xy,normal.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=saturate(dot(transformed_normal,u_lighting_directional_dir));
#endif
return apply_lighting(albedo,transformed_normal,lighting_factor);
#else
vec3 n=normal;float colorvalue=((albedo.x*0.2126)+(albedo.y*0.7152))+(albedo.z*0.0722);vec3 c=vec3(0.03,0.03,0.03);float directional=clamp(dot(n,vec3(lightDir)),0.0,1.0);directional=mix(1.0-u_lightintensity,max((1.0-colorvalue)+u_lightintensity,1.0),directional);vec3 c3=c+clamp((albedo*directional)*lightColor,mix(vec3(0.0),vec3(0.3),vec3(1.0)-lightColor),vec3(1.0));return c3;
#endif
}vec4 getBaseColor() {vec4 albedo=u_baseColorFactor;
#ifdef HAS_ATTRIBUTE_a_color_3f
albedo*=vec4(color_3f,1.0);
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#else
#ifdef HAS_ATTRIBUTE_a_color_4f
albedo*=color_4f;
#endif
#endif
#if defined (HAS_TEXTURE_u_baseColorTexture) && defined (HAS_ATTRIBUTE_a_uv_2f)
vec4 texColor=texture2D(u_baseColorTexture,uv_2f);if(u_alphaMask) {if (texColor.w < u_alphaCutoff) {discard;}}
#ifdef UNPREMULT_TEXTURE_IN_SHADER
if(texColor.w > 0.0) {texColor.rgb/=texColor.w;}texColor.w=1.0;
#endif
texColor.rgb=sRGBToLinear(texColor.rgb);if(u_baseTextureIsAlpha) {if (texColor.w < 0.5) {discard;}albedo*=mix(vec4(texColor.rgb,texColor.a),vec4(texColor.a),float(u_baseTextureIsAlpha));} else {albedo*=texColor;}
#endif
return vec4(mix(albedo.rgb,v_color_mix.rgb,v_color_mix.a),albedo.a);}highp mat3 cotangentFrame(highp vec3 N,highp vec3 p,highp vec2 uv ) {
#ifdef HAS_TEXTURE_u_normalTexture
highp vec3 dp1=vec3(dFdx(p.x),dFdx(p.y),dFdx(p.z));highp vec3 dp2=vec3(dFdy(p.x),dFdy(p.y),dFdy(p.z));highp vec2 duv1=vec2(dFdx(uv.x),dFdx(uv.y));highp vec2 duv2=vec2(dFdy(uv.x),dFdy(uv.y));highp vec3 dp2perp=cross( dp2,N );highp vec3 dp1perp=cross( N,dp1 );highp vec3 T=dp2perp*duv1.x+dp1perp*duv2.x;highp vec3 B=dp2perp*duv1.y+dp1perp*duv2.y;highp float lengthT=dot(T,T);highp float lengthB=dot(B,B);highp float maxLength=max(lengthT,lengthB);highp float invmax=inversesqrt( maxLength );highp mat3 res=mat3( T*invmax,B*invmax,N );return res;
#else
return mat3(1.0);
#endif
}highp vec3 getNormal(){highp vec3 n;
#ifdef HAS_ATTRIBUTE_a_normal_3f
n=normalize(normal_3f);
#else
highp vec3 fdx=vec3(dFdx(v_position_height.x),dFdx(v_position_height.y),dFdx(v_position_height.z));highp vec3 fdy=vec3(dFdy(v_position_height.x),dFdy(v_position_height.y),dFdy(v_position_height.z));n=normalize(cross(fdx,fdy))*-1.0;
#endif
#if defined(HAS_TEXTURE_u_normalTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
vec3 nMap=texture2D( u_normalTexture,uv_2f).xyz;nMap=normalize(2.0*nMap-vec3(1.0));highp vec3 v=normalize(-v_position_height.xyz);highp mat3 TBN=cotangentFrame(n,v,uv_2f);n=normalize(TBN*nMap);
#endif
return n;}struct Material {float perceptualRoughness;float alphaRoughness;float metallic;vec3 f90;vec4 baseColor;vec3 diffuseColor;vec3 specularColor;highp vec3 normal;};Material getPBRMaterial() {Material mat;mat.baseColor=getBaseColor();mat.perceptualRoughness=u_roughnessFactor;mat.metallic=u_metallicFactor;
#ifdef HAS_ATTRIBUTE_a_pbr
mat.perceptualRoughness=v_roughness_metallic_emissive_alpha.x;mat.metallic=v_roughness_metallic_emissive_alpha.y;mat.baseColor.w*=v_roughness_metallic_emissive_alpha.w;
#endif
#if defined(HAS_TEXTURE_u_metallicRoughnessTexture) && defined(HAS_ATTRIBUTE_a_uv_2f) 
vec4 mrSample=texture2D(u_metallicRoughnessTexture,uv_2f);mat.perceptualRoughness*=mrSample.g;mat.metallic*=mrSample.b;
#endif
const float c_minRoughness=0.04;mat.perceptualRoughness=clamp(mat.perceptualRoughness,c_minRoughness,1.0);mat.metallic=saturate(mat.metallic);mat.alphaRoughness=mat.perceptualRoughness*mat.perceptualRoughness;const vec3 f0=vec3(0.04);mat.diffuseColor=mat.baseColor.rgb*(vec3(1.0)-f0);mat.diffuseColor*=1.0-mat.metallic;mat.specularColor=mix(f0,mat.baseColor.rgb,mat.metallic);highp float reflectance=max(max(mat.specularColor.r,mat.specularColor.g),mat.specularColor.b);highp float reflectance90=saturate(reflectance*25.0);mat.f90=vec3(reflectance90);mat.normal=getNormal();return mat;}float V_GGX(float NdotL,float NdotV,float roughness)
{float a2=roughness*roughness;float GGXV=NdotL*sqrt(NdotV*NdotV*(1.0-a2)+a2);float GGXL=NdotV*sqrt(NdotL*NdotL*(1.0-a2)+a2);return 0.5/(GGXV+GGXL);}float V_GGXFast(float NdotL,float NdotV,float roughness) {float a=roughness;float GGXV=NdotL*(NdotV*(1.0-a)+a);float GGXL=NdotV*(NdotL*(1.0-a)+a);return 0.5/(GGXV+GGXL);}vec3 F_Schlick(vec3 specularColor,vec3 f90,float VdotH)
{return specularColor+(f90-specularColor)*pow(clamp(1.0-VdotH,0.0,1.0),5.0);}vec3 F_SchlickFast(vec3 specularColor,float VdotH)
{float x=1.0-VdotH;float x4=x*x*x*x;return specularColor+(1.0-specularColor)*x4*x;}float D_GGX(highp float NdotH,float alphaRoughness)
{highp float a4=alphaRoughness*alphaRoughness;highp float f=(NdotH*a4-NdotH)*NdotH+1.0;return a4/(M_PI*f*f);}vec3 diffuseBurley(Material mat,float LdotH,float NdotL,float NdotV)
{float f90=2.0*LdotH*LdotH*mat.alphaRoughness-0.5;return (mat.diffuseColor/M_PI)*(1.0+f90*pow((1.0-NdotL),5.0))*(1.0+f90*pow((1.0-NdotV),5.0));}vec3 diffuseLambertian(Material mat)
{
#ifdef LIGHTING_3D_MODE
return mat.diffuseColor;
#else
return mat.diffuseColor/M_PI;
#endif
}vec3 EnvBRDFApprox(vec3 specularColor,float roughness,highp float NdotV)
{vec4 c0=vec4(-1,-0.0275,-0.572,0.022);vec4 c1=vec4(1,0.0425,1.04,-0.04);highp vec4 r=roughness*c0+c1;highp float a004=min(r.x*r.x,exp2(-9.28*NdotV))*r.x+r.y;vec2 AB=vec2(-1.04,1.04)*a004+r.zw;return specularColor*AB.x+AB.y;}vec3 computeIndirectLightContribution(Material mat,float NdotV,vec3 normal)
{vec3 env_light=vec3(0.65,0.65,0.65);
#ifdef LIGHTING_3D_MODE
float ambient_factor=calculate_ambient_directional_factor(normal);env_light=u_lighting_ambient_color*ambient_factor;
#endif
vec3 envBRDF=EnvBRDFApprox(mat.specularColor,mat.perceptualRoughness,NdotV);vec3 indirectSpecular= envBRDF*env_light;vec3 indirectDiffuse=mat.diffuseColor*env_light;return indirectSpecular+indirectDiffuse;}vec3 computeLightContribution(Material mat,vec3 lightPosition,vec3 lightColor)
{highp vec3 n=mat.normal;highp vec3 v=normalize(-v_position_height.xyz);highp vec3 l=normalize(lightPosition);highp vec3 h=normalize(v+l);float NdotV=clamp(abs(dot(n,v)),0.001,1.0);float NdotL=saturate(dot(n,l));highp float NdotH=saturate(dot(n,h));float VdotH=saturate(dot(v,h));vec3 f=F_SchlickFast(mat.specularColor,VdotH);float g=V_GGXFast(NdotL,NdotV,mat.alphaRoughness);float d=D_GGX(NdotH,mat.alphaRoughness);vec3 diffuseTerm=(1.0-f)*diffuseLambertian(mat);vec3 specularTerm=f*g*d;vec3 transformed_normal=vec3(-n.xy,n.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=NdotL;
#endif
vec3 directLightColor=(specularTerm+diffuseTerm)*lighting_factor*lightColor;vec3 indirectLightColor=computeIndirectLightContribution(mat,NdotV,transformed_normal);vec3 color=(saturate(directLightColor)+indirectLightColor);float intensityFactor=1.0;
#if !defined(LIGHTING_3D_MODE)
const vec3 luminosityFactor=vec3(0.2126,0.7152,0.0722);float luminance=dot(diffuseTerm,luminosityFactor);intensityFactor=mix((1.0-u_lightintensity),max((1.0-luminance+u_lightintensity),1.0),NdotL);
#endif
color*=intensityFactor;return color;}void main() {
#ifdef TERRAIN_FRAGMENT_OCCLUSION
if (isOccluded()) {discard;}
#endif
vec3 lightDir=u_lightpos;vec3 lightColor=u_lightcolor;
#ifdef LIGHTING_3D_MODE
lightDir=u_lighting_directional_dir;lightDir.xy=-lightDir.xy;lightColor=u_lighting_directional_color;
#endif
vec4 finalColor;
#ifdef DIFFUSE_SHADED
vec3 N=getNormal();vec3 diffuse=getDiffuseShadedColor(getBaseColor().rgb,N,lightDir,lightColor);
#ifdef HAS_TEXTURE_u_occlusionTexture
float ao=(texture2D(u_occlusionTexture,uv_2f).r-1.0)*u_aoIntensity+1.0;diffuse*=ao;
#endif
finalColor=vec4(diffuse,1.0)*u_opacity;
#else
Material mat=getPBRMaterial();vec3 color=computeLightContribution(mat,lightDir,lightColor);
#if defined (HAS_TEXTURE_u_occlusionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
float ao=(texture2D(u_occlusionTexture,uv_2f).x-1.0)*u_aoIntensity+1.0;color*=ao;
#endif
vec4 emissive=u_emissiveFactor;
#if defined(HAS_TEXTURE_u_emissionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
emissive.rgb*=sRGBToLinear(texture2D(u_emissionTexture,uv_2f).rgb);
#endif
color+=emissive.rgb;float opacity=mat.baseColor.w*u_opacity;
#ifdef HAS_ATTRIBUTE_a_pbr
float resEmission=v_roughness_metallic_emissive_alpha.z;resEmission*=v_height_based_emission_params.z+v_height_based_emission_params.w*pow(clamp(v_height_based_emission_params.x,0.0,1.0),v_height_based_emission_params.y);color=mix(color,v_color_mix.rgb,min(1.0,resEmission));
#ifdef HAS_ATTRIBUTE_a_color_4f
float distance=length(vec2(1.3*max(0.0,abs(color_4f.x)-color_4f.z),color_4f.y));distance+= mix(0.5,0.0,clamp(resEmission-1.0,0.0,1.0));opacity*=v_roughness_metallic_emissive_alpha.w*saturate(1.0-distance*distance);
#endif
#endif
color=mix(color,mat.baseColor.rgb,u_emissive_strength);color=linearTosRGB(color);color*=opacity;finalColor=vec4(color,opacity);
#endif
#ifdef FOG
finalColor=fog_dither(fog_apply_premultiplied(finalColor,v_fog_pos,v_position_height.w));
#endif
#ifdef RENDER_CUTOFF
finalColor*=v_cutoff_opacity;
#endif
#ifdef INDICATOR_CUTOUT
finalColor=applyCutout(finalColor);
#endif
gl_FragColor=finalColor;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
attribute vec3 a_pos_3f;
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute-vertex-shader-only highp vec4 pbr
#pragma mapbox: define-attribute-vertex-shader-only highp vec3 heightBasedEmissiveStrength
uniform mat4 u_matrix;uniform mat4 u_lighting_matrix;uniform vec3 u_camera_pos;uniform vec4 u_color_mix;
#ifdef INSTANCED_ARRAYS
attribute vec4 a_normal_matrix0;attribute vec4 a_normal_matrix1;attribute vec4 a_normal_matrix2;attribute vec4 a_normal_matrix3;
#else
uniform highp mat4 u_normal_matrix;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth_shadows;
#endif
varying vec4 v_position_height;varying lowp vec4 v_color_mix;
#ifdef TERRAIN_FRAGMENT_OCCLUSION
varying highp float v_depth;
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
varying lowp vec4 v_roughness_metallic_emissive_alpha;varying mediump vec4 v_height_based_emission_params;
#endif
void main() {
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute-custom highp vec4 pbr
#pragma mapbox: initialize-attribute-custom highp vec3 heightBasedEmissiveStrength
highp mat4 normal_matrix;
#ifdef INSTANCED_ARRAYS
normal_matrix=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
normal_matrix=u_normal_matrix;
#endif
vec3 local_pos;mat3 rs;
#ifdef MODEL_POSITION_ON_GPU
vec3 pos_color=normal_matrix[0].xyz;vec4 translate=normal_matrix[1];vec3 pos_a=floor(pos_color);vec3 rgb=1.05*(pos_color-pos_a);float color_mix=pos_a.z/100.0;v_color_mix=vec4(sRGBToLinear(rgb),color_mix);float meter_to_tile=normal_matrix[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);rs[0].x=normal_matrix[1].w;rs[0].yz=normal_matrix[2].xy;rs[1].xy=normal_matrix[2].zw;rs[1].z=normal_matrix[3].x;rs[2].xyz=normal_matrix[3].yzw;vec4 pos_node=u_lighting_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;local_pos=pos.xyz;gl_Position=u_matrix*pos;pos.z*=meter_to_tile;v_position_height.xyz=pos.xyz-u_camera_pos;
#else
local_pos=a_pos_3f;gl_Position=u_matrix*vec4(a_pos_3f,1);v_position_height.xyz=vec3(u_lighting_matrix*vec4(a_pos_3f,1));v_color_mix=vec4(sRGBToLinear(u_color_mix.rgb),u_color_mix.a);
#endif
v_position_height.w=a_pos_3f.z;
#ifdef HAS_ATTRIBUTE_a_pbr
vec4 albedo_c=decode_color(pbr.xy);vec2 e_r_m=unpack_float(pbr.z);vec2 r_m= unpack_float(e_r_m.y*16.0);r_m.r=r_m.r*16.0;v_color_mix=vec4(albedo_c.rgb,1.0);v_roughness_metallic_emissive_alpha=vec4(vec3(r_m,e_r_m.x)/255.0,albedo_c.a);v_roughness_metallic_emissive_alpha.z*=2.0;float heightBasedRelativeIntepolation=a_pos_3f.z*heightBasedEmissiveStrength.x+heightBasedEmissiveStrength.y;v_height_based_emission_params.x=heightBasedRelativeIntepolation;v_height_based_emission_params.y=heightBasedEmissiveStrength.z;vec2 emissionMultiplierValues=unpack_float(pbr.w)/256.0;v_height_based_emission_params.z=emissionMultiplierValues.x;v_height_based_emission_params.w=emissionMultiplierValues.y-emissionMultiplierValues.x;
#endif
#ifdef FOG
v_fog_pos=fog_position(local_pos);
#endif
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
float x_squared_scale=dot(rs[0],rs[0]);float y_squared_scale=dot(rs[1],rs[1]);float z_squared_scale=dot(rs[2],rs[2]);vec3 squared_scale=vec3(x_squared_scale,y_squared_scale,z_squared_scale);normal_3f=rs*((u_lighting_matrix*vec4(normal_3f,0.0)).xyz/squared_scale);normal_3f=normalize(normal_3f);
#else
normal_3f=vec3(normal_matrix*vec4(normal_3f,0));
#endif
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#ifdef HAS_ATTRIBUTE_a_color_4f
v_roughness_metallic_emissive_alpha.w=clamp(color_4f.a*v_roughness_metallic_emissive_alpha.w*(v_roughness_metallic_emissive_alpha.z-1.0),0.0,1.0);
#endif
#endif
#ifdef RENDER_SHADOWS
vec3 shadow_pos=local_pos;
#ifdef NORMAL_OFFSET
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
vec3 offset=shadow_normal_offset(vec3(-normal_3f.xy,normal_3f.z));shadow_pos+=offset*shadow_normal_offset_multiplier0();
#else
vec3 offset=shadow_normal_offset_model(normalize(normal_3f));shadow_pos+=offset*shadow_normal_offset_multiplier0();
#endif
#endif
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shadow_pos,1);v_pos_light_view_1=u_light_matrix_1*vec4(shadow_pos,1);v_depth_shadows=gl_Position.w;
#endif
}`),modelDepth:ri(`varying highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
gl_FragColor=pack_depth(v_depth);
#endif
}`,`attribute vec3 a_pos_3f;uniform mat4 u_matrix;varying highp float v_depth;
#ifdef MODEL_POSITION_ON_GPU
#ifdef INSTANCED_ARRAYS
attribute vec4 a_normal_matrix0;attribute vec4 a_normal_matrix1;attribute vec4 a_normal_matrix2;attribute vec4 a_normal_matrix3;
#else
uniform highp mat4 u_instance;
#endif
uniform highp mat4 u_node_matrix;
#endif
void main() {
#ifdef MODEL_POSITION_ON_GPU
highp mat4 instance;
#ifdef INSTANCED_ARRAYS
instance=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
instance=u_instance;
#endif
vec3 pos_color=instance[0].xyz;vec4 translate=instance[1];vec3 pos_a=floor(pos_color);float meter_to_tile=instance[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);mat3 rs;rs[0].x=instance[1].w;rs[0].yz=instance[2].xy;rs[1].xy=instance[2].zw;rs[1].z=instance[3].x;rs[2].xyz=instance[3].yzw;vec4 pos_node=u_node_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;gl_Position=u_matrix*pos;
#else
gl_Position=u_matrix*vec4(a_pos_3f,1);
#endif
v_depth=gl_Position.z/gl_Position.w;}`),stars:ri(`varying highp vec2 v_uv;varying mediump float v_intensity;float shapeCircle(in vec2 uv)
{float beginFade=0.6;float lengthFromCenter=length(v_uv);return 1.0-clamp((lengthFromCenter-beginFade)/(1.0-beginFade),0.0,1.0);}void main() {float alpha=shapeCircle(v_uv);vec3 color=vec3(1.0,1.0,1.0);alpha*=v_intensity;gl_FragColor=vec4(color*alpha,alpha);HANDLE_WIREFRAME_DEBUG;}`,`
attribute vec3 a_pos_3f;attribute vec2 a_uv;attribute float a_size_scale;attribute float a_fade_opacity;uniform mat4 u_matrix;uniform vec3 u_up;uniform vec3 u_right;uniform float u_intensity_multiplier;varying highp vec2 v_uv;varying mediump float v_intensity;void main() {v_uv=a_uv;v_intensity=a_fade_opacity*u_intensity_multiplier;vec3 pos=a_pos_3f;pos+=a_uv.x*u_right*a_size_scale;pos+=a_uv.y*u_up*a_size_scale;gl_Position=u_matrix*vec4(pos,1.0);}`)};function by(r,e){const i=r.replace(/\s*\/\/[^\n]*\n/g,`
`).split(`
`);for(let o of i)if(o=o.trim(),o[0]==="#"&&o.includes("if")&&!o.includes("endif")){o=o.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const l=o.split(" ");for(const u of l)e.includes(u)||e.push(u)}}function ri(r,e){const i=/#include\s+"([^"]+)"/g,o=/#pragma mapbox: ([\w\-]+) ([\w]+) ([\w]+) ([\w]+)/g;let l=e.match(/attribute(\S*) (highp |mediump |lowp )?([\w]+) ([\w]+)/g);l&&(l=l.filter((v,x)=>l.indexOf(v)===x));const u={},h=[],m=[];r=r.replace(i,(v,x)=>(m.push(x),"")),e=e.replace(i,(v,x)=>(h.push(x),""));let _=[...yO];by(r,_),by(e,_);for(const v of[...h,...m])yy[v]||console.error(`Undefined include: ${v}`),xy[v]||(xy[v]=[],by(yy[v],xy[v])),_=[..._,...xy[v]];return{fragmentSource:r=r.replace(o,(v,x,w,C,k)=>(u[k]=!0,x==="define"?`
#ifndef HAS_UNIFORM_u_${k}
varying ${w} ${C} ${k};
#else
uniform ${w} ${C} u_${k};
#endif
`:x==="initialize"?`
#ifdef HAS_UNIFORM_u_${k}
    ${w} ${C} ${k} = u_${k};
#endif
`:x==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${k}
    varying ${w} ${C} ${k};
#endif
`:x==="initialize-attribute"?"":void 0)),vertexSource:e=e.replace(o,(v,x,w,C,k)=>{const P=C==="float"?"vec2":C,R=k.match(/color/)?"color":P;return x==="define-attribute-vertex-shader-only"?`
#ifdef HAS_ATTRIBUTE_a_${k}
attribute ${w} ${C} a_${k};
#endif
`:u[k]?x==="define"?`
#ifndef HAS_UNIFORM_u_${k}
uniform lowp float u_${k}_t;
attribute ${w} ${P} a_${k};
varying ${w} ${C} ${k};
#else
uniform ${w} ${C} u_${k};
#endif
`:x==="initialize"?R==="vec4"?`
#ifndef HAS_UNIFORM_u_${k}
    ${k} = a_${k};
#else
    ${w} ${C} ${k} = u_${k};
#endif
`:`
#ifndef HAS_UNIFORM_u_${k}
    ${k} = unpack_mix_${R}(a_${k}, u_${k}_t);
#else
    ${w} ${C} ${k} = u_${k};
#endif
`:x==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${k}
    attribute ${w} ${C} a_${k};
    varying ${w} ${C} ${k};
#endif
`:x==="initialize-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${k}
    ${k} = a_${k};
#endif
`:void 0:x==="define"?`
#ifndef HAS_UNIFORM_u_${k}
uniform lowp float u_${k}_t;
attribute ${w} ${P} a_${k};
#else
uniform ${w} ${C} u_${k};
#endif
`:x==="define-instanced"?R==="mat4"?`
#ifdef INSTANCED_ARRAYS
attribute vec4 a_${k}0;
attribute vec4 a_${k}1;
attribute vec4 a_${k}2;
attribute vec4 a_${k}3;
#else
uniform ${w} ${C} u_${k};
#endif
`:`
#ifdef INSTANCED_ARRAYS
attribute ${w} ${P} a_${k};
#else
uniform ${w} ${C} u_${k};
#endif
`:x==="initialize-attribute-custom"?`
#ifdef HAS_ATTRIBUTE_a_${k}
    ${w} ${C} ${k} = a_${k};
#endif
`:R==="vec4"?`
#ifndef HAS_UNIFORM_u_${k}
    ${w} ${C} ${k} = a_${k};
#else
    ${w} ${C} ${k} = u_${k};
#endif
`:`
#ifndef HAS_UNIFORM_u_${k}
    ${w} ${C} ${k} = unpack_mix_${R}(a_${k}, u_${k}_t);
#else
    ${w} ${C} ${k} = u_${k};
#endif
`}),staticAttributes:l,usedDefines:_,vertexIncludes:h,fragmentIncludes:m}}class mq{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(e,i,o,l,u,h,m,_){this.context=e;let v=this.boundPaintVertexBuffers.length!==l.length;for(let w=0;!v&&w<l.length;w++)this.boundPaintVertexBuffers[w]!==l[w]&&(v=!0);let x=this.boundDynamicVertexBuffers.length!==m.length;for(let w=0;!x&&w<m.length;w++)this.boundDynamicVertexBuffers[w]!==m[w]&&(x=!0);if(!this.vao||this.boundProgram!==i||this.boundLayoutVertexBuffer!==o||v||x||this.boundIndexBuffer!==u||this.boundVertexOffset!==h)this.freshBind(i,o,l,u,h,m,_);else{e.bindVertexArrayOES.set(this.vao);for(const w of m)w&&(w.bind(),_&&w.instanceCount&&w.setVertexAttribDivisor(e.gl,i,_));u&&u.dynamicDraw&&u.bind()}}freshBind(e,i,o,l,u,h,m){const _=e.numAttributes,v=this.context,x=v.gl;this.vao&&this.destroy(),this.vao=v.gl.createVertexArray(),v.bindVertexArrayOES.set(this.vao),this.boundProgram=e,this.boundLayoutVertexBuffer=i,this.boundPaintVertexBuffers=o,this.boundIndexBuffer=l,this.boundVertexOffset=u,this.boundDynamicVertexBuffers=h,i.enableAttributes(x,e),i.bind(),i.setVertexAttribPointers(x,e,u);for(const w of o)w.enableAttributes(x,e),w.bind(),w.setVertexAttribPointers(x,e,u);for(const w of h)w&&(w.enableAttributes(x,e),w.bind(),w.setVertexAttribPointers(x,e,u),m&&w.instanceCount&&w.setVertexAttribDivisor(x,e,m));l&&l.bind(),v.currentNumAttributes=_}destroy(){this.vao&&(this.context.gl.deleteVertexArray(this.vao),this.vao=null)}}function gq(r,e){const i=Math.pow(2,e.canonical.z),o=e.canonical.y;return[new Pn(0,o/i).toLngLat().lat,new Pn(0,(o+1)/i).toLngLat().lat]}function _q(r,e,i,o,l,u,h){const m=r.context,_=m.gl,v=i.hillshadeFBO;if(!v)return;r.prepareDrawTile();const x=r.isTileAffectedByFog(e),w=r.getOrCreateProgram("hillshade",{overrideFog:x});m.activeTexture.set(_.TEXTURE0),_.bindTexture(_.TEXTURE_2D,v.colorAttachment.get());const C=((z,B,H,Z)=>{const Y=H.paint.get("hillshade-shadow-color"),q=H.paint.get("hillshade-highlight-color"),ee=H.paint.get("hillshade-accent-color"),ce=H.paint.get("hillshade-emissive-strength");let de=le(H.paint.get("hillshade-illumination-direction"));if(H.paint.get("hillshade-illumination-anchor")==="viewport")de-=z.transform.angle;else if(z.style&&z.style.enable3dLights()&&z.style.directionalLight){const ve=z.style.directionalLight.properties.get("direction");de=le(Xe(ve.x,ve.y,ve.z)[1])}const ge=!z.options.moving;return{u_matrix:Z||z.transform.calculateProjMatrix(B.tileID.toUnwrapped(),ge),u_image:0,u_latrange:gq(0,B.tileID),u_light:[H.paint.get("hillshade-exaggeration"),de],u_shadow:Y,u_highlight:q,u_emissive_strength:ce,u_accent:ee}})(r,i,o,r.terrain?e.projMatrix:null);r.uploadCommonUniforms(m,w,e.toUnwrapped());const{tileBoundsBuffer:k,tileBoundsIndexBuffer:P,tileBoundsSegments:R}=r.getTileBoundsBuffers(i);w.draw(r,_.TRIANGLES,l,u,h,Cn.disabled,C,o.id,k,P,R)}function EO(r,e,i){if(!e.needsDEMTextureUpload)return;const o=r.context,l=o.gl;o.pixelStoreUnpackPremultiplyAlpha.set(!1),e.demTexture=e.demTexture||r.getTileTexture(i.stride);const u=i.getPixels();e.demTexture?e.demTexture.update(u,{premultiply:!1}):e.demTexture=new Ia(o,u,r.terrainUseFloatDEM()?l.R32F:l.RGBA,{premultiply:!1}),e.needsDEMTextureUpload=!1}function vq(r,e,i){const o=r.context,l=o.gl;if(!e.dem)return;const u=e.dem;if(o.activeTexture.set(l.TEXTURE1),EO(r,e,u),!e.demTexture)return;e.demTexture.bind(l.NEAREST,l.CLAMP_TO_EDGE);const h=u.dim;o.activeTexture.set(l.TEXTURE0);let m=e.hillshadeFBO;if(!m){const C=new Ia(o,{width:h,height:h,data:null},l.RGBA);C.bind(l.LINEAR,l.CLAMP_TO_EDGE),m=e.hillshadeFBO=o.createFramebuffer(h,h,!0,"renderbuffer"),m.colorAttachment.set(C.texture)}o.bindFramebuffer.set(m.framebuffer),o.viewport.set([0,0,h,h]);const{tileBoundsBuffer:_,tileBoundsIndexBuffer:v,tileBoundsSegments:x}=r.getMercatorTileBoundsBuffers(),w=[];r.terrainUseFloatDEM()&&w.push("TERRAIN_DEM_FLOAT_FORMAT"),r.getOrCreateProgram("hillshadePrepare",{defines:w}).draw(r,l.TRIANGLES,Zr.disabled,wn.disabled,Nn.unblended,Cn.disabled,((C,k)=>{const P=k.stride,R=dt.create();return dt.ortho(R,0,Et,-Et,0,0,1),dt.translate(R,R,[0,-Et,0]),{u_matrix:R,u_image:1,u_dimension:[P,P],u_zoom:C.overscaledZ,u_unpack:k.unpackVector}})(e.tileID,u),i.id,_,v,x),e.needsHillshadePrepare=!1}const TO=r=>({u_matrix:new an(r),u_image0:new bn(r),u_skirt_height:new Zt(r),u_ground_shadow_factor:new sn(r)}),SO=(r,e,i)=>({u_matrix:r,u_image0:0,u_skirt_height:e,u_ground_shadow_factor:i}),CO=(r,e,i,o,l,u,h,m,_,v,x,w,C,k,P)=>({u_proj_matrix:Float32Array.from(r),u_globe_matrix:e,u_normalize_matrix:Float32Array.from(o),u_merc_matrix:i,u_zoom_transition:l,u_merc_center:u,u_image0:0,u_frustum_tl:h,u_frustum_tr:m,u_frustum_br:_,u_frustum_bl:v,u_globe_pos:x,u_globe_radius:w,u_viewport:C,u_grid_matrix:P?Float32Array.from(P):new Float32Array(9),u_skirt_height:k}),c0=(r,e)=>{if(e>0&&r.terrain&&se("Cutoff is currently disabled on terrain"),e<=0||r.terrain)return{shouldRenderCutoff:!1,uniformValues:{u_cutoff_params:[0,0,0,0]}};const i=r.transform,o=Math.max(Math.abs(i._zoom-(r.minCutoffZoom-1)),1),l=i.isLODDisabled(!1)?Pe(60,45,i.pitch):Pe(30,15,i.pitch),u=i._farZ-i._nearZ,h=e*i.height,m=((1-(_=l))*(.75*i.cameraToCenterDistance)+_*(i._farZ+h))*o;var _;return{shouldRenderCutoff:l<1,uniformValues:{u_cutoff_params:[i._nearZ,i._farZ,(m-i._nearZ)/u,(m-h-i._nearZ)/u]}}};function AO(r,e){return r!=null&&e!=null&&!(!r.hasData()||!e.hasData())&&r.demTexture!=null&&e.demTexture!=null&&r.tileID.key!==e.tileID.key}const u0=new class{constructor(){this.operations={}}newMorphing(r,e,i,o,l){if(r in this.operations){const u=this.operations[r];u.to.tileID.key!==i.tileID.key&&(u.queued=i)}else this.operations[r]={startTime:o,phase:0,duration:l,from:e,to:i,queued:null}}getMorphValuesForProxy(r){if(!(r in this.operations))return null;const e=this.operations[r];return{from:e.from,to:e.to,phase:e.phase}}update(r){for(const e in this.operations){const i=this.operations[e];for(i.phase=(r-i.startTime)/i.duration;i.phase>=1||!this._validOp(i);)if(!this._nextOp(i,r)){delete this.operations[e];break}}}_nextOp(r,e){return!!r.queued&&(r.from=r.to,r.to=r.queued,r.queued=null,r.phase=0,r.startTime=e,!0)}_validOp(r){return r.from.hasData()&&r.to.hasData()}},kO={0:null,1:"TERRAIN_VERTEX_MORPHING"};function IO(r,e,i){if(e===0)return 0;const o=e<1&&i===514?.25/e:1;return 6*Math.pow(1.5,22-r)*Math.max(e,1)*o}function yq(r,e){const i=1<<r.z;return!e&&(r.x===0||r.x===i-1)||r.y===0||r.y===i-1}const bT=r=>({u_matrix:r});function MO(r,e,i,o,l){if(l>0){const u=Jr.now(),h=(u-r.timeAdded)/l,m=e?(u-e.timeAdded)/l:-1,_=i.getSource(),v=o.coveringZoomLevel({tileSize:_.tileSize,roundZoom:_.roundZoom}),x=!e||Math.abs(e.tileID.overscaledZ-v)>Math.abs(r.tileID.overscaledZ-v),w=x&&r.refreshedUponExpiration?1:Oe(x?h:1-m,0,1);return r.refreshedUponExpiration&&h>=1&&(r.refreshedUponExpiration=!1),e?{opacity:1,mix:1-w}:{opacity:w,mix:0}}return{opacity:1,mix:0}}class xq extends Kl{constructor(e){const i={type:"raster-dem",maxzoom:e.transform.maxZoom},o=new pd(kg(),null),l=dT("mock-dem",i,o,e.style);super("mock-dem",l,!1),l.setEventedParent(this),this._sourceLoaded=!0}_loadTile(e,i){e.state="loaded",i(null)}}class bq extends Kl{constructor(e){const i=dT("proxy",{type:"geojson",maxzoom:e.transform.maxZoom},new pd(kg(),null),e.style);super("proxy",i,!1),i.setEventedParent(this),this.map=this.getSource().map=e,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(e,i,o){if(e.freezeTileCoverage)return;this.transform=e;const l=e.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((u,h)=>{if(u[h.key]="",!this._tiles[h.key]){const m=new gg(h,this._source.tileSize*h.overscaleFactor(),e.tileZoom);m.state="loaded",this._tiles[h.key]=m}return u},{});for(const u in this._tiles)u in l||(this.freeFBO(u),this._tiles[u].unloadVectorData(),delete this._tiles[u])}freeFBO(e){const i=this.proxyCachedFBO[e];if(i!==void 0){const o=Object.values(i);this.renderCachePool.push(...o),delete this.proxyCachedFBO[e]}}deallocRenderCache(){this.renderCache.forEach(e=>e.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class FO extends Wn{constructor(e,i,o){super(e.overscaledZ,e.wrap,e.canonical.z,e.canonical.x,e.canonical.y),this.proxyTileKey=i,this.projMatrix=o}}class wq extends eW{constructor(e,i){super(),this.painter=e,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[o,l,u]=function(_){const v=new Es,x=new Oa,w=131;v.reserve(17161),x.reserve(33800);const C=Et/128,k=Et+C/2,P=k+C;for(let z=-C;z<P;z+=C)for(let B=-C;B<P;B+=C){const H=B<0||B>k||z<0||z>k?24575:0,Z=Oe(Math.round(B),0,Et),Y=Oe(Math.round(z),0,Et);v.emplaceBack(Z+H,Y)}const R=(z,B)=>{const H=B*w+z;x.emplaceBack(H+1,H,H+w),x.emplaceBack(H+w,H+w+1,H+1)};for(let z=1;z<129;z++)for(let B=1;B<129;B++)R(B,z);return[0,129].forEach(z=>{for(let B=0;B<130;B++)R(B,z),R(z,B)}),[v,x,32768]}(),h=e.context;this.gridBuffer=h.createVertexBuffer(o,Bf.members),this.gridIndexBuffer=h.createIndexBuffer(l),this.gridSegments=ui.simpleSegment(0,0,o.length,l.length),this.gridNoSkirtSegments=ui.simpleSegment(0,0,o.length,u),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new bq(i.map),this.orthoMatrix=dt.create(),dt.ortho(this.orthoMatrix,this.painter.transform.projection.name==="globe"?.015:0,Et,0,Et,0,1);const m=h.gl;this._overlapStencilMode=new wn({func:m.GEQUAL,mask:255},0,255,m.KEEP,m.KEEP,m.REPLACE),this._previousZoom=e.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=i,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new xq(i.map),this._pendingGroundEffectLayers=[]}set style(e){e.on("data",this._onStyleDataEvent.bind(this)),this._style=e,this._style.map.on("moveend",()=>{this._clearLineLayersFromRenderCache()})}update(e,i,o){if(e&&e.terrain){this._style!==e&&(this.style=e,this._evaluationZoom=void 0);const l=e.terrain.properties,u=e.terrain.drapeRenderMode===0,h=e.terrain.isZoomDependent();this._previousUpdateTimestamp=this.enabled?this._updateTimestamp:void 0,this._updateTimestamp=Jr.now();const m=e.terrain&&e.terrain.scope,_=l.get("source"),v=u?this._mockSourceCache:e.getSourceCache(_,m);if(!v)return void se(`Couldn't find terrain source "${_}".`);if(this.sourceCache=v,this._exaggeration=h?this.calculateExaggeration(i):l.get("exaggeration"),!i.projection.requiresDraping&&h&&this._exaggeration===0)return void this._disable();this.enabled=!0;const x=()=>{this.sourceCache.used&&se(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.
This leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const w=this.getScaledDemTileSize();this.sourceCache.update(i,w,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,x(),this._initializing=!0),x(),i.updateElevation(!0,o),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(i),this._emptyDEMTextureDirty=!0,this._previousZoom=i.zoom}else this._disable()}calculateExaggeration(e){const i=this._previousCameraAltitude,o=e.getFreeCameraOptions().position.z/e.pixelsPerMeter*e.worldSize;this._previousCameraAltitude=o;const l=i!=null?o-i:Number.MAX_VALUE;if(Math.abs(l)<2)return this._exaggeration;const u=e.zoom,h=this._style.terrain;if(!this._previousUpdateTimestamp)return h.getExaggeration(u);let m=u-this._previousZoom;const _=this._previousUpdateTimestamp;let v=u;this._evaluationZoom!=null&&(v=this._evaluationZoom,Math.abs(u-v)>.5&&(m=.5*(u-v+m)),m*l<0&&(v+=m)),this._evaluationZoom=v;const x=h.getExaggeration(v),w=x===h.getExaggeration(Math.max(0,v-.1));if(w&&Math.abs(x-this._exaggeration)<.01)return x;let C=Math.min(.1,.00375*(this._updateTimestamp-_));return(w||x<.1||Math.abs(m)<1e-4)&&(C=Math.min(.2,4*C)),$r(this._exaggeration,x,C)}resetTileLookupCache(e){this._findCoveringTileCache[e]={}}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_onStyleDataEvent(e){e.coord&&e.dataType==="source"?this._clearRenderCacheForTile(e.sourceCacheId,e.coord):e.dataType==="style"&&(this.invalidateRenderCache=!0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this._previousCameraAltitude=void 0)}_disable(){if(this.enabled&&(this.enabled=!1,this._sharedDepthStencil=void 0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const e in this._style._mergedSourceCaches)this._style._mergedSourceCaches[e].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this._emptyDepthBufferTexture&&this._emptyDepthBufferTexture.destroy(),this.pool.forEach(e=>e.fb.destroy()),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),this.framebufferCopyTexture&&this.framebufferCopyTexture.destroy()}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this._exaggeration}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const e=2*this.proxySourceCache.getSource().tileSize;return[e,e]}set useVertexMorphing(e){this._useVertexMorphing=e}updateTileBinding(e){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const i=this.proxySourceCache,o=this.painter.transform;this._initializing&&(this._initializing=o._centerAltitude===0&&this.getAtPointOrZero(Pn.fromLngLat(o.center),-1)===-1,this._emptyDEMTextureDirty=!this._initializing);const l=this.proxyCoords=i.getIds().map(_=>{const v=i.getTileByID(_).tileID;return v.projMatrix=o.calculateProjMatrix(v.toUnwrapped()),v});(function(_,v){const x=v.transform.pointCoordinate(v.transform.getCameraPoint()),w=new D(x.x,x.y);_.sort((C,k)=>{if(k.overscaledZ-C.overscaledZ)return k.overscaledZ-C.overscaledZ;const P=new D(C.canonical.x+(1<<C.canonical.z)*C.wrap,C.canonical.y),R=new D(k.canonical.x+(1<<k.canonical.z)*k.wrap,k.canonical.y),z=w.mult(1<<C.canonical.z);return z.x-=.5,z.y-=.5,z.distSqr(P)-z.distSqr(R)})})(l,this.painter);const u=this.proxyToSource||{};this.proxyToSource={},l.forEach(_=>{this.proxyToSource[_.key]={}}),this.terrainTileForTile={};const h=this._style._mergedSourceCaches;for(const _ in h){const v=h[_];if(!v.used||(v!==this.sourceCache&&this.resetTileLookupCache(v.id),this._setupProxiedCoordsForOrtho(v,e[_],u),v.usedForTerrain))continue;const x=e[_];v.getSource().reparseOverscaled&&this._assignTerrainTiles(x)}this.proxiedCoords[i.id]=l.map(_=>new FO(_,_.key,this.orthoMatrix)),this._assignTerrainTiles(l),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(u),this.renderingToTexture=!1;const m={};this._visibleDemTiles=[];for(const _ of this.proxyCoords){const v=this.terrainTileForTile[_.key];if(!v)continue;const x=v.tileID.key;x in m||(this._visibleDemTiles.push(v),m[x]=x)}}_assignTerrainTiles(e){this._initializing||e.forEach(i=>{if(this.terrainTileForTile[i.key])return;const o=this._findTileCoveringTileID(i,this.sourceCache);o&&(this.terrainTileForTile[i.key]=o)})}_prepareDEMTextures(){const e=this.painter.context,i=e.gl;for(const o in this.terrainTileForTile){const l=this.terrainTileForTile[o],u=l.dem;!u||l.demTexture&&!l.needsDEMTextureUpload||(e.activeTexture.set(i.TEXTURE1),EO(this.painter,l,u))}}_prepareDemTileUniforms(e,i,o,l){if(!i||i.demTexture==null)return!1;const u=e.tileID.canonical,h=Math.pow(2,i.tileID.canonical.z-u.z),m=l||"";return o[`u_dem_tl${m}`]=[u.x*h%1,u.y*h%1],o[`u_dem_scale${m}`]=h,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}get emptyDepthBufferTexture(){const e=this.painter.context,i=e.gl;if(!this._emptyDepthBufferTexture){const o=new da({width:1,height:1},Uint8Array.of(255,255,255,255));this._emptyDepthBufferTexture=new Ia(e,o,i.RGBA,{premultiply:!1})}return this._emptyDepthBufferTexture}_getLoadedAreaMinimum(){let e=0;const i=this._visibleDemTiles.reduce((o,l)=>{if(!l.dem)return o;const u=l.dem.tree.minimums[0];return u>0&&e++,o+u},0);return e?i/e:0}_updateEmptyDEMTexture(){const e=this.painter.context,i=e.gl;e.activeTexture.set(i.TEXTURE2);const o=this._getLoadedAreaMinimum(),[l,u]=(()=>{if(this.painter.terrainUseFloatDEM()){const m=new wM({width:1,height:1},new Float32Array([o]));return[i.R32F,m]}{const m=new da({width:1,height:1},new Uint8Array(ld.pack(o,this.sourceCache.getSource().encoding)));return[i.RGBA,m]}})();this._emptyDEMTextureDirty=!1;let h=this._emptyDEMTexture;return h?h.update(u,{premultiply:!1}):h=this._emptyDEMTexture=new Ia(e,u,l,{premultiply:!1}),h}setupElevationDraw(e,i,o){const l=this.painter.context,u=l.gl,h=(m=this.sourceCache.getSource().encoding,{u_dem:2,u_dem_prev:4,u_dem_unpack:ld.getUnpackVector(m),u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0});var m;h.u_exaggeration=this.exaggeration();let _=null,v=null,x=1;if(o&&o.morphing&&this._useVertexMorphing){const k=o.morphing.srcDemTile,P=o.morphing.dstDemTile;x=o.morphing.phase,k&&P&&(this._prepareDemTileUniforms(e,k,h,"_prev")&&(v=k),this._prepareDemTileUniforms(e,P,h)&&(_=P))}const w=k=>k&&k.demTexture&&this.painter.terrainUseFloatDEM()?u.LINEAR:u.NEAREST,C=k=>{h.u_dem_size=k.size[0]===1?1:k.size[0]-2};if(v&&_)l.activeTexture.set(u.TEXTURE2),_.demTexture.bind(w(_),u.CLAMP_TO_EDGE),l.activeTexture.set(u.TEXTURE4),v.demTexture.bind(w(v),u.CLAMP_TO_EDGE),_.demTexture&&C(_.demTexture),h.u_dem_lerp=x;else{_=this.terrainTileForTile[e.tileID.key],l.activeTexture.set(u.TEXTURE2);const k=this._prepareDemTileUniforms(e,_,h)?_.demTexture:this.emptyDEMTexture;k.bind(w(_),u.CLAMP_TO_EDGE),C(k)}if(l.activeTexture.set(u.TEXTURE3),o&&o.useDepthForOcclusion?(this._depthTexture&&this._depthTexture.bind(u.NEAREST,u.CLAMP_TO_EDGE),this._depthFBO&&(h.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height])):(this.emptyDepthBufferTexture.bind(u.NEAREST,u.CLAMP_TO_EDGE),h.u_depth_size_inv=[1,1]),o&&o.useMeterToDem&&_){const k=(1<<_.tileID.canonical.z)*fi(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;h.u_meter_to_dem=k}if(o&&o.labelPlaneMatrixInv&&(h.u_label_plane_matrix_inv=o.labelPlaneMatrixInv),i.setTerrainUniformValues(l,h),this.painter.transform.projection.name==="globe"){const k=this.globeUniformValues(this.painter.transform,e.tileID.canonical,o&&o.useDenormalizedUpVectorScale);i.setGlobeUniformValues(l,k)}}globeUniformValues(e,i,o){const l=e.projection;return{u_tile_tl_up:l.upVector(i,0,0),u_tile_tr_up:l.upVector(i,Et,0),u_tile_br_up:l.upVector(i,Et,Et),u_tile_bl_up:l.upVector(i,0,Et),u_tile_up_scale:o?m1(1):l.upVectorScale(i,e.center.lat,e.worldSize).metersToTile}}renderToBackBuffer(e){const i=this.painter,o=this.painter.context;e.length!==0&&(o.bindFramebuffer.set(null),o.viewport.set([0,0,i.width,i.height]),i.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(l,u,h,m,_){if(l.transform.projection.name==="globe")(function(v,x,w,C,k){const P=v.context,R=P.gl;let z,B;const H=v.transform,Z=tM(v,P,H),Y=($e,Ie)=>{if(B===Ie)return;const Qe=[kO[Ie],"PROJECTION_GLOBE_VIEW"];Z&&Qe.push("CUSTOM_ANTIALIASING");const st=v.isTileAffectedByFog($e);z=v.getOrCreateProgram("globeRaster",{defines:Qe,overrideFog:st}),B=Ie},q=v.colorModeForRenderPass(),ee=new Zr(R.LEQUAL,Zr.ReadWrite,v.depthRangeFor3D);u0.update(k);const ce=function($e){const Ie=$e.pixelsPerMeter,Qe=Ie/fi(1,$e.center.lat),st=dt.identity(new Float64Array(16));return dt.translate(st,st,[$e.point.x,$e.point.y,0]),dt.scale(st,st,[Qe,Qe,Ie]),Float32Array.from(st)}(H),de=[Xa(H.center.lng),oo(H.center.lat)],ge=v.globeSharedBuffers,ve=[H.width*Jr.devicePixelRatio,H.height*Jr.devicePixelRatio],Re=Float32Array.from(H.globeMatrix),ke={useDenormalizedUpVectorScale:!0};{const $e=v.transform,Ie=IO($e.zoom,x.exaggeration(),x.sourceCache._source.tileSize);B=-1;const Qe=R.TRIANGLES;for(const st of C){const ft=w.getTile(st),Je=wn.disabled,tt=x.prevTerrainTileForTile[st.key],pt=x.terrainTileForTile[st.key];AO(tt,pt)&&u0.newMorphing(st.key,tt,pt,k,250),P.activeTexture.set(R.TEXTURE0),ft.texture.bind(R.LINEAR,R.CLAMP_TO_EDGE);const bt=u0.getMorphValuesForProxy(st.key),St=bt?1:0;bt&&Nr(ke,{morphing:{srcDemTile:bt.from,dstDemTile:bt.to,phase:Ye(bt.phase)}});const Pt=g1(st.canonical),Ut=GV(Pt.getCenter().lat),Tt=HV(st.canonical,Pt,Ut,$e.worldSize/$e._pixelsPerMercatorPixel),Mt=od(vl(st.canonical)),tr=CO($e.projMatrix,Re,ce,Mt,qa($e.zoom),de,$e.frustumCorners.TL,$e.frustumCorners.TR,$e.frustumCorners.BR,$e.frustumCorners.BL,$e.globeCenterInViewSpace,$e.globeRadius,ve,Ie,Tt);if(Y(st,St),z&&(x.setupElevationDraw(ft,z,ke),v.uploadCommonUniforms(P,z,st.toUnwrapped()),ge)){const[ur,cr,hr]=ge.getGridBuffers(Ut,Ie!==0);z.draw(v,Qe,ee,Je,q,Cn.backCCW,tr,"globe_raster",ur,cr,hr)}}}if(ge&&(v.renderDefaultNorthPole||v.renderDefaultSouthPole)){const $e=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];Z&&$e.push("CUSTOM_ANTIALIASING"),z=v.getOrCreateProgram("globeRaster",{defines:$e});for(const Ie of C){const{x:Qe,y:st,z:ft}=Ie.canonical,Je=st===0,tt=st===(1<<ft)-1,[pt,bt,St,Pt]=ge.getPoleBuffers(ft,!1);if(Pt&&(Je||tt)){const Ut=w.getTile(Ie);P.activeTexture.set(R.TEXTURE0),Ut.texture.bind(R.LINEAR,R.CLAMP_TO_EDGE);let Tt=eM(ft,Qe,H);const Mt=od(vl(Ie.canonical)),tr=(ur,cr)=>ur.draw(v,R.TRIANGLES,ee,wn.disabled,q,Cn.disabled,CO(H.projMatrix,Tt,Tt,Mt,0,de,H.frustumCorners.TL,H.frustumCorners.TR,H.frustumCorners.BR,H.frustumCorners.BL,H.globeCenterInViewSpace,H.globeRadius,ve,0),"globe_pole_raster",cr,St,Pt);x.setupElevationDraw(Ut,z,ke),v.uploadCommonUniforms(P,z,Ie.toUnwrapped()),Je&&v.renderDefaultNorthPole&&tr(z,pt),tt&&v.renderDefaultSouthPole&&(Tt=dt.scale(dt.create(),Tt,[1,-1,1]),tr(z,bt))}}}})(l,u,h,m,_);else{const v=l.context,x=v.gl;let w,C;const k=l.shadowRenderer,P=c0(l,l.longestCutoffRange),R=q=>{if(C===q)return;const ee=[];ee.push(kO[q]),P.shouldRenderCutoff&&ee.push("RENDER_CUTOFF"),w=l.getOrCreateProgram("terrainRaster",{defines:ee}),C=q},z=l.colorModeForRenderPass(),B=new Zr(x.LEQUAL,Zr.ReadWrite,l.depthRangeFor3D);u0.update(_);const H=l.transform,Z=IO(H.zoom,u.exaggeration(),u.sourceCache._source.tileSize);let Y=[0,0,0];if(k){const q=l.style.directionalLight,ee=l.style.ambientLight;q&&ee&&(Y=CT(q,ee))}{C=-1;const q=x.TRIANGLES,[ee,ce]=[u.gridIndexBuffer,u.gridSegments];for(const de of m){const ge=h.getTile(de),ve=wn.disabled,Re=u.prevTerrainTileForTile[de.key],ke=u.terrainTileForTile[de.key];AO(Re,ke)&&u0.newMorphing(de.key,Re,ke,_,250),v.activeTexture.set(x.TEXTURE0),ge.texture.bind(x.LINEAR,x.CLAMP_TO_EDGE,x.LINEAR_MIPMAP_NEAREST);const $e=u0.getMorphValuesForProxy(de.key),Ie=$e?1:0;let Qe;$e&&(Qe={morphing:{srcDemTile:$e.from,dstDemTile:$e.to,phase:Ye($e.phase)}});const st=SO(de.projMatrix,yq(de.canonical,H.renderWorldCopies)?Z/10:Z,Y);if(R(Ie),!w)continue;u.setupElevationDraw(ge,w,Qe);const ft=de.toUnwrapped();k&&k.setupShadows(ft,w),l.uploadCommonUniforms(v,w,ft,null,P),w.draw(l,q,B,ve,z,Cn.backCCW,st,"terrain_raster",u.gridBuffer,ee,ce)}}}}(i,this,this.proxySourceCache,e,this._updateTimestamp),this.renderingToTexture=!0,i.gpuTimingDeferredRenderEnd(),e.splice(0,e.length))}renderBatch(e){if(this._drapedRenderBatches.length===0)return e+1;this.renderingToTexture=!0;const i=this.painter,o=this.painter.context,l=this.proxySourceCache,u=this.proxiedCoords[l.id],h=this._drapedRenderBatches.shift(),m=i.style.order,_=[];let v=0;for(const x of u){const w=l.getTileByID(x.proxyTileKey),C=l.proxyCachedFBO[x.key]?l.proxyCachedFBO[x.key][e]:void 0,k=C!==void 0?l.renderCache[C]:this.pool[v++],P=C!==void 0;if(w.texture=k.tex,P&&!k.dirty){_.push(w.tileID);continue}let R;o.bindFramebuffer.set(k.fb.framebuffer),this.renderedToTile=!1,k.dirty&&(o.clear({color:hn.transparent,stencil:0}),k.dirty=!1);for(let z=h.start;z<=h.end;++z){const B=i.style._mergedLayers[m[z]];if(B.isHidden(i.transform.zoom))continue;const H=i.style.getLayerSourceCache(B),Z=H?this.proxyToSource[x.key][H.id]:[x];if(!Z)continue;const Y=Z;o.viewport.set([0,0,k.fb.width,k.fb.height]),R!==(H?H.id:null)&&(this._setupStencil(k,Z,B,H),R=H?H.id:null),i.renderLayer(i,H,B,Y)}if(this._drapedRenderBatches.length===0)for(const z of this._pendingGroundEffectLayers){const B=i.style._mergedLayers[m[z]];if(B.isHidden(i.transform.zoom))continue;const H=i.style.getLayerSourceCache(B),Z=H?this.proxyToSource[x.key][H.id]:[x];if(!Z)continue;const Y=Z;o.viewport.set([0,0,k.fb.width,k.fb.height]),R!==(H?H.id:null)&&(this._setupStencil(k,Z,B,H),R=H?H.id:null),i.renderLayer(i,H,B,Y)}this.renderedToTile?(k.dirty=!0,_.push(w.tileID)):P||--v,v===5&&(v=0,this.renderToBackBuffer(_))}return this.renderToBackBuffer(_),this.renderingToTexture=!1,o.bindFramebuffer.set(null),o.viewport.set([0,0,i.width,i.height]),h.end+1}postRender(){}isLayerOrderingCorrect(e){const i=e.order.length;let o=-1,l=i;for(let u=0;u<i;++u)this._style.isLayerDraped(e._mergedLayers[e.order[u]])?o=Math.max(o,u):l=Math.min(l,u);return l>o}getMinElevationBelowMSL(){let e=0;return this._visibleDemTiles.filter(i=>i.dem).forEach(i=>{e=Math.min(e,i.dem.tree.minimums[0])}),e===0?e:(e-30)*this._exaggeration}raycast(e,i,o){if(!this._visibleDemTiles)return null;const l=this._visibleDemTiles.filter(u=>u.dem).map(u=>{const h=u.tileID,m=1<<h.overscaledZ,{x:_,y:v}=h.canonical,x=_/m,w=(_+1)/m,C=v/m,k=(v+1)/m;return{minx:x,miny:C,maxx:w,maxy:k,t:u.dem.tree.raycastRoot(x,C,w,k,e,i,o),tile:u}});l.sort((u,h)=>(u.t!==null?u.t:Number.MAX_VALUE)-(h.t!==null?h.t:Number.MAX_VALUE));for(const u of l){if(u.t==null)return null;const h=u.tile.dem.tree.raycast(u.minx,u.miny,u.maxx,u.maxy,e,i,o);if(h!=null)return h}return null}_createFBO(){const e=this.painter.context,i=e.gl,o=this.drapeBufferSize;e.activeTexture.set(i.TEXTURE0);const l=new Ia(e,{width:o[0],height:o[1],data:null},i.RGBA);l.bind(i.LINEAR,i.CLAMP_TO_EDGE);const u=e.createFramebuffer(o[0],o[1],!0,null);return u.colorAttachment.set(l.texture),u.depthAttachment=new IH(e,u.framebuffer),this._sharedDepthStencil===void 0?(this._sharedDepthStencil=e.createRenderbuffer(e.gl.DEPTH_STENCIL,o[0],o[1]),this._stencilRef=0,u.depthAttachment.set(this._sharedDepthStencil),e.clear({stencil:0})):u.depthAttachment.set(this._sharedDepthStencil),e.extTextureFilterAnisotropic&&!e.extTextureFilterAnisotropicForceOff&&i.texParameterf(i.TEXTURE_2D,e.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,e.extTextureFilterAnisotropicMax),{fb:u,tex:l,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._style.hasLightTransitions())return!0;for(const e in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[e].hasTransition())return!0;return this._style.order.some(e=>{const i=this._style._mergedLayers[e],o=i.isHidden(this.painter.transform.zoom);return i.type==="custom"?!o&&i.shouldRedrape():!o&&i.hasTransition()})}_clearLineLayersFromRenderCache(){let e=!1;for(const o of this._style.getSources())if(o instanceof jP){e=!0;break}if(!e)return;const i={};for(let o=0;o<this._style.order.length;++o){const l=this._style._mergedLayers[this._style.order[o]],u=this._style.getLayerSourceCache(l);if(u&&!i[u.id]&&!l.isHidden(this.painter.transform.zoom)&&l.type==="line"&&l.widthExpression()instanceof Af){i[u.id]=!0;for(const h of this.proxyCoords){const m=this.proxyToSource[h.key][u.id];if(m)for(const _ of m)this._clearRenderCacheForTile(u.id,_)}}}}_clearRasterLayersFromRenderCache(){let e=!1;for(const o in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[o]._source instanceof Cg){e=!0;break}if(!e)return;const i={};for(let o=0;o<this._style.order.length;++o){const l=this._style._mergedLayers[this._style.order[o]],u=this._style.getLayerSourceCache(l);if(!u||i[u.id]||l.isHidden(this.painter.transform.zoom)||l.type!=="raster")continue;const h=l.paint.get("raster-fade-duration");for(const m of this.proxyCoords){const _=this.proxyToSource[m.key][u.id];if(_)for(const v of _){const x=MO(u.getTile(v),u.findLoadedParent(v,0),u,this.painter.transform,h);(x.opacity!==1||x.mix!==0)&&this._clearRenderCacheForTile(u.id,v)}}}}_setupDrapedRenderBatches(){const e=this._style.order,i=e.length;if(i===0)return;const o=[];this._pendingGroundEffectLayers=[];let l,u=0,h=this._style._mergedLayers[e[u]];for(;!this._style.isLayerDraped(h)&&h.isHidden(this.painter.transform.zoom)&&++u<i;)h=this._style._mergedLayers[e[u]];for(;u<i;++u){const m=this._style._mergedLayers[e[u]];m.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(m)?l===void 0&&(l=u):(m.type==="fill-extrusion"&&this._pendingGroundEffectLayers.push(u),l!==void 0&&(o.push({start:l,end:u-1}),l=void 0)))}if(l!==void 0&&o.push({start:l,end:u-1}),o.length!==0){const m=o[o.length-1];this._pendingGroundEffectLayers.every(v=>v>m.end)||se("fill-extrusion with flood lighting and/or ground ambient occlusion should be moved to be on top of all draped layers.")}this._drapedRenderBatches=o}_setupRenderCache(e){const i=this.proxySourceCache;if(this._shouldDisableRenderCache()||this.invalidateRenderCache){if(this.invalidateRenderCache=!1,i.renderCache.length>i.renderCachePool.length){const h=Object.values(i.proxyCachedFBO);i.proxyCachedFBO={};for(let m=0;m<h.length;++m){const _=Object.values(h[m]);i.renderCachePool.push(..._)}}return}this._clearRasterLayersFromRenderCache();const o=this.proxyCoords,l=this._tilesDirty;for(let h=o.length-1;h>=0;h--){const m=o[h];if(i.getTileByID(m.key),i.proxyCachedFBO[m.key]!==void 0){const _=e[m.key],v=this.proxyToSource[m.key];let x=0;for(const w in v){const C=v[w],k=_[w];if(!k||k.length!==C.length||C.some((P,R)=>P!==k[R]||l[w]&&l[w].hasOwnProperty(P.key))){x=-1;break}++x}for(const w in i.proxyCachedFBO[m.key])i.renderCache[i.proxyCachedFBO[m.key][w]].dirty=x<0||x!==Object.values(_).length}}const u=[...this._drapedRenderBatches];u.sort((h,m)=>m.end-m.start-(h.end-h.start));for(const h of u)for(const m of o){if(i.proxyCachedFBO[m.key])continue;let _=i.renderCachePool.pop();_===void 0&&i.renderCache.length<50&&(_=i.renderCache.length,i.renderCache.push(this._createFBO())),_!==void 0&&(i.proxyCachedFBO[m.key]={},i.proxyCachedFBO[m.key][h.start]=_,i.renderCache[_].dirty=!0)}this._tilesDirty={}}_setupStencil(e,i,o,l){if(!l||!this._sourceTilesOverlap[l.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const u=this.painter.context,h=u.gl;if(i.length<=1)return void(this._overlapStencilType=!1);let m;if(o.isTileClipped())m=i.length,this._overlapStencilMode.test={func:h.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(i[0].overscaledZ>i[i.length-1].overscaledZ))return void(this._overlapStencilType=!1);m=1,this._overlapStencilMode.test={func:h.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+m>255&&(u.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=m,this._overlapStencilMode.ref=this._stencilRef,o.isTileClipped()&&this._renderTileClippingMasks(i,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return this._overlapStencilType==="Clip"||this._overlapStencilType==="Mask"}stencilModeForRTTOverlap(e){return this.renderingToTexture&&this._overlapStencilType?(this._overlapStencilType==="Clip"&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[e.key]),this._overlapStencilMode):wn.disabled}_renderTileClippingMasks(e,i){const o=this.painter,l=this.painter.context,u=l.gl;o._tileClippingMaskIDs={},l.setColorMode(Nn.disabled),l.setDepthMode(Zr.disabled);const h=o.getOrCreateProgram("clippingMask");for(const m of e){const _=o._tileClippingMaskIDs[m.key]=--i;h.draw(o,u.TRIANGLES,Zr.disabled,new wn({func:u.ALWAYS,mask:0},_,255,u.KEEP,u.KEEP,u.REPLACE),Nn.disabled,Cn.disabled,bT(m.projMatrix),"$clipping",o.tileExtentBuffer,o.quadTriangleIndexBuffer,o.tileExtentSegments)}}pointCoordinate(e){const i=this.painter.transform;if(e.x<0||e.x>i.width||e.y<0||e.y>i.height)return null;const o=[e.x,e.y,1,1];li.transformMat4(o,o,i.pixelMatrixInverse),li.scale(o,o,1/o[3]),o[0]/=i.worldSize,o[1]/=i.worldSize;const l=i._camera.position,u=fi(1,i.center.lat),h=[l[0],l[1],l[2]/u,0],m=We.subtract([],o.slice(0,3),h);We.normalize(m,m);const _=this.raycast(h,m,this._exaggeration);return _!==null&&_?(We.scaleAndAdd(h,h,m,_),h[3]=h[2],h[2]*=u,h):null}drawDepth(){const e=this.painter,i=e.context,o=this.proxySourceCache,l=Math.ceil(e.width),u=Math.ceil(e.height);if(!this._depthFBO||this._depthFBO.width===l&&this._depthFBO.height===u||(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),!this._depthFBO){const h=i.gl,m=i.createFramebuffer(l,u,!0,"renderbuffer");i.activeTexture.set(h.TEXTURE0);const _=new Ia(i,{width:l,height:u,data:null},h.RGBA);_.bind(h.NEAREST,h.CLAMP_TO_EDGE),m.colorAttachment.set(_.texture);const v=i.createRenderbuffer(i.gl.DEPTH_COMPONENT16,l,u);m.depthAttachment.set(v),this._depthFBO=m,this._depthTexture=_}i.bindFramebuffer.set(this._depthFBO.framebuffer),i.viewport.set([0,0,l,u]),function(h,m,_,v){if(h.transform.projection.name==="globe")return;const x=h.context,w=x.gl;x.clear({depth:1});const C=h.getOrCreateProgram("terrainDepth"),k=new Zr(w.LESS,Zr.ReadWrite,h.depthRangeFor3D);for(const P of v){const R=_.getTile(P),z=SO(P.projMatrix,0,[0,0,0]);m.setupElevationDraw(R,C),C.draw(h,w.TRIANGLES,k,wn.disabled,Nn.unblended,Cn.backCCW,z,"terrain_depth",m.gridBuffer,m.gridIndexBuffer,m.gridNoSkirtSegments)}}(e,this,o,this.proxyCoords)}_setupProxiedCoordsForOrtho(e,i,o){if(e.getSource()instanceof Vc)return this._setupProxiedCoordsForImageSource(e,i,o);this._findCoveringTileCache[e.id]=this._findCoveringTileCache[e.id]||{};const l=this.proxiedCoords[e.id]=[],u=this.proxyCoords;for(let m=0;m<u.length;m++){const _=u[m],v=this._findTileCoveringTileID(_,e);if(v){const x=this._createProxiedId(_,v,o[_.key]&&o[_.key][e.id]);l.push(x),this.proxyToSource[_.key][e.id]=[x]}}let h=!1;for(let m=0;m<i.length;m++){const _=e.getTile(i[m]);if(!_||!_.hasData())continue;const v=this._findTileCoveringTileID(_.tileID,this.proxySourceCache);if(v&&v.tileID.canonical.z!==_.tileID.canonical.z){const x=this.proxyToSource[v.tileID.key][e.id],w=this._createProxiedId(v.tileID,_,o[v.tileID.key]&&o[v.tileID.key][e.id]);x?x.splice(x.length-1,0,w):this.proxyToSource[v.tileID.key][e.id]=[w],l.push(w),h=!0}}this._sourceTilesOverlap[e.id]=h}_setupProxiedCoordsForImageSource(e,i,o){if(!e.getSource().loaded())return;const l=this.proxiedCoords[e.id]=[],u=this.proxyCoords,h=e.getSource(),m=h.tileID;if(!m)return;const _=new D(m.x,m.y)._div(1<<m.z),v=h.coordinates.map(Pn.fromLngLat).reduce((w,C)=>(w.min.x=Math.min(w.min.x,C.x-_.x),w.min.y=Math.min(w.min.y,C.y-_.y),w.max.x=Math.max(w.max.x,C.x-_.x),w.max.y=Math.max(w.max.y,C.y-_.y),w),{min:new D(Number.MAX_VALUE,Number.MAX_VALUE),max:new D(-Number.MAX_VALUE,-Number.MAX_VALUE)}),x=(w,C)=>{const k=w.wrap+w.canonical.x/(1<<w.canonical.z),P=w.canonical.y/(1<<w.canonical.z),R=Et/(1<<w.canonical.z),z=C.wrap+C.canonical.x/(1<<C.canonical.z),B=C.canonical.y/(1<<C.canonical.z);return k+R<z+v.min.x||k>z+v.max.x||P+R<B+v.min.y||P>B+v.max.y};for(let w=0;w<u.length;w++){const C=u[w];for(let k=0;k<i.length;k++){const P=e.getTile(i[k]);if(!P||!P.hasData()||x(C,P.tileID))continue;const R=this._createProxiedId(C,P,o[C.key]&&o[C.key][e.id]),z=this.proxyToSource[C.key][e.id];z?z.push(R):this.proxyToSource[C.key][e.id]=[R],l.push(R)}}}_createProxiedId(e,i,o){let l=this.orthoMatrix;if(o){const u=o.find(h=>h.key===i.tileID.key);if(u)return u}if(i.tileID.key!==e.key){const u=e.canonical.z-i.tileID.canonical.z;let h,m,_;l=dt.create();const v=i.tileID.wrap-e.wrap<<e.overscaledZ;u>0?(h=Et>>u,m=h*((i.tileID.canonical.x<<u)-e.canonical.x+v),_=h*((i.tileID.canonical.y<<u)-e.canonical.y)):(h=Et<<-u,m=Et*(i.tileID.canonical.x-(e.canonical.x+v<<-u)),_=Et*(i.tileID.canonical.y-(e.canonical.y<<-u))),dt.ortho(l,0,h,0,h,0,1),dt.translate(l,l,[m,_,0])}return new FO(i.tileID,e.key,l)}_findTileCoveringTileID(e,i){let o=i.getTile(e);if(o&&o.hasData())return o;const l=this._findCoveringTileCache[i.id],u=l[e.key];if(o=u?i.getTileByID(u):null,o&&o.hasData()||u===null)return o;let h=o?o.tileID:e,m=h.overscaledZ;const _=i.getSource().minzoom,v=[];if(!u){const w=i.getSource().maxzoom;if(e.canonical.z>=w){const C=e.canonical.z-w;i.getSource().reparseOverscaled?(m=Math.max(e.canonical.z+2,i.transform.tileZoom),h=new Wn(m,e.wrap,w,e.canonical.x>>C,e.canonical.y>>C)):C!==0&&(m=w,h=new Wn(m,e.wrap,w,e.canonical.x>>C,e.canonical.y>>C))}h.key!==e.key&&(v.push(h.key),o=i.getTile(h))}const x=w=>{v.forEach(C=>{l[C]=w}),v.length=0};for(m-=1;m>=_&&(!o||!o.hasData());m--){o&&x(o.tileID.key);const w=h.calculateScaledKey(m);if(o=i.getTileByID(w),o&&o.hasData())break;const C=l[w];if(C===null)break;C===void 0?v.push(w):o=i.getTileByID(C)}return x(o?o.tileID.key:null),o&&o.hasData()?o:null}findDEMTileFor(e){return this.enabled?this._findTileCoveringTileID(e,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(e,i){let o=this._tilesDirty[e];o||(o=this._tilesDirty[e]={}),o[i.key]=!0}}function Eq(r,e,i){const o=function(m,_,v){const x=We.dot(_,m),w=We.dot(v,[.2126,.7152,.0722]),C=(P,R,z)=>(1-z)*P+z*R,k=C(1-.3*Math.min(w,1),1,Math.min(x+1,1));return C(.92,1,Math.asin(Oe(_[2],-1,1))/Math.PI+.5)*k}(r,[0,0,1],e),l=[0,0,0];We.scale(l,i.slice(0,3),o);const u=[0,0,0];We.scale(u,e.slice(0,3),r[2]);const h=[0,0,0];return We.add(h,l,u),Qt(h)}const Tq=["fill","fillOutline","fillPattern","line","linePattern","background","backgroundPattern","hillshade","raster"],Sq=["stars","fillExtrusion","fillExtrusionGroundEffect","model","symbolSDF","symbolIcon","symbolTextAndIcon"];class PO{static cacheKey(e,i,o,l){let u=`${i}${l?l.cacheKey:""}`;for(const h of o)e.usedDefines.includes(h)&&(u+=`/${h}`);return u}constructor(e,i,o,l,u,h){const m=e.gl;this.program=m.createProgram(),this.configuration=l,this.name=i,this.fixedDefines=[...h];const _=function(B){const H=[];for(let Z=0;Z<B.length;Z++){if(B[Z]===null)continue;const Y=B[Z].split(" ");H.push(Y.pop())}return H}(o.staticAttributes),v=l?l.getBinderAttributes():[],x=_.concat(v);let w=l?l.defines():[];w=w.concat(h.map(B=>`#define ${B}`));const C=`#version 300 es
`;let k=C+w.concat(`
#ifdef GL_ES
precision mediump float;
#else

#if !defined(lowp)
#define lowp
#endif

#if !defined(mediump)
#define mediump
#endif

#if !defined(highp)
#define highp
#endif

#endif`,bO,xO.fragmentSource).join(`
`);for(const B of o.fragmentIncludes)k+=`
${yy[B]}`;k+=`
${o.fragmentSource}`;let P=C+w.concat(`
#ifdef GL_ES
precision highp float;
#else

#if !defined(lowp)
#define lowp
#endif

#if !defined(mediump)
#define mediump
#endif

#if !defined(highp)
#define highp
#endif

#endif`,bO,xO.vertexSource).join(`
`);for(const B of o.vertexIncludes)P+=`
${yy[B]}`;P+=`
${o.vertexSource}`;const R=m.createShader(m.FRAGMENT_SHADER);if(m.isContextLost())return void(this.failedToCreate=!0);m.shaderSource(R,k),m.compileShader(R),m.attachShader(this.program,R);const z=m.createShader(m.VERTEX_SHADER);if(m.isContextLost())this.failedToCreate=!0;else{m.shaderSource(z,P),m.compileShader(z),m.attachShader(this.program,z),this.attributes={},this.numAttributes=x.length;for(let B=0;B<this.numAttributes;B++)if(x[B]){const H=x[B].startsWith("a_")?x[B]:`a_${x[B]}`;m.bindAttribLocation(this.program,B,H),this.attributes[H]=B}m.linkProgram(this.program),m.deleteShader(z),m.deleteShader(R),this.fixedUniforms=u(e),this.binderUniforms=l?l.getUniforms(e):[],h.includes("TERRAIN")&&(this.terrainUniforms=(B=>({u_dem:new bn(B),u_dem_prev:new bn(B),u_dem_unpack:new Ts(B),u_dem_tl:new An(B),u_dem_scale:new Zt(B),u_dem_tl_prev:new An(B),u_dem_scale_prev:new Zt(B),u_dem_size:new Zt(B),u_dem_lerp:new Zt(B),u_exaggeration:new Zt(B),u_depth:new bn(B),u_depth_size_inv:new An(B),u_meter_to_dem:new Zt(B),u_label_plane_matrix_inv:new an(B)}))(e)),h.includes("GLOBE")&&(this.globeUniforms=(B=>({u_tile_tl_up:new sn(B),u_tile_tr_up:new sn(B),u_tile_br_up:new sn(B),u_tile_bl_up:new sn(B),u_tile_up_scale:new Zt(B)}))(e)),h.includes("FOG")&&(this.fogUniforms=(B=>({u_fog_matrix:new an(B),u_fog_range:new An(B),u_fog_color:new Ts(B),u_fog_horizon_blend:new Zt(B),u_fog_vertical_limit:new An(B),u_fog_temporal_offset:new Zt(B),u_frustum_tl:new sn(B),u_frustum_tr:new sn(B),u_frustum_br:new sn(B),u_frustum_bl:new sn(B),u_globe_pos:new sn(B),u_globe_radius:new Zt(B),u_globe_transition:new Zt(B),u_is_globe:new bn(B),u_viewport:new An(B)}))(e)),h.includes("RENDER_CUTOFF")&&(this.cutoffUniforms=(B=>({u_cutoff_params:new Ts(B)}))(e)),h.includes("LIGHTING_3D_MODE")&&(this.lightsUniforms=(B=>({u_lighting_ambient_color:new sn(B),u_lighting_directional_dir:new sn(B),u_lighting_directional_color:new sn(B),u_ground_radiance:new sn(B)}))(e)),h.includes("RENDER_SHADOWS")&&(this.shadowUniforms=(B=>({u_light_matrix_0:new an(B),u_light_matrix_1:new an(B),u_fade_range:new An(B),u_shadow_normal_offset:new sn(B),u_shadow_intensity:new Zt(B),u_shadow_texel_size:new Zt(B),u_shadow_map_resolution:new Zt(B),u_shadow_direction:new sn(B),u_shadow_bias:new sn(B),u_shadowmap_0:new bn(B),u_shadowmap_1:new bn(B)}))(e))}}setTerrainUniformValues(e,i){if(!this.terrainUniforms)return;const o=this.terrainUniforms;if(!this.failedToCreate){e.program.set(this.program);for(const l in i)o[l]&&o[l].set(this.program,l,i[l])}}setGlobeUniformValues(e,i){if(!this.globeUniforms)return;const o=this.globeUniforms;if(!this.failedToCreate){e.program.set(this.program);for(const l in i)o[l]&&o[l].set(this.program,l,i[l])}}setFogUniformValues(e,i){if(!this.fogUniforms)return;const o=this.fogUniforms;if(!this.failedToCreate){e.program.set(this.program);for(const l in i)o[l].set(this.program,l,i[l])}}setCutoffUniformValues(e,i){if(!this.cutoffUniforms)return;const o=this.cutoffUniforms;if(!this.failedToCreate){e.program.set(this.program);for(const l in i)o[l].set(this.program,l,i[l])}}setLightsUniformValues(e,i){if(!this.lightsUniforms)return;const o=this.lightsUniforms;if(!this.failedToCreate){e.program.set(this.program);for(const l in i)o[l].set(this.program,l,i[l])}}setShadowUniformValues(e,i){if(this.failedToCreate||!this.shadowUniforms)return;const o=this.shadowUniforms;e.program.set(this.program);for(const l in i)o[l].set(this.program,l,i[l])}_drawDebugWireframe(e,i,o,l,u,h,m,_,v,x){const w=e.options.wireframe;if(w.terrain===!1&&w.layers2D===!1&&w.layers3D===!1)return;const C=e.context;if(!(()=>!(!w.terrain||this.name!=="terrainRaster"&&this.name!=="globeRaster")||!(!w.layers2D||e._terrain&&e._terrain.renderingToTexture||!Tq.includes(this.name))||!(!w.layers3D||!Sq.includes(this.name)))())return;const k=C.gl,P=e.wireframeDebugCache.getLinesFromTrianglesBuffer(e.frameCounter,u,C);if(!P)return;const R=[...this.fixedDefines];R.push("DEBUG_WIREFRAME");const z=e.getOrCreateProgram(this.name,{config:this.configuration,defines:R});C.program.set(z.program);const B=(Y,q,ee)=>{if(q[Y]&&ee[Y])for(const ce in q[Y])ee[Y][ce]&&ee[Y][ce].set(ee.program,ce,q[Y][ce].current)};v&&v.setUniforms(z.program,C,z.binderUniforms,m,{zoom:_}),B("fixedUniforms",this,z),B("terrainUniforms",this,z),B("globeUniforms",this,z),B("fogUniforms",this,z),B("lightsUniforms",this,z),B("shadowUniforms",this,z),P.bind(),C.setColorMode(new Nn([k.ONE,k.ONE_MINUS_SRC_ALPHA,k.ZERO,k.ONE],hn.transparent,[!0,!0,!0,!1])),C.setDepthMode(new Zr(i.func===k.LESS?k.LEQUAL:i.func,Zr.ReadOnly,i.range)),C.setStencilMode(wn.disabled);const H=3*h.primitiveLength*2,Z=3*h.primitiveOffset*2*2;x&&x>1?k.drawElementsInstanced(k.LINES,H,k.UNSIGNED_SHORT,Z,x):k.drawElements(k.LINES,H,k.UNSIGNED_SHORT,Z),u.bind(),C.program.set(this.program),C.setDepthMode(i),C.setStencilMode(o),C.setColorMode(l)}draw(e,i,o,l,u,h,m,_,v,x,w,C,k,P,R,z){const B=e.context,H=B.gl;if(this.failedToCreate)return;B.program.set(this.program),B.setDepthMode(o),B.setStencilMode(l),B.setColorMode(u),B.setCullFace(h);for(const q of Object.keys(this.fixedUniforms))this.fixedUniforms[q].set(this.program,q,m[q]);P&&P.setUniforms(this.program,B,this.binderUniforms,C,{zoom:k});const Z={[H.LINES]:2,[H.TRIANGLES]:3,[H.LINE_STRIP]:1}[i],Y=z&&z>0?1:void 0;for(const q of w.get()){const ee=q.vaos||(q.vaos={});(ee[_]||(ee[_]=new mq)).bind(B,this,v,P?P.getPaintVertexBuffers():[],x,q.vertexOffset,R||[],Y),z&&z>1?H.drawElementsInstanced(i,q.primitiveLength*Z,H.UNSIGNED_SHORT,q.primitiveOffset*Z*2,z):H.drawElements(i,q.primitiveLength*Z,H.UNSIGNED_SHORT,q.primitiveOffset*Z*2),i===H.TRIANGLES&&this._drawDebugWireframe(e,o,l,u,x,q,C,k,P,z)}}}function OO(r,e){const i=Math.pow(2,e.tileID.overscaledZ),o=e.tileSize*Math.pow(2,r.transform.tileZoom)/i,l=o*(e.tileID.canonical.x+e.tileID.wrap*i),u=o*e.tileID.canonical.y;return{u_image:0,u_texsize:e.imageAtlasTexture.size,u_tile_units_to_pixels:1/ud(e,1,r.transform.tileZoom),u_pixel_coord_upper:[l>>16,u>>16],u_pixel_coord_lower:[65535&l,65535&u]}}const Cq=dt.create(),RO=(r,e,i,o,l,u,h,m,_,v,x,w,C,k,P)=>{const R=e.style.light,z=R.properties.get("position"),B=[z.x,z.y,z.z],H=rs.create();R.properties.get("anchor")==="viewport"&&(rs.fromRotation(H,-e.transform.angle),We.transformMat3(B,B,H));const Z=R.properties.get("color"),Y=e.transform,q={u_matrix:r,u_lightpos:B,u_lightintensity:R.properties.get("intensity"),u_lightcolor:[Z.r,Z.g,Z.b],u_vertical_gradient:+i,u_opacity:o,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Cq,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_ao:l,u_edge_radius:u,u_flood_light_color:w,u_vertical_scale:C,u_flood_light_intensity:k,u_ground_shadow_factor:P};return Y.projection.name==="globe"&&(q.u_tile_id=[h.canonical.x,h.canonical.y,1<<h.canonical.z],q.u_zoom_transition=_,q.u_inv_rot_matrix=x,q.u_merc_center=v,q.u_up_dir=Y.projection.upVector(new Dc(0,0,0),v[0]*Et,v[1]*Et),q.u_height_lift=m),q},Aq=(r,e,i)=>({u_matrix:r,u_edge_radius:e,u_vertical_scale:i}),kq=(r,e,i,o,l,u,h,m,_,v,x,w,C,k)=>{const P=RO(r,e,i,o,l,u,h,_,v,x,w,C,k,1,[0,0,0]),R={u_height_factor:-Math.pow(2,h.overscaledZ)/m.tileSize/8};return ze(P,OO(e,m),R)},LO=(r,e)=>({u_matrix:r,u_emissive_strength:e}),DO=(r,e,i,o)=>ze(LO(r,e),OO(i,o)),Iq=(r,e,i)=>({u_matrix:r,u_world:i,u_emissive_strength:e}),Mq=(r,e,i,o,l)=>ze(DO(r,e,i,o),{u_world:l}),Fq=(r,e,i,o)=>{const l=Et/i.tileSize;return{u_matrix:r,u_camera_to_center_distance:e.getCameraToCenterDistance(o),u_extrude_scale:[e.pixelsToGLUnits[0]/l,e.pixelsToGLUnits[1]/l]}},BO=(r,e,i=1)=>({u_matrix:r,u_color:e,u_overlay:0,u_overlay_scale:i}),Pq=dt.create(),Oq=(r,e,i,o,l,u,h)=>{const m=r.transform,_=m.projection.name==="globe",v=_?JI(m.zoom,e.canonical)*m._pixelsPerMercatorPixel:ud(i,1,u),x={u_matrix:e.projMatrix,u_extrude_scale:v,u_intensity:h,u_inv_rot_matrix:Pq,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(_){x.u_inv_rot_matrix=o,x.u_merc_center=l,x.u_tile_id=[e.canonical.x,e.canonical.y,1<<e.canonical.z],x.u_zoom_transition=qa(m.zoom);const w=l[0]*Et,C=l[1]*Et;x.u_up_dir=m.projection.upVector(new Dc(0,0,0),w,C)}return x},zO=(r,e,i,o,l,u,h,m,_,v,x)=>{return{u_matrix:r,u_normalize_matrix:e,u_globe_matrix:i,u_tl_parent:o,u_scale_parent:l,u_fade_t:u.mix,u_opacity:u.opacity*h.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:h.paint.get("raster-brightness-min"),u_brightness_high:h.paint.get("raster-brightness-max"),u_saturation_factor:(C=h.paint.get("raster-saturation"),C>0?1-1/(1.001-C):-C),u_contrast_factor:(w=h.paint.get("raster-contrast"),w>0?1/(1-w):1+w),u_spin_weights:Rq(h.paint.get("raster-hue-rotate")),u_perspective_transform:m,u_colorization_mix:v,u_colorization_scale:Lq(x),u_color_ramp:_};var w,C};function Rq(r){r*=Math.PI/180;const e=Math.sin(r),i=Math.cos(r);return[(2*i+1)/3,(-Math.sqrt(3)*e-i+1)/3,(Math.sqrt(3)*e-i+1)/3]}function Lq([r,e]){if(r===e)return[r,e];const i=(e+r)/2,o=(e-r)/2*256/255;return[-(r=i-o)/((e=i+o)-r),1/(e-r)]}const NO=dt.create(),UO=(r,e,i,o,l,u,h,m,_,v,x,w,C,k,P,R,z)=>{const B=l.transform,H={u_is_size_zoom_constant:+(r==="constant"||r==="source"),u_is_size_feature_constant:+(r==="constant"||r==="camera"),u_size_t:e?e.uSizeT:0,u_size:e?e.uSize:0,u_camera_to_center_distance:B.getCameraToCenterDistance(R),u_rotate_symbol:+i,u_aspect_ratio:B.width/B.height,u_fade_change:l.options.fadeDuration?l.symbolFadeChange:1,u_matrix:u,u_label_plane_matrix:h,u_coord_matrix:m,u_is_text:+_,u_pitch_with_map:+o,u_texsize:v,u_texture:0,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:NO,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:NO,u_up_vector:[0,-1,0],u_icon_transition:z||0};return R.name==="globe"&&(H.u_tile_id=[x.canonical.x,x.canonical.y,1<<x.canonical.z],H.u_zoom_transition=w,H.u_inv_rot_matrix=k,H.u_merc_center=C,H.u_camera_forward=B._camera.forward(),H.u_ecef_origin=function(Z,Y){const q=[0,0,0],ee=od(vl(Y.canonical));return We.transformMat4(q,q,ee),We.transformMat4(q,q,Z),q}(B.globeMatrix,x.toUnwrapped()),H.u_tile_matrix=Float32Array.from(B.globeMatrix),H.u_up_vector=P),H},$O=(r,e,i,o,l,u,h,m,_,v,x,w,C,k,P,R,z)=>ze(UO(r,e,i,o,l,u,h,m,_,v,w,C,k,P,R,z),{u_gamma_scale:o?l.transform.getCameraToCenterDistance(z)*Math.cos(l.terrain?0:l.transform._pitch):1,u_device_pixel_ratio:Jr.devicePixelRatio,u_is_halo:+x,undefined:void 0}),Dq=(r,e,i,o,l,u,h,m,_,v,x,w,C,k,P,R)=>ze($O(r,e,i,o,l,u,h,m,!0,_,!0,x,w,C,k,P,R),{u_texsize_icon:v,u_texture_icon:1}),Bq=(r,e,i,o)=>({u_matrix:r,u_emissive_strength:e,u_opacity:i,u_color:o}),zq=(r,e,i,o,l,u,h)=>ze(function(m,_,v,x){const w=v.imageManager.getPattern(m.toString(),_),{width:C,height:k}=v.imageManager.getPixelSize(_),P=Math.pow(2,x.tileID.overscaledZ),R=x.tileSize*Math.pow(2,v.transform.tileZoom)/P,z=R*(x.tileID.canonical.x+x.tileID.wrap*P),B=R*x.tileID.canonical.y;return{u_image:0,u_pattern_tl:w.tl,u_pattern_br:w.br,u_texsize:[C,k],u_pattern_size:w.displaySize,u_tile_units_to_pixels:1/ud(x,1,v.transform.tileZoom),u_pixel_coord_upper:[z>>16,B>>16],u_pixel_coord_lower:[65535&z,65535&B]}}(l,u,o,h),{u_matrix:r,u_emissive_strength:e,u_opacity:i}),Cs={BaseColor:5,MetallicRoughness:6,Normal:7,Occlusion:8,Emission:9,ShadowMap0:10},wT=(r,e,i,o,l,u,h,m,_,v,x,w=[0,0,0])=>{const C=o.style.light,k=C.properties.get("position"),P=[-k.x,-k.y,k.z],R=rs.create();C.properties.get("anchor")==="viewport"&&(rs.fromRotation(R,-o.transform.angle),We.transformMat3(P,P,R));const z=v.alphaMode==="MASK",B=C.properties.get("color"),H=x.paint.get("model-ambient-occlusion-intensity"),Z=x.paint.get("model-color").constantOr(hn.white),Y=x.paint.get("model-color-mix-intensity").constantOr(0);return{u_matrix:r,u_lighting_matrix:e,u_normal_matrix:i,u_lightpos:P,u_lightintensity:C.properties.get("intensity"),u_lightcolor:[B.r,B.g,B.b],u_camera_pos:w,u_opacity:l,u_baseTextureIsAlpha:0,u_alphaMask:+z,u_alphaCutoff:v.alphaCutoff,u_baseColorFactor:[u.r,u.g,u.b,u.a],u_emissiveFactor:[h[0],h[1],h[2],1],u_metallicFactor:m,u_roughnessFactor:_,u_baseColorTexture:Cs.BaseColor,u_metallicRoughnessTexture:Cs.MetallicRoughness,u_normalTexture:Cs.Normal,u_occlusionTexture:Cs.Occlusion,u_emissionTexture:Cs.Emission,u_color_mix:[Z.r,Z.g,Z.b,Y],u_aoIntensity:H}},VO=new Float32Array(16),jO=(r,e=VO,i=VO)=>({u_matrix:r,u_instance:e,u_node_matrix:i}),Nq={fillExtrusion:r=>({u_matrix:new an(r),u_lightpos:new sn(r),u_lightintensity:new Zt(r),u_lightcolor:new sn(r),u_vertical_gradient:new Zt(r),u_opacity:new Zt(r),u_edge_radius:new Zt(r),u_ao:new An(r),u_tile_id:new sn(r),u_zoom_transition:new Zt(r),u_inv_rot_matrix:new an(r),u_merc_center:new An(r),u_up_dir:new sn(r),u_height_lift:new Zt(r),u_flood_light_color:new sn(r),u_vertical_scale:new Zt(r),u_flood_light_intensity:new Zt(r),u_ground_shadow_factor:new sn(r)}),fillExtrusionDepth:r=>({u_matrix:new an(r),u_edge_radius:new Zt(r),u_vertical_scale:new Zt(r)}),fillExtrusionPattern:r=>({u_matrix:new an(r),u_lightpos:new sn(r),u_lightintensity:new Zt(r),u_lightcolor:new sn(r),u_vertical_gradient:new Zt(r),u_height_factor:new Zt(r),u_edge_radius:new Zt(r),u_ao:new An(r),u_tile_id:new sn(r),u_zoom_transition:new Zt(r),u_inv_rot_matrix:new an(r),u_merc_center:new An(r),u_up_dir:new sn(r),u_height_lift:new Zt(r),u_image:new bn(r),u_texsize:new An(r),u_pixel_coord_upper:new An(r),u_pixel_coord_lower:new An(r),u_tile_units_to_pixels:new Zt(r),u_opacity:new Zt(r)}),fillExtrusionGroundEffect:r=>({u_matrix:new an(r),u_opacity:new Zt(r),u_ao_pass:new Zt(r),u_meter_to_tile:new Zt(r),u_ao:new An(r),u_flood_light_intensity:new Zt(r),u_flood_light_color:new sn(r),u_attenuation:new Zt(r),u_edge_radius:new Zt(r),u_fb:new bn(r),u_fb_size:new Zt(r)}),fill:r=>({u_matrix:new an(r),u_emissive_strength:new Zt(r)}),fillPattern:r=>({u_matrix:new an(r),u_emissive_strength:new Zt(r),u_image:new bn(r),u_texsize:new An(r),u_pixel_coord_upper:new An(r),u_pixel_coord_lower:new An(r),u_tile_units_to_pixels:new Zt(r)}),fillOutline:r=>({u_matrix:new an(r),u_emissive_strength:new Zt(r),u_world:new An(r)}),fillOutlinePattern:r=>({u_matrix:new an(r),u_emissive_strength:new Zt(r),u_world:new An(r),u_image:new bn(r),u_texsize:new An(r),u_pixel_coord_upper:new An(r),u_pixel_coord_lower:new An(r),u_tile_units_to_pixels:new Zt(r)}),circle:r=>({u_camera_to_center_distance:new Zt(r),u_extrude_scale:new R2(r),u_device_pixel_ratio:new Zt(r),u_matrix:new an(r),u_inv_rot_matrix:new an(r),u_merc_center:new An(r),u_tile_id:new sn(r),u_zoom_transition:new Zt(r),u_up_dir:new sn(r),u_emissive_strength:new Zt(r)}),collisionBox:r=>({u_matrix:new an(r),u_camera_to_center_distance:new Zt(r),u_extrude_scale:new An(r)}),collisionCircle:r=>({u_matrix:new an(r),u_inv_matrix:new an(r),u_camera_to_center_distance:new Zt(r),u_viewport_size:new An(r)}),debug:r=>({u_color:new Up(r),u_matrix:new an(r),u_overlay:new bn(r),u_overlay_scale:new Zt(r)}),clippingMask:r=>({u_matrix:new an(r)}),heatmap:r=>({u_extrude_scale:new Zt(r),u_intensity:new Zt(r),u_matrix:new an(r),u_inv_rot_matrix:new an(r),u_merc_center:new An(r),u_tile_id:new sn(r),u_zoom_transition:new Zt(r),u_up_dir:new sn(r)}),heatmapTexture:r=>({u_image:new bn(r),u_color_ramp:new bn(r),u_opacity:new Zt(r)}),hillshade:r=>({u_matrix:new an(r),u_image:new bn(r),u_latrange:new An(r),u_light:new An(r),u_shadow:new Up(r),u_highlight:new Up(r),u_emissive_strength:new Zt(r),u_accent:new Up(r)}),hillshadePrepare:r=>({u_matrix:new an(r),u_image:new bn(r),u_dimension:new An(r),u_zoom:new Zt(r),u_unpack:new Ts(r)}),line:r=>({u_matrix:new an(r),u_pixels_to_tile_units:new R2(r),u_device_pixel_ratio:new Zt(r),u_units_to_pixels:new An(r),u_dash_image:new bn(r),u_gradient_image:new bn(r),u_image_height:new Zt(r),u_texsize:new An(r),u_tile_units_to_pixels:new Zt(r),u_alpha_discard_threshold:new Zt(r),u_trim_offset:new An(r),u_emissive_strength:new Zt(r)}),linePattern:r=>({u_matrix:new an(r),u_texsize:new An(r),u_pixels_to_tile_units:new R2(r),u_device_pixel_ratio:new Zt(r),u_image:new bn(r),u_units_to_pixels:new An(r),u_tile_units_to_pixels:new Zt(r),u_alpha_discard_threshold:new Zt(r)}),raster:r=>({u_matrix:new an(r),u_normalize_matrix:new an(r),u_globe_matrix:new an(r),u_tl_parent:new An(r),u_scale_parent:new Zt(r),u_fade_t:new Zt(r),u_opacity:new Zt(r),u_image0:new bn(r),u_image1:new bn(r),u_brightness_low:new Zt(r),u_brightness_high:new Zt(r),u_saturation_factor:new Zt(r),u_contrast_factor:new Zt(r),u_spin_weights:new sn(r),u_perspective_transform:new An(r),u_colorization_mix:new Ts(r),u_colorization_scale:new An(r),u_color_ramp:new bn(r)}),symbolIcon:r=>({u_is_size_zoom_constant:new bn(r),u_is_size_feature_constant:new bn(r),u_size_t:new Zt(r),u_size:new Zt(r),u_camera_to_center_distance:new Zt(r),u_rotate_symbol:new bn(r),u_aspect_ratio:new Zt(r),u_fade_change:new Zt(r),u_matrix:new an(r),u_label_plane_matrix:new an(r),u_coord_matrix:new an(r),u_is_text:new bn(r),u_pitch_with_map:new bn(r),u_texsize:new An(r),u_tile_id:new sn(r),u_zoom_transition:new Zt(r),u_inv_rot_matrix:new an(r),u_merc_center:new An(r),u_camera_forward:new sn(r),u_tile_matrix:new an(r),u_up_vector:new sn(r),u_ecef_origin:new sn(r),u_texture:new bn(r),u_icon_transition:new Zt(r)}),symbolSDF:r=>({u_is_size_zoom_constant:new bn(r),u_is_size_feature_constant:new bn(r),u_size_t:new Zt(r),u_size:new Zt(r),u_camera_to_center_distance:new Zt(r),u_rotate_symbol:new bn(r),u_aspect_ratio:new Zt(r),u_fade_change:new Zt(r),u_matrix:new an(r),u_label_plane_matrix:new an(r),u_coord_matrix:new an(r),u_is_text:new bn(r),u_pitch_with_map:new bn(r),u_texsize:new An(r),u_texture:new bn(r),u_gamma_scale:new Zt(r),u_device_pixel_ratio:new Zt(r),u_tile_id:new sn(r),u_zoom_transition:new Zt(r),u_inv_rot_matrix:new an(r),u_merc_center:new An(r),u_camera_forward:new sn(r),u_tile_matrix:new an(r),u_up_vector:new sn(r),u_ecef_origin:new sn(r),u_is_halo:new bn(r)}),symbolTextAndIcon:r=>({u_is_size_zoom_constant:new bn(r),u_is_size_feature_constant:new bn(r),u_size_t:new Zt(r),u_size:new Zt(r),u_camera_to_center_distance:new Zt(r),u_rotate_symbol:new bn(r),u_aspect_ratio:new Zt(r),u_fade_change:new Zt(r),u_matrix:new an(r),u_label_plane_matrix:new an(r),u_coord_matrix:new an(r),u_is_text:new bn(r),u_pitch_with_map:new bn(r),u_texsize:new An(r),u_texsize_icon:new An(r),u_texture:new bn(r),u_texture_icon:new bn(r),u_gamma_scale:new Zt(r),u_device_pixel_ratio:new Zt(r),u_is_halo:new bn(r)}),background:r=>({u_matrix:new an(r),u_emissive_strength:new Zt(r),u_opacity:new Zt(r),u_color:new Up(r)}),backgroundPattern:r=>({u_matrix:new an(r),u_emissive_strength:new Zt(r),u_opacity:new Zt(r),u_image:new bn(r),u_pattern_tl:new An(r),u_pattern_br:new An(r),u_texsize:new An(r),u_pattern_size:new An(r),u_pixel_coord_upper:new An(r),u_pixel_coord_lower:new An(r),u_tile_units_to_pixels:new Zt(r)}),terrainRaster:TO,terrainDepth:TO,skybox:r=>({u_matrix:new an(r),u_sun_direction:new sn(r),u_cubemap:new bn(r),u_opacity:new Zt(r),u_temporal_offset:new Zt(r)}),skyboxGradient:r=>({u_matrix:new an(r),u_color_ramp:new bn(r),u_center_direction:new sn(r),u_radius:new Zt(r),u_opacity:new Zt(r),u_temporal_offset:new Zt(r)}),skyboxCapture:r=>({u_matrix_3f:new A4(r),u_sun_direction:new sn(r),u_sun_intensity:new Zt(r),u_color_tint_r:new Ts(r),u_color_tint_m:new Ts(r),u_luminance:new Zt(r)}),globeRaster:r=>({u_proj_matrix:new an(r),u_globe_matrix:new an(r),u_normalize_matrix:new an(r),u_merc_matrix:new an(r),u_zoom_transition:new Zt(r),u_merc_center:new An(r),u_image0:new bn(r),u_grid_matrix:new A4(r),u_skirt_height:new Zt(r),u_frustum_tl:new sn(r),u_frustum_tr:new sn(r),u_frustum_br:new sn(r),u_frustum_bl:new sn(r),u_globe_pos:new sn(r),u_globe_radius:new Zt(r),u_viewport:new An(r)}),globeAtmosphere:r=>({u_frustum_tl:new sn(r),u_frustum_tr:new sn(r),u_frustum_br:new sn(r),u_frustum_bl:new sn(r),u_horizon:new Zt(r),u_transition:new Zt(r),u_fadeout_range:new Zt(r),u_color:new Ts(r),u_high_color:new Ts(r),u_space_color:new Ts(r),u_temporal_offset:new Zt(r),u_horizon_angle:new Zt(r)}),model:r=>({u_matrix:new an(r),u_lighting_matrix:new an(r),u_normal_matrix:new an(r),u_lightpos:new sn(r),u_lightintensity:new Zt(r),u_lightcolor:new sn(r),u_camera_pos:new sn(r),u_opacity:new Zt(r),u_baseColorFactor:new Ts(r),u_emissiveFactor:new Ts(r),u_metallicFactor:new Zt(r),u_roughnessFactor:new Zt(r),u_baseTextureIsAlpha:new bn(r),u_alphaMask:new bn(r),u_alphaCutoff:new Zt(r),u_baseColorTexture:new bn(r),u_metallicRoughnessTexture:new bn(r),u_normalTexture:new bn(r),u_occlusionTexture:new bn(r),u_emissionTexture:new bn(r),u_color_mix:new Ts(r),u_aoIntensity:new Zt(r)}),modelDepth:r=>({u_matrix:new an(r),u_instance:new an(r),u_node_matrix:new an(r)}),groundShadow:r=>({u_matrix:new an(r),u_ground_shadow_factor:new sn(r)}),stars:r=>({u_matrix:new an(r),u_up:new sn(r),u_right:new sn(r),u_intensity_multiplier:new Zt(r)})};let wy;function WO(r,e,i,o,l,u,h){const m=r.context,_=m.gl,v=r.transform,x=r.getOrCreateProgram("collisionBox"),w=[];let C=0,k=0;for(let Y=0;Y<o.length;Y++){const q=o[Y],ee=e.getTile(q),ce=ee.getBucket(i);if(!ce)continue;const de=YG(q,ce,v);let ge=de;l[0]===0&&l[1]===0||(ge=r.translatePosMatrix(de,ee,l,u));const ve=h?ce.textCollisionBox:ce.iconCollisionBox,Re=ce.collisionCircleArray;if(Re.length>0){const ke=dt.create(),$e=ge;dt.mul(ke,ce.placementInvProjMatrix,v.glCoordMatrix),dt.mul(ke,ke,ce.placementViewportMatrix),w.push({circleArray:Re,circleOffset:k,transform:$e,invTransform:ke,projection:ce.getProjection()}),C+=Re.length/4,k=C}ve&&(r.terrain&&r.terrain.setupElevationDraw(ee,x),x.draw(r,_.LINES,Zr.disabled,wn.disabled,r.colorModeForRenderPass(),Cn.disabled,Fq(ge,v,ee,ce.getProjection()),i.id,ve.layoutVertexBuffer,ve.indexBuffer,ve.segments,null,v.zoom,null,[ve.collisionVertexBuffer,ve.collisionVertexBufferExt]))}if(!h||!w.length)return;const P=r.getOrCreateProgram("collisionCircle"),R=new E2;R.resize(4*C),R._trim();let z=0;for(const Y of w)for(let q=0;q<Y.circleArray.length/4;q++){const ee=4*q,ce=Y.circleArray[ee+0],de=Y.circleArray[ee+1],ge=Y.circleArray[ee+2],ve=Y.circleArray[ee+3];R.emplace(z++,ce,de,ge,ve,0),R.emplace(z++,ce,de,ge,ve,1),R.emplace(z++,ce,de,ge,ve,2),R.emplace(z++,ce,de,ge,ve,3)}(!wy||wy.length<2*C)&&(wy=function(Y){const q=2*Y,ee=new Oa;ee.resize(q),ee._trim();for(let ce=0;ce<q;ce++){const de=6*ce;ee.uint16[de+0]=4*ce+0,ee.uint16[de+1]=4*ce+1,ee.uint16[de+2]=4*ce+2,ee.uint16[de+3]=4*ce+2,ee.uint16[de+4]=4*ce+3,ee.uint16[de+5]=4*ce+0}return ee}(C));const B=m.createIndexBuffer(wy,!0),H=m.createVertexBuffer(R,cW.members,!0);for(const Y of w){const q={u_matrix:Y.transform,u_inv_matrix:Y.invTransform,u_camera_to_center_distance:(Z=v).getCameraToCenterDistance(Y.projection),u_viewport_size:[Z.width,Z.height]};P.draw(r,_.TRIANGLES,Zr.disabled,wn.disabled,r.colorModeForRenderPass(),Cn.disabled,q,i.id,H,B,ui.simpleSegment(0,2*Y.circleOffset,Y.circleArray.length,Y.circleArray.length/2),null,v.zoom)}var Z;H.destroy(),B.destroy()}const HO=dt.create();function Uq({width:r,height:e,anchor:i,textOffset:o,textScale:l},u){const{horizontalAlign:h,verticalAlign:m}=B1(i),_=-(h-.5)*r,v=-(m-.5)*e,x=OE(i,o);return new D((_/l+x[0])*u,(v/l+x[1])*u)}function $q(r,e,i,o,l,u,h,m,_,v,x){const w=r.text.placedSymbolArray,C=r.text.dynamicLayoutVertexArray,k=r.icon.dynamicLayoutVertexArray,P={},R=r.getProjection(),z=mT(m,R,u),B=u.elevation,H=R.upVectorScale(m.canonical,u.center.lat,u.worldSize).metersToTile;C.clear();for(let Z=0;Z<w.length;Z++){const Y=w.get(Z),{tileAnchorX:q,tileAnchorY:ee,numGlyphs:ce}=Y,de=Y.hidden||!Y.crossTileID||r.allowVerticalPlacement&&!Y.placedOrientation?null:o[Y.crossTileID];if(de){let ge=0,ve=0,Re=0;if(B){const pt=B?B.getAtTileOffset(m,q,ee):0,[bt,St,Pt]=R.upVector(m.canonical,q,ee);ge=pt*bt*H,ve=pt*St*H,Re=pt*Pt*H}let[ke,$e,Ie,Qe]=Yl(Y.projectedAnchorX+ge,Y.projectedAnchorY+ve,Y.projectedAnchorZ+Re,i?z:h);const st=DF(u.getCameraToCenterDistance(R),Qe);let ft=l.evaluateSizeForFeature(r.textSizeData,v,Y)*st/Ua;i&&(ft*=r.tilePixelRatio/_);const Je=Uq(de,ft);i?({x:ke,y:$e,z:Ie}=R.projectTilePoint(q+Je.x,ee+Je.y,m.canonical),[ke,$e,Ie]=Yl(ke+ge,$e+ve,Ie+Re,h)):(e&&Je._rotate(-u.angle),ke+=Je.x,$e+=Je.y,Ie=0);const tt=r.allowVerticalPlacement&&Y.placedOrientation===zi.vertical?Math.PI/2:0;for(let pt=0;pt<ce;pt++)i0(C,ke,$e,Ie,tt);x&&Y.associatedIconIndex>=0&&(P[Y.associatedIconIndex]={x:ke,y:$e,z:Ie,angle:tt})}else o0(ce,C)}if(x){k.clear();const Z=r.icon.placedSymbolArray;for(let Y=0;Y<Z.length;Y++){const q=Z.get(Y),{numGlyphs:ee}=q,ce=P[Y];if(q.hidden||!ce)o0(ee,k);else{const{x:de,y:ge,z:ve,angle:Re}=ce;for(let ke=0;ke<ee;ke++)i0(k,de,ge,ve,Re)}}r.icon.dynamicLayoutVertexBuffer.updateData(k)}r.text.dynamicLayoutVertexBuffer.updateData(C)}function Vq(r,e,i){return i.iconsInText&&e?"symbolTextAndIcon":r?"symbolSDF":"symbolIcon"}function GO(r,e,i,o,l,u,h,m,_,v,x,w){const C=r.context,k=C.gl,P=r.transform,R=m==="map",z=_==="map",B=R&&i.layout.get("symbol-placement")!=="point",H=R&&!z&&!B,Z=i.layout.get("symbol-sort-key").constantOr(1)!==void 0;let Y=!1;const q=r.depthModeForSublayer(0,Zr.ReadOnly),ee=[Xa(P.center.lng),oo(P.center.lat)],ce=i.layout.get("text-variable-anchor"),de=P.projection.name==="globe",ge=[],ve=[0,-1,0];let Re=ve;!de&&!P.mercatorFromTransition||R||(Re=function(ke){const $e=ke._camera.getWorldToCamera(ke.worldSize,1),Ie=dt.multiply([],$e,ke.globeMatrix);dt.invert(Ie,Ie);const Qe=[0,0,0],st=[0,1,0,0];return li.transformMat4(st,st,Ie),Qe[0]=st[0],Qe[1]=st[1],Qe[2]=st[2],We.normalize(Qe,Qe),Qe}(P));for(const ke of o){const $e=e.getTile(ke),Ie=$e.getBucket(i);if(!Ie||Ie.projection.name==="mercator"&&de)continue;const Qe=l?Ie.text:Ie.icon;if(!Qe||Ie.fullyClipped||!Qe.segments.get().length)continue;const st=Qe.programConfigurations.get(i.id),ft=l||Ie.sdfIcons,Je=l?Ie.textSizeData:Ie.iconSizeData,tt=z||P.pitch!==0,pt=zc(Je,P.zoom);let bt,St,Pt,Ut,Tt=[0,0],Mt=null;if(l)St=$e.glyphAtlasTexture,Pt=k.LINEAR,bt=$e.glyphAtlasTexture.size,Ie.iconsInText&&(Tt=$e.imageAtlasTexture.size,Mt=$e.imageAtlasTexture,Ut=tt||r.options.rotating||r.options.zooming||Je.kind==="composite"||Je.kind==="camera"?k.LINEAR:k.NEAREST);else{const Ui=i.layout.get("icon-size").constantOr(0)!==1||Ie.iconsNeedLinear;St=$e.imageAtlasTexture,Pt=ft||r.options.rotating||r.options.zooming||Ui||tt?k.LINEAR:k.NEAREST,bt=$e.imageAtlasTexture.size}const tr=Ie.projection.name==="globe",ur=tr?Re:ve,cr=tr?qa(P.zoom):0,hr=mT(ke,Ie.getProjection(),P),Mr=P.calculatePixelsToTileUnitsMatrix($e),jr=ry(hr,$e.tileID.canonical,z,R,P,Ie.getProjection(),Mr),gn=r.terrain&&z&&B?dt.invert(dt.create(),jr):HO,Bn=LF(hr,$e.tileID.canonical,z,R,P,Ie.getProjection(),Mr),on=ce&&Ie.hasTextData(),Qr=Ie.hasIconTextFit()&&on&&Ie.hasIconData();if(B){const Ui=P.elevation,ra=Ui?Ui.getAtTileOffsetFunc(ke,P.center.lat,P.worldSize,Ie.getProjection()):null,_i=RF(hr,$e.tileID.canonical,z,R,P,Ie.getProjection(),Mr);$H(Ie,hr,r,l,_i,Bn,z,v,ra,ke)}const Vr=B||l&&ce||Qr,Dr=r.translatePosMatrix(hr,$e,u,h),In=Vr?HO:jr,Un=r.translatePosMatrix(Bn,$e,u,h,!0),dn=Ie.getProjection().createInversionMatrix(P,ke.canonical),gi=i.paint.get("icon-image-cross-fade").constantOr(0),Ni=[];r.terrainRenderModeElevated()&&z&&Ni.push("PITCH_WITH_MAP_TERRAIN"),tr&&(Ni.push("PROJECTION_GLOBE_VIEW"),Vr&&Ni.push("PROJECTED_POS_ON_VIEWPORT")),gi>0&&Ni.push("ICON_TRANSITION"),Qe.zOffsetVertexBuffer&&Ni.push("Z_OFFSET");const Ii=ft&&i.paint.get(l?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let Ti;Ti=ft?Ie.iconsInText?Dq(Je.kind,pt,H,z,r,Dr,In,Un,bt,Tt,ke,cr,ee,dn,ur,Ie.getProjection()):$O(Je.kind,pt,H,z,r,Dr,In,Un,l,bt,!0,ke,cr,ee,dn,ur,Ie.getProjection()):UO(Je.kind,pt,H,z,r,Dr,In,Un,l,bt,ke,cr,ee,dn,ur,Ie.getProjection(),gi);const ba={program:r.getOrCreateProgram(Vq(ft,l,Ie),{config:st,defines:Ni}),buffers:Qe,uniformValues:Ti,atlasTexture:St,atlasTextureIcon:Mt,atlasInterpolation:Pt,atlasInterpolationIcon:Ut,isSDF:ft,hasHalo:Ii,tile:$e,labelPlaneMatrixInv:gn};if(Z&&Ie.canOverlap){Y=!0;const Ui=Qe.segments.get();for(const ra of Ui)ge.push({segments:new ui([ra]),sortKey:ra.sortKey,state:ba})}else ge.push({segments:Qe.segments,sortKey:0,state:ba})}Y&&ge.sort((ke,$e)=>ke.sortKey-$e.sortKey);for(const ke of ge){const $e=ke.state;if(r.terrain&&r.terrain.setupElevationDraw($e.tile,$e.program,{useDepthForOcclusion:P.depthOcclusionForSymbolsAndCircles,labelPlaneMatrixInv:$e.labelPlaneMatrixInv}),C.activeTexture.set(k.TEXTURE0),$e.atlasTexture.bind($e.atlasInterpolation,k.CLAMP_TO_EDGE),$e.atlasTextureIcon&&(C.activeTexture.set(k.TEXTURE1),$e.atlasTextureIcon&&$e.atlasTextureIcon.bind($e.atlasInterpolationIcon,k.CLAMP_TO_EDGE)),r.uploadCommonLightUniforms(r.context,$e.program),$e.hasHalo){const Ie=$e.uniformValues;Ie.u_is_halo=1,ET($e.buffers,ke.segments,i,r,$e.program,q,x,w,Ie,2),Ie.u_is_halo=0}else{if($e.isSDF){const Ie=$e.uniformValues;$e.hasHalo&&(Ie.u_is_halo=1,ET($e.buffers,ke.segments,i,r,$e.program,q,x,w,Ie,1)),Ie.u_is_halo=0}ET($e.buffers,ke.segments,i,r,$e.program,q,x,w,$e.uniformValues,1)}}}function ET(r,e,i,o,l,u,h,m,_,v){const x=[r.dynamicLayoutVertexBuffer,r.opacityVertexBuffer,r.iconTransitioningVertexBuffer,r.globeExtVertexBuffer,r.zOffsetVertexBuffer];l.draw(o,o.context.gl.TRIANGLES,u,h,m,Cn.disabled,_,i.id,r.layoutVertexBuffer,r.indexBuffer,e,i.paint,o.transform.zoom,r.programConfigurations.get(i.id),x,v)}function qO(r,e,i,o,l,u,h){const m=r.context.gl,_=i.paint.get("fill-pattern"),v=_&&_.constantOr(1);let x,w,C,k,P;h?(w=v&&!i.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",x=m.LINES):(w=v?"fillPattern":"fill",x=m.TRIANGLES);for(const R of o){const z=e.getTile(R);if(v&&!z.patternsLoaded())continue;const B=z.getBucket(i);if(!B)continue;r.prepareDrawTile();const H=B.programConfigurations.get(i.id),Z=r.isTileAffectedByFog(R),Y=r.getOrCreateProgram(w,{config:H,overrideFog:Z});v&&(r.context.activeTexture.set(m.TEXTURE0),z.imageAtlasTexture.bind(m.LINEAR,m.CLAMP_TO_EDGE),H.updatePaintBuffers());const q=_.constantOr(null);if(q&&z.imageAtlas){const de=z.imageAtlas.patternPositions[q.toString()];de&&H.setConstantPatternPositions(de)}const ee=r.translatePosMatrix(R.projMatrix,z,i.paint.get("fill-translate"),i.paint.get("fill-translate-anchor")),ce=i.paint.get("fill-emissive-strength");if(h){k=B.indexBuffer2,P=B.segments2;const de=r.terrain&&r.terrain.renderingToTexture?r.terrain.drapeBufferSize:[m.drawingBufferWidth,m.drawingBufferHeight];C=w==="fillOutlinePattern"&&v?Mq(ee,ce,r,z,de):Iq(ee,ce,de)}else k=B.indexBuffer,P=B.segments,C=v?DO(ee,ce,r,z):LO(ee,ce);r.uploadCommonUniforms(r.context,Y,R.toUnwrapped()),Y.draw(r,x,l,r.stencilModeForClipping(R),u,Cn.disabled,C,i.id,B.layoutVertexBuffer,k,P,i.paint,r.transform.zoom,H,void 0)}}function Ey(r,e,i,o,l,u,h,m){const _=r.context,v=_.gl,x=r.transform,w=i.paint.get("fill-extrusion-pattern"),C=w.constantOr(1),k=i.paint.get("fill-extrusion-opacity"),P=r.style.enable3dLights(),R=i.paint.get(P&&!C?"fill-extrusion-ambient-occlusion-wall-radius":"fill-extrusion-ambient-occlusion-radius"),z=[i.paint.get("fill-extrusion-ambient-occlusion-intensity"),R],B=i.layout.get("fill-extrusion-edge-radius"),H=B>0&&!i.paint.get("fill-extrusion-rounded-roof"),Z=H?0:B,Y=x.projection.name==="globe"?_P():0,q=x.projection.name==="globe",ee=q?qa(x.zoom):0,ce=[Xa(x.center.lng),oo(x.center.lat)],de=i.paint.get("fill-extrusion-flood-light-color").toArray01().slice(0,3),ge=i.paint.get("fill-extrusion-flood-light-intensity"),ve=i.paint.get("fill-extrusion-vertical-scale"),Re=c0(r,i.paint.get("fill-extrusion-cutoff-fade-range")),ke=[];let $e;q&&ke.push("PROJECTION_GLOBE_VIEW"),z[0]>0&&ke.push("FAUX_AO"),H&&ke.push("ZERO_ROOF_RADIUS"),m&&ke.push("HAS_CENTROID"),ge>0&&ke.push("FLOOD_LIGHT"),Re.shouldRenderCutoff&&ke.push("RENDER_CUTOFF");const Ie=r.renderPass==="shadow",Qe=r.shadowRenderer,st=Ie&&!!Qe;r.shadowRenderer&&(r.shadowRenderer.useNormalOffset=!0);let ft=[0,0,0];if(Qe){const tt=r.style.directionalLight,pt=r.style.ambientLight;tt&&pt&&(ft=CT(tt,pt)),$e=ke.concat(["SHADOWS_SINGLE_CASCADE"])}const Je=st?"fillExtrusionDepth":C?"fillExtrusionPattern":"fillExtrusion";for(const tt of o){const pt=e.getTile(tt),bt=pt.getBucket(i);if(!bt||bt.projection.name!==x.projection.name)continue;let St=!1;Qe&&(St=Qe.getMaxCascadeForTile(tt.toUnwrapped())===0);const Pt=r.isTileAffectedByFog(tt),Ut=bt.programConfigurations.get(i.id),Tt=r.getOrCreateProgram(Je,{config:Ut,defines:St?$e:ke,overrideFog:Pt});if(r.terrain){const hr=r.terrain;r.style.terrainSetForDrapingOnly(),hr.setupElevationDraw(pt,Tt,{useMeterToDem:!0})}if(!bt.centroidVertexBuffer){const hr=Tt.attributes.a_centroid_pos;hr!==void 0&&v.vertexAttrib2f(hr,0,0)}!Ie&&Qe&&Qe.setupShadows(pt.tileID.toUnwrapped(),Tt,"vector-tile",pt.tileID.overscaledZ),C&&(r.context.activeTexture.set(v.TEXTURE0),pt.imageAtlasTexture.bind(v.LINEAR,v.CLAMP_TO_EDGE),Ut.updatePaintBuffers());const Mt=w.constantOr(null);if(Mt&&pt.imageAtlas){const hr=pt.imageAtlas.patternPositions[Mt.toString()];hr&&Ut.setConstantPatternPositions(hr)}const tr=i.paint.get("fill-extrusion-vertical-gradient");let ur;if(Ie&&Qe){if(qq(pt.tileID,bt,r))continue;const hr=Qe.calculateShadowPassMatrixFromTile(pt.tileID.toUnwrapped());ur=Aq(hr,Z,ve)}else{const hr=r.translatePosMatrix(tt.projMatrix,pt,i.paint.get("fill-extrusion-translate"),i.paint.get("fill-extrusion-translate-anchor")),Mr=x.projection.createInversionMatrix(x,tt.canonical);ur=C?kq(hr,r,tr,k,z,Z,tt,pt,Y,ee,ce,Mr,de,ve):RO(hr,r,tr,k,z,Z,tt,Y,ee,ce,Mr,de,ve,ge,ft)}r.uploadCommonUniforms(_,Tt,tt.toUnwrapped(),null,Re);const cr=[];(r.terrain||m)&&cr.push(bt.centroidVertexBuffer),q&&cr.push(bt.layoutVertexExtBuffer),Tt.draw(r,_.gl.TRIANGLES,l,u,h,Cn.backCCW,ur,i.id,bt.layoutVertexBuffer,bt.indexBuffer,bt.segments,i.paint,r.transform.zoom,Ut,cr)}r.shadowRenderer&&(r.shadowRenderer.useNormalOffset=!1)}function f0(r,e,i,o,l,u,h,m,_,v,x,w,C,k,P,R,z,B,H){const Z=r.context,Y=Z.gl,q=r.transform,ee=r.transform.zoom,ce=[],de=c0(r,i.paint.get("fill-extrusion-cutoff-fade-range"));v==="clear"?(ce.push("CLEAR_SUBPASS"),H&&(ce.push("CLEAR_FROM_TEXTURE"),Z.activeTexture.set(Y.TEXTURE0),H.bind(Y.LINEAR,Y.CLAMP_TO_EDGE))):v==="sdf"&&ce.push("SDF_SUBPASS"),z&&ce.push("HAS_CENTROID"),de.shouldRenderCutoff&&ce.push("RENDER_CUTOFF");const ge=i.layout.get("fill-extrusion-edge-radius"),ve=(Re,ke,$e,Ie,Qe)=>{const st=ke.programConfigurations.get(i.id),ft=r.isTileAffectedByFog(Re),Je=r.getOrCreateProgram("fillExtrusionGroundEffect",{config:st,defines:ce,overrideFog:ft}),tt=((bt,St,Pt,Ut,Tt,Mt,tr,ur,cr,hr,Mr)=>({u_matrix:St,u_opacity:Pt,u_ao_pass:Ut?1:0,u_meter_to_tile:Tt,u_ao:Mt,u_flood_light_intensity:tr,u_flood_light_color:ur,u_attenuation:cr,u_edge_radius:hr,u_fb:0,u_fb_size:Mr}))(0,Ie,x,_,Qe,[w,C*Qe],k,P,R,ee>=17?0:ge*Qe,H?H.size[0]:0),pt=[];z&&pt.push(ke.hiddenByLandmarkVertexBuffer),r.uploadCommonUniforms(Z,Je,Re.toUnwrapped(),null,de),Je.draw(r,Z.gl.TRIANGLES,l,u,h,m,tt,i.id,ke.vertexBuffer,ke.indexBuffer,$e,i.paint,ee,st,pt)};for(const Re of o){const ke=e.getTile(Re),$e=ke.getBucket(i);if(!$e||$e.projection.name!==q.projection.name||!$e.groundEffect||$e.groundEffect&&!$e.groundEffect.hasData())continue;const Ie=$e.groundEffect,Qe=1/$e.tileToMeter;{const st=r.translatePosMatrix(Re.projMatrix,ke,i.paint.get("fill-extrusion-translate"),i.paint.get("fill-extrusion-translate-anchor")),ft=Ie.getDefaultSegment();ve(Re,Ie,ft,st,Qe)}if(B)for(let st=0;st<4;st++){const ft=WI[st](Re),Je=e.getTile(ft);if(!Je)continue;const tt=Je.getBucket(i);if(!tt||tt.projection.name!==q.projection.name||!tt.groundEffect||tt.groundEffect&&!tt.groundEffect.hasData())continue;const pt=tt.groundEffect;let bt,St;st===0?(bt=[-Et,0,0],St=1):st===1?(bt=[Et,0,0],St=0):st===2?(bt=[0,-Et,0],St=3):(bt=[0,Et,0],St=2);const Pt=pt.regionSegments[St];if(!Pt)continue;const Ut=new Float32Array(16);dt.translate(Ut,Re.projMatrix,bt),ve(Re,pt,Pt,r.translatePosMatrix(Ut,ke,i.paint.get("fill-extrusion-translate"),i.paint.get("fill-extrusion-translate-anchor")),Qe)}}}function jq(r,e,i,o,l,u,h){o.centroidVertexArray.length===0&&o.createCentroidsBuffer();const m=u?u.findDEMTileFor(i):null;if(!(m&&m.dem||h))return;const _=B=>{const H=e.getSource().minzoom,Z=q=>{const ee=e.getTileByID(q);if(ee&&ee.hasData())return ee.getBucket(l)},Y=[0,-1,1];for(const q of Y){if(B.overscaledZ+q<H)continue;const ee=Z(B.calculateScaledKey(B.overscaledZ+q));if(ee)return ee}},v=[0,0,0],x=(B,H)=>(v[0]=Math.min(B.min.y,H.min.y),v[1]=Math.max(B.max.y,H.max.y),v[2]=Et-H.min.x>B.max.x?H.min.x-Et:B.max.x,v),w=(B,H)=>(v[0]=Math.min(B.min.x,H.min.x),v[1]=Math.max(B.max.x,H.max.x),v[2]=Et-H.min.y>B.max.y?H.min.y-Et:B.max.y,v),C=[(B,H)=>x(B,H),(B,H)=>x(H,B),(B,H)=>w(B,H),(B,H)=>w(H,B)],k=(B,H,Z,Y,q,ee,ce)=>{if(!u)return 0;const de=[[ee?Z:B,ee?B:Z,0],[ee?Z:H,ee?H:Z,0]],ge=ce<0?Et+ce:ce,ve=[ee?ge:(B+H)/2,ee?(B+H)/2:ge,0];return Z===0&&ce<0||Z!==0&&ce>0?u.getForTilePoints(q,[ve],!0,Y):de.push(ve),u.getForTilePoints(i,de,!0,m),Math.max(de[0][2],de[1][2],ve[2])/u.exaggeration()};for(let B=0;B<4;B++){const H=o.borderFeatureIndices[B];if(H.length===0)continue;const Z=WI[B](i),Y=_(Z);if(!(Y&&Y instanceof Eg)||o.borderDoneWithNeighborZ[B]===Y.canonical.z)continue;Y.centroidVertexArray.length===0&&Y.createCentroidsBuffer();const q=u?u.findDEMTileFor(Z):null;if(!(q&&q.dem||h))continue;const ee=(B<2?1:5)-B,ce=Y.borderDoneWithNeighborZ[ee]!==o.canonical.z,de=Y.borderFeatureIndices[ee];let ge=0;if(o.canonical.z!==Y.canonical.z){for(const ve of H)o.showCentroid(o.featuresOnBorder[ve]);if(ce)for(const ve of de)Y.showCentroid(Y.featuresOnBorder[ve]);o.borderDoneWithNeighborZ[B]=Y.canonical.z,Y.borderDoneWithNeighborZ[ee]=o.canonical.z}for(const ve of H){const Re=o.featuresOnBorder[ve],ke=o.centroidData[Re.centroidDataIndex],$e=Re.borders[B];let Ie;for(;ge<de.length;){Ie=Y.featuresOnBorder[de[ge]];const Qe=Ie.borders[ee];if(Qe[1]>$e[0]+3||Qe[0]>$e[0]-3)break;Y.showCentroid(Ie),ge++}if(Ie&&ge<de.length){const Qe=ge;let st=0;for(;!(Ie.borders[ee][0]>$e[1]-3)&&(st++,++ge!==de.length);)Ie=Y.featuresOnBorder[de[ge]];if(Ie=Y.featuresOnBorder[de[Qe]],st>1){const tt=Ie.borders[ee];Math.abs($e[0]-tt[0])<3&&Math.abs($e[1]-tt[1])<3&&(st=1,ge=Qe+1)}else if(st===0){o.showCentroid(Re);continue}const ft=Y.centroidData[Ie.centroidDataIndex];h&&st===1&&(((R=ke).flags|(z=ft).flags)&$c?(R.flags|=$c,z.flags|=$c):(R.flags&=2147483647,z.flags&=2147483647));let Je=new D(0,0);if(st>1)ge=Qe;else if(q&&q.dem&&!(Re.intersectsCount()>1||Ie.intersectsCount()>1)){const tt=C[B](ke,ft),pt=B%2?Et-1:0;P=k(tt[0],Math.min(Et-1,tt[1]),pt,q,Z,B<2,tt[2]),Je=new D(Math.ceil(7*(P+450)),0)}ke.centroidXY=ft.centroidXY=Je,o.writeCentroidToBuffer(ke),Y.writeCentroidToBuffer(ft)}else o.showCentroid(Re)}o.borderDoneWithNeighborZ[B]=Y.canonical.z,Y.borderDoneWithNeighborZ[ee]=o.canonical.z}var P,R,z;(o.needsCentroidUpdate||!o.centroidVertexBuffer&&o.centroidVertexArray.length!==0)&&o.uploadCentroid(r)}const Wq=[1,0,0],Hq=[0,1,0],Gq=[0,0,1];function qq(r,e,i){const o=i.transform,l=i.shadowRenderer;if(!l)return!0;const u=r.toUnwrapped(),h=o.tileSize*l._cascades[i.currentShadowCascade].scale;let m=e.maxHeight;if(o.elevation){const R=o.elevation.getMinMaxForTile(r);R&&(m+=R.max)}const _=[...l.shadowDirection];_[2]=-_[2];const v=l.computeSimplifiedTileShadowVolume(u,m,h,_);if(!v)return!1;const x=[Wq,Hq,Gq,_,[_[0],0,_[2]],[0,_[1],_[2]]],w=o.projection.name==="globe",C=o.scaleZoom(h),k=ku.fromInvProjectionMatrix(o.invProjMatrix,o.worldSize,C,!w),P=l.getCurrentCascadeFrustum();return k.intersectsPrecise(v.vertices,v.planes,x)===0||P.intersectsPrecise(v.vertices,v.planes,x)===0}const Xq=new hn(1,0,0,1),Zq=new hn(0,1,0,1),Kq=new hn(0,0,1,1),Yq=new hn(1,0,1,1),Jq=new hn(0,1,1,1);function Qq(r,e,i){const o=r.context,l=r.transform,u=o.gl,h=l.projection.name==="globe",m=h?["PROJECTION_GLOBE_VIEW"]:[];let _=i.projMatrix;if(h&&qa(l.zoom)>0){const ve=nE(ZI(i.canonical,l));_=dt.multiply(new Float32Array(16),l.globeMatrix,ve),dt.multiply(_,l.projMatrix,_)}const v=r.getOrCreateProgram("debug",{defines:m}),x=e.getTileByID(i.key);r.terrain&&r.terrain.setupElevationDraw(x,v);const w=Zr.disabled,C=wn.disabled,k=r.colorModeForRenderPass(),P="$debug";o.activeTexture.set(u.TEXTURE0),r.emptyTexture.bind(u.LINEAR,u.CLAMP_TO_EDGE),h?x._makeGlobeTileDebugBuffers(r.context,l):x._makeDebugTileBoundsBuffers(r.context,l.projection);const R=x._tileDebugBuffer||r.debugBuffer,z=x._tileDebugIndexBuffer||r.debugIndexBuffer,B=x._tileDebugSegments||r.debugSegments;v.draw(r,u.LINE_STRIP,w,C,k,Cn.disabled,BO(_,hn.red),P,R,z,B,null,null,null,[x._globeTileDebugBorderBuffer]);const H=x.latestRawTileData,Z=Math.floor((H&&H.byteLength||0)/1024),Y=e.getTile(i).tileSize,q=512/Math.min(Y,512)*(i.overscaledZ/l.zoom)*.5;let ee=i.canonical.toString();i.overscaledZ!==i.canonical.z&&(ee+=` => ${i.overscaledZ}`),ee+=` ${Z}kb`,function(ve,Re){ve.initDebugOverlayCanvas();const ke=ve.debugOverlayCanvas,$e=ve.context.gl,Ie=ve.debugOverlayCanvas.getContext("2d");Ie.clearRect(0,0,ke.width,ke.height),Ie.shadowColor="white",Ie.shadowBlur=2,Ie.lineWidth=1.5,Ie.strokeStyle="white",Ie.textBaseline="top",Ie.font="bold 36px Open Sans, sans-serif",Ie.fillText(Re,5,5),Ie.strokeText(Re,5,5),ve.debugOverlayTexture.update(ke),ve.debugOverlayTexture.bind($e.LINEAR,$e.CLAMP_TO_EDGE)}(r,ee);const ce=x._tileDebugTextBuffer||r.debugBuffer,de=x._tileDebugTextIndexBuffer||r.quadTriangleIndexBuffer,ge=x._tileDebugTextSegments||r.debugSegments;v.draw(r,u.TRIANGLES,w,C,Nn.alphaBlended,Cn.disabled,BO(_,hn.transparent,q),P,ce,de,ge,null,null,null,[x._globeTileDebugTextBuffer])}function XO(r,e,i,o){Ty(r,0,e+i/2,r.transform.width,i,o)}function ZO(r,e,i,o){Ty(r,e-i/2,0,i,r.transform.height,o)}function Ty(r,e,i,o,l,u){const h=r.context,m=h.gl;m.enable(m.SCISSOR_TEST),m.scissor(e*Jr.devicePixelRatio,i*Jr.devicePixelRatio,o*Jr.devicePixelRatio,l*Jr.devicePixelRatio),h.clear({color:u}),m.disable(m.SCISSOR_TEST)}const eX=Zn([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:tX}=eX;function Jf(r,e,i,o){r.emplaceBack(e,i,o)}class KO{constructor(e){this.vertexArray=new Of,this.indices=new Oa,Jf(this.vertexArray,-1,-1,1),Jf(this.vertexArray,1,-1,1),Jf(this.vertexArray,-1,1,1),Jf(this.vertexArray,1,1,1),Jf(this.vertexArray,-1,-1,-1),Jf(this.vertexArray,1,-1,-1),Jf(this.vertexArray,-1,1,-1),Jf(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=e.createVertexBuffer(this.vertexArray,tX),this.indexBuffer=e.createIndexBuffer(this.indices),this.segment=ui.simpleSegment(0,0,36,12)}}function h0(r,e,i,o,l,u){const h=r.context.gl,m=e.paint.get("sky-atmosphere-color"),_=e.paint.get("sky-atmosphere-halo-color"),v=e.paint.get("sky-atmosphere-sun-intensity"),x=((w,C,k,P,R)=>({u_matrix_3f:w,u_sun_direction:C,u_sun_intensity:k,u_color_tint_r:[P.r,P.g,P.b,P.a],u_color_tint_m:[R.r,R.g,R.b,R.a],u_luminance:5e-5}))(rs.fromMat4(rs.create(),o),l,v,m,_);h.framebufferTexture2D(h.FRAMEBUFFER,h.COLOR_ATTACHMENT0,h.TEXTURE_CUBE_MAP_POSITIVE_X+u,e.skyboxTexture,0),i.draw(r,h.TRIANGLES,Zr.disabled,wn.disabled,Nn.unblended,Cn.frontCW,x,"skyboxCapture",e.skyboxGeometry.vertexBuffer,e.skyboxGeometry.indexBuffer,e.skyboxGeometry.segment)}const rX=Zn([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class nX{constructor(e){const i=new rd;i.emplaceBack(-1,1,1,0,0),i.emplaceBack(1,1,1,1,0),i.emplaceBack(1,-1,1,1,1),i.emplaceBack(-1,-1,1,0,1);const o=new Oa;o.emplaceBack(0,1,2),o.emplaceBack(2,3,0),this.vertexBuffer=e.createVertexBuffer(i,rX.members),this.indexBuffer=e.createIndexBuffer(o),this.segments=ui.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const iX=Zn([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_size_scale",components:1},{type:"Float32",name:"a_fade_opacity",components:1}]);class aX{constructor(){this.colorModeAlphaBlendedWriteRGB=new Nn([1,ey,1,ey],hn.transparent,[!0,!0,!0,!1]),this.colorModeWriteAlpha=new Nn([1,0,1,0],hn.transparent,[!1,!1,!1,!0])}update(e){const i=e.context;if(!this.atmosphereBuffer){this.atmosphereBuffer=new nX(i);const o=100,l=200,u=function(x){const w=Zw(30),C=[];for(let k=0;k<16e3;++k){const P=2*Math.PI*w(),R=Math.acos(1-2*w())-.5*Math.PI;C.push(We.fromValues(Math.cos(R)*Math.cos(P),Math.cos(R)*Math.sin(P),Math.sin(R)))}return C}(),h=Zw(300),m=new A2,_=new Oa;let v=0;for(let x=0;x<u.length;++x){const w=We.scale([],u[x],200),C=Math.max(0,1+.01*o*(1*h()-.5)),k=Math.max(0,1+.01*l*(1*h()-.5));m.emplaceBack(w[0],w[1],w[2],-1,-1,C,k),m.emplaceBack(w[0],w[1],w[2],1,-1,C,k),m.emplaceBack(w[0],w[1],w[2],1,1,C,k),m.emplaceBack(w[0],w[1],w[2],-1,1,C,k),_.emplaceBack(v+0,v+1,v+2),_.emplaceBack(v+0,v+2,v+3),v+=4}this.starsVx=i.createVertexBuffer(m,iX.members),this.starsIdx=i.createIndexBuffer(_),this.starsSegments=ui.simpleSegment(0,0,m.length,_.length)}}destroy(){this.atmosphereBuffer&&this.atmosphereBuffer.destroy(),this.starsVx&&this.starsVx.destroy(),this.starsIdx&&this.starsIdx.destroy()}drawAtmosphereGlow(e,i){const o=e.context,l=o.gl,u=e.transform,h=new Zr(l.LEQUAL,Zr.ReadOnly,[0,1]),m=qa(u.zoom),_=i.properties.get("color").toArray01(),v=i.properties.get("high-color").toArray01(),x=i.properties.get("space-color").toArray01PremultipliedAlpha(),w=5e-4,C=Oe((i.properties.get("horizon-blend")-0)/1*.2495+w,5e-4,.25),k=tM(e,o,u)&&C===w?u.worldSize/(2*Math.PI*1.025)-1:u.globeRadius,P=e.frameCounter/1e3%1,R=We.length(u.globeCenterInViewSpace),z=Math.sqrt(Math.pow(R,2)-Math.pow(k,2)),B=Math.acos(z/R),H=Z=>{const Y=u.projection.name==="globe"?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"];Z&&Y.push("ALPHA_PASS");const q=e.getOrCreateProgram("globeAtmosphere",{defines:Y}),ee=((de,ge,ve,Re,ke,$e,Ie,Qe,st,ft,Je,tt)=>({u_frustum_tl:de,u_frustum_tr:ge,u_frustum_br:ve,u_frustum_bl:Re,u_horizon:ke,u_transition:$e,u_fadeout_range:Ie,u_color:Qe,u_high_color:st,u_space_color:ft,u_temporal_offset:Je,u_horizon_angle:tt}))(u.frustumCorners.TL,u.frustumCorners.TR,u.frustumCorners.BR,u.frustumCorners.BL,u.frustumCorners.horizon,m,C,_,v,x,P,B);e.uploadCommonUniforms(o,q);const ce=this.atmosphereBuffer;ce&&q.draw(e,l.TRIANGLES,h,wn.disabled,Z?this.colorModeWriteAlpha:this.colorModeAlphaBlendedWriteRGB,Cn.backCW,ee,Z?"atmosphere_glow_alpha":"atmosphere_glow",ce.vertexBuffer,ce.indexBuffer,ce.segments)};H(!1),H(!0)}drawStars(e,i){const o=Oe(i.properties.get("star-intensity"),0,1);if(o===0)return;const l=e.context,u=l.gl,h=e.transform,m=e.getOrCreateProgram("stars"),_=ao.identity([]);ao.rotateX(_,_,-h._pitch),ao.rotateZ(_,_,-h.angle),ao.rotateX(_,_,le(h._center.lat)),ao.rotateY(_,_,-le(h._center.lng));const v=dt.fromQuat(new Float32Array(16),_),x=dt.multiply([],h.starsProjMatrix,v),w=rs.fromMat4([],v),C=rs.invert([],w),k=[0,1,0];We.transformMat3(k,k,C),We.scale(k,k,.15);const P=[1,0,0];We.transformMat3(P,P,C),We.scale(P,P,.15);const R=((z,B,H,Z)=>({u_matrix:Float32Array.from(z),u_up:B,u_right:H,u_intensity_multiplier:Z}))(x,k,P,o);e.uploadCommonUniforms(l,m),this.starsVx&&this.starsIdx&&m.draw(e,u.TRIANGLES,Zr.disabled,wn.disabled,this.colorModeAlphaBlendedWriteRGB,Cn.disabled,R,"atmosphere_stars",this.starsVx,this.starsIdx,this.starsSegments)}}function YO(r,e){const i=[...r],o=e.cameraWorldSizeForFog/e.worldSize,l=dt.identity([]);return dt.scale(l,l,[o,o,1]),dt.multiply(i,l,i),dt.multiply(i,e.worldToFogMatrix,i),i}function TT(r,e,i,o){const l=i.material,u=o.context,{baseColorTexture:h,metallicRoughnessTexture:m}=l.pbrMetallicRoughness,{normalTexture:_,occlusionTexture:v,emissionTexture:x}=l;function w(C,k,P){if(C&&(r.push(k),u.activeTexture.set(u.gl.TEXTURE0+P),C.gfxTexture)){const{minFilter:R,magFilter:z,wrapS:B,wrapT:H}=C.sampler;C.gfxTexture.bindExtraParam(R,z,B,H)}}w(h,"HAS_TEXTURE_u_baseColorTexture",Cs.BaseColor),w(m,"HAS_TEXTURE_u_metallicRoughnessTexture",Cs.MetallicRoughness),w(_,"HAS_TEXTURE_u_normalTexture",Cs.Normal),w(v,"HAS_TEXTURE_u_occlusionTexture",Cs.Occlusion),w(x,"HAS_TEXTURE_u_emissionTexture",Cs.Emission),i.texcoordBuffer&&(r.push("HAS_ATTRIBUTE_a_uv_2f"),e.push(i.texcoordBuffer)),i.colorBuffer&&(r.push(i.colorBuffer.itemSize===12?"HAS_ATTRIBUTE_a_color_3f":"HAS_ATTRIBUTE_a_color_4f"),e.push(i.colorBuffer)),i.normalBuffer&&(r.push("HAS_ATTRIBUTE_a_normal_3f"),e.push(i.normalBuffer)),i.pbrBuffer&&(r.push("HAS_ATTRIBUTE_a_pbr"),r.push("HAS_ATTRIBUTE_a_heightBasedEmissiveStrength"),e.push(i.pbrBuffer)),l.alphaMode!=="OPAQUE"&&l.alphaMode!=="MASK"||r.push("UNPREMULT_TEXTURE_IN_SHADER"),l.defined||r.push("DIFFUSE_SHADED"),r.push("USE_STANDARD_DERIVATIVES")}function Sy(r,e,i,o,l,u){const h=i.paint.get("model-opacity"),m=e.context,_=new Zr(e.context.gl.LEQUAL,Zr.ReadWrite,e.depthRangeFor3D),v=e.transform,x=r.mesh,w=x.material,C=w.pbrMetallicRoughness,k=e.style.fog;let P;P=e.transform.projection.zAxisUnit==="pixels"?[...r.nodeModelMatrix]:dt.multiply([],o.zScaleMatrix,r.nodeModelMatrix),dt.multiply(P,o.negCameraPosMatrix,P);const R=dt.invert([],P);dt.transpose(R,R);const z=wT(new Float32Array(r.worldViewProjection),new Float32Array(P),new Float32Array(R),e,h,C.baseColorFactor,w.emissiveFactor,C.metallicFactor,C.roughnessFactor,w,i),B={defines:[]},H=[];TT(B.defines,H,x,e);const Z=e.shadowRenderer;Z&&(Z.useNormalOffset=!1);let Y=null;if(k){const ce=YO(r.nodeModelMatrix,e.transform);if(Y=new Float32Array(ce),v.projection.name!=="globe"){const de=x.aabb.min,ge=x.aabb.max,[ve,Re]=k.getOpacityForBounds(ce,de[0],de[1],ge[0],ge[1]);B.overrideFog=ve>=dd||Re>=dd}}const q=c0(e,i.paint.get("model-cutoff-fade-range"));q.shouldRenderCutoff&&B.defines.push("RENDER_CUTOFF");const ee=e.getOrCreateProgram("model",B);e.uploadCommonUniforms(m,ee,null,Y,q),e.renderPass!=="shadow"&&Z&&Z.setupShadowsFromMatrix(r.nodeModelMatrix,ee),ee.draw(e,m.gl.TRIANGLES,_,l,u,x.material.doubleSided?Cn.disabled:Cn.backCCW,z,i.id,x.vertexBuffer,x.indexBuffer,x.segments,i.paint,e.transform.zoom,void 0,H)}function JO(r,e,i,o,l,u,h){let m;m=r.projection.name==="globe"?GF(i,r):[...i],dt.multiply(m,m,e.matrix);const _=dt.multiply([],o,m);if(e.meshes)for(const v of e.meshes){if(v.material.alphaMode!=="BLEND"){h.push({mesh:v,depth:0,modelIndex:l,worldViewProjection:_,nodeModelMatrix:m});continue}const x=We.transformMat4([],v.centroid,_);x[2]>0&&u.push({mesh:v,depth:x[2],modelIndex:l,worldViewProjection:_,nodeModelMatrix:m})}if(e.children)for(const v of e.children)JO(r,v,i,o,l,u,h)}function ST(r,e,i,o){const l=i.shadowRenderer;if(!l)return;const u=l.getShadowPassDepthMode(),h=l.getShadowPassColorMode(),m=l.calculateShadowPassMatrixFromMatrix(e),_=jO(m);i.getOrCreateProgram("modelDepth",{defines:["DEPTH_TEXTURE"]}).draw(i,i.context.gl.TRIANGLES,u,wn.disabled,h,Cn.backCCW,_,o.id,r.vertexBuffer,r.indexBuffer,r.segments,o.paint,i.transform.zoom,void 0,void 0)}function oX(r,e,i){const o=e.updateZoomBasedPaintProperties(),l=function(u,h,m){let _,v,x,w=u.terrain?u.terrain.exaggeration():0;if(u.terrain&&w>0){const C=u.terrain,k=C.findDEMTileFor(m);k&&k.dem?_=Jp.create(C,m,k):w=0}if(w===0&&(h.terrainElevationMin=0,h.terrainElevationMax=0),w===h.validForExaggeration&&(w===0||_&&_._demTile&&_._demTile.tileID===h.validForDEMTile.id&&_._dem._timestamp===h.validForDEMTile.timestamp))return!1;for(const C in h.instancesPerModel){const k=h.instancesPerModel[C];for(let P=0;P<k.instancedDataArray.length;++P){const R=(_?w*_.getElevationAt(0|k.instancedDataArray.float32[16*P],0|k.instancedDataArray.float32[16*P+1],!0,!0):0)+k.instancesEvaluatedElevation[P];k.instancedDataArray.float32[16*P+6]=R,v=v?Math.min(h.terrainElevationMin,R):R,x=x?Math.max(h.terrainElevationMax,R):R}}return h.terrainElevationMin=v||0,h.terrainElevationMax=x||0,h.validForExaggeration=w,h.validForDEMTile=_&&_._demTile?{id:_._demTile.tileID,timestamp:_._dem._timestamp}:{id:void 0,timestamp:0},!0}(r,e,i);(o||l)&&(e.uploaded=!1,e.upload(r.context))}const Wc={shadowUniformsInitialized:!1,useSingleShadowCascade:!1,tileMatrix:new Float64Array(16),shadowTileMatrix:new Float32Array(16),aabb:new Oi([0,0,0],[Et,Et,0])};function sX(r,e){const i=1<<r.canonical.z,o=e.getFreeCameraOptions().position,l=e.elevation,u=r.canonical.x/i,h=(r.canonical.x+1)/i,m=r.canonical.y/i,_=(r.canonical.y+1)/i;let v=e._centerAltitude;if(l){const k=l.getMinMaxForTile(r);k&&k.max>v&&(v=k.max)}const x=Oe(o.x,u,h)-o.x,w=Oe(o.y,m,_)-o.y,C=fi(v,e.center.lat)-o.z;return e._zoomFromMercatorZ(Math.sqrt(x*x+w*w+C*C))}function QO(r,e,i,o,l,u,h){const m=r.context,_=r.renderPass==="shadow",v=r.shadowRenderer,x=_&&v?v.getShadowPassDepthMode():new Zr(m.gl.LEQUAL,Zr.ReadWrite,r.depthRangeFor3D),w=r.isTileAffectedByFog(u);if(i.meshes)for(const C of i.meshes){const k=["MODEL_POSITION_ON_GPU"],P=[];let R,z,B;o.instancedDataArray.length>20&&k.push("INSTANCED_ARRAYS");const H=c0(r,e.paint.get("model-cutoff-fade-range"));if(H.shouldRenderCutoff&&k.push("RENDER_CUTOFF"),_&&v)R=r.getOrCreateProgram("modelDepth",{defines:k}),z=jO(h.shadowTileMatrix,h.shadowTileMatrix,Float32Array.from(i.matrix)),B=v.getShadowPassColorMode();else{TT(k,P,C,r),R=r.getOrCreateProgram("model",{defines:k,overrideFog:w});const Y=C.material,q=Y.pbrMetallicRoughness,ee=e.paint.get("model-opacity");z=wT(u.projMatrix,Float32Array.from(i.matrix),new Float32Array(16),r,ee,q.baseColorFactor,Y.emissiveFactor,q.metallicFactor,q.roughnessFactor,Y,e,l),v&&(h.shadowUniformsInitialized?R.setShadowUniformValues(m,v.getShadowUniformValues()):(v.setupShadows(u.toUnwrapped(),R,"model-tile",u.overscaledZ),h.shadowUniformsInitialized=!0)),B=H.shouldRenderCutoff||ee<1||Y.alphaMode!=="OPAQUE"?Nn.alphaBlended:Nn.unblended}r.uploadCommonUniforms(m,R,u.toUnwrapped(),null,H);const Z=C.material.doubleSided?Cn.disabled:Cn.backCCW;if(o.instancedDataArray.length>20)P.push(o.instancedDataBuffer),R.draw(r,m.gl.TRIANGLES,x,wn.disabled,B,Z,z,e.id,C.vertexBuffer,C.indexBuffer,C.segments,e.paint,r.transform.zoom,void 0,P,o.instancedDataArray.length);else{const Y=_?"u_instance":"u_normal_matrix";for(let q=0;q<o.instancedDataArray.length;++q)z[Y]=new Float32Array(o.instancedDataArray.arrayBuffer,64*q,16),R.draw(r,m.gl.TRIANGLES,x,wn.disabled,B,Z,z,e.id,C.vertexBuffer,C.indexBuffer,C.segments,e.paint,r.transform.zoom,void 0,P)}}if(i.children)for(const C of i.children)QO(r,e,C,o,l,u,h)}const lX=[1,-1,1];function cX(r,e,i,o){if(!i.modelManager)return!0;const l=i.modelManager;if(!i.shadowRenderer)return!0;const u=i.shadowRenderer,h=e.aabb;let m=!0,_=r.maxHeight;if(_===0){let x=0;for(const w in r.instancesPerModel){const C=l.getModel(w,o);C?x=Math.max(x,Math.max(Math.max(C.aabb.max[0],C.aabb.max[1]),C.aabb.max[2])):m=!1}_=r.maxScale*x*1.41+r.maxVerticalOffset,m&&(r.maxHeight=_)}h.max[2]=_,h.min[2]+=r.terrainElevationMin,h.max[2]+=r.terrainElevationMax,We.transformMat4(h.min,h.min,e.tileMatrix),We.transformMat4(h.max,h.max,e.tileMatrix);const v=h.intersects(u.getCurrentCascadeFrustum());return i.currentShadowCascade===0&&(r.isInsideFirstShadowMapFrustum=v===2),v===0}class uX{}class fX{constructor(){this._storage=new Map}getLinesFromTrianglesBuffer(e,i,o){{const w=this._storage.get(i.id);if(w)return w.lastUsedFrameIdx=e,w.buf}const l=o.gl,u=l.getBufferParameter(l.ELEMENT_ARRAY_BUFFER,l.BUFFER_SIZE),h=new ArrayBuffer(u),m=new Int16Array(h);l.getBufferSubData(l.ELEMENT_ARRAY_BUFFER,0,new Int16Array(h));const _=new Pf;for(let w=0;w<u/2;w+=3){const C=m[w],k=m[w+1],P=m[w+2];_.emplaceBack(C,k),_.emplaceBack(k,P),_.emplaceBack(P,C)}const v=o.bindVertexArrayOES.current,x=new uX;return x.buf=new Zf(o,_),x.lastUsedFrameIdx=e,this._storage.set(i.id,x),o.bindVertexArrayOES.set(v),x.buf}update(e){for(const[i,o]of this._storage)e-o.lastUsedFrameIdx>30&&(o.buf.destroy(),this._storage.delete(i))}destroy(){for(const[e,i]of this._storage)i.buf.destroy(),this._storage.delete(e)}}const eR={symbol:function(r,e,i,o,l){if(r.renderPass!=="translucent")return;const u=wn.disabled,h=r.colorModeForRenderPass();i.layout.get("text-variable-anchor")&&function(m,_,v,x,w,C,k){const P=_.transform,R=w==="map",z=C==="map";for(const B of m){const H=x.getTile(B),Z=H.getBucket(v);if(!Z||!Z.text||!Z.text.segments.get().length)continue;const Y=zc(Z.textSizeData,P.zoom),q=mT(B,Z.getProjection(),P),ee=P.calculatePixelsToTileUnitsMatrix(H),ce=ry(q,H.tileID.canonical,z,R,P,Z.getProjection(),ee),de=Z.hasIconTextFit()&&Z.hasIconData();if(Y){const ge=Math.pow(2,P.zoom-H.tileID.overscaledZ);$q(Z,R,z,k,uW,P,ce,B,ge,Y,de)}}}(o,r,i,e,i.layout.get("text-rotation-alignment"),i.layout.get("text-pitch-alignment"),l),i.paint.get("icon-opacity").constantOr(1)!==0&&GO(r,e,i,o,!1,i.paint.get("icon-translate"),i.paint.get("icon-translate-anchor"),i.layout.get("icon-rotation-alignment"),i.layout.get("icon-pitch-alignment"),i.layout.get("icon-keep-upright"),u,h),i.paint.get("text-opacity").constantOr(1)!==0&&GO(r,e,i,o,!0,i.paint.get("text-translate"),i.paint.get("text-translate-anchor"),i.layout.get("text-rotation-alignment"),i.layout.get("text-pitch-alignment"),i.layout.get("text-keep-upright"),u,h),e.map.showCollisionBoxes&&(WO(r,e,i,o,i.paint.get("text-translate"),i.paint.get("text-translate-anchor"),!0),WO(r,e,i,o,i.paint.get("icon-translate"),i.paint.get("icon-translate-anchor"),!1))},circle:function(r,e,i,o){if(r.renderPass!=="translucent")return;const l=i.paint.get("circle-opacity"),u=i.paint.get("circle-stroke-width"),h=i.paint.get("circle-stroke-opacity"),m=i.layout.get("circle-sort-key").constantOr(1)!==void 0,_=i.paint.get("circle-emissive-strength");if(l.constantOr(1)===0&&(u.constantOr(1)===0||h.constantOr(1)===0))return;const v=r.context,x=v.gl,w=r.transform,C=r.depthModeForSublayer(0,Zr.ReadOnly),k=wn.disabled,P=r.colorModeForDrapableLayerRenderPass(_),R=w.projection.name==="globe",z=[Xa(w.center.lng),oo(w.center.lat)],B=[];for(let Z=0;Z<o.length;Z++){const Y=o[Z],q=e.getTile(Y),ee=q.getBucket(i);if(!ee||ee.projection.name!==w.projection.name)continue;const ce=ee.programConfigurations.get(i.id),de=gM(i),ge=r.isTileAffectedByFog(Y);R&&de.push("PROJECTION_GLOBE_VIEW");const ve=r.getOrCreateProgram("circle",{config:ce,defines:de,overrideFog:ge}),Re=ee.layoutVertexBuffer,ke=ee.globeExtVertexBuffer,$e=ee.indexBuffer,Ie=w.projection.createInversionMatrix(w,Y.canonical),Qe={programConfiguration:ce,program:ve,layoutVertexBuffer:Re,globeExtVertexBuffer:ke,indexBuffer:$e,uniformValues:sj(r,Y,q,Ie,z,i),tile:q};if(m){const st=ee.segments.get();for(const ft of st)B.push({segments:new ui([ft]),sortKey:ft.sortKey,state:Qe})}else B.push({segments:ee.segments,sortKey:0,state:Qe})}m&&B.sort((Z,Y)=>Z.sortKey-Y.sortKey);const H={useDepthForOcclusion:w.depthOcclusionForSymbolsAndCircles};for(const Z of B){const{programConfiguration:Y,program:q,layoutVertexBuffer:ee,globeExtVertexBuffer:ce,indexBuffer:de,uniformValues:ge,tile:ve}=Z.state,Re=Z.segments;r.terrain&&r.terrain.setupElevationDraw(ve,q,H),r.uploadCommonUniforms(v,q,ve.tileID.toUnwrapped()),q.draw(r,x.TRIANGLES,C,k,P,Cn.disabled,ge,i.id,ee,de,Re,i.paint,w.zoom,Y,[ce])}},heatmap:function(r,e,i,o){if(i.paint.get("heatmap-opacity")!==0)if(r.renderPass==="offscreen"){const l=r.context,u=l.gl,h=wn.disabled,m=new Nn([u.ONE,u.ONE,u.ONE,u.ONE],hn.transparent,[!0,!0,!0,!0]);(function(k,P,R,z){const B=k.gl,H=P.width*z,Z=P.height*z;k.activeTexture.set(B.TEXTURE1),k.viewport.set([0,0,H,Z]);let Y=R.heatmapFbo;if(!Y||Y&&(Y.width!==H||Y.height!==Z)){Y&&Y.destroy();const q=B.createTexture();B.bindTexture(B.TEXTURE_2D,q),B.texParameteri(B.TEXTURE_2D,B.TEXTURE_WRAP_S,B.CLAMP_TO_EDGE),B.texParameteri(B.TEXTURE_2D,B.TEXTURE_WRAP_T,B.CLAMP_TO_EDGE),B.texParameteri(B.TEXTURE_2D,B.TEXTURE_MIN_FILTER,B.LINEAR),B.texParameteri(B.TEXTURE_2D,B.TEXTURE_MAG_FILTER,B.LINEAR),Y=R.heatmapFbo=k.createFramebuffer(H,Z,!0,null),function(ee,ce,de,ge,ve,Re){const ke=ee.gl;ke.texImage2D(ke.TEXTURE_2D,0,ee.extRenderToTextureHalfFloat?ke.RGBA16F:ke.RGBA,ve,Re,0,ke.RGBA,ee.extRenderToTextureHalfFloat?ke.HALF_FLOAT:ke.UNSIGNED_BYTE,null),ge.colorAttachment.set(de)}(k,0,q,Y,H,Z)}else B.bindTexture(B.TEXTURE_2D,Y.colorAttachment.get()),k.bindFramebuffer.set(Y.framebuffer)})(l,r,i,r.transform.projection.name==="globe"?.5:.25),l.clear({color:hn.transparent});const _=r.transform,v=_.projection.name==="globe",x=v?["PROJECTION_GLOBE_VIEW"]:[],w=v?Cn.frontCCW:Cn.disabled,C=[Xa(_.center.lng),oo(_.center.lat)];for(let k=0;k<o.length;k++){const P=o[k];if(e.hasRenderableParent(P))continue;const R=e.getTile(P),z=R.getBucket(i);if(!z||z.projection.name!==_.projection.name)continue;const B=r.isTileAffectedByFog(P),H=z.programConfigurations.get(i.id),Z=r.getOrCreateProgram("heatmap",{config:H,defines:x,overrideFog:B}),{zoom:Y}=r.transform;r.terrain&&r.terrain.setupElevationDraw(R,Z),r.uploadCommonUniforms(l,Z,P.toUnwrapped());const q=_.projection.createInversionMatrix(_,P.canonical);Z.draw(r,u.TRIANGLES,Zr.disabled,h,m,w,Oq(r,P,R,q,C,Y,i.paint.get("heatmap-intensity")),i.id,z.layoutVertexBuffer,z.indexBuffer,z.segments,i.paint,r.transform.zoom,H,v?[z.globeExtVertexBuffer]:null)}l.viewport.set([0,0,r.width,r.height])}else r.renderPass==="translucent"&&(r.context.setColorMode(r.colorModeForRenderPass()),function(l,u){const h=l.context,m=h.gl,_=u.heatmapFbo;if(!_)return;h.activeTexture.set(m.TEXTURE0),m.bindTexture(m.TEXTURE_2D,_.colorAttachment.get()),h.activeTexture.set(m.TEXTURE1);let v=u.colorRampTexture;v||(v=u.colorRampTexture=new Ia(h,u.colorRamp,m.RGBA)),v.bind(m.LINEAR,m.CLAMP_TO_EDGE),l.getOrCreateProgram("heatmapTexture").draw(l,m.TRIANGLES,Zr.disabled,wn.disabled,l.colorModeForRenderPass(),Cn.disabled,((x,w,C,k)=>({u_image:0,u_color_ramp:1,u_opacity:w.paint.get("heatmap-opacity")}))(0,u),u.id,l.viewportBuffer,l.quadTriangleIndexBuffer,l.viewportSegments,u.paint,l.transform.zoom)}(r,i))},line:function(r,e,i,o){if(r.renderPass!=="translucent")return;const l=i.paint.get("line-opacity"),u=i.paint.get("line-width");if(l.constantOr(1)===0||u.constantOr(1)===0)return;const h=i.paint.get("line-emissive-strength"),m=r.depthModeForSublayer(0,Zr.ReadOnly),_=r.colorModeForDrapableLayerRenderPass(h),v=r.terrain&&r.terrain.renderingToTexture?1:Jr.devicePixelRatio,x=i.paint.get("line-dasharray"),w=x.constantOr(1),C=i.layout.get("line-cap"),k=i.paint.get("line-pattern"),P=k.constantOr(1),R=i.paint.get("line-pattern").constantOr(1),z=i.paint.get("line-opacity").constantOr(1)!==1;let B=!R&&z;const H=i.paint.get("line-gradient"),Z=P?"linePattern":"line",Y=r.context,q=Y.gl,ee=TP(i);r.terrain&&r.terrain.clipOrMaskOverlapStencilType()&&(B=!1);for(const ce of o){const de=e.getTile(ce);if(P&&!de.patternsLoaded())continue;const ge=de.getBucket(i);if(!ge)continue;r.prepareDrawTile();const ve=ge.programConfigurations.get(i.id),Re=r.isTileAffectedByFog(ce),ke=r.getOrCreateProgram(Z,{config:ve,defines:ee,overrideFog:Re}),$e=k.constantOr(null);if($e&&de.imageAtlas){const bt=de.imageAtlas.patternPositions[$e.toString()];bt&&ve.setConstantPatternPositions(bt)}const Ie=x.constantOr(null),Qe=C.constantOr(null);if(!P&&Ie&&Qe&&de.lineAtlas){const bt=de.lineAtlas.getDash(Ie,Qe);bt&&ve.setConstantPatternPositions(bt)}let[st,ft]=i.paint.get("line-trim-offset");(Qe==="round"||Qe==="square")&&st!==ft&&(st===0&&(st-=1),ft===1&&(ft+=1));const Je=r.terrain?ce.projMatrix:null,tt=P?cG(r,de,i,Je,v):lG(r,de,i,Je,ge.lineClipsArray.length,v,[st,ft]);if(H){const bt=ge.gradients[i.id];let St=bt.texture;if(i.gradientVersion!==bt.version){let Pt=256;if(i.stepInterpolant){const Ut=e.getSource().maxzoom,Tt=ce.canonical.z===Ut?Math.ceil(1<<r.transform.maxZoom-ce.canonical.z):1;Pt=Oe(ot(ge.maxLineLength/Et*1024*Tt),256,Y.maxTextureSize)}bt.gradient=E1({expression:i.gradientExpression(),evaluationKey:"lineProgress",resolution:Pt,image:bt.gradient||void 0,clips:ge.lineClipsArray}),bt.texture?bt.texture.update(bt.gradient):bt.texture=new Ia(Y,bt.gradient,q.RGBA),bt.version=i.gradientVersion,St=bt.texture}Y.activeTexture.set(q.TEXTURE1),St.bind(i.stepInterpolant?q.NEAREST:q.LINEAR,q.CLAMP_TO_EDGE)}w&&(Y.activeTexture.set(q.TEXTURE0),de.lineAtlasTexture.bind(q.LINEAR,q.REPEAT),ve.updatePaintBuffers()),P&&(Y.activeTexture.set(q.TEXTURE0),de.imageAtlasTexture.bind(q.LINEAR,q.CLAMP_TO_EDGE),ve.updatePaintBuffers()),r.uploadCommonUniforms(Y,ke,ce.toUnwrapped());const pt=bt=>{ke.draw(r,q.TRIANGLES,m,bt,_,Cn.disabled,tt,i.id,ge.layoutVertexBuffer,ge.indexBuffer,ge.segments,i.paint,r.transform.zoom,ve,[ge.layoutVertexBuffer2])};if(B){const bt=r.stencilModeForClipping(ce).ref;bt===0&&r.terrain&&Y.clear({stencil:0});const St={func:q.EQUAL,mask:255};tt.u_alpha_discard_threshold=.8,pt(new wn(St,bt,255,q.KEEP,q.KEEP,q.INVERT)),tt.u_alpha_discard_threshold=0,pt(new wn(St,bt,255,q.KEEP,q.KEEP,q.KEEP))}else pt(r.stencilModeForClipping(ce))}B&&(r.resetStencilClippingMasks(),r.terrain&&Y.clear({stencil:0}))},fill:function(r,e,i,o){const l=i.paint.get("fill-color"),u=i.paint.get("fill-opacity");if(u.constantOr(1)===0)return;const h=i.paint.get("fill-emissive-strength"),m=r.colorModeForDrapableLayerRenderPass(h),_=i.paint.get("fill-pattern"),v=r.opaquePassEnabledForLayer()&&!_.constantOr(1)&&l.constantOr(hn.transparent).a===1&&u.constantOr(0)===1?"opaque":"translucent";if(r.renderPass===v){const x=r.depthModeForSublayer(1,r.renderPass==="opaque"?Zr.ReadWrite:Zr.ReadOnly);qO(r,e,i,o,x,m,!1)}if(r.renderPass==="translucent"&&i.paint.get("fill-antialias")){const x=r.depthModeForSublayer(i.getPaintProperty("fill-outline-color")?2:0,Zr.ReadOnly);qO(r,e,i,o,x,m,!0)}},"fill-extrusion":function(r,e,i,o){const l=i.paint.get("fill-extrusion-opacity"),u=r.context,h=u.gl,m=r.terrain,_=m&&m.renderingToTexture,v=i.paint.get("fill-extrusion-cutoff-fade-range");if(l===0)return;const x=r.conflationActive&&r.layerUsedInConflation(i,e.getSource());if(x&&function(w,C,k,P){for(const R of P){const z=C.getTile(R).getBucket(k);z&&(z.updateReplacement(R,w.replacementSource),z.uploadCentroid(w.context))}}(r,e,i,o),m||x)for(const w of o){const C=e.getTile(w).getBucket(i);C&&jq(r.context,e,w,C,i,m,x)}if(r.renderPass==="shadow"&&r.shadowRenderer){const w=r.shadowRenderer;if(m&&l<.65&&i._transitionablePaint._values["fill-extrusion-opacity"].value.expression instanceof Af)return;const C=w.getShadowPassDepthMode(),k=w.getShadowPassColorMode();Ey(r,e,i,o,C,wn.disabled,k,x)}else if(r.renderPass==="translucent"){const w=!i.paint.get("fill-extrusion-pattern").constantOr(1);if(!_){const C=new Zr(r.context.gl.LEQUAL,Zr.ReadWrite,r.depthRangeFor3D);v===0&&l===1&&w?Ey(r,e,i,o,C,wn.disabled,Nn.unblended,x):(Ey(r,e,i,o,C,wn.disabled,Nn.disabled,x),Ey(r,e,i,o,C,r.stencilModeFor3D(),r.colorModeForRenderPass(),x),r.resetStencilClippingMasks())}if(r.style.enable3dLights()&&w&&(!m&&r.transform.projection.name!=="globe"||_)){const C=i.paint.get("fill-extrusion-opacity"),k=i.paint.get("fill-extrusion-ambient-occlusion-intensity"),P=i.paint.get("fill-extrusion-ambient-occlusion-ground-radius"),R=i.paint.get("fill-extrusion-flood-light-intensity"),z=i.paint.get("fill-extrusion-flood-light-color").toArray01().slice(0,3),B=k>0&&P>0,H=R>0,Z=(q,ee,ce)=>(1-ce)*q+ce*ee,Y=q=>{const ee=r.depthModeForSublayer(1,Zr.ReadOnly,h.LEQUAL,!0),ce=i.paint.get(q?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),de=Z(.1,3,ce),ge=r._showOverdrawInspector;if(!ge){const ve=new wn({func:h.ALWAYS,mask:255},255,255,h.KEEP,h.KEEP,h.REPLACE),Re=new Nn([h.ONE,h.ONE,h.ONE,h.ONE],hn.transparent,[!1,!1,!1,!0],h.MIN);f0(r,e,i,o,ee,ve,Re,Cn.disabled,q,"sdf",C,k,P,R,z,de,x,!1)}{const ve=ge?wn.disabled:new wn({func:h.EQUAL,mask:255},255,255,h.KEEP,h.DECR,h.DECR),Re=ge?r.colorModeForRenderPass():new Nn([h.ONE_MINUS_DST_ALPHA,h.DST_ALPHA,h.ONE,h.ONE],hn.transparent,[!0,!0,!0,!0]);f0(r,e,i,o,ee,ve,Re,Cn.disabled,q,"color",C,k,P,R,z,de,x,!1)}};if(_){const q=(ee,ce,de)=>{const ge=r.depthModeForSublayer(1,Zr.ReadOnly,h.LEQUAL,!1),ve=i.paint.get(ee?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),Re=Z(.1,3,ve);{const ke=new Nn([h.ONE,h.ONE,h.ONE,h.ONE],hn.transparent,[!1,!1,!1,!0]);f0(r,e,i,o,ge,wn.disabled,ke,Cn.disabled,ee,"clear",C,k,P,R,z,Re,x,ce)}{const ke=new wn({func:h.ALWAYS,mask:255},255,255,h.KEEP,h.KEEP,h.REPLACE),$e=new Nn([h.ONE,h.ONE,h.ONE,h.ONE],hn.transparent,[!1,!1,!1,!0],h.MIN);f0(r,e,i,o,ge,ke,$e,Cn.disabled,ee,"sdf",C,k,P,R,z,Re,x,ce)}{const ke=ee?h.ZERO:h.ONE_MINUS_DST_ALPHA,$e=new wn({func:h.EQUAL,mask:255},255,255,h.KEEP,h.DECR,h.DECR),Ie=new Nn([ke,h.DST_ALPHA,h.ONE_MINUS_DST_ALPHA,h.ZERO],hn.transparent,[!0,!0,!0,!0]);f0(r,e,i,o,ge,$e,Ie,Cn.disabled,ee,"color",C,k,P,R,z,Re,x,ce)}{const ke=new Nn([h.ONE,h.ONE,h.ONE,ee?h.ZERO:h.ONE],hn.transparent,[!1,!1,!1,!0],ee?h.FUNC_ADD:h.MAX);f0(r,e,i,o,ge,wn.disabled,ke,Cn.disabled,ee,"clear",C,k,P,R,z,Re,x,ce,de)}};if(B||H){let ee;if(r.prepareDrawTile(),m){const ce=m.drapeBufferSize[0],de=m.drapeBufferSize[1];ee=m.framebufferCopyTexture,ee&&(!ee||ee.size[0]===ce&&ee.size[1]===de)||(ee&&ee.destroy(),ee=m.framebufferCopyTexture=new Ia(u,new da({width:ce,height:de}),h.RGBA)),ee.bind(h.LINEAR,h.CLAMP_TO_EDGE),h.copyTexImage2D(h.TEXTURE_2D,0,h.RGBA,0,0,ce,de,0)}B&&q(!0,!1,ee),H&&q(!1,!0,ee)}}else B&&Y(!0),H&&Y(!1)}}},hillshade:function(r,e,i,o){if(r.renderPass!=="offscreen"&&r.renderPass!=="translucent")return;const l=r.context,u=r.terrain&&r.terrain.renderingToTexture,[h,m]=r.renderPass!=="translucent"||u?[{},o]:r.stencilConfigForOverlap(o);for(const _ of m){const v=e.getTile(_);if(v.needsHillshadePrepare&&r.renderPass==="offscreen")vq(r,v,i);else if(r.renderPass==="translucent"){const x=r.depthModeForSublayer(0,Zr.ReadOnly),w=i.paint.get("hillshade-emissive-strength"),C=r.colorModeForDrapableLayerRenderPass(w),k=u&&r.terrain?r.terrain.stencilModeForRTTOverlap(_):h[_.overscaledZ];_q(r,_,v,i,x,k,C)}}l.viewport.set([0,0,r.width,r.height]),r.resetStencilClippingMasks()},raster:function(r,e,i,o,l,u){if(r.renderPass!=="translucent"||i.paint.get("raster-opacity")===0)return;const h=r.context,m=h.gl,_=e.getSource(),v=function(Z,Y,q){const ee=[];let ce,de;if(Z.paint.get("raster-color")){ee.push("RASTER_COLOR"),ce=Z.paint.get("raster-color-mix"),de=Z.paint.get("raster-color-range"),Y.activeTexture.set(q.TEXTURE2);let ge=Z.colorRampTexture;ge||(ge=Z.colorRampTexture=new Ia(Y,Z.colorRamp,q.RGBA)),ge.bind(q.LINEAR,q.CLAMP_TO_EDGE)}return{mix:ce,range:de,defines:ee}}(i,h,m),x=v.defines;let w=!1;if(_ instanceof Vc&&!o.length){if(r.transform.projection.name!=="globe")return;if(_.onNorthPole)w=!0,x.push("PROJECTION_GLOBE_VIEW");else{if(!_.onSouthPole)return;w=!0,x.push("PROJECTION_GLOBE_VIEW")}}const C=r.colorModeForDrapableLayerRenderPass(),k=r.terrain&&r.terrain.renderingToTexture,P=!r.options.moving,R=i.paint.get("raster-resampling")==="nearest"?m.NEAREST:m.LINEAR;if(w){const Z=e.getSource();if(!(Z instanceof Vc))return;const Y=Z.texture;if(!Y)return;const q=r.globeSharedBuffers;if(!q)return;const ee=new Zr(m.LEQUAL,Zr.ReadWrite,r.depthRangeFor3D),ce=Float32Array.from(r.transform.projMatrix);let de=eM(0,0,r.transform);const ge=Float32Array.from(od(vl(new Dc(0,0,0)))),ve={opacity:1,mix:0};r.terrain&&r.terrain.prepareDrawTile(),h.activeTexture.set(m.TEXTURE0),Y.bind(R,m.CLAMP_TO_EDGE),h.activeTexture.set(m.TEXTURE1),Y.bind(R,m.CLAMP_TO_EDGE),Y.useMipmap&&h.extTextureFilterAnisotropic&&r.transform.pitch>20&&m.texParameterf(m.TEXTURE_2D,h.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,h.extTextureFilterAnisotropicMax);const[Re,ke,$e,Ie]=q.getPoleBuffers(0,!0);let Qe;Z.onNorthPole?(Qe=Re,r.renderDefaultNorthPole=!1):(de=dt.scale(dt.create(),de,[1,-1,1]),Qe=ke,r.renderDefaultSouthPole=!1);const st=zO(ce,ge,de,[0,0],1,ve,i,Z.perspectiveTransform||[0,0],2,v.mix||[0,0,0,0],v.range||[0,0]),ft=r.getOrCreateProgram("raster",{defines:v.defines});return r.uploadCommonUniforms(h,ft,null),void ft.draw(r,m.TRIANGLES,ee,wn.disabled,C,Cn.disabled,st,i.id,Qe,$e,Ie)}if(!o.length)return;const[z,B]=_ instanceof Vc||k?[{},o]:r.stencilConfigForOverlap(o),H=B[B.length-1].overscaledZ;for(const Z of B){const Y=k?Zr.disabled:r.depthModeForSublayer(Z.overscaledZ-H,i.paint.get("raster-opacity")===1?Zr.ReadWrite:Zr.ReadOnly,m.LESS),q=Z.toUnwrapped(),ee=e.getTile(Z);if(k&&(!ee||!ee.hasData())||!ee.texture)continue;const ce=k?Z.projMatrix:r.transform.calculateProjMatrix(q,P),de=r.terrain&&k?r.terrain.stencilModeForRTTOverlap(Z):z[Z.overscaledZ],ge=u?0:i.paint.get("raster-fade-duration");ee.registerFadeDuration(ge);const ve=e.findLoadedParent(Z,0),Re=MO(ee,ve,e,r.transform,ge);let ke,$e;r.terrain&&r.terrain.prepareDrawTile(),h.activeTexture.set(m.TEXTURE0),ee.texture.bind(R,m.CLAMP_TO_EDGE),h.activeTexture.set(m.TEXTURE1),ve?(ve.texture.bind(R,m.CLAMP_TO_EDGE),ke=Math.pow(2,ve.tileID.overscaledZ-ee.tileID.overscaledZ),$e=[ee.tileID.canonical.x*ke%1,ee.tileID.canonical.y*ke%1]):ee.texture.bind(R,m.CLAMP_TO_EDGE),ee.texture.useMipmap&&h.extTextureFilterAnisotropic&&r.transform.pitch>20&&m.texParameterf(m.TEXTURE_2D,h.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,h.extTextureFilterAnisotropicMax);const Ie=_ instanceof Vc?_.perspectiveTransform:[0,0],Qe=new Float32Array(16),st=zO(ce,Qe,Qe,$e||[0,0],ke||1,Re,i,Ie,2,v.mix||[0,0,0,0],v.range||[0,0]),ft=r.isTileAffectedByFog(Z),Je=r.getOrCreateProgram("raster",{defines:v.defines,overrideFog:ft});if(r.uploadCommonUniforms(h,Je,q),_ instanceof Vc)_.boundsBuffer&&_.boundsSegments&&Je.draw(r,m.TRIANGLES,Y,wn.disabled,C,Cn.disabled,st,i.id,_.boundsBuffer,r.quadTriangleIndexBuffer,_.boundsSegments);else{const{tileBoundsBuffer:tt,tileBoundsIndexBuffer:pt,tileBoundsSegments:bt}=r.getTileBoundsBuffers(ee);Je.draw(r,m.TRIANGLES,Y,de,C,Cn.disabled,st,i.id,tt,pt,bt)}}r.resetStencilClippingMasks()},background:function(r,e,i,o){const l=i.paint.get("background-color"),u=i.paint.get("background-opacity"),h=i.paint.get("background-emissive-strength");if(u===0)return;const m=r.context,_=m.gl,v=r.transform,x=v.tileSize,w=i.paint.get("background-pattern");if(r.isPatternMissing(w,i.scope))return;const C=!w&&l.a===1&&u===1&&r.opaquePassEnabledForLayer()?"opaque":"translucent";if(r.renderPass!==C)return;const k=wn.disabled,P=r.depthModeForSublayer(0,C==="opaque"?Zr.ReadWrite:Zr.ReadOnly),R=r.colorModeForDrapableLayerRenderPass(h),z=w?"backgroundPattern":"background";let B,H=o;H||(B=r.getBackgroundTiles(),H=Object.values(B).map(Z=>Z.tileID)),w&&(m.activeTexture.set(_.TEXTURE0),r.imageManager.bind(r.context,i.scope));for(const Z of H){const Y=r.isTileAffectedByFog(Z),q=r.getOrCreateProgram(z,{overrideFog:Y}),ee=Z.toUnwrapped(),ce=o?Z.projMatrix:r.transform.calculateProjMatrix(ee);r.prepareDrawTile();const de=e?e.getTile(Z):B?B[Z.key]:new gg(Z,x,v.zoom,r),ge=w?zq(ce,h,u,r,w,i.scope,{tileID:Z,tileSize:x}):Bq(ce,h,u,l);r.uploadCommonUniforms(m,q,ee);const{tileBoundsBuffer:ve,tileBoundsIndexBuffer:Re,tileBoundsSegments:ke}=r.getTileBoundsBuffers(de);q.draw(r,_.TRIANGLES,P,k,R,Cn.disabled,ge,i.id,ve,Re,ke)}},sky:function(r,e,i){const o=r._atmosphere?qa(r.transform.zoom):1,l=i.paint.get("sky-opacity")*o;if(l===0)return;const u=r.context,h=i.paint.get("sky-type"),m=new Zr(u.gl.LEQUAL,Zr.ReadOnly,[0,1]),_=r.frameCounter/1e3%1;h==="atmosphere"?r.renderPass==="offscreen"?i.needsSkyboxCapture(r)&&(function(v,x,w,C){const k=v.context,P=k.gl;let R=x.skyboxFbo;if(!R){R=x.skyboxFbo=k.createFramebuffer(32,32,!0,null),x.skyboxGeometry=new KO(k),x.skyboxTexture=k.gl.createTexture(),P.bindTexture(P.TEXTURE_CUBE_MAP,x.skyboxTexture),P.texParameteri(P.TEXTURE_CUBE_MAP,P.TEXTURE_WRAP_S,P.CLAMP_TO_EDGE),P.texParameteri(P.TEXTURE_CUBE_MAP,P.TEXTURE_WRAP_T,P.CLAMP_TO_EDGE),P.texParameteri(P.TEXTURE_CUBE_MAP,P.TEXTURE_MIN_FILTER,P.LINEAR),P.texParameteri(P.TEXTURE_CUBE_MAP,P.TEXTURE_MAG_FILTER,P.LINEAR);for(let Z=0;Z<6;++Z)P.texImage2D(P.TEXTURE_CUBE_MAP_POSITIVE_X+Z,0,P.RGBA,32,32,0,P.RGBA,P.UNSIGNED_BYTE,null)}k.bindFramebuffer.set(R.framebuffer),k.viewport.set([0,0,32,32]);const z=x.getCenter(v,!0),B=v.getOrCreateProgram("skyboxCapture"),H=new Float64Array(16);dt.identity(H),dt.rotateY(H,H,.5*-Math.PI),h0(v,x,B,H,z,0),dt.identity(H),dt.rotateY(H,H,.5*Math.PI),h0(v,x,B,H,z,1),dt.identity(H),dt.rotateX(H,H,.5*-Math.PI),h0(v,x,B,H,z,2),dt.identity(H),dt.rotateX(H,H,.5*Math.PI),h0(v,x,B,H,z,3),dt.identity(H),h0(v,x,B,H,z,4),dt.identity(H),dt.rotateY(H,H,Math.PI),h0(v,x,B,H,z,5),k.viewport.set([0,0,v.width,v.height])}(r,i),i.markSkyboxValid(r)):r.renderPass==="sky"&&function(v,x,w,C,k){const P=v.context,R=P.gl,z=v.transform,B=v.getOrCreateProgram("skybox");P.activeTexture.set(R.TEXTURE0),R.bindTexture(R.TEXTURE_CUBE_MAP,x.skyboxTexture);const H=((Z,Y,q,ee,ce)=>({u_matrix:Z,u_sun_direction:Y,u_cubemap:0,u_opacity:ee,u_temporal_offset:ce}))(z.skyboxMatrix,x.getCenter(v,!1),0,C,k);v.uploadCommonUniforms(P,B),B.draw(v,R.TRIANGLES,w,wn.disabled,v.colorModeForRenderPass(),Cn.backCW,H,"skybox",x.skyboxGeometry.vertexBuffer,x.skyboxGeometry.indexBuffer,x.skyboxGeometry.segment)}(r,i,m,l,_):h==="gradient"&&r.renderPass==="sky"&&function(v,x,w,C,k){const P=v.context,R=P.gl,z=v.transform,B=v.getOrCreateProgram("skyboxGradient");x.skyboxGeometry||(x.skyboxGeometry=new KO(P)),P.activeTexture.set(R.TEXTURE0);let H=x.colorRampTexture;H||(H=x.colorRampTexture=new Ia(P,x.colorRamp,R.RGBA)),H.bind(R.LINEAR,R.CLAMP_TO_EDGE);const Z=((Y,q,ee,ce,de)=>({u_matrix:Y,u_color_ramp:0,u_center_direction:q,u_radius:le(ee),u_opacity:ce,u_temporal_offset:de}))(z.skyboxMatrix,x.getCenter(v,!1),x.paint.get("sky-gradient-radius"),C,k);v.uploadCommonUniforms(P,B),B.draw(v,R.TRIANGLES,w,wn.disabled,v.colorModeForRenderPass(),Cn.backCW,Z,"skyboxGradient",x.skyboxGeometry.vertexBuffer,x.skyboxGeometry.indexBuffer,x.skyboxGeometry.segment)}(r,i,m,l,_)},debug:function(r,e,i){for(let o=0;o<i.length;o++)Qq(r,e,i[o])},custom:function(r,e,i,o){const l=r.context,u=i.implementation;if(!r.transform.projection.unsupportedLayers||!r.transform.projection.unsupportedLayers.includes("custom")||r.terrain&&(r.terrain.renderingToTexture||r.renderPass==="offscreen")&&i.isLayerDraped(e)){if(r.renderPass==="offscreen"){const h=u.prerender;if(h){if(r.setCustomLayerDefaults(),l.setColorMode(r.colorModeForRenderPass()),r.transform.projection.name==="globe"){const m=r.transform.pointMerc;h.call(u,l.gl,r.transform.customLayerMatrix(),r.transform.getProjection(),r.transform.globeToMercatorMatrix(),qa(r.transform.zoom),[m.x,m.y],r.transform.pixelsPerMeterRatio)}else h.call(u,l.gl,r.transform.customLayerMatrix());l.setDirty(),r.setBaseState()}}else if(r.renderPass==="translucent"){if(r.terrain&&r.terrain.renderingToTexture){const m=u.renderToTile;if(m){const _=o[0].canonical,v=new Pn(_.x+o[0].wrap*(1<<_.z),_.y,_.z);l.setDepthMode(Zr.disabled),l.setStencilMode(wn.disabled),l.setColorMode(r.colorModeForRenderPass()),r.setCustomLayerDefaults(),m.call(u,l.gl,v),l.setDirty(),r.setBaseState()}return}r.setCustomLayerDefaults(),l.setColorMode(r.colorModeForRenderPass()),l.setStencilMode(wn.disabled);const h=u.renderingMode==="3d"?new Zr(r.context.gl.LEQUAL,Zr.ReadWrite,r.depthRangeFor3D):r.depthModeForSublayer(0,Zr.ReadOnly);if(l.setDepthMode(h),r.transform.projection.name==="globe"){const m=r.transform.pointMerc;u.render(l.gl,r.transform.customLayerMatrix(),r.transform.getProjection(),r.transform.globeToMercatorMatrix(),qa(r.transform.zoom),[m.x,m.y],r.transform.pixelsPerMeterRatio)}else u.render(l.gl,r.transform.customLayerMatrix());l.setDirty(),r.setBaseState(),l.bindFramebuffer.set(null)}}else se("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")},model:function(r,e,i,o){if(r.renderPass==="opaque")return;const l=i.paint.get("model-opacity");if(l===0)return;const u=i.paint.get("model-cast-shadows");if(r.renderPass==="shadow"&&(!u||r.terrain&&l<.65&&i._transitionablePaint._values["model-opacity"].value.expression instanceof Af))return;const h=r.shadowRenderer,m=i.paint.get("model-receive-shadows");h&&(h.useNormalOffset=!0,m||(h.enabled=!1));const _=()=>{h&&(h.useNormalOffset=!0,m||(h.enabled=!0))},v=e.getSource();if(r.renderPass==="light-beam"&&v.type!=="batched-model")return;if(v.type==="vector"||v.type==="geojson")return function(B,H,Z,Y){const q=B.transform;if(q.projection.name!=="mercator")return void se(`Drawing 3D models for ${q.projection.name} projection is not yet implemented`);const ee=q.getFreeCameraOptions().position;if(!B.modelManager)return;const ce=B.modelManager,de=B.shadowRenderer;if(!Z._unevaluatedLayout._values.hasOwnProperty("model-id"))return;const ge=Z._unevaluatedLayout._values["model-id"],ve={...Z.layout.get("model-id").parameters};for(const Re of Y){const ke=H.getTile(Re).getBucket(Z);if(!ke||ke.projection.name!==q.projection.name)continue;const $e=sX(Re,q);ve.zoom=$e;const Ie=ge.possiblyEvaluate(ve);if(oX(B,ke,Re),Wc.shadowUniformsInitialized=!1,Wc.useSingleShadowCascade=!!de&&de.getMaxCascadeForTile(Re.toUnwrapped())===0,B.renderPass==="shadow"&&de){if(B.currentShadowCascade===1&&ke.isInsideFirstShadowMapFrustum)continue;const ft=q.calculatePosMatrix(Re.toUnwrapped(),q.worldSize);if(Wc.tileMatrix.set(ft),Wc.shadowTileMatrix=Float32Array.from(de.calculateShadowPassMatrixFromMatrix(ft)),Wc.aabb.min.fill(0),Wc.aabb.max[0]=Wc.aabb.max[1]=Et,Wc.aabb.max[2]=0,cX(ke,Wc,B,Z.scope))continue}const Qe=1<<Re.canonical.z,st=[((ee.x-Re.wrap)*Qe-Re.canonical.x)*Et,(ee.y*Qe-Re.canonical.y)*Et,ee.z*Qe*Et];for(let ft in ke.instancesPerModel){const Je=ke.instancesPerModel[ft];Je.features.length>0&&(ft=Ie.evaluate(Je.features[0].feature,{}));const tt=ce.getModel(ft,Z.scope);if(tt&&tt.uploaded)for(const pt of tt.nodes)QO(B,Z,pt,Je,st,Re,Wc)}}}(r,e,i,o),void _();if(!v.loaded())return;if(v.type==="batched-model")return function(B,H,Z,Y){const q=B.context,ee=B.transform,ce=B.style.fog,de=B.shadowRenderer;if(ee.projection.name!=="mercator")return void se(`Drawing 3D landmark models for ${ee.projection.name} projection is not yet implemented`);const ge=B.transform.getFreeCameraOptions().position,ve=We.scale([],[ge.x,ge.y,ge.z],B.transform.worldSize);We.negate(ve,ve);const Re=dt.identity([]),ke=Uf(ee.center.lat,ee.zoom),$e=dt.fromScaling([],[1,1,1/ke]);dt.translate(Re,Re,ve);const Ie=Z.paint.get("model-opacity"),Qe=new Zr(q.gl.LEQUAL,Zr.ReadWrite,B.depthRangeFor3D),st=new Zr(q.gl.LEQUAL,Zr.ReadOnly,B.depthRangeFor3D),ft=function(Je,tt){for(const pt of Y){const bt=H.getTile(pt).getBucket(Z);if(!bt||!bt.uploaded)continue;let St=!1;de&&(St=de.getMaxCascadeForTile(pt.toUnwrapped())===0);const Pt=ee.calculatePosMatrix(pt.toUnwrapped(),ee.worldSize),Ut=bt.modelTraits;for(const Tt of bt.getNodesInfo()){if(Tt.hiddenByReplacement||!Tt.node.meshes)continue;const Mt=Tt.node,tr=B.renderPass==="light-beam",ur=[...Pt],cr=Tt.evaluatedScale;let hr=0;B.terrain&&Mt.elevation&&(hr=Mt.elevation*B.terrain.exaggeration()),dt.translate(ur,ur,[(Mt.anchor?Mt.anchor[0]:0)*(cr[0]-1),(Mt.anchor?Mt.anchor[1]:0)*(cr[1]-1),hr]),cr!==VH&&dt.scale(ur,ur,cr),dt.multiply(ur,ur,Mt.matrix);const Mr=dt.multiply([],$e,ur);dt.multiply(Mr,Re,Mr);const jr=dt.invert([],Mr);dt.transpose(jr,jr),dt.scale(jr,jr,lX);const gn=dt.multiply([],ee.projMatrix,ur);for(let Bn=0;Bn<Mt.meshes.length;++Bn){const on=Mt.meshes[Bn],Qr=Bn===Mt.lightMeshIndex;if(Qr){if(!tr&&!B.terrain&&B.shadowRenderer){B.currentLayer<B.firstLightBeamLayer&&(B.firstLightBeamLayer=B.currentLayer);continue}}else if(tr)continue;const Vr={defines:[]},Dr=[];TT(Vr.defines,Dr,on,B),4&Ut||Vr.defines.push("DIFFUSE_SHADED"),St&&Vr.defines.push("SHADOWS_SINGLE_CASCADE");const In=B.renderPass==="shadow";if(In){ST(on,ur,B,Z);continue}let Un=null;if(ce){const Ti=YO(ur,B.transform);if(Un=new Float32Array(Ti),ee.projection.name!=="globe"){const ba=on.aabb.min,Ui=on.aabb.max,[ra,_i]=ce.getOpacityForBounds(Ti,ba[0],ba[1],Ui[0],Ui[1]);Vr.overrideFog=ra>=dd||_i>=dd}}const dn=B.getOrCreateProgram("model",Vr);!In&&de&&(de.useNormalOffset=!!on.normalBuffer,de.setupShadowsFromMatrix(ur,dn,de.useNormalOffset)),B.uploadCommonUniforms(q,dn,pt.toUnwrapped(),Un);const gi=on.material,Ni=gi.pbrMetallicRoughness;Ni.metallicFactor=.9,Ni.roughnessFactor=.5;const Ii=wT(new Float32Array(gn),new Float32Array(Mr),new Float32Array(jr),B,Ie,Ni.baseColorFactor,gi.emissiveFactor,Ni.metallicFactor,Ni.roughnessFactor,gi,Z);dn.draw(B,q.gl.TRIANGLES,tt&&!Qr?Qe:st,wn.disabled,Je?Qr||Ie<1||Tt.hasTranslucentParts?Nn.alphaBlended:Nn.unblended:Nn.disabled,Cn.backCCW,Ii,Z.id,on.vertexBuffer,on.indexBuffer,on.segments,Z.paint,B.transform.zoom,void 0,Dr)}}}};(function(Je,tt,pt,bt){const St=Je.terrain?Je.terrain.exaggeration():0,Pt=Je.transform.zoom;for(const Ut of bt){const Tt=tt.getTile(Ut).getBucket(pt);Tt&&(Je.conflationActive&&Tt.updateReplacement(Ut,Je.replacementSource),Tt.evaluateScale(Je,pt),Je.terrain&&St>0&&Tt.elevationUpdate(Je.terrain,St,Ut,pt.source),Tt.needsReEvaluation(Je,Pt,pt)&&Tt.evaluate(pt))}})(B,H,Z,Y),Ie===1?ft(!0,!0):(ft(!1,!0),ft(!0,!1))}(r,e,i,o),void _();const x=v.getModels(),w=[],C=r.transform.getFreeCameraOptions().position,k=We.scale([],[C.x,C.y,C.z],r.transform.worldSize);We.negate(k,k);const P=[],R=[];let z=0;for(const B of x){const H=i.paint.get("model-rotation").constantOr(null),Z=i.paint.get("model-scale").constantOr(null),Y=i.paint.get("model-translation").constantOr(null);B.computeModelMatrix(r,H,Z,Y,!0,!0,!1);const q=dt.identity([]),ee=Uf(B.position.lat,r.transform.zoom),ce=dt.fromScaling([],[1,1,1/ee]);dt.translate(q,q,k),w.push({zScaleMatrix:ce,negCameraPosMatrix:q});for(const de of B.nodes)JO(r.transform,de,B.matrix,r.transform.projMatrix,z,P,R);z++}if(P.sort((B,H)=>H.depth-B.depth),r.renderPass!=="shadow"){if(l===1)for(const B of R)Sy(B,r,i,w[B.modelIndex],wn.disabled,r.colorModeForRenderPass());else{for(const B of R)Sy(B,r,i,w[B.modelIndex],wn.disabled,Nn.disabled);for(const B of R)Sy(B,r,i,w[B.modelIndex],r.stencilModeFor3D(),r.colorModeForRenderPass());r.resetStencilClippingMasks()}for(const B of P)Sy(B,r,i,w[B.modelIndex],wn.disabled,r.colorModeForRenderPass());_()}else{for(const B of R)ST(B.mesh,B.nodeModelMatrix,r,i);for(const B of P)ST(B.mesh,B.nodeModelMatrix,r,i);_()}}},tR={modelUpload:function(r,e,i){const o=e.getSource();if(!o.loaded())return;if(o.type==="vector"||o.type==="geojson")return void(r.modelManager&&r.modelManager.upload(r,i));if(o.type==="batched-model")return;const l=o.getModels();for(const u of l)u.upload(r.context)}};class hX{constructor(e,i){this.context=new FH(e),this.transform=i,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.setup(),this.numSublayers=Kl.maxUnderzooming+Kl.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={},this.conflationActive=!1,this.replacementSource=new XH,this.longestCutoffRange=0,this.minCutoffZoom=0,this._fogVisible=!1,this._cachedTileFogOpacities={},this._shadowRenderer=new mX(this),this._wireframeDebugCache=new fX,this.renderDefaultNorthPole=!0,this.renderDefaultSouthPole=!0}updateTerrain(e,i){const o=!!e&&!!e.terrain&&this.transform.projection.supportsTerrain;if(!(o||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new wq(this,e));const l=this._terrain;this.transform.elevation=o?l:null,l.update(e,this.transform,i),this.transform.elevation&&!l.enabled&&(this.transform.elevation=null)}_updateFog(e){const i=e.fog;if(!i||this.transform.projection.name==="globe"||i.getOpacity(this.transform.pitch)<1||i.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[o,l]=i.getFovAdjustedRange(this.transform._fov);if(o>l)return void(this.transform.fogCullDistSq=null);const u=o+.78*(l-o);this.transform.fogCullDistSq=u*u}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled?this._terrain:null}get shadowRenderer(){return this._shadowRenderer&&this._shadowRenderer.enabled?this._shadowRenderer:null}get wireframeDebugCache(){return this._wireframeDebugCache}resize(e,i){if(this.width=e*Jr.devicePixelRatio,this.height=i*Jr.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const o of this.style.order)this.style._mergedLayers[o].resize()}setup(){const e=this.context,i=new Es;i.emplaceBack(0,0),i.emplaceBack(Et,0),i.emplaceBack(0,Et),i.emplaceBack(Et,Et),this.tileExtentBuffer=e.createVertexBuffer(i,Bf.members),this.tileExtentSegments=ui.simpleSegment(0,0,4,2);const o=new Es;o.emplaceBack(0,0),o.emplaceBack(Et,0),o.emplaceBack(0,Et),o.emplaceBack(Et,Et),this.debugBuffer=e.createVertexBuffer(o,Bf.members),this.debugSegments=ui.simpleSegment(0,0,4,5);const l=new Es;l.emplaceBack(-1,-1),l.emplaceBack(1,-1),l.emplaceBack(-1,1),l.emplaceBack(1,1),this.viewportBuffer=e.createVertexBuffer(l,Bf.members),this.viewportSegments=ui.simpleSegment(0,0,4,2);const u=new td;u.emplaceBack(0,0,0,0),u.emplaceBack(Et,0,Et,0),u.emplaceBack(0,Et,0,Et),u.emplaceBack(Et,Et,Et,Et),this.mercatorBoundsBuffer=e.createVertexBuffer(u,NE.members),this.mercatorBoundsSegments=ui.simpleSegment(0,0,4,2);const h=new Oa;h.emplaceBack(0,1,2),h.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=e.createIndexBuffer(h);const m=new Xm;for(const v of[0,1,3,2,0])m.emplaceBack(v);this.debugIndexBuffer=e.createIndexBuffer(m),this.emptyTexture=new Ia(e,new da({width:1,height:1},Uint8Array.of(0,0,0,0)),e.gl.RGBA),this.identityMat=dt.create();const _=this.context.gl;this.stencilClearMode=new wn({func:_.ALWAYS,mask:0},0,255,_.ZERO,_.ZERO,_.ZERO),this.loadTimeStamps.push(g.performance.now())}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(e){return e._makeTileBoundsBuffers(this.context,this.transform.projection),e._tileBoundsBuffer?{tileBoundsBuffer:e._tileBoundsBuffer,tileBoundsIndexBuffer:e._tileBoundsIndexBuffer,tileBoundsSegments:e._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const e=this.context.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.getOrCreateProgram("clippingMask").draw(this,e.TRIANGLES,Zr.disabled,this.stencilClearMode,Nn.disabled,Cn.disabled,bT(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(e,i,o){if(!i||this.currentStencilSource===i.id||!e.isTileClipped()||!o||o.length===0)return;if(this._tileClippingMaskIDs&&!this.terrain){let m=!1;for(const _ of o)if(this._tileClippingMaskIDs[_.key]===void 0){m=!0;break}if(!m)return}this.currentStencilSource=i.id;const l=this.context,u=l.gl;this.nextStencilID+o.length>256&&this.clearStencil(),l.setColorMode(Nn.disabled),l.setDepthMode(Zr.disabled);const h=this.getOrCreateProgram("clippingMask");this._tileClippingMaskIDs={};for(const m of o){const _=i.getTile(m),v=this._tileClippingMaskIDs[m.key]=this.nextStencilID++,{tileBoundsBuffer:x,tileBoundsIndexBuffer:w,tileBoundsSegments:C}=this.getTileBoundsBuffers(_);h.draw(this,u.TRIANGLES,Zr.disabled,new wn({func:u.ALWAYS,mask:0},v,255,u.KEEP,u.KEEP,u.REPLACE),Nn.disabled,Cn.disabled,bT(m.projMatrix),"$clipping",x,w,C)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const e=this.nextStencilID++,i=this.context.gl;return new wn({func:i.NOTEQUAL,mask:255},e,255,i.KEEP,i.KEEP,i.REPLACE)}stencilModeForClipping(e){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(e);const i=this.context.gl;return new wn({func:i.EQUAL,mask:255},this._tileClippingMaskIDs[e.key],0,i.KEEP,i.KEEP,i.REPLACE)}stencilConfigForOverlap(e){const i=this.context.gl,o=e.sort((h,m)=>m.overscaledZ-h.overscaledZ),l=o[o.length-1].overscaledZ,u=o[0].overscaledZ-l+1;if(u>1){this.currentStencilSource=void 0,this.nextStencilID+u>256&&this.clearStencil();const h={};for(let m=0;m<u;m++)h[m+l]=new wn({func:i.GEQUAL,mask:255},m+this.nextStencilID,255,i.KEEP,i.KEEP,i.REPLACE);return this.nextStencilID+=u,[h,o]}return[{[l]:wn.disabled},o]}colorModeForRenderPass(){const e=this.context.gl;return this._showOverdrawInspector?new Nn([e.CONSTANT_COLOR,e.ONE,e.CONSTANT_COLOR,e.ONE],new hn(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Nn.unblended:Nn.alphaBlended}colorModeForDrapableLayerRenderPass(e){const i=this.context.gl;return(()=>this.style&&this.style.enable3dLights()&&this.terrain&&this.terrain.renderingToTexture)()&&this.renderPass==="translucent"?new Nn([i.ONE,i.ONE_MINUS_SRC_ALPHA,i.CONSTANT_ALPHA,i.ONE_MINUS_SRC_ALPHA],new hn(0,0,0,e===void 0?0:e),[!0,!0,!0,!0]):this.colorModeForRenderPass()}depthModeForSublayer(e,i,o,l=!1){if(!this.opaquePassEnabledForLayer()&&!l)return Zr.disabled;const u=1-((1+this.currentLayer)*this.numSublayers+e)*this.depthEpsilon;return new Zr(o||this.context.gl.LEQUAL,i,[u,u])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(e,i){this._wireframeDebugCache.update(this.frameCounter),this.style=e,this.options=i;const o=this.style._mergedLayers,l=this.style.order,u=l.map(q=>o[q]),h=this.style._mergedSourceCaches;this.imageManager=e.imageManager,this.modelManager=e.modelManager,this.symbolFadeChange=e.placement.symbolFadeChange(Jr.now()),this.imageManager.beginFrame();let m=0,_=!1;for(const q in h){const ee=h[q];ee.used&&(ee.prepare(this.context),ee.getSource().usedInConflation&&++m)}const v={},x={},w={},C={},k={};for(const q in h){const ee=h[q];v[q]=ee.getVisibleCoordinates(),x[q]=v[q].slice().reverse(),w[q]=ee.getVisibleCoordinates(!0).reverse(),C[q]=ee.getShadowCasterCoordinates(),k[q]=ee.sortCoordinatesByDistance(v[q])}const P=q=>{const ee=this.style.getLayerSourceCache(q);return ee&&ee.used?ee.getSource():null};if(m){const q=[];for(const ee of u)this.layerUsedInConflation(ee,P(ee))&&q.push(ee);if(q&&q.length>1){const ee=[];for(const ce of q){const de=this.style.getLayerSourceCache(ce);de&&de.used&&de.getSource().usedInConflation&&ee.push({layer:ce.fqid,cache:de})}this.replacementSource.setSources(ee),_=!0}}_||this.replacementSource.clear(),this.conflationActive=_,this.minCutoffZoom=0,this.longestCutoffRange=0;for(const q of u){const ee=q.cutoffRange();if(this.longestCutoffRange=Math.max(ee,this.longestCutoffRange),ee>0){const ce=P(q);ce&&(this.minCutoffZoom=Math.max(ce.minzoom,this.minCutoffZoom)),q.minzoom&&(this.minCutoffZoom=Math.max(q.minzoom,this.minCutoffZoom))}}this.opaquePassCutoff=1/0;for(let q=0;q<u.length;q++)if(u[q].is3D()){this.opaquePassCutoff=q;break}const R=this.style&&this.style.fog;R?(this._fogVisible=R.getOpacity(this.transform.pitch)!==0,this._fogVisible&&this.transform.projection.name!=="globe"&&(this._fogVisible=R.isVisibleOnFrustum(this.transform.cameraFrustum))):this._fogVisible=!1,this._cachedTileFogOpacities={},this.terrain&&(this.terrain.updateTileBinding(w),this.opaquePassCutoff=0);const z=this._shadowRenderer;if(z){z.updateShadowParameters(this.transform,this.style.directionalLight);for(const q in h)for(const ee of v[q]){let ce={min:0,max:0};this.terrain&&(ce=this.terrain.getMinMaxForTile(ee)||ce),z.addShadowReceiver(ee.toUnwrapped(),ce.min,ce.max)}}this.transform.projection.name!=="globe"||this.globeSharedBuffers||(this.globeSharedBuffers=new ZV(this.context));for(const q of u){if(q.isHidden(this.transform.zoom))continue;const ee=e.getLayerSourceCache(q);this.uploadLayer(this,q,ee)}if(this.style.fog&&this.transform.projection.supportsFog?(this._atmosphere||(this._atmosphere=new aX),this._atmosphere.update(this)):this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0),!Ca.has(this.context.gl))return;this.renderPass="offscreen";for(const q of u){const ee=e.getLayerSourceCache(q);if(!q.hasOffscreenPass()||q.isHidden(this.transform.zoom))continue;const ce=ee?x[ee.id]:void 0;(q.type==="custom"||q.type==="raster"||q.isSky()||ce&&ce.length)&&this.renderLayer(this,ee,q,ce)}this.depthRangeFor3D=[0,1-(u.length+2)*this.numSublayers*this.depthEpsilon];const B=this.terrain;B&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&!this.transform.isOrthographic&&B.drawDepth(),this._shadowRenderer&&(this.renderPass="shadow",this._shadowRenderer.drawShadowPass(this.style,C)),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]);const H=this.transform.projection.name==="globe"||this.transform.isHorizonVisible(),Z=(()=>{if(i.showOverdrawInspector)return hn.black;if(this.style.fog&&this.transform.projection.supportsFog&&!H){const q=this.style.fog.properties.get("color").toArray01();return new hn(...q)}if(this.style.fog&&this.transform.projection.supportsFog&&H){const q=this.style.fog.properties.get("space-color").toArray01();return new hn(...q)}return hn.transparent})();if(this.context.clear({color:Z,depth:1}),this.clearStencil(),this._showOverdrawInspector=i.showOverdrawInspector,this.renderPass="opaque",this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&H&&this._atmosphere.drawStars(this,this.style.fog),!this.terrain)for(this.currentLayer=l.length-1;this.currentLayer>=0;this.currentLayer--){const q=u[this.currentLayer],ee=e.getLayerSourceCache(q);if(q.isSky())continue;const ce=ee?(q.is3D()?k:x)[ee.id]:void 0;this._renderTileClippingMasks(q,ee,ce),this.renderLayer(this,ee,q,ce)}if(this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&H&&this._atmosphere.drawAtmosphereGlow(this,this.style.fog),this.renderPass="sky",(!this._atmosphere||qa(this.transform.zoom)>0)&&(this.transform.projection.name==="globe"||this.transform.isHorizonVisible()))for(this.currentLayer=0;this.currentLayer<l.length;this.currentLayer++){const q=u[this.currentLayer],ee=e.getLayerSourceCache(q);q.isSky()&&this.renderLayer(this,ee,q,ee?x[ee.id]:void 0)}this.renderPass="translucent",this.currentLayer=0,this.firstLightBeamLayer=Number.MAX_SAFE_INTEGER;let Y=0;for(z&&(Y=z.getShadowCastingLayerCount());this.currentLayer<l.length;){const q=u[this.currentLayer],ee=e.getLayerSourceCache(q);if(q.isSky()){++this.currentLayer;continue}if(B&&this.style.isLayerDraped(q)){if(q.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=B.renderBatch(this.currentLayer);continue}let ce;if(ee&&(ce=(q.type==="symbol"?w:q.is3D()?k:x)[ee.id]),this._renderTileClippingMasks(q,ee,ee?v[ee.id]:void 0),this.renderLayer(this,ee,q,ce),!B&&z&&Y>0&&q.hasShadowPass()&&--Y==0&&(z.drawGroundShadows(),this.firstLightBeamLayer<=this.currentLayer)){const de=this.currentLayer;for(this.renderPass="light-beam",this.currentLayer=this.firstLightBeamLayer;this.currentLayer<=de;this.currentLayer++){const ge=u[this.currentLayer];if(!ge.hasLightBeamPass())continue;const ve=e.getLayerSourceCache(ge);this.renderLayer(this,ve,ge,ve?x[ve.id]:void 0)}this.currentLayer=de,this.renderPass="translucent"}++this.currentLayer}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let q=null;u.forEach(ee=>{const ce=e.getLayerSourceCache(ee);ce&&!ee.isHidden(this.transform.zoom)&&ce.getVisibleCoordinates().length&&(!q||q.getSource().maxzoom<ce.getSource().maxzoom)&&(q=ce)}),q&&this.options.showTileBoundaries&&eR.debug(this,q,q.getVisibleCoordinates())}this.options.showPadding&&function(q){const ee=q.transform.padding;XO(q,q.transform.height-(ee.top||0),3,Xq),XO(q,ee.bottom||0,3,Zq),ZO(q,ee.left||0,3,Kq),ZO(q,q.transform.width-(ee.right||0),3,Yq);const ce=q.transform.centerPoint;(function(de,ge,ve,Re){Ty(de,ge-1,ve-10,2,20,Re),Ty(de,ge-10,ve-1,20,2,Re)})(q,ce.x,q.transform.height-ce.y,Jq)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(g.performance.now()),this.saveCanvasCopy()),_||(this.conflationActive=!1)}uploadLayer(e,i,o){this.gpuTimingStart(i),(!e.transform.projection.unsupportedLayers||!e.transform.projection.unsupportedLayers.includes(i.type)||e.terrain&&i.type==="custom")&&tR[`${i.type}Upload`]&&tR[`${i.type}Upload`](e,o,i.scope),this.gpuTimingEnd()}renderLayer(e,i,o,l){o.isHidden(this.transform.zoom)||(o.type==="background"||o.type==="sky"||o.type==="custom"||o.type==="model"||o.type==="raster"||l&&l.length)&&(this.id=o.id,this.gpuTimingStart(o),(!e.transform.projection.unsupportedLayers||!e.transform.projection.unsupportedLayers.includes(o.type)||e.terrain&&o.type==="custom")&&eR[o.type](e,i,o,l,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(e){if(!this.options.gpuTiming)return;const i=this.context.extTimerQuery,o=this.context.gl;let l=this.gpuTimers[e.id];l||(l=this.gpuTimers[e.id]={calls:0,cpuTime:0,query:o.createQuery()}),l.calls++,o.beginQuery(i.TIME_ELAPSED_EXT,l.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const e=this.context.extTimerQuery,i=this.context.gl,o=i.createQuery();this.deferredRenderGpuTimeQueries.push(o),i.beginQuery(e.TIME_ELAPSED_EXT,o)}}gpuTimingDeferredRenderEnd(){this.options.gpuTimingDeferredRender&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}gpuTimingEnd(){this.options.gpuTiming&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}collectGpuTimers(){const e=this.gpuTimers;return this.gpuTimers={},e}collectDeferredRenderGpuQueries(){const e=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],e}queryGpuTimers(e){const i={};for(const o in e){const l=e[o],u=this.context.extTimerQuery,h=u.getQueryParameter(l.query,this.context.gl.QUERY_RESULT)/1e6;u.deleteQueryEXT(l.query),i[o]=h}return i}queryGpuTimeDeferredRender(e){if(!this.options.gpuTimingDeferredRender)return 0;const i=this.context.extTimerQuery,o=this.context.gl;let l=0;for(const u of e)l+=i.getQueryParameter(u,o.QUERY_RESULT)/1e6,i.deleteQueryEXT(u);return l}translatePosMatrix(e,i,o,l,u){if(!o[0]&&!o[1])return e;const h=u?l==="map"?this.transform.angle:0:l==="viewport"?-this.transform.angle:0;if(h){const v=Math.sin(h),x=Math.cos(h);o=[o[0]*x-o[1]*v,o[0]*v+o[1]*x]}const m=[u?o[0]:ud(i,o[0],this.transform.zoom),u?o[1]:ud(i,o[1],this.transform.zoom),0],_=new Float32Array(16);return dt.translate(_,e,m),_}saveTileTexture(e){const i=this._tileTextures[e.size[0]];i?i.push(e):this._tileTextures[e.size[0]]=[e]}getTileTexture(e){const i=this._tileTextures[e];return i&&i.length>0?i.pop():null}isPatternMissing(e,i){return e===null||e!==void 0&&!this.imageManager.getPattern(e.toString(),i)}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture}terrainUseFloatDEM(){return this.context.extTextureFloatLinear!=null}currentGlobalDefines(e,i,o){const l=o===void 0?this.terrain&&this.terrain.renderingToTexture:o,u=this.terrain&&this.terrain.exaggeration()===0,h=[];return this.style&&this.style.enable3dLights()&&(e==="globeRaster"||e==="terrainRaster"?(h.push("LIGHTING_3D_MODE"),h.push("LIGHTING_3D_ALPHA_EMISSIVENESS")):l||h.push("LIGHTING_3D_MODE")),this.renderPass==="shadow"?this._shadowMapDebug||h.push("DEPTH_TEXTURE"):this.shadowRenderer&&(this.shadowRenderer.useNormalOffset?h.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET"):h.push("RENDER_SHADOWS","DEPTH_TEXTURE")),this.terrainRenderModeElevated()&&(h.push("TERRAIN"),this.terrainUseFloatDEM()&&h.push("TERRAIN_DEM_FLOAT_FORMAT"),u&&h.push("ZERO_EXAGGERATION")),this.transform.projection.name==="globe"&&h.push("GLOBE"),!this._fogVisible||l||i!==void 0&&!i||h.push("FOG","FOG_DITHERING"),l&&h.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&h.push("OVERDRAW_INSPECTOR"),h}getOrCreateProgram(e,i){this.cache=this.cache||{};const o=i&&i.defines||[],l=i&&i.config,u=this.currentGlobalDefines(e,i&&i.overrideFog,i&&i.overrideRtt).concat(o),h=PO.cacheKey(wO[e],e,u,l);return this.cache[h]||(this.cache[h]=new PO(this.context,e,wO[e],l,Nq[e],u)),this.cache[h]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const e=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(e.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=g.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new Ia(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this._wireframeDebugCache.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}uploadCommonLightUniforms(e,i){if(this.style.enable3dLights()){const o=this.style.directionalLight,l=this.style.ambientLight;if(o&&l){const u=((h,m)=>{const _=h.properties.get("direction"),v=h.properties.get("color").toArray01(),x=h.properties.get("intensity"),w=m.properties.get("color").toArray01(),C=m.properties.get("intensity"),k=[_.x,_.y,_.z],P=Lt(w,C),R=Lt(v,x);return{u_lighting_ambient_color:P,u_lighting_directional_dir:k,u_lighting_directional_color:R,u_ground_radiance:Eq(k,R,P)}})(o,l);i.setLightsUniformValues(e,u)}}}uploadCommonUniforms(e,i,o,l,u){if(this.uploadCommonLightUniforms(e,i),this.terrain&&this.terrain.renderingToTexture)return;const h=this.style.fog;if(h){const m=h.getOpacity(this.transform.pitch),_=((v,x,w,C,k,P,R,z,B,H,Z,Y)=>{const q=v.transform,ee=x.properties.get("color").toArray01();ee[3]=C;const ce=v.frameCounter/1e3%1,[de,ge]=x.properties.get("vertical-range");return{u_fog_matrix:w?q.calculateFogTileMatrix(w):Y||v.identityMat,u_fog_range:x.getFovAdjustedRange(q._fov),u_fog_color:ee,u_fog_horizon_blend:x.properties.get("horizon-blend"),u_fog_vertical_limit:[Math.min(de,ge),ge],u_fog_temporal_offset:ce,u_frustum_tl:k,u_frustum_tr:P,u_frustum_br:R,u_frustum_bl:z,u_globe_pos:B,u_globe_radius:H,u_viewport:Z,u_globe_transition:qa(q.zoom),u_is_globe:+(q.projection.name==="globe")}})(this,h,o,m,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*Jr.devicePixelRatio,this.transform.height*Jr.devicePixelRatio],l);i.setFogUniformValues(e,_)}u&&i.setCutoffUniformValues(e,u.uniformValues)}setTileLoadedFlag(e){this.tileLoaded=e}saveCanvasCopy(){const e=this.canvasCopy();e&&(this.frameCopies.push(e),this.tileLoaded=!1)}canvasCopy(){const e=this.context.gl,i=e.createTexture();return e.bindTexture(e.TEXTURE_2D,i),e.copyTexImage2D(e.TEXTURE_2D,0,e.RGBA,0,0,e.drawingBufferWidth,e.drawingBufferHeight,0),i}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const e=this.style&&this.style.fog;return!!e&&e.getOpacity(this.transform.pitch)!==0}getBackgroundTiles(){const e=this._backgroundTiles,i=this._backgroundTiles={},o=this.transform.coveringTiles({tileSize:512});for(const l of o)i[l.key]=e[l.key]||new gg(l,512,this.transform.tileZoom,this);return i}clearBackgroundTiles(){this._backgroundTiles={}}layerUsedInConflation(e,i){return!(!e.is3D()||e.minzoom&&e.minzoom>this.transform.zoom||e.sourceLayer!=="building"&&(!i||i.type!=="batched-model"))}isTileAffectedByFog(e){if(!this.style||!this.style.fog)return!1;if(this.transform.projection.name==="globe")return!0;let i=this._cachedTileFogOpacities[e.key];return i||(this._cachedTileFogOpacities[e.key]=i=this.style.fog.getOpacityForTile(e)),i[0]>=dd||i[1]>=dd}}const gd=2048;class dX{constructor(e,i){this.aabb=e,this.lastCascade=i}}class pX{add(e,i){const o=this.receivers[e.key];o!==void 0?(o.aabb.min[0]=Math.min(o.aabb.min[0],i.min[0]),o.aabb.min[1]=Math.min(o.aabb.min[1],i.min[1]),o.aabb.min[2]=Math.min(o.aabb.min[2],i.min[2]),o.aabb.max[0]=Math.max(o.aabb.max[0],i.max[0]),o.aabb.max[1]=Math.max(o.aabb.max[1],i.max[1]),o.aabb.max[2]=Math.max(o.aabb.max[2],i.max[2])):this.receivers[e.key]=new dX(i,null)}clear(){this.receivers={}}get(e){return this.receivers[e.key]}computeRequiredCascades(e,i,o){const l=Oi.fromPoints(e.points);let u=0;for(const h in this.receivers){const m=this.receivers[h];if(!m||!l.intersectsAabb(m.aabb))continue;m.aabb.min=l.closestPoint(m.aabb.min),m.aabb.max=l.closestPoint(m.aabb.max);const _=m.aabb.getCorners();for(let v=0;v<o.length;v++){let x=!0;for(const w of _){const C=[w[0]*i,w[1]*i,w[2]];if(We.transformMat4(C,C,o[v].matrix),C[0]<-1||C[0]>1||C[1]<-1||C[1]>1){x=!1;break}}if(m.lastCascade=v,u=Math.max(u,v),x)break}}return u+1}}class mX{constructor(e){this.painter=e,this._enabled=!1,this._shadowLayerCount=0,this._numCascadesToRender=0,this._cascades=[],this._groundShadowTiles=[],this._receivers=new pX,this._depthMode=new Zr(e.context.gl.LEQUAL,Zr.ReadWrite,[0,1]),this._uniformValues={u_light_matrix_0:new Float32Array(16),u_light_matrix_1:new Float32Array(16),u_shadow_intensity:0,u_fade_range:[0,0],u_shadow_normal_offset:[1,1,1],u_shadow_texel_size:1,u_shadow_map_resolution:1,u_shadow_direction:[0,0,1],u_shadow_bias:[36e-5,.0012,.012],u_shadowmap_0:0,u_shadowmap_1:0},this.useNormalOffset=!1}destroy(){for(const e of this._cascades)e.texture.destroy(),e.framebuffer.destroy();this._cascades=[]}updateShadowParameters(e,i){const o=this.painter;if(this._enabled=!1,this._shadowLayerCount=0,this._receivers.clear(),!i||!i.properties)return;const l=i.properties.get("shadow-intensity");if(!i.shadowsEnabled()||l<=0||(this._shadowLayerCount=o.style.order.reduce((k,P)=>{const R=o.style._mergedLayers[P];return k+(R.hasShadowPass()&&!R.isHidden(e.zoom)?1:0)},0),this._enabled=this._shadowLayerCount>0,!this._enabled))return;const u=o.context,h=gd,m=gd;if(this._cascades.length===0)for(let k=0;k<2;++k){const P=o._shadowMapDebug,R=u.gl,z=u.createFramebuffer(h,m,P,"texture"),B=new Ia(u,{width:h,height:m,data:null},R.DEPTH_COMPONENT);if(z.depthAttachment.set(B.texture),P){const H=new Ia(u,{width:h,height:m,data:null},R.RGBA);z.colorAttachment.set(H.texture)}this._cascades.push({framebuffer:z,texture:B,matrix:[],far:0,boundingSphereRadius:0,frustum:new ku,scale:0})}this.shadowDirection=rR(i);let _=0;if(e.elevation){const k=e.elevation,P=[1e4,-1e4];k.visibleDemTiles.filter(R=>R.dem).forEach(R=>{const z=R.dem.tree;P[0]=Math.min(P[0],z.minimums[0]),P[1]=Math.max(P[1],z.maximums[0])}),P[0]!==1e4&&(_=(P[1]-P[0])*k.exaggeration())}const v=1.5*e.cameraToCenterDistance,x=3*v,w=new Float64Array(16);for(let k=0;k<2;++k){const P=this._cascades[k];let R=e.height/50,z=1;k===0?z=v:(R=v,z=x);const[B,H]=gX(e,this.shadowDirection,R,z,gd,_);P.scale=e.scale,P.matrix=B,P.boundingSphereRadius=H,dt.invert(w,P.matrix),P.frustum=ku.fromInvProjectionMatrix(w,1,0,!0),P.far=z}this._uniformValues.u_fade_range=[.75*this._cascades[1].far,this._cascades[1].far],this._uniformValues.u_shadow_intensity=l,this._uniformValues.u_shadow_direction=[this.shadowDirection[0],this.shadowDirection[1],this.shadowDirection[2]],this._uniformValues.u_shadow_texel_size=.00048828125,this._uniformValues.u_shadow_map_resolution=gd,this._uniformValues.u_shadowmap_0=Cs.ShadowMap0,this._uniformValues.u_shadowmap_1=Cs.ShadowMap0+1,this._groundShadowTiles=o.transform.coveringTiles({tileSize:512,renderWorldCopies:!0});const C=o.transform.elevation;for(const k of this._groundShadowTiles){let P={min:0,max:0};if(C){const R=C.getMinMaxForTile(k);R&&(P=R)}this.addShadowReceiver(k.toUnwrapped(),P.min,P.max)}}get enabled(){return this._enabled}set enabled(e){this._enabled=e}drawShadowPass(e,i){if(!this._enabled)return;const o=this.painter,l=o.context;this._numCascadesToRender=this._receivers.computeRequiredCascades(o.transform.getFrustum(0),o.transform.worldSize,this._cascades),l.viewport.set([0,0,gd,gd]);for(let u=0;u<this._numCascadesToRender;++u){o.currentShadowCascade=u,l.bindFramebuffer.set(this._cascades[u].framebuffer.framebuffer),l.clear({color:hn.white,depth:1});for(const h of e.order){const m=e._mergedLayers[h];if(!m.hasShadowPass()||m.isHidden(o.transform.zoom))continue;const _=e.getLayerSourceCache(m),v=_?i[_.id]:void 0;(m.type==="model"||v&&v.length)&&o.renderLayer(o,_,m,v)}}o.currentShadowCascade=0}drawGroundShadows(){if(!this._enabled)return;const e=this.painter,i=e.style,o=e.context,l=i.directionalLight,u=i.ambientLight;if(!l||!u)return;const h=[],m=c0(e,e.longestCutoffRange);m.shouldRenderCutoff&&h.push("RENDER_CUTOFF");const _=CT(l,u),v=new Zr(o.gl.LEQUAL,Zr.ReadOnly,e.depthRangeFor3D);for(const x of this._groundShadowTiles){const w=x.toUnwrapped(),C=e.isTileAffectedByFog(x),k=e.getOrCreateProgram("groundShadow",{defines:h,overrideFog:C});this.setupShadows(w,k),e.uploadCommonUniforms(o,k,w,null,m);const P={u_matrix:e.transform.calculateProjMatrix(w),u_ground_shadow_factor:_};k.draw(e,o.gl.TRIANGLES,v,wn.disabled,Nn.multiply,Cn.disabled,P,"ground_shadow",e.tileExtentBuffer,e.quadTriangleIndexBuffer,e.tileExtentSegments,{},e.transform.zoom,null,null)}}getShadowPassColorMode(){return this.painter._shadowMapDebug?Nn.unblended:Nn.disabled}getShadowPassDepthMode(){return this._depthMode}getShadowCastingLayerCount(){return this._shadowLayerCount}calculateShadowPassMatrixFromTile(e){const i=this.painter.transform,o=i.calculatePosMatrix(e,i.worldSize);return dt.multiply(o,this._cascades[this.painter.currentShadowCascade].matrix,o),Float32Array.from(o)}calculateShadowPassMatrixFromMatrix(e){return dt.multiply(e,this._cascades[this.painter.currentShadowCascade].matrix,e),Float32Array.from(e)}setupShadows(e,i,o,l=0){if(!this._enabled)return;const u=this.painter.transform,h=this.painter.context,m=h.gl,_=this._uniformValues,v=new Float64Array(16),x=u.calculatePosMatrix(e,u.worldSize);for(let w=0;w<2;w++)dt.multiply(v,this._cascades[w].matrix,x),_[w===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(v),h.activeTexture.set(m.TEXTURE0+Cs.ShadowMap0+w),this._cascades[w].texture.bind(m.NEAREST,m.CLAMP_TO_EDGE);if(this.useNormalOffset=!!o,this.useNormalOffset){const w=rg(e.canonical),C=2/u.tileSize*Et/gd,k=C*this._cascades[0].boundingSphereRadius,P=C*this._cascades[1].boundingSphereRadius,R=(o==="vector-tile"?1:3)/Math.pow(2,l-e.canonical.z-(1-u.zoom+Math.floor(u.zoom)));_.u_shadow_normal_offset=[w,k*R,P*R],_.u_shadow_bias=[6e-5,.0012,.012]}else _.u_shadow_bias=[36e-5,.0012,.012];i.setShadowUniformValues(h,_)}setupShadowsFromMatrix(e,i,o=!1){if(!this._enabled)return;const l=this.painter.context,u=l.gl,h=this._uniformValues,m=new Float64Array(16);for(let _=0;_<2;_++)dt.multiply(m,this._cascades[_].matrix,e),h[_===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(m),l.activeTexture.set(u.TEXTURE0+Cs.ShadowMap0+_),this._cascades[_].texture.bind(u.NEAREST,u.CLAMP_TO_EDGE);this.useNormalOffset=o,o?(h.u_shadow_normal_offset=[1,5,5],h.u_shadow_bias=[6e-5,.0012,.012]):h.u_shadow_bias=[36e-5,.0012,.012],i.setShadowUniformValues(l,h)}getShadowUniformValues(){return this._uniformValues}getCurrentCascadeFrustum(){return this._cascades[this.painter.currentShadowCascade].frustum}computeSimplifiedTileShadowVolume(e,i,o,l){if(l[2]>=0)return{};const u=function(_,v,x){const w=x/(1<<_.canonical.z);return new Oi([_.canonical.x*w+_.wrap*x,_.canonical.y*w+_.wrap*x,0],[(_.canonical.x+1)*w+_.wrap*x,(_.canonical.y+1)*w+_.wrap*x,v])}(e,i,o).getCorners(),h=i/-l[2];l[0]<0?(We.add(u[0],u[0],[l[0]*h,0,0]),We.add(u[3],u[3],[l[0]*h,0,0])):l[0]>0&&(We.add(u[1],u[1],[l[0]*h,0,0]),We.add(u[2],u[2],[l[0]*h,0,0])),l[1]<0?(We.add(u[0],u[0],[0,l[1]*h,0]),We.add(u[1],u[1],[0,l[1]*h,0])):l[1]>0&&(We.add(u[2],u[2],[0,l[1]*h,0]),We.add(u[3],u[3],[0,l[1]*h,0]));const m={};return m.vertices=u,m.planes=[Cy(u[1],u[0],u[4]),Cy(u[2],u[1],u[5]),Cy(u[3],u[2],u[6]),Cy(u[0],u[3],u[7])],m}addShadowReceiver(e,i,o){this._receivers.add(e,Oi.fromTileIdAndHeight(e,i,o))}getMaxCascadeForTile(e){const i=this._receivers.get(e);return i&&i.lastCascade?i.lastCascade:0}}function Cy(r,e,i){const o=We.sub([],i,e),l=We.sub([],r,e),u=We.cross([],o,l),h=We.length(u);return h===0?[0,0,1,0]:(We.scale(u,u,1/h),[u[0],u[1],u[2],-We.dot(u,e)])}function rR(r){const e=r.properties.get("direction"),i=Xe(e.x,e.y,e.z);i[2]=Oe(i[2],0,75);const o=ye([i[0],i[1],i[2]]);return We.fromValues(o.x,o.y,o.z)}function CT(r,e){const i=r.properties.get("color"),o=r.properties.get("intensity"),l=r.properties.get("direction"),u=[l.x,l.y,l.z],h=e.properties.get("color"),m=e.properties.get("intensity"),_=Math.max(We.dot([0,0,1],u),0),v=[0,0,0];We.scale(v,h.toArray01Linear().slice(0,3),m);const x=[0,0,0];return We.scale(x,i.toArray01Linear().slice(0,3),_*o),Qt([v[0]>0?v[0]/(v[0]+x[0]):0,v[1]>0?v[1]/(v[1]+x[1]):0,v[2]>0?v[2]/(v[2]+x[2]):0])}function gX(r,e,i,o,l,u){const h=r.zoom,m=r.scale,_=r.worldSize,v=1/_,x=r.aspect,w=Math.sqrt(1+x*x)*Math.tan(.5*r.fovX),C=w*w,k=o-i,P=o+i;let R,z;C>k/P?(R=o,z=o*w):(R=.5*P*(1+C),z=.5*Math.sqrt(k*k+2*(o*o+i*i)*C+P*P*C*C));const B=r.projection.pixelsPerMeter(r.center.lat,_),H=r._camera.getCameraToWorldMercator(),Z=[0,0,-R*v];We.transformMat4(Z,Z,H);let Y=z*v;const q=r._edgeInsets;if(!(q.left===0&&q.top===0&&q.right===0&&q.bottom===0||q.left===q.right&&q.top===q.bottom)){const bt=r._camera.getWorldToCamera(r.worldSize,r.projection.zAxisUnit==="meters"?B:1),St=r._camera.getCameraToClipPerspective(r._fov,r.width/r.height,i,o);St[8]=2*-r.centerOffset.x/r.width,St[9]=2*r.centerOffset.y/r.height;const Pt=new Float64Array(16);dt.mul(Pt,St,bt);const Ut=new Float64Array(16);dt.invert(Ut,Pt);const Tt=ku.fromInvProjectionMatrix(Ut,_,h,!0);for(const Mt of Tt.points){const tr=((ee=Mt)[0]/=m,ee[1]/=m,ee[2]=fi(ee[2],r._center.lat),ee);Y=Math.max(Y,We.len(We.subtract([],Z,tr)))}}var ee;Y*=l/(l-1);const ce=Math.acos(e[2]),de=Math.atan2(-e[0],-e[1]),ge=new ty;ge.position=Z,ge.setPitchBearing(ce,de);const ve=ge.getWorldToCamera(_,B),Re=Y*_,ke=Math.min(r._mercatorZfromZoom(17)*_*-2,-2*Re),$e=ge.getCameraToClipOrthographic(-Re,Re,-Re,Re,ke,(Re+u*B)/e[2]),Ie=new Float64Array(16);dt.multiply(Ie,$e,ve);const Qe=We.fromValues(Math.floor(1e6*Z[0])/1e6*_,Math.floor(1e6*Z[1])/1e6*_,0),st=.5*l,ft=[0,0,0];We.transformMat4(ft,Qe,Ie),We.scale(ft,ft,st);const Je=[Math.floor(ft[0]),Math.floor(ft[1]),Math.floor(ft[2])],tt=[0,0,0];We.sub(tt,ft,Je),We.scale(tt,tt,-1/st);const pt=new Float64Array(16);return dt.identity(pt),dt.translate(pt,pt,tt),dt.multiply(Ie,pt,Ie),[Ie,Re]}class _X extends Ln{constructor(e){super(),this.requestManager=e,this.models={"":{}},this.numModelsLoading={}}loadModel(e,i){return YP(this.requestManager.transformRequest(i,Le.Model).url).then(o=>{if(!o)return;const l=fT(o),u=new qF(e,void 0,void 0,l);return u.computeBoundsAndApplyParent(),u}).catch(o=>{this.fire(new ar(new Error(`Could not load model ${e} from ${i}: ${o.message}`)))})}load(e,i){this.models[i]||(this.models[i]={});const o=Object.keys(e);this.numModelsLoading[i]=(this.numModelsLoading[i]||0)+o.length;const l=[];for(const u of o)l.push(this.loadModel(u,e[u]));Promise.allSettled(l).then(u=>{for(let h=0;h<u.length;h++){const{status:m,value:_}=u[h];m==="fulfilled"&&_&&(this.models[i][o[h]]=_)}this.numModelsLoading[i]-=o.length,this.fire(new _t("data",{dataType:"style"}))}).catch(u=>{this.fire(new ar(new Error(`Could not load models: ${u.message}`)))})}isLoaded(){for(const e in this.numModelsLoading)if(this.numModelsLoading[e]>0)return!1;return!0}hasModel(e,i){return!!this.getModel(e,i)}getModel(e,i){return this.models[i]||(this.models[i]={}),this.models[i][e]}addModel(e,i,o){this.models[o]||(this.models[o]={}),this.hasModel(e,o)&&this.removeModel(e,o),this.load({[e]:this.requestManager.normalizeModelURL(i)},o)}addModels(e,i){const o={};for(const l in e)o[l]=this.requestManager.normalizeModelURL(e[l]);this.load(o,i)}removeModel(e,i){this.models[i]||(this.models[i]={});const o=this.models[i][e];delete this.models[i][e],o.destroy()}listModels(e){return this.models[e]||(this.models[e]={}),Object.keys(this.models[e])}upload(e,i){this.models[i]||(this.models[i]={});for(const o in this.models[i])this.models[i][o].upload(e.context)}}const Fg=(r,e)=>Qv(r,e&&e.filter(i=>i.identifier!=="source.canvas")),vX=oe(Gn,["addLayer","removeLayer","setLights","setPaintProperty","setLayoutProperty","setSlot","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection","setCamera","addImport","removeImport","setImportUrl","setImportData","setImportConfig"]),yX=oe(Gn,["setCenter","setZoom","setBearing","setPitch"]),nR={version:8,layers:[],sources:{}},iR={duration:300,delay:0},xX=new Set(["fill","line","background","hillshade","raster"]);class Ql extends Ln{constructor(e,i={}){super(),this.map=e,this.scope=i.scope||"",this.fragments=[],this.importDepth=i.importDepth||0,this.importsCache=i.importsCache||new Map,this.resolvedImports=i.resolvedImports||new Set,this.transition=ze({},iR),this._buildingIndex=new HG(this),this.crossTileSymbolIndex=new pq,this._mergedOrder=[],this._drapedFirstOrder=[],this._mergedLayers={},this._mergedSourceCaches={},this._mergedOtherSourceCaches={},this._mergedSymbolSourceCaches={},this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this._changes=i.styleChanges||new oV,this.dispatcher=i.dispatcher?i.dispatcher:new pd(kg(),this),i.imageManager?this.imageManager=i.imageManager:(this.imageManager=new xG,this.imageManager.setEventedParent(this)),this.imageManager.createScope(this.scope),this.glyphManager=i.glyphManager?i.glyphManager:new e0(e._requestManager,i.localFontFamily?2:i.localIdeographFontFamily?1:0,i.localFontFamily||i.localIdeographFontFamily),i.modelManager?this.modelManager=i.modelManager:(this.modelManager=new _X(e._requestManager),this.modelManager.setEventedParent(this)),this._layers={},this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._precompileDone=!1,this._shouldPrecompile=!1,this._availableImages=[],this._order=[],this._markersNeedUpdate=!1,this.options=new Map,this._configDependentLayers=new Set,this.dispatcher.broadcast("setReferrer",xt());const o=this;this._rtlTextPluginCallback=Ql.registerForPluginStateChange(l=>{o.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:l.pluginStatus,pluginURL:l.pluginURL},(u,h)=>{if(o4(u),h&&h.every(m=>m))for(const m in o._sourceCaches){const _=o._sourceCaches[m],v=_.getSource().type;v!=="vector"&&v!=="geojson"||_.reload()}})}),this.on("data",l=>{if(l.dataType!=="source"||l.sourceDataType!=="metadata")return;const u=this.getOwnSource(l.sourceId);if(u&&u.vectorLayerIds)for(const h in this._layers){const m=this._layers[h];m.source===u.id&&this._validateLayer(m)}})}loadURL(e,i={}){this.fire(new _t("dataloading",{dataType:"style"}));const o=typeof i.validate=="boolean"?i.validate:!_e(e);e=this.map._requestManager.normalizeStyleURL(e,i.accessToken),this.resolvedImports.add(e);const l=this.importsCache.get(e);if(l)return this._load(l,o);const u=this.map._requestManager.transformRequest(e,Le.Style);this._request=jt(u,(h,m)=>{if(this._request=null,h)this.fire(new ar(h));else if(m)return this.importsCache.set(e,m),this._load(m,o)})}loadJSON(e,i={}){this.fire(new _t("dataloading",{dataType:"style"})),this._request=Jr.frame(()=>{this._request=null,this._load(e,i.validate!==!1)})}loadEmpty(){this.fire(new _t("dataloading",{dataType:"style"})),this._load(nR,!1)}_loadImports(e,i){if(this.importDepth>=4)return se("Style doesn't support nesting deeper than 5"),this._reloadImports();const o=[];for(const l of e){const u=this._createFragmentStyle(l),h=new Promise(_=>u.on("style.import.load",_));if(o.push(h),this.resolvedImports.has(l.url)){u.loadEmpty();continue}const m=l.data||this.importsCache.get(l.url);m?u.loadJSON(m,{validate:i}):l.url?u.loadURL(l.url,{validate:i}):u.loadEmpty(),this.fragments.push({style:u,id:l.id,config:l.config})}Promise.all(o).then(()=>this._reloadImports())}_createFragmentStyle(e){const i=this.scope?To(e.id,this.scope):e.id,o=new Ql(this.map,{scope:i,styleChanges:this._changes,importDepth:this.importDepth+1,importsCache:this.importsCache,resolvedImports:new Set(this.resolvedImports),dispatcher:this.dispatcher,imageManager:this.imageManager,glyphManager:this.glyphManager,modelManager:this.modelManager});return o.setEventedParent(this.map,{style:o}),o.setConfig(e.config),o}_reloadImports(){this.mergeAll(),this._updateMapProjection(),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options});const e=this.isRootStyle();this._shouldPrecompile=e,this.fire(new _t("data",{dataType:"style"})),this.fire(new _t(e?"style.load":"style.import.load"))}_load(e,i){const o=e.schema;if(this.isRootStyle()&&(e.fragment||o&&e.fragment!==!1)){const h=ze({},nR,{imports:[{id:"basemap",data:e,url:""}]});return void this._load(h,i)}if(this.updateSchema(o),i&&Fg(this,Lp(e)))return;this._loaded=!0,this.stylesheet=G(e);for(const h in e.sources)this.addSource(h,e.sources[h],{validate:!1});this._changes.changed=!1,e.sprite?this._loadSprite(e.sprite):(this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0})),this.glyphManager.setURL(e.glyphs,this.scope);const l=rO(this.stylesheet.layers);if(this._order=l.map(h=>h.id),this.stylesheet.light&&se("The `light` root property is deprecated, prefer using `lights` with `flat` light type instead."),this.stylesheet.lights)if(this.stylesheet.lights.length===1&&this.stylesheet.lights[0].type==="flat"){const h=this.stylesheet.lights[0];this.light=new IP(h.properties,h.id)}else this.setLights(this.stylesheet.lights);this.light||(this.light=new IP(this.stylesheet.light)),this._layers={},this._serializedLayers={};for(const h of l){const m=cy(h,this.options);m.setScope(this.scope),m.isConfigDependent&&this._configDependentLayers.add(m.fqid),m.setEventedParent(this,{layer:{id:m.id}}),this._layers[m.id]=m,this._layers[m.id]=m,this._serializedLayers[m.id]=m.serialize();const _=this.getOwnLayerSourceCache(m),v=!!this.directionalLight&&this.directionalLight.shadowsEnabled();_&&m.canCastShadows()&&v&&(_.castsShadows=!0)}this.stylesheet.models&&this.modelManager.addModels(this.stylesheet.models,this.scope);const u=this.stylesheet.terrain;if(u&&!this.terrainSetForDrapingOnly()&&this._createTerrain(u,1),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this.stylesheet.transition&&this.setTransition(this.stylesheet.transition),this.mergeAll(),this._updateMapProjection(),this.map._triggerCameraUpdate(this.camera),this.fire(new _t("data",{dataType:"style"})),e.imports)this._loadImports(e.imports,i);else{this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options});const h=this.isRootStyle();this._shouldPrecompile=h,this.fire(new _t(h?"style.load":"style.import.load"))}}isRootStyle(){return this.importDepth===0}mergeAll(){let e,i,o,l,u,h,m,_;this.forEachFragmentStyle(v=>{if(v.stylesheet){if(v.light!=null&&(e=v.light),v.stylesheet.lights)for(const x of v.stylesheet.lights)x.type==="ambient"&&v.ambientLight!=null&&(i=v.ambientLight),x.type==="directional"&&v.directionalLight!=null&&(o=v.directionalLight);(v.stylesheet.terrain||v.stylesheet.projection&&v.stylesheet.projection.name==="globe")&&v.terrain!=null&&(!l||l&&l.drapeRenderMode===0||v.terrain.drapeRenderMode===1)&&(l=v.terrain),v.stylesheet.fog&&v.fog!=null&&(u=v.fog),v.stylesheet.camera!=null&&(_=v.stylesheet.camera),v.stylesheet.projection!=null&&(h=v.stylesheet.projection),v.stylesheet.transition!=null&&(m=v.stylesheet.transition)}}),this.light=e,this.ambientLight=i,this.directionalLight=o,this.terrain=l,this.fog=u,this.camera=_||{"camera-projection":"perspective"},this.projection=h||{name:"mercator"},this.transition=ze({},iR,m),this.mergeSources(),this.mergeLayers()}forEachFragmentStyle(e){const i=o=>{for(const l of o.fragments)i(l.style);e(o)};i(this)}mergeTerrain(){let e;this.forEachFragmentStyle(i=>{i.terrain!=null&&(!e||e&&e.drapeRenderMode===0||i.terrain.drapeRenderMode===1)&&(e=i.terrain)}),this.terrain=e}mergeProjection(){let e;this.forEachFragmentStyle(i=>{i.stylesheet.projection!=null&&(e=i.stylesheet.projection)}),this.projection=e||{name:"mercator"}}mergeSources(){const e={},i={},o={};this.forEachFragmentStyle(l=>{for(const u in l._sourceCaches){const h=To(u,l.scope);e[h]=l._sourceCaches[u]}for(const u in l._otherSourceCaches){const h=To(u,l.scope);i[h]=l._otherSourceCaches[u]}for(const u in l._symbolSourceCaches){const h=To(u,l.scope);o[h]=l._symbolSourceCaches[u]}}),this._mergedSourceCaches=e,this._mergedOtherSourceCaches=i,this._mergedSymbolSourceCaches=o}mergeLayers(){const e={},i=[],o={};this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this.forEachFragmentStyle(u=>{for(const h of u._order){const m=u._layers[h];if(m.type==="slot"){const _=g2(h);if(e[_])continue;e[_]=[]}m.slot&&e[m.slot]?e[m.slot].push(m):i.push(m)}}),this._mergedOrder=[];const l=(u=[])=>{for(const h of u)if(h.type==="slot"){const m=g2(h.id);e[m]&&l(e[m])}else{const m=To(h.id,h.scope);this._mergedOrder.push(m),o[m]=h,h.is3D()&&(this._has3DLayers=!0),h.type==="circle"&&(this._hasCircleLayers=!0),h.type==="symbol"&&(this._hasSymbolLayers=!0)}};l(i),this._mergedLayers=o,this.updateDrapeFirstLayers(),this._buildingIndex.processLayersChanged()}terrainSetForDrapingOnly(){return!!this.terrain&&this.terrain.drapeRenderMode===0}getCamera(){return this.stylesheet.camera}setCamera(e){return this.stylesheet.camera=ze({},this.stylesheet.camera,e),this.camera=this.stylesheet.camera,this}setProjection(e){e?this.stylesheet.projection=e:delete this.stylesheet.projection,this.mergeProjection(),this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?this.getTerrain()||this.stylesheet.terrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null))}_updateMapProjection(){this.isRootStyle()&&(this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.projection))}_loadSprite(e){this._spriteRequest=function(i,o,l){let u,h,m;const _=Jr.devicePixelRatio>1?"@2x":"";let v=jt(o.transformRequest(o.normalizeSpriteURL(i,_,".json"),Le.SpriteJSON),(C,k)=>{v=null,m||(m=C,u=k,w())}),x=Ur(o.transformRequest(o.normalizeSpriteURL(i,_,".png"),Le.SpriteImage),(C,k)=>{x=null,m||(m=C,h=k,w())});function w(){if(m)l(m);else if(u&&h){const C=Jr.getImageData(h),k={};for(const P in u){const{width:R,height:z,x:B,y:H,sdf:Z,pixelRatio:Y,stretchX:q,stretchY:ee,content:ce}=u[P],de=new da({width:R,height:z});da.copy(C,de,{x:B,y:H},{x:0,y:0},{width:R,height:z}),k[P]={data:de,pixelRatio:Y,sdf:Z,stretchX:q,stretchY:ee,content:ce}}l(null,k)}}return{cancel(){v&&(v.cancel(),v=null),x&&(x.cancel(),x=null)}}}(e,this.map._requestManager,(i,o)=>{if(this._spriteRequest=null,i)this.fire(new ar(i));else if(o)for(const l in o)this.imageManager.addImage(l,this.scope,o[l]);this.imageManager.setLoaded(!0,this.scope),this._availableImages=this.imageManager.listImages(this.scope),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages}),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0}),this.fire(new _t("data",{dataType:"style"}))})}_validateLayer(e){const i=this.getOwnSource(e.source);if(!i)return;const o=e.sourceLayer;o&&(i.type==="geojson"||i.vectorLayerIds&&i.vectorLayerIds.indexOf(o)===-1)&&this.fire(new ar(new Error(`Source layer "${o}" does not exist on source "${i.id}" as specified by style layer "${e.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._changes.updatedSourceCaches).length)return!1;for(const e in this._sourceCaches)if(!this._sourceCaches[e].loaded())return!1;if(!this.imageManager.isLoaded()||!this.modelManager.isLoaded())return!1;for(const{style:e}of this.fragments)if(!e.loaded())return!1;return!0}_serializeImports(){if(this.stylesheet.imports)return this.stylesheet.imports.map((e,i)=>{const o=this.fragments[i];return o&&o.style&&(e.data=o.style.serialize()),e})}_serializeSources(){const e={};for(const i in this._sourceCaches){const o=this._sourceCaches[i].getSource();e[o.id]||(e[o.id]=o.serialize())}return e}_serializeLayers(e){const i=[];for(const o of e){const l=this._layers[o];l&&l.type!=="custom"&&i.push(l.serialize())}return i}hasLightTransitions(){return!(!this.light||!this.light.hasTransition())||!(!this.ambientLight||!this.ambientLight.hasTransition())||!(!this.directionalLight||!this.directionalLight.hasTransition())}hasFogTransition(){return!!this.fog&&this.fog.hasTransition()}hasTransitions(){if(this.hasLightTransitions()||this.hasFogTransition())return!0;for(const e in this._sourceCaches)if(this._sourceCaches[e].hasTransition())return!0;for(const e in this._layers)if(this._layers[e].hasTransition())return!0;return!1}get order(){return this.terrain?this._drapedFirstOrder:this._mergedOrder}isLayerDraped(e){return!!this.terrain&&(typeof e.isLayerDraped=="function"?e.isLayerDraped(this.getLayerSourceCache(e)):xX.has(e.type))}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}_checkLayer(e){const i=this.getOwnLayer(e);if(i)return i;this.fire(new ar(new Error(`The layer '${e}' does not exist in the map's style.`)))}_checkSource(e){const i=this.getOwnSource(e);if(i)return i;this.fire(new ar(new Error(`The source '${e}' does not exist in the map's style.`)))}update(e){if(!this._loaded)return;this.ambientLight&&this.ambientLight.recalculate(e),this.directionalLight&&this.directionalLight.recalculate(e);const i=this.calculateLightsBrightness();e.brightness=i||0,i!==this._brightness&&(this._brightness=i,this.dispatcher.broadcast("setBrightness",i));const o=this._changes.changed;if(this._changes.changed){const u=this._changes.getLayerUpdatesByScope();for(const h in u){const{updatedIds:m,removedIds:_}=u[h];(m||_)&&this._updateWorkerLayers(h,m,_)}this.updateSourceCaches(),this._updateTilesForChangedImages(),this.updateLayers(e),this.light&&this.light.updateTransitions(e),this.ambientLight&&this.ambientLight.updateTransitions(e),this.directionalLight&&this.directionalLight.updateTransitions(e),this.fog&&this.fog.updateTransitions(e),this._changes.reset()}const l={};for(const u in this._mergedSourceCaches){const h=this._mergedSourceCaches[u];l[u]=h.used,h.used=!1}for(const u of this._mergedOrder){const h=this._mergedLayers[u];if(h.recalculate(e,this._availableImages),!h.isHidden(e.zoom)){const m=this.getOwnLayerSourceCache(h);m&&(m.used=!0)}if(!this._precompileDone&&this._shouldPrecompile)for(let m=h.minzoom||0;m<(h.maxzoom||25.5);m++){const _=this.map.painter;if(_){const v=h.getProgramIds();if(!v)continue;for(const x of v){const w=h.getDefaultProgramParams(x,e.zoom);w&&(_.style=this,this.fog&&(_._fogVisible=!0,w.overrideFog=!0,_.getOrCreateProgram(x,w)),_._fogVisible=!1,w.overrideFog=!1,_.getOrCreateProgram(x,w),(this.stylesheet.terrain||this.stylesheet.projection&&this.stylesheet.projection.name==="globe")&&(w.overrideRtt=!0,_.getOrCreateProgram(x,w)))}}}}this._shouldPrecompile&&(this._precompileDone=!0);for(const u in l){const h=this._mergedSourceCaches[u];l[u]!==h.used&&h.getSource().fire(new _t("data",{sourceDataType:"visibility",dataType:"source",sourceId:h.getSource().id}))}this.light&&this.light.recalculate(e),this.terrain&&this.terrain.recalculate(e),this.fog&&this.fog.recalculate(e),this.z=e.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),o&&this.fire(new _t("data",{dataType:"style"}));for(const{style:u}of this.fragments)u.update(e)}_updateTilesForChangedImages(){const e=Array.from(this._changes.changedImages.keys());if(e.length){for(const i in this._sourceCaches)this._sourceCaches[i].reloadTilesForDependencies(["icons","patterns"],e);this._changes.changedImages.clear()}}_updateWorkerLayers(e,i,o){const l=this.getFragmentStyle(e);this.dispatcher.broadcast("updateLayers",{layers:i?l._serializeLayers(i):[],scope:e,removedIds:o||[],options:l.options})}setState(e){if(this._checkLoaded(),Fg(this,Lp(e)))return!1;(e=G(e)).layers=rO(e.layers);const i=function(l,u){if(!l)return[{command:Gn.setStyle,args:[u]}];let h=[];try{if(!te(l.version,u.version))return[{command:Gn.setStyle,args:[u]}];te(l.center,u.center)||h.push({command:Gn.setCenter,args:[u.center]}),te(l.zoom,u.zoom)||h.push({command:Gn.setZoom,args:[u.zoom]}),te(l.bearing,u.bearing)||h.push({command:Gn.setBearing,args:[u.bearing]}),te(l.pitch,u.pitch)||h.push({command:Gn.setPitch,args:[u.pitch]}),te(l.sprite,u.sprite)||h.push({command:Gn.setSprite,args:[u.sprite]}),te(l.glyphs,u.glyphs)||h.push({command:Gn.setGlyphs,args:[u.glyphs]}),te(l.transition,u.transition)||h.push({command:Gn.setTransition,args:[u.transition]}),te(l.light,u.light)||h.push({command:Gn.setLight,args:[u.light]}),te(l.fog,u.fog)||h.push({command:Gn.setFog,args:[u.fog]}),te(l.projection,u.projection)||h.push({command:Gn.setProjection,args:[u.projection]}),te(l.lights,u.lights)||h.push({command:Gn.setLights,args:[u.lights]}),te(l.camera,u.camera)||h.push({command:Gn.setCamera,args:[u.camera]});const m={},_=[];(function(w,C,k,P){let R;for(R in C=C||{},w=w||{})w.hasOwnProperty(R)&&(C.hasOwnProperty(R)||iO(R,k,P));for(R in C){if(!C.hasOwnProperty(R))continue;const z=C[R];w.hasOwnProperty(R)?te(w[R],z)||(w[R].type==="geojson"&&z.type==="geojson"&&XG(w,C,R)?k.push({command:Gn.setGeoJSONSourceData,args:[R,z.data]}):qG(R,C,k,P)):nO(R,C,k)}})(l.sources,u.sources,_,m);const v=[];l.layers&&l.layers.forEach(w=>{w.source&&m[w.source]?h.push({command:Gn.removeLayer,args:[w.id]}):v.push(w)});let x=l.terrain;x&&m[x.source]&&(h.push({command:Gn.setTerrain,args:[void 0]}),x=void 0),h=h.concat(_),te(x,u.terrain)||h.push({command:Gn.setTerrain,args:[u.terrain]}),function(w,C,k){C=C||[];const P=(w=w||[]).map(py),R=C.map(py),z=w.reduce(my,{}),B=C.reduce(my,{}),H=P.slice(),Z=Object.create(null);let Y,q,ee,ce,de,ge,ve;for(Y=0,q=0;Y<P.length;Y++)ee=P[Y],B.hasOwnProperty(ee)?q++:(k.push({command:Gn.removeLayer,args:[ee]}),H.splice(H.indexOf(ee,q),1));for(Y=0,q=0;Y<R.length;Y++)ee=R[R.length-1-Y],H[H.length-1-Y]!==ee&&(z.hasOwnProperty(ee)?(k.push({command:Gn.removeLayer,args:[ee]}),H.splice(H.lastIndexOf(ee,H.length-q),1)):q++,ge=H[H.length-Y],k.push({command:Gn.addLayer,args:[B[ee],ge]}),H.splice(H.length-Y,0,ee),Z[ee]=!0);for(Y=0;Y<R.length;Y++)if(ee=R[Y],ce=z[ee],de=B[ee],!Z[ee]&&!te(ce,de))if(te(ce.source,de.source)&&te(ce["source-layer"],de["source-layer"])&&te(ce.type,de.type)){for(ve in dy(ce.layout,de.layout,k,ee,null,Gn.setLayoutProperty),dy(ce.paint,de.paint,k,ee,null,Gn.setPaintProperty),te(ce.slot,de.slot)||k.push({command:Gn.setSlot,args:[ee,de.slot]}),te(ce.filter,de.filter)||k.push({command:Gn.setFilter,args:[ee,de.filter]}),te(ce.minzoom,de.minzoom)&&te(ce.maxzoom,de.maxzoom)||k.push({command:Gn.setLayerZoomRange,args:[ee,de.minzoom,de.maxzoom]}),ce)ce.hasOwnProperty(ve)&&ve!=="layout"&&ve!=="paint"&&ve!=="filter"&&ve!=="metadata"&&ve!=="minzoom"&&ve!=="maxzoom"&&ve!=="slot"&&(ve.indexOf("paint.")===0?dy(ce[ve],de[ve],k,ee,ve.slice(6),Gn.setPaintProperty):te(ce[ve],de[ve])||k.push({command:Gn.setLayerProperty,args:[ee,ve,de[ve]]}));for(ve in de)de.hasOwnProperty(ve)&&!ce.hasOwnProperty(ve)&&ve!=="layout"&&ve!=="paint"&&ve!=="filter"&&ve!=="metadata"&&ve!=="minzoom"&&ve!=="maxzoom"&&ve!=="slot"&&(ve.indexOf("paint.")===0?dy(ce[ve],de[ve],k,ee,ve.slice(6),Gn.setPaintProperty):te(ce[ve],de[ve])||k.push({command:Gn.setLayerProperty,args:[ee,ve,de[ve]]}))}else k.push({command:Gn.removeLayer,args:[ee]}),ge=H[H.lastIndexOf(ee)+1],k.push({command:Gn.addLayer,args:[de,ge]})}(v,u.layers,h),function(w=[],C=[],k){C=C||[];const P=(w=w||[]).map(py),R=C.map(py),z=w.reduce(my,{}),B=C.reduce(my,{}),H=P.slice();let Z,Y,q,ee;for(Z=0,Y=0;Z<P.length;Z++)q=P[Z],B.hasOwnProperty(q)?Y++:(k.push({command:Gn.removeImport,args:[q]}),H.splice(H.indexOf(q,Y),1));for(Z=0,Y=0;Z<R.length;Z++)q=R[R.length-1-Z],H[H.length-1-Z]!==q&&(z.hasOwnProperty(q)?(k.push({command:Gn.removeImport,args:[q]}),H.splice(H.lastIndexOf(q,H.length-Y),1)):Y++,ee=H[H.length-Z],k.push({command:Gn.addImport,args:[B[q],ee]}),H.splice(H.length-Z,0,q));for(const ce of C){const de=z[ce.id];if(!de||te(de,ce))continue;te(de.config,ce.config)||k.push({command:Gn.setImportConfig,args:[ce.id,ce.config]}),te(de.url,ce.url)||k.push({command:Gn.setImportUrl,args:[ce.id,ce.url]});const ge=ce.data;te(de&&de.data,ge)||k.push({command:Gn.setImportData,args:[ce.id,ge]})}}(l.imports,u.imports,h)}catch(m){console.warn("Unable to compute style diff:",m),h=[{command:Gn.setStyle,args:[u]}]}return h}(this.serialize(),e).filter(l=>!(l.command in yX));if(i.length===0)return!1;const o=i.filter(l=>!(l.command in vX));if(o.length>0)throw new Error(`Unimplemented: ${o.map(l=>l.command).join(", ")}.`);return i.forEach(l=>{this[l.command].apply(this,l.args)}),this.stylesheet=e,this.mergeAll(),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),!0}addImage(e,i){return this.getImage(e)?this.fire(new ar(new Error("An image with this name already exists."))):(this.imageManager.addImage(e,this.scope,i),this._afterImageUpdated(e),this)}updateImage(e,i){this.imageManager.updateImage(e,this.scope,i)}getImage(e){return this.imageManager.getImage(e,this.scope)}removeImage(e){return this.getImage(e)?(this.imageManager.removeImage(e,this.scope),this._afterImageUpdated(e),this):this.fire(new ar(new Error("No image with this name exists.")))}_afterImageUpdated(e){this._availableImages=this.imageManager.listImages(this.scope),this._changes.changedImages.add(e),this._changes.changed=!0,this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages}),this.fire(new _t("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addModel(e,i,o={}){return this._checkLoaded(),this._validate(Q$,`models.${e}`,i,null,o)||(this.modelManager.addModel(e,i,this.scope),this._changes.changed=!0),this}hasModel(e){return this.modelManager.hasModel(e,this.scope)}removeModel(e){return this.hasModel(e)?(this.modelManager.removeModel(e,this.scope),this):this.fire(new ar(new Error("No model with this ID exists.")))}listModels(){return this._checkLoaded(),this.modelManager.listModels(this.scope)}addSource(e,i,o={}){if(this._checkLoaded(),this.getOwnSource(e)!==void 0)throw new Error(`There is already a source with ID "${e}".`);if(!i.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(i).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(i.type)>=0&&this._validate(H$,`sources.${e}`,i,null,o))return;this.map&&this.map._collectResourceTiming&&(i.collectResourceTiming=!0);const l=dT(e,i,this.dispatcher,this);l.scope=this.scope,l.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(l.id),source:l.serialize(),sourceId:l.id}));const u=h=>{const m=(h?"symbol:":"other:")+l.id,_=To(m,this.scope),v=this._sourceCaches[m]=new Kl(_,l,h);(h?this._symbolSourceCaches:this._otherSourceCaches)[l.id]=v,v.onAdd(this.map)};u(!1),i.type!=="vector"&&i.type!=="geojson"||u(!0),l.onAdd&&l.onAdd(this.map),this.mergeSources(),this._changes.changed=!0}removeSource(e){this._checkLoaded();const i=this.getOwnSource(e);if(!i)throw new Error("There is no source with this ID");for(const l in this._layers)if(this._layers[l].source===e)return this.fire(new ar(new Error(`Source "${e}" cannot be removed while layer "${l}" is using it.`)));if(this.terrain&&this.terrain.get().source===e)return this.fire(new ar(new Error(`Source "${e}" cannot be removed while terrain is using it.`)));const o=this.getOwnSourceCaches(e);for(const l of o){const u=g2(l.id);delete this._sourceCaches[u],delete this._changes.updatedSourceCaches[l.id],l.fire(new _t("data",{sourceDataType:"metadata",dataType:"source",sourceId:l.getSource().id})),l.setEventedParent(null),l.clearTiles()}return delete this._otherSourceCaches[e],delete this._symbolSourceCaches[e],this.mergeSources(),i.setEventedParent(null),i.onRemove&&i.onRemove(this.map),this._changes.changed=!0,this}setGeoJSONSourceData(e,i){this._checkLoaded(),this.getOwnSource(e).setData(i),this._changes.changed=!0}getOwnSource(e){const i=this.getOwnSourceCache(e);return i&&i.getSource()}getOwnSources(){const e=[];for(const i in this._otherSourceCaches){const o=this.getOwnSourceCache(i);o&&e.push(o.getSource())}return e}setLights(e){if(this._checkLoaded(),!e)return delete this.ambientLight,void delete this.directionalLight;const i=this._getTransitionParameters();for(const l of e){if(this._validate(q$,"lights",l))return;switch(l.type){case"ambient":if(this.ambientLight){const u=this.ambientLight;u.set(l),u.updateTransitions(i)}else this.ambientLight=new DP(l,kG,this.scope,this.options);break;case"directional":if(this.directionalLight){const u=this.directionalLight;u.set(l),u.updateTransitions(i)}else this.directionalLight=new DP(l,IG,this.scope,this.options)}}const o=new Gi(this.z||0,i);this.ambientLight&&this.ambientLight.recalculate(o),this.directionalLight&&this.directionalLight.recalculate(o),this._brightness=this.calculateLightsBrightness(),this.dispatcher.broadcast("setBrightness",this._brightness)}calculateLightsBrightness(){const e=this.directionalLight,i=this.ambientLight;if(!e||!i)return;const o=w=>.2126*(w[0]<=.03928?w[0]/12.92:Math.pow((w[0]+.055)/1.055,2.4))+.7152*(w[1]<=.03928?w[1]/12.92:Math.pow((w[1]+.055)/1.055,2.4))+.0722*(w[2]<=.03928?w[2]/12.92:Math.pow((w[2]+.055)/1.055,2.4)),l=e.properties.get("color").toArray01(),u=e.properties.get("intensity"),h=e.properties.get("direction"),m=1-Xe(h.x,h.y,h.z)[2]/90,_=o(l)*u*m,v=i.properties.get("color").toArray01(),x=i.properties.get("intensity");return(_+o(v)*x)/2}getBrightness(){return this._brightness}getLights(){if(!this.enable3dLights())return null;const e=[];return this.directionalLight&&e.push(this.directionalLight.get()),this.ambientLight&&e.push(this.ambientLight.get()),e}enable3dLights(){return!!this.ambientLight&&!!this.directionalLight}getFragmentStyle(e){if(!e)return this;const i=this.fragments.find(({id:o})=>o===e);if(!i)throw new Error(`Style import not found: ${e}`);return i.style}setConfigProperty(e,i,o){const l=Cf(o);if(l.result!=="success")return void Fg(this,l.value);const u=l.value.expression,h=this.getFragmentStyle(e);h.options.set(i,u),h.updateConfigDependencies()}setConfig(e,i){if(this.options.clear(),e){for(const o in e){const l=Cf(e[o]);l.result==="success"&&this.options.set(o,l.value.expression)}this.updateSchema(i)}}updateSchema(e){if(e)for(const i in e){if(this.options.has(i))continue;const o=Cf(e[i].default);o.result==="success"&&this.options.set(i,o.value.expression)}}updateConfigDependencies(){for(const e of this._configDependentLayers){const i=this.getLayer(e);i&&(i.possiblyEvaluateVisibility(),this._updateLayer(i))}this.ambientLight&&this.ambientLight.scope===this.scope&&this.ambientLight.updateConfig(this.options),this.directionalLight&&this.directionalLight.scope===this.scope&&this.directionalLight.updateConfig(this.options),this._changes.changed=!0}addLayer(e,i,o={}){this._checkLoaded();const l=e.id;if(this._layers[l])return void this.fire(new ar(new Error(`Layer with id "${l}" already exists on this map`)));let u;if(e.type==="custom"){if(Fg(this,function(x){const w=[],C=x.id;return C===void 0&&w.push({message:`layers.${C}: missing required property "id"`}),x.render===void 0&&w.push({message:`layers.${C}: missing required method "render"`}),x.renderingMode&&x.renderingMode!=="2d"&&x.renderingMode!=="3d"&&w.push({message:`layers.${C}: property "renderingMode" must be either "2d" or "3d"`}),w}(e)))return;u=cy(e,this.options)}else{if(typeof e.source=="object"&&(this.addSource(l,e.source),e=ze(e=G(e),{source:l})),this._validate(K$,`layers.${l}`,e,{arrayIndex:-1},o))return;u=cy(e,this.options),this._validateLayer(u),u.setEventedParent(this,{layer:{id:l}}),this._serializedLayers[u.id]=u.serialize()}u.isConfigDependent&&this._configDependentLayers.add(u.fqid),u.setScope(this.scope);const h=i?this._order.indexOf(i):this._order.length;if(i&&h===-1)return void this.fire(new ar(new Error(`Layer with id "${i}" does not exist on this map.`)));this._order.splice(h,0,l),this._layerOrderChanged=!0,this._layers[l]=u;const m=this.getOwnLayerSourceCache(u),_=!!this.directionalLight&&this.directionalLight.shadowsEnabled();m&&u.canCastShadows()&&_&&(m.castsShadows=!0);const v=this._changes.getRemovedLayer(u);if(v&&u.source&&m&&u.type!=="custom"){this._changes.discardLayerRemoval(u);const x=To(u.source,u.scope);v.type!==u.type?this._changes.updatedSourceCaches[x]="clear":(this._changes.updatedSourceCaches[x]="reload",m.pause())}this._updateLayer(u),u.onAdd&&u.onAdd(this.map),u.scope=this.scope,this.mergeLayers()}moveLayer(e,i){if(this._checkLoaded(),this._changes.changed=!0,!this._checkLayer(e)||e===i)return;const o=this._order.indexOf(e);this._order.splice(o,1);const l=i?this._order.indexOf(i):this._order.length;i&&l===-1?this.fire(new ar(new Error(`Layer with id "${i}" does not exist on this map.`))):(this._order.splice(l,0,e),this._layerOrderChanged=!0,this.mergeLayers())}removeLayer(e){this._checkLoaded();const i=this._checkLayer(e);if(!i)return;i.setEventedParent(null);const o=this._order.indexOf(e);this._order.splice(o,1),delete this._layers[e],delete this._serializedLayers[e],this._changes.changed=!0,this._layerOrderChanged=!0,this._configDependentLayers.delete(i.fqid),this._changes.removeLayer(i);const l=this.getOwnLayerSourceCache(i);if(l&&l.castsShadows){let u=!1;for(const h in this._layers)if(this._layers[h].source===i.source&&this._layers[h].canCastShadows()){u=!0;break}l.castsShadows=u}i.onRemove&&i.onRemove(this.map),this.mergeLayers()}getOwnLayer(e){return this._layers[e]}hasLayer(e){return e in this._mergedLayers}hasLayerType(e){for(const i in this._layers)if(this._layers[i].type===e)return!0;return!1}setLayerZoomRange(e,i,o){this._checkLoaded();const l=this._checkLayer(e);l&&(l.minzoom===i&&l.maxzoom===o||(i!=null&&(l.minzoom=i),o!=null&&(l.maxzoom=o),this._updateLayer(l)))}setSlot(e,i){this._checkLoaded();const o=this._checkLayer(e);o&&o.slot!==i&&(o.slot=i,this._updateLayer(o))}setFilter(e,i,o={}){this._checkLoaded();const l=this._checkLayer(e);if(l&&!te(l.filter,i))return i==null?(l.filter=void 0,void this._updateLayer(l)):void(this._validate(a2,`layers.${l.id}.filter`,i,{layerType:l.type},o)||(l.filter=G(i),this._updateLayer(l)))}getFilter(e){const i=this._checkLayer(e);if(i)return G(i.filter)}setLayoutProperty(e,i,o,l={}){this._checkLoaded();const u=this._checkLayer(e);u&&(te(u.getLayoutProperty(i),o)||(u.setLayoutProperty(i,o,l),u.isConfigDependent&&this._configDependentLayers.add(u.fqid),this._updateLayer(u)))}getLayoutProperty(e,i){const o=this._checkLayer(e);if(o)return o.getLayoutProperty(i)}setPaintProperty(e,i,o,l={}){this._checkLoaded();const u=this._checkLayer(e);if(!u||te(u.getPaintProperty(i),o))return;const h=u.setPaintProperty(i,o,l);u.isConfigDependent&&this._configDependentLayers.add(u.fqid),h&&this._updateLayer(u),this._changes.changed=!0,this._changes.updatedPaintProps.add(u.fqid)}getPaintProperty(e,i){const o=this._checkLayer(e);if(o)return o.getPaintProperty(i)}setFeatureState(e,i){this._checkLoaded();const o=e.source,l=e.sourceLayer,u=this._checkSource(o);if(!u)return;const h=u.type;if(h==="geojson"&&l)return void this.fire(new ar(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if(h==="vector"&&!l)return void this.fire(new ar(new Error("The sourceLayer parameter must be provided for vector source types.")));e.id===void 0&&this.fire(new ar(new Error("The feature id parameter must be provided.")));const m=this.getOwnSourceCaches(o);for(const _ of m)_.setFeatureState(l,e.id,i)}removeFeatureState(e,i){this._checkLoaded();const o=e.source,l=this._checkSource(o);if(!l)return;const u=l.type,h=u==="vector"?e.sourceLayer:void 0;if(u==="vector"&&!h)return void this.fire(new ar(new Error("The sourceLayer parameter must be provided for vector source types.")));if(i&&typeof e.id!="string"&&typeof e.id!="number")return void this.fire(new ar(new Error("A feature id is required to remove its specific state property.")));const m=this.getOwnSourceCaches(o);for(const _ of m)_.removeFeatureState(h,e.id,i)}getFeatureState(e){this._checkLoaded();const i=e.source,o=e.sourceLayer,l=this._checkSource(i);if(l){if(l.type!=="vector"||o)return e.id===void 0&&this.fire(new ar(new Error("The feature id parameter must be provided."))),this.getOwnSourceCaches(i)[0].getFeatureState(o,e.id);this.fire(new ar(new Error("The sourceLayer parameter must be provided for vector source types.")))}}setTransition(e){return this.stylesheet.transition=ze({},this.stylesheet.transition,e),this.transition=this.stylesheet.transition,this}getTransition(){return ze({},this.stylesheet.transition)}serialize(){this._checkLoaded();const e=this.getTerrain(),i=e&&this.terrain&&this.terrain.scope===this.scope?e:void 0;return he({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,imports:this._serializeImports(),schema:this.stylesheet.schema,camera:this.stylesheet.camera,light:this.stylesheet.light,lights:this.stylesheet.lights,terrain:i,fog:this.stylesheet.fog,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:this._serializeSources(),layers:this._serializeLayers(this._order)},o=>o!==void 0)}_updateLayer(e){this._changes.updateLayer(e);const i=this.getLayerSourceCache(e),o=To(e.source,e.scope);e.source&&!this._changes.updatedSourceCaches[o]&&i&&i.getSource().type!=="raster"&&(this._changes.updatedSourceCaches[o]="reload",i.pause()),this._changes.changed=!0,e.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(e){const i=m=>this._mergedLayers[m].type==="fill-extrusion",o=this.order,l={},u=[];for(let m=o.length-1;m>=0;m--){const _=o[m];if(i(_)){l[_]=m;for(const v of e){const x=v[_];if(x)for(const w of x)u.push(w)}}}u.sort((m,_)=>_.intersectionZ-m.intersectionZ);const h=[];for(let m=o.length-1;m>=0;m--){const _=o[m];if(i(_))for(let v=u.length-1;v>=0;v--){const x=u[v].feature;if(l[x.layer.id]<m)break;h.push(x),u.pop()}else for(const v of e){const x=v[_];if(x)for(const w of x)h.push(w.feature)}}return h}queryRenderedFeatures(e,i,o){i&&i.filter&&this._validate(a2,"queryRenderedFeatures.filter",i.filter,null,i),i.scope=this.scope,i.availableImages=this._availableImages,i.serializedLayers=this._serializedLayers;const l={};if(i&&i.layers){if(!Array.isArray(i.layers))return this.fire(new ar(new Error("parameters.layers must be an Array."))),[];for(const v of i.layers){const x=this._mergedLayers[v];if(!x)return this.fire(new ar(new Error(`The layer '${v}' does not exist in the map's style and cannot be queried for features.`))),[];l[x.source]=!0}}const u=[],h=i.serializedLayers||{},m=i&&i.layers?i.layers.some(v=>{const x=this.getLayer(v);return x&&x.is3D()}):this.has3DLayers(),_=JE.createFromScreenPoints(e,o);for(const v in this._mergedSourceCaches){const x=this._mergedSourceCaches[v].getSource();if(!x||x.scope!==i.scope)continue;const w=this._mergedSourceCaches[v].getSource().id;i.layers&&!l[w]||u.push(jG(this._mergedSourceCaches[v],this._mergedLayers,h,_,i,o,m,!!this.map._showQueryGeometry))}return this.placement&&u.push(function(v,x,w,C,k,P,R){const z={},B=P.queryRenderedSymbols(C),H=[];for(const Z of Object.keys(B).map(Number))H.push(R[Z]);H.sort(eO);for(const Z of H){const Y=Z.featureIndex.lookupSymbolFeatures(B[Z.bucketInstanceId],x,Z.bucketIndex,Z.sourceLayerIndex,k.filter,k.layers,k.availableImages,v);for(const q in Y){const ee=z[q]=z[q]||[],ce=Y[q];ce.sort((de,ge)=>{const ve=Z.featureSortOrder;if(ve){const Re=ve.indexOf(de.featureIndex);return ve.indexOf(ge.featureIndex)-Re}return ge.featureIndex-de.featureIndex});for(const de of ce)ee.push(de)}}for(const Z in z)z[Z].forEach(Y=>{const q=Y.feature,ee=w(v[Z]);if(!ee)return;const ce=ee.getFeatureState(q.layer["source-layer"],q.id);q.source=q.layer.source,q.layer["source-layer"]&&(q.sourceLayer=q.layer["source-layer"]),q.state=ce});return z}(this._mergedLayers,h,this.getLayerSourceCache.bind(this),_.screenGeometry,i,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(u)}querySourceFeatures(e,i){i&&i.filter&&this._validate(a2,"querySourceFeatures.filter",i.filter,null,i);const o=this.getOwnSourceCaches(e);let l=[];for(const u of o)l=l.concat(WG(u,i));return l}addSourceType(e,i,o){return Ql.getSourceType(e)?o(new Error(`A source type called "${e}" already exists.`)):(Ql.setSourceType(e,i),i.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:e,url:i.workerSourceURL},o):o(null,null))}getFlatLight(){return this.light.getLight()}setFlatLight(e,i,o={}){this._checkLoaded();const l=this.light.getLight();let u=!1;for(const m in e)if(!te(e[m],l[m])){u=!0;break}if(!u)return;const h=this._getTransitionParameters();this.light.setLight(e,i,o),this.light.updateTransitions(h)}getTerrain(){return this.terrain&&this.terrain.drapeRenderMode===1?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}setTerrain(e,i=1){if(this._checkLoaded(),!e)return delete this.terrain,delete this.stylesheet.terrain,this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);let o=e;if(i===1){if(typeof o.source=="object"){const l="terrain-dem-src";this.addSource(l,o.source),o=G(o),o=ze(o,{source:l})}if(this._validate(X$,"terrain",o))return}if(!this.terrain||this.terrain&&i!==this.terrain.drapeRenderMode){if(!o)return;this._createTerrain(o,i),this.fire(new _t("data",{dataType:"style"}))}else{const l=this.terrain,u=l.get();for(const h of Object.keys(at.terrain))!o.hasOwnProperty(h)&&at.terrain[h].default&&(o[h]=at.terrain[h].default);for(const h in e)if(!te(e[h],u[h])){l.set(e),this.stylesheet.terrain=e;const m=this._getTransitionParameters({duration:0});l.updateTransitions(m),this.fire(new _t("data",{dataType:"style"}));break}}this.mergeTerrain(),this.updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(e){const i=this.fog=new SG(e,this.map.transform);this.stylesheet.fog=i.get();const o=this._getTransitionParameters({duration:0});i.updateTransitions(o)}_updateMarkersOpacity(){this.map._markers.length!==0&&this.map._requestDomTask(()=>{for(const e of this.map._markers)e._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(e){if(this._checkLoaded(),!e)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const i=this.fog;if(!te(i.get(),e)){i.set(e),this.stylesheet.fog=i.get();const o=this._getTransitionParameters({duration:0});i.updateTransitions(o)}}else this._createFog(e);this._markersNeedUpdate=!0}_getTransitionParameters(e){return{now:Jr.now(),transition:ze(this.transition,e)}}updateDrapeFirstLayers(){if(!this.terrain)return;const e=[],i=[];for(const o in this._mergedLayers)this.isLayerDraped(this._mergedLayers[o])?e.push(o):i.push(o);this._drapedFirstOrder=[],this._drapedFirstOrder.push(...e),this._drapedFirstOrder.push(...i)}_createTerrain(e,i){const o=this.terrain=new EG(e,i);o.setScope(this.scope),this.stylesheet.terrain=e,this.mergeTerrain(),this.updateDrapeFirstLayers(),this._force3DLayerUpdate();const l=this._getTransitionParameters({duration:0});o.updateTransitions(l)}_force3DLayerUpdate(){for(const e in this._layers){const i=this._layers[e];i.type==="fill-extrusion"&&this._updateLayer(i)}}_forceSymbolLayerUpdate(){for(const e in this._layers){const i=this._layers[e];i.type==="symbol"&&this._updateLayer(i)}}_validate(e,i,o,l,u={}){if(u&&u.validate===!1)return!1;const h=ze({},this.serialize());return Fg(this,e.call(Lp,ze({key:i,style:h,value:o,styleSpec:at},l)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),d2.off("pluginStateChange",this._rtlTextPluginCallback);for(const e in this._mergedLayers)this._mergedLayers[e].setEventedParent(null);for(const e in this._mergedSourceCaches)this._mergedSourceCaches[e].clearTiles(),this._mergedSourceCaches[e].setEventedParent(null);this.setEventedParent(null),delete this.fog,delete this.terrain,delete this.ambientLight,delete this.directionalLight,this.isRootStyle()&&(this.imageManager.setEventedParent(null),this.modelManager.setEventedParent(null),this.dispatcher.remove())}clearSource(e){const i=this.getSourceCaches(e);for(const o of i)o.clearTiles()}clearSources(){for(const e in this._mergedSourceCaches)this._mergedSourceCaches[e].clearTiles()}reloadSource(e){const i=this.getSourceCaches(e);for(const o of i)o.resume(),o.reload()}updateSources(e){let i;this.directionalLight&&(i=rR(this.directionalLight));for(const o in this._mergedSourceCaches)this._mergedSourceCaches[o].update(e,void 0,void 0,i)}_generateCollisionBoxes(){for(const e in this._sourceCaches){const i=this._sourceCaches[e];i.resume(),i.reload()}}_updatePlacement(e,i,o,l,u=!1){let h=!1,m=!1;const _={},v={};for(const x of this._mergedOrder){const w=this._mergedLayers[x];if(w.type!=="symbol")continue;const C=To(w.source,w.scope);let k=_[C];if(!k){const R=this.getLayerSourceCache(w);if(!R)continue;const z=R.getRenderableIds(!0).map(B=>R.getTileByID(B));v[C]=z.slice(),k=_[C]=z.sort((B,H)=>H.tileID.overscaledZ-B.tileID.overscaledZ||(B.tileID.isLessThan(H.tileID)?-1:1))}const P=this.crossTileSymbolIndex.addLayer(w,k,e.center.lng,e.projection);h=h||P}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._mergedOrder),u=u||this._layerOrderChanged||o===0,this._layerOrderChanged&&this.fire(new _t("neworder")),(u||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(Jr.now(),e.zoom))&&(this.pauseablePlacement=new uq(e,this._mergedOrder,u,i,o,l,this.placement,this.fog&&e.projection.supportsFog?this.fog.state:null,this._buildingIndex),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._mergedOrder,this._mergedLayers,_,v),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(Jr.now()),m=!0),h&&this.pauseablePlacement.placement.setStale()),m||h)for(const x of this._mergedOrder){const w=this._mergedLayers[x];w.type==="symbol"&&this.placement.updateLayerOpacities(w,_[To(w.source,w.scope)])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(Jr.now())}_releaseSymbolFadeTiles(){for(const e in this._sourceCaches)this._sourceCaches[e].releaseSymbolFadeTiles()}addImport(e){this._checkLoaded();const i=this.stylesheet.imports=this.stylesheet.imports||[];return i.findIndex(({id:l})=>l===e.id)!==-1?this.fire(new ar(new Error(`Import with id '${e.id}' already exists in the map's style.`))):(i.push(e),this._loadImports([e],!0),this)}setImportUrl(e,i){this._checkLoaded();const o=this.stylesheet.imports||[],l=this.getImportIndex(e);if(l===-1)return this;o[l].url=i;const u=this.fragments[l];u.style=this._createFragmentStyle({id:e,url:i});const h=new Promise(m=>u.style.on("style.import.load",m));return u.style.loadURL(i),h.then(()=>this._reloadImports()),this}setImportData(e,i){this._checkLoaded();const o=this.getImportIndex(e),l=this.stylesheet.imports||[];return o===-1?this:i?(this.fragments[o].style.setState(i),this._reloadImports(),this):(delete l[o].data,this.setImportUrl(e,l[o].url))}setImportConfig(e,i){this._checkLoaded();const o=this.getImportIndex(e),l=this.stylesheet.imports||[];if(o===-1)return this;i?l[o].config=i:delete l[o].config;const u=this.fragments[o],h=u.style.stylesheet&&u.style.stylesheet.schema;return u.config=i,u.style.setConfig(i,h),u.style.updateConfigDependencies(),this}removeImport(e){this._checkLoaded();const i=this.stylesheet.imports||[],o=this.getImportIndex(e);return o===-1||(i.splice(o,1),this.fragments[o].style._remove(),this.fragments.splice(o,1),this._reloadImports()),this}getImportIndex(e){const i=(this.stylesheet.imports||[]).findIndex(o=>o.id===e);return i===-1&&this.fire(new ar(new Error(`Import '${e}' does not exist in the map's style and cannot be updated.`))),i}getLayer(e){return this._mergedLayers[e]}getSources(){const e=[];for(const i in this._mergedOtherSourceCaches){const o=this._mergedOtherSourceCaches[i];o&&e.push(o.getSource())}return e}getSource(e,i){const o=this.getSourceCache(e,i);return o&&o.getSource()}getLayerSource(e){const i=this.getLayerSourceCache(e);return i&&i.getSource()}getSourceCache(e,i){const o=To(e,i);return this._mergedOtherSourceCaches[o]}getLayerSourceCache(e){const i=To(e.source,e.scope);return e.type==="symbol"?this._mergedSymbolSourceCaches[i]:this._mergedOtherSourceCaches[i]}getSourceCaches(e){const i=[];return this._mergedOtherSourceCaches[e]&&i.push(this._mergedOtherSourceCaches[e]),this._mergedSymbolSourceCaches[e]&&i.push(this._mergedSymbolSourceCaches[e]),i}updateSourceCaches(){for(const e in this._changes.updatedSourceCaches){const i=this._changes.updatedSourceCaches[e];i==="reload"?this.reloadSource(e):i==="clear"&&this.clearSource(e)}}updateLayers(e){for(const i of this._changes.updatedPaintProps){const o=this.getLayer(i);o&&o.updateTransitions(e)}}getImages(e,i,o){this.imageManager.getImages(i.icons,i.scope,o),this._updateTilesForChangedImages();const l=u=>{u&&u.setDependencies(i.tileID.key,i.type,i.icons)};l(this._otherSourceCaches[i.source]),l(this._symbolSourceCaches[i.source])}getGlyphs(e,i,o){this.glyphManager.getGlyphs(i.stacks,i.scope,o)}getResource(e,i,o){return Ot(i,o)}getOwnSourceCache(e){return this._otherSourceCaches[e]}getOwnLayerSourceCache(e){return e.type==="symbol"?this._symbolSourceCaches[e.source]:this._otherSourceCaches[e.source]}getOwnSourceCaches(e){const i=[];return this._otherSourceCaches[e]&&i.push(this._otherSourceCaches[e]),this._symbolSourceCaches[e]&&i.push(this._symbolSourceCaches[e]),i}_isSourceCacheLoaded(e){const i=this.getOwnSourceCaches(e);return i.length===0?(this.fire(new ar(new Error(`There is no source with ID '${e}'`))),!1):i.every(o=>o.loaded())}has3DLayers(){return this._has3DLayers}hasSymbolLayers(){return this._hasSymbolLayers}hasCircleLayers(){return this._hasCircleLayers}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}function aR(r,e){let i=!1,o=null;const l=()=>{o=null,i&&(r(),o=setTimeout(l,e),i=!1)};return()=>(i=!0,o||l(),o)}Ql.getSourceType=function(r){return hT[r]},Ql.setSourceType=function(r,e){hT[r]=e},Ql.registerForPluginStateChange=function(r){return r({pluginStatus:ws,pluginURL:If}),d2.on("pluginStateChange",r),r};class bX{constructor(e){this._hashName=e&&encodeURIComponent(e),ae(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=aR(this._updateHashUnthrottled.bind(this),300)}addTo(e){return this._map=e,g.addEventListener("hashchange",this._onHashChange,!1),e.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),g.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const e=this._map;if(!e)return"";const i=oR(e);if(this._hashName){const o=this._hashName;let l=!1;const u=g.location.hash.slice(1).split("&").map(h=>{const m=h.split("=")[0];return m===o?(l=!0,`${m}=${i}`):h}).filter(h=>h);return l||u.push(`${o}=${i}`),`#${u.join("&")}`}return`#${i}`}_getCurrentHash(){const e=g.location.hash.replace("#","");if(this._hashName){let i;return e.split("&").map(o=>o.split("=")).forEach(o=>{o[0]===this._hashName&&(i=o)}),(i&&i[1]||"").split("/")}return e.split("/")}_onHashChange(){const e=this._map;if(!e)return!1;const i=this._getCurrentHash();if(i.length>=3&&!i.some(o=>isNaN(o))){const o=e.dragRotate.isEnabled()&&e.touchZoomRotate.isEnabled()?+(i[3]||0):e.getBearing();return e.jumpTo({center:[+i[2],+i[1]],zoom:+i[0],bearing:o,pitch:+(i[4]||0)}),!0}return!1}_updateHashUnthrottled(){const e=g.location.href.replace(/(#.+)?$/,this.getHashString());g.history.replaceState(g.history.state,null,e)}}function oR(r,e){const i=r.getCenter(),o=Math.round(100*r.getZoom())/100,l=Math.ceil((o*Math.LN2+Math.log(512/360/.5))/Math.LN10),u=Math.pow(10,l),h=Math.round(i.lng*u)/u,m=Math.round(i.lat*u)/u,_=r.getBearing(),v=r.getPitch();let x=e?`/${h}/${m}/${o}`:`${o}/${m}/${h}`;return(_||v)&&(x+="/"+Math.round(10*_)/10),v&&(x+=`/${Math.round(v)}`),x}const Ay={linearity:.3,easing:Ne(0,0,.3,1)},wX=ze({deceleration:2500,maxSpeed:1400},Ay),EX=ze({deceleration:20,maxSpeed:1400},Ay),TX=ze({deceleration:1e3,maxSpeed:360},Ay),SX=ze({deceleration:1e3,maxSpeed:90},Ay);class CX{constructor(e){this._map=e,this.clear()}clear(){this._inertiaBuffer=[]}record(e){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:Jr.now(),settings:e})}_drainInertiaBuffer(){const e=this._inertiaBuffer,i=Jr.now();for(;e.length>0&&i-e[0].time>160;)e.shift()}_onMoveEnd(e){if(this._map._prefersReducedMotion()||(this._drainInertiaBuffer(),this._inertiaBuffer.length<2))return;const i={zoom:0,bearing:0,pitch:0,pan:new D(0,0),pinchAround:void 0,around:void 0};for(const{settings:u}of this._inertiaBuffer)i.zoom+=u.zoomDelta||0,i.bearing+=u.bearingDelta||0,i.pitch+=u.pitchDelta||0,u.panDelta&&i.pan._add(u.panDelta),u.around&&(i.around=u.around),u.pinchAround&&(i.pinchAround=u.pinchAround);const o=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,l={};if(i.pan.mag()){const u=Iy(i.pan.mag(),o,ze({},wX,e||{}));l.offset=i.pan.mult(u.amount/i.pan.mag()),l.center=this._map.transform.center,ky(l,u)}if(i.zoom){const u=Iy(i.zoom,o,EX);l.zoom=this._map.transform.zoom+u.amount,ky(l,u)}if(i.bearing){const u=Iy(i.bearing,o,TX);l.bearing=this._map.transform.bearing+Oe(u.amount,-179,179),ky(l,u)}if(i.pitch){const u=Iy(i.pitch,o,SX);l.pitch=this._map.transform.pitch+u.amount,ky(l,u)}if(l.zoom||l.bearing){const u=i.pinchAround===void 0?i.around:i.pinchAround;l.around=u?this._map.unproject(u):this._map.getCenter()}return this.clear(),l.noMoveStart=!0,l}}function ky(r,e){(!r.duration||r.duration<e.duration)&&(r.duration=e.duration,r.easing=e.easing)}function Iy(r,e,i){const{maxSpeed:o,linearity:l,deceleration:u}=i,h=Oe(r*l/(e/1e3),-o,o),m=Math.abs(h)/(u*l);return{easing:i.easing,duration:1e3*m,amount:h*(m/2)}}class Qs extends _t{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,i,o,l={}){const u=vt(i.getCanvasContainer(),o);super(e,ze({point:u,lngLat:i.unproject(u),originalEvent:o},l)),this._defaultPrevented=!1,this.target=i}}class My extends _t{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,i,o){const l=e==="touchend"?o.changedTouches:o.touches,u=wt(i.getCanvasContainer(),l),h=u.map(_=>i.unproject(_)),m=u.reduce((_,v,x,w)=>_.add(v.div(w.length)),new D(0,0));super(e,{points:u,point:m,lngLats:h,lngLat:i.unproject(m),originalEvent:o}),this._defaultPrevented=!1}}class AX extends _t{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,i,o){super(e,{originalEvent:o}),this._defaultPrevented=!1}}class kX{constructor(e,i){this._map=e,this._clickTolerance=i.clickTolerance}reset(){this._mousedownPos=void 0}wheel(e){return this._firePreventable(new AX(e.type,this._map,e))}mousedown(e,i){return this._mousedownPos=i,this._firePreventable(new Qs(e.type,this._map,e))}mouseup(e){this._map.fire(new Qs(e.type,this._map,e))}preclick(e){const i=ze({},e);i.type="preclick",this._map.fire(new Qs(i.type,this._map,i))}click(e,i){this._mousedownPos&&this._mousedownPos.dist(i)>=this._clickTolerance||(this.preclick(e),this._map.fire(new Qs(e.type,this._map,e)))}dblclick(e){return this._firePreventable(new Qs(e.type,this._map,e))}mouseover(e){this._map.fire(new Qs(e.type,this._map,e))}mouseout(e){this._map.fire(new Qs(e.type,this._map,e))}touchstart(e){return this._firePreventable(new My(e.type,this._map,e))}touchmove(e){this._map.fire(new My(e.type,this._map,e))}touchend(e){this._map.fire(new My(e.type,this._map,e))}touchcancel(e){this._map.fire(new My(e.type,this._map,e))}_firePreventable(e){if(this._map.fire(e),e.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class IX{constructor(e){this._map=e}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(e){this._map.fire(new Qs(e.type,this._map,e))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Qs("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(e){this._delayContextMenu?this._contextMenuEvent=e:this._map.fire(new Qs(e.type,this._map,e)),this._map.listens("contextmenu")&&e.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class MX{constructor(e,i){this._map=e,this._el=e.getCanvasContainer(),this._container=e.getContainer(),this._clickTolerance=i.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(e,i){this.isEnabled()&&e.shiftKey&&e.button===0&&(ne(),this._startPos=this._lastPos=i,this._active=!0)}mousemoveWindow(e,i){if(!this._active)return;const o=i,l=this._startPos,u=this._lastPos;if(!l||!u||u.equals(o)||!this._box&&o.dist(l)<this._clickTolerance)return;this._lastPos=o,this._box||(this._box=pi("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",e));const h=Math.min(l.x,o.x),m=Math.max(l.x,o.x),_=Math.min(l.y,o.y),v=Math.max(l.y,o.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${h}px,${_}px)`,this._box.style.width=m-h+"px",this._box.style.height=v-_+"px")})}mouseupWindow(e,i){if(!this._active)return;const o=this._startPos,l=i;if(o&&e.button===0){if(this.reset(),mt(),o.x!==l.x||o.y!==l.y)return this._map.fire(new _t("boxzoomend",{originalEvent:e})),{cameraAnimation:u=>u.fitScreenCoordinates(o,l,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",e)}}keydown(e){this._active&&e.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",e))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),Te(),delete this._startPos,delete this._lastPos}_fireEvent(e,i){return this._map.fire(new _t(e,{originalEvent:i}))}}function AT(r,e){const i={};for(let o=0;o<r.length;o++)i[r[o].identifier]=e[o];return i}class FX{constructor(e){this.reset(),this.numTouches=e.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(e,i,o){(this.centroid||o.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===0&&(this.startTime=e.timeStamp),o.length===this.numTouches&&(this.centroid=function(l){const u=new D(0,0);for(const h of l)u._add(h);return u.div(l.length)}(i),this.touches=AT(o,i)))}touchmove(e,i,o){if(this.aborted||!this.centroid)return;const l=AT(o,i);for(const u in this.touches){const h=l[u];(!h||h.dist(this.touches[u])>30)&&(this.aborted=!0)}}touchend(e,i,o){if((!this.centroid||e.timeStamp-this.startTime>500)&&(this.aborted=!0),o.length===0){const l=!this.aborted&&this.centroid;if(this.reset(),l)return l}}}class kT{constructor(e){this.singleTap=new FX(e),this.numTaps=e.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(e,i,o){this.singleTap.touchstart(e,i,o)}touchmove(e,i,o){this.singleTap.touchmove(e,i,o)}touchend(e,i,o){const l=this.singleTap.touchend(e,i,o);if(l){const u=e.timeStamp-this.lastTime<500,h=!this.lastTap||this.lastTap.dist(l)<30;if(u&&h||this.reset(),this.count++,this.lastTime=e.timeStamp,this.lastTap=l,this.count===this.numTaps)return this.reset(),l}}}class PX{constructor(){this._zoomIn=new kT({numTouches:1,numTaps:2}),this._zoomOut=new kT({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(e,i,o){this._zoomIn.touchstart(e,i,o),this._zoomOut.touchstart(e,i,o)}touchmove(e,i,o){this._zoomIn.touchmove(e,i,o),this._zoomOut.touchmove(e,i,o)}touchend(e,i,o){const l=this._zoomIn.touchend(e,i,o),u=this._zoomOut.touchend(e,i,o);return l?(this._active=!0,e.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:h=>h.easeTo({duration:300,zoom:h.getZoom()+1,around:h.unproject(l)},{originalEvent:e})}):u?(this._active=!0,e.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:h=>h.easeTo({duration:300,zoom:h.getZoom()-1,around:h.unproject(u)},{originalEvent:e})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const OX={0:1,2:2};class IT{constructor(e){this.reset(),this._clickTolerance=e.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(e,i){return!1}_move(e,i){return{}}mousedown(e,i){if(this._lastPoint)return;const o=sr(e);this._correctButton(e,o)&&(this._lastPoint=i,this._eventButton=o)}mousemoveWindow(e,i){const o=this._lastPoint;if(o){if(e.preventDefault(),this._eventButton!=null&&function(l,u){const h=OX[u];return l.buttons===void 0||(l.buttons&h)!==h}(e,this._eventButton))this.reset();else if(this._moved||!(i.dist(o)<this._clickTolerance))return this._moved=!0,this._lastPoint=i,this._move(o,i)}}mouseupWindow(e){this._lastPoint&&sr(e)===this._eventButton&&(this._moved&&mt(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class RX extends IT{mousedown(e,i){super.mousedown(e,i),this._lastPoint&&(this._active=!0)}_correctButton(e,i){return i===0&&!e.ctrlKey}_move(e,i){return{around:i,panDelta:i.sub(e)}}}class sR extends IT{_correctButton(e,i){return i===0&&e.ctrlKey||i===2}_move(e,i){const o=.8*(i.x-e.x);if(o)return this._active=!0,{bearingDelta:o}}contextmenu(e){e.preventDefault()}}class lR extends IT{_correctButton(e,i){return i===0&&e.ctrlKey||i===2}_move(e,i){const o=-.5*(i.y-e.y);if(o)return this._active=!0,{pitchDelta:o}}contextmenu(e){e.preventDefault()}}class LX{constructor(e,i){this._map=e,this._el=e.getCanvasContainer(),this._minTouches=1,this._clickTolerance=i.clickTolerance||1,this.reset(),ae(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new D(0,0)}touchstart(e,i,o){return this._calculateTransform(e,i,o)}touchmove(e,i,o){if(this._active&&!(o.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(o.length===1&&!At())return void this._showTouchPanBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return e.cancelable&&e.preventDefault(),this._calculateTransform(e,i,o)}}touchend(e,i,o){this._calculateTransform(e,i,o),this._active&&o.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(e,i,o){o.length>0&&(this._active=!0);const l=AT(o,i),u=new D(0,0),h=new D(0,0);let m=0;for(const v in l){const x=l[v],w=this._touches[v];w&&(u._add(x),h._add(x.sub(w)),m++,l[v]=x)}if(this._touches=l,m<this._minTouches||!h.mag())return;const _=h.div(m);return this._sum._add(_),this._sum.mag()<this._clickTolerance?void 0:{around:u.div(m),panDelta:_}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=pi("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","null")},500)}}class MT{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(e){}_move(e,i,o){return{}}touchstart(e,i,o){this._firstTwoTouches||o.length<2||(this._firstTwoTouches=[o[0].identifier,o[1].identifier],this._start([i[0],i[1]]))}touchmove(e,i,o){const l=this._firstTwoTouches;if(!l)return;e.preventDefault();const[u,h]=l,m=Fy(o,i,u),_=Fy(o,i,h);if(!m||!_)return;const v=this._aroundCenter?null:m.add(_).div(2);return this._move([m,_],v,e)}touchend(e,i,o){if(!this._firstTwoTouches)return;const[l,u]=this._firstTwoTouches,h=Fy(o,i,l),m=Fy(o,i,u);h&&m||(this._active&&mt(),this.reset())}touchcancel(){this.reset()}enable(e){this._enabled=!0,this._aroundCenter=!!e&&e.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function Fy(r,e,i){for(let o=0;o<r.length;o++)if(r[o].identifier===i)return e[o]}function cR(r,e){return Math.log(r/e)/Math.LN2}class DX extends MT{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(e){this._startDistance=this._distance=e[0].dist(e[1])}_move(e,i){const o=this._distance;if(this._distance=e[0].dist(e[1]),this._active||!(Math.abs(cR(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:cR(this._distance,o),pinchAround:i}}}function uR(r,e){return 180*r.angleWith(e)/Math.PI}class BX extends MT{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(e){this._startVector=this._vector=e[0].sub(e[1]),this._minDiameter=e[0].dist(e[1])}_move(e,i){const o=this._vector;if(this._vector=e[0].sub(e[1]),o&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:uR(this._vector,o),pinchAround:i}}_isBelowThreshold(e){this._minDiameter=Math.min(this._minDiameter,e.mag());const i=25/(Math.PI*this._minDiameter)*360,o=this._startVector;if(!o)return!1;const l=uR(e,o);return Math.abs(l)<i}}function FT(r){return Math.abs(r.y)>Math.abs(r.x)}class zX extends MT{constructor(e){super(),this._map=e}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(e){this._lastPoints=e,FT(e[0].sub(e[1]))&&(this._valid=!1)}_move(e,i,o){const l=this._lastPoints;if(!l)return;const u=e[0].sub(l[0]),h=e[1].sub(l[1]);return this._map._cooperativeGestures&&!At()&&o.touches.length<3||(this._valid=this.gestureBeginsVertically(u,h,o.timeStamp),!this._valid)?void 0:(this._lastPoints=e,this._active=!0,{pitchDelta:(u.y+h.y)/2*-.5})}gestureBeginsVertically(e,i,o){if(this._valid!==void 0)return this._valid;const l=e.mag()>=2,u=i.mag()>=2;if(!l&&!u)return;if(!l||!u)return this._firstMove==null&&(this._firstMove=o),o-this._firstMove<100&&void 0;const h=e.y>0==i.y>0;return FT(e)&&FT(i)&&h}}const NX={panStep:100,bearingStep:15,pitchStep:10};class UX{constructor(){const e=NX;this._panStep=e.panStep,this._bearingStep=e.bearingStep,this._pitchStep=e.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(e){if(e.altKey||e.ctrlKey||e.metaKey)return;let i=0,o=0,l=0,u=0,h=0;switch(e.keyCode){case 61:case 107:case 171:case 187:i=1;break;case 189:case 109:case 173:i=-1;break;case 37:e.shiftKey?o=-1:(e.preventDefault(),u=-1);break;case 39:e.shiftKey?o=1:(e.preventDefault(),u=1);break;case 38:e.shiftKey?l=1:(e.preventDefault(),h=-1);break;case 40:e.shiftKey?l=-1:(e.preventDefault(),h=1);break;default:return}return this._rotationDisabled&&(o=0,l=0),{cameraAnimation:m=>{const _=m.getZoom();m.easeTo({duration:300,easeId:"keyboardHandler",easing:$X,zoom:i?Math.round(_)+i*(e.shiftKey?2:1):_,bearing:m.getBearing()+o*this._bearingStep,pitch:m.getPitch()+l*this._pitchStep,offset:[-u*this._panStep,-h*this._panStep],center:m.getCenter()},{originalEvent:e})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function $X(r){return r*(2-r)}const fR=4.000244140625;class VX{constructor(e,i){this._map=e,this._el=e.getCanvasContainer(),this._handler=i,this._delta=0,this._lastDelta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,ae(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(e){this._defaultZoomRate=e}setWheelZoomRate(e){this._wheelZoomRate=e}isEnabled(){return!!this._enabled}isActive(){return this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(e){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!e&&e.around==="center",this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(e){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(e.ctrlKey||e.metaKey||this.isZooming()||At()))return void this._showBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let i=e.deltaMode===g.WheelEvent.DOM_DELTA_LINE?40*e.deltaY:e.deltaY;const o=Jr.now(),l=o-(this._lastWheelEventTime||0);this._lastWheelEventTime=o,i!==0&&i%fR==0?this._type="wheel":i!==0&&Math.abs(i)<4?this._type="trackpad":l>400?(this._type=null,this._lastValue=i,this._timeout=setTimeout(this._onTimeout,40,e)):this._type||(this._type=Math.abs(l*i)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,i+=this._lastValue)),e.shiftKey&&i&&(i/=4),this._type&&(this._lastWheelEvent=e,this._delta-=i,this._active||this._start(e)),e.preventDefault()}_onTimeout(e){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(e)}_start(e){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const i=vt(this._el,e);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:i,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const e=this._map.transform;this._type==="wheel"&&e.projection.wrap&&(e._center.lng>=180||e._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const i=()=>e._terrainEnabled()&&this._aroundCoord?e.computeZoomRelativeTo(this._aroundCoord):e.zoom;if(this._delta!==0){const v=this._type==="wheel"&&Math.abs(this._delta)>fR?this._wheelZoomRate:this._defaultZoomRate;let x=2/(1+Math.exp(-Math.abs(this._delta*v)));this._delta<0&&x!==0&&(x=1/x);const w=i(),C=Math.pow(2,w),k=typeof this._targetZoom=="number"?e.zoomScale(this._targetZoom):C;this._targetZoom=Math.min(e.maxZoom,Math.max(e.minZoom,e.scaleZoom(k*x))),this._type==="wheel"&&(this._startZoom=w,this._easing=this._smoothOutEasing(200)),this._lastDelta=this._delta,this._delta=0}const o=typeof this._targetZoom=="number"?this._targetZoom:i(),l=this._startZoom,u=this._easing;let h,m=!1;if(this._type==="wheel"&&l&&u){const v=Math.min((Jr.now()-this._lastWheelEventTime)/200,1);h=$r(l,o,u(v)),v<1?this._frameId||(this._frameId=!0):m=!0}else h=o,m=!0;this._active=!0,m&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200));let _=h-i();return _*this._lastDelta<0&&(_=0),{noInertia:!0,needsRenderFrame:!m,zoomDelta:_,around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(e){let i=He;if(this._prevEase){const o=this._prevEase,l=(Jr.now()-o.start)/o.duration,u=o.easing(l+.01)-o.easing(l),h=.27/Math.sqrt(u*u+1e-4)*.01;i=Ne(h,Math.sqrt(.0729-h*h),.25,1)}return this._prevEase={start:Jr.now(),duration:e,easing:i},i}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=pi("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(g.navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","null")},200)}}class jX{constructor(e,i){this._clickZoom=e,this._tapZoom=i}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class WX{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(e,i){return e.preventDefault(),{cameraAnimation:o=>{o.easeTo({duration:300,zoom:o.getZoom()+(e.shiftKey?-1:1),around:o.unproject(i)},{originalEvent:e})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class HX{constructor(){this._tap=new kT({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(e,i,o){this._swipePoint||(this._tapTime&&e.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?o.length>0&&(this._swipePoint=i[0],this._swipeTouch=o[0].identifier):this._tap.touchstart(e,i,o))}touchmove(e,i,o){if(this._tapTime){if(this._swipePoint){if(o[0].identifier!==this._swipeTouch)return;const l=i[0],u=l.y-this._swipePoint.y;return this._swipePoint=l,e.preventDefault(),this._active=!0,{zoomDelta:u/128}}}else this._tap.touchmove(e,i,o)}touchend(e,i,o){this._tapTime?this._swipePoint&&o.length===0&&this.reset():this._tap.touchend(e,i,o)&&(this._tapTime=e.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class GX{constructor(e,i,o){this._el=e,this._mousePan=i,this._touchPan=o}enable(e){this._inertiaOptions=e||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class qX{constructor(e,i,o){this._pitchWithRotate=e.pitchWithRotate,this._mouseRotate=i,this._mousePitch=o}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class XX{constructor(e,i,o,l){this._el=e,this._touchZoom=i,this._touchRotate=o,this._tapDragZoom=l,this._rotationDisabled=!1,this._enabled=!0}enable(e){this._touchZoom.enable(e),this._rotationDisabled||this._touchRotate.enable(e),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const Py=r=>r.zoom||r.drag||r.pitch||r.rotate;class ZX extends _t{}class KX{constructor(){this.constants=[1,1,.01],this.radius=0}setup(e,i){const o=We.sub([],i,e);this.radius=We.length(o[2]<0?We.div([],o,this.constants):[o[0],o[1],0])}projectRay(e){We.div(e,e,this.constants),We.normalize(e,e),We.mul(e,e,this.constants);const i=We.scale([],e,this.radius);if(i[2]>0){const o=We.scale([],[0,0,1],We.dot(i,[0,0,1])),l=We.scale([],We.normalize([],[i[0],i[1],0]),this.radius),u=We.add([],i,We.scale([],We.sub([],We.add([],l,o),i),2));i[0]=u[0],i[1]=u[1]}return i}}function Oy(r){return r.panDelta&&r.panDelta.mag()||r.zoomDelta||r.bearingDelta||r.pitchDelta}class YX{constructor(e,i){this._map=e,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new CX(e),this._bearingSnap=i.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new KX,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(i),ae(["handleEvent","handleWindowEvent"],this);const o=this._el;this._listeners=[[o,"touchstart",{passive:!0}],[o,"touchmove",{passive:!1}],[o,"touchend",void 0],[o,"touchcancel",void 0],[o,"mousedown",void 0],[o,"mousemove",void 0],[o,"mouseup",void 0],[g.document,"mousemove",{capture:!0}],[g.document,"mouseup",void 0],[o,"mouseover",void 0],[o,"mouseout",void 0],[o,"dblclick",void 0],[o,"click",void 0],[o,"keydown",{capture:!1}],[o,"keyup",void 0],[o,"wheel",{passive:!1}],[o,"contextmenu",void 0],[g,"blur",void 0]];for(const[l,u,h]of this._listeners)l.addEventListener(u,l===g.document?this.handleWindowEvent:this.handleEvent,h)}destroy(){for(const[e,i,o]of this._listeners)e.removeEventListener(i,e===g.document?this.handleWindowEvent:this.handleEvent,o)}_addDefaultHandlers(e){const i=this._map,o=i.getCanvasContainer();this._add("mapEvent",new kX(i,e));const l=i.boxZoom=new MX(i,e);this._add("boxZoom",l);const u=new PX,h=new WX;i.doubleClickZoom=new jX(h,u),this._add("tapZoom",u),this._add("clickZoom",h);const m=new HX;this._add("tapDragZoom",m);const _=i.touchPitch=new zX(i);this._add("touchPitch",_);const v=new sR(e),x=new lR(e);i.dragRotate=new qX(e,v,x),this._add("mouseRotate",v,["mousePitch"]),this._add("mousePitch",x,["mouseRotate"]);const w=new RX(e),C=new LX(i,e);i.dragPan=new GX(o,w,C),this._add("mousePan",w),this._add("touchPan",C,["touchZoom","touchRotate"]);const k=new BX,P=new DX;i.touchZoomRotate=new XX(o,P,k,m),this._add("touchRotate",k,["touchPan","touchZoom"]),this._add("touchZoom",P,["touchPan","touchRotate"]),this._add("blockableMapEvent",new IX(i));const R=i.scrollZoom=new VX(i,this);this._add("scrollZoom",R,["mousePan"]);const z=i.keyboard=new UX;this._add("keyboard",z);for(const B of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])e.interactive&&e[B]&&i[B].enable(e[B])}_add(e,i,o){this._handlers.push({handlerName:e,handler:i,allowed:o}),this._handlersById[e]=i}stop(e){if(!this._updatingCamera){for(const{handler:i}of this._handlers)i.reset();this._inertia.clear(),this._fireEvents({},{},e),this._changes=[],this._originalZoom=void 0}}isActive(){for(const{handler:e}of this._handlers)if(e.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Py(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(e,i,o){for(const l in e)if(l!==o&&(!i||i.indexOf(l)<0))return!0;return!1}handleWindowEvent(e){this.handleEvent(e,`${e.type}Window`)}_getMapTouches(e){const i=[];for(const o of e)this._el.contains(o.target)&&i.push(o);return i}handleEvent(e,i){this._updatingCamera=!0;const o=e.type==="renderFrame",l=o?void 0:e,u={needsRenderFrame:!1},h={},m={},_=e.touches?this._getMapTouches(e.touches):void 0,v=_?wt(this._el,_):o?void 0:vt(this._el,e);for(const{handlerName:C,handler:k,allowed:P}of this._handlers){if(!k.isEnabled())continue;let R;this._blockedByActive(m,P,C)?k.reset():k[i||e.type]&&(R=k[i||e.type](e,v,_),this.mergeHandlerResult(u,h,R,C,l),R&&R.needsRenderFrame&&this._triggerRenderFrame()),(R||k.isActive())&&(m[C]=k)}const x={};for(const C in this._previousActiveHandlers)m[C]||(x[C]=l);this._previousActiveHandlers=m,(Object.keys(x).length||Oy(u))&&(this._changes.push([u,h,x]),this._triggerRenderFrame()),(Object.keys(m).length||Oy(u))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:w}=u;w&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],w(this._map))}mergeHandlerResult(e,i,o,l,u){if(!o)return;ze(e,o);const h={handlerName:l,originalEvent:o.originalEvent||u};o.zoomDelta!==void 0&&(i.zoom=h),o.panDelta!==void 0&&(i.drag=h),o.pitchDelta!==void 0&&(i.pitch=h),o.bearingDelta!==void 0&&(i.rotate=h)}_applyChanges(){const e={},i={},o={};for(const[l,u,h]of this._changes)l.panDelta&&(e.panDelta=(e.panDelta||new D(0,0))._add(l.panDelta)),l.zoomDelta&&(e.zoomDelta=(e.zoomDelta||0)+l.zoomDelta),l.bearingDelta&&(e.bearingDelta=(e.bearingDelta||0)+l.bearingDelta),l.pitchDelta&&(e.pitchDelta=(e.pitchDelta||0)+l.pitchDelta),l.around!==void 0&&(e.around=l.around),l.aroundCoord!==void 0&&(e.aroundCoord=l.aroundCoord),l.pinchAround!==void 0&&(e.pinchAround=l.pinchAround),l.noInertia&&(e.noInertia=l.noInertia),ze(i,u),ze(o,h);this._updateMapTransform(e,i,o),this._changes=[]}_updateMapTransform(e,i,o){const l=this._map,u=l.transform,h=H=>[H.x,H.y,H.z];if((H=>{const Z=this._eventsInProgress.drag;return Z&&!this._handlersById[Z.handlerName].isActive()})()&&!Oy(e)){const H=u.zoom;u.cameraElevationReference="sea",this._originalZoom!=null&&u._orthographicProjectionAtLowPitch&&u.projection.name!=="globe"&&u.pitch===0?(u.cameraElevationReference="ground",u.zoom=this._originalZoom):(u.recenterOnTerrain(),u.cameraElevationReference="ground"),H!==u.zoom&&this._map._update(!0)}if(u._isCameraConstrained&&l._stop(!0),!Oy(e))return void this._fireEvents(i,o,!0);let{panDelta:m,zoomDelta:_,bearingDelta:v,pitchDelta:x,around:w,aroundCoord:C,pinchAround:k}=e;u._isCameraConstrained&&(_>0&&(_=0),u._isCameraConstrained=!1),k!==void 0&&(w=k),(_||(H=>i[H]&&!this._eventsInProgress[H])("drag"))&&w&&(this._dragOrigin=h(u.pointCoordinate3D(w)),this._originalZoom=u.zoom,this._trackingEllipsoid.setup(u._camera.position,this._dragOrigin)),u.cameraElevationReference="sea",l._stop(!0),w=w||l.transform.centerPoint,v&&(u.bearing+=v),x&&(u.pitch+=x),u._updateCameraState();const P=[0,0,0];if(m)if(u.projection.name==="mercator"){const H=this._trackingEllipsoid.projectRay(u.screenPointToMercatorRay(w).dir),Z=this._trackingEllipsoid.projectRay(u.screenPointToMercatorRay(w.sub(m)).dir);P[0]=Z[0]-H[0],P[1]=Z[1]-H[1]}else{const H=u.pointCoordinate(w);if(u.projection.name==="globe"){m=m.rotate(-u.angle);const Z=u._pixelsPerMercatorPixel/u.worldSize;P[0]=-m.x*oE(ka(H.y))*Z,P[1]=-m.y*oE(u.center.lat)*Z}else{const Z=u.pointCoordinate(w.sub(m));H&&Z&&(P[0]=Z.x-H.x,P[1]=Z.y-H.y)}}const R=u.zoom,z=[0,0,0];if(_){const H=h(C||u.pointCoordinate3D(w)),Z={dir:We.normalize([],We.sub([],H,u._camera.position))};if(Z.dir[2]<0){const Y=u.zoomDeltaToMovement(H,_);We.scale(z,Z.dir,Y)}}const B=We.add(P,P,z);u._translateCameraConstrained(B),_&&Math.abs(u.zoom-R)>1e-4&&u.recenterOnTerrain(),u.cameraElevationReference="ground",this._map._update(),e.noInertia||this._inertia.record(e),this._fireEvents(i,o,!0)}_fireEvents(e,i,o){const l=Py(this._eventsInProgress),u=Py(e),h={};for(const x in e){const{originalEvent:w}=e[x];this._eventsInProgress[x]||(h[`${x}start`]=w),this._eventsInProgress[x]=e[x]}!l&&u&&this._fireEvent("movestart",u.originalEvent);for(const x in h)this._fireEvent(x,h[x]);u&&this._fireEvent("move",u.originalEvent);for(const x in e){const{originalEvent:w}=e[x];this._fireEvent(x,w)}const m={};let _;for(const x in this._eventsInProgress){const{handlerName:w,originalEvent:C}=this._eventsInProgress[x];this._handlersById[w].isActive()||(delete this._eventsInProgress[x],_=i[w]||C,m[`${x}end`]=_)}for(const x in m)this._fireEvent(x,m[x]);const v=Py(this._eventsInProgress);if(o&&(l||u)&&!v){this._updatingCamera=!0;const x=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),w=C=>C!==0&&-this._bearingSnap<C&&C<this._bearingSnap;x?(w(x.bearing||this._map.getBearing())&&(x.bearing=0),this._map.easeTo(x,{originalEvent:_})):(this._map.fire(new _t("moveend",{originalEvent:_})),w(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(e,i){this._map.fire(new _t(e,i?{originalEvent:i}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(e=>{this._frameId=void 0,this.handleEvent(new ZX("renderFrame",{timeStamp:e})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const hR="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class JX extends Ln{constructor(e,i){super(),this._moving=!1,this._zooming=!1,this.transform=e,this._bearingSnap=i.bearingSnap,this._respectPrefersReducedMotion=i.respectPrefersReducedMotion!==!1,ae(["_renderFrameCallback"],this)}getCenter(){return new Xr(this.transform.center.lng,this.transform.center.lat)}setCenter(e,i){return this.jumpTo({center:e},i)}panBy(e,i,o){return e=D.convert(e).mult(-1),this.panTo(this.transform.center,ze({offset:e},i),o)}panTo(e,i,o){return this.easeTo(ze({center:e},i),o)}getZoom(){return this.transform.zoom}setZoom(e,i){return this.jumpTo({zoom:e},i),this}zoomTo(e,i,o){return this.easeTo(ze({zoom:e},i),o)}zoomIn(e,i){return this.zoomTo(this.getZoom()+1,e,i),this}zoomOut(e,i){return this.zoomTo(this.getZoom()-1,e,i),this}getBearing(){return this.transform.bearing}setBearing(e,i){return this.jumpTo({bearing:e},i),this}getPadding(){return this.transform.padding}setPadding(e,i){return this.jumpTo({padding:e},i),this}rotateTo(e,i,o){return this.easeTo(ze({bearing:e},i),o)}resetNorth(e,i){return this.rotateTo(0,ze({duration:1e3},e),i),this}resetNorthPitch(e,i){return this.easeTo(ze({bearing:0,pitch:0,duration:1e3},e),i),this}snapToNorth(e,i){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(e,i):this}getPitch(){return this.transform.pitch}setPitch(e,i){return this.jumpTo({pitch:e},i),this}cameraForBounds(e,i){e=Ks.convert(e);const o=i&&i.bearing||0,l=i&&i.pitch||0,u=e.getNorthWest(),h=e.getSouthEast();return this._cameraForBounds(this.transform,u,h,o,l,i)}_extendCameraOptions(e){const i={top:0,bottom:0,right:0,left:0};if(typeof(e=ze({padding:i,offset:[0,0],maxZoom:this.transform.maxZoom},e)).padding=="number"){const o=e.padding;e.padding={top:o,bottom:o,right:o,left:o}}return e.padding=ze(i,e.padding),e}_minimumAABBFrustumDistance(e,i){const o=i.max[0]-i.min[0],l=i.max[1]-i.min[1];return o/l>e.aspect?o/(2*Math.tan(.5*e.fovX)*e.aspect):l/(2*Math.tan(.5*e.fovY)*e.aspect)}_cameraForBoundsOnGlobe(e,i,o,l,u,h){const m=e.clone(),_=this._extendCameraOptions(h);m.bearing=l,m.pitch=u;const v=Xr.convert(i),x=Xr.convert(o),w=.5*(v.lat+x.lat),C=.5*(v.lng+x.lng),k=ns(w,C),P=We.normalize([],k),R=We.normalize([],We.cross([],P,[0,1,0])),z=We.cross([],R,P),B=[R[0],R[1],R[2],0,z[0],z[1],z[2],0,P[0],P[1],P[2],0,0,0,0,1],H=[k,ns(v.lat,v.lng),ns(x.lat,v.lng),ns(x.lat,x.lng),ns(v.lat,x.lng),ns(w,v.lng),ns(w,x.lng),ns(v.lat,C),ns(x.lat,C)];let Z=Oi.fromPoints(H.map(tt=>[We.dot(R,tt),We.dot(z,tt),We.dot(P,tt)]));const Y=We.transformMat4([],Z.center,B);We.squaredLength(Y)===0&&We.set(Y,0,0,1),We.normalize(Y,Y),We.scale(Y,Y,Fo),m.center=function([tt,pt,bt]){const St=Math.hypot(tt,pt,bt),Pt=Math.atan2(tt,bt),Ut=.5*Math.PI-Math.acos(-pt/St);return new Xr(re(Pt),re(Ut))}(Y);const q=m.getWorldToCameraMatrix(),ee=dt.invert(new Float64Array(16),q);Z=Oi.applyTransform(Z,dt.multiply([],q,B)),We.transformMat4(Y,Y,q);const ce=.5*(Z.max[2]-Z.min[2]),de=this._minimumAABBFrustumDistance(m,Z),ge=We.scale([],[0,0,1],ce),ve=We.add(ge,Y,ge),Re=de+(m.pitch===0?0:We.distance(Y,ve)),ke=m.globeCenterInViewSpace,$e=We.sub([],Y,[ke[0],ke[1],ke[2]]);We.normalize($e,$e),We.scale($e,$e,Re);const Ie=We.add([],Y,$e);We.transformMat4(Ie,Ie,ee);const Qe=Hp/Fo,st=We.length(Ie),ft=fi(Math.max(st*Qe-Hp,Number.EPSILON),0),Je=Math.min(m.zoomFromMercatorZAdjusted(ft),_.maxZoom);return Je>.5*(eg+zf)?(m.setProjection({name:"mercator"}),m.zoom=Je,this._cameraForBounds(m,i,o,l,u,h)):{center:m.center,zoom:Je,bearing:l,pitch:u}}queryTerrainElevation(e,i){const o=this.transform.elevation;return o?(i=ze({},{exaggerated:!0},i),o.getAtPoint(Pn.fromLngLat(e),null,i.exaggerated)):null}_cameraForBounds(e,i,o,l,u,h){if(e.projection.name==="globe")return this._cameraForBoundsOnGlobe(e,i,o,l,u,h);const m=e.clone(),_=this._extendCameraOptions(h),v=m.padding;m.bearing=l,m.pitch=u;const x=Xr.convert(i),w=Xr.convert(o),C=new Xr(x.lng,w.lat),k=new Xr(w.lng,x.lat),P=m.project(x),R=m.project(w),z=this.queryTerrainElevation(x),B=this.queryTerrainElevation(w),H=this.queryTerrainElevation(C),Z=this.queryTerrainElevation(k),Y=[[P.x,P.y,Math.min(z||0,B||0,H||0,Z||0)],[R.x,R.y,Math.max(z||0,B||0,H||0,Z||0)]];let q=Oi.fromPoints(Y);const ee=m.getWorldToCameraMatrix(),ce=dt.invert(new Float64Array(16),ee);q=Oi.applyTransform(q,ee);const de=We.sub([],q.max,q.min),ge=v.left||0,ve=v.right||0,Re=v.bottom||0,ke=v.top||0,{left:$e,right:Ie,top:Qe,bottom:st}=_.padding,ft=.5*(ge+ve),Je=.5*(ke+Re),tt=Math.min(m.scaleZoom(m.scale*Math.min((m.width-(ge+ve+$e+Ie))/de[0],(m.height-(Re+ke+st+Qe))/de[1])),_.maxZoom),pt=m.scale/m.zoomScale(tt);q=new Oi([q.min[0]-($e+ft)*pt,q.min[1]-(st+Je)*pt,q.min[2]],[q.max[0]+(Ie+ft)*pt,q.max[1]+(Qe+Je)*pt,q.max[2]]);const bt=.5*de[2],St=this._minimumAABBFrustumDistance(m,q),Pt=[0,0,1,0];li.transformMat4(Pt,Pt,ee),li.normalize(Pt,Pt);const Ut=We.scale([],Pt,St+bt),Tt=We.add([],q.center,Ut),Mt=(typeof _.offset.x=="number"&&typeof _.offset.y=="number"?new D(_.offset.x,_.offset.y):D.convert(_.offset)).rotate(-le(l));q.center[0]-=Mt.x*pt,q.center[1]+=Mt.y*pt,We.transformMat4(q.center,q.center,ce),We.transformMat4(Tt,Tt,ce);const tr=[q.center[0],q.center[1],Tt[2]*m.pixelsPerMeter];We.scale(tr,tr,1/m.worldSize);const ur=Ss(tr[0]),cr=ka(tr[1]),hr=Math.min(m._zoomFromMercatorZ(tr[2]),_.maxZoom),Mr=new Xr(ur,cr);return m.mercatorFromTransition&&hr<.5*(eg+zf)?(m.setProjection({name:"globe"}),m.zoom=hr,this._cameraForBounds(m,i,o,l,u,h)):{center:Mr,zoom:hr,bearing:l,pitch:u}}fitBounds(e,i,o){const l=this.cameraForBounds(e,i);return this._fitInternal(l,i,o)}fitScreenCoordinates(e,i,o,l,u){const h=D.convert(e),m=D.convert(i),_=new D(Math.min(h.x,m.x),Math.min(h.y,m.y)),v=new D(Math.max(h.x,m.x),Math.max(h.y,m.y));if(this.transform.projection.name==="mercator"&&this.transform.anyCornerOffEdge(h,m))return this;const x=this.transform.pointLocation3D(_),w=this.transform.pointLocation3D(v),C=this.transform.pointLocation3D(new D(_.x,v.y)),k=this.transform.pointLocation3D(new D(v.x,_.y)),P=[Math.min(x.lng,w.lng,C.lng,k.lng),Math.min(x.lat,w.lat,C.lat,k.lat)],R=[Math.max(x.lng,w.lng,C.lng,k.lng),Math.max(x.lat,w.lat,C.lat,k.lat)],z=l&&l.pitch?l.pitch:this.getPitch(),B=this._cameraForBounds(this.transform,P,R,o,z,l);return this._fitInternal(B,l,u)}_fitInternal(e,i,o){return e?(delete(i=ze(e,i)).padding,i.linear?this.easeTo(i,o):this.flyTo(i,o)):this}jumpTo(e,i){this.stop();const o=e.preloadOnly?this.transform.clone():this.transform;let l=!1,u=!1,h=!1;return"zoom"in e&&o.zoom!==+e.zoom&&(l=!0,o.zoom=+e.zoom),e.center!==void 0&&(o.center=Xr.convert(e.center)),"bearing"in e&&o.bearing!==+e.bearing&&(u=!0,o.bearing=+e.bearing),"pitch"in e&&o.pitch!==+e.pitch&&(h=!0,o.pitch=+e.pitch),e.padding==null||o.isPaddingEqual(e.padding)||(o.padding=e.padding),e.preloadOnly?(this._preloadTiles(o),this):(this.fire(new _t("movestart",i)).fire(new _t("move",i)),l&&this.fire(new _t("zoomstart",i)).fire(new _t("zoom",i)).fire(new _t("zoomend",i)),u&&this.fire(new _t("rotatestart",i)).fire(new _t("rotate",i)).fire(new _t("rotateend",i)),h&&this.fire(new _t("pitchstart",i)).fire(new _t("pitch",i)).fire(new _t("pitchend",i)),this.fire(new _t("moveend",i)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||se(hR),this.transform.getFreeCameraOptions()}setFreeCameraOptions(e,i){const o=this.transform;if(!o.projection.supportsFreeCamera)return se(hR),this;this.stop();const l=o.zoom,u=o.pitch,h=o.bearing;o.setFreeCameraOptions(e);const m=l!==o.zoom,_=u!==o.pitch,v=h!==o.bearing;return this.fire(new _t("movestart",i)).fire(new _t("move",i)),m&&this.fire(new _t("zoomstart",i)).fire(new _t("zoom",i)).fire(new _t("zoomend",i)),v&&this.fire(new _t("rotatestart",i)).fire(new _t("rotate",i)).fire(new _t("rotateend",i)),_&&this.fire(new _t("pitchstart",i)).fire(new _t("pitch",i)).fire(new _t("pitchend",i)),this.fire(new _t("moveend",i)),this}easeTo(e,i){this._stop(!1,e.easeId),((e=ze({offset:[0,0],duration:500,easing:He},e)).animate===!1||this._prefersReducedMotion(e))&&(e.duration=0);const o=this.transform,l=this.getZoom(),u=this.getBearing(),h=this.getPitch(),m=this.getPadding(),_="zoom"in e?+e.zoom:l,v="bearing"in e?this._normalizeBearing(e.bearing,u):u,x="pitch"in e?+e.pitch:h,w="padding"in e?e.padding:o.padding,C=D.convert(e.offset);let k,P,R;if(o.projection.name==="globe"){const ge=Pn.fromLngLat(o.center),ve=C.rotate(-o.angle);ge.x+=ve.x/o.worldSize,ge.y+=ve.y/o.worldSize;const Re=ge.toLngLat(),ke=Xr.convert(e.center||Re);this._normalizeCenter(ke),k=o.centerPoint.add(ve),P=new D(ge.x,ge.y).mult(o.worldSize),R=new D(Xa(ke.lng),oo(ke.lat)).mult(o.worldSize).sub(P)}else{k=o.centerPoint.add(C);const ge=o.pointLocation(k),ve=Xr.convert(e.center||ge);this._normalizeCenter(ve),P=o.project(ge),R=o.project(ve).sub(P)}const z=o.zoomScale(_-l);let B,H;e.around&&(B=Xr.convert(e.around),H=o.locationPoint(B));const Z=this._zooming||_!==l,Y=this._rotating||u!==v,q=this._pitching||x!==h,ee=!o.isPaddingEqual(w),ce=ge=>ve=>{if(Z&&(ge.zoom=$r(l,_,ve)),Y&&(ge.bearing=$r(u,v,ve)),q&&(ge.pitch=$r(h,x,ve)),ee&&(ge.interpolatePadding(m,w,ve),k=ge.centerPoint.add(C)),B)ge.setLocationAtPoint(B,H);else{const Re=ge.zoomScale(ge.zoom-l),ke=_>l?Math.min(2,z):Math.max(.5,z),$e=Math.pow(ke,1-ve),Ie=ge.unproject(P.add(R.mult(ve*$e)).mult(Re));ge.setLocationAtPoint(ge.renderWorldCopies?Ie.wrap():Ie,k)}return e.preloadOnly||this._fireMoveEvents(i),ge};if(e.preloadOnly){const ge=this._emulate(ce,e.duration,o);return this._preloadTiles(ge),this}const de={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=Z,this._rotating=Y,this._pitching=q,this._padding=ee,this._easeId=e.easeId,this._prepareEase(i,e.noMoveStart,de),this._ease(ce(o),ge=>{o.cameraElevationReference==="sea"&&o.recenterOnTerrain(),this._afterEase(i,ge)},e),this}_prepareEase(e,i,o={}){this._moving=!0,this.transform.cameraElevationReference="sea",this.transform._orthographicProjectionAtLowPitch&&this.transform.pitch===0&&this.transform.projection.name!=="globe"&&(this.transform.cameraElevationReference="ground"),i||o.moving||this.fire(new _t("movestart",e)),this._zooming&&!o.zooming&&this.fire(new _t("zoomstart",e)),this._rotating&&!o.rotating&&this.fire(new _t("rotatestart",e)),this._pitching&&!o.pitching&&this.fire(new _t("pitchstart",e))}_fireMoveEvents(e){this.fire(new _t("move",e)),this._zooming&&this.fire(new _t("zoom",e)),this._rotating&&this.fire(new _t("rotate",e)),this._pitching&&this.fire(new _t("pitch",e))}_afterEase(e,i){if(this._easeId&&i&&this._easeId===i)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const o=this._zooming,l=this._rotating,u=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,o&&this.fire(new _t("zoomend",e)),l&&this.fire(new _t("rotateend",e)),u&&this.fire(new _t("pitchend",e)),this.fire(new _t("moveend",e))}flyTo(e,i){if(this._prefersReducedMotion(e)){const tt=oe(e,["center","zoom","bearing","pitch","around"]);return this.jumpTo(tt,i)}this.stop(),e=ze({offset:[0,0],speed:1.2,curve:1.42,easing:He},e);const o=this.transform,l=this.getZoom(),u=this.getBearing(),h=this.getPitch(),m=this.getPadding(),_="zoom"in e?Oe(+e.zoom,o.minZoom,o.maxZoom):l,v="bearing"in e?this._normalizeBearing(e.bearing,u):u,x="pitch"in e?+e.pitch:h,w="padding"in e?e.padding:o.padding,C=o.zoomScale(_-l),k=D.convert(e.offset);let P=o.centerPoint.add(k);const R=o.pointLocation(P),z=Xr.convert(e.center||R);this._normalizeCenter(z);const B=o.project(R),H=o.project(z).sub(B);let Z=e.curve;const Y=Math.max(o.width,o.height),q=Y/C,ee=H.mag();if("minZoom"in e){const tt=Oe(Math.min(e.minZoom,l,_),o.minZoom,o.maxZoom),pt=Y/o.zoomScale(tt-l);Z=Math.sqrt(pt/ee*2)}const ce=Z*Z;function de(tt){const pt=(q*q-Y*Y+(tt?-1:1)*ce*ce*ee*ee)/(2*(tt?q:Y)*ce*ee);return Math.log(Math.sqrt(pt*pt+1)-pt)}function ge(tt){return(Math.exp(tt)-Math.exp(-tt))/2}function ve(tt){return(Math.exp(tt)+Math.exp(-tt))/2}const Re=de(0);let ke=function(tt){return ve(Re)/ve(Re+Z*tt)},$e=function(tt){return Y*((ve(Re)*(ge(pt=Re+Z*tt)/ve(pt))-ge(Re))/ce)/ee;var pt},Ie=(de(1)-Re)/Z;if(Math.abs(ee)<1e-6||!isFinite(Ie)){if(Math.abs(Y-q)<1e-6)return this.easeTo(e,i);const tt=q<Y?-1:1;Ie=Math.abs(Math.log(q/Y))/Z,$e=function(){return 0},ke=function(pt){return Math.exp(tt*Z*pt)}}e.duration="duration"in e?+e.duration:1e3*Ie/("screenSpeed"in e?+e.screenSpeed/Z:+e.speed),e.maxDuration&&e.duration>e.maxDuration&&(e.duration=0);const Qe=u!==v,st=x!==h,ft=!o.isPaddingEqual(w),Je=tt=>pt=>{const bt=pt*Ie,St=1/ke(bt);tt.zoom=pt===1?_:l+tt.scaleZoom(St),Qe&&(tt.bearing=$r(u,v,pt)),st&&(tt.pitch=$r(h,x,pt)),ft&&(tt.interpolatePadding(m,w,pt),P=tt.centerPoint.add(k));const Pt=pt===1?z:tt.unproject(B.add(H.mult($e(bt))).mult(St));return tt.setLocationAtPoint(tt.renderWorldCopies?Pt.wrap():Pt,P),tt._updateCameraOnTerrain(),e.preloadOnly||this._fireMoveEvents(i),tt};if(e.preloadOnly){const tt=this._emulate(Je,e.duration,o);return this._preloadTiles(tt),this}return this._zooming=!0,this._rotating=Qe,this._pitching=st,this._padding=ft,this._prepareEase(i,!1),this._ease(Je(o),()=>this._afterEase(i),e),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(e,i){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const o=this._onEaseEnd;this._onEaseEnd=void 0,o.call(this,i)}if(!e){const o=this.handlers;o&&o.stop(!1)}return this}_ease(e,i,o){o.animate===!1||o.duration===0?(e(1),i()):(this._easeStart=Jr.now(),this._easeOptions=o,this._onEaseFrame=e,this._onEaseEnd=i,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const e=Math.min((Jr.now()-this._easeStart)/this._easeOptions.duration,1),i=this._onEaseFrame;i&&i(this._easeOptions.easing(e)),e<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(e,i){e=rt(e,-180,180);const o=Math.abs(e-i);return Math.abs(e-360-i)<o&&(e-=360),Math.abs(e+360-i)<o&&(e+=360),e}_normalizeCenter(e){const i=this.transform;if(!i.renderWorldCopies||i.maxBounds)return;const o=e.lng-i.center.lng;e.lng+=o>180?-360:o<-180?360:0}_prefersReducedMotion(e){return this._respectPrefersReducedMotion&&Jr.prefersReducedMotion&&!(e&&e.essential)}_emulate(e,i,o){const l=Math.ceil(15*i/1e3),u=[],h=e(o.clone());for(let m=0;m<=l;m++){const _=h(m/l);u.push(_.clone())}return u}}class dR{constructor(e={}){this.options=e,ae(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(e){const i=this.options&&this.options.compact;return this._map=e,this._container=pi("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=pi("button","mapboxgl-ctrl-attrib-button",this._container),pi("span","mapboxgl-ctrl-icon",this._compactButton).setAttribute("aria-hidden","true"),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=pi("div","mapboxgl-ctrl-attrib-inner",this._container),i&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),i===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_setElementTitle(e,i){const o=this._map._getUIString(`AttributionControl.${i}`);e.setAttribute("aria-label",o),e.removeAttribute("title"),e.firstElementChild&&e.firstElementChild.setAttribute("title",o)}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let e=this._editLink;e||(e=this._editLink=this._container.querySelector(".mapbox-improve-map"));const i=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||E.ACCESS_TOKEN}];if(e){const o=i.reduce((l,u,h)=>(u.value&&(l+=`${u.key}=${u.value}${h<i.length-1?"&":""}`),l),"?");e.href=`${E.FEEDBACK_URL}/${o}#${oR(this._map,!0)}`,e.rel="noopener nofollow",this._setElementTitle(e,"MapFeedback")}}_updateData(e){!e||e.sourceDataType!=="metadata"&&e.sourceDataType!=="visibility"&&e.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let e=[];if(this._map.style.stylesheet){const l=this._map.style.stylesheet;this.styleOwner=l.owner,this.styleId=l.id}const i=this._map.style._sourceCaches;for(const l in i){const u=i[l];if(u.used){const h=u.getSource();h.attribution&&e.indexOf(h.attribution)<0&&e.push(h.attribution)}}e.sort((l,u)=>l.length-u.length),e=e.filter((l,u)=>{for(let h=u+1;h<e.length;h++)if(e[h].indexOf(l)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?e=[...this.options.customAttribution,...e]:e.unshift(this.options.customAttribution));const o=e.join(" | ");o!==this._attribHTML&&(this._attribHTML=o,e.length?(this._innerContainer.innerHTML=o,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class pR{constructor(){ae(["_updateLogo","_updateCompact"],this)}onAdd(e){this._map=e,this._container=pi("div","mapboxgl-ctrl");const i=pi("a","mapboxgl-ctrl-logo");return i.target="_blank",i.rel="noopener nofollow",i.href="https://www.mapbox.com/",i.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),i.setAttribute("rel","noopener nofollow"),this._container.appendChild(i),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(e){e&&e.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const e=this._map.style._sourceCaches;if(Object.entries(e).length===0)return!0;for(const i in e){const o=e[i].getSource();if(o.hasOwnProperty("mapbox_logo")&&!o.mapbox_logo)return!1}return!0}_updateCompact(){const e=this._container.children;if(e.length){const i=e[0];this._map.getCanvasContainer().offsetWidth<250?i.classList.add("mapboxgl-compact"):i.classList.remove("mapboxgl-compact")}}}class mR{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(e){const i=++this._id;return this._queue.push({callback:e,id:i,cancelled:!1}),i}remove(e){const i=this._currentlyRunning,o=i?this._queue.concat(i):this._queue;for(const l of o)if(l.id===e)return void(l.cancelled=!0)}run(e=0){const i=this._currentlyRunning=this._queue;this._queue=[];for(const o of i)if(!o.cancelled&&(o.callback(e),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function gR(r,e,i){if(r=new Xr(r.lng,r.lat),e){const o=new Xr(r.lng-360,r.lat),l=new Xr(r.lng+360,r.lat),u=360*Math.ceil(Math.abs(r.lng-i.center.lng)/360),h=i.locationPoint(r).distSqr(e),m=e.x<0||e.y<0||e.x>i.width||e.y>i.height;i.locationPoint(o).distSqr(e)<h&&(m||Math.abs(o.lng-i.center.lng)<u)?r=o:i.locationPoint(l).distSqr(e)<h&&(m||Math.abs(l.lng-i.center.lng)<u)&&(r=l)}for(;Math.abs(r.lng-i.center.lng)>180;){const o=i.locationPoint(r);if(o.x>=0&&o.y>=0&&o.x<=i.width&&o.y<=i.height)break;r.lng>i.center.lng?r.lng-=360:r.lng+=360}return r}const PT={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class OT extends Ln{constructor(e,i){if(super(),(e instanceof g.HTMLElement||i)&&(e=ze({element:e},i)),ae(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=e&&e.anchor||"center",this._color=e&&e.color||"#3FB1CE",this._scale=e&&e.scale||1,this._draggable=e&&e.draggable||!1,this._clickTolerance=e&&e.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=e&&e.rotation||0,this._rotationAlignment=e&&e.rotationAlignment||"auto",this._pitchAlignment=e&&e.pitchAlignment&&e.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),this._occludedOpacity=e&&e.occludedOpacity||.2,e&&e.element)this._element=e.element,this._offset=D.convert(e&&e.offset||[0,0]);else{this._defaultMarker=!0,this._element=pi("div");const u=41,h=27,m=Nl("svg",{display:"block",height:u*this._scale+"px",width:h*this._scale+"px",viewBox:`0 0 ${h} ${u}`},this._element),_=Nl("radialGradient",{id:"shadowGradient"},Nl("defs",{},m));Nl("stop",{offset:"10%","stop-opacity":.4},_),Nl("stop",{offset:"100%","stop-opacity":.05},_),Nl("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},m),Nl("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},m),Nl("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},m),Nl("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},m),this._offset=D.convert(e&&e.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.hasAttribute("role")||this._element.setAttribute("role","img"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",u=>{u.preventDefault()}),this._element.addEventListener("mousedown",u=>{u.preventDefault()});const o=this._element.classList;for(const u in PT)o.remove(`mapboxgl-marker-anchor-${u}`);o.add(`mapboxgl-marker-anchor-${this._anchor}`);const l=e&&e.className?e.className.trim().split(/\s+/):[];o.add(...l),this._popup=null}addTo(e){return e===this._map||(this.remove(),this._map=e,e.getCanvasContainer().appendChild(this._element),e.on("move",this._updateMoving),e.on("moveend",this._update),e.on("remove",this._clearFadeTimer),e._addMarker(this),this.setDraggable(this._draggable),this._update(),e.on("click",this._onMapClick)),this}remove(){const e=this._map;return e&&(e.off("click",this._onMapClick),e.off("move",this._updateMoving),e.off("moveend",this._update),e.off("mousedown",this._addDragHandler),e.off("touchstart",this._addDragHandler),e.off("mouseup",this._onUp),e.off("touchend",this._onUp),e.off("mousemove",this._onMove),e.off("touchmove",this._onMove),e.off("remove",this._clearFadeTimer),e._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(e){return this._lngLat=Xr.convert(e),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(e){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),e){if(!("offset"in e.options)){const l=Math.sqrt(Math.pow(13.5,2)/2);e.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[l,-1*(38.1-13.5+l)],"bottom-right":[-l,-1*(38.1-13.5+l)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=e,e._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(e){const i=e.code,o=e.charCode||e.keyCode;i!=="Space"&&i!=="Enter"&&o!==32&&o!==13||this.togglePopup()}_onMapClick(e){const i=e.originalEvent.target,o=this._element;this._popup&&(i===o||o.contains(i))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const e=this._popup;return e?(e.isOpen()?(e.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(e.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const e=this._map,i=this._pos;if(!e||!i)return!1;const o=e.unproject(i),l=e.getFreeCameraOptions();if(!l.position)return!1;const u=l.position.toLngLat();return u.distanceTo(o)<.9*u.distanceTo(this._lngLat)}_evaluateOpacity(){const e=this._map;if(!e)return;const i=this._pos;if(!i||i.x<0||i.x>e.transform.width||i.y<0||i.y>e.transform.height)return void this._clearFadeTimer();const o=e.unproject(i);let l;e._showingGlobe()&&v1(e.transform,this._lngLat)?l=0:(l=1-e._queryFogOpacity(o),e.transform._terrainEnabled()&&e.getTerrain()&&this._behindTerrain()&&(l*=this._occludedOpacity)),this._element.style.opacity=`${l}`,this._element.style.pointerEvents=l>0?"auto":"none",this._popup&&this._popup._setOpacity(l),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const e=this._pos;if(!e||!this._map)return;const i=this._offset.mult(this._scale);this._element.style.transform=`
            translate(${e.x}px,${e.y}px)
            ${PT[this._anchor]}
            ${this._calculateXYTransform()} ${this._calculateZTransform()}
            translate(${i.x}px,${i.y}px)
        `}_calculateXYTransform(){const e=this._pos,i=this._map,o=this.getPitchAlignment();if(!i||!e||o!=="map")return"";if(!i._showingGlobe()){const _=i.getPitch();return _?`rotateX(${_}deg)`:""}const l=re(nM(i.transform,this._lngLat)),u=e.sub(rM(i.transform)),h=Math.abs(u.x)+Math.abs(u.y);if(h===0)return"";const m=l/h;return`rotateX(${-u.y*m}deg) rotateY(${u.x*m}deg)`}_calculateZTransform(){const e=this._pos,i=this._map;if(!i||!e)return"";let o=0;const l=this.getRotationAlignment();if(l==="map")if(i._showingGlobe()){const u=i.project(new Xr(this._lngLat.lng,this._lngLat.lat+.001)),h=i.project(new Xr(this._lngLat.lng,this._lngLat.lat-.001)).sub(u);o=re(Math.atan2(h.y,h.x))-90}else o=-i.getBearing();else if(l==="horizon"){const u=Pe(4,6,i.getZoom()),h=rM(i.transform);h.y+=u*i.transform.height;const m=e.sub(h),_=re(Math.atan2(m.y,m.x));o=(_>90?_-270:_+90)*(1-u)}return o+=this._rotation,o?`rotateZ(${o}deg)`:""}_update(e){g.cancelAnimationFrame(this._updateFrameId);const i=this._map;i&&(i.transform.renderWorldCopies&&(this._lngLat=gR(this._lngLat,this._pos,i.transform)),this._pos=i.project(this._lngLat),e===!0?this._updateFrameId=g.requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),i._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(i._showingGlobe()||i.getTerrain()||i.getFog())&&!this._fadeTimer&&(this._fadeTimer=setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(e){return this._offset=D.convert(e),this._update(),this}addClassName(e){return this._element.classList.add(e),this}removeClassName(e){return this._element.classList.remove(e),this}toggleClassName(e){return this._element.classList.toggle(e)}_onMove(e){const i=this._map;if(!i)return;const o=this._pointerdownPos,l=this._positionDelta;if(o&&l){if(!this._isDragging){const u=this._clickTolerance||i._clickTolerance;if(e.point.dist(o)<u)return;this._isDragging=!0}this._pos=e.point.sub(l),this._lngLat=i.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new _t("dragstart"))),this.fire(new _t("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const e=this._map;e&&(e.off("mousemove",this._onMove),e.off("touchmove",this._onMove)),this._state==="active"&&this.fire(new _t("dragend")),this._state="inactive"}_addDragHandler(e){const i=this._map,o=this._pos;i&&o&&this._element.contains(e.originalEvent.target)&&(e.preventDefault(),this._positionDelta=e.point.sub(o),this._pointerdownPos=e.point,this._state="pending",i.on("mousemove",this._onMove),i.on("touchmove",this._onMove),i.once("mouseup",this._onUp),i.once("touchend",this._onUp))}setDraggable(e){this._draggable=!!e;const i=this._map;return i&&(e?(i.on("mousedown",this._addDragHandler),i.on("touchstart",this._addDragHandler)):(i.off("mousedown",this._addDragHandler),i.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(e){return this._rotation=e||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(e){return this._rotationAlignment=e||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment==="auto"||this._rotationAlignment==="horizon"&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(e){return this._pitchAlignment=e||"auto",this._update(),this}getPitchAlignment(){return this._pitchAlignment==="auto"?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(e){return this._occludedOpacity=e||.2,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const QX={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},eZ=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function _R(r=new D(0,0),e="bottom"){if(typeof r=="number"){const i=Math.round(Math.sqrt(.5*Math.pow(r,2)));switch(e){case"top":return new D(0,r);case"top-left":return new D(i,i);case"top-right":return new D(-i,i);case"bottom":return new D(0,-r);case"bottom-left":return new D(i,-i);case"bottom-right":return new D(-i,-i);case"left":return new D(r,0);case"right":return new D(-r,0)}return new D(0,0)}return r instanceof D||Array.isArray(r)?D.convert(r):D.convert(r[e]||[0,0])}class tZ{constructor(e){this.jumpTo(e)}getValue(e){if(e<=this._startTime)return this._start;if(e>=this._endTime)return this._end;const i=Ye((e-this._startTime)/(this._endTime-this._startTime));return this._start*(1-i)+this._end*i}isEasing(e){return e>=this._startTime&&e<=this._endTime}jumpTo(e){this._startTime=-1/0,this._endTime=-1/0,this._start=e,this._end=e}easeTo(e,i,o){this._start=this.getValue(i),this._end=e,this._startTime=i,this._endTime=i+o}}const rZ={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use ⌘ + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"},nZ={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,antialias:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,respectPrefersReducedMotion:!0,crossSourceCollisions:!0,collectResourceTiming:!1,testMode:!1},iZ={showCompass:!0,showZoom:!0,visualizePitch:!1};class aZ{constructor(e,i,o=!1){this._clickTolerance=10,this.element=i,this.mouseRotate=new sR({clickTolerance:e.dragRotate._mouseRotate._clickTolerance}),this.map=e,o&&(this.mousePitch=new lR({clickTolerance:e.dragRotate._mousePitch._clickTolerance})),ae(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),i.addEventListener("mousedown",this.mousedown),i.addEventListener("touchstart",this.touchstart,{passive:!1}),i.addEventListener("touchmove",this.touchmove),i.addEventListener("touchend",this.touchend),i.addEventListener("touchcancel",this.reset)}down(e,i){this.mouseRotate.mousedown(e,i),this.mousePitch&&this.mousePitch.mousedown(e,i),ne()}move(e,i){const o=this.map,l=this.mouseRotate.mousemoveWindow(e,i),u=l&&l.bearingDelta;if(u&&o.setBearing(o.getBearing()+u),this.mousePitch){const h=this.mousePitch.mousemoveWindow(e,i),m=h&&h.pitchDelta;m&&o.setPitch(o.getPitch()+m)}}off(){const e=this.element;e.removeEventListener("mousedown",this.mousedown),e.removeEventListener("touchstart",this.touchstart,{passive:!1}),e.removeEventListener("touchmove",this.touchmove),e.removeEventListener("touchend",this.touchend),e.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){Te(),g.removeEventListener("mousemove",this.mousemove),g.removeEventListener("mouseup",this.mouseup)}mousedown(e){this.down(ze({},e,{ctrlKey:!0,preventDefault:()=>e.preventDefault()}),vt(this.element,e)),g.addEventListener("mousemove",this.mousemove),g.addEventListener("mouseup",this.mouseup)}mousemove(e){this.move(e,vt(this.element,e))}mouseup(e){this.mouseRotate.mouseupWindow(e),this.mousePitch&&this.mousePitch.mouseupWindow(e),this.offTemp()}touchstart(e){e.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=wt(this.element,e.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>e.preventDefault()},this._startPos))}touchmove(e){e.targetTouches.length!==1?this.reset():(this._lastPos=wt(this.element,e.targetTouches)[0],this.move({preventDefault:()=>e.preventDefault()},this._lastPos))}touchend(e){e.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}const oZ={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},sZ={maxWidth:100,unit:"metric"},lZ={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"},Ry={version:y,supported:km,setRTLTextPlugin:function(r,e,i=!1){if(ws===l2||ws===c2||ws===u2)throw new Error("setRTLTextPlugin cannot be called multiple times.");If=Jr.resolveURL(r),ws=l2,f2=e,h2(),i||s4()},getRTLTextPluginStatus:p2,Map:class extends JX{constructor(r){if(no.mark(ro.create),(r=ze({},nZ,r)).minZoom!=null&&r.maxZoom!=null&&r.minZoom>r.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(r.minPitch!=null&&r.maxPitch!=null&&r.minPitch>r.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(r.minPitch!=null&&r.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(r.maxPitch!=null&&r.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(r.antialias&&function(e){const i=e.navigator?e.navigator.userAgent:null;return!!function(o){if(ct==null){const l=o.navigator?o.navigator.userAgent:null;ct=!!o.safari||!(!l||!(/\b(iPad|iPhone|iPod)\b/.test(l)||l.match("Safari")&&!l.match("Chrome")))}return ct}(e)&&i&&(i.match("Version/15.4")||i.match("Version/15.5")||i.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))}(g)&&(r.antialias=!1,se("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new qE(r.minZoom,r.maxZoom,r.minPitch,r.maxPitch,r.renderWorldCopies),r),this._interactive=r.interactive,this._minTileCacheSize=r.minTileCacheSize,this._maxTileCacheSize=r.maxTileCacheSize,this._failIfMajorPerformanceCaveat=r.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=r.preserveDrawingBuffer,this._antialias=r.antialias,this._trackResize=r.trackResize,this._bearingSnap=r.bearingSnap,this._refreshExpiredTiles=r.refreshExpiredTiles,this._fadeDuration=r.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=r.crossSourceCollisions,this._collectResourceTiming=r.collectResourceTiming,this._language=this._parseLanguage(r.language),this._worldview=r.worldview,this._renderTaskQueue=new mR,this._domRenderTaskQueue=new mR,this._controls=[],this._markers=[],this._popups=[],this._mapId=fe(),this._locale=ze({},rZ,r.locale),this._clickTolerance=r.clickTolerance,this._cooperativeGestures=r.cooperativeGestures,this._performanceMetricsCollection=r.performanceMetricsCollection,this._containerWidth=0,this._containerHeight=0,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new tZ(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._requestManager=new Cr(r.transformRequest,r.accessToken,r.testMode),this._silenceAuthErrors=!!r.testMode,typeof r.container=="string"){if(this._container=g.document.getElementById(r.container),!this._container)throw new Error(`Container '${r.container.toString()}' not found.`)}else{if(!(r.container instanceof g.HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=r.container}if(this._container.childNodes.length>0&&se("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),r.maxBounds&&this.setMaxBounds(r.maxBounds),ae(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");if(this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),g!==void 0&&(this._fullscreenchangeEvent="onfullscreenchange"in g.document?"fullscreenchange":"webkitfullscreenchange",g.addEventListener("online",this._onWindowOnline,!1),g.addEventListener("resize",this._onWindowResize,!1),g.addEventListener("orientationchange",this._onWindowResize,!1),g.addEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),g.addEventListener("visibilitychange",this._onVisibilityChange,!1)),this.handlers=new YX(this,r),this._localFontFamily=r.localFontFamily,this._localIdeographFontFamily=r.localIdeographFontFamily,(r.style||!r.testMode)&&this.setStyle(r.style||E.DEFAULT_STYLE,{localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),r.projection&&this.setProjection(r.projection),r.hash&&(this._hash=new bX(typeof r.hash=="string"&&r.hash||void 0).addTo(this)),!this._hash||!this._hash._onHashChange()){this.jumpTo({center:r.center,zoom:r.zoom,bearing:r.bearing,pitch:r.pitch});const e=r.bounds;e&&(this.resize(),this.fitBounds(e,ze({},r.fitBoundsOptions,{duration:0})))}this.resize(),r.attributionControl&&this.addControl(new dR({customAttribution:r.customAttribution})),this._logoControl=new pR,this.addControl(this._logoControl,r.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",e=>{this._update(e.dataType==="style"),this.fire(new _t(`${e.dataType}data`,e))}),this.on("dataloading",e=>{this.fire(new _t(`${e.dataType}dataloading`,e))})}_getMapId(){return this._mapId}addControl(r,e){if(e===void 0&&(e=r.getDefaultPosition?r.getDefaultPosition():"top-right"),!r||!r.onAdd)return this.fire(new ar(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const i=r.onAdd(this);this._controls.push(r);const o=this._controlPositions[e];return e.indexOf("bottom")!==-1?o.insertBefore(i,o.firstChild):o.appendChild(i),this}removeControl(r){if(!r||!r.onRemove)return this.fire(new ar(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const e=this._controls.indexOf(r);return e>-1&&this._controls.splice(e,1),r.onRemove(this),this}hasControl(r){return this._controls.indexOf(r)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(r){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const e=!this._moving;return e&&this.fire(new _t("movestart",r)).fire(new _t("move",r)),this.fire(new _t("resize",r)),e&&this.fire(new _t("moveend",r)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(r){return this.transform.setMaxBounds(Ks.convert(r)),this._update()}setMinZoom(r){if((r=r??-2)>=-2&&r<=this.transform.maxZoom)return this.transform.minZoom=r,this._update(),this.getZoom()<r?this.setZoom(r):this.fire(new _t("zoomstart")).fire(new _t("zoom")).fire(new _t("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(r){if((r=r??22)>=this.transform.minZoom)return this.transform.maxZoom=r,this._update(),this.getZoom()>r?this.setZoom(r):this.fire(new _t("zoomstart")).fire(new _t("zoom")).fire(new _t("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(r){if((r=r??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(r>=0&&r<=this.transform.maxPitch)return this.transform.minPitch=r,this._update(),this.getPitch()<r?this.setPitch(r):this.fire(new _t("pitchstart")).fire(new _t("pitch")).fire(new _t("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(r){if((r=r??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(r>=this.transform.minPitch)return this.transform.maxPitch=r,this._update(),this.getPitch()>r?this.setPitch(r):this.fire(new _t("pitchstart")).fire(new _t("pitch")).fire(new _t("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(r){return this.transform.renderWorldCopies=r,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(r){return r==="auto"?g.navigator.language:Array.isArray(r)?r.length===0?void 0:r.map(e=>e==="auto"?g.navigator.language:e):r}setLanguage(r){const e=this._parseLanguage(r);if(!this.style||e===this._language)return this;this._language=e,this.style.clearSources();for(const i of this._controls)i._setLanguage&&i._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(r){return this.style&&r!==this._worldview?(this._worldview=r,this.style.clearSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return this.transform.projection.name==="globe"}setProjection(r){return this._lazyInitEmptyStyle(),r?typeof r=="string"&&(r={name:r}):r=null,this._useExplicitProjection=!!r,this._prioritizeAndUpdateProjection(r,this.style.projection)}_updateProjectionTransition(){if(this.getProjection().name!=="globe")return;const r=this.transform,e=r.projection.name;let i;e==="globe"&&r.zoom>=zf?(r.setMercatorFromTransition(),i=!0):e==="mercator"&&r.zoom<zf&&(r.setProjection({name:"globe"}),i=!0),i&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(r,e){return this._updateProjection(r||e||{name:"mercator"})}_updateProjection(r){let e;return e=r.name==="globe"&&this.transform.zoom>=zf?this.transform.setMercatorFromTransition():this.transform.setProjection(r),this.style.applyProjectionUpdate(),e&&(this.painter.clearBackgroundTiles(),this.style.clearSources(),this._update(!0),this._forceMarkerAndPopupUpdate(!0)),this}project(r){return this.transform.locationPoint3D(Xr.convert(r))}unproject(r){return this.transform.pointLocation3D(D.convert(r))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(r,e,i){if(r==="mouseenter"||r==="mouseover"){let o=!1;const l=h=>{const m=e.filter(v=>this.getLayer(v)),_=m.length?this.queryRenderedFeatures(h.point,{layers:m}):[];_.length?o||(o=!0,i.call(this,new Qs(r,this,h.originalEvent,{features:_}))):o=!1},u=()=>{o=!1};return{layers:new Set(e),listener:i,delegates:{mousemove:l,mouseout:u}}}if(r==="mouseleave"||r==="mouseout"){let o=!1;const l=h=>{const m=e.filter(_=>this.getLayer(_));(m.length?this.queryRenderedFeatures(h.point,{layers:m}):[]).length?o=!0:o&&(o=!1,i.call(this,new Qs(r,this,h.originalEvent)))},u=h=>{o&&(o=!1,i.call(this,new Qs(r,this,h.originalEvent)))};return{layers:new Set(e),listener:i,delegates:{mousemove:l,mouseout:u}}}{const o=l=>{const u=e.filter(m=>this.getLayer(m)),h=u.length?this.queryRenderedFeatures(l.point,{layers:u}):[];h.length&&(l.features=h,i.call(this,l),delete l.features)};return{layers:new Set(e),listener:i,delegates:{[r]:o}}}}on(r,e,i){if(i===void 0)return super.on(r,e);if(Array.isArray(e)||(e=[e]),e){for(const l of e)if(!this._isValidId(l))return this}const o=this._createDelegatedListener(r,e,i);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[r]=this._delegatedListeners[r]||[],this._delegatedListeners[r].push(o);for(const l in o.delegates)this.on(l,o.delegates[l]);return this}once(r,e,i){if(i===void 0)return super.once(r,e);if(Array.isArray(e)||(e=[e]),e){for(const l of e)if(!this._isValidId(l))return this}const o=this._createDelegatedListener(r,e,i);for(const l in o.delegates)this.once(l,o.delegates[l]);return this}off(r,e,i){if(i===void 0)return super.off(r,e);e=new Set(Array.isArray(e)?e:[e]);for(const u of e)if(!this._isValidId(u))return this;const o=(u,h)=>{if(u.size!==h.size)return!1;for(const m of u)if(!h.has(m))return!1;return!0},l=this._delegatedListeners?this._delegatedListeners[r]:void 0;return l&&(u=>{for(let h=0;h<u.length;h++){const m=u[h];if(m.listener===i&&o(m.layers,e)){for(const _ in m.delegates)this.off(_,m.delegates[_]);return u.splice(h,1),this}}})(l),this}queryRenderedFeatures(r,e){if(!this.style)return[];if(e!==void 0||r===void 0||r instanceof D||Array.isArray(r)||(e=r,r=void 0),r=r||[[0,0],[this.transform.width,this.transform.height]],(e=e||{}).layers&&Array.isArray(e.layers)){for(const i of e.layers)if(!this._isValidId(i))return[]}return this.style.queryRenderedFeatures(r,e,this.transform)}querySourceFeatures(r,e){return this._isValidId(r)?this.style.querySourceFeatures(r,e):[]}isPointOnSurface(r){const{name:e}=this.transform.projection;return e!=="globe"&&e!=="mercator"&&se(`${e} projection does not support isPointOnSurface, this API may behave unexpectedly.`),this.transform.isPointOnSurface(D.convert(r))}setStyle(r,e){return(e=ze({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},e)).diff!==!1&&e.localIdeographFontFamily===this._localIdeographFontFamily&&e.localFontFamily===this._localFontFamily&&this.style&&r?(this._diffStyle(r,e),this):(this._localIdeographFontFamily=e.localIdeographFontFamily,this._localFontFamily=e.localFontFamily,this._updateStyle(r,e))}_getUIString(r){const e=this._locale[r];if(e==null)throw new Error(`Missing UI string '${r}'`);return e}_updateStyle(r,e){return this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),r&&(this.style=new Ql(this,e||{}),this.style.setEventedParent(this,{style:this.style}),typeof r=="string"?this.style.loadURL(r):this.style.loadJSON(r)),this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new Ql(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(r,e){if(typeof r=="string"){const i=this._requestManager.normalizeStyleURL(r),o=this._requestManager.transformRequest(i,Le.Style);jt(o,(l,u)=>{l?this.fire(new ar(l)):u&&this._updateDiff(u,e)})}else typeof r=="object"&&this._updateDiff(r,e)}_updateDiff(r,e){try{this.style.setState(r)&&this._update(!0)}catch(i){se(`Unable to perform style diff: ${i.message||i.error||i}.  Rebuilding the style from scratch.`),this._updateStyle(r,e)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(se("There is no style added to the map."),!1)}_isValidId(r){return!function(e){return e.indexOf("")>=0}(r)||(this.fire(new ar(new Error(`IDs can't contain special symbols: "${r}".`))),!1)}addSource(r,e){return this._isValidId(r)?(this._lazyInitEmptyStyle(),this.style.addSource(r,e),this._update(!0)):this}isSourceLoaded(r){return!!this._isValidId(r)&&!!this.style&&this.style._isSourceCacheLoaded(r)}areTilesLoaded(){const r=this.style&&this.style._sourceCaches;for(const e in r){const i=r[e]._tiles;for(const o in i){const l=i[o];if(l.state!=="loaded"&&l.state!=="errored")return!1}}return!0}addSourceType(r,e,i){this._lazyInitEmptyStyle(),this.style.addSourceType(r,e,i)}removeSource(r){return this._isValidId(r)?(this.style.removeSource(r),this._updateTerrain(),this._update(!0)):this}getSource(r){return this._isValidId(r)?this.style.getOwnSource(r):null}addImage(r,e,{pixelRatio:i=1,sdf:o=!1,stretchX:l,stretchY:u,content:h}={}){if(this._lazyInitEmptyStyle(),e instanceof g.HTMLImageElement||g.ImageBitmap&&e instanceof g.ImageBitmap){const{width:m,height:_,data:v}=Jr.getImageData(e);this.style.addImage(r,{data:new da({width:m,height:_},v),pixelRatio:i,stretchX:l,stretchY:u,content:h,sdf:o,version:0})}else if(e.width===void 0||e.height===void 0)this.fire(new ar(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:m,height:_}=e,v=e;this.style.addImage(r,{data:new da({width:m,height:_},new Uint8Array(v.data)),pixelRatio:i,stretchX:l,stretchY:u,content:h,sdf:o,version:0,userImage:v}),v.onAdd&&v.onAdd(this,r)}}updateImage(r,e){this._lazyInitEmptyStyle();const i=this.style.getImage(r);if(!i)return void this.fire(new ar(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const o=e instanceof g.HTMLImageElement||g.ImageBitmap&&e instanceof g.ImageBitmap?Jr.getImageData(e):e,{width:l,height:u}=o;l!==void 0&&u!==void 0?l===i.data.width&&u===i.data.height?(i.data.replace(o.data,!(e instanceof g.HTMLImageElement||g.ImageBitmap&&e instanceof g.ImageBitmap)),this.style.updateImage(r,i)):this.fire(new ar(new Error(`The width and height of the updated image (${l}, ${u})
                must be that same as the previous version of the image
                (${i.data.width}, ${i.data.height})`))):this.fire(new ar(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")))}hasImage(r){return r?!!this.style&&!!this.style.getImage(r):(this.fire(new ar(new Error("Missing required image id"))),!1)}removeImage(r){this.style.removeImage(r)}loadImage(r,e){Ur(this._requestManager.transformRequest(r,Le.Image),(i,o)=>{e(i,o instanceof g.HTMLImageElement?Jr.getImageData(o):o)})}listImages(){return this.style.listImages()}addModel(r,e){this._lazyInitEmptyStyle(),this.style.addModel(r,e)}hasModel(r){return r?this.style.hasModel(r):(this.fire(new ar(new Error("Missing required model id"))),!1)}removeModel(r){this.style.removeModel(r)}listModels(){return this.style.listModels()}addLayer(r,e){return this._isValidId(r.id)?(this._lazyInitEmptyStyle(),this.style.addLayer(r,e),this._update(!0)):this}moveLayer(r,e){return this._isValidId(r)?(this.style.moveLayer(r,e),this._update(!0)):this}removeLayer(r){return this._isValidId(r)?(this.style.removeLayer(r),this._update(!0)):this}getLayer(r){return this._isValidId(r)?this.style.getOwnLayer(r):null}setLayerZoomRange(r,e,i){return this._isValidId(r)?(this.style.setLayerZoomRange(r,e,i),this._update(!0)):this}setFilter(r,e,i={}){return this._isValidId(r)?(this.style.setFilter(r,e,i),this._update(!0)):this}getFilter(r){return this._isValidId(r)?this.style.getFilter(r):null}setPaintProperty(r,e,i,o={}){return this._isValidId(r)?(this.style.setPaintProperty(r,e,i,o),this._update(!0)):this}getPaintProperty(r,e){return this._isValidId(r)?this.style.getPaintProperty(r,e):null}setLayoutProperty(r,e,i,o={}){return this._isValidId(r)?(this.style.setLayoutProperty(r,e,i,o),this._update(!0)):this}getLayoutProperty(r,e){return this._isValidId(r)?this.style.getLayoutProperty(r,e):null}setConfigProperty(r,e,i){return this.style.setConfigProperty(r,e,i),this._update(!0)}setLights(r){if(this._lazyInitEmptyStyle(),r&&r.length===1&&r[0].type==="flat"){const e=r[0];e.properties?this.style.setFlatLight(e.properties,e.id,{}):this.style.setFlatLight({},"flat")}else this.style.setLights(r),this.painter.terrain&&(this.painter.terrain.invalidateRenderCache=!0);return this._update(!0)}getLights(){const r=this.style.getLights()||[];return r.length===0&&r.push({id:this.style.light.id,type:"flat",properties:this.style.getFlatLight()}),r}setLight(r,e={}){return console.log("The `map.setLight` function is deprecated, prefer using `map.setLights` with `flat` light type instead."),this.setLights([{id:"flat",type:"flat",properties:r}])}getLight(){return console.log("The `map.getLight` function is deprecated, prefer using `map.getLights` instead."),this.style.getFlatLight()}setTerrain(r){return this._lazyInitEmptyStyle(),!r&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(r),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(r){return this._lazyInitEmptyStyle(),this.style.setFog(r),this._update(!0)}getFog(){return this.style?this.style.getFog():null}setCamera(r){return this.style.setCamera(r),this._triggerCameraUpdate(r)}_triggerCameraUpdate(r){return this._update(this.transform.setOrthographicProjectionAtLowPitch(r["camera-projection"]==="orthographic"))}getCamera(){return this.style.camera}_queryFogOpacity(r){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(Xr.convert(r),this.transform):0}setFeatureState(r,e){return this._isValidId(r.source)?(this.style.setFeatureState(r,e),this._update()):this}removeFeatureState(r,e){return this._isValidId(r.source)?(this.style.removeFeatureState(r,e),this._update()):this}getFeatureState(r){return this._isValidId(r.source)?this.style.getFeatureState(r):null}_updateContainerDimensions(){if(!this._container)return;const r=this._container.getBoundingClientRect().width||400,e=this._container.getBoundingClientRect().height||300;let i,o,l,u=this._container;for(;u&&(!o||!l);){const h=g.getComputedStyle(u).transform;h&&h!=="none"&&(i=h.match(/matrix.*\((.+)\)/)[1].split(", "),i[0]&&i[0]!=="0"&&i[0]!=="1"&&(o=i[0]),i[3]&&i[3]!=="0"&&i[3]!=="1"&&(l=i[3])),u=u.parentElement}this._containerWidth=o?Math.abs(r/o):r,this._containerHeight=l?Math.abs(e/l):e}_detectMissingCSS(){g.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&se("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const r=this._container;r.classList.add("mapboxgl-map"),(this._missingCSSCanary=pi("div","mapboxgl-canary",r)).style.visibility="hidden",this._detectMissingCSS();const e=this._canvasContainer=pi("div","mapboxgl-canvas-container",r);this._canvas=pi("canvas","mapboxgl-canvas",e),this._interactive&&(e.classList.add("mapboxgl-interactive"),this._canvas.setAttribute("tabindex","0")),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const i=this._controlContainer=pi("div","mapboxgl-control-container",r),o=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(l=>{o[l]=pi("div",`mapboxgl-ctrl-${l}`,i)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(r,e){const i=Jr.devicePixelRatio||1;this._canvas.width=i*Math.ceil(r),this._canvas.height=i*Math.ceil(e),this._canvas.style.width=`${r}px`,this._canvas.style.height=`${e}px`}_addMarker(r){this._markers.push(r)}_removeMarker(r){const e=this._markers.indexOf(r);e!==-1&&this._markers.splice(e,1)}_addPopup(r){this._popups.push(r)}_removePopup(r){const e=this._popups.indexOf(r);e!==-1&&this._popups.splice(e,1)}_setupPainter(){const r=ze({},km.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),e=this._canvas.getContext("webgl2",r);e?(zl(e,!0),this.painter=new hX(e,this.transform),this.on("data",i=>{i.dataType==="source"&&this.painter.setTileLoadedFlag(!0)}),T.testSupport(e)):this.fire(new ar(new Error("Failed to initialize WebGL")))}_contextLost(r){r.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new _t("webglcontextlost",{originalEvent:r}))}_contextRestored(r){this._setupPainter(),this.resize(),this._update(),this.fire(new _t("webglcontextrestored",{originalEvent:r}))}_onMapScroll(r){if(r.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(r){return this.style?(this._styleDirty=this._styleDirty||r,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(r){return this._update(),this._renderTaskQueue.add(r)}_cancelRenderFrame(r){this._renderTaskQueue.remove(r)}_requestDomTask(r){!this.loaded()||this.loaded()&&!this.isMoving()?r():this._domRenderTaskQueue.add(r)}_render(r){let e;this.fire(new _t("renderstart"));const i=this.painter.context.extTimerQuery,o=Jr.now(),l=this.painter.context.gl;if(this.listens("gpu-timing-frame")&&(e=l.createQuery(),l.beginQuery(i.TIME_ELAPSED_EXT,e)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],g.performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],g.performance.now())),this._renderTaskQueue.run(r),this._domRenderTaskQueue.run(r),this._removed)return;this._updateProjectionTransition();const u=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const _=this.transform.zoom,v=this.transform.pitch,x=Jr.now(),w=new Gi(_,{now:x,fadeDuration:u,pitch:v,transition:this.style.transition});this.style.update(w)}this.style&&this.style.hasFogTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let h=!1;if(this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),h=this._updateAverageElevation(o),this.style.updateSources(this.transform),this._forceMarkerAndPopupUpdate()):h=this._updateAverageElevation(o),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,u,this._crossSourceCollisions),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,wireframe:{terrain:this.showTerrainWireframe,layers2D:this.showLayers2DWireframe,layers3D:this.showLayers3DWireframe},showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:u,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new _t("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new _t("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),e){const _=Jr.now()-o;l.endQuery(i.TIME_ELAPSED_EXT),setTimeout(()=>{const v=l.getQueryParameter(e,l.QUERY_RESULT)/1e6;l.deleteQuery(e),this.fire(new _t("gpu-timing-frame",{cpuTime:_,gpuTime:v})),g.performance.mark("frame-gpu",{startTime:o,detail:{gpuTime:v}})},50)}if(this.listens("gpu-timing-layer")){const _=this.painter.collectGpuTimers();setTimeout(()=>{const v=this.painter.queryGpuTimers(_);this.fire(new _t("gpu-timing-layer",{layerTimes:v}))},50)}if(this.listens("gpu-timing-deferred-render")){const _=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const v=this.painter.queryGpuTimeDeferredRender(_);this.fire(new _t("gpu-timing-deferred-render",{gpuTime:v}))},50)}const m=this._sourcesDirty||this._styleDirty||this._placementDirty||h;if(m||this._repaint)this.triggerRepaint();else{const _=!this.isMoving()&&this.loaded();if(_&&(h=this._updateAverageElevation(o,!0)),h)this.triggerRepaint();else if(this._triggerFrame(!1),_&&(this.fire(new _t("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const v=this._calculateSpeedIndex();this.fire(new _t("speedindexcompleted",{speedIndex:v})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||m||(this._fullyLoaded=!0,no.mark(ro.fullLoad),this._performanceMetricsCollection&&On(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(r){for(const e of this._markers)r&&!this.getRenderWorldCopies()&&(e._lngLat=e._lngLat.wrap()),e._update();for(const e of this._popups)!r||this.getRenderWorldCopies()||e._trackPointer||(e._lngLat=e._lngLat.wrap()),e._update()}_updateAverageElevation(r,e=!1){const i=l=>(this.transform.averageElevation=l,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return this.transform.averageElevation!==0&&i(0);const o=this.transform.elevation&&this.transform.elevation.exaggeration()!==this._averageElevationExaggeration;if(o||(e||r-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(r)){const l=this.transform.averageElevation;let u=this.transform.sampleAverageElevation();this.transform.elevation&&(this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(u)?u=0:this._averageElevationLastSampledAt=r;const h=Math.abs(l-u);if(h>1){if(this._isInitialLoad||o)return this._averageElevation.jumpTo(u),i(u);this._averageElevation.easeTo(u,r,300)}else if(h>1e-4)return this._averageElevation.jumpTo(u),i(u)}return!!this._averageElevation.isEasing(r)&&i(this._averageElevation.getValue(r))}_authenticate(){Vn(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,r=>{if(r&&(r.message===fn||r.status===401)){const e=this.painter.context.gl;zl(e,!1),this._logoControl instanceof pR&&this._logoControl._updateLogo(),e&&e.clear(e.DEPTH_BUFFER_BIT|e.COLOR_BUFFER_BIT|e.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new ar(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),yr(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_updateTerrain(){const r=this._isDragging();this.painter.updateTerrain(this.style,r)}_calculateSpeedIndex(){const r=this.painter.canvasCopy(),e=this.painter.getCanvasCopiesAndTimestamps();e.timeStamps.push(performance.now());const i=this.painter.context.gl,o=i.createFramebuffer();function l(u){i.framebufferTexture2D(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,u,0);const h=new Uint8Array(i.drawingBufferWidth*i.drawingBufferHeight*4);return i.readPixels(0,0,i.drawingBufferWidth,i.drawingBufferHeight,i.RGBA,i.UNSIGNED_BYTE,h),h}return i.bindFramebuffer(i.FRAMEBUFFER,o),this._canvasPixelComparison(l(r),e.canvasCopies.map(l),e.timeStamps)}_canvasPixelComparison(r,e,i){let o=i[1]-i[0];const l=r.length/4;for(let u=0;u<e.length;u++){const h=e[u];let m=0;for(let _=0;_<h.length;_+=4)h[_]===r[_]&&h[_+1]===r[_+1]&&h[_+2]===r[_+2]&&h[_+3]===r[_+3]&&(m+=1);o+=(i[u+2]-i[u+1])*(1-m/l)}return o}remove(){this._hash&&this._hash.remove();for(const e of this._controls)e.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),g!==void 0&&(g.removeEventListener("resize",this._onWindowResize,!1),g.removeEventListener("orientationchange",this._onWindowResize,!1),g.removeEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),g.removeEventListener("online",this._onWindowOnline,!1),g.removeEventListener("visibilitychange",this._onVisibilityChange,!1));const r=this.painter.context.gl.getExtension("WEBGL_lose_context");r&&r.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),Ca.delete(this.painter.context.gl),this._removed=!0,this.fire(new _t("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(r){this._renderNextFrame=this._renderNextFrame||r,this.style&&!this._frame&&(this._frame=Jr.frame(e=>{const i=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,i&&this._render(e)}))}_preloadTiles(r){return et(this.style?Object.values(this.style._sourceCaches):[],(e,i)=>e._preloadTiles(r,i),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(r){this._trackResize&&this.resize({originalEvent:r})._update()}_onVisibilityChange(){g.document.visibilityState==="hidden"&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(r){this._showTileBoundaries!==r&&(this._showTileBoundaries=r,this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(r){this._showTerrainWireframe!==r&&(this._showTerrainWireframe=r,this._update())}get showLayers2DWireframe(){return!!this._showLayers2DWireframe}set showLayers2DWireframe(r){this._showLayers2DWireframe!==r&&(this._showLayers2DWireframe=r,this._update())}get showLayers3DWireframe(){return!!this._showLayers3DWireframe}set showLayers3DWireframe(r){this._showLayers3DWireframe!==r&&(this._showLayers3DWireframe=r,this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(r){this._speedIndexTiming!==r&&(this._speedIndexTiming=r,this._update())}get showPadding(){return!!this._showPadding}set showPadding(r){this._showPadding!==r&&(this._showPadding=r,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(r){this._showCollisionBoxes!==r&&(this._showCollisionBoxes=r,r?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(r){this._showOverdrawInspector!==r&&(this._showOverdrawInspector=r,this._update())}get repaint(){return!!this._repaint}set repaint(r){this._repaint!==r&&(this._repaint=r,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(r){this._vertices=r,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(r){this._showTileAABBs!==r&&(this._showTileAABBs=r,r&&this._update())}_setCacheLimits(r,e){(function(i,o){dr=i,Br=o})(r,e)}get version(){return y}},NavigationControl:class{constructor(r){this.options=ze({},iZ,r),this._container=pi("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",e=>e.preventDefault()),this.options.showZoom&&(ae(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",e=>{this._map&&this._map.zoomIn({},{originalEvent:e})}),pi("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",e=>{this._map&&this._map.zoomOut({},{originalEvent:e})}),pi("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(ae(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",e=>{const i=this._map;i&&(this.options.visualizePitch?i.resetNorthPitch({},{originalEvent:e}):i.resetNorth({},{originalEvent:e}))}),this._compassIcon=pi("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const r=this._map;if(!r)return;const e=r.getZoom(),i=e===r.getMaxZoom(),o=e===r.getMinZoom();this._zoomInButton.disabled=i,this._zoomOutButton.disabled=o,this._zoomInButton.setAttribute("aria-disabled",i.toString()),this._zoomOutButton.setAttribute("aria-disabled",o.toString())}_rotateCompassArrow(){const r=this._map;if(!r)return;const e=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(r.transform.pitch*(Math.PI/180)),.5)}) rotateX(${r.transform.pitch}deg) rotateZ(${r.transform.angle*(180/Math.PI)}deg)`:`rotate(${r.transform.angle*(180/Math.PI)}deg)`;r._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=e)})}onAdd(r){return this._map=r,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),r.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&r.on("pitch",this._rotateCompassArrow),r.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new aZ(r,this._compass,this.options.visualizePitch)),this._container}onRemove(){const r=this._map;r&&(this._container.remove(),this.options.showZoom&&r.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&r.off("pitch",this._rotateCompassArrow),r.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(r,e){const i=pi("button",r,this._container);return i.type="button",i.addEventListener("click",e),i}_setButtonTitle(r,e){if(!this._map)return;const i=this._map._getUIString(`NavigationControl.${e}`);r.setAttribute("aria-label",i),r.firstElementChild&&r.firstElementChild.setAttribute("title",i)}},GeolocateControl:class extends Ln{constructor(r){super(),this.options=ze({geolocation:g.navigator.geolocation},oZ,r),ae(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=aR(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(r){return this._map=r,this._container=pi("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(r){const e=(i=!!this.options.geolocation)=>{this._supportsGeolocation=i,r(i)};this._supportsGeolocation!==void 0?r(this._supportsGeolocation):g.navigator.permissions!==void 0?g.navigator.permissions.query({name:"geolocation"}).then(i=>e(i.state!=="denied")).catch(()=>e()):e()}_isOutOfMapMaxBounds(r){const e=this._map.getMaxBounds(),i=r.coords;return!!e&&(i.longitude<e.getWest()||i.longitude>e.getEast()||i.latitude<e.getSouth()||i.latitude>e.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(r){if(this._map){if(this._isOutOfMapMaxBounds(r))return this._setErrorState(),this.fire(new _t("outofmaxbounds",r)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=r,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(r),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(r),this.options.showUserLocation&&this._userLocationDotMarker.removeClassName("mapboxgl-user-location-dot-stale"),this.fire(new _t("geolocate",r)),this._finish()}}_updateCamera(r){const e=new Xr(r.coords.longitude,r.coords.latitude),i=r.coords.accuracy,o=ze({bearing:this._map.getBearing()},this.options.fitBoundsOptions);this._map.fitBounds(e.toBounds(i),o,{geolocateSource:!0})}_updateMarker(r){if(r){const e=new Xr(r.coords.longitude,r.coords.latitude);this._accuracyCircleMarker.setLngLat(e).addTo(this._map),this._userLocationDotMarker.setLngLat(e).addTo(this._map),this._accuracy=r.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const r=this._map.transform,e=fi(1,r._center.lat)*r.worldSize,i=Math.ceil(2*this._accuracy*e);this._circleElement.style.width=`${i}px`,this._circleElement.style.height=`${i}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&typeof this._heading=="number"?(this._userLocationDotMarker.setRotation(this._heading),this._userLocationDotMarker.addClassName("mapboxgl-user-location-show-heading")):(this._userLocationDotMarker.removeClassName("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(r){if(this._map){if(this.options.trackUserLocation)if(r.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const e=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",e),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",e),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(r.code===3&&this._noTimeout)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._userLocationDotMarker.addClassName("mapboxgl-user-location-dot-stale"),this.fire(new _t("error",r)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(r){if(this._map!==void 0){if(this._container.addEventListener("contextmenu",e=>e.preventDefault()),this._geolocateButton=pi("button","mapboxgl-ctrl-geolocate",this._container),pi("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",r===!1){se("Geolocation support is not available so the GeolocateControl will be disabled.");const e=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",e),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",e)}else{const e=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",e),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",e)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=pi("div","mapboxgl-user-location"),this._dotElement.appendChild(pi("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(pi("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new OT({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=pi("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new OT({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",e=>{e.geolocateSource||this._watchState!=="ACTIVE_LOCK"||e.originalEvent&&e.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new _t("trackuserlocationend")))})}}_onDeviceOrientation(r){this._userLocationDotMarker&&(r.webkitCompassHeading?this._heading=r.webkitCompassHeading:r.absolute===!0&&(this._heading=-1*r.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return se("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new _t("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new _t("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new _t("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let r;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(r={maximumAge:6e5,timeout:0},this._noTimeout=!0):(r=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,r),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const r=()=>{g.addEventListener("ondeviceorientationabsolute"in g?"deviceorientationabsolute":"deviceorientation",this._onDeviceOrientation)};g.DeviceMotionEvent!==void 0&&typeof g.DeviceMotionEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then(e=>{e==="granted"&&r()}).catch(console.error):r()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),g.removeEventListener("deviceorientation",this._onDeviceOrientation),g.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:dR,ScaleControl:class{constructor(r){this.options=ze({},sZ,r),this._isNumberFormatSupported=function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"short",unit:"meter"}),!0}catch{return!1}}(),ae(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const r=this.options.maxWidth||100,e=this._map,i=e._containerHeight/2,o=e._containerWidth/2-r/2,l=e.unproject([o,i]),u=e.unproject([o+r,i]),h=l.distanceTo(u);if(this.options.unit==="imperial"){const m=3.2808*h;m>5280?this._setScale(r,m/5280,"mile"):this._setScale(r,m,"foot")}else this.options.unit==="nautical"?this._setScale(r,h/1852,"nautical-mile"):h>=1e3?this._setScale(r,h/1e3,"kilometer"):this._setScale(r,h,"meter")}_setScale(r,e,i){this._map._requestDomTask(()=>{const o=function(u){const h=Math.pow(10,`${Math.floor(u)}`.length-1);let m=u/h;return m=m>=10?10:m>=5?5:m>=3?3:m>=2?2:m>=1?1:function(_){const v=Math.pow(10,Math.ceil(-Math.log(_)/Math.LN10));return Math.round(_*v)/v}(m),h*m}(e),l=o/e;this._container.innerHTML=this._isNumberFormatSupported&&i!=="nautical-mile"?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"short",unit:i}).format(o):`${o}&nbsp;${lZ[i]}`,this._container.style.width=r*l+"px"})}onAdd(r){return this._map=r,this._language=r.getLanguage(),this._container=pi("div","mapboxgl-ctrl mapboxgl-ctrl-scale",r.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(r){this._language=r,this._update()}setUnit(r){this.options.unit=r,this._update()}},FullscreenControl:class{constructor(r){this._fullscreen=!1,r&&r.container&&(r.container instanceof g.HTMLElement?this._container=r.container:se("Full screen control 'container' must be a DOM element.")),ae(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in g.document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in g.document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(r){return this._map=r,this._container||(this._container=this._map.getContainer()),this._controlContainer=pi("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",se("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,g.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!g.document.fullscreenEnabled&&!g.document.webkitFullscreenEnabled)}_setupUI(){const r=this._fullscreenButton=pi("button","mapboxgl-ctrl-fullscreen",this._controlContainer);pi("span","mapboxgl-ctrl-icon",r).setAttribute("aria-hidden","true"),r.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),g.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const r=this._getTitle();this._fullscreenButton.setAttribute("aria-label",r),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",r)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(g.document.fullscreenElement||g.document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?g.document.exitFullscreen?g.document.exitFullscreen():g.document.webkitCancelFullScreen&&g.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends Ln{constructor(r){super(),this.options=ze(Object.create(QX),r),ae(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(r&&r.className?r.className.trim().split(/\s+/):[])}addTo(r){return this._map&&this.remove(),this._map=r,this.options.closeOnClick&&r.on("preclick",this._onClose),this.options.closeOnMove&&r.on("move",this._onClose),r.on("remove",this.remove),this._update(),r._addPopup(this),this._focusFirstElement(),this._trackPointer?(r.on("mousemove",this._onMouseEvent),r.on("mouseup",this._onMouseEvent),r._canvasContainer.classList.add("mapboxgl-track-pointer")):r.on("move",this._update),this.fire(new _t("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const r=this._map;return r&&(r.off("move",this._update),r.off("move",this._onClose),r.off("preclick",this._onClose),r.off("click",this._onClose),r.off("remove",this.remove),r.off("mousemove",this._onMouseEvent),r.off("mouseup",this._onMouseEvent),r.off("drag",this._onMouseEvent),r._canvasContainer&&r._canvasContainer.classList.remove("mapboxgl-track-pointer"),r._removePopup(this),this._map=void 0),this.fire(new _t("close")),this}getLngLat(){return this._lngLat}setLngLat(r){this._lngLat=Xr.convert(r),this._pos=null,this._trackPointer=!1,this._update();const e=this._map;return e&&(e.on("move",this._update),e.off("mousemove",this._onMouseEvent),e._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const r=this._map;return r&&(r.off("move",this._update),r.on("mousemove",this._onMouseEvent),r.on("drag",this._onMouseEvent),r._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(r){return this.setDOMContent(g.document.createTextNode(r))}setHTML(r){const e=g.document.createDocumentFragment(),i=g.document.createElement("body");let o;for(i.innerHTML=r;o=i.firstChild,o;)e.appendChild(o);return this.setDOMContent(e)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(r){return this.options.maxWidth=r,this._update(),this}setDOMContent(r){let e=this._content;if(e)for(;e.hasChildNodes();)e.firstChild&&e.removeChild(e.firstChild);else e=this._content=pi("div","mapboxgl-popup-content",this._container||void 0);if(e.appendChild(r),this.options.closeButton){const i=this._closeButton=pi("button","mapboxgl-popup-close-button",e);i.type="button",i.setAttribute("aria-label","Close popup"),i.setAttribute("aria-hidden","true"),i.innerHTML="&#215;",i.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(r){return this._classList.add(r),this._updateClassList(),this}removeClassName(r){return this._classList.delete(r),this._updateClassList(),this}setOffset(r){return this.options.offset=r,this._update(),this}toggleClassName(r){let e;return this._classList.delete(r)?e=!1:(this._classList.add(r),e=!0),this._updateClassList(),e}_onMouseEvent(r){this._update(r.point)}_getAnchor(r){if(this.options.anchor)return this.options.anchor;const e=this._map,i=this._container,o=this._pos;if(!e||!i||!o)return"bottom";const l=i.offsetWidth,u=i.offsetHeight,h=o.x<l/2,m=o.x>e.transform.width-l/2;if(o.y+r<u)return h?"top-left":m?"top-right":"top";if(o.y>e.transform.height-u){if(h)return"bottom-left";if(m)return"bottom-right"}return h?"left":m?"right":"bottom"}_updateClassList(){const r=this._container;if(!r)return;const e=[...this._classList];e.push("mapboxgl-popup"),this._anchor&&e.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&e.push("mapboxgl-popup-track-pointer"),r.className=e.join(" ")}_update(r){const e=this._map,i=this._content;if(!e||!this._lngLat&&!this._trackPointer||!i)return;let o=this._container;if(o||(o=this._container=pi("div","mapboxgl-popup",e.getContainer()),this._tip=pi("div","mapboxgl-popup-tip",o),o.appendChild(i)),this.options.maxWidth&&o.style.maxWidth!==this.options.maxWidth&&(o.style.maxWidth=this.options.maxWidth),e.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=gR(this._lngLat,this._pos,e.transform)),!this._trackPointer||r){const l=this._pos=this._trackPointer&&r?r:e.project(this._lngLat),u=_R(this.options.offset),h=this._anchor=this._getAnchor(u.y),m=_R(this.options.offset,h),_=l.add(m).round();e._requestDomTask(()=>{this._container&&h&&(this._container.style.transform=`${PT[h]} translate(${_.x}px,${_.y}px)`)})}if(!this._marker&&e._showingGlobe()){const l=v1(e.transform,this._lngLat)?0:1;this._setOpacity(l)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const r=this._container.querySelector(eZ);r&&r.focus()}_onClose(){this.remove()}_setOpacity(r){this._container&&(this._container.style.opacity=`${r}`),this._content&&(this._content.style.pointerEvents=r?"auto":"none")}},Marker:OT,Style:Ql,LngLat:Xr,LngLatBounds:Ks,Point:D,MercatorCoordinate:Pn,FreeCameraOptions:IF,Evented:Ln,config:E,prewarm:function(){kg().acquire(nT)},clearPrewarmedResources:function(){const r=Ag;r&&(r.isPreloaded()&&r.numActive()===1?(r.release(nT),Ag=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return E.ACCESS_TOKEN},set accessToken(r){E.ACCESS_TOKEN=r},get baseApiUrl(){return E.API_URL},set baseApiUrl(r){E.API_URL=r},get workerCount(){return l0.workerCount},set workerCount(r){l0.workerCount=r},get maxParallelImageRequests(){return E.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(r){E.MAX_PARALLEL_IMAGE_REQUESTS=r},clearStorage(r){(function(e){if(!Wi())return;const i=g.caches.delete(Gt);e&&i.catch(e).then(()=>e())})(r)},workerUrl:"",workerClass:null,get dracoUrl(){return WP()},set dracoUrl(r){(function(e){iT=Jr.resolveURL(e),aT||(aT=new pd(kg(),new Ln)),aT.broadcast("setDracoUrl",iT)})(r)},setNow:Jr.setNow,restoreNow:Jr.restoreNow};p.A=LP,p.D=ld,p.E=Et,p.F=CE,p.K=vy,p.O=Wn,p.P=D,p.T=eP,p.V=F1,p.a=M1,p.b=FM,p.c=cy,p.d=class extends Ln{constructor(r,e,i,o,l,u){super(),this.actor=r,this.layerIndex=e,this.availableImages=i,this.loadVectorData=l||VP,this.loading={},this.loaded={},this.deduped=new $P(r.scheduler),this.isSpriteLoaded=o,this.scheduler=r.scheduler,this.brightness=u}loadTile(r,e){const i=r.uid,o=r&&r.request,l=o&&o.collectResourceTiming,u=this.loading[i]=new MG(r);u.abort=this.loadVectorData(r,(h,m)=>{const _=!this.loading[i];if(delete this.loading[i],_||h||!m)return u.status="done",_||(this.loaded[i]=u),e(h);const v=m.rawData,x={};m.expires&&(x.expires=m.expires),m.cacheControl&&(x.cacheControl=m.cacheControl),u.vectorTile=m.vectorTile||new wE(new L1(v));const w=()=>{u.parse(u.vectorTile,this.layerIndex,this.availableImages,this.actor,(C,k)=>{if(C||!k)return e(C);const P={};if(l){const R=Ha(o);R.length>0&&(P.resourceTiming=JSON.parse(JSON.stringify(R)))}e(null,ze({rawTileData:v.slice(0)},k,x,P))})};this.isSpriteLoaded?w():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(w,{type:"parseTile",isSymbolTile:r.isSymbolTile,zoom:r.tileZoom}):w()}),this.loaded=this.loaded||{},this.loaded[i]=u})}reloadTile(r,e){const i=this.loaded,o=r.uid,l=this;if(i&&i[o]){const u=i[o];u.showCollisionBoxes=r.showCollisionBoxes,u.projection=r.projection,u.brightness=r.brightness,u.tileTransform=cd(r.tileID.canonical,r.projection),u.extraShadowCaster=r.extraShadowCaster;const h=(m,_)=>{const v=u.reloadCallback;v&&(delete u.reloadCallback,u.parse(u.vectorTile,l.layerIndex,this.availableImages,l.actor,v)),e(m,_)};u.status==="parsing"?u.reloadCallback=h:u.status==="done"&&(u.vectorTile?u.parse(u.vectorTile,this.layerIndex,this.availableImages,this.actor,h):h())}}abortTile(r,e){const i=r.uid,o=this.loading[i];o&&(o.abort&&o.abort(),delete this.loading[i]),e()}removeTile(r,e){const i=this.loaded,o=r.uid;i&&i[o]&&delete i[o],e()}},p.e=Cf,p.f=Ha,p.g=O,p.h=jt,p.i=qt,p.j=function(r,e){const i=fT(r);for(const o of i){for(const l of o.meshes)UG(l);o.lights&&(o.lightMeshIndex=o.meshes.length,o.meshes.push($G(o.lights,e)))}return i},p.k=Gi,p.l=function(r){let e=0;if(new Uint32Array(r,0,1)[0]!==GP){const i=new Uint32Array(r,0,7),[,,o,l,u,h]=i;e=i.byteLength+l+u+h+u,(o!==r.byteLength||e>=r.byteLength)&&se("Invalid b3dm header information.")}return KP(r,e)},p.m=W1,p.n=pl,p.o=_t,p.p=j,p.q=function(r){Fi(),qr&&qr.then(e=>{e.keys().then(i=>{for(let o=0;o<i.length-r;o++)e.delete(i[o])})})},p.r=tO,p.s=Ry,p.t=rg,p.v=Ge,p.w=g}),f(["./shared"],function(p){function g(he){if(typeof he=="number"||typeof he=="boolean"||typeof he=="string"||he==null)return JSON.stringify(he);if(Array.isArray(he)){let K="[";for(const se of he)K+=`${g(se)},`;return`${K}]`}let G="{";for(const K of Object.keys(he).sort())G+=`${K}:${g(he[K])},`;return`${G}}`}function y(he){let G="";for(const K of p.r)G+=`/${g(he[K])}`;return G}class b{constructor(G){this.keyCache={},G&&this.replace(G)}replace(G,K){this._layerConfigs={},this._layers={},this.update(G,[],K)}update(G,K,se){this._options=se;for(const Se of G){this._layerConfigs[Se.id]=Se;const ye=this._layers[Se.id]=p.c(Se,this._options);ye.setScope(this.scope),ye.compileFilter(),this.keyCache[Se.id]&&delete this.keyCache[Se.id]}for(const Se of K)delete this.keyCache[Se],delete this._layerConfigs[Se],delete this._layers[Se];this.familiesBySource={};const Ae=function(Se,ye){const Xe={};for(let Be=0;Be<Se.length;Be++){const ct=ye&&ye[Se[Be].id]||y(Se[Be]);ye&&(ye[Se[Be].id]=ct);let At=Xe[ct];At||(At=Xe[ct]=[]),At.push(Se[Be])}const be=[];for(const Be in Xe)be.push(Xe[Be]);return be}(p.v(this._layerConfigs),this.keyCache);for(const Se of Ae){const ye=Se.map($t=>this._layers[$t.id]),Xe=ye[0];if(Xe.visibility==="none")continue;const be=Xe.source||"";let Be=this.familiesBySource[be];Be||(Be=this.familiesBySource[be]={});const ct=Xe.sourceLayer||"_geojsonTileLayer";let At=Be[ct];At||(At=Be[ct]=[]),At.push(ye)}}}class E{loadTile(G,K){const{uid:se,encoding:Ae,rawImageData:Se,padding:ye}=G,Xe=p.w.ImageBitmap&&Se instanceof p.w.ImageBitmap?this.getImageData(Se,ye):Se;K(null,new p.D(se,Xe,Ae,G.convertToFloat,ye<1))}getImageData(G,K){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(G.width,G.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=G.width,this.offscreenCanvas.height=G.height,this.offscreenCanvasContext.drawImage(G,0,0,G.width,G.height);const se=this.offscreenCanvasContext.getImageData(-K,-K,G.width+2*K,G.height+2*K);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),se}}function T(he,G){if(he.length!==0){S(he[0],G);for(var K=1;K<he.length;K++)S(he[K],!G)}}function S(he,G){for(var K=0,se=0,Ae=0,Se=he.length,ye=Se-1;Ae<Se;ye=Ae++){var Xe=(he[Ae][0]-he[ye][0])*(he[ye][1]+he[Ae][1]),be=K+Xe;se+=Math.abs(K)>=Math.abs(Xe)?K-be+Xe:Xe-be+K,K=be}K+se>=0!=!!G&&he.reverse()}var I=p.g(function he(G,K){var se,Ae=G&&G.type;if(Ae==="FeatureCollection")for(se=0;se<G.features.length;se++)he(G.features[se],K);else if(Ae==="GeometryCollection")for(se=0;se<G.geometries.length;se++)he(G.geometries[se],K);else if(Ae==="Feature")he(G.geometry,K);else if(Ae==="Polygon")T(G.coordinates,K);else if(Ae==="MultiPolygon")for(se=0;se<G.coordinates.length;se++)T(G.coordinates[se],K);return G});const A=p.V.prototype.toGeoJSON;var M={exports:{}},F=p.p,L=p.a.VectorTileFeature,O=N;function N(he,G){this.options=G||{},this.features=he,this.length=he.length}function Q(he,G){this.id=typeof he.id=="number"?he.id:void 0,this.type=he.type,this.rawGeometry=he.type===1?[he.geometry]:he.geometry,this.properties=he.tags,this.extent=G||4096}N.prototype.feature=function(he){return new Q(this.features[he],this.options.extent)},Q.prototype.loadGeometry=function(){var he=this.rawGeometry;this.geometry=[];for(var G=0;G<he.length;G++){for(var K=he[G],se=[],Ae=0;Ae<K.length;Ae++)se.push(new F(K[Ae][0],K[Ae][1]));this.geometry.push(se)}return this.geometry},Q.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var he=this.geometry,G=1/0,K=-1/0,se=1/0,Ae=-1/0,Se=0;Se<he.length;Se++)for(var ye=he[Se],Xe=0;Xe<ye.length;Xe++){var be=ye[Xe];G=Math.min(G,be.x),K=Math.max(K,be.x),se=Math.min(se,be.y),Ae=Math.max(Ae,be.y)}return[G,se,K,Ae]},Q.prototype.toGeoJSON=L.prototype.toGeoJSON;var ie=p.b,j=O;function V(he){var G=new ie;return function(K,se){for(var Ae in K.layers)se.writeMessage(3,D,K.layers[Ae])}(he,G),G.finish()}function D(he,G){var K;G.writeVarintField(15,he.version||1),G.writeStringField(1,he.name||""),G.writeVarintField(5,he.extent||4096);var se={keys:[],values:[],keycache:{},valuecache:{}};for(K=0;K<he.length;K++)se.feature=he.feature(K),G.writeMessage(2,te,se);var Ae=se.keys;for(K=0;K<Ae.length;K++)G.writeStringField(3,Ae[K]);var Se=se.values;for(K=0;K<Se.length;K++)G.writeMessage(4,Fe,Se[K])}function te(he,G){var K=he.feature;K.id!==void 0&&G.writeVarintField(1,K.id),G.writeMessage(2,ue,he),G.writeVarintField(3,K.type),G.writeMessage(4,re,K)}function ue(he,G){var K=he.feature,se=he.keys,Ae=he.values,Se=he.keycache,ye=he.valuecache;for(var Xe in K.properties){var be=K.properties[Xe],Be=Se[Xe];if(be!==null){Be===void 0&&(se.push(Xe),Se[Xe]=Be=se.length-1),G.writeVarint(Be);var ct=typeof be;ct!=="string"&&ct!=="boolean"&&ct!=="number"&&(be=JSON.stringify(be));var At=ct+":"+be,$t=ye[At];$t===void 0&&(Ae.push(be),ye[At]=$t=Ae.length-1),G.writeVarint($t)}}}function J(he,G){return(G<<3)+(7&he)}function le(he){return he<<1^he>>31}function re(he,G){for(var K=he.loadGeometry(),se=he.type,Ae=0,Se=0,ye=K.length,Xe=0;Xe<ye;Xe++){var be=K[Xe],Be=1;se===1&&(Be=be.length),G.writeVarint(J(1,Be));for(var ct=se===3?be.length-1:be.length,At=0;At<ct;At++){At===1&&se!==1&&G.writeVarint(J(2,ct-1));var $t=be[At].x-Ae,mr=be[At].y-Se;G.writeVarint(le($t)),G.writeVarint(le(mr)),Ae+=$t,Se+=mr}se===3&&G.writeVarint(J(7,1))}}function Fe(he,G){var K=typeof he;K==="string"?G.writeStringField(1,he):K==="boolean"?G.writeBooleanField(7,he):K==="number"&&(he%1!=0?G.writeDoubleField(3,he):he<0?G.writeSVarintField(6,he):G.writeVarintField(5,he))}M.exports=V,M.exports.fromVectorTileJs=V,M.exports.fromGeojsonVt=function(he,G){G=G||{};var K={};for(var se in he)K[se]=new j(he[se].features,G),K[se].name=se,K[se].version=G.version,K[se].extent=G.extent;return V({layers:K})},M.exports.GeoJSONWrapper=j;var Ye=p.g(M.exports);const Ee={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:he=>he},ut=Math.fround||(Ne=new Float32Array(1),he=>(Ne[0]=+he,Ne[0]));var Ne;const He=3,Oe=5,Pe=6;class rt{constructor(G){this.options=Object.assign(Object.create(Ee),G),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(G){const{log:K,minZoom:se,maxZoom:Ae}=this.options;K&&console.time("total time");const Se=`prepare ${G.length} points`;K&&console.time(Se),this.points=G;const ye=[];for(let be=0;be<G.length;be++){const Be=G[be];if(!Be.geometry)continue;const[ct,At]=Be.geometry.coordinates,$t=ut(ze(ct)),mr=ut(oe(At));ye.push($t,mr,1/0,be,-1,1),this.options.reduce&&ye.push(0)}let Xe=this.trees[Ae+1]=this._createTree(ye);K&&console.timeEnd(Se);for(let be=Ae;be>=se;be--){const Be=+Date.now();Xe=this.trees[be]=this._createTree(this._cluster(Xe,be)),K&&console.log("z%d: %d clusters in %dms",be,Xe.numItems,+Date.now()-Be)}return K&&console.timeEnd("total time"),this}getClusters(G,K){let se=((G[0]+180)%360+360)%360-180;const Ae=Math.max(-90,Math.min(90,G[1]));let Se=G[2]===180?180:((G[2]+180)%360+360)%360-180;const ye=Math.max(-90,Math.min(90,G[3]));if(G[2]-G[0]>=360)se=-180,Se=180;else if(se>Se){const At=this.getClusters([se,Ae,180,ye],K),$t=this.getClusters([-180,Ae,Se,ye],K);return At.concat($t)}const Xe=this.trees[this._limitZoom(K)],be=Xe.range(ze(se),oe(ye),ze(Se),oe(Ae)),Be=Xe.data,ct=[];for(const At of be){const $t=this.stride*At;ct.push(Be[$t+Oe]>1?et(Be,$t,this.clusterProps):this.points[Be[$t+He]])}return ct}getChildren(G){const K=this._getOriginId(G),se=this._getOriginZoom(G),Ae="No cluster with the specified id.",Se=this.trees[se];if(!Se)throw new Error(Ae);const ye=Se.data;if(K*this.stride>=ye.length)throw new Error(Ae);const Xe=this.options.radius/(this.options.extent*Math.pow(2,se-1)),be=Se.within(ye[K*this.stride],ye[K*this.stride+1],Xe),Be=[];for(const ct of be){const At=ct*this.stride;ye[At+4]===G&&Be.push(ye[At+Oe]>1?et(ye,At,this.clusterProps):this.points[ye[At+He]])}if(Be.length===0)throw new Error(Ae);return Be}getLeaves(G,K,se){const Ae=[];return this._appendLeaves(Ae,G,K=K||10,se=se||0,0),Ae}getTile(G,K,se){const Ae=this.trees[this._limitZoom(G)],Se=Math.pow(2,G),{extent:ye,radius:Xe}=this.options,be=Xe/ye,Be=(se-be)/Se,ct=(se+1+be)/Se,At={features:[]};return this._addTileFeatures(Ae.range((K-be)/Se,Be,(K+1+be)/Se,ct),Ae.data,K,se,Se,At),K===0&&this._addTileFeatures(Ae.range(1-be/Se,Be,1,ct),Ae.data,Se,se,Se,At),K===Se-1&&this._addTileFeatures(Ae.range(0,Be,be/Se,ct),Ae.data,-1,se,Se,At),At.features.length?At:null}getClusterExpansionZoom(G){let K=this._getOriginZoom(G)-1;for(;K<=this.options.maxZoom;){const se=this.getChildren(G);if(K++,se.length!==1)break;G=se[0].properties.cluster_id}return K}_appendLeaves(G,K,se,Ae,Se){const ye=this.getChildren(K);for(const Xe of ye){const be=Xe.properties;if(be&&be.cluster?Se+be.point_count<=Ae?Se+=be.point_count:Se=this._appendLeaves(G,be.cluster_id,se,Ae,Se):Se<Ae?Se++:G.push(Xe),G.length===se)break}return Se}_createTree(G){const K=new p.K(G.length/this.stride|0,this.options.nodeSize,Float32Array);for(let se=0;se<G.length;se+=this.stride)K.add(G[se],G[se+1]);return K.finish(),K.data=G,K}_addTileFeatures(G,K,se,Ae,Se,ye){for(const Xe of G){const be=Xe*this.stride,Be=K[be+Oe]>1;let ct,At,$t;if(Be)ct=Ge(K,be,this.clusterProps),At=K[be],$t=K[be+1];else{const Lt=this.points[K[be+He]];ct=Lt.properties;const[Qt,Gt]=Lt.geometry.coordinates;At=ze(Qt),$t=oe(Gt)}const mr={type:1,geometry:[[Math.round(this.options.extent*(At*Se-se)),Math.round(this.options.extent*($t*Se-Ae))]],tags:ct};let Nt;Nt=Be||this.options.generateId?K[be+He]:this.points[K[be+He]].id,Nt!==void 0&&(mr.id=Nt),ye.features.push(mr)}}_limitZoom(G){return Math.max(this.options.minZoom,Math.min(Math.floor(+G),this.options.maxZoom+1))}_cluster(G,K){const{radius:se,extent:Ae,reduce:Se,minPoints:ye}=this.options,Xe=se/(Ae*Math.pow(2,K)),be=G.data,Be=[],ct=this.stride;for(let At=0;At<be.length;At+=ct){if(be[At+2]<=K)continue;be[At+2]=K;const $t=be[At],mr=be[At+1],Nt=G.within(be[At],be[At+1],Xe),Lt=be[At+Oe];let Qt=Lt;for(const Gt of Nt){const dr=Gt*ct;be[dr+2]>K&&(Qt+=be[dr+Oe])}if(Qt>Lt&&Qt>=ye){let Gt,dr=$t*Lt,Br=mr*Lt,qr=-1;const Ci=((At/ct|0)<<5)+(K+1)+this.points.length;for(const Wi of Nt){const Fi=Wi*ct;if(be[Fi+2]<=K)continue;be[Fi+2]=K;const Ta=be[Fi+Oe];dr+=be[Fi]*Ta,Br+=be[Fi+1]*Ta,be[Fi+4]=Ci,Se&&(Gt||(Gt=this._map(be,At,!0),qr=this.clusterProps.length,this.clusterProps.push(Gt)),Se(Gt,this._map(be,Fi)))}be[At+4]=Ci,Be.push(dr/Qt,Br/Qt,1/0,Ci,-1,Qt),Se&&Be.push(qr)}else{for(let Gt=0;Gt<ct;Gt++)Be.push(be[At+Gt]);if(Qt>1)for(const Gt of Nt){const dr=Gt*ct;if(!(be[dr+2]<=K)){be[dr+2]=K;for(let Br=0;Br<ct;Br++)Be.push(be[dr+Br])}}}}return Be}_getOriginId(G){return G-this.points.length>>5}_getOriginZoom(G){return(G-this.points.length)%32}_map(G,K,se){if(G[K+Oe]>1){const ye=this.clusterProps[G[K+Pe]];return se?Object.assign({},ye):ye}const Ae=this.points[G[K+He]].properties,Se=this.options.map(Ae);return se&&Se===Ae?Object.assign({},Se):Se}}function et(he,G,K){return{type:"Feature",id:he[G+He],properties:Ge(he,G,K),geometry:{type:"Point",coordinates:[(se=he[G],360*(se-.5)),Me(he[G+1])]}};var se}function Ge(he,G,K){const se=he[G+Oe],Ae=se>=1e4?`${Math.round(se/1e3)}k`:se>=1e3?Math.round(se/100)/10+"k":se,Se=he[G+Pe],ye=Se===-1?{}:Object.assign({},K[Se]);return Object.assign(ye,{cluster:!0,cluster_id:he[G+He],point_count:se,point_count_abbreviated:Ae})}function ze(he){return he/360+.5}function oe(he){const G=Math.sin(he*Math.PI/180),K=.5-.25*Math.log((1+G)/(1-G))/Math.PI;return K<0?0:K>1?1:K}function Me(he){const G=(180-360*he)*Math.PI/180;return 360*Math.atan(Math.exp(G))/Math.PI-90}var fe={exports:{}};fe.exports=function(){function he(Le,lt,xt,Ot){for(var jt,qt=Ot,Jt=xt-lt>>1,Xt=xt-lt,or=Le[lt],er=Le[lt+1],Ur=Le[xt],fn=Le[xt+1],Cr=lt+3;Cr<xt;Cr+=3){var _e=G(Le[Cr],Le[Cr+1],or,er,Ur,fn);if(_e>qt)jt=Cr,qt=_e;else if(_e===qt){var qe=Math.abs(Cr-Jt);qe<Xt&&(jt=Cr,Xt=qe)}}qt>Ot&&(jt-lt>3&&he(Le,lt,jt,Ot),Le[jt+2]=qt,xt-jt>3&&he(Le,jt,xt,Ot))}function G(Le,lt,xt,Ot,jt,qt){var Jt=jt-xt,Xt=qt-Ot;if(Jt!==0||Xt!==0){var or=((Le-xt)*Jt+(lt-Ot)*Xt)/(Jt*Jt+Xt*Xt);or>1?(xt=jt,Ot=qt):or>0&&(xt+=Jt*or,Ot+=Xt*or)}return(Jt=Le-xt)*Jt+(Xt=lt-Ot)*Xt}function K(Le,lt,xt,Ot){var jt={id:Le===void 0?null:Le,type:lt,geometry:xt,tags:Ot,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(qt){var Jt=qt.geometry,Xt=qt.type;if(Xt==="Point"||Xt==="MultiPoint"||Xt==="LineString")se(qt,Jt);else if(Xt==="Polygon"||Xt==="MultiLineString")for(var or=0;or<Jt.length;or++)se(qt,Jt[or]);else if(Xt==="MultiPolygon")for(or=0;or<Jt.length;or++)for(var er=0;er<Jt[or].length;er++)se(qt,Jt[or][er])}(jt),jt}function se(Le,lt){for(var xt=0;xt<lt.length;xt+=3)Le.minX=Math.min(Le.minX,lt[xt]),Le.minY=Math.min(Le.minY,lt[xt+1]),Le.maxX=Math.max(Le.maxX,lt[xt]),Le.maxY=Math.max(Le.maxY,lt[xt+1])}function Ae(Le,lt,xt,Ot){if(lt.geometry){var jt=lt.geometry.coordinates,qt=lt.geometry.type,Jt=Math.pow(xt.tolerance/((1<<xt.maxZoom)*xt.extent),2),Xt=[],or=lt.id;if(xt.promoteId?or=lt.properties[xt.promoteId]:xt.generateId&&(or=Ot||0),qt==="Point")Se(jt,Xt);else if(qt==="MultiPoint")for(var er=0;er<jt.length;er++)Se(jt[er],Xt);else if(qt==="LineString")ye(jt,Xt,Jt,!1);else if(qt==="MultiLineString"){if(xt.lineMetrics){for(er=0;er<jt.length;er++)ye(jt[er],Xt=[],Jt,!1),Le.push(K(or,"LineString",Xt,lt.properties));return}Xe(jt,Xt,Jt,!1)}else if(qt==="Polygon")Xe(jt,Xt,Jt,!0);else{if(qt!=="MultiPolygon"){if(qt==="GeometryCollection"){for(er=0;er<lt.geometry.geometries.length;er++)Ae(Le,{id:or,geometry:lt.geometry.geometries[er],properties:lt.properties},xt,Ot);return}throw new Error("Input data is not a valid GeoJSON object.")}for(er=0;er<jt.length;er++){var Ur=[];Xe(jt[er],Ur,Jt,!0),Xt.push(Ur)}}Le.push(K(or,qt,Xt,lt.properties))}}function Se(Le,lt){lt.push(be(Le[0])),lt.push(Be(Le[1])),lt.push(0)}function ye(Le,lt,xt,Ot){for(var jt,qt,Jt=0,Xt=0;Xt<Le.length;Xt++){var or=be(Le[Xt][0]),er=Be(Le[Xt][1]);lt.push(or),lt.push(er),lt.push(0),Xt>0&&(Jt+=Ot?(jt*er-or*qt)/2:Math.sqrt(Math.pow(or-jt,2)+Math.pow(er-qt,2))),jt=or,qt=er}var Ur=lt.length-3;lt[2]=1,he(lt,0,Ur,xt),lt[Ur+2]=1,lt.size=Math.abs(Jt),lt.start=0,lt.end=lt.size}function Xe(Le,lt,xt,Ot){for(var jt=0;jt<Le.length;jt++){var qt=[];ye(Le[jt],qt,xt,Ot),lt.push(qt)}}function be(Le){return Le/360+.5}function Be(Le){var lt=Math.sin(Le*Math.PI/180),xt=.5-.25*Math.log((1+lt)/(1-lt))/Math.PI;return xt<0?0:xt>1?1:xt}function ct(Le,lt,xt,Ot,jt,qt,Jt,Xt){if(Ot/=lt,qt>=(xt/=lt)&&Jt<Ot)return Le;if(Jt<xt||qt>=Ot)return null;for(var or=[],er=0;er<Le.length;er++){var Ur=Le[er],fn=Ur.geometry,Cr=Ur.type,_e=jt===0?Ur.minX:Ur.minY,qe=jt===0?Ur.maxX:Ur.maxY;if(_e>=xt&&qe<Ot)or.push(Ur);else if(!(qe<xt||_e>=Ot)){var Ue=[];if(Cr==="Point"||Cr==="MultiPoint")At(fn,Ue,xt,Ot,jt);else if(Cr==="LineString")$t(fn,Ue,xt,Ot,jt,!1,Xt.lineMetrics);else if(Cr==="MultiLineString")Nt(fn,Ue,xt,Ot,jt,!1);else if(Cr==="Polygon")Nt(fn,Ue,xt,Ot,jt,!0);else if(Cr==="MultiPolygon")for(var je=0;je<fn.length;je++){var Ke=[];Nt(fn[je],Ke,xt,Ot,jt,!0),Ke.length&&Ue.push(Ke)}if(Ue.length){if(Xt.lineMetrics&&Cr==="LineString"){for(je=0;je<Ue.length;je++)or.push(K(Ur.id,Cr,Ue[je],Ur.tags));continue}Cr!=="LineString"&&Cr!=="MultiLineString"||(Ue.length===1?(Cr="LineString",Ue=Ue[0]):Cr="MultiLineString"),Cr!=="Point"&&Cr!=="MultiPoint"||(Cr=Ue.length===3?"Point":"MultiPoint"),or.push(K(Ur.id,Cr,Ue,Ur.tags))}}}return or.length?or:null}function At(Le,lt,xt,Ot,jt){for(var qt=0;qt<Le.length;qt+=3){var Jt=Le[qt+jt];Jt>=xt&&Jt<=Ot&&(lt.push(Le[qt]),lt.push(Le[qt+1]),lt.push(Le[qt+2]))}}function $t(Le,lt,xt,Ot,jt,qt,Jt){for(var Xt,or,er=mr(Le),Ur=jt===0?Qt:Gt,fn=Le.start,Cr=0;Cr<Le.length-3;Cr+=3){var _e=Le[Cr],qe=Le[Cr+1],Ue=Le[Cr+2],je=Le[Cr+3],Ke=Le[Cr+4],nt=jt===0?_e:qe,It=jt===0?je:Ke,Bt=!1;Jt&&(Xt=Math.sqrt(Math.pow(_e-je,2)+Math.pow(qe-Ke,2))),nt<xt?It>xt&&(or=Ur(er,_e,qe,je,Ke,xt),Jt&&(er.start=fn+Xt*or)):nt>Ot?It<Ot&&(or=Ur(er,_e,qe,je,Ke,Ot),Jt&&(er.start=fn+Xt*or)):Lt(er,_e,qe,Ue),It<xt&&nt>=xt&&(or=Ur(er,_e,qe,je,Ke,xt),Bt=!0),It>Ot&&nt<=Ot&&(or=Ur(er,_e,qe,je,Ke,Ot),Bt=!0),!qt&&Bt&&(Jt&&(er.end=fn+Xt*or),lt.push(er),er=mr(Le)),Jt&&(fn+=Xt)}var kt=Le.length-3;_e=Le[kt],qe=Le[kt+1],Ue=Le[kt+2],(nt=jt===0?_e:qe)>=xt&&nt<=Ot&&Lt(er,_e,qe,Ue),kt=er.length-3,qt&&kt>=3&&(er[kt]!==er[0]||er[kt+1]!==er[1])&&Lt(er,er[0],er[1],er[2]),er.length&&lt.push(er)}function mr(Le){var lt=[];return lt.size=Le.size,lt.start=Le.start,lt.end=Le.end,lt}function Nt(Le,lt,xt,Ot,jt,qt){for(var Jt=0;Jt<Le.length;Jt++)$t(Le[Jt],lt,xt,Ot,jt,qt,!1)}function Lt(Le,lt,xt,Ot){Le.push(lt),Le.push(xt),Le.push(Ot)}function Qt(Le,lt,xt,Ot,jt,qt){var Jt=(qt-lt)/(Ot-lt);return Le.push(qt),Le.push(xt+(jt-xt)*Jt),Le.push(1),Jt}function Gt(Le,lt,xt,Ot,jt,qt){var Jt=(qt-xt)/(jt-xt);return Le.push(lt+(Ot-lt)*Jt),Le.push(qt),Le.push(1),Jt}function dr(Le,lt){for(var xt=[],Ot=0;Ot<Le.length;Ot++){var jt,qt=Le[Ot],Jt=qt.type;if(Jt==="Point"||Jt==="MultiPoint"||Jt==="LineString")jt=Br(qt.geometry,lt);else if(Jt==="MultiLineString"||Jt==="Polygon"){jt=[];for(var Xt=0;Xt<qt.geometry.length;Xt++)jt.push(Br(qt.geometry[Xt],lt))}else if(Jt==="MultiPolygon")for(jt=[],Xt=0;Xt<qt.geometry.length;Xt++){for(var or=[],er=0;er<qt.geometry[Xt].length;er++)or.push(Br(qt.geometry[Xt][er],lt));jt.push(or)}xt.push(K(qt.id,Jt,jt,qt.tags))}return xt}function Br(Le,lt){var xt=[];xt.size=Le.size,Le.start!==void 0&&(xt.start=Le.start,xt.end=Le.end);for(var Ot=0;Ot<Le.length;Ot+=3)xt.push(Le[Ot]+lt,Le[Ot+1],Le[Ot+2]);return xt}function qr(Le,lt){if(Le.transformed)return Le;var xt,Ot,jt,qt=1<<Le.z,Jt=Le.x,Xt=Le.y;for(xt=0;xt<Le.features.length;xt++){var or=Le.features[xt],er=or.geometry,Ur=or.type;if(or.geometry=[],Ur===1)for(Ot=0;Ot<er.length;Ot+=2)or.geometry.push(Ci(er[Ot],er[Ot+1],lt,qt,Jt,Xt));else for(Ot=0;Ot<er.length;Ot++){var fn=[];for(jt=0;jt<er[Ot].length;jt+=2)fn.push(Ci(er[Ot][jt],er[Ot][jt+1],lt,qt,Jt,Xt));or.geometry.push(fn)}}return Le.transformed=!0,Le}function Ci(Le,lt,xt,Ot,jt,qt){return[Math.round(xt*(Le*Ot-jt)),Math.round(xt*(lt*Ot-qt))]}function Wi(Le,lt,xt,Ot,jt){for(var qt=lt===jt.maxZoom?0:jt.tolerance/((1<<lt)*jt.extent),Jt={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:xt,y:Ot,z:lt,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},Xt=0;Xt<Le.length;Xt++){Jt.numFeatures++,Fi(Jt,Le[Xt],qt,jt);var or=Le[Xt].minX,er=Le[Xt].minY,Ur=Le[Xt].maxX,fn=Le[Xt].maxY;or<Jt.minX&&(Jt.minX=or),er<Jt.minY&&(Jt.minY=er),Ur>Jt.maxX&&(Jt.maxX=Ur),fn>Jt.maxY&&(Jt.maxY=fn)}return Jt}function Fi(Le,lt,xt,Ot){var jt=lt.geometry,qt=lt.type,Jt=[];if(qt==="Point"||qt==="MultiPoint")for(var Xt=0;Xt<jt.length;Xt+=3)Jt.push(jt[Xt]),Jt.push(jt[Xt+1]),Le.numPoints++,Le.numSimplified++;else if(qt==="LineString")Ta(Jt,jt,Le,xt,!1,!1);else if(qt==="MultiLineString"||qt==="Polygon")for(Xt=0;Xt<jt.length;Xt++)Ta(Jt,jt[Xt],Le,xt,qt==="Polygon",Xt===0);else if(qt==="MultiPolygon")for(var or=0;or<jt.length;or++){var er=jt[or];for(Xt=0;Xt<er.length;Xt++)Ta(Jt,er[Xt],Le,xt,!0,Xt===0)}if(Jt.length){var Ur=lt.tags||null;if(qt==="LineString"&&Ot.lineMetrics){for(var fn in Ur={},lt.tags)Ur[fn]=lt.tags[fn];Ur.mapbox_clip_start=jt.start/jt.size,Ur.mapbox_clip_end=jt.end/jt.size}var Cr={geometry:Jt,type:qt==="Polygon"||qt==="MultiPolygon"?3:qt==="LineString"||qt==="MultiLineString"?2:1,tags:Ur};lt.id!==null&&(Cr.id=lt.id),Le.features.push(Cr)}}function Ta(Le,lt,xt,Ot,jt,qt){var Jt=Ot*Ot;if(Ot>0&&lt.size<(jt?Jt:Ot))xt.numPoints+=lt.length/3;else{for(var Xt=[],or=0;or<lt.length;or+=3)(Ot===0||lt[or+2]>Jt)&&(xt.numSimplified++,Xt.push(lt[or]),Xt.push(lt[or+1])),xt.numPoints++;jt&&function(er,Ur){for(var fn=0,Cr=0,_e=er.length,qe=_e-2;Cr<_e;qe=Cr,Cr+=2)fn+=(er[Cr]-er[qe])*(er[Cr+1]+er[qe+1]);if(fn>0===Ur)for(Cr=0,_e=er.length;Cr<_e/2;Cr+=2){var Ue=er[Cr],je=er[Cr+1];er[Cr]=er[_e-2-Cr],er[Cr+1]=er[_e-1-Cr],er[_e-2-Cr]=Ue,er[_e-1-Cr]=je}}(Xt,qt),Le.push(Xt)}}function Sa(Le,lt){var xt=(lt=this.options=function(jt,qt){for(var Jt in qt)jt[Jt]=qt[Jt];return jt}(Object.create(this.options),lt)).debug;if(xt&&console.time("preprocess data"),lt.maxZoom<0||lt.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(lt.promoteId&&lt.generateId)throw new Error("promoteId and generateId cannot be used together.");var Ot=function(jt,qt){var Jt=[];if(jt.type==="FeatureCollection")for(var Xt=0;Xt<jt.features.length;Xt++)Ae(Jt,jt.features[Xt],qt,Xt);else Ae(Jt,jt.type==="Feature"?jt:{geometry:jt},qt);return Jt}(Le,lt);this.tiles={},this.tileCoords=[],xt&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",lt.indexMaxZoom,lt.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(Ot=function(jt,qt){var Jt=qt.buffer/qt.extent,Xt=jt,or=ct(jt,1,-1-Jt,Jt,0,-1,2,qt),er=ct(jt,1,1-Jt,2+Jt,0,-1,2,qt);return(or||er)&&(Xt=ct(jt,1,-Jt,1+Jt,0,-1,2,qt)||[],or&&(Xt=dr(or,1).concat(Xt)),er&&(Xt=Xt.concat(dr(er,-1)))),Xt}(Ot,lt)).length&&this.splitTile(Ot,0,0,0),xt&&(Ot.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function Ai(Le,lt,xt){return 32*((1<<Le)*xt+lt)+Le}return Sa.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Sa.prototype.splitTile=function(Le,lt,xt,Ot,jt,qt,Jt){for(var Xt=[Le,lt,xt,Ot],or=this.options,er=or.debug;Xt.length;){Ot=Xt.pop(),xt=Xt.pop(),lt=Xt.pop(),Le=Xt.pop();var Ur=1<<lt,fn=Ai(lt,xt,Ot),Cr=this.tiles[fn];if(!Cr&&(er>1&&console.time("creation"),Cr=this.tiles[fn]=Wi(Le,lt,xt,Ot,or),this.tileCoords.push({z:lt,x:xt,y:Ot}),er)){er>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",lt,xt,Ot,Cr.numFeatures,Cr.numPoints,Cr.numSimplified),console.timeEnd("creation"));var _e="z"+lt;this.stats[_e]=(this.stats[_e]||0)+1,this.total++}if(Cr.source=Le,jt){if(lt===or.maxZoom||lt===jt)continue;var qe=1<<jt-lt;if(xt!==Math.floor(qt/qe)||Ot!==Math.floor(Jt/qe))continue}else if(lt===or.indexMaxZoom||Cr.numPoints<=or.indexMaxPoints)continue;if(Cr.source=null,Le.length!==0){er>1&&console.time("clipping");var Ue,je,Ke,nt,It,Bt,kt=.5*or.buffer/or.extent,Dt=.5-kt,Rt=.5+kt,fr=1+kt;Ue=je=Ke=nt=null,It=ct(Le,Ur,xt-kt,xt+Rt,0,Cr.minX,Cr.maxX,or),Bt=ct(Le,Ur,xt+Dt,xt+fr,0,Cr.minX,Cr.maxX,or),Le=null,It&&(Ue=ct(It,Ur,Ot-kt,Ot+Rt,1,Cr.minY,Cr.maxY,or),je=ct(It,Ur,Ot+Dt,Ot+fr,1,Cr.minY,Cr.maxY,or),It=null),Bt&&(Ke=ct(Bt,Ur,Ot-kt,Ot+Rt,1,Cr.minY,Cr.maxY,or),nt=ct(Bt,Ur,Ot+Dt,Ot+fr,1,Cr.minY,Cr.maxY,or),Bt=null),er>1&&console.timeEnd("clipping"),Xt.push(Ue||[],lt+1,2*xt,2*Ot),Xt.push(je||[],lt+1,2*xt,2*Ot+1),Xt.push(Ke||[],lt+1,2*xt+1,2*Ot),Xt.push(nt||[],lt+1,2*xt+1,2*Ot+1)}}},Sa.prototype.getTile=function(Le,lt,xt){var Ot=this.options,jt=Ot.extent,qt=Ot.debug;if(Le<0||Le>24)return null;var Jt=1<<Le,Xt=Ai(Le,lt=(lt%Jt+Jt)%Jt,xt);if(this.tiles[Xt])return qr(this.tiles[Xt],jt);qt>1&&console.log("drilling down to z%d-%d-%d",Le,lt,xt);for(var or,er=Le,Ur=lt,fn=xt;!or&&er>0;)er--,Ur=Math.floor(Ur/2),fn=Math.floor(fn/2),or=this.tiles[Ai(er,Ur,fn)];return or&&or.source?(qt>1&&console.log("found parent tile z%d-%d-%d",er,Ur,fn),qt>1&&console.time("drilling down"),this.splitTile(or.source,er,Ur,fn,Le,lt,xt),qt>1&&console.timeEnd("drilling down"),this.tiles[Xt]?qr(this.tiles[Xt],jt):null):null},function(Le,lt){return new Sa(Le,lt)}}();var pe=p.g(fe.exports);function ot(he,G){const K=he.tileID.canonical;if(!this._geoJSONIndex)return G(null,null);const se=this._geoJSONIndex.getTile(K.z,K.x,K.y);if(!se)return G(null,null);const Ae=new class{constructor(ye){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=p.E,this.length=ye.length,this._features=ye}feature(ye){return new class{constructor(Xe){this._feature=Xe,this.extent=p.E,this.type=Xe.type,this.properties=Xe.tags,"id"in Xe&&!isNaN(Xe.id)&&(this.id=parseInt(Xe.id,10))}loadGeometry(){if(this._feature.type===1){const Xe=[];for(const be of this._feature.geometry)Xe.push([new p.P(be[0],be[1])]);return Xe}{const Xe=[];for(const be of this._feature.geometry){const Be=[];for(const ct of be)Be.push(new p.P(ct[0],ct[1]));Xe.push(Be)}return Xe}}toGeoJSON(Xe,be,Be){return A.call(this,Xe,be,Be)}}(this._features[ye])}}(se.features);let Se=Ye(Ae);Se.byteOffset===0&&Se.byteLength===Se.buffer.byteLength||(Se=new Uint8Array(Se)),G(null,{vectorTile:Ae,rawData:Se.buffer})}class xe extends p.d{constructor(G,K,se,Ae,Se,ye){super(G,K,se,Ae,ot,ye),Se&&(this.loadGeoJSON=Se)}loadData(G,K){const se=G&&G.request,Ae=se&&se.collectResourceTiming;this.loadGeoJSON(G,(Se,ye)=>{if(Se||!ye)return K(Se);if(typeof ye!="object")return K(new Error(`Input data given to '${G.source}' is not a valid GeoJSON object.`));{I(ye,!0);try{if(G.filter){const be=p.e(G.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(be.result==="error")throw new Error(be.value.map(ct=>`${ct.key}: ${ct.message}`).join(", "));ye={type:"FeatureCollection",features:ye.features.filter(ct=>be.value.evaluate({zoom:0},ct))}}this._geoJSONIndex=G.cluster?new rt(function({superclusterOptions:be,clusterProperties:Be}){if(!Be||!be)return be;const ct={},At={},$t={accumulated:null,zoom:0},mr={properties:null},Nt=Object.keys(Be);for(const Lt of Nt){const[Qt,Gt]=Be[Lt],dr=p.e(Gt),Br=p.e(typeof Qt=="string"?[Qt,["accumulated"],["get",Lt]]:Qt);ct[Lt]=dr.value,At[Lt]=Br.value}return be.map=Lt=>{mr.properties=Lt;const Qt={};for(const Gt of Nt)Qt[Gt]=ct[Gt].evaluate($t,mr);return Qt},be.reduce=(Lt,Qt)=>{mr.properties=Qt;for(const Gt of Nt)$t.accumulated=Lt[Gt],Lt[Gt]=At[Gt].evaluate($t,mr)},be}(G)).load(ye.features):pe(ye,G.geojsonVtOptions)}catch(be){return K(be)}this.loaded={};const Xe={};if(Ae){const be=p.f(se);be&&(Xe.resourceTiming={},Xe.resourceTiming[G.source]=JSON.parse(JSON.stringify(be)))}K(null,Xe)}})}reloadTile(G,K){const se=this.loaded;return se&&se[G.uid]?super.reloadTile(G,K):this.loadTile(G,K)}loadGeoJSON(G,K){if(G.request)p.h(G.request,K);else{if(typeof G.data!="string")return K(new Error(`Input data given to '${G.source}' is not a valid GeoJSON object.`));try{return K(null,JSON.parse(G.data))}catch{return K(new Error(`Input data given to '${G.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(G,K){try{K(null,this._geoJSONIndex.getClusterExpansionZoom(G.clusterId))}catch(se){K(se)}}getClusterChildren(G,K){try{K(null,this._geoJSONIndex.getChildren(G.clusterId))}catch(se){K(se)}}getClusterLeaves(G,K){try{K(null,this._geoJSONIndex.getLeaves(G.clusterId,G.limit,G.offset))}catch(se){K(se)}}}class ae{constructor(G,K){this.tileID=new p.O(G.tileID.overscaledZ,G.tileID.wrap,G.tileID.canonical.z,G.tileID.canonical.x,G.tileID.canonical.y),this.tileZoom=G.tileZoom,this.uid=G.uid,this.zoom=G.zoom,this.canonical=G.tileID.canonical,this.pixelRatio=G.pixelRatio,this.tileSize=G.tileSize,this.source=G.source,this.overscaling=this.tileID.overscaleFactor(),this.projection=G.projection,this.brightness=K}parse(G,K,se,Ae){this.status="parsing";const Se=new p.O(se.tileID.overscaledZ,se.tileID.wrap,se.tileID.canonical.z,se.tileID.canonical.x,se.tileID.canonical.y),ye={},Xe=K.familiesBySource[se.source],be=new p.F(Se,se.promoteId);return be.bucketLayerIDs=[],p.l(G).then(Be=>{if(!Be)return Ae(new Error("Could not parse tile"));const ct=p.j(Be,1/p.t(se.tileID.canonical)),At=Be.json.extensionsUsed&&Be.json.extensionsUsed.includes("MAPBOX_mesh_features"),$t=new p.k(this.zoom,{brightness:this.brightness});for(const mr in Xe)for(const Nt of Xe[mr]){const Lt=Nt[0],Qt=Be.json.extensionsUsed;Lt.recalculate($t,[]);const Gt=new p.T(ct,Se,Qt&&Qt.includes("MAPBOX_mesh_features"),this.brightness);At||(Gt.needsUpload=!0),ye[Lt.fqid]=Gt,Gt.evaluate(Lt)}this.status="done",Ae(null,{buckets:ye,featureIndex:be})}).catch(Be=>Ae(new Error(Be.message)))}}class X{constructor(G,K,se,Ae,Se,ye){this.actor=G,this.layerIndex=K,this.brightness=ye,this.loading={},this.loaded={}}loadTile(G,K){const se=G.uid,Ae=this.loading[se]=new ae(G,this.brightness);p.i(G.request,(Se,ye)=>{const Xe=!this.loading[se];return delete this.loading[se],Xe||Se?(Ae.status="done",Xe||(this.loaded[se]=Ae),K(Se)):ye&&ye.byteLength!==0?void Ae.parse(ye,this.layerIndex,G,(be,Be)=>{Ae.status="done",this.loaded=this.loaded||{},this.loaded[se]=Ae,be||!Be?K(be):K(null,Be)}):(Ae.status="done",this.loaded[se]=Ae,K())})}reloadTile(G,K){const se=this.loaded,Ae=G.uid;if(se&&se[Ae]){const Se=se[Ae];Se.projection=G.projection,Se.brightness=G.brightness;const ye=(Xe,be)=>{Se.reloadCallback&&(delete Se.reloadCallback,this.loadTile(G,K)),K(Xe,be)};Se.status==="parsing"?Se.reloadCallback=ye:Se.status==="done"&&this.loadTile(G,K)}}abortTile(G,K){const se=G.uid;this.loading[se]&&delete this.loading[se],K()}removeTile(G,K){const se=this.loaded,Ae=G.uid;se&&se[Ae]&&delete se[Ae],K()}}class Ce{constructor(G){this.self=G,this.actor=new p.A(G,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=p.m({name:"mercator"}),this.workerSourceTypes={vector:p.d,geojson:xe,"batched-model":X},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(K,se)=>{if(this.workerSourceTypes[K])throw new Error(`Worker source with name "${K}" already registered.`);this.workerSourceTypes[K]=se},this.self.registerRTLTextPlugin=K=>{if(p.n.isParsed())throw new Error("RTL text plugin already registered.");p.n.applyArabicShaping=K.applyArabicShaping,p.n.processBidirectionalText=K.processBidirectionalText,p.n.processStyledBidirectionalText=K.processStyledBidirectionalText}}clearCaches(G,K,se){delete this.layerIndexes[G],delete this.availableImages[G],delete this.workerSources[G],delete this.demWorkerSources[G],se()}checkIfReady(G,K,se){se()}setReferrer(G,K){this.referrer=K}spriteLoaded(G,{scope:K,isLoaded:se}){if(this.isSpriteLoaded[G]||(this.isSpriteLoaded[G]={}),this.isSpriteLoaded[G][K]=se,this.workerSources[G]&&this.workerSources[G][K])for(const Ae in this.workerSources[G][K]){const Se=this.workerSources[G][K][Ae];for(const ye in Se)Se[ye]instanceof p.d&&(Se[ye].isSpriteLoaded=se,Se[ye].fire(new p.o("isSpriteLoaded")))}}setImages(G,{scope:K,images:se},Ae){if(this.availableImages[G]||(this.availableImages[G]={}),this.availableImages[G][K]=se,this.workerSources[G]&&this.workerSources[G][K]){for(const Se in this.workerSources[G][K]){const ye=this.workerSources[G][K][Se];for(const Xe in ye)ye[Xe].availableImages=se}Ae()}else Ae()}setProjection(G,K){this.projections[G]=p.m(K)}setBrightness(G,K,se){this.brightness=K,se()}setLayers(G,K,se){this.getLayerIndex(G,K.scope).replace(K.layers,K.options),se()}updateLayers(G,K,se){this.getLayerIndex(G,K.scope).update(K.layers,K.removedIds,K.options),se()}loadTile(G,K,se){K.projection=this.projections[G]||this.defaultProjection,this.getWorkerSource(G,K.type,K.source,K.scope).loadTile(K,se)}loadDEMTile(G,K,se){this.getDEMWorkerSource(G,K.source,K.scope).loadTile(K,se)}reloadTile(G,K,se){K.projection=this.projections[G]||this.defaultProjection,this.getWorkerSource(G,K.type,K.source,K.scope).reloadTile(K,se)}abortTile(G,K,se){this.getWorkerSource(G,K.type,K.source,K.scope).abortTile(K,se)}removeTile(G,K,se){this.getWorkerSource(G,K.type,K.source,K.scope).removeTile(K,se)}removeSource(G,K,se){if(!(this.workerSources[G]&&this.workerSources[G][K.scope]&&this.workerSources[G][K.scope][K.type]&&this.workerSources[G][K.scope][K.type][K.source]))return;const Ae=this.workerSources[G][K.scope][K.type][K.source];delete this.workerSources[G][K.scope][K.type][K.source],Ae.removeSource!==void 0?Ae.removeSource(K,se):se()}loadWorkerSource(G,K,se){try{this.self.importScripts(K.url),se()}catch(Ae){se(Ae.toString())}}syncRTLPluginState(G,K,se){try{p.n.setState(K);const Ae=p.n.getPluginURL();if(p.n.isLoaded()&&!p.n.isParsed()&&Ae!=null){this.self.importScripts(Ae);const Se=p.n.isParsed();se(Se?void 0:new Error(`RTL Text Plugin failed to import scripts from ${Ae}`),Se)}}catch(Ae){se(Ae.toString())}}setDracoUrl(G,K){this.dracoUrl=K}getAvailableImages(G,K){this.availableImages[G]||(this.availableImages[G]={});let se=this.availableImages[G][K];return se||(se=[]),se}getLayerIndex(G,K){this.layerIndexes[G]||(this.layerIndexes[G]={});let se=this.layerIndexes[G][K];return se||(se=this.layerIndexes[G][K]=new b,se.scope=K),se}getWorkerSource(G,K,se,Ae){if(this.workerSources[G]||(this.workerSources[G]={}),this.workerSources[G][Ae]||(this.workerSources[G][Ae]={}),this.workerSources[G][Ae][K]||(this.workerSources[G][Ae][K]={}),this.isSpriteLoaded[G]||(this.isSpriteLoaded[G]={}),!this.workerSources[G][Ae][K][se]){const Se={send:(ye,Xe,be,Be,ct,At)=>{this.actor.send(ye,Xe,be,G,ct,At)},scheduler:this.actor.scheduler};this.workerSources[G][Ae][K][se]=new this.workerSourceTypes[K](Se,this.getLayerIndex(G,Ae),this.getAvailableImages(G,Ae),this.isSpriteLoaded[G][Ae],void 0,this.brightness)}return this.workerSources[G][Ae][K][se]}getDEMWorkerSource(G,K,se){return this.demWorkerSources[G]||(this.demWorkerSources[G]={}),this.demWorkerSources[G][se]||(this.demWorkerSources[G][se]={}),this.demWorkerSources[G][se][K]||(this.demWorkerSources[G][se][K]=new E),this.demWorkerSources[G][se][K]}enforceCacheSizeLimit(G,K){p.q(K)}getWorkerPerformanceMetrics(G,K,se){se(void 0,void 0)}}return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new Ce(self)),Ce}),f(["./shared"],function(p){return p.s});var d=c;return d})})(_U);var O_e=_U.exports;const rx=qb(O_e);var yU={exports:{}};(function(t,n){(function(a,s){t.exports=s()})($o,function(){var a=function(U,ne){var Te={drag:[],click:[],mousemove:[],mousedown:[],mouseup:[],mouseout:[],keydown:[],keyup:[],touchstart:[],touchmove:[],touchend:[],tap:[]},it={on:function(vt,wt,sr){if(Te[vt]===void 0)throw new Error("Invalid event type: "+vt);Te[vt].push({selector:wt,fn:sr})},render:function(vt){ne.store.featureChanged(vt)}},mt=function(vt,wt){for(var sr=Te[vt],_r=sr.length;_r--;){var Fr=sr[_r];if(Fr.selector(wt)){Fr.fn.call(it,wt)||ne.store.render(),ne.ui.updateMapClasses();break}}};return U.start.call(it),{render:U.render,stop:function(){U.stop&&U.stop()},trash:function(){U.trash&&(U.trash(),ne.store.render())},combineFeatures:function(){U.combineFeatures&&U.combineFeatures()},uncombineFeatures:function(){U.uncombineFeatures&&U.uncombineFeatures()},drag:function(vt){mt("drag",vt)},click:function(vt){mt("click",vt)},mousemove:function(vt){mt("mousemove",vt)},mousedown:function(vt){mt("mousedown",vt)},mouseup:function(vt){mt("mouseup",vt)},mouseout:function(vt){mt("mouseout",vt)},keydown:function(vt){mt("keydown",vt)},keyup:function(vt){mt("keyup",vt)},touchstart:function(vt){mt("touchstart",vt)},touchmove:function(vt){mt("touchmove",vt)},touchend:function(vt){mt("touchend",vt)},tap:function(vt){mt("tap",vt)}}};function s(U){return U&&U.__esModule&&Object.prototype.hasOwnProperty.call(U,"default")?U.default:U}function c(U){if(U.__esModule)return U;var ne=U.default;if(typeof ne=="function"){var Te=function it(){if(this instanceof it){var mt=[null];mt.push.apply(mt,arguments);var vt=Function.bind.apply(ne,mt);return new vt}return ne.apply(this,arguments)};Te.prototype=ne.prototype}else Te={};return Object.defineProperty(Te,"__esModule",{value:!0}),Object.keys(U).forEach(function(it){var mt=Object.getOwnPropertyDescriptor(U,it);Object.defineProperty(Te,it,mt.get?mt:{enumerable:!0,get:function(){return U[it]}})}),Te}var f={},d={RADIUS:6378137,FLATTENING:1/298.257223563,POLAR_RADIUS:63567523142e-4},p=d;function g(U){var ne=0;if(U&&U.length>0){ne+=Math.abs(y(U[0]));for(var Te=1;Te<U.length;Te++)ne-=Math.abs(y(U[Te]))}return ne}function y(U){var ne,Te,it,mt,vt,wt,sr=0,_r=U.length;if(_r>2){for(wt=0;wt<_r;wt++)wt===_r-2?(it=_r-2,mt=_r-1,vt=0):wt===_r-1?(it=_r-1,mt=0,vt=1):(it=wt,mt=wt+1,vt=wt+2),ne=U[it],Te=U[mt],sr+=(b(U[vt][0])-b(ne[0]))*Math.sin(b(Te[1]));sr=sr*p.RADIUS*p.RADIUS/2}return sr}function b(U){return U*Math.PI/180}f.geometry=function U(ne){var Te,it=0;switch(ne.type){case"Polygon":return g(ne.coordinates);case"MultiPolygon":for(Te=0;Te<ne.coordinates.length;Te++)it+=g(ne.coordinates[Te]);return it;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0;case"GeometryCollection":for(Te=0;Te<ne.geometries.length;Te++)it+=U(ne.geometries[Te]);return it}},f.ring=y;var E={CONTROL_BASE:"mapboxgl-ctrl",CONTROL_PREFIX:"mapboxgl-ctrl-",CONTROL_BUTTON:"mapbox-gl-draw_ctrl-draw-btn",CONTROL_BUTTON_LINE:"mapbox-gl-draw_line",CONTROL_BUTTON_POLYGON:"mapbox-gl-draw_polygon",CONTROL_BUTTON_POINT:"mapbox-gl-draw_point",CONTROL_BUTTON_TRASH:"mapbox-gl-draw_trash",CONTROL_BUTTON_COMBINE_FEATURES:"mapbox-gl-draw_combine",CONTROL_BUTTON_UNCOMBINE_FEATURES:"mapbox-gl-draw_uncombine",CONTROL_GROUP:"mapboxgl-ctrl-group",ATTRIBUTION:"mapboxgl-ctrl-attrib",ACTIVE_BUTTON:"active",BOX_SELECT:"mapbox-gl-draw_boxselect"},T={HOT:"mapbox-gl-draw-hot",COLD:"mapbox-gl-draw-cold"},S={ADD:"add",MOVE:"move",DRAG:"drag",POINTER:"pointer",NONE:"none"},I={POLYGON:"polygon",LINE:"line_string",POINT:"point"},A={FEATURE:"Feature",POLYGON:"Polygon",LINE_STRING:"LineString",POINT:"Point",FEATURE_COLLECTION:"FeatureCollection",MULTI_PREFIX:"Multi",MULTI_POINT:"MultiPoint",MULTI_LINE_STRING:"MultiLineString",MULTI_POLYGON:"MultiPolygon"},M={DRAW_LINE_STRING:"draw_line_string",DRAW_POLYGON:"draw_polygon",DRAW_POINT:"draw_point",SIMPLE_SELECT:"simple_select",DIRECT_SELECT:"direct_select",STATIC:"static"},F={CREATE:"draw.create",DELETE:"draw.delete",UPDATE:"draw.update",SELECTION_CHANGE:"draw.selectionchange",MODE_CHANGE:"draw.modechange",ACTIONABLE:"draw.actionable",RENDER:"draw.render",COMBINE_FEATURES:"draw.combine",UNCOMBINE_FEATURES:"draw.uncombine"},L={MOVE:"move",CHANGE_COORDINATES:"change_coordinates"},O={FEATURE:"feature",MIDPOINT:"midpoint",VERTEX:"vertex"},N={ACTIVE:"true",INACTIVE:"false"},Q=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate"],ie=-85,j=Object.freeze({__proto__:null,classes:E,sources:T,cursors:S,types:I,geojsonTypes:A,modes:M,events:F,updateActions:L,meta:O,activeStates:N,interactions:Q,LAT_MIN:-90,LAT_RENDERED_MIN:ie,LAT_MAX:90,LAT_RENDERED_MAX:85,LNG_MIN:-270,LNG_MAX:270}),V={Point:0,LineString:1,MultiLineString:1,Polygon:2};function D(U,ne){var Te=V[U.geometry.type]-V[ne.geometry.type];return Te===0&&U.geometry.type===A.POLYGON?U.area-ne.area:Te}function te(U){return U.map(function(ne){return ne.geometry.type===A.POLYGON&&(ne.area=f.geometry({type:A.FEATURE,property:{},geometry:ne.geometry})),ne}).sort(D).map(function(ne){return delete ne.area,ne})}function ue(U,ne){return ne===void 0&&(ne=0),[[U.point.x-ne,U.point.y-ne],[U.point.x+ne,U.point.y+ne]]}function J(U){if(this._items={},this._nums={},this._length=U?U.length:0,U)for(var ne=0,Te=U.length;ne<Te;ne++)this.add(U[ne]),U[ne]!==void 0&&(typeof U[ne]=="string"?this._items[U[ne]]=ne:this._nums[U[ne]]=ne)}J.prototype.add=function(U){return this.has(U)||(this._length++,typeof U=="string"?this._items[U]=this._length:this._nums[U]=this._length),this},J.prototype.delete=function(U){return this.has(U)===!1||(this._length--,delete this._items[U],delete this._nums[U]),this},J.prototype.has=function(U){return(typeof U=="string"||typeof U=="number")&&(this._items[U]!==void 0||this._nums[U]!==void 0)},J.prototype.values=function(){var U=this,ne=[];return Object.keys(this._items).forEach(function(Te){ne.push({k:Te,v:U._items[Te]})}),Object.keys(this._nums).forEach(function(Te){ne.push({k:JSON.parse(Te),v:U._nums[Te]})}),ne.sort(function(Te,it){return Te.v-it.v}).map(function(Te){return Te.k})},J.prototype.clear=function(){return this._length=0,this._items={},this._nums={},this};var le=[O.FEATURE,O.MIDPOINT,O.VERTEX],re={click:function(U,ne,Te){return Fe(U,ne,Te,Te.options.clickBuffer)},touch:function(U,ne,Te){return Fe(U,ne,Te,Te.options.touchBuffer)}};function Fe(U,ne,Te,it){if(Te.map===null)return[];var mt=U?ue(U,it):ne,vt={};Te.options.styles&&(vt.layers=Te.options.styles.map(function(Fr){return Fr.id}).filter(function(Fr){return Te.map.getLayer(Fr)!=null}));var wt=Te.map.queryRenderedFeatures(mt,vt).filter(function(Fr){return le.indexOf(Fr.properties.meta)!==-1}),sr=new J,_r=[];return wt.forEach(function(Fr){var Ir=Fr.properties.id;sr.has(Ir)||(sr.add(Ir),_r.push(Fr))}),te(_r)}function Ye(U,ne){var Te=re.click(U,null,ne),it={mouse:S.NONE};return Te[0]&&(it.mouse=Te[0].properties.active===N.ACTIVE?S.MOVE:S.POINTER,it.feature=Te[0].properties.meta),ne.events.currentModeName().indexOf("draw")!==-1&&(it.mouse=S.ADD),ne.ui.queueMapClasses(it),ne.ui.updateMapClasses(),Te[0]}function Ee(U,ne){var Te=U.x-ne.x,it=U.y-ne.y;return Math.sqrt(Te*Te+it*it)}function ut(U,ne,Te){Te===void 0&&(Te={});var it=Te.fineTolerance!=null?Te.fineTolerance:4,mt=Te.grossTolerance!=null?Te.grossTolerance:12,vt=Te.interval!=null?Te.interval:500;U.point=U.point||ne.point,U.time=U.time||ne.time;var wt=Ee(U.point,ne.point);return wt<it||wt<mt&&ne.time-U.time<vt}function Ne(U,ne,Te){Te===void 0&&(Te={});var it=Te.tolerance!=null?Te.tolerance:25,mt=Te.interval!=null?Te.interval:250;return U.point=U.point||ne.point,U.time=U.time||ne.time,Ee(U.point,ne.point)<it&&ne.time-U.time<mt}var He={exports:{}},Oe=He.exports=function(U,ne){if(ne||(ne=16),U===void 0&&(U=128),U<=0)return"0";for(var Te=Math.log(Math.pow(2,U))/Math.log(ne),it=2;Te===1/0;it*=2)Te=Math.log(Math.pow(2,U/it))/Math.log(ne)*it;var mt=Te-Math.floor(Te),vt="";for(it=0;it<Math.floor(Te);it++)vt=Math.floor(Math.random()*ne).toString(ne)+vt;if(mt){var wt=Math.pow(ne,mt);vt=Math.floor(Math.random()*wt).toString(ne)+vt}var sr=parseInt(vt,ne);return sr!==1/0&&sr>=Math.pow(2,U)?Oe(U,ne):vt};Oe.rack=function(U,ne,Te){var it=function(vt){var wt=0;do{if(wt++>10){if(!Te)throw new Error("too many ID collisions, use more bits");U+=Te}var sr=Oe(U,ne)}while(Object.hasOwnProperty.call(mt,sr));return mt[sr]=vt,sr},mt=it.hats={};return it.get=function(vt){return it.hats[vt]},it.set=function(vt,wt){return it.hats[vt]=wt,it},it.bits=U||128,it.base=ne||16,it};var Pe=s(He.exports),rt=function(U,ne){this.ctx=U,this.properties=ne.properties||{},this.coordinates=ne.geometry.coordinates,this.id=ne.id||Pe(),this.type=ne.geometry.type};rt.prototype.changed=function(){this.ctx.store.featureChanged(this.id)},rt.prototype.incomingCoords=function(U){this.setCoordinates(U)},rt.prototype.setCoordinates=function(U){this.coordinates=U,this.changed()},rt.prototype.getCoordinates=function(){return JSON.parse(JSON.stringify(this.coordinates))},rt.prototype.setProperty=function(U,ne){this.properties[U]=ne},rt.prototype.toGeoJSON=function(){return JSON.parse(JSON.stringify({id:this.id,type:A.FEATURE,properties:this.properties,geometry:{coordinates:this.getCoordinates(),type:this.type}}))},rt.prototype.internal=function(U){var ne={id:this.id,meta:O.FEATURE,"meta:type":this.type,active:N.INACTIVE,mode:U};if(this.ctx.options.userProperties)for(var Te in this.properties)ne["user_"+Te]=this.properties[Te];return{type:A.FEATURE,properties:ne,geometry:{coordinates:this.getCoordinates(),type:this.type}}};var et=function(U,ne){rt.call(this,U,ne)};(et.prototype=Object.create(rt.prototype)).isValid=function(){return typeof this.coordinates[0]=="number"&&typeof this.coordinates[1]=="number"},et.prototype.updateCoordinate=function(U,ne,Te){this.coordinates=arguments.length===3?[ne,Te]:[U,ne],this.changed()},et.prototype.getCoordinate=function(){return this.getCoordinates()};var Ge=function(U,ne){rt.call(this,U,ne)};(Ge.prototype=Object.create(rt.prototype)).isValid=function(){return this.coordinates.length>1},Ge.prototype.addCoordinate=function(U,ne,Te){this.changed();var it=parseInt(U,10);this.coordinates.splice(it,0,[ne,Te])},Ge.prototype.getCoordinate=function(U){var ne=parseInt(U,10);return JSON.parse(JSON.stringify(this.coordinates[ne]))},Ge.prototype.removeCoordinate=function(U){this.changed(),this.coordinates.splice(parseInt(U,10),1)},Ge.prototype.updateCoordinate=function(U,ne,Te){var it=parseInt(U,10);this.coordinates[it]=[ne,Te],this.changed()};var ze=function(U,ne){rt.call(this,U,ne),this.coordinates=this.coordinates.map(function(Te){return Te.slice(0,-1)})};(ze.prototype=Object.create(rt.prototype)).isValid=function(){return this.coordinates.length!==0&&this.coordinates.every(function(U){return U.length>2})},ze.prototype.incomingCoords=function(U){this.coordinates=U.map(function(ne){return ne.slice(0,-1)}),this.changed()},ze.prototype.setCoordinates=function(U){this.coordinates=U,this.changed()},ze.prototype.addCoordinate=function(U,ne,Te){this.changed();var it=U.split(".").map(function(mt){return parseInt(mt,10)});this.coordinates[it[0]].splice(it[1],0,[ne,Te])},ze.prototype.removeCoordinate=function(U){this.changed();var ne=U.split(".").map(function(it){return parseInt(it,10)}),Te=this.coordinates[ne[0]];Te&&(Te.splice(ne[1],1),Te.length<3&&this.coordinates.splice(ne[0],1))},ze.prototype.getCoordinate=function(U){var ne=U.split(".").map(function(it){return parseInt(it,10)}),Te=this.coordinates[ne[0]];return JSON.parse(JSON.stringify(Te[ne[1]]))},ze.prototype.getCoordinates=function(){return this.coordinates.map(function(U){return U.concat([U[0]])})},ze.prototype.updateCoordinate=function(U,ne,Te){this.changed();var it=U.split("."),mt=parseInt(it[0],10),vt=parseInt(it[1],10);this.coordinates[mt]===void 0&&(this.coordinates[mt]=[]),this.coordinates[mt][vt]=[ne,Te]};var oe={MultiPoint:et,MultiLineString:Ge,MultiPolygon:ze},Me=function(U,ne,Te,it,mt){var vt=Te.split("."),wt=parseInt(vt[0],10),sr=vt[1]?vt.slice(1).join("."):null;return U[wt][ne](sr,it,mt)},fe=function(U,ne){if(rt.call(this,U,ne),delete this.coordinates,this.model=oe[ne.geometry.type],this.model===void 0)throw new TypeError(ne.geometry.type+" is not a valid type");this.features=this._coordinatesToFeatures(ne.geometry.coordinates)};function pe(U){this.map=U.map,this.drawConfig=JSON.parse(JSON.stringify(U.options||{})),this._ctx=U}(fe.prototype=Object.create(rt.prototype))._coordinatesToFeatures=function(U){var ne=this,Te=this.model.bind(this);return U.map(function(it){return new Te(ne.ctx,{id:Pe(),type:A.FEATURE,properties:{},geometry:{coordinates:it,type:ne.type.replace("Multi","")}})})},fe.prototype.isValid=function(){return this.features.every(function(U){return U.isValid()})},fe.prototype.setCoordinates=function(U){this.features=this._coordinatesToFeatures(U),this.changed()},fe.prototype.getCoordinate=function(U){return Me(this.features,"getCoordinate",U)},fe.prototype.getCoordinates=function(){return JSON.parse(JSON.stringify(this.features.map(function(U){return U.type===A.POLYGON?U.getCoordinates():U.coordinates})))},fe.prototype.updateCoordinate=function(U,ne,Te){Me(this.features,"updateCoordinate",U,ne,Te),this.changed()},fe.prototype.addCoordinate=function(U,ne,Te){Me(this.features,"addCoordinate",U,ne,Te),this.changed()},fe.prototype.removeCoordinate=function(U){Me(this.features,"removeCoordinate",U),this.changed()},fe.prototype.getFeatures=function(){return this.features},pe.prototype.setSelected=function(U){return this._ctx.store.setSelected(U)},pe.prototype.setSelectedCoordinates=function(U){var ne=this;this._ctx.store.setSelectedCoordinates(U),U.reduce(function(Te,it){return Te[it.feature_id]===void 0&&(Te[it.feature_id]=!0,ne._ctx.store.get(it.feature_id).changed()),Te},{})},pe.prototype.getSelected=function(){return this._ctx.store.getSelected()},pe.prototype.getSelectedIds=function(){return this._ctx.store.getSelectedIds()},pe.prototype.isSelected=function(U){return this._ctx.store.isSelected(U)},pe.prototype.getFeature=function(U){return this._ctx.store.get(U)},pe.prototype.select=function(U){return this._ctx.store.select(U)},pe.prototype.deselect=function(U){return this._ctx.store.deselect(U)},pe.prototype.deleteFeature=function(U,ne){return ne===void 0&&(ne={}),this._ctx.store.delete(U,ne)},pe.prototype.addFeature=function(U){return this._ctx.store.add(U)},pe.prototype.clearSelectedFeatures=function(){return this._ctx.store.clearSelected()},pe.prototype.clearSelectedCoordinates=function(){return this._ctx.store.clearSelectedCoordinates()},pe.prototype.setActionableState=function(U){U===void 0&&(U={});var ne={trash:U.trash||!1,combineFeatures:U.combineFeatures||!1,uncombineFeatures:U.uncombineFeatures||!1};return this._ctx.events.actionable(ne)},pe.prototype.changeMode=function(U,ne,Te){return ne===void 0&&(ne={}),Te===void 0&&(Te={}),this._ctx.events.changeMode(U,ne,Te)},pe.prototype.updateUIClasses=function(U){return this._ctx.ui.queueMapClasses(U)},pe.prototype.activateUIButton=function(U){return this._ctx.ui.setActiveButton(U)},pe.prototype.featuresAt=function(U,ne,Te){if(Te===void 0&&(Te="click"),Te!=="click"&&Te!=="touch")throw new Error("invalid buffer type");return re[Te](U,ne,this._ctx)},pe.prototype.newFeature=function(U){var ne=U.geometry.type;return ne===A.POINT?new et(this._ctx,U):ne===A.LINE_STRING?new Ge(this._ctx,U):ne===A.POLYGON?new ze(this._ctx,U):new fe(this._ctx,U)},pe.prototype.isInstanceOf=function(U,ne){if(U===A.POINT)return ne instanceof et;if(U===A.LINE_STRING)return ne instanceof Ge;if(U===A.POLYGON)return ne instanceof ze;if(U==="MultiFeature")return ne instanceof fe;throw new Error("Unknown feature class: "+U)},pe.prototype.doRender=function(U){return this._ctx.store.featureChanged(U)},pe.prototype.onSetup=function(){},pe.prototype.onDrag=function(){},pe.prototype.onClick=function(){},pe.prototype.onMouseMove=function(){},pe.prototype.onMouseDown=function(){},pe.prototype.onMouseUp=function(){},pe.prototype.onMouseOut=function(){},pe.prototype.onKeyUp=function(){},pe.prototype.onKeyDown=function(){},pe.prototype.onTouchStart=function(){},pe.prototype.onTouchMove=function(){},pe.prototype.onTouchEnd=function(){},pe.prototype.onTap=function(){},pe.prototype.onStop=function(){},pe.prototype.onTrash=function(){},pe.prototype.onCombineFeature=function(){},pe.prototype.onUncombineFeature=function(){},pe.prototype.toDisplayFeatures=function(){throw new Error("You must overwrite toDisplayFeatures")};var ot={drag:"onDrag",click:"onClick",mousemove:"onMouseMove",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseout:"onMouseOut",keyup:"onKeyUp",keydown:"onKeyDown",touchstart:"onTouchStart",touchmove:"onTouchMove",touchend:"onTouchEnd",tap:"onTap"},xe=Object.keys(ot);function ae(U){var ne=Object.keys(U);return function(Te,it){it===void 0&&(it={});var mt={},vt=ne.reduce(function(wt,sr){return wt[sr]=U[sr],wt},new pe(Te));return{start:function(){var wt=this;mt=vt.onSetup(it),xe.forEach(function(sr){var _r,Fr=ot[sr],Ir=function(){return!1};U[Fr]&&(Ir=function(){return!0}),wt.on(sr,Ir,(_r=Fr,function(_t){return vt[_r](mt,_t)}))})},stop:function(){vt.onStop(mt)},trash:function(){vt.onTrash(mt)},combineFeatures:function(){vt.onCombineFeatures(mt)},uncombineFeatures:function(){vt.onUncombineFeatures(mt)},render:function(wt,sr){vt.toDisplayFeatures(mt,wt,sr)}}}}function X(U){return[].concat(U).filter(function(ne){return ne!==void 0})}function Ce(){var U=this;if(!(U.ctx.map&&U.ctx.map.getSource(T.HOT)!==void 0))return _r();var ne=U.ctx.events.currentModeName();U.ctx.ui.queueMapClasses({mode:ne});var Te=[],it=[];U.isDirty?it=U.getAllIds():(Te=U.getChangedIds().filter(function(Fr){return U.get(Fr)!==void 0}),it=U.sources.hot.filter(function(Fr){return Fr.properties.id&&Te.indexOf(Fr.properties.id)===-1&&U.get(Fr.properties.id)!==void 0}).map(function(Fr){return Fr.properties.id})),U.sources.hot=[];var mt=U.sources.cold.length;U.sources.cold=U.isDirty?[]:U.sources.cold.filter(function(Fr){var Ir=Fr.properties.id||Fr.properties.parent;return Te.indexOf(Ir)===-1});var vt=mt!==U.sources.cold.length||it.length>0;function wt(Fr,Ir){var _t=U.get(Fr).internal(ne);U.ctx.events.currentModeRender(_t,function(ar){U.sources[Ir].push(ar)})}if(Te.forEach(function(Fr){return wt(Fr,"hot")}),it.forEach(function(Fr){return wt(Fr,"cold")}),vt&&U.ctx.map.getSource(T.COLD).setData({type:A.FEATURE_COLLECTION,features:U.sources.cold}),U.ctx.map.getSource(T.HOT).setData({type:A.FEATURE_COLLECTION,features:U.sources.hot}),U._emitSelectionChange&&(U.ctx.map.fire(F.SELECTION_CHANGE,{features:U.getSelected().map(function(Fr){return Fr.toGeoJSON()}),points:U.getSelectedCoordinates().map(function(Fr){return{type:A.FEATURE,properties:{},geometry:{type:A.POINT,coordinates:Fr.coordinates}}})}),U._emitSelectionChange=!1),U._deletedFeaturesToEmit.length){var sr=U._deletedFeaturesToEmit.map(function(Fr){return Fr.toGeoJSON()});U._deletedFeaturesToEmit=[],U.ctx.map.fire(F.DELETE,{features:sr})}function _r(){U.isDirty=!1,U.clearChangedIds()}_r(),U.ctx.map.fire(F.RENDER,{})}function he(U){var ne,Te=this;this._features={},this._featureIds=new J,this._selectedFeatureIds=new J,this._selectedCoordinates=[],this._changedFeatureIds=new J,this._deletedFeaturesToEmit=[],this._emitSelectionChange=!1,this._mapInitialConfig={},this.ctx=U,this.sources={hot:[],cold:[]},this.render=function(){ne||(ne=requestAnimationFrame(function(){ne=null,Ce.call(Te)}))},this.isDirty=!1}function G(U,ne){var Te=U._selectedCoordinates.filter(function(it){return U._selectedFeatureIds.has(it.feature_id)});U._selectedCoordinates.length===Te.length||ne.silent||(U._emitSelectionChange=!0),U._selectedCoordinates=Te}he.prototype.createRenderBatch=function(){var U=this,ne=this.render,Te=0;return this.render=function(){Te++},function(){U.render=ne,Te>0&&U.render()}},he.prototype.setDirty=function(){return this.isDirty=!0,this},he.prototype.featureChanged=function(U){return this._changedFeatureIds.add(U),this},he.prototype.getChangedIds=function(){return this._changedFeatureIds.values()},he.prototype.clearChangedIds=function(){return this._changedFeatureIds.clear(),this},he.prototype.getAllIds=function(){return this._featureIds.values()},he.prototype.add=function(U){return this.featureChanged(U.id),this._features[U.id]=U,this._featureIds.add(U.id),this},he.prototype.delete=function(U,ne){var Te=this;return ne===void 0&&(ne={}),X(U).forEach(function(it){Te._featureIds.has(it)&&(Te._featureIds.delete(it),Te._selectedFeatureIds.delete(it),ne.silent||Te._deletedFeaturesToEmit.indexOf(Te._features[it])===-1&&Te._deletedFeaturesToEmit.push(Te._features[it]),delete Te._features[it],Te.isDirty=!0)}),G(this,ne),this},he.prototype.get=function(U){return this._features[U]},he.prototype.getAll=function(){var U=this;return Object.keys(this._features).map(function(ne){return U._features[ne]})},he.prototype.select=function(U,ne){var Te=this;return ne===void 0&&(ne={}),X(U).forEach(function(it){Te._selectedFeatureIds.has(it)||(Te._selectedFeatureIds.add(it),Te._changedFeatureIds.add(it),ne.silent||(Te._emitSelectionChange=!0))}),this},he.prototype.deselect=function(U,ne){var Te=this;return ne===void 0&&(ne={}),X(U).forEach(function(it){Te._selectedFeatureIds.has(it)&&(Te._selectedFeatureIds.delete(it),Te._changedFeatureIds.add(it),ne.silent||(Te._emitSelectionChange=!0))}),G(this,ne),this},he.prototype.clearSelected=function(U){return U===void 0&&(U={}),this.deselect(this._selectedFeatureIds.values(),{silent:U.silent}),this},he.prototype.setSelected=function(U,ne){var Te=this;return ne===void 0&&(ne={}),U=X(U),this.deselect(this._selectedFeatureIds.values().filter(function(it){return U.indexOf(it)===-1}),{silent:ne.silent}),this.select(U.filter(function(it){return!Te._selectedFeatureIds.has(it)}),{silent:ne.silent}),this},he.prototype.setSelectedCoordinates=function(U){return this._selectedCoordinates=U,this._emitSelectionChange=!0,this},he.prototype.clearSelectedCoordinates=function(){return this._selectedCoordinates=[],this._emitSelectionChange=!0,this},he.prototype.getSelectedIds=function(){return this._selectedFeatureIds.values()},he.prototype.getSelected=function(){var U=this;return this._selectedFeatureIds.values().map(function(ne){return U.get(ne)})},he.prototype.getSelectedCoordinates=function(){var U=this;return this._selectedCoordinates.map(function(ne){return{coordinates:U.get(ne.feature_id).getCoordinate(ne.coord_path)}})},he.prototype.isSelected=function(U){return this._selectedFeatureIds.has(U)},he.prototype.setFeatureProperty=function(U,ne,Te){this.get(U).setProperty(ne,Te),this.featureChanged(U)},he.prototype.storeMapConfig=function(){var U=this;Q.forEach(function(ne){U.ctx.map[ne]&&(U._mapInitialConfig[ne]=U.ctx.map[ne].isEnabled())})},he.prototype.restoreMapConfig=function(){var U=this;Object.keys(this._mapInitialConfig).forEach(function(ne){U._mapInitialConfig[ne]?U.ctx.map[ne].enable():U.ctx.map[ne].disable()})},he.prototype.getInitialConfigValue=function(U){return this._mapInitialConfig[U]===void 0||this._mapInitialConfig[U]};var K=function(){for(var U=arguments,ne={},Te=0;Te<arguments.length;Te++){var it=U[Te];for(var mt in it)se.call(it,mt)&&(ne[mt]=it[mt])}return ne},se=Object.prototype.hasOwnProperty,Ae=s(K),Se=["mode","feature","mouse"];function ye(U){var ne=null,Te=null,it={onRemove:function(){return U.map.off("load",it.connect),clearInterval(Te),it.removeLayers(),U.store.restoreMapConfig(),U.ui.removeButtons(),U.events.removeEventListeners(),U.ui.clearMapClasses(),U.boxZoomInitial&&U.map.boxZoom.enable(),U.map=null,U.container=null,U.store=null,ne&&ne.parentNode&&ne.parentNode.removeChild(ne),ne=null,this},connect:function(){U.map.off("load",it.connect),clearInterval(Te),it.addLayers(),U.store.storeMapConfig(),U.events.addEventListeners()},onAdd:function(mt){var vt=mt.fire;return mt.fire=function(wt,sr){var _r=arguments;return vt.length===1&&arguments.length!==1&&(_r=[Ae({},{type:wt},sr)]),vt.apply(mt,_r)},U.map=mt,U.events=function(wt){var sr=Object.keys(wt.options.modes).reduce(function(Kt,Nr){return Kt[Nr]=ae(wt.options.modes[Nr]),Kt},{}),_r={},Fr={},Ir={},_t=null,ar=null;Ir.drag=function(Kt,Nr){Nr({point:Kt.point,time:new Date().getTime()})?(wt.ui.queueMapClasses({mouse:S.DRAG}),ar.drag(Kt)):Kt.originalEvent.stopPropagation()},Ir.mousedrag=function(Kt){Ir.drag(Kt,function(Nr){return!ut(_r,Nr)})},Ir.touchdrag=function(Kt){Ir.drag(Kt,function(Nr){return!Ne(Fr,Nr)})},Ir.mousemove=function(Kt){if((Kt.originalEvent.buttons!==void 0?Kt.originalEvent.buttons:Kt.originalEvent.which)===1)return Ir.mousedrag(Kt);var Nr=Ye(Kt,wt);Kt.featureTarget=Nr,ar.mousemove(Kt)},Ir.mousedown=function(Kt){_r={time:new Date().getTime(),point:Kt.point};var Nr=Ye(Kt,wt);Kt.featureTarget=Nr,ar.mousedown(Kt)},Ir.mouseup=function(Kt){var Nr=Ye(Kt,wt);Kt.featureTarget=Nr,ut(_r,{point:Kt.point,time:new Date().getTime()})?ar.click(Kt):ar.mouseup(Kt)},Ir.mouseout=function(Kt){ar.mouseout(Kt)},Ir.touchstart=function(Kt){if(wt.options.touchEnabled){Fr={time:new Date().getTime(),point:Kt.point};var Nr=re.touch(Kt,null,wt)[0];Kt.featureTarget=Nr,ar.touchstart(Kt)}},Ir.touchmove=function(Kt){if(wt.options.touchEnabled)return ar.touchmove(Kt),Ir.touchdrag(Kt)},Ir.touchend=function(Kt){if(Kt.originalEvent.preventDefault(),wt.options.touchEnabled){var Nr=re.touch(Kt,null,wt)[0];Kt.featureTarget=Nr,Ne(Fr,{time:new Date().getTime(),point:Kt.point})?ar.tap(Kt):ar.touchend(Kt)}};var Ln=function(Kt){return!(Kt===8||Kt===46||Kt>=48&&Kt<=57)};function at(Kt,Nr,Sn){Sn===void 0&&(Sn={}),ar.stop();var aa=sr[Kt];if(aa===void 0)throw new Error(Kt+" is not valid");_t=Kt;var Da=aa(wt,Nr);ar=a(Da,wt),Sn.silent||wt.map.fire(F.MODE_CHANGE,{mode:Kt}),wt.store.setDirty(),wt.store.render()}Ir.keydown=function(Kt){(Kt.srcElement||Kt.target).classList.contains("mapboxgl-canvas")&&(Kt.keyCode!==8&&Kt.keyCode!==46||!wt.options.controls.trash?Ln(Kt.keyCode)?ar.keydown(Kt):Kt.keyCode===49&&wt.options.controls.point?at(M.DRAW_POINT):Kt.keyCode===50&&wt.options.controls.line_string?at(M.DRAW_LINE_STRING):Kt.keyCode===51&&wt.options.controls.polygon&&at(M.DRAW_POLYGON):(Kt.preventDefault(),ar.trash()))},Ir.keyup=function(Kt){Ln(Kt.keyCode)&&ar.keyup(Kt)},Ir.zoomend=function(){wt.store.changeZoom()},Ir.data=function(Kt){if(Kt.dataType==="style"){var Nr=wt.setup,Sn=wt.map,aa=wt.options,Da=wt.store;aa.styles.some(function(vs){return Sn.getLayer(vs.id)})||(Nr.addLayers(),Da.setDirty(),Da.render())}};var nr={trash:!1,combineFeatures:!1,uncombineFeatures:!1};return{start:function(){_t=wt.options.defaultMode,ar=a(sr[_t](wt),wt)},changeMode:at,actionable:function(Kt){var Nr=!1;Object.keys(Kt).forEach(function(Sn){if(nr[Sn]===void 0)throw new Error("Invalid action type");nr[Sn]!==Kt[Sn]&&(Nr=!0),nr[Sn]=Kt[Sn]}),Nr&&wt.map.fire(F.ACTIONABLE,{actions:nr})},currentModeName:function(){return _t},currentModeRender:function(Kt,Nr){return ar.render(Kt,Nr)},fire:function(Kt,Nr){Ir[Kt]&&Ir[Kt](Nr)},addEventListeners:function(){wt.map.on("mousemove",Ir.mousemove),wt.map.on("mousedown",Ir.mousedown),wt.map.on("mouseup",Ir.mouseup),wt.map.on("data",Ir.data),wt.map.on("touchmove",Ir.touchmove),wt.map.on("touchstart",Ir.touchstart),wt.map.on("touchend",Ir.touchend),wt.container.addEventListener("mouseout",Ir.mouseout),wt.options.keybindings&&(wt.container.addEventListener("keydown",Ir.keydown),wt.container.addEventListener("keyup",Ir.keyup))},removeEventListeners:function(){wt.map.off("mousemove",Ir.mousemove),wt.map.off("mousedown",Ir.mousedown),wt.map.off("mouseup",Ir.mouseup),wt.map.off("data",Ir.data),wt.map.off("touchmove",Ir.touchmove),wt.map.off("touchstart",Ir.touchstart),wt.map.off("touchend",Ir.touchend),wt.container.removeEventListener("mouseout",Ir.mouseout),wt.options.keybindings&&(wt.container.removeEventListener("keydown",Ir.keydown),wt.container.removeEventListener("keyup",Ir.keyup))},trash:function(Kt){ar.trash(Kt)},combineFeatures:function(){ar.combineFeatures()},uncombineFeatures:function(){ar.uncombineFeatures()},getMode:function(){return _t}}}(U),U.ui=function(wt){var sr={},_r=null,Fr={mode:null,feature:null,mouse:null},Ir={mode:null,feature:null,mouse:null};function _t(Kt){Ir=Ae(Ir,Kt)}function ar(){var Kt,Nr;if(wt.container){var Sn=[],aa=[];Se.forEach(function(Da){Ir[Da]!==Fr[Da]&&(Sn.push(Da+"-"+Fr[Da]),Ir[Da]!==null&&aa.push(Da+"-"+Ir[Da]))}),Sn.length>0&&(Kt=wt.container.classList).remove.apply(Kt,Sn),aa.length>0&&(Nr=wt.container.classList).add.apply(Nr,aa),Fr=Ae(Fr,Ir)}}function Ln(Kt,Nr){Nr===void 0&&(Nr={});var Sn=document.createElement("button");return Sn.className=E.CONTROL_BUTTON+" "+Nr.className,Sn.setAttribute("title",Nr.title),Nr.container.appendChild(Sn),Sn.addEventListener("click",function(aa){if(aa.preventDefault(),aa.stopPropagation(),aa.target===_r)return at(),void Nr.onDeactivate();nr(Kt),Nr.onActivate()},!0),Sn}function at(){_r&&(_r.classList.remove(E.ACTIVE_BUTTON),_r=null)}function nr(Kt){at();var Nr=sr[Kt];Nr&&Nr&&Kt!=="trash"&&(Nr.classList.add(E.ACTIVE_BUTTON),_r=Nr)}return{setActiveButton:nr,queueMapClasses:_t,updateMapClasses:ar,clearMapClasses:function(){_t({mode:null,feature:null,mouse:null}),ar()},addButtons:function(){var Kt=wt.options.controls,Nr=document.createElement("div");return Nr.className=E.CONTROL_GROUP+" "+E.CONTROL_BASE,Kt&&(Kt[I.LINE]&&(sr[I.LINE]=Ln(I.LINE,{container:Nr,className:E.CONTROL_BUTTON_LINE,title:"LineString tool "+(wt.options.keybindings?"(l)":""),onActivate:function(){return wt.events.changeMode(M.DRAW_LINE_STRING)},onDeactivate:function(){return wt.events.trash()}})),Kt[I.POLYGON]&&(sr[I.POLYGON]=Ln(I.POLYGON,{container:Nr,className:E.CONTROL_BUTTON_POLYGON,title:"Polygon tool "+(wt.options.keybindings?"(p)":""),onActivate:function(){return wt.events.changeMode(M.DRAW_POLYGON)},onDeactivate:function(){return wt.events.trash()}})),Kt[I.POINT]&&(sr[I.POINT]=Ln(I.POINT,{container:Nr,className:E.CONTROL_BUTTON_POINT,title:"Marker tool "+(wt.options.keybindings?"(m)":""),onActivate:function(){return wt.events.changeMode(M.DRAW_POINT)},onDeactivate:function(){return wt.events.trash()}})),Kt.trash&&(sr.trash=Ln("trash",{container:Nr,className:E.CONTROL_BUTTON_TRASH,title:"Delete",onActivate:function(){wt.events.trash()}})),Kt.combine_features&&(sr.combine_features=Ln("combineFeatures",{container:Nr,className:E.CONTROL_BUTTON_COMBINE_FEATURES,title:"Combine",onActivate:function(){wt.events.combineFeatures()}})),Kt.uncombine_features&&(sr.uncombine_features=Ln("uncombineFeatures",{container:Nr,className:E.CONTROL_BUTTON_UNCOMBINE_FEATURES,title:"Uncombine",onActivate:function(){wt.events.uncombineFeatures()}}))),Nr},removeButtons:function(){Object.keys(sr).forEach(function(Kt){var Nr=sr[Kt];Nr.parentNode&&Nr.parentNode.removeChild(Nr),delete sr[Kt]})}}}(U),U.container=mt.getContainer(),U.store=new he(U),ne=U.ui.addButtons(),U.options.boxSelect&&(U.boxZoomInitial=mt.boxZoom.isEnabled(),mt.boxZoom.disable(),mt.dragPan.disable(),mt.dragPan.enable()),mt.loaded()?it.connect():(mt.on("load",it.connect),Te=setInterval(function(){mt.loaded()&&it.connect()},16)),U.events.start(),ne},addLayers:function(){U.map.addSource(T.COLD,{data:{type:A.FEATURE_COLLECTION,features:[]},type:"geojson"}),U.map.addSource(T.HOT,{data:{type:A.FEATURE_COLLECTION,features:[]},type:"geojson"}),U.options.styles.forEach(function(mt){U.map.addLayer(mt)}),U.store.setDirty(!0),U.store.render()},removeLayers:function(){U.options.styles.forEach(function(mt){U.map.getLayer(mt.id)&&U.map.removeLayer(mt.id)}),U.map.getSource(T.COLD)&&U.map.removeSource(T.COLD),U.map.getSource(T.HOT)&&U.map.removeSource(T.HOT)}};return U.setup=it,it}var Xe=[{id:"gl-draw-polygon-fill-inactive",type:"fill",filter:["all",["==","active","false"],["==","$type","Polygon"],["!=","mode","static"]],paint:{"fill-color":"#3bb2d0","fill-outline-color":"#3bb2d0","fill-opacity":.1}},{id:"gl-draw-polygon-fill-active",type:"fill",filter:["all",["==","active","true"],["==","$type","Polygon"]],paint:{"fill-color":"#fbb03b","fill-outline-color":"#fbb03b","fill-opacity":.1}},{id:"gl-draw-polygon-midpoint",type:"circle",filter:["all",["==","$type","Point"],["==","meta","midpoint"]],paint:{"circle-radius":3,"circle-color":"#fbb03b"}},{id:"gl-draw-polygon-stroke-inactive",type:"line",filter:["all",["==","active","false"],["==","$type","Polygon"],["!=","mode","static"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#3bb2d0","line-width":2}},{id:"gl-draw-polygon-stroke-active",type:"line",filter:["all",["==","active","true"],["==","$type","Polygon"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#fbb03b","line-dasharray":[.2,2],"line-width":2}},{id:"gl-draw-line-inactive",type:"line",filter:["all",["==","active","false"],["==","$type","LineString"],["!=","mode","static"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#3bb2d0","line-width":2}},{id:"gl-draw-line-active",type:"line",filter:["all",["==","$type","LineString"],["==","active","true"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#fbb03b","line-dasharray":[.2,2],"line-width":2}},{id:"gl-draw-polygon-and-line-vertex-stroke-inactive",type:"circle",filter:["all",["==","meta","vertex"],["==","$type","Point"],["!=","mode","static"]],paint:{"circle-radius":5,"circle-color":"#fff"}},{id:"gl-draw-polygon-and-line-vertex-inactive",type:"circle",filter:["all",["==","meta","vertex"],["==","$type","Point"],["!=","mode","static"]],paint:{"circle-radius":3,"circle-color":"#fbb03b"}},{id:"gl-draw-point-point-stroke-inactive",type:"circle",filter:["all",["==","active","false"],["==","$type","Point"],["==","meta","feature"],["!=","mode","static"]],paint:{"circle-radius":5,"circle-opacity":1,"circle-color":"#fff"}},{id:"gl-draw-point-inactive",type:"circle",filter:["all",["==","active","false"],["==","$type","Point"],["==","meta","feature"],["!=","mode","static"]],paint:{"circle-radius":3,"circle-color":"#3bb2d0"}},{id:"gl-draw-point-stroke-active",type:"circle",filter:["all",["==","$type","Point"],["==","active","true"],["!=","meta","midpoint"]],paint:{"circle-radius":7,"circle-color":"#fff"}},{id:"gl-draw-point-active",type:"circle",filter:["all",["==","$type","Point"],["!=","meta","midpoint"],["==","active","true"]],paint:{"circle-radius":5,"circle-color":"#fbb03b"}},{id:"gl-draw-polygon-fill-static",type:"fill",filter:["all",["==","mode","static"],["==","$type","Polygon"]],paint:{"fill-color":"#404040","fill-outline-color":"#404040","fill-opacity":.1}},{id:"gl-draw-polygon-stroke-static",type:"line",filter:["all",["==","mode","static"],["==","$type","Polygon"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#404040","line-width":2}},{id:"gl-draw-line-static",type:"line",filter:["all",["==","mode","static"],["==","$type","LineString"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#404040","line-width":2}},{id:"gl-draw-point-static",type:"circle",filter:["all",["==","mode","static"],["==","$type","Point"]],paint:{"circle-radius":5,"circle-color":"#404040"}}];function be(U){return function(ne){var Te=ne.featureTarget;return!!Te&&!!Te.properties&&Te.properties.meta===U}}function Be(U){return!!U.originalEvent&&!!U.originalEvent.shiftKey&&U.originalEvent.button===0}function ct(U){return!!U.featureTarget&&!!U.featureTarget.properties&&U.featureTarget.properties.active===N.ACTIVE&&U.featureTarget.properties.meta===O.FEATURE}function At(U){return!!U.featureTarget&&!!U.featureTarget.properties&&U.featureTarget.properties.active===N.INACTIVE&&U.featureTarget.properties.meta===O.FEATURE}function $t(U){return U.featureTarget===void 0}function mr(U){return!!U.featureTarget&&!!U.featureTarget.properties&&U.featureTarget.properties.meta===O.FEATURE}function Nt(U){var ne=U.featureTarget;return!!ne&&!!ne.properties&&ne.properties.meta===O.VERTEX}function Lt(U){return!!U.originalEvent&&U.originalEvent.shiftKey===!0}function Qt(U){return U.keyCode===27}function Gt(U){return U.keyCode===13}var dr=Object.freeze({__proto__:null,isOfMetaType:be,isShiftMousedown:Be,isActiveFeature:ct,isInactiveFeature:At,noTarget:$t,isFeature:mr,isVertex:Nt,isShiftDown:Lt,isEscapeKey:Qt,isEnterKey:Gt,isTrue:function(){return!0}}),Br=qr;function qr(U,ne){this.x=U,this.y=ne}qr.prototype={clone:function(){return new qr(this.x,this.y)},add:function(U){return this.clone()._add(U)},sub:function(U){return this.clone()._sub(U)},multByPoint:function(U){return this.clone()._multByPoint(U)},divByPoint:function(U){return this.clone()._divByPoint(U)},mult:function(U){return this.clone()._mult(U)},div:function(U){return this.clone()._div(U)},rotate:function(U){return this.clone()._rotate(U)},rotateAround:function(U,ne){return this.clone()._rotateAround(U,ne)},matMult:function(U){return this.clone()._matMult(U)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(U){return this.x===U.x&&this.y===U.y},dist:function(U){return Math.sqrt(this.distSqr(U))},distSqr:function(U){var ne=U.x-this.x,Te=U.y-this.y;return ne*ne+Te*Te},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(U){return Math.atan2(this.y-U.y,this.x-U.x)},angleWith:function(U){return this.angleWithSep(U.x,U.y)},angleWithSep:function(U,ne){return Math.atan2(this.x*ne-this.y*U,this.x*U+this.y*ne)},_matMult:function(U){var ne=U[0]*this.x+U[1]*this.y,Te=U[2]*this.x+U[3]*this.y;return this.x=ne,this.y=Te,this},_add:function(U){return this.x+=U.x,this.y+=U.y,this},_sub:function(U){return this.x-=U.x,this.y-=U.y,this},_mult:function(U){return this.x*=U,this.y*=U,this},_div:function(U){return this.x/=U,this.y/=U,this},_multByPoint:function(U){return this.x*=U.x,this.y*=U.y,this},_divByPoint:function(U){return this.x/=U.x,this.y/=U.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var U=this.y;return this.y=this.x,this.x=-U,this},_rotate:function(U){var ne=Math.cos(U),Te=Math.sin(U),it=ne*this.x-Te*this.y,mt=Te*this.x+ne*this.y;return this.x=it,this.y=mt,this},_rotateAround:function(U,ne){var Te=Math.cos(U),it=Math.sin(U),mt=ne.x+Te*(this.x-ne.x)-it*(this.y-ne.y),vt=ne.y+it*(this.x-ne.x)+Te*(this.y-ne.y);return this.x=mt,this.y=vt,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},qr.convert=function(U){return U instanceof qr?U:Array.isArray(U)?new qr(U[0],U[1]):U};var Ci=s(Br);function Wi(U,ne){var Te=ne.getBoundingClientRect();return new Ci(U.clientX-Te.left-(ne.clientLeft||0),U.clientY-Te.top-(ne.clientTop||0))}function Fi(U,ne,Te,it){return{type:A.FEATURE,properties:{meta:O.VERTEX,parent:U,coord_path:Te,active:it?N.ACTIVE:N.INACTIVE},geometry:{type:A.POINT,coordinates:ne}}}function Ta(U,ne,Te){var it=ne.geometry.coordinates,mt=Te.geometry.coordinates;if(it[1]>85||it[1]<ie||mt[1]>85||mt[1]<ie)return null;var vt={lng:(it[0]+mt[0])/2,lat:(it[1]+mt[1])/2};return{type:A.FEATURE,properties:{meta:O.MIDPOINT,parent:U,lng:vt.lng,lat:vt.lat,coord_path:Te.properties.coord_path},geometry:{type:A.POINT,coordinates:[vt.lng,vt.lat]}}}function Sa(U,ne,Te){ne===void 0&&(ne={}),Te===void 0&&(Te=null);var it,mt=U.geometry,vt=mt.type,wt=mt.coordinates,sr=U.properties&&U.properties.id,_r=[];function Fr(_t,ar){var Ln="",at=null;_t.forEach(function(nr,Kt){var Nr=ar!=null?ar+"."+Kt:String(Kt),Sn=Fi(sr,nr,Nr,Ir(Nr));if(ne.midpoints&&at){var aa=Ta(sr,at,Sn);aa&&_r.push(aa)}at=Sn;var Da=JSON.stringify(nr);Ln!==Da&&_r.push(Sn),Kt===0&&(Ln=Da)})}function Ir(_t){return!!ne.selectedPaths&&ne.selectedPaths.indexOf(_t)!==-1}return vt===A.POINT?_r.push(Fi(sr,wt,Te,Ir(Te))):vt===A.POLYGON?wt.forEach(function(_t,ar){Fr(_t,Te!==null?Te+"."+ar:String(ar))}):vt===A.LINE_STRING?Fr(wt,Te):vt.indexOf(A.MULTI_PREFIX)===0&&(it=vt.replace(A.MULTI_PREFIX,""),wt.forEach(function(_t,ar){var Ln={type:A.FEATURE,properties:U.properties,geometry:{type:it,coordinates:_t}};_r=_r.concat(Sa(Ln,ne,ar))})),_r}var Ai={enable:function(U){setTimeout(function(){U.map&&U.map.doubleClickZoom&&U._ctx&&U._ctx.store&&U._ctx.store.getInitialConfigValue&&U._ctx.store.getInitialConfigValue("doubleClickZoom")&&U.map.doubleClickZoom.enable()},0)},disable:function(U){setTimeout(function(){U.map&&U.map.doubleClickZoom&&U.map.doubleClickZoom.disable()},0)}},Le={exports:{}},lt=function(U){if(!U||!U.type)return null;var ne=xt[U.type];if(!ne)return null;if(ne==="geometry")return{type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:U}]};if(ne==="feature")return{type:"FeatureCollection",features:[U]};if(ne==="featurecollection")return U},xt={Point:"geometry",MultiPoint:"geometry",LineString:"geometry",MultiLineString:"geometry",Polygon:"geometry",MultiPolygon:"geometry",GeometryCollection:"geometry",Feature:"feature",FeatureCollection:"featurecollection"},Ot=s(lt),jt=Object.freeze({__proto__:null,default:function U(ne){switch(ne&&ne.type||null){case"FeatureCollection":return ne.features=ne.features.reduce(function(Te,it){return Te.concat(U(it))},[]),ne;case"Feature":return ne.geometry?U(ne.geometry).map(function(Te){var it={type:"Feature",properties:JSON.parse(JSON.stringify(ne.properties)),geometry:Te};return ne.id!==void 0&&(it.id=ne.id),it}):[ne];case"MultiPoint":return ne.coordinates.map(function(Te){return{type:"Point",coordinates:Te}});case"MultiPolygon":return ne.coordinates.map(function(Te){return{type:"Polygon",coordinates:Te}});case"MultiLineString":return ne.coordinates.map(function(Te){return{type:"LineString",coordinates:Te}});case"GeometryCollection":return ne.geometries.map(U).reduce(function(Te,it){return Te.concat(it)},[]);case"Point":case"Polygon":case"LineString":return[ne]}}}),qt=lt,Jt=c(jt),Xt=function(U){return function ne(Te){return Array.isArray(Te)&&Te.length&&typeof Te[0]=="number"?[Te]:Te.reduce(function(it,mt){return Array.isArray(mt)&&Array.isArray(mt[0])?it.concat(ne(mt)):(it.push(mt),it)},[])}(U)};Jt instanceof Function||(Jt=Jt.default);var or={exports:{}},er=or.exports=function(U){return new Ur(U)};function Ur(U){this.value=U}function fn(U,ne,Te){var it=[],mt=[],vt=!0;return function wt(sr){var _r=Te?Cr(sr):sr,Fr={},Ir=!0,_t={node:_r,node_:sr,path:[].concat(it),parent:mt[mt.length-1],parents:mt,key:it.slice(-1)[0],isRoot:it.length===0,level:it.length,circular:null,update:function(at,nr){_t.isRoot||(_t.parent.node[_t.key]=at),_t.node=at,nr&&(Ir=!1)},delete:function(at){delete _t.parent.node[_t.key],at&&(Ir=!1)},remove:function(at){Ue(_t.parent.node)?_t.parent.node.splice(_t.key,1):delete _t.parent.node[_t.key],at&&(Ir=!1)},keys:null,before:function(at){Fr.before=at},after:function(at){Fr.after=at},pre:function(at){Fr.pre=at},post:function(at){Fr.post=at},stop:function(){vt=!1},block:function(){Ir=!1}};if(!vt)return _t;function ar(){if(typeof _t.node=="object"&&_t.node!==null){_t.keys&&_t.node_===_t.node||(_t.keys=_e(_t.node)),_t.isLeaf=_t.keys.length==0;for(var at=0;at<mt.length;at++)if(mt[at].node_===sr){_t.circular=mt[at];break}}else _t.isLeaf=!0,_t.keys=null;_t.notLeaf=!_t.isLeaf,_t.notRoot=!_t.isRoot}ar();var Ln=ne.call(_t,_t.node);return Ln!==void 0&&_t.update&&_t.update(Ln),Fr.before&&Fr.before.call(_t,_t.node),Ir&&(typeof _t.node!="object"||_t.node===null||_t.circular||(mt.push(_t),ar(),je(_t.keys,function(at,nr){it.push(at),Fr.pre&&Fr.pre.call(_t,_t.node[at],at);var Kt=wt(_t.node[at]);Te&&Ke.call(_t.node,at)&&(_t.node[at]=Kt.node),Kt.isLast=nr==_t.keys.length-1,Kt.isFirst=nr==0,Fr.post&&Fr.post.call(_t,Kt),it.pop()}),mt.pop()),Fr.after&&Fr.after.call(_t,_t.node)),_t}(U).node}function Cr(U){if(typeof U=="object"&&U!==null){var ne;if(Ue(U))ne=[];else if(qe(U)==="[object Date]")ne=new Date(U.getTime?U.getTime():U);else if(function(mt){return qe(mt)==="[object RegExp]"}(U))ne=new RegExp(U);else if(function(mt){return qe(mt)==="[object Error]"}(U))ne={message:U.message};else if(function(mt){return qe(mt)==="[object Boolean]"}(U))ne=new Boolean(U);else if(function(mt){return qe(mt)==="[object Number]"}(U))ne=new Number(U);else if(function(mt){return qe(mt)==="[object String]"}(U))ne=new String(U);else if(Object.create&&Object.getPrototypeOf)ne=Object.create(Object.getPrototypeOf(U));else if(U.constructor===Object)ne={};else{var Te=U.constructor&&U.constructor.prototype||U.__proto__||{},it=function(){};it.prototype=Te,ne=new it}return je(_e(U),function(mt){ne[mt]=U[mt]}),ne}return U}Ur.prototype.get=function(U){for(var ne=this.value,Te=0;Te<U.length;Te++){var it=U[Te];if(!ne||!Ke.call(ne,it)){ne=void 0;break}ne=ne[it]}return ne},Ur.prototype.has=function(U){for(var ne=this.value,Te=0;Te<U.length;Te++){var it=U[Te];if(!ne||!Ke.call(ne,it))return!1;ne=ne[it]}return!0},Ur.prototype.set=function(U,ne){for(var Te=this.value,it=0;it<U.length-1;it++){var mt=U[it];Ke.call(Te,mt)||(Te[mt]={}),Te=Te[mt]}return Te[U[it]]=ne,ne},Ur.prototype.map=function(U){return fn(this.value,U,!0)},Ur.prototype.forEach=function(U){return this.value=fn(this.value,U,!1),this.value},Ur.prototype.reduce=function(U,ne){var Te=arguments.length===1,it=Te?this.value:ne;return this.forEach(function(mt){this.isRoot&&Te||(it=U.call(this,it,mt))}),it},Ur.prototype.paths=function(){var U=[];return this.forEach(function(ne){U.push(this.path)}),U},Ur.prototype.nodes=function(){var U=[];return this.forEach(function(ne){U.push(this.node)}),U},Ur.prototype.clone=function(){var U=[],ne=[];return function Te(it){for(var mt=0;mt<U.length;mt++)if(U[mt]===it)return ne[mt];if(typeof it=="object"&&it!==null){var vt=Cr(it);return U.push(it),ne.push(vt),je(_e(it),function(wt){vt[wt]=Te(it[wt])}),U.pop(),ne.pop(),vt}return it}(this.value)};var _e=Object.keys||function(U){var ne=[];for(var Te in U)ne.push(Te);return ne};function qe(U){return Object.prototype.toString.call(U)}var Ue=Array.isArray||function(U){return Object.prototype.toString.call(U)==="[object Array]"},je=function(U,ne){if(U.forEach)return U.forEach(ne);for(var Te=0;Te<U.length;Te++)ne(U[Te],Te,U)};je(_e(Ur.prototype),function(U){er[U]=function(ne){var Te=[].slice.call(arguments,1),it=new Ur(ne);return it[U].apply(it,Te)}});var Ke=Object.hasOwnProperty||function(U,ne){return ne in U},nt=or.exports,It=Bt;function Bt(U){if(!(this instanceof Bt))return new Bt(U);this._bbox=U||[1/0,1/0,-1/0,-1/0],this._valid=!!U}Bt.prototype.include=function(U){return this._valid=!0,this._bbox[0]=Math.min(this._bbox[0],U[0]),this._bbox[1]=Math.min(this._bbox[1],U[1]),this._bbox[2]=Math.max(this._bbox[2],U[0]),this._bbox[3]=Math.max(this._bbox[3],U[1]),this},Bt.prototype.equals=function(U){var ne;return ne=U instanceof Bt?U.bbox():U,this._bbox[0]==ne[0]&&this._bbox[1]==ne[1]&&this._bbox[2]==ne[2]&&this._bbox[3]==ne[3]},Bt.prototype.center=function(U){return this._valid?[(this._bbox[0]+this._bbox[2])/2,(this._bbox[1]+this._bbox[3])/2]:null},Bt.prototype.union=function(U){var ne;return this._valid=!0,ne=U instanceof Bt?U.bbox():U,this._bbox[0]=Math.min(this._bbox[0],ne[0]),this._bbox[1]=Math.min(this._bbox[1],ne[1]),this._bbox[2]=Math.max(this._bbox[2],ne[2]),this._bbox[3]=Math.max(this._bbox[3],ne[3]),this},Bt.prototype.bbox=function(){return this._valid?this._bbox:null},Bt.prototype.contains=function(U){if(!U)return this._fastContains();if(!this._valid)return null;var ne=U[0],Te=U[1];return this._bbox[0]<=ne&&this._bbox[1]<=Te&&this._bbox[2]>=ne&&this._bbox[3]>=Te},Bt.prototype.intersect=function(U){return this._valid?(ne=U instanceof Bt?U.bbox():U,!(this._bbox[0]>ne[2]||this._bbox[2]<ne[0]||this._bbox[3]<ne[1]||this._bbox[1]>ne[3])):null;var ne},Bt.prototype._fastContains=function(){if(!this._valid)return new Function("return null;");var U="return "+this._bbox[0]+"<= ll[0] &&"+this._bbox[1]+"<= ll[1] &&"+this._bbox[2]+">= ll[0] &&"+this._bbox[3]+">= ll[1]";return new Function("ll",U)},Bt.prototype.polygon=function(){return this._valid?{type:"Polygon",coordinates:[[[this._bbox[0],this._bbox[1]],[this._bbox[2],this._bbox[1]],[this._bbox[2],this._bbox[3]],[this._bbox[0],this._bbox[3]],[this._bbox[0],this._bbox[1]]]]}:null};var kt=function(U){if(!U)return[];var ne=Jt(qt(U)),Te=[];return ne.features.forEach(function(it){it.geometry&&(Te=Te.concat(Xt(it.geometry.coordinates)))}),Te},Dt=nt,Rt=It,fr={features:["FeatureCollection"],coordinates:["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"],geometry:["Feature"],geometries:["GeometryCollection"]},Tr=Object.keys(fr);function zr(U){for(var ne=Rt(),Te=kt(U),it=0;it<Te.length;it++)ne.include(Te[it]);return ne}Le.exports=function(U){return zr(U).bbox()},Le.exports.polygon=function(U){return zr(U).polygon()},Le.exports.bboxify=function(U){return Dt(U).map(function(ne){ne&&Tr.some(function(Te){return!!ne[Te]&&fr[Te].indexOf(ne.type)!==-1})&&(ne.bbox=zr(ne).bbox(),this.update(ne))})};var yr=s(Le.exports),wr=-90;function On(U,ne){var Te=wr,it=90,mt=wr,vt=90,wt=270,sr=-270;U.forEach(function(Fr){var Ir=yr(Fr),_t=Ir[1],ar=Ir[3],Ln=Ir[0],at=Ir[2];_t>Te&&(Te=_t),ar<it&&(it=ar),ar>mt&&(mt=ar),_t<vt&&(vt=_t),Ln<wt&&(wt=Ln),at>sr&&(sr=at)});var _r=ne;return Te+_r.lat>85&&(_r.lat=85-Te),mt+_r.lat>90&&(_r.lat=90-mt),it+_r.lat<-85&&(_r.lat=-85-it),vt+_r.lat<wr&&(_r.lat=wr-vt),wt+_r.lng<=-270&&(_r.lng+=360*Math.ceil(Math.abs(_r.lng)/360)),sr+_r.lng>=270&&(_r.lng-=360*Math.ceil(Math.abs(_r.lng)/360)),_r}function Di(U,ne){var Te=On(U.map(function(it){return it.toGeoJSON()}),ne);U.forEach(function(it){var mt,vt=it.getCoordinates(),wt=function(_r){var Fr={lng:_r[0]+Te.lng,lat:_r[1]+Te.lat};return[Fr.lng,Fr.lat]},sr=function(_r){return _r.map(function(Fr){return wt(Fr)})};it.type===A.POINT?mt=wt(vt):it.type===A.LINE_STRING||it.type===A.MULTI_POINT?mt=vt.map(wt):it.type===A.POLYGON||it.type===A.MULTI_LINE_STRING?mt=vt.map(sr):it.type===A.MULTI_POLYGON&&(mt=vt.map(function(_r){return _r.map(function(Fr){return sr(Fr)})})),it.incomingCoords(mt)})}var Vn={onSetup:function(U){var ne=this,Te={dragMoveLocation:null,boxSelectStartLocation:null,boxSelectElement:void 0,boxSelecting:!1,canBoxSelect:!1,dragMoving:!1,canDragMove:!1,initiallySelectedFeatureIds:U.featureIds||[]};return this.setSelected(Te.initiallySelectedFeatureIds.filter(function(it){return ne.getFeature(it)!==void 0})),this.fireActionable(),this.setActionableState({combineFeatures:!0,uncombineFeatures:!0,trash:!0}),Te},fireUpdate:function(){this.map.fire(F.UPDATE,{action:L.MOVE,features:this.getSelected().map(function(U){return U.toGeoJSON()})})},fireActionable:function(){var U=this,ne=this.getSelected(),Te=ne.filter(function(sr){return U.isInstanceOf("MultiFeature",sr)}),it=!1;if(ne.length>1){it=!0;var mt=ne[0].type.replace("Multi","");ne.forEach(function(sr){sr.type.replace("Multi","")!==mt&&(it=!1)})}var vt=Te.length>0,wt=ne.length>0;this.setActionableState({combineFeatures:it,uncombineFeatures:vt,trash:wt})},getUniqueIds:function(U){return U.length?U.map(function(ne){return ne.properties.id}).filter(function(ne){return ne!==void 0}).reduce(function(ne,Te){return ne.add(Te),ne},new J).values():[]},stopExtendedInteractions:function(U){U.boxSelectElement&&(U.boxSelectElement.parentNode&&U.boxSelectElement.parentNode.removeChild(U.boxSelectElement),U.boxSelectElement=null),this.map.dragPan.enable(),U.boxSelecting=!1,U.canBoxSelect=!1,U.dragMoving=!1,U.canDragMove=!1},onStop:function(){Ai.enable(this)},onMouseMove:function(U,ne){return mr(ne)&&U.dragMoving&&this.fireUpdate(),this.stopExtendedInteractions(U),!0},onMouseOut:function(U){return!U.dragMoving||this.fireUpdate()}};Vn.onTap=Vn.onClick=function(U,ne){return $t(ne)?this.clickAnywhere(U,ne):be(O.VERTEX)(ne)?this.clickOnVertex(U,ne):mr(ne)?this.clickOnFeature(U,ne):void 0},Vn.clickAnywhere=function(U){var ne=this,Te=this.getSelectedIds();Te.length&&(this.clearSelectedFeatures(),Te.forEach(function(it){return ne.doRender(it)})),Ai.enable(this),this.stopExtendedInteractions(U)},Vn.clickOnVertex=function(U,ne){this.changeMode(M.DIRECT_SELECT,{featureId:ne.featureTarget.properties.parent,coordPath:ne.featureTarget.properties.coord_path,startPos:ne.lngLat}),this.updateUIClasses({mouse:S.MOVE})},Vn.startOnActiveFeature=function(U,ne){this.stopExtendedInteractions(U),this.map.dragPan.disable(),this.doRender(ne.featureTarget.properties.id),U.canDragMove=!0,U.dragMoveLocation=ne.lngLat},Vn.clickOnFeature=function(U,ne){var Te=this;Ai.disable(this),this.stopExtendedInteractions(U);var it=Lt(ne),mt=this.getSelectedIds(),vt=ne.featureTarget.properties.id,wt=this.isSelected(vt);if(!it&&wt&&this.getFeature(vt).type!==A.POINT)return this.changeMode(M.DIRECT_SELECT,{featureId:vt});wt&&it?(this.deselect(vt),this.updateUIClasses({mouse:S.POINTER}),mt.length===1&&Ai.enable(this)):!wt&&it?(this.select(vt),this.updateUIClasses({mouse:S.MOVE})):wt||it||(mt.forEach(function(sr){return Te.doRender(sr)}),this.setSelected(vt),this.updateUIClasses({mouse:S.MOVE})),this.doRender(vt)},Vn.onMouseDown=function(U,ne){return ct(ne)?this.startOnActiveFeature(U,ne):this.drawConfig.boxSelect&&Be(ne)?this.startBoxSelect(U,ne):void 0},Vn.startBoxSelect=function(U,ne){this.stopExtendedInteractions(U),this.map.dragPan.disable(),U.boxSelectStartLocation=Wi(ne.originalEvent,this.map.getContainer()),U.canBoxSelect=!0},Vn.onTouchStart=function(U,ne){if(ct(ne))return this.startOnActiveFeature(U,ne)},Vn.onDrag=function(U,ne){return U.canDragMove?this.dragMove(U,ne):this.drawConfig.boxSelect&&U.canBoxSelect?this.whileBoxSelect(U,ne):void 0},Vn.whileBoxSelect=function(U,ne){U.boxSelecting=!0,this.updateUIClasses({mouse:S.ADD}),U.boxSelectElement||(U.boxSelectElement=document.createElement("div"),U.boxSelectElement.classList.add(E.BOX_SELECT),this.map.getContainer().appendChild(U.boxSelectElement));var Te=Wi(ne.originalEvent,this.map.getContainer()),it=Math.min(U.boxSelectStartLocation.x,Te.x),mt=Math.max(U.boxSelectStartLocation.x,Te.x),vt=Math.min(U.boxSelectStartLocation.y,Te.y),wt=Math.max(U.boxSelectStartLocation.y,Te.y),sr="translate("+it+"px, "+vt+"px)";U.boxSelectElement.style.transform=sr,U.boxSelectElement.style.WebkitTransform=sr,U.boxSelectElement.style.width=mt-it+"px",U.boxSelectElement.style.height=wt-vt+"px"},Vn.dragMove=function(U,ne){U.dragMoving=!0,ne.originalEvent.stopPropagation();var Te={lng:ne.lngLat.lng-U.dragMoveLocation.lng,lat:ne.lngLat.lat-U.dragMoveLocation.lat};Di(this.getSelected(),Te),U.dragMoveLocation=ne.lngLat},Vn.onTouchEnd=Vn.onMouseUp=function(U,ne){var Te=this;if(U.dragMoving)this.fireUpdate();else if(U.boxSelecting){var it=[U.boxSelectStartLocation,Wi(ne.originalEvent,this.map.getContainer())],mt=this.featuresAt(null,it,"click"),vt=this.getUniqueIds(mt).filter(function(wt){return!Te.isSelected(wt)});vt.length&&(this.select(vt),vt.forEach(function(wt){return Te.doRender(wt)}),this.updateUIClasses({mouse:S.MOVE}))}this.stopExtendedInteractions(U)},Vn.toDisplayFeatures=function(U,ne,Te){ne.properties.active=this.isSelected(ne.properties.id)?N.ACTIVE:N.INACTIVE,Te(ne),this.fireActionable(),ne.properties.active===N.ACTIVE&&ne.geometry.type!==A.POINT&&Sa(ne).forEach(Te)},Vn.onTrash=function(){this.deleteFeature(this.getSelectedIds()),this.fireActionable()},Vn.onCombineFeatures=function(){var U=this.getSelected();if(!(U.length===0||U.length<2)){for(var ne=[],Te=[],it=U[0].type.replace("Multi",""),mt=0;mt<U.length;mt++){var vt=U[mt];if(vt.type.replace("Multi","")!==it)return;vt.type.includes("Multi")?vt.getCoordinates().forEach(function(sr){ne.push(sr)}):ne.push(vt.getCoordinates()),Te.push(vt.toGeoJSON())}if(Te.length>1){var wt=this.newFeature({type:A.FEATURE,properties:Te[0].properties,geometry:{type:"Multi"+it,coordinates:ne}});this.addFeature(wt),this.deleteFeature(this.getSelectedIds(),{silent:!0}),this.setSelected([wt.id]),this.map.fire(F.COMBINE_FEATURES,{createdFeatures:[wt.toGeoJSON()],deletedFeatures:Te})}this.fireActionable()}},Vn.onUncombineFeatures=function(){var U=this,ne=this.getSelected();if(ne.length!==0){for(var Te=[],it=[],mt=function(wt){var sr=ne[wt];U.isInstanceOf("MultiFeature",sr)&&(sr.getFeatures().forEach(function(_r){U.addFeature(_r),_r.properties=sr.properties,Te.push(_r.toGeoJSON()),U.select([_r.id])}),U.deleteFeature(sr.id,{silent:!0}),it.push(sr.toGeoJSON()))},vt=0;vt<ne.length;vt++)mt(vt);Te.length>1&&this.map.fire(F.UNCOMBINE_FEATURES,{createdFeatures:Te,deletedFeatures:it}),this.fireActionable()}};var Ca=be(O.VERTEX),zl=be(O.MIDPOINT),ro={fireUpdate:function(){this.map.fire(F.UPDATE,{action:L.CHANGE_COORDINATES,features:this.getSelected().map(function(U){return U.toGeoJSON()})})},fireActionable:function(U){this.setActionableState({combineFeatures:!1,uncombineFeatures:!1,trash:U.selectedCoordPaths.length>0})},startDragging:function(U,ne){this.map.dragPan.disable(),U.canDragMove=!0,U.dragMoveLocation=ne.lngLat},stopDragging:function(U){this.map.dragPan.enable(),U.dragMoving=!1,U.canDragMove=!1,U.dragMoveLocation=null},onVertex:function(U,ne){this.startDragging(U,ne);var Te=ne.featureTarget.properties,it=U.selectedCoordPaths.indexOf(Te.coord_path);Lt(ne)||it!==-1?Lt(ne)&&it===-1&&U.selectedCoordPaths.push(Te.coord_path):U.selectedCoordPaths=[Te.coord_path];var mt=this.pathsToCoordinates(U.featureId,U.selectedCoordPaths);this.setSelectedCoordinates(mt)},onMidpoint:function(U,ne){this.startDragging(U,ne);var Te=ne.featureTarget.properties;U.feature.addCoordinate(Te.coord_path,Te.lng,Te.lat),this.fireUpdate(),U.selectedCoordPaths=[Te.coord_path]},pathsToCoordinates:function(U,ne){return ne.map(function(Te){return{feature_id:U,coord_path:Te}})},onFeature:function(U,ne){U.selectedCoordPaths.length===0?this.startDragging(U,ne):this.stopDragging(U)},dragFeature:function(U,ne,Te){Di(this.getSelected(),Te),U.dragMoveLocation=ne.lngLat},dragVertex:function(U,ne,Te){for(var it=U.selectedCoordPaths.map(function(sr){return U.feature.getCoordinate(sr)}),mt=On(it.map(function(sr){return{type:A.FEATURE,properties:{},geometry:{type:A.POINT,coordinates:sr}}}),Te),vt=0;vt<it.length;vt++){var wt=it[vt];U.feature.updateCoordinate(U.selectedCoordPaths[vt],wt[0]+mt.lng,wt[1]+mt.lat)}},clickNoTarget:function(){this.changeMode(M.SIMPLE_SELECT)},clickInactive:function(){this.changeMode(M.SIMPLE_SELECT)},clickActiveFeature:function(U){U.selectedCoordPaths=[],this.clearSelectedCoordinates(),U.feature.changed()},onSetup:function(U){var ne=U.featureId,Te=this.getFeature(ne);if(!Te)throw new Error("You must provide a featureId to enter direct_select mode");if(Te.type===A.POINT)throw new TypeError("direct_select mode doesn't handle point features");var it={featureId:ne,feature:Te,dragMoveLocation:U.startPos||null,dragMoving:!1,canDragMove:!1,selectedCoordPaths:U.coordPath?[U.coordPath]:[]};return this.setSelectedCoordinates(this.pathsToCoordinates(ne,it.selectedCoordPaths)),this.setSelected(ne),Ai.disable(this),this.setActionableState({trash:!0}),it},onStop:function(){Ai.enable(this),this.clearSelectedCoordinates()},toDisplayFeatures:function(U,ne,Te){U.featureId===ne.properties.id?(ne.properties.active=N.ACTIVE,Te(ne),Sa(ne,{map:this.map,midpoints:!0,selectedPaths:U.selectedCoordPaths}).forEach(Te)):(ne.properties.active=N.INACTIVE,Te(ne)),this.fireActionable(U)},onTrash:function(U){U.selectedCoordPaths.sort(function(ne,Te){return Te.localeCompare(ne,"en",{numeric:!0})}).forEach(function(ne){return U.feature.removeCoordinate(ne)}),this.fireUpdate(),U.selectedCoordPaths=[],this.clearSelectedCoordinates(),this.fireActionable(U),U.feature.isValid()===!1&&(this.deleteFeature([U.featureId]),this.changeMode(M.SIMPLE_SELECT,{}))},onMouseMove:function(U,ne){var Te=ct(ne),it=Ca(ne),mt=zl(ne),vt=U.selectedCoordPaths.length===0;return Te&&vt||it&&!vt?this.updateUIClasses({mouse:S.MOVE}):this.updateUIClasses({mouse:S.NONE}),(it||Te||mt)&&U.dragMoving&&this.fireUpdate(),this.stopDragging(U),!0},onMouseOut:function(U){return U.dragMoving&&this.fireUpdate(),!0}};ro.onTouchStart=ro.onMouseDown=function(U,ne){return Ca(ne)?this.onVertex(U,ne):ct(ne)?this.onFeature(U,ne):zl(ne)?this.onMidpoint(U,ne):void 0},ro.onDrag=function(U,ne){if(U.canDragMove===!0){U.dragMoving=!0,ne.originalEvent.stopPropagation();var Te={lng:ne.lngLat.lng-U.dragMoveLocation.lng,lat:ne.lngLat.lat-U.dragMoveLocation.lat};U.selectedCoordPaths.length>0?this.dragVertex(U,ne,Te):this.dragFeature(U,ne,Te),U.dragMoveLocation=ne.lngLat}},ro.onClick=function(U,ne){return $t(ne)?this.clickNoTarget(U,ne):ct(ne)?this.clickActiveFeature(U,ne):At(ne)?this.clickInactive(U,ne):void this.stopDragging(U)},ro.onTap=function(U,ne){return $t(ne)?this.clickNoTarget(U,ne):ct(ne)?this.clickActiveFeature(U,ne):At(ne)?this.clickInactive(U,ne):void 0},ro.onTouchEnd=ro.onMouseUp=function(U){U.dragMoving&&this.fireUpdate(),this.stopDragging(U)};var no={};function _s(U,ne){return!!U.lngLat&&U.lngLat.lng===ne[0]&&U.lngLat.lat===ne[1]}no.onSetup=function(){var U=this.newFeature({type:A.FEATURE,properties:{},geometry:{type:A.POINT,coordinates:[]}});return this.addFeature(U),this.clearSelectedFeatures(),this.updateUIClasses({mouse:S.ADD}),this.activateUIButton(I.POINT),this.setActionableState({trash:!0}),{point:U}},no.stopDrawingAndRemove=function(U){this.deleteFeature([U.point.id],{silent:!0}),this.changeMode(M.SIMPLE_SELECT)},no.onTap=no.onClick=function(U,ne){this.updateUIClasses({mouse:S.MOVE}),U.point.updateCoordinate("",ne.lngLat.lng,ne.lngLat.lat),this.map.fire(F.CREATE,{features:[U.point.toGeoJSON()]}),this.changeMode(M.SIMPLE_SELECT,{featureIds:[U.point.id]})},no.onStop=function(U){this.activateUIButton(),U.point.getCoordinate().length||this.deleteFeature([U.point.id],{silent:!0})},no.toDisplayFeatures=function(U,ne,Te){var it=ne.properties.id===U.point.id;if(ne.properties.active=it?N.ACTIVE:N.INACTIVE,!it)return Te(ne)},no.onTrash=no.stopDrawingAndRemove,no.onKeyUp=function(U,ne){if(Qt(ne)||Gt(ne))return this.stopDrawingAndRemove(U,ne)};var js={onSetup:function(){var U=this.newFeature({type:A.FEATURE,properties:{},geometry:{type:A.POLYGON,coordinates:[[]]}});return this.addFeature(U),this.clearSelectedFeatures(),Ai.disable(this),this.updateUIClasses({mouse:S.ADD}),this.activateUIButton(I.POLYGON),this.setActionableState({trash:!0}),{polygon:U,currentVertexPosition:0}},clickAnywhere:function(U,ne){if(U.currentVertexPosition>0&&_s(ne,U.polygon.coordinates[0][U.currentVertexPosition-1]))return this.changeMode(M.SIMPLE_SELECT,{featureIds:[U.polygon.id]});this.updateUIClasses({mouse:S.ADD}),U.polygon.updateCoordinate("0."+U.currentVertexPosition,ne.lngLat.lng,ne.lngLat.lat),U.currentVertexPosition++,U.polygon.updateCoordinate("0."+U.currentVertexPosition,ne.lngLat.lng,ne.lngLat.lat)},clickOnVertex:function(U){return this.changeMode(M.SIMPLE_SELECT,{featureIds:[U.polygon.id]})},onMouseMove:function(U,ne){U.polygon.updateCoordinate("0."+U.currentVertexPosition,ne.lngLat.lng,ne.lngLat.lat),Nt(ne)&&this.updateUIClasses({mouse:S.POINTER})}};js.onTap=js.onClick=function(U,ne){return Nt(ne)?this.clickOnVertex(U,ne):this.clickAnywhere(U,ne)},js.onKeyUp=function(U,ne){Qt(ne)?(this.deleteFeature([U.polygon.id],{silent:!0}),this.changeMode(M.SIMPLE_SELECT)):Gt(ne)&&this.changeMode(M.SIMPLE_SELECT,{featureIds:[U.polygon.id]})},js.onStop=function(U){this.updateUIClasses({mouse:S.NONE}),Ai.enable(this),this.activateUIButton(),this.getFeature(U.polygon.id)!==void 0&&(U.polygon.removeCoordinate("0."+U.currentVertexPosition),U.polygon.isValid()?this.map.fire(F.CREATE,{features:[U.polygon.toGeoJSON()]}):(this.deleteFeature([U.polygon.id],{silent:!0}),this.changeMode(M.SIMPLE_SELECT,{},{silent:!0})))},js.toDisplayFeatures=function(U,ne,Te){var it=ne.properties.id===U.polygon.id;if(ne.properties.active=it?N.ACTIVE:N.INACTIVE,!it)return Te(ne);if(ne.geometry.coordinates.length!==0){var mt=ne.geometry.coordinates[0].length;if(!(mt<3)){if(ne.properties.meta=O.FEATURE,Te(Fi(U.polygon.id,ne.geometry.coordinates[0][0],"0.0",!1)),mt>3){var vt=ne.geometry.coordinates[0].length-3;Te(Fi(U.polygon.id,ne.geometry.coordinates[0][vt],"0."+vt,!1))}if(mt<=4){var wt=[[ne.geometry.coordinates[0][0][0],ne.geometry.coordinates[0][0][1]],[ne.geometry.coordinates[0][1][0],ne.geometry.coordinates[0][1][1]]];if(Te({type:A.FEATURE,properties:ne.properties,geometry:{coordinates:wt,type:A.LINE_STRING}}),mt===3)return}return Te(ne)}}},js.onTrash=function(U){this.deleteFeature([U.polygon.id],{silent:!0}),this.changeMode(M.SIMPLE_SELECT)};var Ha={onSetup:function(U){var ne,Te,it=(U=U||{}).featureId,mt="forward";if(it){if(!(ne=this.getFeature(it)))throw new Error("Could not find a feature with the provided featureId");var vt=U.from;if(vt&&vt.type==="Feature"&&vt.geometry&&vt.geometry.type==="Point"&&(vt=vt.geometry),vt&&vt.type==="Point"&&vt.coordinates&&vt.coordinates.length===2&&(vt=vt.coordinates),!vt||!Array.isArray(vt))throw new Error("Please use the `from` property to indicate which point to continue the line from");var wt=ne.coordinates.length-1;if(ne.coordinates[wt][0]===vt[0]&&ne.coordinates[wt][1]===vt[1])Te=wt+1,ne.addCoordinate.apply(ne,[Te].concat(ne.coordinates[wt]));else{if(ne.coordinates[0][0]!==vt[0]||ne.coordinates[0][1]!==vt[1])throw new Error("`from` should match the point at either the start or the end of the provided LineString");mt="backwards",Te=0,ne.addCoordinate.apply(ne,[Te].concat(ne.coordinates[0]))}}else ne=this.newFeature({type:A.FEATURE,properties:{},geometry:{type:A.LINE_STRING,coordinates:[]}}),Te=0,this.addFeature(ne);return this.clearSelectedFeatures(),Ai.disable(this),this.updateUIClasses({mouse:S.ADD}),this.activateUIButton(I.LINE),this.setActionableState({trash:!0}),{line:ne,currentVertexPosition:Te,direction:mt}},clickAnywhere:function(U,ne){if(U.currentVertexPosition>0&&_s(ne,U.line.coordinates[U.currentVertexPosition-1])||U.direction==="backwards"&&_s(ne,U.line.coordinates[U.currentVertexPosition+1]))return this.changeMode(M.SIMPLE_SELECT,{featureIds:[U.line.id]});this.updateUIClasses({mouse:S.ADD}),U.line.updateCoordinate(U.currentVertexPosition,ne.lngLat.lng,ne.lngLat.lat),U.direction==="forward"?(U.currentVertexPosition++,U.line.updateCoordinate(U.currentVertexPosition,ne.lngLat.lng,ne.lngLat.lat)):U.line.addCoordinate(0,ne.lngLat.lng,ne.lngLat.lat)},clickOnVertex:function(U){return this.changeMode(M.SIMPLE_SELECT,{featureIds:[U.line.id]})},onMouseMove:function(U,ne){U.line.updateCoordinate(U.currentVertexPosition,ne.lngLat.lng,ne.lngLat.lat),Nt(ne)&&this.updateUIClasses({mouse:S.POINTER})}};Ha.onTap=Ha.onClick=function(U,ne){if(Nt(ne))return this.clickOnVertex(U,ne);this.clickAnywhere(U,ne)},Ha.onKeyUp=function(U,ne){Gt(ne)?this.changeMode(M.SIMPLE_SELECT,{featureIds:[U.line.id]}):Qt(ne)&&(this.deleteFeature([U.line.id],{silent:!0}),this.changeMode(M.SIMPLE_SELECT))},Ha.onStop=function(U){Ai.enable(this),this.activateUIButton(),this.getFeature(U.line.id)!==void 0&&(U.line.removeCoordinate(""+U.currentVertexPosition),U.line.isValid()?this.map.fire(F.CREATE,{features:[U.line.toGeoJSON()]}):(this.deleteFeature([U.line.id],{silent:!0}),this.changeMode(M.SIMPLE_SELECT,{},{silent:!0})))},Ha.onTrash=function(U){this.deleteFeature([U.line.id],{silent:!0}),this.changeMode(M.SIMPLE_SELECT)},Ha.toDisplayFeatures=function(U,ne,Te){var it=ne.properties.id===U.line.id;if(ne.properties.active=it?N.ACTIVE:N.INACTIVE,!it)return Te(ne);ne.geometry.coordinates.length<2||(ne.properties.meta=O.FEATURE,Te(Fi(U.line.id,ne.geometry.coordinates[U.direction==="forward"?ne.geometry.coordinates.length-2:1],""+(U.direction==="forward"?ne.geometry.coordinates.length-2:1),!1)),Te(ne))};var km={simple_select:Vn,direct_select:ro,draw_point:no,draw_polygon:js,draw_line_string:Ha},Im={defaultMode:M.SIMPLE_SELECT,keybindings:!0,touchEnabled:!0,clickBuffer:2,touchBuffer:25,boxSelect:!0,displayControlsDefault:!0,styles:Xe,modes:km,controls:{},userProperties:!1},Mm={point:!0,line_string:!0,polygon:!0,trash:!0,combine_features:!0,uncombine_features:!0},mp={point:!1,line_string:!1,polygon:!1,trash:!1,combine_features:!1,uncombine_features:!1};function gp(U,ne){return U.map(function(Te){return Te.source?Te:Ae(Te,{id:Te.id+"."+ne,source:ne==="hot"?T.HOT:T.COLD})})}var hf={exports:{}};(function(U,ne){var Te="__lodash_hash_undefined__",it=9007199254740991,mt="[object Arguments]",vt="[object Array]",wt="[object Boolean]",sr="[object Date]",_r="[object Error]",Fr="[object Function]",Ir="[object Map]",_t="[object Number]",ar="[object Object]",Ln="[object Promise]",at="[object RegExp]",nr="[object Set]",Kt="[object String]",Nr="[object Symbol]",Sn="[object WeakMap]",aa="[object ArrayBuffer]",Da="[object DataView]",vs=/^\[object .+?Constructor\]$/,Fm=/^(?:0|[1-9]\d*)$/,ua={};ua["[object Float32Array]"]=ua["[object Float64Array]"]=ua["[object Int8Array]"]=ua["[object Int16Array]"]=ua["[object Int32Array]"]=ua["[object Uint8Array]"]=ua["[object Uint8ClampedArray]"]=ua["[object Uint16Array]"]=ua["[object Uint32Array]"]=!0,ua[mt]=ua[vt]=ua[aa]=ua[wt]=ua[Da]=ua[sr]=ua[_r]=ua[Fr]=ua[Ir]=ua[_t]=ua[ar]=ua[at]=ua[nr]=ua[Kt]=ua[Sn]=!1;var mu=typeof $o=="object"&&$o&&$o.Object===Object&&$o,pr=typeof self=="object"&&self&&self.Object===Object&&self,vn=mu||pr||Function("return this")(),jn=ne&&!ne.nodeType&&ne,Jo=jn&&U&&!U.nodeType&&U,gu=Jo&&Jo.exports===jn,Dn=gu&&mu.process,Nh=function(){try{return Dn&&Dn.binding&&Dn.binding("util")}catch{}}(),df=Nh&&Nh.isTypedArray;function Uh(Ct,Vt){for(var kr=-1,nn=Ct==null?0:Ct.length;++kr<nn;)if(Vt(Ct[kr],kr,Ct))return!0;return!1}function Io(Ct){var Vt=-1,kr=Array(Ct.size);return Ct.forEach(function(nn,Hi){kr[++Vt]=[Hi,nn]}),kr}function ga(Ct){var Vt=-1,kr=Array(Ct.size);return Ct.forEach(function(nn){kr[++Vt]=nn}),kr}var Ov,pf,_p,$h=Array.prototype,Pm=Function.prototype,Vh=Object.prototype,mf=vn["__core-js_shared__"],vp=Pm.toString,Qo=Vh.hasOwnProperty,yp=(Ov=/[^.]+$/.exec(mf&&mf.keys&&mf.keys.IE_PROTO||""))?"Symbol(src)_1."+Ov:"",wo=Vh.toString,hn=RegExp("^"+vp.call(Qo).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),xp=gu?vn.Buffer:void 0,gf=vn.Symbol,Eo=vn.Uint8Array,es=Vh.propertyIsEnumerable,Rv=$h.splice,ys=gf?gf.toStringTag:void 0,Aa=Object.getOwnPropertySymbols,jh=xp?xp.isBuffer:void 0,Om=(pf=Object.keys,_p=Object,function(Ct){return pf(_p(Ct))}),_u=_f(vn,"DataView"),_a=_f(vn,"Map"),Wh=_f(vn,"Promise"),Hh=_f(vn,"Set"),Ws=_f(vn,"WeakMap"),Ul=_f(Object,"create"),Gh=Mc(_u),ei=Mc(_a),Ow=Mc(Wh),Rm=Mc(Hh),vu=Mc(Ws),Lv=gf?gf.prototype:void 0,bp=Lv?Lv.valueOf:void 0;function xs(Ct){var Vt=-1,kr=Ct==null?0:Ct.length;for(this.clear();++Vt<kr;){var nn=Ct[Vt];this.set(nn[0],nn[1])}}function Ga(Ct){var Vt=-1,kr=Ct==null?0:Ct.length;for(this.clear();++Vt<kr;){var nn=Ct[Vt];this.set(nn[0],nn[1])}}function ul(Ct){var Vt=-1,kr=Ct==null?0:Ct.length;for(this.clear();++Vt<kr;){var nn=Ct[Vt];this.set(nn[0],nn[1])}}function qh(Ct){var Vt=-1,kr=Ct==null?0:Ct.length;for(this.__data__=new ul;++Vt<kr;)this.add(Ct[Vt])}function Ac(Ct){var Vt=this.__data__=new Ga(Ct);this.size=Vt.size}function Rw(Ct,Vt){var kr=Xh(Ct),nn=!kr&&Uv(Ct),Hi=!kr&&!nn&&xu(Ct),zn=!kr&&!nn&&!Hi&&Cp(Ct),va=kr||nn||Hi||zn,oa=va?function(Pa,fl){for(var hl=-1,mo=Array(Pa);++hl<Pa;)mo[hl]=fl(hl);return mo}(Ct.length,String):[],Mo=oa.length;for(var ya in Ct)!Vt&&!Qo.call(Ct,ya)||va&&(ya=="length"||Hi&&(ya=="offset"||ya=="parent")||zn&&(ya=="buffer"||ya=="byteLength"||ya=="byteOffset")||Lm(ya,Mo))||oa.push(ya);return oa}function kc(Ct,Vt){for(var kr=Ct.length;kr--;)if(Dm(Ct[kr][0],Vt))return kr;return-1}function $l(Ct){return Ct==null?Ct===void 0?"[object Undefined]":"[object Null]":ys&&ys in Object(Ct)?function(Vt){var kr=Qo.call(Vt,ys),nn=Vt[ys];try{Vt[ys]=void 0;var Hi=!0}catch{}var zn=wo.call(Vt);return Hi&&(kr?Vt[ys]=nn:delete Vt[ys]),zn}(Ct):function(Vt){return wo.call(Vt)}(Ct)}function Dv(Ct){return vf(Ct)&&$l(Ct)==mt}function yu(Ct,Vt,kr,nn,Hi){return Ct===Vt||(Ct==null||Vt==null||!vf(Ct)&&!vf(Vt)?Ct!=Ct&&Vt!=Vt:function(zn,va,oa,Mo,ya,Pa){var fl=Xh(zn),hl=Xh(va),mo=fl?vt:Ic(zn),Hs=hl?vt:Ic(va),yf=(mo=mo==mt?ar:mo)==ar,Ap=(Hs=Hs==mt?ar:Hs)==ar,xf=mo==Hs;if(xf&&xu(zn)){if(!xu(va))return!1;fl=!0,yf=!1}if(xf&&!yf)return Pa||(Pa=new Ac),fl||Cp(zn)?Vl(zn,va,oa,Mo,ya,Pa):function(ea,Pi,bf,Gs,Kh,go,qs){switch(bf){case Da:if(ea.byteLength!=Pi.byteLength||ea.byteOffset!=Pi.byteOffset)return!1;ea=ea.buffer,Pi=Pi.buffer;case aa:return!(ea.byteLength!=Pi.byteLength||!go(new Eo(ea),new Eo(Pi)));case wt:case sr:case _t:return Dm(+ea,+Pi);case _r:return ea.name==Pi.name&&ea.message==Pi.message;case at:case Kt:return ea==Pi+"";case Ir:var bs=Io;case nr:var Fc=1&Gs;if(bs||(bs=ga),ea.size!=Pi.size&&!Fc)return!1;var wf=qs.get(ea);if(wf)return wf==Pi;Gs|=2,qs.set(ea,Pi);var Xs=Vl(bs(ea),bs(Pi),Gs,Kh,go,qs);return qs.delete(ea),Xs;case Nr:if(bp)return bp.call(ea)==bp.call(Pi)}return!1}(zn,va,mo,oa,Mo,ya,Pa);if(!(1&oa)){var Zh=yf&&Qo.call(zn,"__wrapped__"),zm=Ap&&Qo.call(va,"__wrapped__");if(Zh||zm){var Lw=Zh?zn.value():zn,kp=zm?va.value():va;return Pa||(Pa=new Ac),ya(Lw,kp,oa,Mo,Pa)}}return xf?(Pa||(Pa=new Ac),function(ea,Pi,bf,Gs,Kh,go){var qs=1&bf,bs=zv(ea),Fc=bs.length,wf=zv(Pi).length;if(Fc!=wf&&!qs)return!1;for(var Xs=Fc;Xs--;){var jl=bs[Xs];if(!(qs?jl in Pi:Qo.call(Pi,jl)))return!1}var Nm=go.get(ea);if(Nm&&go.get(Pi))return Nm==Pi;var Ef=!0;go.set(ea,Pi),go.set(Pi,ea);for(var Ip=qs;++Xs<Fc;){var Tf=ea[jl=bs[Xs]],bu=Pi[jl];if(Gs)var Mp=qs?Gs(bu,Tf,jl,Pi,ea,go):Gs(Tf,bu,jl,ea,Pi,go);if(!(Mp===void 0?Tf===bu||Kh(Tf,bu,bf,Gs,go):Mp)){Ef=!1;break}Ip||(Ip=jl=="constructor")}if(Ef&&!Ip){var Sf=ea.constructor,$r=Pi.constructor;Sf==$r||!("constructor"in ea)||!("constructor"in Pi)||typeof Sf=="function"&&Sf instanceof Sf&&typeof $r=="function"&&$r instanceof $r||(Ef=!1)}return go.delete(ea),go.delete(Pi),Ef}(zn,va,oa,Mo,ya,Pa)):!1}(Ct,Vt,kr,nn,yu,Hi))}function Bv(Ct){return!(!Sp(Ct)||function(Vt){return!!yp&&yp in Vt}(Ct))&&(Tp(Ct)?hn:vs).test(Mc(Ct))}function wp(Ct){if(kr=(Vt=Ct)&&Vt.constructor,nn=typeof kr=="function"&&kr.prototype||Vh,Vt!==nn)return Om(Ct);var Vt,kr,nn,Hi=[];for(var zn in Object(Ct))Qo.call(Ct,zn)&&zn!="constructor"&&Hi.push(zn);return Hi}function Vl(Ct,Vt,kr,nn,Hi,zn){var va=1&kr,oa=Ct.length,Mo=Vt.length;if(oa!=Mo&&!(va&&Mo>oa))return!1;var ya=zn.get(Ct);if(ya&&zn.get(Vt))return ya==Vt;var Pa=-1,fl=!0,hl=2&kr?new qh:void 0;for(zn.set(Ct,Vt),zn.set(Vt,Ct);++Pa<oa;){var mo=Ct[Pa],Hs=Vt[Pa];if(nn)var yf=va?nn(Hs,mo,Pa,Vt,Ct,zn):nn(mo,Hs,Pa,Ct,Vt,zn);if(yf!==void 0){if(yf)continue;fl=!1;break}if(hl){if(!Uh(Vt,function(Ap,xf){if(Zh=xf,!hl.has(Zh)&&(mo===Ap||Hi(mo,Ap,kr,nn,zn)))return hl.push(xf);var Zh})){fl=!1;break}}else if(mo!==Hs&&!Hi(mo,Hs,kr,nn,zn)){fl=!1;break}}return zn.delete(Ct),zn.delete(Vt),fl}function zv(Ct){return function(Vt,kr,nn){var Hi=kr(Vt);return Xh(Vt)?Hi:function(zn,va){for(var oa=-1,Mo=va.length,ya=zn.length;++oa<Mo;)zn[ya+oa]=va[oa];return zn}(Hi,nn(Vt))}(Ct,Et,Nv)}function Ep(Ct,Vt){var kr,nn,Hi=Ct.__data__;return((nn=typeof(kr=Vt))=="string"||nn=="number"||nn=="symbol"||nn=="boolean"?kr!=="__proto__":kr===null)?Hi[typeof Vt=="string"?"string":"hash"]:Hi.map}function _f(Ct,Vt){var kr=function(nn,Hi){return nn==null?void 0:nn[Hi]}(Ct,Vt);return Bv(kr)?kr:void 0}xs.prototype.clear=function(){this.__data__=Ul?Ul(null):{},this.size=0},xs.prototype.delete=function(Ct){var Vt=this.has(Ct)&&delete this.__data__[Ct];return this.size-=Vt?1:0,Vt},xs.prototype.get=function(Ct){var Vt=this.__data__;if(Ul){var kr=Vt[Ct];return kr===Te?void 0:kr}return Qo.call(Vt,Ct)?Vt[Ct]:void 0},xs.prototype.has=function(Ct){var Vt=this.__data__;return Ul?Vt[Ct]!==void 0:Qo.call(Vt,Ct)},xs.prototype.set=function(Ct,Vt){var kr=this.__data__;return this.size+=this.has(Ct)?0:1,kr[Ct]=Ul&&Vt===void 0?Te:Vt,this},Ga.prototype.clear=function(){this.__data__=[],this.size=0},Ga.prototype.delete=function(Ct){var Vt=this.__data__,kr=kc(Vt,Ct);return!(kr<0)&&(kr==Vt.length-1?Vt.pop():Rv.call(Vt,kr,1),--this.size,!0)},Ga.prototype.get=function(Ct){var Vt=this.__data__,kr=kc(Vt,Ct);return kr<0?void 0:Vt[kr][1]},Ga.prototype.has=function(Ct){return kc(this.__data__,Ct)>-1},Ga.prototype.set=function(Ct,Vt){var kr=this.__data__,nn=kc(kr,Ct);return nn<0?(++this.size,kr.push([Ct,Vt])):kr[nn][1]=Vt,this},ul.prototype.clear=function(){this.size=0,this.__data__={hash:new xs,map:new(_a||Ga),string:new xs}},ul.prototype.delete=function(Ct){var Vt=Ep(this,Ct).delete(Ct);return this.size-=Vt?1:0,Vt},ul.prototype.get=function(Ct){return Ep(this,Ct).get(Ct)},ul.prototype.has=function(Ct){return Ep(this,Ct).has(Ct)},ul.prototype.set=function(Ct,Vt){var kr=Ep(this,Ct),nn=kr.size;return kr.set(Ct,Vt),this.size+=kr.size==nn?0:1,this},qh.prototype.add=qh.prototype.push=function(Ct){return this.__data__.set(Ct,Te),this},qh.prototype.has=function(Ct){return this.__data__.has(Ct)},Ac.prototype.clear=function(){this.__data__=new Ga,this.size=0},Ac.prototype.delete=function(Ct){var Vt=this.__data__,kr=Vt.delete(Ct);return this.size=Vt.size,kr},Ac.prototype.get=function(Ct){return this.__data__.get(Ct)},Ac.prototype.has=function(Ct){return this.__data__.has(Ct)},Ac.prototype.set=function(Ct,Vt){var kr=this.__data__;if(kr instanceof Ga){var nn=kr.__data__;if(!_a||nn.length<199)return nn.push([Ct,Vt]),this.size=++kr.size,this;kr=this.__data__=new ul(nn)}return kr.set(Ct,Vt),this.size=kr.size,this};var Nv=Aa?function(Ct){return Ct==null?[]:(Ct=Object(Ct),function(Vt,kr){for(var nn=-1,Hi=Vt==null?0:Vt.length,zn=0,va=[];++nn<Hi;){var oa=Vt[nn];kr(oa,nn,Vt)&&(va[zn++]=oa)}return va}(Aa(Ct),function(Vt){return es.call(Ct,Vt)}))}:function(){return[]},Ic=$l;function Lm(Ct,Vt){return!!(Vt=Vt??it)&&(typeof Ct=="number"||Fm.test(Ct))&&Ct>-1&&Ct%1==0&&Ct<Vt}function Mc(Ct){if(Ct!=null){try{return vp.call(Ct)}catch{}try{return Ct+""}catch{}}return""}function Dm(Ct,Vt){return Ct===Vt||Ct!=Ct&&Vt!=Vt}(_u&&Ic(new _u(new ArrayBuffer(1)))!=Da||_a&&Ic(new _a)!=Ir||Wh&&Ic(Wh.resolve())!=Ln||Hh&&Ic(new Hh)!=nr||Ws&&Ic(new Ws)!=Sn)&&(Ic=function(Ct){var Vt=$l(Ct),kr=Vt==ar?Ct.constructor:void 0,nn=kr?Mc(kr):"";if(nn)switch(nn){case Gh:return Da;case ei:return Ir;case Ow:return Ln;case Rm:return nr;case vu:return Sn}return Vt});var Uv=Dv(function(){return arguments}())?Dv:function(Ct){return vf(Ct)&&Qo.call(Ct,"callee")&&!es.call(Ct,"callee")},Xh=Array.isArray,xu=jh||function(){return!1};function Tp(Ct){if(!Sp(Ct))return!1;var Vt=$l(Ct);return Vt==Fr||Vt=="[object GeneratorFunction]"||Vt=="[object AsyncFunction]"||Vt=="[object Proxy]"}function Bm(Ct){return typeof Ct=="number"&&Ct>-1&&Ct%1==0&&Ct<=it}function Sp(Ct){var Vt=typeof Ct;return Ct!=null&&(Vt=="object"||Vt=="function")}function vf(Ct){return Ct!=null&&typeof Ct=="object"}var Cp=df?function(Ct){return function(Vt){return Ct(Vt)}}(df):function(Ct){return vf(Ct)&&Bm(Ct.length)&&!!ua[$l(Ct)]};function Et(Ct){return(Vt=Ct)!=null&&Bm(Vt.length)&&!Tp(Vt)?Rw(Ct):wp(Ct);var Vt}U.exports=function(Ct,Vt){return yu(Ct,Vt)}})(hf,hf.exports);var Sc=s(hf.exports);function Jr(U,ne){return U.length===ne.length&&JSON.stringify(U.map(function(Te){return Te}).sort())===JSON.stringify(ne.map(function(Te){return Te}).sort())}var pi={Polygon:ze,LineString:Ge,Point:et,MultiPolygon:fe,MultiLineString:fe,MultiPoint:fe},Nl=Object.freeze({__proto__:null,CommonSelectors:dr,constrainFeatureMovement:On,createMidPoint:Ta,createSupplementaryPoints:Sa,createVertex:Fi,doubleClickZoom:Ai,euclideanDistance:Ee,featuresAt:re,getFeatureAtAndSetCursors:Ye,isClick:ut,isEventAtCoordinates:_s,isTap:Ne,mapEventToBoundingBox:ue,ModeHandler:a,moveFeatures:Di,sortFeatures:te,stringSetsAreEqual:Jr,StringSet:J,theme:Xe,toDenseArray:X}),pu=function(U,ne){var Te={options:U=function(mt){mt===void 0&&(mt={});var vt=Ae(mt);return mt.controls||(vt.controls={}),mt.displayControlsDefault===!1?vt.controls=Ae(mp,mt.controls):vt.controls=Ae(Mm,mt.controls),(vt=Ae(Im,vt)).styles=gp(vt.styles,"cold").concat(gp(vt.styles,"hot")),vt}(U)};ne=function(mt,vt){return vt.modes=M,vt.getFeatureIdsAt=function(wt){return re.click({point:wt},null,mt).map(function(sr){return sr.properties.id})},vt.getSelectedIds=function(){return mt.store.getSelectedIds()},vt.getSelected=function(){return{type:A.FEATURE_COLLECTION,features:mt.store.getSelectedIds().map(function(wt){return mt.store.get(wt)}).map(function(wt){return wt.toGeoJSON()})}},vt.getSelectedPoints=function(){return{type:A.FEATURE_COLLECTION,features:mt.store.getSelectedCoordinates().map(function(wt){return{type:A.FEATURE,properties:{},geometry:{type:A.POINT,coordinates:wt.coordinates}}})}},vt.set=function(wt){if(wt.type===void 0||wt.type!==A.FEATURE_COLLECTION||!Array.isArray(wt.features))throw new Error("Invalid FeatureCollection");var sr=mt.store.createRenderBatch(),_r=mt.store.getAllIds().slice(),Fr=vt.add(wt),Ir=new J(Fr);return(_r=_r.filter(function(_t){return!Ir.has(_t)})).length&&vt.delete(_r),sr(),Fr},vt.add=function(wt){var sr=JSON.parse(JSON.stringify(Ot(wt))).features.map(function(_r){if(_r.id=_r.id||Pe(),_r.geometry===null)throw new Error("Invalid geometry: null");if(mt.store.get(_r.id)===void 0||mt.store.get(_r.id).type!==_r.geometry.type){var Fr=pi[_r.geometry.type];if(Fr===void 0)throw new Error("Invalid geometry type: "+_r.geometry.type+".");var Ir=new Fr(mt,_r);mt.store.add(Ir)}else{var _t=mt.store.get(_r.id);_t.properties=_r.properties,Sc(_t.properties,_r.properties)||mt.store.featureChanged(_t.id),Sc(_t.getCoordinates(),_r.geometry.coordinates)||_t.incomingCoords(_r.geometry.coordinates)}return _r.id});return mt.store.render(),sr},vt.get=function(wt){var sr=mt.store.get(wt);if(sr)return sr.toGeoJSON()},vt.getAll=function(){return{type:A.FEATURE_COLLECTION,features:mt.store.getAll().map(function(wt){return wt.toGeoJSON()})}},vt.delete=function(wt){return mt.store.delete(wt,{silent:!0}),vt.getMode()!==M.DIRECT_SELECT||mt.store.getSelectedIds().length?mt.store.render():mt.events.changeMode(M.SIMPLE_SELECT,void 0,{silent:!0}),vt},vt.deleteAll=function(){return mt.store.delete(mt.store.getAllIds(),{silent:!0}),vt.getMode()===M.DIRECT_SELECT?mt.events.changeMode(M.SIMPLE_SELECT,void 0,{silent:!0}):mt.store.render(),vt},vt.changeMode=function(wt,sr){return sr===void 0&&(sr={}),wt===M.SIMPLE_SELECT&&vt.getMode()===M.SIMPLE_SELECT?(Jr(sr.featureIds||[],mt.store.getSelectedIds())||(mt.store.setSelected(sr.featureIds,{silent:!0}),mt.store.render()),vt):(wt===M.DIRECT_SELECT&&vt.getMode()===M.DIRECT_SELECT&&sr.featureId===mt.store.getSelectedIds()[0]||mt.events.changeMode(wt,sr,{silent:!0}),vt)},vt.getMode=function(){return mt.events.getMode()},vt.trash=function(){return mt.events.trash({silent:!0}),vt},vt.combineFeatures=function(){return mt.events.combineFeatures({silent:!0}),vt},vt.uncombineFeatures=function(){return mt.events.uncombineFeatures({silent:!0}),vt},vt.setFeatureProperty=function(wt,sr,_r){return mt.store.setFeatureProperty(wt,sr,_r),vt},vt}(Te,ne),Te.api=ne;var it=ye(Te);return ne.onAdd=it.onAdd,ne.onRemove=it.onRemove,ne.types=I,ne.options=U,ne};function Cc(U){pu(U,this)}return Cc.modes=km,Cc.constants=j,Cc.lib=Nl,Cc})})(yU);var R_e=yU.exports;const L_e=qb(R_e),Vs=(t,n)=>{const a=t.__vccOpts||t;for(const[s,c]of n)a[s]=c;return a},D_e=t=>(rf("data-v-afd36e5b"),t=t(),nf(),t),B_e=D_e(()=>gt("span",null,"   文物古建列表",-1)),z_e=["disabled"],N_e={class:"info-list"},U_e={class:"info-cards"},$_e=["onClick"],V_e={key:0,class:"info-list"},j_e={class:"info-cards"},W_e=["onClick"],H_e=Ft({name:"leftBar",components:{}}),G_e=Object.assign(H_e,{props:["listData","map"],emits:["openManagement","refreshData","changeCurrentUnit","clearCurrentUnit","showBuilding"],setup(t,{emit:n}){const{proxy:a}=Tn(),s=Ph(),c=t,f=c.map,d=n,p=Ze(!0);Ze(!0);const g=Ze(1),y=Ze(1),b=10,E=Ze("");function T(J){g.value=J}function S(J){y.value=J}function I(){g.value=1,y.value=1}const A=Ze(""),M=Ze(""),F=Ze("文保单位"),L=Ve(function(){let J=c.listData;const le=M.value;return A.value==""?M.value="":le!==""&&(J=J.filter(Fe=>String(Fe.name).toLowerCase().indexOf(le)>-1||String(Fe.type).toLowerCase().indexOf(le)>-1||String(Fe.age).toLowerCase().indexOf(le)>-1)),J.sort(function(re,Fe){var Ye=re.id,Ee=Fe.id;return Ye<Ee?-1:Ye>Ee?1:0})}),O=Ve(function(){let J=N.value;const le=M.value;return A.value==""?M.value="":le!==""&&(J=J.filter(Fe=>Object.keys(Fe).some(Ye=>String(Fe[Ye]).toLowerCase().indexOf(le)>-1))),J.sort(function(re,Fe){var Ye=re.id,Ee=Fe.id;return Ye<Ee?-1:Ye>Ee?1:0})}),N=Ze(null);a.$axios.get("/api/buildings/list",{responseType:"json"}).then(J=>{N.value=J.data.data});function Q(){A.value=""}function ie(){M.value=A.value}function j(J){Vu.confirm("确认永久删除该记录？","警告",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then(()=>{J==E.value&&(d("clearCurrentUnit",J),E.value=""),a.$axios.delete(`/units/info/${J}`).then(le=>{d("refreshData"),cs({title:"成功",message:"文物已成功删除",position:"bottom-right",type:"success"}),te()}).catch(le=>{console.error("API Error:",le.response.data),cs({title:"失败",message:"删除失败",position:"bottom-right",type:"error"})})}).catch(()=>{})}function V(J){J==E.value?(d("clearCurrentUnit",J),E.value=""):(d("changeCurrentUnit",J),E.value=J)}function D(J){d("showBuilding",J)}function te(){a.$axios.get("/api/map/version",{responseType:"json"}).then(J=>{var le=J.data.data;f.getSource("vector-source").setTiles(["http://47.103.20.189/server/api/map/mvt/units/{z}/{x}/{y}?version="+le])})}async function ue(J){s.isLoggedIn?Vu.confirm("是否下载该矢量文件？","提示",{confirmButtonText:"是",cancelButtonText:"否",type:"info"}).then(()=>{a.$axios.get(`/buildings/export/geojson/${J}`,{responseType:"blob"}).then(le=>{const re=new Blob([le.data],{type:"application/json"}),Fe=N.value.find(ut=>ut.id===J).name,Ye=window.URL.createObjectURL(re),Ee=document.createElement("a");Ee.href=Ye,Ee.download=`${Fe}.geojson`,document.body.appendChild(Ee),Ee.click(),window.URL.revokeObjectURL(Ye)}).catch(le=>{console.error("API Error:",le.response.data),cs({title:"失败",message:"下载失败",position:"bottom-right",type:"error"})})}).catch(()=>{}):Vu.alert("您暂无下载权限，请在登录后操作。","提示",{confirmButtonText:"确定"})}return di(()=>{}),(J,le)=>{const re=Ec,Fe=Ll,Ye=Hn,Ee=uu,ut=uf,Ne=wN,He=xv,Oe=uhe,Pe=Dh,rt=BN,et=Zb,Ge=Nfe,ze=Xb;return De(),Ht(ze,{class:"container"},{default:we(()=>[me(Ge,{class:ht(["aside_main map-overlay-left",{aside_main_show:!p.value}])},{default:we(()=>[me(Pe,null,{default:we(()=>[me(et,null,{default:we(()=>[me(Pe,null,{default:we(()=>[me(Fe,{align:"middle"},{default:we(()=>[me(re,{span:16,id:"title"},{default:we(()=>[B_e]),_:1}),me(re,{span:8,style:{display:"flex","align-items":"center"}},{default:we(()=>[W(s).isLoggedIn?(De(),yt("button",{key:0,class:"btn-manage",onClick:le[0]||(le[0]=oe=>d("openManagement")),disabled:!W(s).isLoggedIn}," 信息管理 ",8,z_e)):Wt("",!0)]),_:1})]),_:1}),me(ut,{style:{height:"5vh",width:"95%"},modelValue:A.value,"onUpdate:modelValue":le[1]||(le[1]=oe=>A.value=oe),class:"searchinput",placeholder:"请输入文物信息（如名称、类型、年代）"},{suffix:we(()=>[me(Ye,{onClick:Q,style:{cursor:"pointer"}},{default:we(()=>[me(W(Qu))]),_:1})]),append:we(()=>[me(Ee,{icon:W(sae),onClick:ie,style:{height:"5vh"}},null,8,["icon"])]),_:1},8,["modelValue"]),me(Fe,{style:{height:"5vh",margin:"1vh"},align:"bottom"},{default:we(()=>[me(re,{span:6,class:"text1"},{default:we(()=>[Sr("搜索结果：")]),_:1}),me(re,{span:4},{default:we(()=>[me(Ye,{class:"btn-refresh",size:"12",onClick:le[2]||(le[2]=oe=>d("refreshData"))},{default:we(()=>[me(W(aae))]),_:1})]),_:1}),me(re,{span:14,class:"text1"},{default:we(()=>[me(He,{modelValue:F.value,"onUpdate:modelValue":le[3]||(le[3]=oe=>F.value=oe),onChange:I,size:"small",fill:"#758a99"},{default:we(()=>[me(Ne,{class:"radio-btn",value:"units",label:"文保单位"}),me(Ne,{class:"radio-btn",value:"buildings",label:"测绘数据"})]),_:1},8,["modelValue"])]),_:1})]),_:1}),me(Oe),ci(gt("div",N_e,[gt("div",U_e,[me(Pe,null,{default:we(()=>[(De(!0),yt(mn,null,pa(L.value.slice((g.value-1)*b,g.value*b),(oe,Me)=>(De(),yt("div",{class:"info-card",onClick:fe=>V(oe.id),key:oe.id},[me(Fe,{align:"middle"},{default:we(()=>[me(re,{span:22},{default:we(()=>[me(Fe,{class:"unit-name",align:"middle"},{default:we(()=>[Sr(Lr(oe.name),1)]),_:2},1024),me(Fe,{style:{height:"0.5vh"}}),me(Fe,{class:"unit-info",align:"middle"},{default:we(()=>[me(re,{span:12},{default:we(()=>[Sr(Lr(oe.type)+" ",1),ci(gt("span",null,"未知类型",512),[[la,!oe.type]])]),_:2},1024),me(re,{span:12},{default:we(()=>[Sr(Lr(oe.age)+" ",1),ci(gt("span",null,"未知年代",512),[[la,!oe.age]])]),_:2},1024)]),_:2},1024)]),_:2},1024),me(re,{span:2},{default:we(()=>[W(s).isLoggedIn&&W(s).role==1?(De(),Ht(Ye,{key:0,size:14,color:"#8A8A8A",onClick:si(fe=>j(oe.id),["stop"])},{default:we(()=>[me(W(eae))]),_:2},1032,["onClick"])):Wt("",!0)]),_:2},1024)]),_:2},1024)],8,$_e))),128))]),_:1})]),me(Fe,{justify:"center"},{default:we(()=>[me(rt,{small:"",background:"",layout:"prev, pager, next",total:L.value.length,pagesize:b,"pager-count":5,class:"page mt-4",onCurrentChange:T},null,8,["total"])]),_:1})],512),[[la,F.value=="文保单位"]]),F.value=="测绘数据"?(De(),yt("div",V_e,[gt("div",j_e,[me(Pe,null,{default:we(()=>[(De(!0),yt(mn,null,pa(O.value.slice((y.value-1)*b,y.value*b),(oe,Me)=>(De(),yt("div",{class:"info-card-small",onClick:fe=>D(oe.id),key:oe.id},[me(Fe,{class:"building-name"},{default:we(()=>[me(re,{span:22},{default:we(()=>[Sr(Lr(oe.name),1)]),_:2},1024),me(re,{span:2},{default:we(()=>[me(Ye,{size:14,color:"#8A8A8A",onClick:si(fe=>ue(oe.id),["stop"])},{default:we(()=>[me(W(qie))]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)],8,W_e))),128))]),_:1})]),me(Fe,{justify:"center"},{default:we(()=>[me(rt,{small:"",background:"",layout:"prev, pager, next",total:O.value.length,pagesize:b,"pager-count":4,class:"page mt-4",onCurrentChange:S},null,8,["total"])]),_:1})])):Wt("",!0)]),_:1})]),_:1})]),_:1})]),_:1},8,["class"])]),_:1})}}}),xU=Vs(G_e,[["__scopeId","data-v-afd36e5b"]]);function mk(t,n,a){a===void 0&&(a={});var s={type:"Feature"};return(a.id===0||a.id)&&(s.id=a.id),a.bbox&&(s.bbox=a.bbox),s.properties=n||{},s.geometry=t,s}function q_e(t,n,a){if(a===void 0&&(a={}),!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");if(t.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!F5(t[0])||!F5(t[1]))throw new Error("coordinates must contain numbers");var s={type:"Point",coordinates:t};return mk(s,n,a)}function X_e(t,n,a){a===void 0&&(a={});for(var s=0,c=t;s<c.length;s++){var f=c[s];if(f.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var d=0;d<f[f.length-1].length;d++)if(f[f.length-1][d]!==f[0][d])throw new Error("First and last Position are not equivalent.")}var p={type:"Polygon",coordinates:t};return mk(p,n,a)}function Z_e(t,n,a){if(a===void 0&&(a={}),t.length<2)throw new Error("coordinates must be an array of two or more positions");var s={type:"LineString",coordinates:t};return mk(s,n,a)}function K_e(t,n){n===void 0&&(n={});var a={type:"FeatureCollection"};return n.id&&(a.id=n.id),n.bbox&&(a.bbox=n.bbox),a.features=t,a}function F5(t){return!isNaN(t)&&t!==null&&!Array.isArray(t)}function bU(t,n,a){if(t!==null)for(var s,c,f,d,p,g,y,b=0,E=0,T,S=t.type,I=S==="FeatureCollection",A=S==="Feature",M=I?t.features.length:1,F=0;F<M;F++){y=I?t.features[F].geometry:A?t.geometry:t,T=y?y.type==="GeometryCollection":!1,p=T?y.geometries.length:1;for(var L=0;L<p;L++){var O=0,N=0;if(d=T?y.geometries[L]:y,d!==null){g=d.coordinates;var Q=d.type;switch(b=a&&(Q==="Polygon"||Q==="MultiPolygon")?1:0,Q){case null:break;case"Point":if(n(g,E,F,O,N)===!1)return!1;E++,O++;break;case"LineString":case"MultiPoint":for(s=0;s<g.length;s++){if(n(g[s],E,F,O,N)===!1)return!1;E++,Q==="MultiPoint"&&O++}Q==="LineString"&&O++;break;case"Polygon":case"MultiLineString":for(s=0;s<g.length;s++){for(c=0;c<g[s].length-b;c++){if(n(g[s][c],E,F,O,N)===!1)return!1;E++}Q==="MultiLineString"&&O++,Q==="Polygon"&&N++}Q==="Polygon"&&O++;break;case"MultiPolygon":for(s=0;s<g.length;s++){for(N=0,c=0;c<g[s].length;c++){for(f=0;f<g[s][c].length-b;f++){if(n(g[s][c][f],E,F,O,N)===!1)return!1;E++}N++}O++}break;case"GeometryCollection":for(s=0;s<d.geometries.length;s++)if(bU(d.geometries[s],n,a)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function MC(t){var n=[1/0,1/0,-1/0,-1/0];return bU(t,function(a){n[0]>a[0]&&(n[0]=a[0]),n[1]>a[1]&&(n[1]=a[1]),n[2]<a[0]&&(n[2]=a[0]),n[3]<a[1]&&(n[3]=a[1])}),n}MC.default=MC;const Y_e={key:0,id:"point-settings"},J_e={key:1,id:"line-settings"},Q_e={key:2,id:"polygon-settings"},eve=Ft({name:"styleSetting",components:{},computed:{}}),tve=Object.assign(eve,{props:["unitId","drawData","map","featureName"],emits:["styleChangeEvent"],setup(t,{emit:n}){const a=t,{unitId:s,drawData:c,map:f,featureName:d}=a,p=Gr("styleConfig"),g=["pointStyle","lineStyle","polygonStyle"],y=n;var b=c.find(F=>F.name===a.featureName),E=b.type,T=Ze(b.style1==null?p[g[E]].style1.default:b.style1),S=Ze(b.style2==null?p[g[E]].style2.default:b.style2),I;try{I=Ze(b.style3==null?p[g[E]].style3.default:b.style3)}catch{I=Ze(0)}A(),gr(()=>T.value,(F,L)=>{var O=p[g[E]].style1.name,N=p[g[E]].style1.options[F].value;b.style1=F,y("styleChangeEvent",c),f.setPaintProperty(s+"-"+a.featureName+"-layer",O,N),M(E,O,N)}),gr(()=>S.value,(F,L)=>{var O=p[g[E]].style2.name,N=p[g[E]].style2.options[F].value;b.style2=F,y("styleChangeEvent",c),f.setPaintProperty(s+"-"+a.featureName+"-layer",O,N),M(E,O,N)}),gr(()=>I.value,(F,L)=>{var O=p[g[E]].style3.name,N=p[g[E]].style3.options[F].value;b.style3=F,y("styleChangeEvent",c),f.setPaintProperty(s+"-"+a.featureName+"-layer",O,N),M(E,O,N)});function A(){M(E,p[g[E]].style1.name,p[g[E]].style1.options[T.value].value),M(E,p[g[E]].style2.name,p[g[E]].style2.options[S.value].value),E!=2&&M(E,p[g[E]].style3.name,p[g[E]].style3.options[I.value].value),E==0?(f.setPaintProperty("gl-draw-point-active.hot","circle-stroke-color","#FAF200"),f.setPaintProperty("gl-draw-point-active.cold","circle-stroke-color","#FAF200"),f.setPaintProperty("gl-draw-point-inactive.hot","circle-stroke-color","#FAF200"),f.setPaintProperty("gl-draw-point-inactive.cold","circle-stroke-color","#FAF200"),f.setPaintProperty("gl-draw-point-static.hot","circle-stroke-color","#FAF200"),f.setPaintProperty("gl-draw-point-static.cold","circle-stroke-color","#FAF200"),f.setPaintProperty("gl-draw-point-stroke-active.hot","circle-color","#FAF200"),f.setPaintProperty("gl-draw-point-stroke-active.cold","circle-color","#FAF200")):(f.setPaintProperty("gl-draw-point-active.hot","circle-stroke-color","#FFFFFF"),f.setPaintProperty("gl-draw-point-active.cold","circle-stroke-color","#FFFFFF"),f.setPaintProperty("gl-draw-point-inactive.hot","circle-stroke-color","#FFFFFF"),f.setPaintProperty("gl-draw-point-inactive.cold","circle-stroke-color","#FFFFFF"),f.setPaintProperty("gl-draw-point-static.hot","circle-stroke-color","#FFFFFF"),f.setPaintProperty("gl-draw-point-static.cold","circle-stroke-color","#FFFFFF"),f.setPaintProperty("gl-draw-point-stroke-active.hot","circle-color","#FFFFFF"),f.setPaintProperty("gl-draw-point-stroke-active.cold","circle-color","#FFFFFF"),f.setPaintProperty("gl-draw-point-active.hot","circle-radius",5),f.setPaintProperty("gl-draw-point-active.hot","circle-color","#fbb03b"),f.setPaintProperty("gl-draw-point-active.hot","circle-stroke-width",2),f.setPaintProperty("gl-draw-point-active.cold","circle-radius",5),f.setPaintProperty("gl-draw-point-active.cold","circle-color","#fbb03b"),f.setPaintProperty("gl-draw-point-active.cold","circle-stroke-width",2)),E==2&&(M(1,"line-color","#fbb03b"),M(1,"line-width",2),M(1,"line-dasharray",[.2,2]))}function M(F,L,O){switch(F){case 0:f.setPaintProperty("gl-draw-point-active.hot",L,O),f.setPaintProperty("gl-draw-point-active.cold",L,O),f.setPaintProperty("gl-draw-point-inactive.hot",L,O),f.setPaintProperty("gl-draw-point-inactive.cold",L,O),f.setPaintProperty("gl-draw-point-static.hot",L,O),f.setPaintProperty("gl-draw-point-static.cold",L,O);break;case 1:f.setPaintProperty("gl-draw-line-active.hot",L,O),f.setPaintProperty("gl-draw-line-active.cold",L,O),f.setPaintProperty("gl-draw-line-inactive.hot",L,O),f.setPaintProperty("gl-draw-line-inactive.cold",L,O),f.setPaintProperty("gl-draw-line-static.hot",L,O),f.setPaintProperty("gl-draw-line-static.cold",L,O);break;case 2:f.setPaintProperty("gl-draw-polygon-fill-active.hot",L,O),f.setPaintProperty("gl-draw-polygon-fill-active.cold",L,O),f.setPaintProperty("gl-draw-polygon-fill-inactive.hot",L,O),f.setPaintProperty("gl-draw-polygon-fill-inactive.cold",L,O),f.setPaintProperty("gl-draw-polygon-fill-static.hot",L,O),f.setPaintProperty("gl-draw-polygon-fill-static.cold",L,O);break;default:return}}return(F,L)=>{const O=Ec,N=Jb,Q=Yb,ie=Ll;return De(),yt(mn,null,[W(E)==0?(De(),yt("div",Y_e,[me(ie,null,{default:we(()=>[me(O,{span:12,class:"text"},{default:we(()=>[Sr(Lr(W(p).pointStyle.style1.label)+"： ",1)]),_:1}),me(O,{span:12},{default:we(()=>[me(Q,{modelValue:W(T),"onUpdate:modelValue":L[0]||(L[0]=j=>ai(T)?T.value=j:T=j),class:"m-2",size:"small"},{default:we(()=>[(De(!0),yt(mn,null,pa(W(p).pointStyle.style1.options,(j,V)=>(De(),Ht(N,{value:V,label:j.label},null,8,["value","label"]))),256))]),_:1},8,["modelValue"])]),_:1})]),_:1}),me(ie,null,{default:we(()=>[me(O,{span:12,class:"text"},{default:we(()=>[Sr(Lr(W(p).pointStyle.style2.label)+"： ",1)]),_:1}),me(O,{span:12},{default:we(()=>[me(Q,{modelValue:W(S),"onUpdate:modelValue":L[1]||(L[1]=j=>ai(S)?S.value=j:S=j),class:"m-2",size:"small"},{default:we(()=>[(De(!0),yt(mn,null,pa(W(p).pointStyle.style2.options,(j,V)=>(De(),Ht(N,{value:V,label:j.label},null,8,["value","label"]))),256))]),_:1},8,["modelValue"])]),_:1})]),_:1}),me(ie,null,{default:we(()=>[me(O,{span:12,class:"text"},{default:we(()=>[Sr(Lr(W(p).pointStyle.style3.label)+"： ",1)]),_:1}),me(O,{span:12},{default:we(()=>[me(Q,{modelValue:W(I),"onUpdate:modelValue":L[2]||(L[2]=j=>ai(I)?I.value=j:I=j),class:"m-2",size:"small"},{default:we(()=>[(De(!0),yt(mn,null,pa(W(p).pointStyle.style3.options,(j,V)=>(De(),Ht(N,{value:V,label:j.label},null,8,["value","label"]))),256))]),_:1},8,["modelValue"])]),_:1})]),_:1})])):Wt("",!0),W(E)==1?(De(),yt("div",J_e,[me(ie,null,{default:we(()=>[me(O,{span:12,class:"text"},{default:we(()=>[Sr(Lr(W(p).lineStyle.style1.label)+"： ",1)]),_:1}),me(O,{span:12},{default:we(()=>[me(Q,{modelValue:W(T),"onUpdate:modelValue":L[3]||(L[3]=j=>ai(T)?T.value=j:T=j),class:"m-2",size:"small"},{default:we(()=>[(De(!0),yt(mn,null,pa(W(p).lineStyle.style1.options,(j,V)=>(De(),Ht(N,{value:V,label:j.label},null,8,["value","label"]))),256))]),_:1},8,["modelValue"])]),_:1})]),_:1}),me(ie,null,{default:we(()=>[me(O,{span:12,class:"text"},{default:we(()=>[Sr(Lr(W(p).lineStyle.style2.label)+"： ",1)]),_:1}),me(O,{span:12},{default:we(()=>[me(Q,{modelValue:W(S),"onUpdate:modelValue":L[4]||(L[4]=j=>ai(S)?S.value=j:S=j),class:"m-2",size:"small"},{default:we(()=>[(De(!0),yt(mn,null,pa(W(p).lineStyle.style2.options,(j,V)=>(De(),Ht(N,{value:V,label:j.label},null,8,["value","label"]))),256))]),_:1},8,["modelValue"])]),_:1})]),_:1}),me(ie,null,{default:we(()=>[me(O,{span:12,class:"text"},{default:we(()=>[Sr(Lr(W(p).lineStyle.style3.label)+"： ",1)]),_:1}),me(O,{span:12},{default:we(()=>[me(Q,{modelValue:W(I),"onUpdate:modelValue":L[5]||(L[5]=j=>ai(I)?I.value=j:I=j),class:"m-2",size:"small"},{default:we(()=>[(De(!0),yt(mn,null,pa(W(p).lineStyle.style3.options,(j,V)=>(De(),Ht(N,{value:V,label:j.label},null,8,["value","label"]))),256))]),_:1},8,["modelValue"])]),_:1})]),_:1})])):Wt("",!0),W(E)==2?(De(),yt("div",Q_e,[me(ie,null,{default:we(()=>[me(O,{span:12,class:"text"},{default:we(()=>[Sr(Lr(W(p).polygonStyle.style1.label)+"： ",1)]),_:1}),me(O,{span:12},{default:we(()=>[me(Q,{modelValue:W(T),"onUpdate:modelValue":L[6]||(L[6]=j=>ai(T)?T.value=j:T=j),class:"m-2",size:"small"},{default:we(()=>[(De(!0),yt(mn,null,pa(W(p).polygonStyle.style1.options,(j,V)=>(De(),Ht(N,{value:V,label:j.label},null,8,["value","label"]))),256))]),_:1},8,["modelValue"])]),_:1})]),_:1}),me(ie,null,{default:we(()=>[me(O,{span:12,class:"text"},{default:we(()=>[Sr(Lr(W(p).polygonStyle.style2.label)+"： ",1)]),_:1}),me(O,{span:12},{default:we(()=>[me(Q,{modelValue:W(S),"onUpdate:modelValue":L[7]||(L[7]=j=>ai(S)?S.value=j:S=j),class:"m-2",size:"small"},{default:we(()=>[(De(!0),yt(mn,null,pa(W(p).polygonStyle.style2.options,(j,V)=>(De(),Ht(N,{value:V,label:j.label},null,8,["value","label"]))),256))]),_:1},8,["modelValue"])]),_:1})]),_:1})])):Wt("",!0)],64)}}}),wU=Vs(tve,[["__scopeId","data-v-835d0e77"]]),rve={key:0},nve={key:0},ive={key:1},ave=Ft({name:"infoSetting",components:{},computed:{}}),ove=Object.assign(ave,{props:["unitId"],setup(t){const n=Ph(),s=t.unitId,c=Ze(null),f=Ze(!0),{proxy:d}=Tn();p();function p(){d.$axios.get(`/api/units/info/${s}`,{responseType:"json"}).then(b=>{c.value=b.data.data}).catch(b=>{console.error("API Error:",b.response.data)})}function g(){d.$axios.put(`/units/info/${s}`,c.value).then(b=>{}).catch(b=>{console.error("API Error:",b.response.data)})}function y(){n.isLoggedIn?f.value=!1:Vu.alert("您暂无编辑权限，请在登录后操作。","提示",{confirmButtonText:"确定"})}return(b,E)=>{const T=Ec,S=uf,I=Ll,A=uu;return c.value!=null?(De(),yt("div",rve,[me(I,{align:"middle"},{default:we(()=>[me(T,{span:7,class:"text"},{default:we(()=>[Sr("名称：")]),_:1}),me(T,{span:17},{default:we(()=>[me(S,{modelValue:c.value.name,"onUpdate:modelValue":E[0]||(E[0]=M=>c.value.name=M),disabled:f.value,placeholder:"暂无"},null,8,["modelValue","disabled"])]),_:1})]),_:1}),me(I,{align:"middle"},{default:we(()=>[me(T,{span:7,class:"text"},{default:we(()=>[Sr("编号：")]),_:1}),me(T,{span:17},{default:we(()=>[me(S,{modelValue:c.value.survey3_id,"onUpdate:modelValue":E[1]||(E[1]=M=>c.value.survey3_id=M),disabled:f.value,placeholder:"暂无"},null,8,["modelValue","disabled"])]),_:1})]),_:1}),me(I,{align:"middle"},{default:we(()=>[me(T,{span:7,class:"text"},{default:we(()=>[Sr("类型：")]),_:1}),me(T,{span:17},{default:we(()=>[me(S,{modelValue:c.value.type,"onUpdate:modelValue":E[2]||(E[2]=M=>c.value.type=M),placeholder:"暂无",disabled:f.value},null,8,["modelValue","disabled"])]),_:1})]),_:1}),me(I,{align:"middle"},{default:we(()=>[me(T,{span:7,class:"text"},{default:we(()=>[Sr("年代：")]),_:1}),me(T,{span:17},{default:we(()=>[me(S,{modelValue:c.value.age,"onUpdate:modelValue":E[3]||(E[3]=M=>c.value.age=M),disabled:f.value,placeholder:"暂无"},null,8,["modelValue","disabled"])]),_:1})]),_:1}),me(I,{align:"middle"},{default:we(()=>[me(T,{span:7,class:"text"},{default:we(()=>[Sr("地址：")]),_:1}),me(T,{span:17},{default:we(()=>[me(S,{modelValue:c.value.address,"onUpdate:modelValue":E[4]||(E[4]=M=>c.value.address=M),disabled:f.value,placeholder:"暂无"},null,8,["modelValue","disabled"])]),_:1})]),_:1}),me(I,{justify:"center",align:"middle",class:"button-group"},{default:we(()=>[f.value?Wt("",!0):(De(),yt("div",nve,[me(A,{size:"small",class:"btn-reset",onClick:E[5]||(E[5]=M=>p())},{default:we(()=>[Sr("重置")]),_:1}),me(A,{size:"small",class:"btn-saveAll",onClick:E[6]||(E[6]=M=>g())},{default:we(()=>[Sr("保存")]),_:1})])),f.value?(De(),yt("div",ive,[me(A,{size:"small",onClick:E[7]||(E[7]=M=>y())},{default:we(()=>[Sr("进入编辑")]),_:1})])):Wt("",!0)]),_:1})])):Wt("",!0)}}}),EU=Vs(ove,[["__scopeId","data-v-e7a12080"]]),sp=t=>(rf("data-v-99fba5e4"),t=t(),nf(),t),sve={id:"title"},lve=sp(()=>gt("span",{class:"subtitle"},"   标绘管理",-1)),cve={class:"draw-manage"},uve={id:"draw-layers"},fve={key:0},hve={key:1},dve=sp(()=>gt("span",{class:"subtitle"},"   属性管理",-1)),pve={class:"property-manage box-area"},mve=sp(()=>gt("span",{class:"subtitle"},"   三普资料",-1)),gve={class:"file-manage"},_ve=sp(()=>gt("span",{class:"text"},"PDF文件：",-1)),vve={id:"style-title"},yve=sp(()=>gt("span",{class:"subtitle"},"   样式设置",-1)),xve={id:"style-setting",class:"box-area"},bve=sp(()=>gt("span",{class:"subtitle"},"   标注设置",-1)),wve={id:"label-setting",class:"box-area"},Eve=sp(()=>gt("span",{class:"subtitle"},"   描述",-1)),Tve=["src"],Sve=Ft({name:"mapDraw",components:{styleSetting:wU,infoSetting:EU},computed:{}}),Cve=Object.assign(Sve,{props:["unitId","unitName","map","draw"],setup(t){const{proxy:n}=Tn(),a=Ph(),s={lock:!0,text:"请稍等...",background:"rgba(0, 0, 0, 0.7)"},c=[{id:0,label:"点标绘",value:0},{id:1,label:"线标绘",value:1},{id:2,label:"面标绘",value:2}],f=t,d=f.map,p=f.draw,g=Ve(()=>function(Ge){return"http://47.103.20.189/server/api/units/resources/images"+Ge}),y=Ze([]);var b=[];const E=Ze(null),T=Ze(""),S=Ze(0),I={0:"点标绘",1:"线标绘",2:"面标绘"},A=Ze(0),M=Ze(""),F=Ze(""),L=Ze(!1),O=Ze(!0),N=Gr("styleConfig"),Q=Ze(!1);Ze("");const ie=["http://localhost:8181/api/images/330881-0001-0.png","http://localhost:8181/api/images/330881-0001-1.png","http://localhost:8181/api/images/330881-0001-2.png"];di(()=>{const Ge=p5.service(s);document.body.classList.remove("el-loading-parent--relative"),n.$axios.get(`/api/units/features/${f.unitId}`,{responseType:"json"}).then(ze=>{y.value=ze.data.data,b=JSON.parse(JSON.stringify(y.value)),Ge.close(),V(),ue(),re()})}),gr(T,(Ge,ze)=>{ze&&ut(ze),Ge&&(E.value=y.value.find(oe=>oe.name===Ge),S.value=E.value.type,Ee(Ge))});function j(Ge,ze){if(Ge===ze)return!0;if(typeof Ge!="object"||typeof ze!="object")return!1;const oe=Object.keys(Ge),Me=Object.keys(ze);if(oe.length!==Me.length)return!1;for(let fe of oe)if(!j(Ge[fe],ze[fe]))return!1;return!0}of(()=>{He(),te(),Fe()});function V(){if(y.value.length==0)return;let Ge=[];for(var ze of y.value){let xe=JSON.parse(ze.geometry);switch(ze.type){case 0:{var oe=q_e(xe);break}case 1:{var oe=Z_e(xe);break}case 2:{var oe=X_e(xe);break}}Ge.push(oe)}let Me=K_e(Ge),fe=MC(Me),pe=d.cameraForBounds([[fe[0],fe[1]],[fe[2],fe[3]]]).zoom,ot=d.cameraForBounds([[fe[0],fe[1]],[fe[2],fe[3]]]).center;d.easeTo({zoom:Math.min(17,pe-1.3),center:ot,pitch:0,bearing:0})}function D(Ge,ze,oe,Me){var fe={};return fe[N[Ge].style1.name]=N[Ge].style1.options[ze].value,fe[N[Ge].style2.name]=N[Ge].style2.options[oe].value,Ge!="polygonStyle"&&(fe[N[Ge].style3.name]=N[Ge].style3.options[Me].value),Ge=="pointStyle"&&(fe["circle-stroke-color"]="#FEFEFE"),fe}function te(){for(var Ge of y.value)d.removeLayer(f.unitId+"-"+Ge.name+"-layer"),d.removeSource(f.unitId+"-"+Ge.name+"-source")}function ue(){for(var Ge of y.value){var ze=f.unitId+"-"+Ge.name+"-source",oe=f.unitId+"-"+Ge.name+"-layer",Me=JSON.parse(Ge.geometry),fe={},pe=Ge.style1==null?N.pointStyle.style1.default:Ge.style1,ot=Ge.style2==null?N.pointStyle.style2.default:Ge.style2;if(Ge.type!=2)var xe=Ge.style3==null?N.pointStyle.style3.default:Ge.style3;switch(Ge.type){case 0:{fe=D("pointStyle",pe,ot,xe);var ae={type:"Feature",properties:{name:Ge.name},geometry:{type:"Point",coordinates:Me}};d.addSource(ze,{type:"geojson",data:ae}),d.addLayer({id:oe,type:"circle",source:ze,paint:fe},"pointLocation");break}case 1:{fe=D("lineStyle",pe,ot,xe);var X={type:"Feature",properties:{name:Ge.name},geometry:{type:"LineString",coordinates:Me}};d.addSource(ze,{type:"geojson",data:X}),d.addLayer({id:oe,type:"line",source:ze,paint:fe},"lineLocation");break}case 2:{fe=D("polygonStyle",pe,ot);var Ce={type:"Feature",properties:{name:Ge.name},geometry:{type:"Polygon",coordinates:Me}};d.addSource(ze,{type:"geojson",data:Ce}),d.addLayer({id:oe,type:"fill",source:ze,paint:fe},"fillLocation");break}}}}function J(){if(!y.value.find(Me=>Me.name===M.value)){if(M.value!=""){const Me=["pointStyle","lineStyle","polygonStyle"];var Ge=N[Me[A.value]].style1.default,ze=N[Me[A.value]].style2.default;if(A.value!=2)var oe=N[Me[A.value]].style3.default;else var oe=null;y.value.push({unit_id:f.unitId,name:M.value,type:A.value,geometry:"[]",description:F.value,style1:Ge,style2:ze,style3:oe});const fe={0:"circle",1:"line",2:"fill"},pe={0:"pointLocation",1:"lineLocation",2:"fillLocation"};d.addSource(f.unitId+"-"+M.value+"-source",{type:"geojson",data:{type:"FeatureCollection",features:[]}}),d.addLayer({id:f.unitId+"-"+M.value+"-layer",type:fe[A.value],source:f.unitId+"-"+M.value+"-source",paint:D(Me[A.value],Ge,ze,oe)},pe[A.value]),T.value=M.value,L.value=!1}}}function le(){Vu.confirm("确认删除该标绘？","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{ut(T.value),d.removeLayer(f.unitId+"-"+T.value+"-layer"),d.removeSource(f.unitId+"-"+T.value+"-source"),y.value=y.value.filter(Ge=>Ge.name!==T.value),T.value=""}).catch(()=>{})}function re(){d.setFilter("point-vector",["!=",["get","unit_id"],f.unitId]),d.setFilter("line-vector",["!=",["get","unit_id"],f.unitId]),d.setFilter("polygon-vector",["!=",["get","unit_id"],f.unitId]),d.setPaintProperty("point-vector","circle-opacity",.2),d.setPaintProperty("point-vector","circle-stroke-opacity",.2),d.setPaintProperty("line-vector","line-opacity",.2),d.setPaintProperty("polygon-vector","fill-opacity",.2),d.setPaintProperty("point-label","text-opacity",["match",["get","unit_id"],f.unitId,1,.5]),d.setPaintProperty("line-label","text-opacity",["match",["get","unit_id"],f.unitId,1,.5]),d.setPaintProperty("polygon-label","text-opacity",["match",["get","unit_id"],f.unitId,1,.5])}function Fe(){d.setFilter("point-vector",null),d.setFilter("line-vector",null),d.setFilter("polygon-vector",null),d.setPaintProperty("point-vector","circle-opacity",1),d.setPaintProperty("point-vector","circle-stroke-opacity",1),d.setPaintProperty("line-vector","line-opacity",1);var Ge=["match",["get","opacity"]],ze=N.polygonStyle.style2;ze.options.forEach((oe,Me)=>{Ge.push(Me.toString()),Ge.push(oe.value)}),Ge.push(ze.options[ze.default].value),d.setPaintProperty("polygon-vector","fill-opacity",Ge),d.setPaintProperty("point-label","text-opacity",["step",["zoom"],0,11,1]),d.setPaintProperty("line-label","text-opacity",["step",["zoom"],0,10,1]),d.setPaintProperty("polygon-label","text-opacity",["step",["zoom"],0,10,1])}function Ye(){n.$axios.get("/api/map/version",{responseType:"json"}).then(Ge=>{var ze=Ge.data.data;d.getSource("vector-source").setTiles(["http://47.103.20.189/server/api/map/mvt/units/{z}/{x}/{y}?version="+ze])})}function Ee(Ge){y.value.find(oe=>oe.name===Ge);var ze=d.getSource(f.unitId+"-"+Ge+"-source")._data;if(ze){const oe=p.add(ze)[0];d.setLayoutProperty(f.unitId+"-"+Ge+"-layer","visibility","none"),p.changeMode("simple_select",{featureIds:[oe]})}}function ut(Ge){if(p.getAll().features.length!=0){var ze=p.getAll().features[0],oe=y.value.find(Me=>Me.name===Ge);oe.geometry=JSON.stringify(ze.geometry.coordinates),d.getSource(f.unitId+"-"+Ge+"-source").setData(ze),p.deleteAll(),d.setLayoutProperty(f.unitId+"-"+Ge+"-layer","visibility","visible"),p.changeMode("simple_select")}}function Ne(){p.deleteAll();const ze=y.value.find(Me=>Me.name===T.value).type,oe={0:"draw_point",1:"draw_line_string",2:"draw_polygon"};p.changeMode(oe[ze])}function He(){if(ut(T.value),T.value="",!a.isLoggedIn||j(y.value,b))return;const Ge=p5.service(s);document.body.classList.remove("el-loading-parent--relative"),n.$axios.put(`/units/features/${f.unitId}`,y.value).then(ze=>{Ye(),Ge.close(),b=y.value}).catch(ze=>{Ge.close(),console.error("API Error:",ze.response.data)})}function Oe(Ge){y.value=Ge}function Pe(){a.isLoggedIn?n.$axios.get(`/api/units/resources/images/list/${f.unitId}`).then(Ge=>{ie.value=Ge.data.data,Q.value=!0}).catch(Ge=>{console.error("Failed to fetch images:",Ge),cs({title:"失败",message:"无法预览该文件",position:"bottom-right",type:"error"})}):Vu.alert("您暂无预览权限，请在登录后操作。","提示",{confirmButtonText:"确定"})}function rt(){a.isLoggedIn?n.$axios.get(`/units/resources/pdf/${f.unitId}`,{responseType:"blob"}).then(Ge=>{const ze=window.URL.createObjectURL(new Blob([Ge.data])),oe=document.createElement("a");oe.href=ze,oe.setAttribute("download",`${f.unitName}.pdf`),document.body.appendChild(oe),oe.click(),window.URL.revokeObjectURL(ze)}).catch(Ge=>{console.error("API Error:",Ge.response),cs({title:"失败",message:"下载失败",position:"bottom-right",type:"error"})}):Vu.alert("您暂无下载权限，请在登录后操作。","提示",{confirmButtonText:"确定"})}function et(){a.isLoggedIn?O.value=!1:Vu.alert("您暂无编辑权限，请在登录后操作。","提示",{confirmButtonText:"确定"})}return(Ge,ze)=>{const oe=Ll,Me=Yhe,fe=Afe,pe=Cfe,ot=Dh,xe=uu,ae=Ec,X=Jb,Ce=Yb,he=uf,G=fpe,K=Zb,se=Xb,Ae=Ppe,Se=mue,ye=pue,Xe=ahe;return De(),yt(mn,null,[me(se,{id:"layer-container",class:"map-overlay-right"},{default:we(()=>[me(ot,null,{default:we(()=>[me(K,null,{default:we(()=>[me(oe,{justify:"center"},{default:we(()=>[gt("span",sve,"   "+Lr(t.unitName),1)]),_:1}),me(oe,null,{default:we(()=>[lve]),_:1}),gt("div",cve,[gt("div",uve,[y.value.length==0?(De(),Ht(Me,{key:0,"image-size":.1,description:"无标绘"})):Wt("",!0),me(ot,null,{default:we(()=>[ci(me(pe,{class:"collapse box-overlay",modelValue:T.value,"onUpdate:modelValue":ze[0]||(ze[0]=be=>T.value=be),accordion:""},{default:we(()=>[(De(!0),yt(mn,null,pa(y.value,(be,Be)=>(De(),Ht(fe,{name:be.name,disabled:O.value},{title:we(()=>[Sr(Lr(be.name),1)]),default:we(()=>[me(oe,null,{default:we(()=>[Sr(" 标绘类型："+Lr(I[be.type]),1)]),_:2},1024)]),_:2},1032,["name","disabled"]))),256))]),_:1},8,["modelValue"]),[[la,y.value.length!=0]])]),_:1})]),me(oe,{justify:"center",align:"middle",class:"button-group"},{default:we(()=>[O.value?Wt("",!0):(De(),yt("div",fve,[me(xe,{size:"small",class:"btn-locate",onClick:ze[1]||(ze[1]=be=>V())},{default:we(()=>[Sr("定位")]),_:1}),me(G,{placement:"left",width:250,trigger:"click",visible:L.value},{reference:we(()=>[me(xe,{size:"small",onClick:ze[2]||(ze[2]=be=>L.value=!0),class:"btn-add"},{default:we(()=>[Sr("添加标绘")]),_:1})]),default:we(()=>[me(oe,{align:"middle",style:{height:"30px"}},{default:we(()=>[me(ae,{span:8,style:{"font-size":"14px"}},{default:we(()=>[Sr("标绘类型：")]),_:1}),me(ae,{span:16},{default:we(()=>[me(Ce,{modelValue:A.value,"onUpdate:modelValue":ze[3]||(ze[3]=be=>A.value=be),class:"m-2",size:"small"},{default:we(()=>[(De(),yt(mn,null,pa(c,be=>me(X,{key:be.id,label:be.label,value:be.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1})]),_:1}),me(oe,{align:"middle",style:{height:"30px"}},{default:we(()=>[me(ae,{span:8,style:{"font-size":"14px"}},{default:we(()=>[Sr("标绘名称：")]),_:1}),me(ae,{span:16},{default:we(()=>[me(he,{modelValue:M.value,"onUpdate:modelValue":ze[4]||(ze[4]=be=>M.value=be),placeholder:"输入标绘名称"},null,8,["modelValue"])]),_:1})]),_:1}),me(oe,{align:"middle"},{default:we(()=>[me(ae,{span:8,style:{"font-size":"14px"}},{default:we(()=>[Sr("描述：")]),_:1}),me(ae,{span:16},{default:we(()=>[me(he,{modelValue:F.value,"onUpdate:modelValue":ze[5]||(ze[5]=be=>F.value=be),rows:3,type:"textarea",placeholder:"输入描述信息"},null,8,["modelValue"])]),_:1})]),_:1}),me(oe,{justify:"center",style:{"padding-top":"2vh"}},{default:we(()=>[me(xe,{size:"small",color:"#758a99",style:{color:"#fff"},onClick:ze[6]||(ze[6]=be=>J())},{default:we(()=>[Sr(" 确定 ")]),_:1}),me(xe,{size:"small",onClick:ze[7]||(ze[7]=be=>L.value=!1)},{default:we(()=>[Sr(" 取消 ")]),_:1})]),_:1})]),_:1},8,["visible"]),me(xe,{size:"small",class:"btn-saveAll",onClick:ze[8]||(ze[8]=be=>He())},{default:we(()=>[Sr("全部保存")]),_:1})])),O.value?(De(),yt("div",hve,[me(xe,{size:"small",onClick:ze[9]||(ze[9]=be=>et())},{default:we(()=>[Sr("进入编辑")]),_:1})])):Wt("",!0)]),_:1})]),me(oe,null,{default:we(()=>[dve]),_:1}),gt("div",pve,[me(EU,{unitId:t.unitId},null,8,["unitId"])]),me(oe,null,{default:we(()=>[mve]),_:1}),gt("div",gve,[me(oe,{align:"middle"},{default:we(()=>[me(ae,{span:10},{default:we(()=>[_ve]),_:1}),me(ae,{span:14},{default:we(()=>[me(xe,{class:"btn-pdf",onClick:ze[10]||(ze[10]=be=>Pe())},{default:we(()=>[Sr("预览")]),_:1}),me(xe,{class:"btn-pdf",onClick:ze[11]||(ze[11]=be=>rt())},{default:we(()=>[Sr("下载")]),_:1})]),_:1})]),_:1})])]),_:1})]),_:1})]),_:1}),T.value?(De(),Ht(se,{key:0,id:"style-container",class:"map-overlay-right"},{default:we(()=>[me(ot,null,{default:we(()=>[me(K,null,{default:we(()=>[me(oe,{justify:"center"},{default:we(()=>[gt("span",vve,Lr(T.value),1)]),_:1}),me(oe,{justify:"center",align:"middle"},{default:we(()=>[me(xe,{class:"btn-draw",onClick:ze[12]||(ze[12]=be=>Ne())},{default:we(()=>[Sr("绘制 / 重新绘制")]),_:1})]),_:1}),me(oe,null,{default:we(()=>[yve]),_:1}),gt("div",xve,[(De(),Ht(wU,{unitId:t.unitId,drawData:y.value,map:W(d),featureName:T.value,key:T.value,onStyleChangeEvent:Oe},null,8,["unitId","drawData","map","featureName"]))]),me(oe,null,{default:we(()=>[bve]),_:1}),gt("div",wve,[me(oe,{align:"middle",style:{height:"5vh"}},{default:we(()=>[me(ae,{span:12,class:"text"},{default:we(()=>[Sr(" 显示标注： ")]),_:1}),me(ae,{span:12},{default:we(()=>[me(Ae,{modelValue:E.value.use_label,"onUpdate:modelValue":ze[13]||(ze[13]=be=>E.value.use_label=be),size:"small"},null,8,["modelValue"])]),_:1})]),_:1}),me(oe,{align:"middle",style:{height:"5vh"}},{default:we(()=>[me(ae,{span:12,class:"text"},{default:we(()=>[Sr(" 标注文本： ")]),_:1})]),_:1}),me(oe,null,{default:we(()=>[me(he,{modelValue:E.value.label,"onUpdate:modelValue":ze[14]||(ze[14]=be=>E.value.label=be),rows:2,type:"textarea",placeholder:"无"},null,8,["modelValue"])]),_:1})]),me(oe,null,{default:we(()=>[Eve]),_:1}),me(he,{modelValue:E.value.description,"onUpdate:modelValue":ze[15]||(ze[15]=be=>E.value.description=be),rows:4,type:"textarea",placeholder:"输入描述信息"},null,8,["modelValue"]),me(oe,{justify:"center",align:"middle"},{default:we(()=>[me(xe,{class:"btn-delete",onClick:ze[16]||(ze[16]=be=>le())},{default:we(()=>[Sr("删除标绘")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})):Wt("",!0),me(Xe,{title:"PDF预览",modelValue:Q.value,"onUpdate:modelValue":ze[17]||(ze[17]=be=>Q.value=be),width:"45vw",center:"","align-center":""},{default:we(()=>[me(ye,{trigger:"click",autoplay:!1,height:"85vh",loop:!1},{default:we(()=>[(De(!0),yt(mn,null,pa(ie.value,be=>(De(),Ht(Se,{key:be},{default:we(()=>[me(ot,null,{default:we(()=>[gt("img",{src:g.value(be),alt:"预览图片",style:{width:"100%",height:"100%"}},null,8,Tve)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1},8,["modelValue"])],64)}}}),TU=Vs(Cve,[["__scopeId","data-v-99fba5e4"]]);var SU={exports:{}};/* @license
Papa Parse
v5.4.1
https://github.com/mholt/PapaParse
License: MIT
*/(function(t,n){(function(a,s){t.exports=s()})($o,function a(){var s=typeof self<"u"?self:typeof window<"u"?window:s!==void 0?s:{},c=!s.document&&!!s.postMessage,f=s.IS_PAPA_WORKER||!1,d={},p=0,g={parse:function(V,D){var te=(D=D||{}).dynamicTyping||!1;if(j(te)&&(D.dynamicTypingFunction=te,te={}),D.dynamicTyping=te,D.transform=!!j(D.transform)&&D.transform,D.worker&&g.WORKERS_SUPPORTED){var ue=function(){if(!g.WORKERS_SUPPORTED)return!1;var le=(Fe=s.URL||s.webkitURL||null,Ye=a.toString(),g.BLOB_URL||(g.BLOB_URL=Fe.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",Ye,")();"],{type:"text/javascript"})))),re=new s.Worker(le),Fe,Ye;return re.onmessage=L,re.id=p++,d[re.id]=re}();return ue.userStep=D.step,ue.userChunk=D.chunk,ue.userComplete=D.complete,ue.userError=D.error,D.step=j(D.step),D.chunk=j(D.chunk),D.complete=j(D.complete),D.error=j(D.error),delete D.worker,void ue.postMessage({input:V,config:D,workerId:ue.id})}var J=null;return g.NODE_STREAM_INPUT,typeof V=="string"?(V=function(le){return le.charCodeAt(0)===65279?le.slice(1):le}(V),J=D.download?new E(D):new S(D)):V.readable===!0&&j(V.read)&&j(V.on)?J=new I(D):(s.File&&V instanceof File||V instanceof Object)&&(J=new T(D)),J.stream(V)},unparse:function(V,D){var te=!1,ue=!0,J=",",le=`\r
`,re='"',Fe=re+re,Ye=!1,Ee=null,ut=!1;(function(){if(typeof D=="object"){if(typeof D.delimiter!="string"||g.BAD_DELIMITERS.filter(function(Pe){return D.delimiter.indexOf(Pe)!==-1}).length||(J=D.delimiter),(typeof D.quotes=="boolean"||typeof D.quotes=="function"||Array.isArray(D.quotes))&&(te=D.quotes),typeof D.skipEmptyLines!="boolean"&&typeof D.skipEmptyLines!="string"||(Ye=D.skipEmptyLines),typeof D.newline=="string"&&(le=D.newline),typeof D.quoteChar=="string"&&(re=D.quoteChar),typeof D.header=="boolean"&&(ue=D.header),Array.isArray(D.columns)){if(D.columns.length===0)throw new Error("Option columns is empty");Ee=D.columns}D.escapeChar!==void 0&&(Fe=D.escapeChar+re),(typeof D.escapeFormulae=="boolean"||D.escapeFormulae instanceof RegExp)&&(ut=D.escapeFormulae instanceof RegExp?D.escapeFormulae:/^[=+\-@\t\r].*$/)}})();var Ne=new RegExp(M(re),"g");if(typeof V=="string"&&(V=JSON.parse(V)),Array.isArray(V)){if(!V.length||Array.isArray(V[0]))return He(null,V,Ye);if(typeof V[0]=="object")return He(Ee||Object.keys(V[0]),V,Ye)}else if(typeof V=="object")return typeof V.data=="string"&&(V.data=JSON.parse(V.data)),Array.isArray(V.data)&&(V.fields||(V.fields=V.meta&&V.meta.fields||Ee),V.fields||(V.fields=Array.isArray(V.data[0])?V.fields:typeof V.data[0]=="object"?Object.keys(V.data[0]):[]),Array.isArray(V.data[0])||typeof V.data[0]=="object"||(V.data=[V.data])),He(V.fields||[],V.data||[],Ye);throw new Error("Unable to serialize unrecognized input");function He(Pe,rt,et){var Ge="";typeof Pe=="string"&&(Pe=JSON.parse(Pe)),typeof rt=="string"&&(rt=JSON.parse(rt));var ze=Array.isArray(Pe)&&0<Pe.length,oe=!Array.isArray(rt[0]);if(ze&&ue){for(var Me=0;Me<Pe.length;Me++)0<Me&&(Ge+=J),Ge+=Oe(Pe[Me],Me);0<rt.length&&(Ge+=le)}for(var fe=0;fe<rt.length;fe++){var pe=ze?Pe.length:rt[fe].length,ot=!1,xe=ze?Object.keys(rt[fe]).length===0:rt[fe].length===0;if(et&&!ze&&(ot=et==="greedy"?rt[fe].join("").trim()==="":rt[fe].length===1&&rt[fe][0].length===0),et==="greedy"&&ze){for(var ae=[],X=0;X<pe;X++){var Ce=oe?Pe[X]:X;ae.push(rt[fe][Ce])}ot=ae.join("").trim()===""}if(!ot){for(var he=0;he<pe;he++){0<he&&!xe&&(Ge+=J);var G=ze&&oe?Pe[he]:he;Ge+=Oe(rt[fe][G],he)}fe<rt.length-1&&(!et||0<pe&&!xe)&&(Ge+=le)}}return Ge}function Oe(Pe,rt){if(Pe==null)return"";if(Pe.constructor===Date)return JSON.stringify(Pe).slice(1,25);var et=!1;ut&&typeof Pe=="string"&&ut.test(Pe)&&(Pe="'"+Pe,et=!0);var Ge=Pe.toString().replace(Ne,Fe);return(et=et||te===!0||typeof te=="function"&&te(Pe,rt)||Array.isArray(te)&&te[rt]||function(ze,oe){for(var Me=0;Me<oe.length;Me++)if(-1<ze.indexOf(oe[Me]))return!0;return!1}(Ge,g.BAD_DELIMITERS)||-1<Ge.indexOf(J)||Ge.charAt(0)===" "||Ge.charAt(Ge.length-1)===" ")?re+Ge+re:Ge}}};if(g.RECORD_SEP=String.fromCharCode(30),g.UNIT_SEP=String.fromCharCode(31),g.BYTE_ORDER_MARK="\uFEFF",g.BAD_DELIMITERS=["\r",`
`,'"',g.BYTE_ORDER_MARK],g.WORKERS_SUPPORTED=!c&&!!s.Worker,g.NODE_STREAM_INPUT=1,g.LocalChunkSize=10485760,g.RemoteChunkSize=5242880,g.DefaultDelimiter=",",g.Parser=F,g.ParserHandle=A,g.NetworkStreamer=E,g.FileStreamer=T,g.StringStreamer=S,g.ReadableStreamStreamer=I,s.jQuery){var y=s.jQuery;y.fn.parse=function(V){var D=V.config||{},te=[];return this.each(function(le){if(!(y(this).prop("tagName").toUpperCase()==="INPUT"&&y(this).attr("type").toLowerCase()==="file"&&s.FileReader)||!this.files||this.files.length===0)return!0;for(var re=0;re<this.files.length;re++)te.push({file:this.files[re],inputElem:this,instanceConfig:y.extend({},D)})}),ue(),this;function ue(){if(te.length!==0){var le,re,Fe,Ye,Ee=te[0];if(j(V.before)){var ut=V.before(Ee.file,Ee.inputElem);if(typeof ut=="object"){if(ut.action==="abort")return le="AbortError",re=Ee.file,Fe=Ee.inputElem,Ye=ut.reason,void(j(V.error)&&V.error({name:le},re,Fe,Ye));if(ut.action==="skip")return void J();typeof ut.config=="object"&&(Ee.instanceConfig=y.extend(Ee.instanceConfig,ut.config))}else if(ut==="skip")return void J()}var Ne=Ee.instanceConfig.complete;Ee.instanceConfig.complete=function(He){j(Ne)&&Ne(He,Ee.file,Ee.inputElem),J()},g.parse(Ee.file,Ee.instanceConfig)}else j(V.complete)&&V.complete()}function J(){te.splice(0,1),ue()}}}function b(V){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},(function(D){var te=Q(D);te.chunkSize=parseInt(te.chunkSize),D.step||D.chunk||(te.chunkSize=null),this._handle=new A(te),(this._handle.streamer=this)._config=te}).call(this,V),this.parseChunk=function(D,te){if(this.isFirstChunk&&j(this._config.beforeFirstChunk)){var ue=this._config.beforeFirstChunk(D);ue!==void 0&&(D=ue)}this.isFirstChunk=!1,this._halted=!1;var J=this._partialLine+D;this._partialLine="";var le=this._handle.parse(J,this._baseIndex,!this._finished);if(!this._handle.paused()&&!this._handle.aborted()){var re=le.meta.cursor;this._finished||(this._partialLine=J.substring(re-this._baseIndex),this._baseIndex=re),le&&le.data&&(this._rowCount+=le.data.length);var Fe=this._finished||this._config.preview&&this._rowCount>=this._config.preview;if(f)s.postMessage({results:le,workerId:g.WORKER_ID,finished:Fe});else if(j(this._config.chunk)&&!te){if(this._config.chunk(le,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);le=void 0,this._completeResults=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(le.data),this._completeResults.errors=this._completeResults.errors.concat(le.errors),this._completeResults.meta=le.meta),this._completed||!Fe||!j(this._config.complete)||le&&le.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),Fe||le&&le.meta.paused||this._nextChunk(),le}this._halted=!0},this._sendError=function(D){j(this._config.error)?this._config.error(D):f&&this._config.error&&s.postMessage({workerId:g.WORKER_ID,error:D,finished:!1})}}function E(V){var D;(V=V||{}).chunkSize||(V.chunkSize=g.RemoteChunkSize),b.call(this,V),this._nextChunk=c?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(te){this._input=te,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(D=new XMLHttpRequest,this._config.withCredentials&&(D.withCredentials=this._config.withCredentials),c||(D.onload=ie(this._chunkLoaded,this),D.onerror=ie(this._chunkError,this)),D.open(this._config.downloadRequestBody?"POST":"GET",this._input,!c),this._config.downloadRequestHeaders){var te=this._config.downloadRequestHeaders;for(var ue in te)D.setRequestHeader(ue,te[ue])}if(this._config.chunkSize){var J=this._start+this._config.chunkSize-1;D.setRequestHeader("Range","bytes="+this._start+"-"+J)}try{D.send(this._config.downloadRequestBody)}catch(le){this._chunkError(le.message)}c&&D.status===0&&this._chunkError()}},this._chunkLoaded=function(){D.readyState===4&&(D.status<200||400<=D.status?this._chunkError():(this._start+=this._config.chunkSize?this._config.chunkSize:D.responseText.length,this._finished=!this._config.chunkSize||this._start>=function(te){var ue=te.getResponseHeader("Content-Range");return ue===null?-1:parseInt(ue.substring(ue.lastIndexOf("/")+1))}(D),this.parseChunk(D.responseText)))},this._chunkError=function(te){var ue=D.statusText||te;this._sendError(new Error(ue))}}function T(V){var D,te;(V=V||{}).chunkSize||(V.chunkSize=g.LocalChunkSize),b.call(this,V);var ue=typeof FileReader<"u";this.stream=function(J){this._input=J,te=J.slice||J.webkitSlice||J.mozSlice,ue?((D=new FileReader).onload=ie(this._chunkLoaded,this),D.onerror=ie(this._chunkError,this)):D=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var J=this._input;if(this._config.chunkSize){var le=Math.min(this._start+this._config.chunkSize,this._input.size);J=te.call(J,this._start,le)}var re=D.readAsText(J,this._config.encoding);ue||this._chunkLoaded({target:{result:re}})},this._chunkLoaded=function(J){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(J.target.result)},this._chunkError=function(){this._sendError(D.error)}}function S(V){var D;b.call(this,V=V||{}),this.stream=function(te){return D=te,this._nextChunk()},this._nextChunk=function(){if(!this._finished){var te,ue=this._config.chunkSize;return ue?(te=D.substring(0,ue),D=D.substring(ue)):(te=D,D=""),this._finished=!D,this.parseChunk(te)}}}function I(V){b.call(this,V=V||{});var D=[],te=!0,ue=!1;this.pause=function(){b.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){b.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(J){this._input=J,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){ue&&D.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),D.length?this.parseChunk(D.shift()):te=!0},this._streamData=ie(function(J){try{D.push(typeof J=="string"?J:J.toString(this._config.encoding)),te&&(te=!1,this._checkIsFinished(),this.parseChunk(D.shift()))}catch(le){this._streamError(le)}},this),this._streamError=ie(function(J){this._streamCleanUp(),this._sendError(J)},this),this._streamEnd=ie(function(){this._streamCleanUp(),ue=!0,this._streamData("")},this),this._streamCleanUp=ie(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function A(V){var D,te,ue,J=Math.pow(2,53),le=-J,re=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,Fe=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,Ye=this,Ee=0,ut=0,Ne=!1,He=!1,Oe=[],Pe={data:[],errors:[],meta:{}};if(j(V.step)){var rt=V.step;V.step=function(fe){if(Pe=fe,ze())Ge();else{if(Ge(),Pe.data.length===0)return;Ee+=fe.data.length,V.preview&&Ee>V.preview?te.abort():(Pe.data=Pe.data[0],rt(Pe,Ye))}}}function et(fe){return V.skipEmptyLines==="greedy"?fe.join("").trim()==="":fe.length===1&&fe[0].length===0}function Ge(){return Pe&&ue&&(Me("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+g.DefaultDelimiter+"'"),ue=!1),V.skipEmptyLines&&(Pe.data=Pe.data.filter(function(fe){return!et(fe)})),ze()&&function(){if(!Pe)return;function fe(ot,xe){j(V.transformHeader)&&(ot=V.transformHeader(ot,xe)),Oe.push(ot)}if(Array.isArray(Pe.data[0])){for(var pe=0;ze()&&pe<Pe.data.length;pe++)Pe.data[pe].forEach(fe);Pe.data.splice(0,1)}else Pe.data.forEach(fe)}(),function(){if(!Pe||!V.header&&!V.dynamicTyping&&!V.transform)return Pe;function fe(ot,xe){var ae,X=V.header?{}:[];for(ae=0;ae<ot.length;ae++){var Ce=ae,he=ot[ae];V.header&&(Ce=ae>=Oe.length?"__parsed_extra":Oe[ae]),V.transform&&(he=V.transform(he,Ce)),he=oe(Ce,he),Ce==="__parsed_extra"?(X[Ce]=X[Ce]||[],X[Ce].push(he)):X[Ce]=he}return V.header&&(ae>Oe.length?Me("FieldMismatch","TooManyFields","Too many fields: expected "+Oe.length+" fields but parsed "+ae,ut+xe):ae<Oe.length&&Me("FieldMismatch","TooFewFields","Too few fields: expected "+Oe.length+" fields but parsed "+ae,ut+xe)),X}var pe=1;return!Pe.data.length||Array.isArray(Pe.data[0])?(Pe.data=Pe.data.map(fe),pe=Pe.data.length):Pe.data=fe(Pe.data,0),V.header&&Pe.meta&&(Pe.meta.fields=Oe),ut+=pe,Pe}()}function ze(){return V.header&&Oe.length===0}function oe(fe,pe){return ot=fe,V.dynamicTypingFunction&&V.dynamicTyping[ot]===void 0&&(V.dynamicTyping[ot]=V.dynamicTypingFunction(ot)),(V.dynamicTyping[ot]||V.dynamicTyping)===!0?pe==="true"||pe==="TRUE"||pe!=="false"&&pe!=="FALSE"&&(function(xe){if(re.test(xe)){var ae=parseFloat(xe);if(le<ae&&ae<J)return!0}return!1}(pe)?parseFloat(pe):Fe.test(pe)?new Date(pe):pe===""?null:pe):pe;var ot}function Me(fe,pe,ot,xe){var ae={type:fe,code:pe,message:ot};xe!==void 0&&(ae.row=xe),Pe.errors.push(ae)}this.parse=function(fe,pe,ot){var xe=V.quoteChar||'"';if(V.newline||(V.newline=function(Ce,he){Ce=Ce.substring(0,1048576);var G=new RegExp(M(he)+"([^]*?)"+M(he),"gm"),K=(Ce=Ce.replace(G,"")).split("\r"),se=Ce.split(`
`),Ae=1<se.length&&se[0].length<K[0].length;if(K.length===1||Ae)return`
`;for(var Se=0,ye=0;ye<K.length;ye++)K[ye][0]===`
`&&Se++;return Se>=K.length/2?`\r
`:"\r"}(fe,xe)),ue=!1,V.delimiter)j(V.delimiter)&&(V.delimiter=V.delimiter(fe),Pe.meta.delimiter=V.delimiter);else{var ae=function(Ce,he,G,K,se){var Ae,Se,ye,Xe;se=se||[",","	","|",";",g.RECORD_SEP,g.UNIT_SEP];for(var be=0;be<se.length;be++){var Be=se[be],ct=0,At=0,$t=0;ye=void 0;for(var mr=new F({comments:K,delimiter:Be,newline:he,preview:10}).parse(Ce),Nt=0;Nt<mr.data.length;Nt++)if(G&&et(mr.data[Nt]))$t++;else{var Lt=mr.data[Nt].length;At+=Lt,ye!==void 0?0<Lt&&(ct+=Math.abs(Lt-ye),ye=Lt):ye=Lt}0<mr.data.length&&(At/=mr.data.length-$t),(Se===void 0||ct<=Se)&&(Xe===void 0||Xe<At)&&1.99<At&&(Se=ct,Ae=Be,Xe=At)}return{successful:!!(V.delimiter=Ae),bestDelimiter:Ae}}(fe,V.newline,V.skipEmptyLines,V.comments,V.delimitersToGuess);ae.successful?V.delimiter=ae.bestDelimiter:(ue=!0,V.delimiter=g.DefaultDelimiter),Pe.meta.delimiter=V.delimiter}var X=Q(V);return V.preview&&V.header&&X.preview++,D=fe,te=new F(X),Pe=te.parse(D,pe,ot),Ge(),Ne?{meta:{paused:!0}}:Pe||{meta:{paused:!1}}},this.paused=function(){return Ne},this.pause=function(){Ne=!0,te.abort(),D=j(V.chunk)?"":D.substring(te.getCharIndex())},this.resume=function(){Ye.streamer._halted?(Ne=!1,Ye.streamer.parseChunk(D,!0)):setTimeout(Ye.resume,3)},this.aborted=function(){return He},this.abort=function(){He=!0,te.abort(),Pe.meta.aborted=!0,j(V.complete)&&V.complete(Pe),D=""}}function M(V){return V.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function F(V){var D,te=(V=V||{}).delimiter,ue=V.newline,J=V.comments,le=V.step,re=V.preview,Fe=V.fastMode,Ye=D=V.quoteChar===void 0||V.quoteChar===null?'"':V.quoteChar;if(V.escapeChar!==void 0&&(Ye=V.escapeChar),(typeof te!="string"||-1<g.BAD_DELIMITERS.indexOf(te))&&(te=","),J===te)throw new Error("Comment character same as delimiter");J===!0?J="#":(typeof J!="string"||-1<g.BAD_DELIMITERS.indexOf(J))&&(J=!1),ue!==`
`&&ue!=="\r"&&ue!==`\r
`&&(ue=`
`);var Ee=0,ut=!1;this.parse=function(Ne,He,Oe){if(typeof Ne!="string")throw new Error("Input must be a string");var Pe=Ne.length,rt=te.length,et=ue.length,Ge=J.length,ze=j(le),oe=[],Me=[],fe=[],pe=Ee=0;if(!Ne)return Qt();if(V.header&&!He){var ot=Ne.split(ue)[0].split(te),xe=[],ae={},X=!1;for(var Ce in ot){var he=ot[Ce];j(V.transformHeader)&&(he=V.transformHeader(he,Ce));var G=he,K=ae[he]||0;for(0<K&&(X=!0,G=he+"_"+K),ae[he]=K+1;xe.includes(G);)G=G+"_"+K;xe.push(G)}if(X){var se=Ne.split(ue);se[0]=xe.join(te),Ne=se.join(ue)}}if(Fe||Fe!==!1&&Ne.indexOf(D)===-1){for(var Ae=Ne.split(ue),Se=0;Se<Ae.length;Se++){if(fe=Ae[Se],Ee+=fe.length,Se!==Ae.length-1)Ee+=ue.length;else if(Oe)return Qt();if(!J||fe.substring(0,Ge)!==J){if(ze){if(oe=[],$t(fe.split(te)),Gt(),ut)return Qt()}else $t(fe.split(te));if(re&&re<=Se)return oe=oe.slice(0,re),Qt(!0)}}return Qt()}for(var ye=Ne.indexOf(te,Ee),Xe=Ne.indexOf(ue,Ee),be=new RegExp(M(Ye)+M(D),"g"),Be=Ne.indexOf(D,Ee);;)if(Ne[Ee]!==D)if(J&&fe.length===0&&Ne.substring(Ee,Ee+Ge)===J){if(Xe===-1)return Qt();Ee=Xe+et,Xe=Ne.indexOf(ue,Ee),ye=Ne.indexOf(te,Ee)}else if(ye!==-1&&(ye<Xe||Xe===-1))fe.push(Ne.substring(Ee,ye)),Ee=ye+rt,ye=Ne.indexOf(te,Ee);else{if(Xe===-1)break;if(fe.push(Ne.substring(Ee,Xe)),Lt(Xe+et),ze&&(Gt(),ut))return Qt();if(re&&oe.length>=re)return Qt(!0)}else for(Be=Ee,Ee++;;){if((Be=Ne.indexOf(D,Be+1))===-1)return Oe||Me.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:oe.length,index:Ee}),Nt();if(Be===Pe-1)return Nt(Ne.substring(Ee,Be).replace(be,D));if(D!==Ye||Ne[Be+1]!==Ye){if(D===Ye||Be===0||Ne[Be-1]!==Ye){ye!==-1&&ye<Be+1&&(ye=Ne.indexOf(te,Be+1)),Xe!==-1&&Xe<Be+1&&(Xe=Ne.indexOf(ue,Be+1));var ct=mr(Xe===-1?ye:Math.min(ye,Xe));if(Ne.substr(Be+1+ct,rt)===te){fe.push(Ne.substring(Ee,Be).replace(be,D)),Ne[Ee=Be+1+ct+rt]!==D&&(Be=Ne.indexOf(D,Ee)),ye=Ne.indexOf(te,Ee),Xe=Ne.indexOf(ue,Ee);break}var At=mr(Xe);if(Ne.substring(Be+1+At,Be+1+At+et)===ue){if(fe.push(Ne.substring(Ee,Be).replace(be,D)),Lt(Be+1+At+et),ye=Ne.indexOf(te,Ee),Be=Ne.indexOf(D,Ee),ze&&(Gt(),ut))return Qt();if(re&&oe.length>=re)return Qt(!0);break}Me.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:oe.length,index:Ee}),Be++}}else Be++}return Nt();function $t(dr){oe.push(dr),pe=Ee}function mr(dr){var Br=0;if(dr!==-1){var qr=Ne.substring(Be+1,dr);qr&&qr.trim()===""&&(Br=qr.length)}return Br}function Nt(dr){return Oe||(dr===void 0&&(dr=Ne.substring(Ee)),fe.push(dr),Ee=Pe,$t(fe),ze&&Gt()),Qt()}function Lt(dr){Ee=dr,$t(fe),fe=[],Xe=Ne.indexOf(ue,Ee)}function Qt(dr){return{data:oe,errors:Me,meta:{delimiter:te,linebreak:ue,aborted:ut,truncated:!!dr,cursor:pe+(He||0)}}}function Gt(){le(Qt()),oe=[],Me=[]}},this.abort=function(){ut=!0},this.getCharIndex=function(){return Ee}}function L(V){var D=V.data,te=d[D.workerId],ue=!1;if(D.error)te.userError(D.error,D.file);else if(D.results&&D.results.data){var J={abort:function(){ue=!0,O(D.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:N,resume:N};if(j(te.userStep)){for(var le=0;le<D.results.data.length&&(te.userStep({data:D.results.data[le],errors:D.results.errors,meta:D.results.meta},J),!ue);le++);delete D.results}else j(te.userChunk)&&(te.userChunk(D.results,J,D.file),delete D.results)}D.finished&&!ue&&O(D.workerId,D.results)}function O(V,D){var te=d[V];j(te.userComplete)&&te.userComplete(D),te.terminate(),delete d[V]}function N(){throw new Error("Not implemented.")}function Q(V){if(typeof V!="object"||V===null)return V;var D=Array.isArray(V)?[]:{};for(var te in V)D[te]=Q(V[te]);return D}function ie(V,D){return function(){V.apply(D,arguments)}}function j(V){return typeof V=="function"}return f&&(s.onmessage=function(V){var D=V.data;if(g.WORKER_ID===void 0&&D&&(g.WORKER_ID=D.workerId),typeof D.input=="string")s.postMessage({workerId:g.WORKER_ID,results:g.parse(D.input,D.config),finished:!0});else if(s.File&&D.input instanceof File||D.input instanceof Object){var te=g.parse(D.input,D.config);te&&s.postMessage({workerId:g.WORKER_ID,results:te,finished:!0})}}),(E.prototype=Object.create(b.prototype)).constructor=E,(T.prototype=Object.create(b.prototype)).constructor=T,(S.prototype=Object.create(S.prototype)).constructor=S,(I.prototype=Object.create(b.prototype)).constructor=I,g})})(SU);var Ave=SU.exports;const CU=qb(Ave);/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var eb={};eb.version="0.20.0";var co=1200,Xd=1252,Jn,kve=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],gk={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},rw=function(t){kve.indexOf(t)!=-1&&(Xd=gk[0]=t)};function Ive(){rw(1252)}var Al=function(t){co=t,rw(t)};function nw(){Al(1200),Ive()}function tb(t){for(var n=[],a=0,s=t.length;a<s;++a)n[a]=t.charCodeAt(a);return n}function AU(t){for(var n=[],a=0;a<t.length>>1;++a)n[a]=String.fromCharCode(t.charCodeAt(2*a)+(t.charCodeAt(2*a+1)<<8));return n.join("")}function Mve(t){for(var n=[],a=0;a<t.length>>1;++a)n[a]=String.fromCharCode(t[2*a]+(t[2*a+1]<<8));return n.join("")}function kU(t){for(var n=[],a=0;a<t.length>>1;++a)n[a]=String.fromCharCode(t.charCodeAt(2*a+1)+(t.charCodeAt(2*a)<<8));return n.join("")}var S0=function(t){var n=t.charCodeAt(0),a=t.charCodeAt(1);return n==255&&a==254?AU(t.slice(2)):n==254&&a==255?kU(t.slice(2)):n==65279?t.slice(1):t},Gg=function(n){return String.fromCharCode(n)},FC=function(n){return String.fromCharCode(n)};function Fve(t){Jn=t,Al=function(n){co=n,rw(n)},S0=function(n){return n.charCodeAt(0)===255&&n.charCodeAt(1)===254?Jn.utils.decode(1200,tb(n.slice(2))):n},Gg=function(a){return co===1200?String.fromCharCode(a):Jn.utils.decode(co,[a&255,a>>8])[0]},FC=function(a){return Jn.utils.decode(Xd,[a])[0]},t9()}var Pve=null,jo="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function rb(t){for(var n="",a=0,s=0,c=0,f=0,d=0,p=0,g=0,y=0;y<t.length;)a=t.charCodeAt(y++),f=a>>2,s=t.charCodeAt(y++),d=(a&3)<<4|s>>4,c=t.charCodeAt(y++),p=(s&15)<<2|c>>6,g=c&63,isNaN(s)?p=g=64:isNaN(c)&&(g=64),n+=jo.charAt(f)+jo.charAt(d)+jo.charAt(p)+jo.charAt(g);return n}function Ove(t){for(var n="",a=0,s=0,c=0,f=0,d=0,p=0,g=0,y=0;y<t.length;)a=t.charCodeAt(y++),a>255&&(a=95),f=a>>2,s=t.charCodeAt(y++),s>255&&(s=95),d=(a&3)<<4|s>>4,c=t.charCodeAt(y++),c>255&&(c=95),p=(s&15)<<2|c>>6,g=c&63,isNaN(s)?p=g=64:isNaN(c)&&(g=64),n+=jo.charAt(f)+jo.charAt(d)+jo.charAt(p)+jo.charAt(g);return n}function Rve(t){for(var n="",a=0,s=0,c=0,f=0,d=0,p=0,g=0,y=0;y<t.length;)a=t[y++],f=a>>2,s=t[y++],d=(a&3)<<4|s>>4,c=t[y++],p=(s&15)<<2|c>>6,g=c&63,isNaN(s)?p=g=64:isNaN(c)&&(g=64),n+=jo.charAt(f)+jo.charAt(d)+jo.charAt(p)+jo.charAt(g);return n}function ll(t){var n="",a=0,s=0,c=0,f=0,d=0,p=0,g=0;t=t.replace(/^data:([^\/]+\/[^\/]+)?;base64\,/,"").replace(/[^\w\+\/\=]/g,"");for(var y=0;y<t.length;)f=jo.indexOf(t.charAt(y++)),d=jo.indexOf(t.charAt(y++)),a=f<<2|d>>4,n+=String.fromCharCode(a),p=jo.indexOf(t.charAt(y++)),s=(d&15)<<4|p>>2,p!==64&&(n+=String.fromCharCode(s)),g=jo.indexOf(t.charAt(y++)),c=(p&3)<<6|g,g!==64&&(n+=String.fromCharCode(c));return n}var oi=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),hu=function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(n,a){return a?new Buffer(n,a):new Buffer(n)}:Buffer.from.bind(Buffer)}return function(){}}(),j_=function(){if(typeof Buffer>"u")return!1;var t=hu([65,0]);if(!t)return!1;var n=t.toString("utf16le");return n.length==1}();function Ah(t){return oi?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function P5(t){return oi?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var us=function(n){return oi?hu(n,"binary"):n.split("").map(function(a){return a.charCodeAt(0)&255})};function bv(t){if(typeof ArrayBuffer>"u")return us(t);for(var n=new ArrayBuffer(t.length),a=new Uint8Array(n),s=0;s!=t.length;++s)a[s]=t.charCodeAt(s)&255;return n}function su(t){if(Array.isArray(t))return t.map(function(s){return String.fromCharCode(s)}).join("");for(var n=[],a=0;a<t.length;++a)n[a]=String.fromCharCode(t[a]);return n.join("")}function Lve(t){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(t)}function _k(t){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(t instanceof ArrayBuffer)return _k(new Uint8Array(t));for(var n=new Array(t.length),a=0;a<t.length;++a)n[a]=t[a];return n}var Va=oi?function(t){return Buffer.concat(t.map(function(n){return Buffer.isBuffer(n)?n:hu(n)}))}:function(t){if(typeof Uint8Array<"u"){var n=0,a=0;for(n=0;n<t.length;++n)a+=t[n].length;var s=new Uint8Array(a),c=0;for(n=0,a=0;n<t.length;a+=c,++n)c=t[n].length,t[n]instanceof Uint8Array?s.set(t[n],a):typeof t[n]=="string"?s.set(new Uint8Array(us(t[n])),a):s.set(new Uint8Array(t[n]),a);return s}return[].concat.apply([],t.map(function(f){return Array.isArray(f)?f:[].slice.call(f)}))};function Dve(t){for(var n=[],a=0,s=t.length+250,c=Ah(t.length+255),f=0;f<t.length;++f){var d=t.charCodeAt(f);if(d<128)c[a++]=d;else if(d<2048)c[a++]=192|d>>6&31,c[a++]=128|d&63;else if(d>=55296&&d<57344){d=(d&1023)+64;var p=t.charCodeAt(++f)&1023;c[a++]=240|d>>8&7,c[a++]=128|d>>2&63,c[a++]=128|p>>6&15|(d&3)<<4,c[a++]=128|p&63}else c[a++]=224|d>>12&15,c[a++]=128|d>>6&63,c[a++]=128|d&63;a>s&&(n.push(c.slice(0,a)),a=0,c=Ah(65535),s=65530)}return n.push(c.slice(0,a)),Va(n)}var Ho=/\u0000/g,qg=/[\u0001-\u0006]/g;function P0(t){for(var n="",a=t.length-1;a>=0;)n+=t.charAt(a--);return n}function sc(t,n){var a=""+t;return a.length>=n?a:Mi("0",n-a.length)+a}function vk(t,n){var a=""+t;return a.length>=n?a:Mi(" ",n-a.length)+a}function nb(t,n){var a=""+t;return a.length>=n?a:a+Mi(" ",n-a.length)}function Bve(t,n){var a=""+Math.round(t);return a.length>=n?a:Mi("0",n-a.length)+a}function zve(t,n){var a=""+t;return a.length>=n?a:Mi("0",n-a.length)+a}var O5=Math.pow(2,32);function v0(t,n){if(t>O5||t<-O5)return Bve(t,n);var a=Math.round(t);return zve(a,n)}function ib(t,n){return n=n||0,t.length>=7+n&&(t.charCodeAt(n)|32)===103&&(t.charCodeAt(n+1)|32)===101&&(t.charCodeAt(n+2)|32)===110&&(t.charCodeAt(n+3)|32)===101&&(t.charCodeAt(n+4)|32)===114&&(t.charCodeAt(n+5)|32)===97&&(t.charCodeAt(n+6)|32)===108}var R5=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],cS=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function Nve(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',t}var pn={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'},L5={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},Uve={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function ab(t,n,a){for(var s=t<0?-1:1,c=t*s,f=0,d=1,p=0,g=1,y=0,b=0,E=Math.floor(c);y<n&&(E=Math.floor(c),p=E*d+f,b=E*y+g,!(c-E<5e-8));)c=1/(c-E),f=d,d=p,g=y,y=b;if(b>n&&(y>n?(b=g,p=f):(b=y,p=d)),!a)return[0,s*p,b];var T=Math.floor(s*p/b);return[T,s*p-T*b,b]}function vh(t,n,a){if(t>2958465||t<0)return null;var s=t|0,c=Math.floor(86400*(t-s)),f=0,d=[],p={D:s,T:c,u:86400*(t-s)-c,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(p.u)<1e-6&&(p.u=0),n&&n.date1904&&(s+=1462),p.u>.9999&&(p.u=0,++c==86400&&(p.T=c=0,++s,++p.D)),s===60)d=a?[1317,10,29]:[1900,2,29],f=3;else if(s===0)d=a?[1317,8,29]:[1900,1,0],f=6;else{s>60&&--s;var g=new Date(1900,0,1);g.setDate(g.getDate()+s-1),d=[g.getFullYear(),g.getMonth()+1,g.getDate()],f=g.getDay(),s<60&&(f=(f+6)%7),a&&(f=Wve(g,d))}return p.y=d[0],p.m=d[1],p.d=d[2],p.S=c%60,c=Math.floor(c/60),p.M=c%60,c=Math.floor(c/60),p.H=c,p.q=f,p}function yk(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function $ve(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function Vve(t){var n=t<0?12:11,a=yk(t.toFixed(12));return a.length<=n||(a=t.toPrecision(10),a.length<=n)?a:t.toExponential(5)}function jve(t){var n=yk(t.toFixed(11));return n.length>(t<0?12:11)||n==="0"||n==="-0"?t.toPrecision(6):n}function W_(t){var n=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),a;return n>=-4&&n<=-1?a=t.toPrecision(10+n):Math.abs(n)<=9?a=Vve(t):n===10?a=t.toFixed(10).substr(0,12):a=jve(t),yk($ve(a.toUpperCase()))}function Zd(t,n){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):W_(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return $s(14,La(t,n&&n.date1904),n)}throw new Error("unsupported value in General format: "+t)}function Wve(t,n){n[0]-=581;var a=t.getDay();return t<60&&(a=(a+6)%7),a}function Hve(t,n,a,s){var c="",f=0,d=0,p=a.y,g,y=0;switch(t){case 98:p=a.y+543;case 121:switch(n.length){case 1:case 2:g=p%100,y=2;break;default:g=p%1e4,y=4;break}break;case 109:switch(n.length){case 1:case 2:g=a.m,y=n.length;break;case 3:return cS[a.m-1][1];case 5:return cS[a.m-1][0];default:return cS[a.m-1][2]}break;case 100:switch(n.length){case 1:case 2:g=a.d,y=n.length;break;case 3:return R5[a.q][0];default:return R5[a.q][1]}break;case 104:switch(n.length){case 1:case 2:g=1+(a.H+11)%12,y=n.length;break;default:throw"bad hour format: "+n}break;case 72:switch(n.length){case 1:case 2:g=a.H,y=n.length;break;default:throw"bad hour format: "+n}break;case 77:switch(n.length){case 1:case 2:g=a.M,y=n.length;break;default:throw"bad minute format: "+n}break;case 115:if(n!="s"&&n!="ss"&&n!=".0"&&n!=".00"&&n!=".000")throw"bad second format: "+n;return a.u===0&&(n=="s"||n=="ss")?sc(a.S,n.length):(s>=2?d=s===3?1e3:100:d=s===1?10:1,f=Math.round(d*(a.S+a.u)),f>=60*d&&(f=0),n==="s"?f===0?"0":""+f/d:(c=sc(f,2+s),n==="ss"?c.substr(0,2):"."+c.substr(2,n.length-1)));case 90:switch(n){case"[h]":case"[hh]":g=a.D*24+a.H;break;case"[m]":case"[mm]":g=(a.D*24+a.H)*60+a.M;break;case"[s]":case"[ss]":g=((a.D*24+a.H)*60+a.M)*60+Math.round(a.S+a.u);break;default:throw"bad abstime format: "+n}y=n.length===3?1:2;break;case 101:g=p,y=1;break}var b=y>0?sc(g,y):"";return b}function ju(t){var n=3;if(t.length<=n)return t;for(var a=t.length%n,s=t.substr(0,a);a!=t.length;a+=n)s+=(s.length>0?",":"")+t.substr(a,n);return s}var IU=/%/g;function Gve(t,n,a){var s=n.replace(IU,""),c=n.length-s.length;return Xu(t,s,a*Math.pow(10,2*c))+Mi("%",c)}function qve(t,n,a){for(var s=n.length-1;n.charCodeAt(s-1)===44;)--s;return Xu(t,n.substr(0,s),a/Math.pow(10,3*(n.length-s)))}function MU(t,n){var a,s=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(n==0)return"0.0E+0";if(n<0)return"-"+MU(t,-n);var c=t.indexOf(".");c===-1&&(c=t.indexOf("E"));var f=Math.floor(Math.log(n)*Math.LOG10E)%c;if(f<0&&(f+=c),a=(n/Math.pow(10,f)).toPrecision(s+1+(c+f)%c),a.indexOf("e")===-1){var d=Math.floor(Math.log(n)*Math.LOG10E);for(a.indexOf(".")===-1?a=a.charAt(0)+"."+a.substr(1)+"E+"+(d-a.length+f):a+="E+"+(d-f);a.substr(0,2)==="0.";)a=a.charAt(0)+a.substr(2,c)+"."+a.substr(2+c),a=a.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");a=a.replace(/\+-/,"-")}a=a.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(p,g,y,b){return g+y+b.substr(0,(c+f)%c)+"."+b.substr(f)+"E"})}else a=n.toExponential(s);return t.match(/E\+00$/)&&a.match(/e[+-]\d$/)&&(a=a.substr(0,a.length-1)+"0"+a.charAt(a.length-1)),t.match(/E\-/)&&a.match(/e\+/)&&(a=a.replace(/e\+/,"e")),a.replace("e","E")}var FU=/# (\?+)( ?)\/( ?)(\d+)/;function Xve(t,n,a){var s=parseInt(t[4],10),c=Math.round(n*s),f=Math.floor(c/s),d=c-f*s,p=s;return a+(f===0?"":""+f)+" "+(d===0?Mi(" ",t[1].length+1+t[4].length):vk(d,t[1].length)+t[2]+"/"+t[3]+sc(p,t[4].length))}function Zve(t,n,a){return a+(n===0?"":""+n)+Mi(" ",t[1].length+2+t[4].length)}var PU=/^#*0*\.([0#]+)/,OU=/\).*[0#]/,RU=/\(###\) ###\\?-####/;function ls(t){for(var n="",a,s=0;s!=t.length;++s)switch(a=t.charCodeAt(s)){case 35:break;case 63:n+=" ";break;case 48:n+="0";break;default:n+=String.fromCharCode(a)}return n}function D5(t,n){var a=Math.pow(10,n);return""+Math.round(t*a)/a}function B5(t,n){var a=t-Math.floor(t),s=Math.pow(10,n);return n<(""+Math.round(a*s)).length?0:Math.round(a*s)}function Kve(t,n){return n<(""+Math.round((t-Math.floor(t))*Math.pow(10,n))).length?1:0}function Yve(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function wl(t,n,a){if(t.charCodeAt(0)===40&&!n.match(OU)){var s=n.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return a>=0?wl("n",s,a):"("+wl("n",s,-a)+")"}if(n.charCodeAt(n.length-1)===44)return qve(t,n,a);if(n.indexOf("%")!==-1)return Gve(t,n,a);if(n.indexOf("E")!==-1)return MU(n,a);if(n.charCodeAt(0)===36)return"$"+wl(t,n.substr(n.charAt(1)==" "?2:1),a);var c,f,d,p,g=Math.abs(a),y=a<0?"-":"";if(n.match(/^00+$/))return y+v0(g,n.length);if(n.match(/^[#?]+$/))return c=v0(a,0),c==="0"&&(c=""),c.length>n.length?c:ls(n.substr(0,n.length-c.length))+c;if(f=n.match(FU))return Xve(f,g,y);if(n.match(/^#+0+$/))return y+v0(g,n.length-n.indexOf("0"));if(f=n.match(PU))return c=D5(a,f[1].length).replace(/^([^\.]+)$/,"$1."+ls(f[1])).replace(/\.$/,"."+ls(f[1])).replace(/\.(\d*)$/,function(I,A){return"."+A+Mi("0",ls(f[1]).length-A.length)}),n.indexOf("0.")!==-1?c:c.replace(/^0\./,".");if(n=n.replace(/^#+([0.])/,"$1"),f=n.match(/^(0*)\.(#*)$/))return y+D5(g,f[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,f[1].length?"0.":".");if(f=n.match(/^#{1,3},##0(\.?)$/))return y+ju(v0(g,0));if(f=n.match(/^#,##0\.([#0]*0)$/))return a<0?"-"+wl(t,n,-a):ju(""+(Math.floor(a)+Kve(a,f[1].length)))+"."+sc(B5(a,f[1].length),f[1].length);if(f=n.match(/^#,#*,#0/))return wl(t,n.replace(/^#,#*,/,""),a);if(f=n.match(/^([0#]+)(\\?-([0#]+))+$/))return c=P0(wl(t,n.replace(/[\\-]/g,""),a)),d=0,P0(P0(n.replace(/\\/g,"")).replace(/[0#]/g,function(I){return d<c.length?c.charAt(d++):I==="0"?"0":""}));if(n.match(RU))return c=wl(t,"##########",a),"("+c.substr(0,3)+") "+c.substr(3,3)+"-"+c.substr(6);var b="";if(f=n.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return d=Math.min(f[4].length,7),p=ab(g,Math.pow(10,d)-1,!1),c=""+y,b=Xu("n",f[1],p[1]),b.charAt(b.length-1)==" "&&(b=b.substr(0,b.length-1)+"0"),c+=b+f[2]+"/"+f[3],b=nb(p[2],d),b.length<f[4].length&&(b=ls(f[4].substr(f[4].length-b.length))+b),c+=b,c;if(f=n.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return d=Math.min(Math.max(f[1].length,f[4].length),7),p=ab(g,Math.pow(10,d)-1,!0),y+(p[0]||(p[1]?"":"0"))+" "+(p[1]?vk(p[1],d)+f[2]+"/"+f[3]+nb(p[2],d):Mi(" ",2*d+1+f[2].length+f[3].length));if(f=n.match(/^[#0?]+$/))return c=v0(a,0),n.length<=c.length?c:ls(n.substr(0,n.length-c.length))+c;if(f=n.match(/^([#0?]+)\.([#0]+)$/)){c=""+a.toFixed(Math.min(f[2].length,10)).replace(/([^0])0+$/,"$1"),d=c.indexOf(".");var E=n.indexOf(".")-d,T=n.length-c.length-E;return ls(n.substr(0,E)+c+n.substr(n.length-T))}if(f=n.match(/^00,000\.([#0]*0)$/))return d=B5(a,f[1].length),a<0?"-"+wl(t,n,-a):ju(Yve(a)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(I){return"00,"+(I.length<3?sc(0,3-I.length):"")+I})+"."+sc(d,f[1].length);switch(n){case"###,##0.00":return wl(t,"#,##0.00",a);case"###,###":case"##,###":case"#,###":var S=ju(v0(g,0));return S!=="0"?y+S:"";case"###,###.00":return wl(t,"###,##0.00",a).replace(/^0\./,".");case"#,###.00":return wl(t,"#,##0.00",a).replace(/^0\./,".")}throw new Error("unsupported format |"+n+"|")}function Jve(t,n,a){for(var s=n.length-1;n.charCodeAt(s-1)===44;)--s;return Xu(t,n.substr(0,s),a/Math.pow(10,3*(n.length-s)))}function Qve(t,n,a){var s=n.replace(IU,""),c=n.length-s.length;return Xu(t,s,a*Math.pow(10,2*c))+Mi("%",c)}function LU(t,n){var a,s=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(n==0)return"0.0E+0";if(n<0)return"-"+LU(t,-n);var c=t.indexOf(".");c===-1&&(c=t.indexOf("E"));var f=Math.floor(Math.log(n)*Math.LOG10E)%c;if(f<0&&(f+=c),a=(n/Math.pow(10,f)).toPrecision(s+1+(c+f)%c),!a.match(/[Ee]/)){var d=Math.floor(Math.log(n)*Math.LOG10E);a.indexOf(".")===-1?a=a.charAt(0)+"."+a.substr(1)+"E+"+(d-a.length+f):a+="E+"+(d-f),a=a.replace(/\+-/,"-")}a=a.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(p,g,y,b){return g+y+b.substr(0,(c+f)%c)+"."+b.substr(f)+"E"})}else a=n.toExponential(s);return t.match(/E\+00$/)&&a.match(/e[+-]\d$/)&&(a=a.substr(0,a.length-1)+"0"+a.charAt(a.length-1)),t.match(/E\-/)&&a.match(/e\+/)&&(a=a.replace(/e\+/,"e")),a.replace("e","E")}function Zc(t,n,a){if(t.charCodeAt(0)===40&&!n.match(OU)){var s=n.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return a>=0?Zc("n",s,a):"("+Zc("n",s,-a)+")"}if(n.charCodeAt(n.length-1)===44)return Jve(t,n,a);if(n.indexOf("%")!==-1)return Qve(t,n,a);if(n.indexOf("E")!==-1)return LU(n,a);if(n.charCodeAt(0)===36)return"$"+Zc(t,n.substr(n.charAt(1)==" "?2:1),a);var c,f,d,p,g=Math.abs(a),y=a<0?"-":"";if(n.match(/^00+$/))return y+sc(g,n.length);if(n.match(/^[#?]+$/))return c=""+a,a===0&&(c=""),c.length>n.length?c:ls(n.substr(0,n.length-c.length))+c;if(f=n.match(FU))return Zve(f,g,y);if(n.match(/^#+0+$/))return y+sc(g,n.length-n.indexOf("0"));if(f=n.match(PU))return c=(""+a).replace(/^([^\.]+)$/,"$1."+ls(f[1])).replace(/\.$/,"."+ls(f[1])),c=c.replace(/\.(\d*)$/,function(I,A){return"."+A+Mi("0",ls(f[1]).length-A.length)}),n.indexOf("0.")!==-1?c:c.replace(/^0\./,".");if(n=n.replace(/^#+([0.])/,"$1"),f=n.match(/^(0*)\.(#*)$/))return y+(""+g).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,f[1].length?"0.":".");if(f=n.match(/^#{1,3},##0(\.?)$/))return y+ju(""+g);if(f=n.match(/^#,##0\.([#0]*0)$/))return a<0?"-"+Zc(t,n,-a):ju(""+a)+"."+Mi("0",f[1].length);if(f=n.match(/^#,#*,#0/))return Zc(t,n.replace(/^#,#*,/,""),a);if(f=n.match(/^([0#]+)(\\?-([0#]+))+$/))return c=P0(Zc(t,n.replace(/[\\-]/g,""),a)),d=0,P0(P0(n.replace(/\\/g,"")).replace(/[0#]/g,function(I){return d<c.length?c.charAt(d++):I==="0"?"0":""}));if(n.match(RU))return c=Zc(t,"##########",a),"("+c.substr(0,3)+") "+c.substr(3,3)+"-"+c.substr(6);var b="";if(f=n.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return d=Math.min(f[4].length,7),p=ab(g,Math.pow(10,d)-1,!1),c=""+y,b=Xu("n",f[1],p[1]),b.charAt(b.length-1)==" "&&(b=b.substr(0,b.length-1)+"0"),c+=b+f[2]+"/"+f[3],b=nb(p[2],d),b.length<f[4].length&&(b=ls(f[4].substr(f[4].length-b.length))+b),c+=b,c;if(f=n.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return d=Math.min(Math.max(f[1].length,f[4].length),7),p=ab(g,Math.pow(10,d)-1,!0),y+(p[0]||(p[1]?"":"0"))+" "+(p[1]?vk(p[1],d)+f[2]+"/"+f[3]+nb(p[2],d):Mi(" ",2*d+1+f[2].length+f[3].length));if(f=n.match(/^[#0?]+$/))return c=""+a,n.length<=c.length?c:ls(n.substr(0,n.length-c.length))+c;if(f=n.match(/^([#0]+)\.([#0]+)$/)){c=""+a.toFixed(Math.min(f[2].length,10)).replace(/([^0])0+$/,"$1"),d=c.indexOf(".");var E=n.indexOf(".")-d,T=n.length-c.length-E;return ls(n.substr(0,E)+c+n.substr(n.length-T))}if(f=n.match(/^00,000\.([#0]*0)$/))return a<0?"-"+Zc(t,n,-a):ju(""+a).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(I){return"00,"+(I.length<3?sc(0,3-I.length):"")+I})+"."+sc(0,f[1].length);switch(n){case"###,###":case"##,###":case"#,###":var S=ju(""+g);return S!=="0"?y+S:"";default:if(n.match(/\.[0#?]*$/))return Zc(t,n.slice(0,n.lastIndexOf(".")),a)+ls(n.slice(n.lastIndexOf(".")))}throw new Error("unsupported format |"+n+"|")}function Xu(t,n,a){return(a|0)===a?Zc(t,n,a):wl(t,n,a)}function e1e(t){for(var n=[],a=!1,s=0,c=0;s<t.length;++s)switch(t.charCodeAt(s)){case 34:a=!a;break;case 95:case 42:case 92:++s;break;case 59:n[n.length]=t.substr(c,s-c),c=s+1}if(n[n.length]=t.substr(c),a===!0)throw new Error("Format |"+t+"| unterminated string ");return n}var DU=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function cl(t){for(var n=0,a="",s="";n<t.length;)switch(a=t.charAt(n)){case"G":ib(t,n)&&(n+=6),n++;break;case'"':for(;t.charCodeAt(++n)!==34&&n<t.length;);++n;break;case"\\":n+=2;break;case"_":n+=2;break;case"@":++n;break;case"B":case"b":if(t.charAt(n+1)==="1"||t.charAt(n+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if(t.substr(n,3).toUpperCase()==="A/P"||t.substr(n,5).toUpperCase()==="AM/PM"||t.substr(n,5).toUpperCase()==="上午/下午")return!0;++n;break;case"[":for(s=a;t.charAt(n++)!=="]"&&n<t.length;)s+=t.charAt(n);if(s.match(DU))return!0;break;case".":case"0":case"#":for(;n<t.length&&("0#?.,E+-%".indexOf(a=t.charAt(++n))>-1||a=="\\"&&t.charAt(n+1)=="-"&&"0#".indexOf(t.charAt(n+2))>-1););break;case"?":for(;t.charAt(++n)===a;);break;case"*":++n,(t.charAt(n)==" "||t.charAt(n)=="*")&&++n;break;case"(":case")":++n;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;n<t.length&&"0123456789".indexOf(t.charAt(++n))>-1;);break;case" ":++n;break;default:++n;break}return!1}function t1e(t,n,a,s){for(var c=[],f="",d=0,p="",g="t",y,b,E,T="H";d<t.length;)switch(p=t.charAt(d)){case"G":if(!ib(t,d))throw new Error("unrecognized character "+p+" in "+t);c[c.length]={t:"G",v:"General"},d+=7;break;case'"':for(f="";(E=t.charCodeAt(++d))!==34&&d<t.length;)f+=String.fromCharCode(E);c[c.length]={t:"t",v:f},++d;break;case"\\":var S=t.charAt(++d),I=S==="("||S===")"?S:"t";c[c.length]={t:I,v:S},++d;break;case"_":c[c.length]={t:"t",v:" "},d+=2;break;case"@":c[c.length]={t:"T",v:n},++d;break;case"B":case"b":if(t.charAt(d+1)==="1"||t.charAt(d+1)==="2"){if(y==null&&(y=vh(n,a,t.charAt(d+1)==="2"),y==null))return"";c[c.length]={t:"X",v:t.substr(d,2)},g=p,d+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":p=p.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(n<0||y==null&&(y=vh(n,a),y==null))return"";for(f=p;++d<t.length&&t.charAt(d).toLowerCase()===p;)f+=p;p==="m"&&g.toLowerCase()==="h"&&(p="M"),p==="h"&&(p=T),c[c.length]={t:p,v:f},g=p;break;case"A":case"a":case"上":var A={t:p,v:p};if(y==null&&(y=vh(n,a)),t.substr(d,3).toUpperCase()==="A/P"?(y!=null&&(A.v=y.H>=12?t.charAt(d+2):p),A.t="T",T="h",d+=3):t.substr(d,5).toUpperCase()==="AM/PM"?(y!=null&&(A.v=y.H>=12?"PM":"AM"),A.t="T",d+=5,T="h"):t.substr(d,5).toUpperCase()==="上午/下午"?(y!=null&&(A.v=y.H>=12?"下午":"上午"),A.t="T",d+=5,T="h"):(A.t="t",++d),y==null&&A.t==="T")return"";c[c.length]=A,g=p;break;case"[":for(f=p;t.charAt(d++)!=="]"&&d<t.length;)f+=t.charAt(d);if(f.slice(-1)!=="]")throw'unterminated "[" block: |'+f+"|";if(f.match(DU)){if(y==null&&(y=vh(n,a),y==null))return"";c[c.length]={t:"Z",v:f.toLowerCase()},g=f.charAt(1)}else f.indexOf("$")>-1&&(f=(f.match(/\$([^-\[\]]*)/)||[])[1]||"$",cl(t)||(c[c.length]={t:"t",v:f}));break;case".":if(y!=null){for(f=p;++d<t.length&&(p=t.charAt(d))==="0";)f+=p;c[c.length]={t:"s",v:f};break}case"0":case"#":for(f=p;++d<t.length&&"0#?.,E+-%".indexOf(p=t.charAt(d))>-1;)f+=p;c[c.length]={t:"n",v:f};break;case"?":for(f=p;t.charAt(++d)===p;)f+=p;c[c.length]={t:p,v:f},g=p;break;case"*":++d,(t.charAt(d)==" "||t.charAt(d)=="*")&&++d;break;case"(":case")":c[c.length]={t:s===1?"t":p,v:p},++d;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(f=p;d<t.length&&"0123456789".indexOf(t.charAt(++d))>-1;)f+=t.charAt(d);c[c.length]={t:"D",v:f};break;case" ":c[c.length]={t:p,v:p},++d;break;case"$":c[c.length]={t:"t",v:"$"},++d;break;default:if(",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(p)===-1)throw new Error("unrecognized character "+p+" in "+t);c[c.length]={t:"t",v:p},++d;break}var M=0,F=0,L;for(d=c.length-1,g="t";d>=0;--d)switch(c[d].t){case"h":case"H":c[d].t=T,g="h",M<1&&(M=1);break;case"s":(L=c[d].v.match(/\.0+$/))&&(F=Math.max(F,L[0].length-1)),M<3&&(M=3);case"d":case"y":case"M":case"e":g=c[d].t;break;case"m":g==="s"&&(c[d].t="M",M<2&&(M=2));break;case"X":break;case"Z":M<1&&c[d].v.match(/[Hh]/)&&(M=1),M<2&&c[d].v.match(/[Mm]/)&&(M=2),M<3&&c[d].v.match(/[Ss]/)&&(M=3)}switch(M){case 0:break;case 1:y.u>=.5&&(y.u=0,++y.S),y.S>=60&&(y.S=0,++y.M),y.M>=60&&(y.M=0,++y.H);break;case 2:y.u>=.5&&(y.u=0,++y.S),y.S>=60&&(y.S=0,++y.M);break}var O="",N;for(d=0;d<c.length;++d)switch(c[d].t){case"t":case"T":case" ":case"D":break;case"X":c[d].v="",c[d].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":c[d].v=Hve(c[d].t.charCodeAt(0),c[d].v,y,F),c[d].t="t";break;case"n":case"?":for(N=d+1;c[N]!=null&&((p=c[N].t)==="?"||p==="D"||(p===" "||p==="t")&&c[N+1]!=null&&(c[N+1].t==="?"||c[N+1].t==="t"&&c[N+1].v==="/")||c[d].t==="("&&(p===" "||p==="n"||p===")")||p==="t"&&(c[N].v==="/"||c[N].v===" "&&c[N+1]!=null&&c[N+1].t=="?"));)c[d].v+=c[N].v,c[N]={v:"",t:";"},++N;O+=c[d].v,d=N-1;break;case"G":c[d].t="t",c[d].v=Zd(n,a);break}var Q="",ie,j;if(O.length>0){O.charCodeAt(0)==40?(ie=n<0&&O.charCodeAt(0)===45?-n:n,j=Xu("n",O,ie)):(ie=n<0&&s>1?-n:n,j=Xu("n",O,ie),ie<0&&c[0]&&c[0].t=="t"&&(j=j.substr(1),c[0].v="-"+c[0].v)),N=j.length-1;var V=c.length;for(d=0;d<c.length;++d)if(c[d]!=null&&c[d].t!="t"&&c[d].v.indexOf(".")>-1){V=d;break}var D=c.length;if(V===c.length&&j.indexOf("E")===-1){for(d=c.length-1;d>=0;--d)c[d]==null||"n?".indexOf(c[d].t)===-1||(N>=c[d].v.length-1?(N-=c[d].v.length,c[d].v=j.substr(N+1,c[d].v.length)):N<0?c[d].v="":(c[d].v=j.substr(0,N+1),N=-1),c[d].t="t",D=d);N>=0&&D<c.length&&(c[D].v=j.substr(0,N+1)+c[D].v)}else if(V!==c.length&&j.indexOf("E")===-1){for(N=j.indexOf(".")-1,d=V;d>=0;--d)if(!(c[d]==null||"n?".indexOf(c[d].t)===-1)){for(b=c[d].v.indexOf(".")>-1&&d===V?c[d].v.indexOf(".")-1:c[d].v.length-1,Q=c[d].v.substr(b+1);b>=0;--b)N>=0&&(c[d].v.charAt(b)==="0"||c[d].v.charAt(b)==="#")&&(Q=j.charAt(N--)+Q);c[d].v=Q,c[d].t="t",D=d}for(N>=0&&D<c.length&&(c[D].v=j.substr(0,N+1)+c[D].v),N=j.indexOf(".")+1,d=V;d<c.length;++d)if(!(c[d]==null||"n?(".indexOf(c[d].t)===-1&&d!==V)){for(b=c[d].v.indexOf(".")>-1&&d===V?c[d].v.indexOf(".")+1:0,Q=c[d].v.substr(0,b);b<c[d].v.length;++b)N<j.length&&(Q+=j.charAt(N++));c[d].v=Q,c[d].t="t",D=d}}}for(d=0;d<c.length;++d)c[d]!=null&&"n?".indexOf(c[d].t)>-1&&(ie=s>1&&n<0&&d>0&&c[d-1].v==="-"?-n:n,c[d].v=Xu(c[d].t,c[d].v,ie),c[d].t="t");var te="";for(d=0;d!==c.length;++d)c[d]!=null&&(te+=c[d].v);return te}var z5=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function N5(t,n){if(n==null)return!1;var a=parseFloat(n[2]);switch(n[1]){case"=":if(t==a)return!0;break;case">":if(t>a)return!0;break;case"<":if(t<a)return!0;break;case"<>":if(t!=a)return!0;break;case">=":if(t>=a)return!0;break;case"<=":if(t<=a)return!0;break}return!1}function r1e(t,n){var a=e1e(t),s=a.length,c=a[s-1].indexOf("@");if(s<4&&c>-1&&--s,a.length>4)throw new Error("cannot find right format for |"+a.join("|")+"|");if(typeof n!="number")return[4,a.length===4||c>-1?a[a.length-1]:"@"];switch(a.length){case 1:a=c>-1?["General","General","General",a[0]]:[a[0],a[0],a[0],"@"];break;case 2:a=c>-1?[a[0],a[0],a[0],a[1]]:[a[0],a[1],a[0],"@"];break;case 3:a=c>-1?[a[0],a[1],a[0],a[2]]:[a[0],a[1],a[2],"@"];break}var f=n>0?a[0]:n<0?a[1]:a[2];if(a[0].indexOf("[")===-1&&a[1].indexOf("[")===-1)return[s,f];if(a[0].match(/\[[=<>]/)!=null||a[1].match(/\[[=<>]/)!=null){var d=a[0].match(z5),p=a[1].match(z5);return N5(n,d)?[s,a[0]]:N5(n,p)?[s,a[1]]:[s,a[d!=null&&p!=null?2:1]]}return[s,f]}function $s(t,n,a){a==null&&(a={});var s="";switch(typeof t){case"string":t=="m/d/yy"&&a.dateNF?s=a.dateNF:s=t;break;case"number":t==14&&a.dateNF?s=a.dateNF:s=(a.table!=null?a.table:pn)[t],s==null&&(s=a.table&&a.table[L5[t]]||pn[L5[t]]),s==null&&(s=Uve[t]||"General");break}if(ib(s,0))return Zd(n,a);n instanceof Date&&(n=La(n,a.date1904));var c=r1e(s,n);if(ib(c[1]))return Zd(n,a);if(n===!0)n="TRUE";else if(n===!1)n="FALSE";else if(n===""||n==null)return"";return t1e(c[1],n,a,c[0])}function xk(t,n){if(typeof n!="number"){n=+n||-1;for(var a=0;a<392;++a){if(pn[a]==null){n<0&&(n=a);continue}if(pn[a]==t){n=a;break}}n<0&&(n=391)}return pn[n]=t,n}function wv(t){for(var n=0;n!=392;++n)t[n]!==void 0&&xk(t[n],n)}function ym(){pn=Nve()}var BU={format:$s,load:xk,_table:pn,load_table:wv,parse_date_code:vh,is_date:cl,get_table:function(){return BU._table=pn}},n1e={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},ob=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function i1e(t){var n=typeof t=="number"?pn[t]:t;return n=n.replace(ob,"(\\d+)"),ob.lastIndex=0,new RegExp("^"+n+"$")}function a1e(t,n,a){var s=-1,c=-1,f=-1,d=-1,p=-1,g=-1;(n.match(ob)||[]).forEach(function(E,T){var S=parseInt(a[T+1],10);switch(E.toLowerCase().charAt(0)){case"y":s=S;break;case"d":f=S;break;case"h":d=S;break;case"s":g=S;break;case"m":d>=0?p=S:c=S;break}}),ob.lastIndex=0,g>=0&&p==-1&&c>=0&&(p=c,c=-1);var y=(""+(s>=0?s:new Date().getFullYear())).slice(-4)+"-"+("00"+(c>=1?c:1)).slice(-2)+"-"+("00"+(f>=1?f:1)).slice(-2);y.length==7&&(y="0"+y),y.length==8&&(y="20"+y);var b=("00"+(d>=0?d:0)).slice(-2)+":"+("00"+(p>=0?p:0)).slice(-2)+":"+("00"+(g>=0?g:0)).slice(-2);return d==-1&&p==-1&&g==-1?y:s==-1&&c==-1&&f==-1?b:y+"T"+b}var o1e={"d.m":"d\\.m"};function Eh(t,n){return xk(o1e[t]||t,n)}var U5=function(){var t={};t.version="1.2.0";function n(){for(var j=0,V=new Array(256),D=0;D!=256;++D)j=D,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,V[D]=j;return typeof Int32Array<"u"?new Int32Array(V):V}var a=n();function s(j){var V=0,D=0,te=0,ue=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(te=0;te!=256;++te)ue[te]=j[te];for(te=0;te!=256;++te)for(D=j[te],V=256+te;V<4096;V+=256)D=ue[V]=D>>>8^j[D&255];var J=[];for(te=1;te!=16;++te)J[te-1]=typeof Int32Array<"u"&&typeof ue.subarray=="function"?ue.subarray(te*256,te*256+256):ue.slice(te*256,te*256+256);return J}var c=s(a),f=c[0],d=c[1],p=c[2],g=c[3],y=c[4],b=c[5],E=c[6],T=c[7],S=c[8],I=c[9],A=c[10],M=c[11],F=c[12],L=c[13],O=c[14];function N(j,V){for(var D=V^-1,te=0,ue=j.length;te<ue;)D=D>>>8^a[(D^j.charCodeAt(te++))&255];return~D}function Q(j,V){for(var D=V^-1,te=j.length-15,ue=0;ue<te;)D=O[j[ue++]^D&255]^L[j[ue++]^D>>8&255]^F[j[ue++]^D>>16&255]^M[j[ue++]^D>>>24]^A[j[ue++]]^I[j[ue++]]^S[j[ue++]]^T[j[ue++]]^E[j[ue++]]^b[j[ue++]]^y[j[ue++]]^g[j[ue++]]^p[j[ue++]]^d[j[ue++]]^f[j[ue++]]^a[j[ue++]];for(te+=15;ue<te;)D=D>>>8^a[(D^j[ue++])&255];return~D}function ie(j,V){for(var D=V^-1,te=0,ue=j.length,J=0,le=0;te<ue;)J=j.charCodeAt(te++),J<128?D=D>>>8^a[(D^J)&255]:J<2048?(D=D>>>8^a[(D^(192|J>>6&31))&255],D=D>>>8^a[(D^(128|J&63))&255]):J>=55296&&J<57344?(J=(J&1023)+64,le=j.charCodeAt(te++)&1023,D=D>>>8^a[(D^(240|J>>8&7))&255],D=D>>>8^a[(D^(128|J>>2&63))&255],D=D>>>8^a[(D^(128|le>>6&15|(J&3)<<4))&255],D=D>>>8^a[(D^(128|le&63))&255]):(D=D>>>8^a[(D^(224|J>>12&15))&255],D=D>>>8^a[(D^(128|J>>6&63))&255],D=D>>>8^a[(D^(128|J&63))&255]);return~D}return t.table=a,t.bstr=N,t.buf=Q,t.str=ie,t}(),_n=function(){var n={};n.version="1.2.2";function a(_e,qe){for(var Ue=_e.split("/"),je=qe.split("/"),Ke=0,nt=0,It=Math.min(Ue.length,je.length);Ke<It;++Ke){if(nt=Ue[Ke].length-je[Ke].length)return nt;if(Ue[Ke]!=je[Ke])return Ue[Ke]<je[Ke]?-1:1}return Ue.length-je.length}function s(_e){if(_e.charAt(_e.length-1)=="/")return _e.slice(0,-1).indexOf("/")===-1?_e:s(_e.slice(0,-1));var qe=_e.lastIndexOf("/");return qe===-1?_e:_e.slice(0,qe+1)}function c(_e){if(_e.charAt(_e.length-1)=="/")return c(_e.slice(0,-1));var qe=_e.lastIndexOf("/");return qe===-1?_e:_e.slice(qe+1)}function f(_e,qe){typeof qe=="string"&&(qe=new Date(qe));var Ue=qe.getHours();Ue=Ue<<6|qe.getMinutes(),Ue=Ue<<5|qe.getSeconds()>>>1,_e.write_shift(2,Ue);var je=qe.getFullYear()-1980;je=je<<4|qe.getMonth()+1,je=je<<5|qe.getDate(),_e.write_shift(2,je)}function d(_e){var qe=_e.read_shift(2)&65535,Ue=_e.read_shift(2)&65535,je=new Date,Ke=Ue&31;Ue>>>=5;var nt=Ue&15;Ue>>>=4,je.setMilliseconds(0),je.setFullYear(Ue+1980),je.setMonth(nt-1),je.setDate(Ke);var It=qe&31;qe>>>=5;var Bt=qe&63;return qe>>>=6,je.setHours(qe),je.setMinutes(Bt),je.setSeconds(It<<1),je}function p(_e){so(_e,0);for(var qe={},Ue=0;_e.l<=_e.length-4;){var je=_e.read_shift(2),Ke=_e.read_shift(2),nt=_e.l+Ke,It={};switch(je){case 21589:Ue=_e.read_shift(1),Ue&1&&(It.mtime=_e.read_shift(4)),Ke>5&&(Ue&2&&(It.atime=_e.read_shift(4)),Ue&4&&(It.ctime=_e.read_shift(4))),It.mtime&&(It.mt=new Date(It.mtime*1e3));break;case 1:{var Bt=_e.read_shift(4),kt=_e.read_shift(4);It.usz=kt*Math.pow(2,32)+Bt,Bt=_e.read_shift(4),kt=_e.read_shift(4),It.csz=kt*Math.pow(2,32)+Bt}break}_e.l=nt,qe[je]=It}return qe}var g;function y(){return g||(g=Wu)}function b(_e,qe){if(_e[0]==80&&_e[1]==75)return Ta(_e,qe);if((_e[0]|32)==109&&(_e[1]|32)==105)return Jt(_e,qe);if(_e.length<512)throw new Error("CFB file size "+_e.length+" < 512");var Ue=3,je=512,Ke=0,nt=0,It=0,Bt=0,kt=0,Dt=[],Rt=_e.slice(0,512);so(Rt,0);var fr=E(Rt);switch(Ue=fr[0],Ue){case 3:je=512;break;case 4:je=4096;break;case 0:if(fr[1]==0)return Ta(_e,qe);default:throw new Error("Major Version: Expected 3 or 4 saw "+Ue)}je!==512&&(Rt=_e.slice(0,je),so(Rt,28));var Tr=_e.slice(0,je);T(Rt,Ue);var zr=Rt.read_shift(4,"i");if(Ue===3&&zr!==0)throw new Error("# Directory Sectors: Expected 0 saw "+zr);Rt.l+=4,It=Rt.read_shift(4,"i"),Rt.l+=4,Rt.chk("00100000","Mini Stream Cutoff Size: "),Bt=Rt.read_shift(4,"i"),Ke=Rt.read_shift(4,"i"),kt=Rt.read_shift(4,"i"),nt=Rt.read_shift(4,"i");for(var yr=-1,wr=0;wr<109&&(yr=Rt.read_shift(4,"i"),!(yr<0));++wr)Dt[wr]=yr;var On=S(_e,je);M(kt,nt,On,je,Dt);var Di=L(On,It,Dt,je);It<Di.length&&(Di[It].name="!Directory"),Ke>0&&Bt!==le&&(Di[Bt].name="!MiniFAT"),Di[Dt[0]].name="!FAT",Di.fat_addrs=Dt,Di.ssz=je;var Vn={},Ca=[],zl=[],ro=[];O(It,Di,On,Ca,Ke,Vn,zl,Bt),I(zl,ro,Ca),Ca.shift();var no={FileIndex:zl,FullPaths:ro};return qe&&qe.raw&&(no.raw={header:Tr,sectors:On}),no}function E(_e){if(_e[_e.l]==80&&_e[_e.l+1]==75)return[0,0];_e.chk(re,"Header Signature: "),_e.l+=16;var qe=_e.read_shift(2,"u");return[_e.read_shift(2,"u"),qe]}function T(_e,qe){var Ue=9;switch(_e.l+=2,Ue=_e.read_shift(2)){case 9:if(qe!=3)throw new Error("Sector Shift: Expected 9 saw "+Ue);break;case 12:if(qe!=4)throw new Error("Sector Shift: Expected 12 saw "+Ue);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+Ue)}_e.chk("0600","Mini Sector Shift: "),_e.chk("000000000000","Reserved: ")}function S(_e,qe){for(var Ue=Math.ceil(_e.length/qe)-1,je=[],Ke=1;Ke<Ue;++Ke)je[Ke-1]=_e.slice(Ke*qe,(Ke+1)*qe);return je[Ue-1]=_e.slice(Ue*qe),je}function I(_e,qe,Ue){for(var je=0,Ke=0,nt=0,It=0,Bt=0,kt=Ue.length,Dt=[],Rt=[];je<kt;++je)Dt[je]=Rt[je]=je,qe[je]=Ue[je];for(;Bt<Rt.length;++Bt)je=Rt[Bt],Ke=_e[je].L,nt=_e[je].R,It=_e[je].C,Dt[je]===je&&(Ke!==-1&&Dt[Ke]!==Ke&&(Dt[je]=Dt[Ke]),nt!==-1&&Dt[nt]!==nt&&(Dt[je]=Dt[nt])),It!==-1&&(Dt[It]=je),Ke!==-1&&je!=Dt[je]&&(Dt[Ke]=Dt[je],Rt.lastIndexOf(Ke)<Bt&&Rt.push(Ke)),nt!==-1&&je!=Dt[je]&&(Dt[nt]=Dt[je],Rt.lastIndexOf(nt)<Bt&&Rt.push(nt));for(je=1;je<kt;++je)Dt[je]===je&&(nt!==-1&&Dt[nt]!==nt?Dt[je]=Dt[nt]:Ke!==-1&&Dt[Ke]!==Ke&&(Dt[je]=Dt[Ke]));for(je=1;je<kt;++je)if(_e[je].type!==0){if(Bt=je,Bt!=Dt[Bt])do Bt=Dt[Bt],qe[je]=qe[Bt]+"/"+qe[je];while(Bt!==0&&Dt[Bt]!==-1&&Bt!=Dt[Bt]);Dt[je]=-1}for(qe[0]+="/",je=1;je<kt;++je)_e[je].type!==2&&(qe[je]+="/")}function A(_e,qe,Ue){for(var je=_e.start,Ke=_e.size,nt=[],It=je;Ue&&Ke>0&&It>=0;)nt.push(qe.slice(It*J,It*J+J)),Ke-=J,It=Md(Ue,It*4);return nt.length===0?zt(0):Va(nt).slice(0,_e.size)}function M(_e,qe,Ue,je,Ke){var nt=le;if(_e===le){if(qe!==0)throw new Error("DIFAT chain shorter than expected")}else if(_e!==-1){var It=Ue[_e],Bt=(je>>>2)-1;if(!It)return;for(var kt=0;kt<Bt&&(nt=Md(It,kt*4))!==le;++kt)Ke.push(nt);qe>=1&&M(Md(It,je-4),qe-1,Ue,je,Ke)}}function F(_e,qe,Ue,je,Ke){var nt=[],It=[];Ke||(Ke=[]);var Bt=je-1,kt=0,Dt=0;for(kt=qe;kt>=0;){Ke[kt]=!0,nt[nt.length]=kt,It.push(_e[kt]);var Rt=Ue[Math.floor(kt*4/je)];if(Dt=kt*4&Bt,je<4+Dt)throw new Error("FAT boundary crossed: "+kt+" 4 "+je);if(!_e[Rt])break;kt=Md(_e[Rt],Dt)}return{nodes:nt,data:Y5([It])}}function L(_e,qe,Ue,je){var Ke=_e.length,nt=[],It=[],Bt=[],kt=[],Dt=je-1,Rt=0,fr=0,Tr=0,zr=0;for(Rt=0;Rt<Ke;++Rt)if(Bt=[],Tr=Rt+qe,Tr>=Ke&&(Tr-=Ke),!It[Tr]){kt=[];var yr=[];for(fr=Tr;fr>=0;){yr[fr]=!0,It[fr]=!0,Bt[Bt.length]=fr,kt.push(_e[fr]);var wr=Ue[Math.floor(fr*4/je)];if(zr=fr*4&Dt,je<4+zr)throw new Error("FAT boundary crossed: "+fr+" 4 "+je);if(!_e[wr]||(fr=Md(_e[wr],zr),yr[fr]))break}nt[Tr]={nodes:Bt,data:Y5([kt])}}return nt}function O(_e,qe,Ue,je,Ke,nt,It,Bt){for(var kt=0,Dt=je.length?2:0,Rt=qe[_e].data,fr=0,Tr=0,zr;fr<Rt.length;fr+=128){var yr=Rt.slice(fr,fr+128);so(yr,64),Tr=yr.read_shift(2),zr=lw(yr,0,Tr-Dt),je.push(zr);var wr={name:zr,type:yr.read_shift(1),color:yr.read_shift(1),L:yr.read_shift(4,"i"),R:yr.read_shift(4,"i"),C:yr.read_shift(4,"i"),clsid:yr.read_shift(16),state:yr.read_shift(4,"i"),start:0,size:0},On=yr.read_shift(2)+yr.read_shift(2)+yr.read_shift(2)+yr.read_shift(2);On!==0&&(wr.ct=N(yr,yr.l-8));var Di=yr.read_shift(2)+yr.read_shift(2)+yr.read_shift(2)+yr.read_shift(2);Di!==0&&(wr.mt=N(yr,yr.l-8)),wr.start=yr.read_shift(4,"i"),wr.size=yr.read_shift(4,"i"),wr.size<0&&wr.start<0&&(wr.size=wr.type=0,wr.start=le,wr.name=""),wr.type===5?(kt=wr.start,Ke>0&&kt!==le&&(qe[kt].name="!StreamData")):wr.size>=4096?(wr.storage="fat",qe[wr.start]===void 0&&(qe[wr.start]=F(Ue,wr.start,qe.fat_addrs,qe.ssz)),qe[wr.start].name=wr.name,wr.content=qe[wr.start].data.slice(0,wr.size)):(wr.storage="minifat",wr.size<0?wr.size=0:kt!==le&&wr.start!==le&&qe[kt]&&(wr.content=A(wr,qe[kt].data,(qe[Bt]||{}).data))),wr.content&&so(wr.content,0),nt[zr]=wr,It.push(wr)}}function N(_e,qe){return new Date((vo(_e,qe+4)/1e7*Math.pow(2,32)+vo(_e,qe)/1e7-11644473600)*1e3)}function Q(_e,qe){return y(),b(g.readFileSync(_e),qe)}function ie(_e,qe){var Ue=qe&&qe.type;switch(Ue||oi&&Buffer.isBuffer(_e)&&(Ue="buffer"),Ue||"base64"){case"file":return Q(_e,qe);case"base64":return b(us(ll(_e)),qe);case"binary":return b(us(_e),qe)}return b(_e,qe)}function j(_e,qe){var Ue=qe||{},je=Ue.root||"Root Entry";if(_e.FullPaths||(_e.FullPaths=[]),_e.FileIndex||(_e.FileIndex=[]),_e.FullPaths.length!==_e.FileIndex.length)throw new Error("inconsistent CFB structure");_e.FullPaths.length===0&&(_e.FullPaths[0]=je+"/",_e.FileIndex[0]={name:je,type:5}),Ue.CLSID&&(_e.FileIndex[0].clsid=Ue.CLSID),V(_e)}function V(_e){var qe="Sh33tJ5";if(!_n.find(_e,"/"+qe)){var Ue=zt(4);Ue[0]=55,Ue[1]=Ue[3]=50,Ue[2]=54,_e.FileIndex.push({name:qe,type:2,content:Ue,size:4,L:69,R:69,C:69}),_e.FullPaths.push(_e.FullPaths[0]+qe),D(_e)}}function D(_e,qe){j(_e);for(var Ue=!1,je=!1,Ke=_e.FullPaths.length-1;Ke>=0;--Ke){var nt=_e.FileIndex[Ke];switch(nt.type){case 0:je?Ue=!0:(_e.FileIndex.pop(),_e.FullPaths.pop());break;case 1:case 2:case 5:je=!0,isNaN(nt.R*nt.L*nt.C)&&(Ue=!0),nt.R>-1&&nt.L>-1&&nt.R==nt.L&&(Ue=!0);break;default:Ue=!0;break}}if(!(!Ue&&!qe)){var It=new Date(1987,1,19),Bt=0,kt=Object.create?Object.create(null):{},Dt=[];for(Ke=0;Ke<_e.FullPaths.length;++Ke)kt[_e.FullPaths[Ke]]=!0,_e.FileIndex[Ke].type!==0&&Dt.push([_e.FullPaths[Ke],_e.FileIndex[Ke]]);for(Ke=0;Ke<Dt.length;++Ke){var Rt=s(Dt[Ke][0]);for(je=kt[Rt];!je;){for(;s(Rt)&&!kt[s(Rt)];)Rt=s(Rt);Dt.push([Rt,{name:c(Rt).replace("/",""),type:1,clsid:Ye,ct:It,mt:It,content:null}]),kt[Rt]=!0,Rt=s(Dt[Ke][0]),je=kt[Rt]}}for(Dt.sort(function(zr,yr){return a(zr[0],yr[0])}),_e.FullPaths=[],_e.FileIndex=[],Ke=0;Ke<Dt.length;++Ke)_e.FullPaths[Ke]=Dt[Ke][0],_e.FileIndex[Ke]=Dt[Ke][1];for(Ke=0;Ke<Dt.length;++Ke){var fr=_e.FileIndex[Ke],Tr=_e.FullPaths[Ke];if(fr.name=c(Tr).replace("/",""),fr.L=fr.R=fr.C=-(fr.color=1),fr.size=fr.content?fr.content.length:0,fr.start=0,fr.clsid=fr.clsid||Ye,Ke===0)fr.C=Dt.length>1?1:-1,fr.size=0,fr.type=5;else if(Tr.slice(-1)=="/"){for(Bt=Ke+1;Bt<Dt.length&&s(_e.FullPaths[Bt])!=Tr;++Bt);for(fr.C=Bt>=Dt.length?-1:Bt,Bt=Ke+1;Bt<Dt.length&&s(_e.FullPaths[Bt])!=s(Tr);++Bt);fr.R=Bt>=Dt.length?-1:Bt,fr.type=1}else s(_e.FullPaths[Ke+1]||"")==s(Tr)&&(fr.R=Ke+1),fr.type=2}}}function te(_e,qe){var Ue=qe||{};if(Ue.fileType=="mad")return Xt(_e,Ue);switch(D(_e),Ue.fileType){case"zip":return Ai(_e,Ue)}var je=function(zr){for(var yr=0,wr=0,On=0;On<zr.FileIndex.length;++On){var Di=zr.FileIndex[On];if(Di.content){var Vn=Di.content.length;Vn>0&&(Vn<4096?yr+=Vn+63>>6:wr+=Vn+511>>9)}}for(var Ca=zr.FullPaths.length+3>>2,zl=yr+7>>3,ro=yr+127>>7,no=zl+wr+Ca+ro,_s=no+127>>7,js=_s<=109?0:Math.ceil((_s-109)/127);no+_s+js+127>>7>_s;)js=++_s<=109?0:Math.ceil((_s-109)/127);var Ha=[1,js,_s,ro,Ca,wr,yr,0];return zr.FileIndex[0].size=yr<<6,Ha[7]=(zr.FileIndex[0].start=Ha[0]+Ha[1]+Ha[2]+Ha[3]+Ha[4]+Ha[5])+(Ha[6]+7>>3),Ha}(_e),Ke=zt(je[7]<<9),nt=0,It=0;{for(nt=0;nt<8;++nt)Ke.write_shift(1,Fe[nt]);for(nt=0;nt<8;++nt)Ke.write_shift(2,0);for(Ke.write_shift(2,62),Ke.write_shift(2,3),Ke.write_shift(2,65534),Ke.write_shift(2,9),Ke.write_shift(2,6),nt=0;nt<3;++nt)Ke.write_shift(2,0);for(Ke.write_shift(4,0),Ke.write_shift(4,je[2]),Ke.write_shift(4,je[0]+je[1]+je[2]+je[3]-1),Ke.write_shift(4,0),Ke.write_shift(4,4096),Ke.write_shift(4,je[3]?je[0]+je[1]+je[2]-1:le),Ke.write_shift(4,je[3]),Ke.write_shift(-4,je[1]?je[0]-1:le),Ke.write_shift(4,je[1]),nt=0;nt<109;++nt)Ke.write_shift(-4,nt<je[2]?je[1]+nt:-1)}if(je[1])for(It=0;It<je[1];++It){for(;nt<236+It*127;++nt)Ke.write_shift(-4,nt<je[2]?je[1]+nt:-1);Ke.write_shift(-4,It===je[1]-1?le:It+1)}var Bt=function(zr){for(It+=zr;nt<It-1;++nt)Ke.write_shift(-4,nt+1);zr&&(++nt,Ke.write_shift(-4,le))};for(It=nt=0,It+=je[1];nt<It;++nt)Ke.write_shift(-4,Ee.DIFSECT);for(It+=je[2];nt<It;++nt)Ke.write_shift(-4,Ee.FATSECT);Bt(je[3]),Bt(je[4]);for(var kt=0,Dt=0,Rt=_e.FileIndex[0];kt<_e.FileIndex.length;++kt)Rt=_e.FileIndex[kt],Rt.content&&(Dt=Rt.content.length,!(Dt<4096)&&(Rt.start=It,Bt(Dt+511>>9)));for(Bt(je[6]+7>>3);Ke.l&511;)Ke.write_shift(-4,Ee.ENDOFCHAIN);for(It=nt=0,kt=0;kt<_e.FileIndex.length;++kt)Rt=_e.FileIndex[kt],Rt.content&&(Dt=Rt.content.length,!(!Dt||Dt>=4096)&&(Rt.start=It,Bt(Dt+63>>6)));for(;Ke.l&511;)Ke.write_shift(-4,Ee.ENDOFCHAIN);for(nt=0;nt<je[4]<<2;++nt){var fr=_e.FullPaths[nt];if(!fr||fr.length===0){for(kt=0;kt<17;++kt)Ke.write_shift(4,0);for(kt=0;kt<3;++kt)Ke.write_shift(4,-1);for(kt=0;kt<12;++kt)Ke.write_shift(4,0);continue}Rt=_e.FileIndex[nt],nt===0&&(Rt.start=Rt.size?Rt.start-1:le);var Tr=nt===0&&Ue.root||Rt.name;if(Tr.length>32&&(console.error("Name "+Tr+" will be truncated to "+Tr.slice(0,32)),Tr=Tr.slice(0,32)),Dt=2*(Tr.length+1),Ke.write_shift(64,Tr,"utf16le"),Ke.write_shift(2,Dt),Ke.write_shift(1,Rt.type),Ke.write_shift(1,Rt.color),Ke.write_shift(-4,Rt.L),Ke.write_shift(-4,Rt.R),Ke.write_shift(-4,Rt.C),Rt.clsid)Ke.write_shift(16,Rt.clsid,"hex");else for(kt=0;kt<4;++kt)Ke.write_shift(4,0);Ke.write_shift(4,Rt.state||0),Ke.write_shift(4,0),Ke.write_shift(4,0),Ke.write_shift(4,0),Ke.write_shift(4,0),Ke.write_shift(4,Rt.start),Ke.write_shift(4,Rt.size),Ke.write_shift(4,0)}for(nt=1;nt<_e.FileIndex.length;++nt)if(Rt=_e.FileIndex[nt],Rt.size>=4096)if(Ke.l=Rt.start+1<<9,oi&&Buffer.isBuffer(Rt.content))Rt.content.copy(Ke,Ke.l,0,Rt.size),Ke.l+=Rt.size+511&-512;else{for(kt=0;kt<Rt.size;++kt)Ke.write_shift(1,Rt.content[kt]);for(;kt&511;++kt)Ke.write_shift(1,0)}for(nt=1;nt<_e.FileIndex.length;++nt)if(Rt=_e.FileIndex[nt],Rt.size>0&&Rt.size<4096)if(oi&&Buffer.isBuffer(Rt.content))Rt.content.copy(Ke,Ke.l,0,Rt.size),Ke.l+=Rt.size+63&-64;else{for(kt=0;kt<Rt.size;++kt)Ke.write_shift(1,Rt.content[kt]);for(;kt&63;++kt)Ke.write_shift(1,0)}if(oi)Ke.l=Ke.length;else for(;Ke.l<Ke.length;)Ke.write_shift(1,0);return Ke}function ue(_e,qe){var Ue=_e.FullPaths.map(function(kt){return kt.toUpperCase()}),je=Ue.map(function(kt){var Dt=kt.split("/");return Dt[Dt.length-(kt.slice(-1)=="/"?2:1)]}),Ke=!1;qe.charCodeAt(0)===47?(Ke=!0,qe=Ue[0].slice(0,-1)+qe):Ke=qe.indexOf("/")!==-1;var nt=qe.toUpperCase(),It=Ke===!0?Ue.indexOf(nt):je.indexOf(nt);if(It!==-1)return _e.FileIndex[It];var Bt=!nt.match(qg);for(nt=nt.replace(Ho,""),Bt&&(nt=nt.replace(qg,"!")),It=0;It<Ue.length;++It)if((Bt?Ue[It].replace(qg,"!"):Ue[It]).replace(Ho,"")==nt||(Bt?je[It].replace(qg,"!"):je[It]).replace(Ho,"")==nt)return _e.FileIndex[It];return null}var J=64,le=-2,re="d0cf11e0a1b11ae1",Fe=[208,207,17,224,161,177,26,225],Ye="00000000000000000000000000000000",Ee={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:le,FREESECT:-1,HEADER_SIGNATURE:re,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Ye,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function ut(_e,qe,Ue){y();var je=te(_e,Ue);g.writeFileSync(qe,je)}function Ne(_e){for(var qe=new Array(_e.length),Ue=0;Ue<_e.length;++Ue)qe[Ue]=String.fromCharCode(_e[Ue]);return qe.join("")}function He(_e,qe){var Ue=te(_e,qe);switch(qe&&qe.type||"buffer"){case"file":return y(),g.writeFileSync(qe.filename,Ue),Ue;case"binary":return typeof Ue=="string"?Ue:Ne(Ue);case"base64":return rb(typeof Ue=="string"?Ue:Ne(Ue));case"buffer":if(oi)return Buffer.isBuffer(Ue)?Ue:hu(Ue);case"array":return typeof Ue=="string"?us(Ue):Ue}return Ue}var Oe;function Pe(_e){try{var qe=_e.InflateRaw,Ue=new qe;if(Ue._processChunk(new Uint8Array([3,0]),Ue._finishFlushFlag),Ue.bytesRead)Oe=_e;else throw new Error("zlib does not expose bytesRead")}catch(je){console.error("cannot use native zlib: "+(je.message||je))}}function rt(_e,qe){if(!Oe)return Wi(_e,qe);var Ue=Oe.InflateRaw,je=new Ue,Ke=je._processChunk(_e.slice(_e.l),je._finishFlushFlag);return _e.l+=je.bytesRead,Ke}function et(_e){return Oe?Oe.deflateRawSync(_e):Nt(_e)}var Ge=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ze=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],oe=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Me(_e){var qe=(_e<<1|_e<<11)&139536|(_e<<5|_e<<15)&558144;return(qe>>16|qe>>8|qe)&255}for(var fe=typeof Uint8Array<"u",pe=fe?new Uint8Array(256):[],ot=0;ot<256;++ot)pe[ot]=Me(ot);function xe(_e,qe){var Ue=pe[_e&255];return qe<=8?Ue>>>8-qe:(Ue=Ue<<8|pe[_e>>8&255],qe<=16?Ue>>>16-qe:(Ue=Ue<<8|pe[_e>>16&255],Ue>>>24-qe))}function ae(_e,qe){var Ue=qe&7,je=qe>>>3;return(_e[je]|(Ue<=6?0:_e[je+1]<<8))>>>Ue&3}function X(_e,qe){var Ue=qe&7,je=qe>>>3;return(_e[je]|(Ue<=5?0:_e[je+1]<<8))>>>Ue&7}function Ce(_e,qe){var Ue=qe&7,je=qe>>>3;return(_e[je]|(Ue<=4?0:_e[je+1]<<8))>>>Ue&15}function he(_e,qe){var Ue=qe&7,je=qe>>>3;return(_e[je]|(Ue<=3?0:_e[je+1]<<8))>>>Ue&31}function G(_e,qe){var Ue=qe&7,je=qe>>>3;return(_e[je]|(Ue<=1?0:_e[je+1]<<8))>>>Ue&127}function K(_e,qe,Ue){var je=qe&7,Ke=qe>>>3,nt=(1<<Ue)-1,It=_e[Ke]>>>je;return Ue<8-je||(It|=_e[Ke+1]<<8-je,Ue<16-je)||(It|=_e[Ke+2]<<16-je,Ue<24-je)||(It|=_e[Ke+3]<<24-je),It&nt}function se(_e,qe,Ue){var je=qe&7,Ke=qe>>>3;return je<=5?_e[Ke]|=(Ue&7)<<je:(_e[Ke]|=Ue<<je&255,_e[Ke+1]=(Ue&7)>>8-je),qe+3}function Ae(_e,qe,Ue){var je=qe&7,Ke=qe>>>3;return Ue=(Ue&1)<<je,_e[Ke]|=Ue,qe+1}function Se(_e,qe,Ue){var je=qe&7,Ke=qe>>>3;return Ue<<=je,_e[Ke]|=Ue&255,Ue>>>=8,_e[Ke+1]=Ue,qe+8}function ye(_e,qe,Ue){var je=qe&7,Ke=qe>>>3;return Ue<<=je,_e[Ke]|=Ue&255,Ue>>>=8,_e[Ke+1]=Ue&255,_e[Ke+2]=Ue>>>8,qe+16}function Xe(_e,qe){var Ue=_e.length,je=2*Ue>qe?2*Ue:qe+5,Ke=0;if(Ue>=qe)return _e;if(oi){var nt=P5(je);if(_e.copy)_e.copy(nt);else for(;Ke<_e.length;++Ke)nt[Ke]=_e[Ke];return nt}else if(fe){var It=new Uint8Array(je);if(It.set)It.set(_e);else for(;Ke<Ue;++Ke)It[Ke]=_e[Ke];return It}return _e.length=je,_e}function be(_e){for(var qe=new Array(_e),Ue=0;Ue<_e;++Ue)qe[Ue]=0;return qe}function Be(_e,qe,Ue){var je=1,Ke=0,nt=0,It=0,Bt=0,kt=_e.length,Dt=fe?new Uint16Array(32):be(32);for(nt=0;nt<32;++nt)Dt[nt]=0;for(nt=kt;nt<Ue;++nt)_e[nt]=0;kt=_e.length;var Rt=fe?new Uint16Array(kt):be(kt);for(nt=0;nt<kt;++nt)Dt[Ke=_e[nt]]++,je<Ke&&(je=Ke),Rt[nt]=0;for(Dt[0]=0,nt=1;nt<=je;++nt)Dt[nt+16]=Bt=Bt+Dt[nt-1]<<1;for(nt=0;nt<kt;++nt)Bt=_e[nt],Bt!=0&&(Rt[nt]=Dt[Bt+16]++);var fr=0;for(nt=0;nt<kt;++nt)if(fr=_e[nt],fr!=0)for(Bt=xe(Rt[nt],je)>>je-fr,It=(1<<je+4-fr)-1;It>=0;--It)qe[Bt|It<<fr]=fr&15|nt<<4;return je}var ct=fe?new Uint16Array(512):be(512),At=fe?new Uint16Array(32):be(32);if(!fe){for(var $t=0;$t<512;++$t)ct[$t]=0;for($t=0;$t<32;++$t)At[$t]=0}(function(){for(var _e=[],qe=0;qe<32;qe++)_e.push(5);Be(_e,At,32);var Ue=[];for(qe=0;qe<=143;qe++)Ue.push(8);for(;qe<=255;qe++)Ue.push(9);for(;qe<=279;qe++)Ue.push(7);for(;qe<=287;qe++)Ue.push(8);Be(Ue,ct,288)})();var mr=function(){for(var qe=fe?new Uint8Array(32768):[],Ue=0,je=0;Ue<oe.length-1;++Ue)for(;je<oe[Ue+1];++je)qe[je]=Ue;for(;je<32768;++je)qe[je]=29;var Ke=fe?new Uint8Array(259):[];for(Ue=0,je=0;Ue<ze.length-1;++Ue)for(;je<ze[Ue+1];++je)Ke[je]=Ue;function nt(Bt,kt){for(var Dt=0;Dt<Bt.length;){var Rt=Math.min(65535,Bt.length-Dt),fr=Dt+Rt==Bt.length;for(kt.write_shift(1,+fr),kt.write_shift(2,Rt),kt.write_shift(2,~Rt&65535);Rt-- >0;)kt[kt.l++]=Bt[Dt++]}return kt.l}function It(Bt,kt){for(var Dt=0,Rt=0,fr=fe?new Uint16Array(32768):[];Rt<Bt.length;){var Tr=Math.min(65535,Bt.length-Rt);if(Tr<10){for(Dt=se(kt,Dt,+(Rt+Tr==Bt.length)),Dt&7&&(Dt+=8-(Dt&7)),kt.l=Dt/8|0,kt.write_shift(2,Tr),kt.write_shift(2,~Tr&65535);Tr-- >0;)kt[kt.l++]=Bt[Rt++];Dt=kt.l*8;continue}Dt=se(kt,Dt,+(Rt+Tr==Bt.length)+2);for(var zr=0;Tr-- >0;){var yr=Bt[Rt];zr=(zr<<5^yr)&32767;var wr=-1,On=0;if((wr=fr[zr])&&(wr|=Rt&-32768,wr>Rt&&(wr-=32768),wr<Rt))for(;Bt[wr+On]==Bt[Rt+On]&&On<250;)++On;if(On>2){yr=Ke[On],yr<=22?Dt=Se(kt,Dt,pe[yr+1]>>1)-1:(Se(kt,Dt,3),Dt+=5,Se(kt,Dt,pe[yr-23]>>5),Dt+=3);var Di=yr<8?0:yr-4>>2;Di>0&&(ye(kt,Dt,On-ze[yr]),Dt+=Di),yr=qe[Rt-wr],Dt=Se(kt,Dt,pe[yr]>>3),Dt-=3;var Vn=yr<4?0:yr-2>>1;Vn>0&&(ye(kt,Dt,Rt-wr-oe[yr]),Dt+=Vn);for(var Ca=0;Ca<On;++Ca)fr[zr]=Rt&32767,zr=(zr<<5^Bt[Rt])&32767,++Rt;Tr-=On-1}else yr<=143?yr=yr+48:Dt=Ae(kt,Dt,1),Dt=Se(kt,Dt,pe[yr]),fr[zr]=Rt&32767,++Rt}Dt=Se(kt,Dt,0)-1}return kt.l=(Dt+7)/8|0,kt.l}return function(kt,Dt){return kt.length<8?nt(kt,Dt):It(kt,Dt)}}();function Nt(_e){var qe=zt(50+Math.floor(_e.length*1.1)),Ue=mr(_e,qe);return qe.slice(0,Ue)}var Lt=fe?new Uint16Array(32768):be(32768),Qt=fe?new Uint16Array(32768):be(32768),Gt=fe?new Uint16Array(128):be(128),dr=1,Br=1;function qr(_e,qe){var Ue=he(_e,qe)+257;qe+=5;var je=he(_e,qe)+1;qe+=5;var Ke=Ce(_e,qe)+4;qe+=4;for(var nt=0,It=fe?new Uint8Array(19):be(19),Bt=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],kt=1,Dt=fe?new Uint8Array(8):be(8),Rt=fe?new Uint8Array(8):be(8),fr=It.length,Tr=0;Tr<Ke;++Tr)It[Ge[Tr]]=nt=X(_e,qe),kt<nt&&(kt=nt),Dt[nt]++,qe+=3;var zr=0;for(Dt[0]=0,Tr=1;Tr<=kt;++Tr)Rt[Tr]=zr=zr+Dt[Tr-1]<<1;for(Tr=0;Tr<fr;++Tr)(zr=It[Tr])!=0&&(Bt[Tr]=Rt[zr]++);var yr=0;for(Tr=0;Tr<fr;++Tr)if(yr=It[Tr],yr!=0){zr=pe[Bt[Tr]]>>8-yr;for(var wr=(1<<7-yr)-1;wr>=0;--wr)Gt[zr|wr<<yr]=yr&7|Tr<<3}var On=[];for(kt=1;On.length<Ue+je;)switch(zr=Gt[G(_e,qe)],qe+=zr&7,zr>>>=3){case 16:for(nt=3+ae(_e,qe),qe+=2,zr=On[On.length-1];nt-- >0;)On.push(zr);break;case 17:for(nt=3+X(_e,qe),qe+=3;nt-- >0;)On.push(0);break;case 18:for(nt=11+G(_e,qe),qe+=7;nt-- >0;)On.push(0);break;default:On.push(zr),kt<zr&&(kt=zr);break}var Di=On.slice(0,Ue),Vn=On.slice(Ue);for(Tr=Ue;Tr<286;++Tr)Di[Tr]=0;for(Tr=je;Tr<30;++Tr)Vn[Tr]=0;return dr=Be(Di,Lt,286),Br=Be(Vn,Qt,30),qe}function Ci(_e,qe){if(_e[0]==3&&!(_e[1]&3))return[Ah(qe),2];for(var Ue=0,je=0,Ke=P5(qe||1<<18),nt=0,It=Ke.length>>>0,Bt=0,kt=0;!(je&1);){if(je=X(_e,Ue),Ue+=3,je>>>1)je>>1==1?(Bt=9,kt=5):(Ue=qr(_e,Ue),Bt=dr,kt=Br);else{Ue&7&&(Ue+=8-(Ue&7));var Dt=_e[Ue>>>3]|_e[(Ue>>>3)+1]<<8;if(Ue+=32,Dt>0)for(!qe&&It<nt+Dt&&(Ke=Xe(Ke,nt+Dt),It=Ke.length);Dt-- >0;)Ke[nt++]=_e[Ue>>>3],Ue+=8;continue}for(;;){!qe&&It<nt+32767&&(Ke=Xe(Ke,nt+32767),It=Ke.length);var Rt=K(_e,Ue,Bt),fr=je>>>1==1?ct[Rt]:Lt[Rt];if(Ue+=fr&15,fr>>>=4,!(fr>>>8&255))Ke[nt++]=fr;else{if(fr==256)break;fr-=257;var Tr=fr<8?0:fr-4>>2;Tr>5&&(Tr=0);var zr=nt+ze[fr];Tr>0&&(zr+=K(_e,Ue,Tr),Ue+=Tr),Rt=K(_e,Ue,kt),fr=je>>>1==1?At[Rt]:Qt[Rt],Ue+=fr&15,fr>>>=4;var yr=fr<4?0:fr-2>>1,wr=oe[fr];for(yr>0&&(wr+=K(_e,Ue,yr),Ue+=yr),!qe&&It<zr&&(Ke=Xe(Ke,zr+100),It=Ke.length);nt<zr;)Ke[nt]=Ke[nt-wr],++nt}}}return qe?[Ke,Ue+7>>>3]:[Ke.slice(0,nt),Ue+7>>>3]}function Wi(_e,qe){var Ue=_e.slice(_e.l||0),je=Ci(Ue,qe);return _e.l+=je[1],je[0]}function Fi(_e,qe){if(_e)typeof console<"u"&&console.error(qe);else throw new Error(qe)}function Ta(_e,qe){var Ue=_e;so(Ue,0);var je=[],Ke=[],nt={FileIndex:je,FullPaths:Ke};j(nt,{root:qe.root});for(var It=Ue.length-4;(Ue[It]!=80||Ue[It+1]!=75||Ue[It+2]!=5||Ue[It+3]!=6)&&It>=0;)--It;Ue.l=It+4,Ue.l+=4;var Bt=Ue.read_shift(2);Ue.l+=6;var kt=Ue.read_shift(4);for(Ue.l=kt,It=0;It<Bt;++It){Ue.l+=20;var Dt=Ue.read_shift(4),Rt=Ue.read_shift(4),fr=Ue.read_shift(2),Tr=Ue.read_shift(2),zr=Ue.read_shift(2);Ue.l+=8;var yr=Ue.read_shift(4),wr=p(Ue.slice(Ue.l+fr,Ue.l+fr+Tr));Ue.l+=fr+Tr+zr;var On=Ue.l;Ue.l=yr+4,wr&&wr[1]&&((wr[1]||{}).usz&&(Rt=wr[1].usz),(wr[1]||{}).csz&&(Dt=wr[1].csz)),Sa(Ue,Dt,Rt,nt,wr),Ue.l=On}return nt}function Sa(_e,qe,Ue,je,Ke){_e.l+=2;var nt=_e.read_shift(2),It=_e.read_shift(2),Bt=d(_e);if(nt&8257)throw new Error("Unsupported ZIP encryption");for(var kt=_e.read_shift(4),Dt=_e.read_shift(4),Rt=_e.read_shift(4),fr=_e.read_shift(2),Tr=_e.read_shift(2),zr="",yr=0;yr<fr;++yr)zr+=String.fromCharCode(_e[_e.l++]);if(Tr){var wr=p(_e.slice(_e.l,_e.l+Tr));(wr[21589]||{}).mt&&(Bt=wr[21589].mt),(wr[1]||{}).usz&&(Rt=wr[1].usz),(wr[1]||{}).csz&&(Dt=wr[1].csz),Ke&&((Ke[21589]||{}).mt&&(Bt=Ke[21589].mt),(Ke[1]||{}).usz&&(Rt=wr[1].usz),(Ke[1]||{}).csz&&(Dt=wr[1].csz))}_e.l+=Tr;var On=_e.slice(_e.l,_e.l+Dt);switch(It){case 8:On=rt(_e,Rt);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+It)}var Di=!1;nt&8&&(kt=_e.read_shift(4),kt==134695760&&(kt=_e.read_shift(4),Di=!0),Dt=_e.read_shift(4),Rt=_e.read_shift(4)),Dt!=qe&&Fi(Di,"Bad compressed size: "+qe+" != "+Dt),Rt!=Ue&&Fi(Di,"Bad uncompressed size: "+Ue+" != "+Rt),er(je,zr,On,{unsafe:!0,mt:Bt})}function Ai(_e,qe){var Ue=qe||{},je=[],Ke=[],nt=zt(1),It=Ue.compression?8:0,Bt=0,kt=0,Dt=0,Rt=0,fr=0,Tr=_e.FullPaths[0],zr=Tr,yr=_e.FileIndex[0],wr=[],On=0;for(kt=1;kt<_e.FullPaths.length;++kt)if(zr=_e.FullPaths[kt].slice(Tr.length),yr=_e.FileIndex[kt],!(!yr.size||!yr.content||zr=="Sh33tJ5")){var Di=Rt,Vn=zt(zr.length);for(Dt=0;Dt<zr.length;++Dt)Vn.write_shift(1,zr.charCodeAt(Dt)&127);Vn=Vn.slice(0,Vn.l),wr[fr]=typeof yr.content=="string"?U5.bstr(yr.content,0):U5.buf(yr.content,0);var Ca=typeof yr.content=="string"?us(yr.content):yr.content;It==8&&(Ca=et(Ca)),nt=zt(30),nt.write_shift(4,67324752),nt.write_shift(2,20),nt.write_shift(2,Bt),nt.write_shift(2,It),yr.mt?f(nt,yr.mt):nt.write_shift(4,0),nt.write_shift(-4,wr[fr]),nt.write_shift(4,Ca.length),nt.write_shift(4,yr.content.length),nt.write_shift(2,Vn.length),nt.write_shift(2,0),Rt+=nt.length,je.push(nt),Rt+=Vn.length,je.push(Vn),Rt+=Ca.length,je.push(Ca),nt=zt(46),nt.write_shift(4,33639248),nt.write_shift(2,0),nt.write_shift(2,20),nt.write_shift(2,Bt),nt.write_shift(2,It),nt.write_shift(4,0),nt.write_shift(-4,wr[fr]),nt.write_shift(4,Ca.length),nt.write_shift(4,yr.content.length),nt.write_shift(2,Vn.length),nt.write_shift(2,0),nt.write_shift(2,0),nt.write_shift(2,0),nt.write_shift(2,0),nt.write_shift(4,0),nt.write_shift(4,Di),On+=nt.l,Ke.push(nt),On+=Vn.length,Ke.push(Vn),++fr}return nt=zt(22),nt.write_shift(4,101010256),nt.write_shift(2,0),nt.write_shift(2,0),nt.write_shift(2,fr),nt.write_shift(2,fr),nt.write_shift(4,On),nt.write_shift(4,Rt),nt.write_shift(2,0),Va([Va(je),Va(Ke),nt])}var Le={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function lt(_e,qe){if(_e.ctype)return _e.ctype;var Ue=_e.name||"",je=Ue.match(/\.([^\.]+)$/);return je&&Le[je[1]]||qe&&(je=(Ue=qe).match(/[\.\\]([^\.\\])+$/),je&&Le[je[1]])?Le[je[1]]:"application/octet-stream"}function xt(_e){for(var qe=rb(_e),Ue=[],je=0;je<qe.length;je+=76)Ue.push(qe.slice(je,je+76));return Ue.join(`\r
`)+`\r
`}function Ot(_e){var qe=_e.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Dt){var Rt=Dt.charCodeAt(0).toString(16).toUpperCase();return"="+(Rt.length==1?"0"+Rt:Rt)});qe=qe.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),qe.charAt(0)==`
`&&(qe="=0D"+qe.slice(1)),qe=qe.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var Ue=[],je=qe.split(`\r
`),Ke=0;Ke<je.length;++Ke){var nt=je[Ke];if(nt.length==0){Ue.push("");continue}for(var It=0;It<nt.length;){var Bt=76,kt=nt.slice(It,It+Bt);kt.charAt(Bt-1)=="="?Bt--:kt.charAt(Bt-2)=="="?Bt-=2:kt.charAt(Bt-3)=="="&&(Bt-=3),kt=nt.slice(It,It+Bt),It+=Bt,It<nt.length&&(kt+="="),Ue.push(kt)}}return Ue.join(`\r
`)}function jt(_e){for(var qe=[],Ue=0;Ue<_e.length;++Ue){for(var je=_e[Ue];Ue<=_e.length&&je.charAt(je.length-1)=="=";)je=je.slice(0,je.length-1)+_e[++Ue];qe.push(je)}for(var Ke=0;Ke<qe.length;++Ke)qe[Ke]=qe[Ke].replace(/[=][0-9A-Fa-f]{2}/g,function(nt){return String.fromCharCode(parseInt(nt.slice(1),16))});return us(qe.join(`\r
`))}function qt(_e,qe,Ue){for(var je="",Ke="",nt="",It,Bt=0;Bt<10;++Bt){var kt=qe[Bt];if(!kt||kt.match(/^\s*$/))break;var Dt=kt.match(/^(.*?):\s*([^\s].*)$/);if(Dt)switch(Dt[1].toLowerCase()){case"content-location":je=Dt[2].trim();break;case"content-type":nt=Dt[2].trim();break;case"content-transfer-encoding":Ke=Dt[2].trim();break}}switch(++Bt,Ke.toLowerCase()){case"base64":It=us(ll(qe.slice(Bt).join("")));break;case"quoted-printable":It=jt(qe.slice(Bt));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+Ke)}var Rt=er(_e,je.slice(Ue.length),It,{unsafe:!0});nt&&(Rt.ctype=nt)}function Jt(_e,qe){if(Ne(_e.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var Ue=qe&&qe.root||"",je=(oi&&Buffer.isBuffer(_e)?_e.toString("binary"):Ne(_e)).split(`\r
`),Ke=0,nt="";for(Ke=0;Ke<je.length;++Ke)if(nt=je[Ke],!!/^Content-Location:/i.test(nt)&&(nt=nt.slice(nt.indexOf("file")),Ue||(Ue=nt.slice(0,nt.lastIndexOf("/")+1)),nt.slice(0,Ue.length)!=Ue))for(;Ue.length>0&&(Ue=Ue.slice(0,Ue.length-1),Ue=Ue.slice(0,Ue.lastIndexOf("/")+1),nt.slice(0,Ue.length)!=Ue););var It=(je[1]||"").match(/boundary="(.*?)"/);if(!It)throw new Error("MAD cannot find boundary");var Bt="--"+(It[1]||""),kt=[],Dt=[],Rt={FileIndex:kt,FullPaths:Dt};j(Rt);var fr,Tr=0;for(Ke=0;Ke<je.length;++Ke){var zr=je[Ke];zr!==Bt&&zr!==Bt+"--"||(Tr++&&qt(Rt,je.slice(fr,Ke),Ue),fr=Ke)}return Rt}function Xt(_e,qe){var Ue=qe||{},je=Ue.boundary||"SheetJS";je="------="+je;for(var Ke=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+je.slice(2)+'"',"","",""],nt=_e.FullPaths[0],It=nt,Bt=_e.FileIndex[0],kt=1;kt<_e.FullPaths.length;++kt)if(It=_e.FullPaths[kt].slice(nt.length),Bt=_e.FileIndex[kt],!(!Bt.size||!Bt.content||It=="Sh33tJ5")){It=It.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(On){return"_x"+On.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(On){return"_u"+On.charCodeAt(0).toString(16)+"_"});for(var Dt=Bt.content,Rt=oi&&Buffer.isBuffer(Dt)?Dt.toString("binary"):Ne(Dt),fr=0,Tr=Math.min(1024,Rt.length),zr=0,yr=0;yr<=Tr;++yr)(zr=Rt.charCodeAt(yr))>=32&&zr<128&&++fr;var wr=fr>=Tr*4/5;Ke.push(je),Ke.push("Content-Location: "+(Ue.root||"file:///C:/SheetJS/")+It),Ke.push("Content-Transfer-Encoding: "+(wr?"quoted-printable":"base64")),Ke.push("Content-Type: "+lt(Bt,It)),Ke.push(""),Ke.push(wr?Ot(Rt):xt(Rt))}return Ke.push(je+`--\r
`),Ke.join(`\r
`)}function or(_e){var qe={};return j(qe,_e),qe}function er(_e,qe,Ue,je){var Ke=je&&je.unsafe;Ke||j(_e);var nt=!Ke&&_n.find(_e,qe);if(!nt){var It=_e.FullPaths[0];qe.slice(0,It.length)==It?It=qe:(It.slice(-1)!="/"&&(It+="/"),It=(It+qe).replace("//","/")),nt={name:c(qe),type:2},_e.FileIndex.push(nt),_e.FullPaths.push(It),Ke||_n.utils.cfb_gc(_e)}return nt.content=Ue,nt.size=Ue?Ue.length:0,je&&(je.CLSID&&(nt.clsid=je.CLSID),je.mt&&(nt.mt=je.mt),je.ct&&(nt.ct=je.ct)),nt}function Ur(_e,qe){j(_e);var Ue=_n.find(_e,qe);if(Ue){for(var je=0;je<_e.FileIndex.length;++je)if(_e.FileIndex[je]==Ue)return _e.FileIndex.splice(je,1),_e.FullPaths.splice(je,1),!0}return!1}function fn(_e,qe,Ue){j(_e);var je=_n.find(_e,qe);if(je){for(var Ke=0;Ke<_e.FileIndex.length;++Ke)if(_e.FileIndex[Ke]==je)return _e.FileIndex[Ke].name=c(Ue),_e.FullPaths[Ke]=Ue,!0}return!1}function Cr(_e){D(_e,!0)}return n.find=ue,n.read=ie,n.parse=b,n.write=He,n.writeFile=ut,n.utils={cfb_new:or,cfb_add:er,cfb_del:Ur,cfb_mov:fn,cfb_gc:Cr,ReadShift:u_,CheckField:r9,prep_blob:so,bconcat:Va,use_zlib:Pe,_deflateRaw:Nt,_inflateRaw:Wi,consts:Ee},n}(),Wu;function s1e(t){Wu=t}function $5(t){return typeof t=="string"?bv(t):Array.isArray(t)?Lve(t):t}function Ev(t,n,a){if(typeof Wu<"u"&&Wu.writeFileSync)return a?Wu.writeFileSync(t,n,a):Wu.writeFileSync(t,n);if(typeof Deno<"u"){if(a&&typeof n=="string")switch(a){case"utf8":n=new TextEncoder(a).encode(n);break;case"binary":n=bv(n);break;default:throw new Error("Unsupported encoding "+a)}return Deno.writeFileSync(t,n)}var s=a=="utf8"?tu(n):n;if(typeof IE_SaveFile<"u")return IE_SaveFile(s,t);if(typeof Blob<"u"){var c=new Blob([$5(s)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(c,t);if(typeof saveAs<"u")return saveAs(c,t);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var f=URL.createObjectURL(c);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(f)},6e4),chrome.downloads.download({url:f,filename:t,saveAs:!0});var d=document.createElement("a");if(d.download!=null)return d.download=t,d.href=f,document.body.appendChild(d),d.click(),document.body.removeChild(d),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(f)},6e4),f}else if(typeof URL<"u"&&!URL.createObjectURL&&typeof chrome=="object"){var p="data:application/octet-stream;base64,"+Rve(new Uint8Array($5(s)));return chrome.downloads.download({url:p,filename:t,saveAs:!0})}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var g=File(t);return g.open("w"),g.encoding="binary",Array.isArray(n)&&(n=su(n)),g.write(n),g.close(),n}catch(y){if(!y.message||!y.message.match(/onstruct/))throw y}throw new Error("cannot save file "+t)}function l1e(t){if(typeof Wu<"u")return Wu.readFileSync(t);if(typeof Deno<"u")return Deno.readFileSync(t);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var n=File(t);n.open("r"),n.encoding="binary";var a=n.read();return n.close(),a}catch(s){if(!s.message||!s.message.match(/onstruct/))throw s}throw new Error("Cannot access file "+t)}function Ma(t){for(var n=Object.keys(t),a=[],s=0;s<n.length;++s)Object.prototype.hasOwnProperty.call(t,n[s])&&a.push(n[s]);return a}function V5(t,n){for(var a=[],s=Ma(t),c=0;c!==s.length;++c)a[t[s[c]][n]]==null&&(a[t[s[c]][n]]=s[c]);return a}function iw(t){for(var n=[],a=Ma(t),s=0;s!==a.length;++s)n[t[a[s]]]=a[s];return n}function aw(t){for(var n=[],a=Ma(t),s=0;s!==a.length;++s)n[t[a[s]]]=parseInt(a[s],10);return n}function c1e(t){for(var n=[],a=Ma(t),s=0;s!==a.length;++s)n[t[a[s]]]==null&&(n[t[a[s]]]=[]),n[t[a[s]]].push(a[s]);return n}var zU=Date.UTC(1899,11,30,0,0,0),u1e=Date.UTC(1899,11,31,0,0,0),f1e=Date.UTC(1904,0,1,0,0,0);function La(t,n){var a=t.getTime(),s=(a-zU)/(24*60*60*1e3);return n?(s-=1462,s<-1402?s-1:s):s<60?s-1:s}function Zu(t){if(t>=60&&t<61)return t;var n=new Date;return n.setTime((t>60?t:t+1)*24*60*60*1e3+zU),n}function h1e(t){var n=0,a=0,s=!1,c=t.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!c)throw new Error("|"+t+"| is not an ISO8601 Duration");for(var f=1;f!=c.length;++f)if(c[f]){switch(a=1,f>3&&(s=!0),c[f].slice(c[f].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+c[f].slice(c[f].length-1));case"D":a*=24;case"H":a*=60;case"M":if(s)a*=60;else throw new Error("Unsupported ISO Duration Field: M")}n+=a*parseInt(c[f],10)}return n}var d1e=/^(\d+):(\d+)(:\d+)?(\.\d+)?$/,p1e=/^(\d+)-(\d+)-(\d+)$/,NU=/^(\d+)-(\d+)-(\d+)[T ](\d+):(\d+)(:\d+)?(\.\d+)?$/;function Fa(t,n){if(t instanceof Date)return t;var a=t.match(d1e);if(a)return new Date((n?f1e:u1e)+((parseInt(a[1],10)*60+parseInt(a[2],10))*60+(a[3]?parseInt(a[3].slice(1),10):0))*1e3+(a[4]?parseInt((a[4]+"000").slice(1,4),10):0));if(a=t.match(p1e),a)return new Date(Date.UTC(+a[1],+a[2]-1,+a[3],0,0,0,0));if(a=t.match(NU),a)return new Date(Date.UTC(+a[1],+a[2]-1,+a[3],+a[4],+a[5],a[6]&&parseInt(a[6].slice(1),10)||0,a[7]&&parseInt(a[7].slice(1),10)||0));var s=new Date(t);return s}function Kd(t,n){if(oi&&Buffer.isBuffer(t)){if(n&&j_){if(t[0]==255&&t[1]==254)return tu(t.slice(2).toString("utf16le"));if(t[1]==254&&t[2]==255)return tu(kU(t.slice(2).toString("binary")))}return t.toString("binary")}if(typeof TextDecoder<"u")try{if(n){if(t[0]==255&&t[1]==254)return tu(new TextDecoder("utf-16le").decode(t.slice(2)));if(t[0]==254&&t[1]==255)return tu(new TextDecoder("utf-16be").decode(t.slice(2)))}var a={"€":"","‚":"",ƒ:"","„":"","…":"","†":"","‡":"","ˆ":"","‰":"",Š:"","‹":"",Œ:"",Ž:"","‘":"","’":"","“":"","”":"","•":"","–":"","—":"","˜":"","™":"",š:"","›":"",œ:"",ž:"",Ÿ:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(f){return a[f]||f})}catch{}var s=[],c=0;try{for(c=0;c<t.length-65536;c+=65536)s.push(String.fromCharCode.apply(0,t.slice(c,c+65536)));s.push(String.fromCharCode.apply(0,t.slice(c)))}catch{try{for(;c<t.length-16384;c+=16384)s.push(String.fromCharCode.apply(0,t.slice(c,c+16384)));s.push(String.fromCharCode.apply(0,t.slice(c)))}catch{for(;c!=t.length;++c)s.push(String.fromCharCode(t[c]))}}return s.join("")}function Qi(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var n={};for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(n[a]=Qi(t[a]));return n}function Mi(t,n){for(var a="";a.length<n;)a+=t;return a}function sl(t){var n=Number(t);if(!isNaN(n))return isFinite(n)?n:NaN;if(!/\d/.test(t))return n;var a=1,s=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return a*=100,""});return!isNaN(n=Number(s))||(s=s.replace(/[(](.*)[)]/,function(c,f){return a=-a,f}),!isNaN(n=Number(s)))?n/a:n}var m1e=/^(0?\d|1[0-2])(?:|:([0-5]?\d)(?:|(\.\d+)(?:|:([0-5]?\d))|:([0-5]?\d)(|\.\d+)))\s+([ap])m?$/,g1e=/^([01]?\d|2[0-3])(?:|:([0-5]?\d)(?:|(\.\d+)(?:|:([0-5]?\d))|:([0-5]?\d)(|\.\d+)))$/,_1e=/^(\d+)-(\d+)-(\d+)[T ](\d+):(\d+)(:\d+)(\.\d+)?[Z]?$/,v1e=new Date("6/9/69 00:00 UTC").valueOf()==-177984e5;function y1e(t){return t[2]?t[3]?t[4]?new Date(Date.UTC(1899,11,31,+t[1]%12+(t[7]=="p"?12:0),+t[2],+t[4],parseFloat(t[3])*1e3)):new Date(Date.UTC(1899,11,31,t[7]=="p"?12:0,+t[1],+t[2],parseFloat(t[3])*1e3)):t[5]?new Date(Date.UTC(1899,11,31,+t[1]%12+(t[7]=="p"?12:0),+t[2],+t[5],t[6]?parseFloat(t[6])*1e3:0)):new Date(Date.UTC(1899,11,31,+t[1]%12+(t[7]=="p"?12:0),+t[2],0,0)):new Date(Date.UTC(1899,11,31,+t[1]%12+(t[7]=="p"?12:0),0,0,0))}function x1e(t){return t[2]?t[3]?t[4]?new Date(Date.UTC(1899,11,31,+t[1],+t[2],+t[4],parseFloat(t[3])*1e3)):new Date(Date.UTC(1899,11,31,0,+t[1],+t[2],parseFloat(t[3])*1e3)):t[5]?new Date(Date.UTC(1899,11,31,+t[1],+t[2],+t[5],t[6]?parseFloat(t[6])*1e3:0)):new Date(Date.UTC(1899,11,31,+t[1],+t[2],0,0)):new Date(Date.UTC(1899,11,31,+t[1],0,0,0))}var b1e=["january","february","march","april","may","june","july","august","september","october","november","december"];function H_(t){if(_1e.test(t))return t.indexOf("Z")==-1?ow(new Date(t)):new Date(t);var n=t.toLowerCase(),a=n.replace(/\s+/g," ").trim(),s=a.match(m1e);if(s)return y1e(s);if(s=a.match(g1e),s)return x1e(s);if(s=a.match(NU),s)return new Date(Date.UTC(+s[1],+s[2]-1,+s[3],+s[4],+s[5],s[6]&&parseInt(s[6].slice(1),10)||0,s[7]&&parseInt(s[7].slice(1),10)||0));var c=new Date(v1e&&t.indexOf("UTC")==-1?t+" UTC":t),f=new Date(NaN),d=c.getYear();c.getMonth();var p=c.getDate();if(isNaN(p))return f;if(n.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(n=n.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),n.length>3&&b1e.indexOf(n)==-1)return f}else if(n.replace(/[ap]m?/,"").match(/[a-z]/))return f;return d<0||d>8099||t.match(/[^-0-9:,\/\\\ ]/)?f:c}var w1e=function(){var t="abacaba".split(/(:?b)/i).length==5;return function(a,s,c){if(t||typeof s=="string")return a.split(s);for(var f=a.split(s),d=[f[0]],p=1;p<f.length;++p)d.push(c),d.push(f[p]);return d}}();function Yd(t){return new Date(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate(),t.getUTCHours(),t.getUTCMinutes(),t.getUTCSeconds(),t.getUTCMilliseconds())}function ow(t){return new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()))}function UU(t){return t?t.content&&t.type?Kd(t.content,!0):t.data?S0(t.data):t.asNodeBuffer&&oi?S0(t.asNodeBuffer().toString("binary")):t.asBinary?S0(t.asBinary()):t._data&&t._data.getContent?S0(Kd(Array.prototype.slice.call(t._data.getContent(),0))):null:null}function $U(t){if(!t)return null;if(t.data)return tb(t.data);if(t.asNodeBuffer&&oi)return t.asNodeBuffer();if(t._data&&t._data.getContent){var n=t._data.getContent();return typeof n=="string"?tb(n):Array.prototype.slice.call(n)}return t.content&&t.type?t.content:null}function E1e(t){return t&&t.name.slice(-4)===".bin"?$U(t):UU(t)}function El(t,n){for(var a=t.FullPaths||Ma(t.files),s=n.toLowerCase().replace(/[\/]/g,"\\"),c=s.replace(/\\/g,"/"),f=0;f<a.length;++f){var d=a[f].replace(/^Root Entry[\/]/,"").toLowerCase();if(s==d||c==d)return t.files?t.files[a[f]]:t.FileIndex[f]}return null}function bk(t,n){var a=El(t,n);if(a==null)throw new Error("Cannot find file "+n+" in zip");return a}function Ka(t,n,a){if(!a)return E1e(bk(t,n));if(!n)return null;try{return Ka(t,n)}catch{return null}}function hs(t,n,a){if(!a)return UU(bk(t,n));if(!n)return null;try{return hs(t,n)}catch{return null}}function VU(t,n,a){if(!a)return $U(bk(t,n));if(!n)return null;try{return VU(t,n)}catch{return null}}function j5(t){for(var n=t.FullPaths||Ma(t.files),a=[],s=0;s<n.length;++s)n[s].slice(-1)!="/"&&a.push(n[s].replace(/^Root Entry[\/]/,""));return a.sort()}function qn(t,n,a){if(t.FullPaths){if(typeof a=="string"){var s;return oi?s=hu(a):s=Dve(a),_n.utils.cfb_add(t,n,s)}_n.utils.cfb_add(t,n,a)}else t.file(n,a)}function wk(){return _n.utils.cfb_new()}function jU(t,n){switch(n.type){case"base64":return _n.read(t,{type:"base64"});case"binary":return _n.read(t,{type:"binary"});case"buffer":case"array":return _n.read(t,{type:"buffer"})}throw new Error("Unrecognized type "+n.type)}function C0(t,n){if(t.charAt(0)=="/")return t.slice(1);var a=n.split("/");n.slice(-1)!="/"&&a.pop();for(var s=t.split("/");s.length!==0;){var c=s.shift();c===".."?a.pop():c!=="."&&a.push(c)}return a.join("/")}var Wa=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,T1e=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,W5=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,S1e=/<[^>]*>/g,ko=Wa.match(W5)?W5:S1e,C1e=/<\w*:/,A1e=/<(\/?)\w+:/;function Kr(t,n,a){for(var s={},c=0,f=0;c!==t.length&&!((f=t.charCodeAt(c))===32||f===10||f===13);++c);if(n||(s[0]=t.slice(0,c)),c===t.length)return s;var d=t.match(T1e),p=0,g="",y=0,b="",E="",T=1;if(d)for(y=0;y!=d.length;++y){for(E=d[y],f=0;f!=E.length&&E.charCodeAt(f)!==61;++f);for(b=E.slice(0,f).trim();E.charCodeAt(f+1)==32;)++f;for(T=(c=E.charCodeAt(f+1))==34||c==39?1:0,g=E.slice(f+1+T,E.length-T),p=0;p!=b.length&&b.charCodeAt(p)!==58;++p);if(p===b.length)b.indexOf("_")>0&&(b=b.slice(0,b.indexOf("_"))),s[b]=g,a||(s[b.toLowerCase()]=g);else{var S=(p===5&&b.slice(0,5)==="xmlns"?"xmlns":"")+b.slice(p+1);if(s[S]&&b.slice(p-3,p)=="ext")continue;s[S]=g,a||(s[S.toLowerCase()]=g)}}return s}function Dl(t){return t.replace(A1e,"<$1")}var WU={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Ek=iw(WU),bi=function(){var t=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,n=/_x([\da-fA-F]{4})_/ig;function a(s){var c=s+"",f=c.indexOf("<![CDATA[");if(f==-1)return c.replace(t,function(p,g){return WU[p]||String.fromCharCode(parseInt(g,p.indexOf("x")>-1?16:10))||p}).replace(n,function(p,g){return String.fromCharCode(parseInt(g,16))});var d=c.indexOf("]]>");return a(c.slice(0,f))+c.slice(f+9,d)+a(c.slice(d+3))}return function(c,f){var d=a(c);return f?d.replace(/\r\n/g,`
`):d}}(),Tk=/[&<>'"]/g,k1e=/[\u0000-\u0008\u000b-\u001f\uFFFE-\uFFFF]/g;function Yn(t){var n=t+"";return n.replace(Tk,function(a){return Ek[a]}).replace(k1e,function(a){return"_x"+("000"+a.charCodeAt(0).toString(16)).slice(-4)+"_"})}function H5(t){return Yn(t).replace(/ /g,"_x0020_")}var HU=/[\u0000-\u001f]/g;function sb(t){var n=t+"";return n.replace(Tk,function(a){return Ek[a]}).replace(/\n/g,"<br/>").replace(HU,function(a){return"&#x"+("000"+a.charCodeAt(0).toString(16)).slice(-4)+";"})}function I1e(t){var n=t+"";return n.replace(Tk,function(a){return Ek[a]}).replace(HU,function(a){return"&#x"+a.charCodeAt(0).toString(16).toUpperCase()+";"})}var G5=function(){var t=/&#(\d+);/g;function n(a,s){return String.fromCharCode(parseInt(s,10))}return function(s){return s.replace(t,n)}}();function M1e(t){return t.replace(/(\r\n|[\r\n])/g,"&#10;")}function ji(t){switch(t){case 1:case!0:case"1":case"true":return!0;case 0:case!1:case"0":case"false":return!1}return!1}function uS(t){for(var n="",a=0,s=0,c=0,f=0,d=0,p=0;a<t.length;){if(s=t.charCodeAt(a++),s<128){n+=String.fromCharCode(s);continue}if(c=t.charCodeAt(a++),s>191&&s<224){d=(s&31)<<6,d|=c&63,n+=String.fromCharCode(d);continue}if(f=t.charCodeAt(a++),s<240){n+=String.fromCharCode((s&15)<<12|(c&63)<<6|f&63);continue}d=t.charCodeAt(a++),p=((s&7)<<18|(c&63)<<12|(f&63)<<6|d&63)-65536,n+=String.fromCharCode(55296+(p>>>10&1023)),n+=String.fromCharCode(56320+(p&1023))}return n}function q5(t){var n=Ah(2*t.length),a,s,c=1,f=0,d=0,p;for(s=0;s<t.length;s+=c)c=1,(p=t.charCodeAt(s))<128?a=p:p<224?(a=(p&31)*64+(t.charCodeAt(s+1)&63),c=2):p<240?(a=(p&15)*4096+(t.charCodeAt(s+1)&63)*64+(t.charCodeAt(s+2)&63),c=3):(c=4,a=(p&7)*262144+(t.charCodeAt(s+1)&63)*4096+(t.charCodeAt(s+2)&63)*64+(t.charCodeAt(s+3)&63),a-=65536,d=55296+(a>>>10&1023),a=56320+(a&1023)),d!==0&&(n[f++]=d&255,n[f++]=d>>>8,d=0),n[f++]=a%256,n[f++]=a>>>8;return n.slice(0,f).toString("ucs2")}function X5(t){return hu(t,"binary").toString("utf8")}var nx="foo bar bazâð£",Ki=oi&&(X5(nx)==uS(nx)&&X5||q5(nx)==uS(nx)&&q5)||uS,tu=oi?function(t){return hu(t,"utf8").toString("binary")}:function(t){for(var n=[],a=0,s=0,c=0;a<t.length;)switch(s=t.charCodeAt(a++),!0){case s<128:n.push(String.fromCharCode(s));break;case s<2048:n.push(String.fromCharCode(192+(s>>6))),n.push(String.fromCharCode(128+(s&63)));break;case(s>=55296&&s<57344):s-=55296,c=t.charCodeAt(a++)-56320+(s<<10),n.push(String.fromCharCode(240+(c>>18&7))),n.push(String.fromCharCode(144+(c>>12&63))),n.push(String.fromCharCode(128+(c>>6&63))),n.push(String.fromCharCode(128+(c&63)));break;default:n.push(String.fromCharCode(224+(s>>12))),n.push(String.fromCharCode(128+(s>>6&63))),n.push(String.fromCharCode(128+(s&63)))}return n.join("")},G_=function(){var t={};return function(a,s){var c=a+"|"+(s||"");return t[c]?t[c]:t[c]=new RegExp("<(?:\\w+:)?"+a+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+a+">",s||"")}}(),GU=function(){var t=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(n){return[new RegExp("&"+n[0]+";","ig"),n[1]]});return function(a){for(var s=a.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),c=0;c<t.length;++c)s=s.replace(t[c][0],t[c][1]);return s}}(),F1e=function(){var t={};return function(a){return t[a]!==void 0?t[a]:t[a]=new RegExp("<(?:vt:)?"+a+">([\\s\\S]*?)</(?:vt:)?"+a+">","g")}}(),P1e=/<\/?(?:vt:)?variant>/g,O1e=/<(?:vt:)([^>]*)>([\s\S]*)</;function Z5(t,n){var a=Kr(t),s=t.match(F1e(a.baseType))||[],c=[];if(s.length!=a.size){if(n.WTF)throw new Error("unexpected vector length "+s.length+" != "+a.size);return c}return s.forEach(function(f){var d=f.replace(P1e,"").match(O1e);d&&c.push({v:Ki(d[2]),t:d[1]})}),c}var qU=/(^\s|\s$|\n)/;function Co(t,n){return"<"+t+(n.match(qU)?' xml:space="preserve"':"")+">"+n+"</"+t+">"}function q_(t){return Ma(t).map(function(n){return" "+n+'="'+t[n]+'"'}).join("")}function Er(t,n,a){return"<"+t+(a!=null?q_(a):"")+(n!=null?(n.match(qU)?' xml:space="preserve"':"")+">"+n+"</"+t:"/")+">"}function PC(t,n){try{return t.toISOString().replace(/\.\d*/,"")}catch(a){if(n)throw a}return""}function R1e(t,n){switch(typeof t){case"string":var a=Er("vt:lpwstr",Yn(t));return n&&(a=a.replace(/&quot;/g,"_x0022_")),a;case"number":return Er((t|0)==t?"vt:i4":"vt:r8",Yn(String(t)));case"boolean":return Er("vt:bool",t?"true":"false")}if(t instanceof Date)return Er("vt:filetime",PC(t));throw new Error("Unable to serialize "+t)}function sw(t){if(oi&&Buffer.isBuffer(t))return t.toString("utf8");if(typeof t=="string")return t;if(typeof Uint8Array<"u"&&t instanceof Uint8Array)return Ki(su(_k(t)));throw new Error("Bad input format: expected Buffer or string")}var Ja=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/](?:[^>=]|="[^"]*?")*)?>/mg,uo={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},lp=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],nl={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function L1e(t,n){for(var a=1-2*(t[n+7]>>>7),s=((t[n+7]&127)<<4)+(t[n+6]>>>4&15),c=t[n+6]&15,f=5;f>=0;--f)c=c*256+t[n+f];return s==2047?c==0?a*(1/0):NaN:(s==0?s=-1022:(s-=1023,c+=Math.pow(2,52)),a*Math.pow(2,s-52)*c)}function D1e(t,n,a){var s=(n<0||1/n==-1/0?1:0)<<7,c=0,f=0,d=s?-n:n;isFinite(d)?d==0?c=f=0:(c=Math.floor(Math.log(d)/Math.LN2),f=d*Math.pow(2,52-c),c<=-1023&&(!isFinite(f)||f<Math.pow(2,52))?c=-1022:(f-=Math.pow(2,52),c+=1023)):(c=2047,f=isNaN(n)?26985:0);for(var p=0;p<=5;++p,f/=256)t[a+p]=f&255;t[a+6]=(c&15)<<4|f&15,t[a+7]=c>>4|s}var K5=function(t){for(var n=[],a=10240,s=0;s<t[0].length;++s)if(t[0][s])for(var c=0,f=t[0][s].length;c<f;c+=a)n.push.apply(n,t[0][s].slice(c,c+a));return n},Y5=oi?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(n){return Buffer.isBuffer(n)?n:hu(n)})):K5(t)}:K5,J5=function(t,n,a){for(var s=[],c=n;c<a;c+=2)s.push(String.fromCharCode(Hu(t,c)));return s.join("").replace(Ho,"")},lw=oi?function(t,n,a){return!Buffer.isBuffer(t)||!j_?J5(t,n,a):t.toString("utf16le",n,a).replace(Ho,"")}:J5,Q5=function(t,n,a){for(var s=[],c=n;c<n+a;++c)s.push(("0"+t[c].toString(16)).slice(-2));return s.join("")},XU=oi?function(t,n,a){return Buffer.isBuffer(t)?t.toString("hex",n,n+a):Q5(t,n,a)}:Q5,e6=function(t,n,a){for(var s=[],c=n;c<a;c++)s.push(String.fromCharCode(E0(t,c)));return s.join("")},xm=oi?function(n,a,s){return Buffer.isBuffer(n)?n.toString("utf8",a,s):e6(n,a,s)}:e6,ZU=function(t,n){var a=vo(t,n);return a>0?xm(t,n+4,n+4+a-1):""},Sk=ZU,KU=function(t,n){var a=vo(t,n);return a>0?xm(t,n+4,n+4+a-1):""},Ck=KU,YU=function(t,n){var a=2*vo(t,n);return a>0?xm(t,n+4,n+4+a-1):""},Ak=YU,JU=function(n,a){var s=vo(n,a);return s>0?lw(n,a+4,a+4+s):""},kk=JU,QU=function(t,n){var a=vo(t,n);return a>0?xm(t,n+4,n+4+a):""},Ik=QU,e9=function(t,n){return L1e(t,n)},lb=e9,Mk=function(n){return Array.isArray(n)||typeof Uint8Array<"u"&&n instanceof Uint8Array};oi&&(Sk=function(n,a){if(!Buffer.isBuffer(n))return ZU(n,a);var s=n.readUInt32LE(a);return s>0?n.toString("utf8",a+4,a+4+s-1):""},Ck=function(n,a){if(!Buffer.isBuffer(n))return KU(n,a);var s=n.readUInt32LE(a);return s>0?n.toString("utf8",a+4,a+4+s-1):""},Ak=function(n,a){if(!Buffer.isBuffer(n)||!j_)return YU(n,a);var s=2*n.readUInt32LE(a);return n.toString("utf16le",a+4,a+4+s-1)},kk=function(n,a){if(!Buffer.isBuffer(n)||!j_)return JU(n,a);var s=n.readUInt32LE(a);return n.toString("utf16le",a+4,a+4+s)},Ik=function(n,a){if(!Buffer.isBuffer(n))return QU(n,a);var s=n.readUInt32LE(a);return n.toString("utf8",a+4,a+4+s)},lb=function(n,a){return Buffer.isBuffer(n)?n.readDoubleLE(a):e9(n,a)},Mk=function(n){return Buffer.isBuffer(n)||Array.isArray(n)||typeof Uint8Array<"u"&&n instanceof Uint8Array});function t9(){lw=function(t,n,a){return Jn.utils.decode(1200,t.slice(n,a)).replace(Ho,"")},xm=function(t,n,a){return Jn.utils.decode(65001,t.slice(n,a))},Sk=function(t,n){var a=vo(t,n);return a>0?Jn.utils.decode(Xd,t.slice(n+4,n+4+a-1)):""},Ck=function(t,n){var a=vo(t,n);return a>0?Jn.utils.decode(co,t.slice(n+4,n+4+a-1)):""},Ak=function(t,n){var a=2*vo(t,n);return a>0?Jn.utils.decode(1200,t.slice(n+4,n+4+a-1)):""},kk=function(t,n){var a=vo(t,n);return a>0?Jn.utils.decode(1200,t.slice(n+4,n+4+a)):""},Ik=function(t,n){var a=vo(t,n);return a>0?Jn.utils.decode(65001,t.slice(n+4,n+4+a)):""}}typeof Jn<"u"&&t9();var E0=function(t,n){return t[n]},Hu=function(t,n){return t[n+1]*256+t[n]},B1e=function(t,n){var a=t[n+1]*256+t[n];return a<32768?a:(65535-a+1)*-1},vo=function(t,n){return t[n+3]*(1<<24)+(t[n+2]<<16)+(t[n+1]<<8)+t[n]},Md=function(t,n){return t[n+3]<<24|t[n+2]<<16|t[n+1]<<8|t[n]},z1e=function(t,n){return t[n]<<24|t[n+1]<<16|t[n+2]<<8|t[n+3]};function u_(t,n){var a="",s,c,f=[],d,p,g,y;switch(n){case"dbcs":if(y=this.l,oi&&Buffer.isBuffer(this)&&j_)a=this.slice(this.l,this.l+2*t).toString("utf16le");else for(g=0;g<t;++g)a+=String.fromCharCode(Hu(this,y)),y+=2;t*=2;break;case"utf8":a=xm(this,this.l,this.l+t);break;case"utf16le":t*=2,a=lw(this,this.l,this.l+t);break;case"wstr":if(typeof Jn<"u")a=Jn.utils.decode(co,this.slice(this.l,this.l+2*t));else return u_.call(this,t,"dbcs");t=2*t;break;case"lpstr-ansi":a=Sk(this,this.l),t=4+vo(this,this.l);break;case"lpstr-cp":a=Ck(this,this.l),t=4+vo(this,this.l);break;case"lpwstr":a=Ak(this,this.l),t=4+2*vo(this,this.l);break;case"lpp4":t=4+vo(this,this.l),a=kk(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+vo(this,this.l),a=Ik(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,a="";(d=E0(this,this.l+t++))!==0;)f.push(Gg(d));a=f.join("");break;case"_wstr":for(t=0,a="";(d=Hu(this,this.l+t))!==0;)f.push(Gg(d)),t+=2;t+=2,a=f.join("");break;case"dbcs-cont":for(a="",y=this.l,g=0;g<t;++g){if(this.lens&&this.lens.indexOf(y)!==-1)return d=E0(this,y),this.l=y+1,p=u_.call(this,t-g,d?"dbcs-cont":"sbcs-cont"),f.join("")+p;f.push(Gg(Hu(this,y))),y+=2}a=f.join(""),t*=2;break;case"cpstr":if(typeof Jn<"u"){a=Jn.utils.decode(co,this.slice(this.l,this.l+t));break}case"sbcs-cont":for(a="",y=this.l,g=0;g!=t;++g){if(this.lens&&this.lens.indexOf(y)!==-1)return d=E0(this,y),this.l=y+1,p=u_.call(this,t-g,d?"dbcs-cont":"sbcs-cont"),f.join("")+p;f.push(Gg(E0(this,y))),y+=1}a=f.join("");break;default:switch(t){case 1:return s=E0(this,this.l),this.l++,s;case 2:return s=(n==="i"?B1e:Hu)(this,this.l),this.l+=2,s;case 4:case-4:return n==="i"||!(this[this.l+3]&128)?(s=(t>0?Md:z1e)(this,this.l),this.l+=4,s):(c=vo(this,this.l),this.l+=4,c);case 8:case-8:if(n==="f")return t==8?c=lb(this,this.l):c=lb([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,c;t=8;case 16:a=XU(this,this.l,t);break}}return this.l+=t,a}var N1e=function(t,n,a){t[a]=n&255,t[a+1]=n>>>8&255,t[a+2]=n>>>16&255,t[a+3]=n>>>24&255},U1e=function(t,n,a){t[a]=n&255,t[a+1]=n>>8&255,t[a+2]=n>>16&255,t[a+3]=n>>24&255},$1e=function(t,n,a){t[a]=n&255,t[a+1]=n>>>8&255};function V1e(t,n,a){var s=0,c=0;if(a==="dbcs"){for(c=0;c!=n.length;++c)$1e(this,n.charCodeAt(c),this.l+2*c);s=2*n.length}else if(a==="sbcs"||a=="cpstr")if(typeof Jn<"u"&&Xd==874){for(c=0;c!=n.length;++c){var f=Jn.utils.encode(Xd,n.charAt(c));this[this.l+c]=f[0]}s=n.length}else if(typeof Jn<"u"&&a=="cpstr"){if(f=Jn.utils.encode(co,n),f.length==n.length)for(c=0;c<n.length;++c)f[c]==0&&n.charCodeAt(c)!=0&&(f[c]=95);if(f.length==2*n.length)for(c=0;c<n.length;++c)f[2*c]==0&&f[2*c+1]==0&&n.charCodeAt(c)!=0&&(f[2*c]=95);for(c=0;c<f.length;++c)this[this.l+c]=f[c];s=f.length}else{for(n=n.replace(/[^\x00-\x7F]/g,"_"),c=0;c!=n.length;++c)this[this.l+c]=n.charCodeAt(c)&255;s=n.length}else if(a==="hex"){for(;c<t;++c)this[this.l++]=parseInt(n.slice(2*c,2*c+2),16)||0;return this}else if(a==="utf16le"){var d=Math.min(this.l+t,this.length);for(c=0;c<Math.min(n.length,t);++c){var p=n.charCodeAt(c);this[this.l++]=p&255,this[this.l++]=p>>8}for(;this.l<d;)this[this.l++]=0;return this}else switch(t){case 1:s=1,this[this.l]=n&255;break;case 2:s=2,this[this.l]=n&255,n>>>=8,this[this.l+1]=n&255;break;case 3:s=3,this[this.l]=n&255,n>>>=8,this[this.l+1]=n&255,n>>>=8,this[this.l+2]=n&255;break;case 4:s=4,N1e(this,n,this.l);break;case 8:if(s=8,a==="f"){D1e(this,n,this.l);break}case 16:break;case-4:s=4,U1e(this,n,this.l);break}return this.l+=s,this}function r9(t,n){var a=XU(this,this.l,t.length>>1);if(a!==t)throw new Error(n+"Expected "+t+" saw "+a);this.l+=t.length>>1}function so(t,n){t.l=n,t.read_shift=u_,t.chk=r9,t.write_shift=V1e}function Zo(t,n){t.l+=n}function zt(t){var n=Ah(t);return so(n,0),n}function ff(t,n,a){if(t){var s,c,f;so(t,t.l||0);for(var d=t.length,p=0,g=0;t.l<d;){p=t.read_shift(1),p&128&&(p=(p&127)+((t.read_shift(1)&127)<<7));var y=rv[p]||rv[65535];for(s=t.read_shift(1),f=s&127,c=1;c<4&&s&128;++c)f+=((s=t.read_shift(1))&127)<<7*c;g=t.l+f;var b=y.f&&y.f(t,f,a);if(t.l=g,n(b,y,p))return}}}function Go(){var t=[],n=oi?256:2048,a=function(y){var b=zt(y);return so(b,0),b},s=a(n),c=function(){s&&(s.l&&(s.length>s.l&&(s=s.slice(0,s.l),s.l=s.length),s.length>0&&t.push(s)),s=null)},f=function(y){return s&&y<s.length-s.l?s:(c(),s=a(Math.max(y+1,n)))},d=function(){return c(),Va(t)},p=function(y){c(),s=y,s.l==null&&(s.l=s.length),f(n)};return{next:f,push:p,end:d,_bufs:t}}function rr(t,n,a,s){var c=+n,f;if(!isNaN(c)){s||(s=rv[c].p||(a||[]).length||0),f=1+(c>=128?1:0)+1,s>=128&&++f,s>=16384&&++f,s>=2097152&&++f;var d=t.next(f);c<=127?d.write_shift(1,c):(d.write_shift(1,(c&127)+128),d.write_shift(1,c>>7));for(var p=0;p!=4;++p)if(s>=128)d.write_shift(1,(s&127)+128),s>>=7;else{d.write_shift(1,s);break}s>0&&Mk(a)&&t.push(a)}}function f_(t,n,a){var s=Qi(t);if(n.s?(s.cRel&&(s.c+=n.s.c),s.rRel&&(s.r+=n.s.r)):(s.cRel&&(s.c+=n.c),s.rRel&&(s.r+=n.r)),!a||a.biff<12){for(;s.c>=256;)s.c-=256;for(;s.r>=65536;)s.r-=65536}return s}function t6(t,n,a){var s=Qi(t);return s.s=f_(s.s,n.s,a),s.e=f_(s.e,n.s,a),s}function h_(t,n){if(t.cRel&&t.c<0)for(t=Qi(t);t.c<0;)t.c+=n>8?16384:256;if(t.rRel&&t.r<0)for(t=Qi(t);t.r<0;)t.r+=n>8?1048576:n>5?65536:16384;var a=ii(t);return!t.cRel&&t.cRel!=null&&(a=H1e(a)),!t.rRel&&t.rRel!=null&&(a=j1e(a)),a}function fS(t,n){return t.s.r==0&&!t.s.rRel&&t.e.r==(n.biff>=12?1048575:n.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+Qn(t.s.c)+":"+(t.e.cRel?"":"$")+Qn(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(n.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+vi(t.s.r)+":"+(t.e.rRel?"":"$")+vi(t.e.r):h_(t.s,n.biff)+":"+h_(t.e,n.biff)}function Fk(t){return parseInt(W1e(t),10)-1}function vi(t){return""+(t+1)}function j1e(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function W1e(t){return t.replace(/\$(\d+)$/,"$1")}function Pk(t){for(var n=G1e(t),a=0,s=0;s!==n.length;++s)a=26*a+n.charCodeAt(s)-64;return a-1}function Qn(t){if(t<0)throw new Error("invalid column "+t);var n="";for(++t;t;t=Math.floor((t-1)/26))n=String.fromCharCode((t-1)%26+65)+n;return n}function H1e(t){return t.replace(/^([A-Z])/,"$$$1")}function G1e(t){return t.replace(/^\$([A-Z])/,"$1")}function q1e(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Yi(t){for(var n=0,a=0,s=0;s<t.length;++s){var c=t.charCodeAt(s);c>=48&&c<=57?n=10*n+(c-48):c>=65&&c<=90&&(a=26*a+(c-64))}return{c:a-1,r:n-1}}function ii(t){for(var n=t.c+1,a="";n;n=(n-1)/26|0)a=String.fromCharCode((n-1)%26+65)+a;return a+(t.r+1)}function ho(t){var n=t.indexOf(":");return n==-1?{s:Yi(t),e:Yi(t)}:{s:Yi(t.slice(0,n)),e:Yi(t.slice(n+1))}}function Xn(t,n){return typeof n>"u"||typeof n=="number"?Xn(t.s,t.e):(typeof t!="string"&&(t=ii(t)),typeof n!="string"&&(n=ii(n)),t==n?t:t+":"+n)}function X_(t){var n=ho(t);return"$"+Qn(n.s.c)+"$"+vi(n.s.r)+":$"+Qn(n.e.c)+"$"+vi(n.e.r)}function Z_(t,n){if(!t&&!(n&&n.biff<=5&&n.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t.replace(/'/g,"''")+"'":t}function Ei(t){var n={s:{c:0,r:0},e:{c:0,r:0}},a=0,s=0,c=0,f=t.length;for(a=0;s<f&&!((c=t.charCodeAt(s)-64)<1||c>26);++s)a=26*a+c;for(n.s.c=--a,a=0;s<f&&!((c=t.charCodeAt(s)-48)<0||c>9);++s)a=10*a+c;if(n.s.r=--a,s===f||c!=10)return n.e.c=n.s.c,n.e.r=n.s.r,n;for(++s,a=0;s!=f&&!((c=t.charCodeAt(s)-64)<1||c>26);++s)a=26*a+c;for(n.e.c=--a,a=0;s!=f&&!((c=t.charCodeAt(s)-48)<0||c>9);++s)a=10*a+c;return n.e.r=--a,n}function r6(t,n){var a=t.t=="d"&&n instanceof Date;if(t.z!=null)try{return t.w=$s(t.z,a?La(n):n)}catch{}try{return t.w=$s((t.XF||{}).numFmtId||(a?14:0),a?La(n):n)}catch{return""+n}}function lu(t,n,a){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&a&&a.dateNF&&(t.z=a.dateNF),t.t=="e"?uc[t.v]||t.v:n==null?r6(t,t.v):r6(t,n))}function Bh(t,n){var a=n&&n.sheet?n.sheet:"Sheet1",s={};return s[a]=t,{SheetNames:[a],Sheets:s}}function n9(t,n,a){var s=a||{},c=t?t["!data"]!=null:s.dense,f=t||{};c&&!f["!data"]&&(f["!data"]=[]);var d=0,p=0;if(f&&s.origin!=null){if(typeof s.origin=="number")d=s.origin;else{var g=typeof s.origin=="string"?Yi(s.origin):s.origin;d=g.r,p=g.c}f["!ref"]||(f["!ref"]="A1:A1")}var y={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(f["!ref"]){var b=Ei(f["!ref"]);y.s.c=b.s.c,y.s.r=b.s.r,y.e.c=Math.max(y.e.c,b.e.c),y.e.r=Math.max(y.e.r,b.e.r),d==-1&&(y.e.r=d=b.e.r+1)}for(var E=[],T=0;T!=n.length;++T)if(n[T]){if(!Array.isArray(n[T]))throw new Error("aoa_to_sheet expects an array of arrays");var S=d+T,I=""+(S+1);c&&(f["!data"][S]||(f["!data"][S]=[]),E=f["!data"][S]);for(var A=0;A!=n[T].length;++A)if(!(typeof n[T][A]>"u")){var M={v:n[T][A]},F=p+A;if(y.s.r>S&&(y.s.r=S),y.s.c>F&&(y.s.c=F),y.e.r<S&&(y.e.r=S),y.e.c<F&&(y.e.c=F),n[T][A]&&typeof n[T][A]=="object"&&!Array.isArray(n[T][A])&&!(n[T][A]instanceof Date))M=n[T][A];else if(Array.isArray(M.v)&&(M.f=n[T][A][1],M.v=M.v[0]),M.v===null)if(M.f)M.t="n";else if(s.nullError)M.t="e",M.v=0;else if(s.sheetStubs)M.t="z";else continue;else typeof M.v=="number"?M.t="n":typeof M.v=="boolean"?M.t="b":M.v instanceof Date?(M.z=s.dateNF||pn[14],s.UTC||(M.v=ow(M.v)),s.cellDates?(M.t="d",M.w=$s(M.z,La(M.v,s.date1904))):(M.t="n",M.v=La(M.v,s.date1904),M.w=$s(M.z,M.v))):M.t="s";if(c)E[F]&&E[F].z&&(M.z=E[F].z),E[F]=M;else{var L=Qn(F)+I;f[L]&&f[L].z&&(M.z=f[L].z),f[L]=M}}}return y.s.c<1e7&&(f["!ref"]=Xn(y)),f}function bm(t,n){return n9(null,t,n)}function X1e(t){return t.read_shift(4,"i")}function cc(t,n){return n||(n=zt(4)),n.write_shift(4,t),n}function qo(t){var n=t.read_shift(4);return n===0?"":t.read_shift(n,"dbcs")}function fo(t,n){var a=!1;return n==null&&(a=!0,n=zt(4+2*t.length)),n.write_shift(4,t.length),t.length>0&&n.write_shift(0,t,"dbcs"),a?n.slice(0,n.l):n}function Z1e(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function K1e(t,n){return n||(n=zt(4)),n.write_shift(2,t.ich||0),n.write_shift(2,t.ifnt||0),n}function Ok(t,n){var a=t.l,s=t.read_shift(1),c=qo(t),f=[],d={t:c,h:c};if(s&1){for(var p=t.read_shift(4),g=0;g!=p;++g)f.push(Z1e(t));d.r=f}else d.r=[{ich:0,ifnt:0}];return t.l=a+n,d}function Y1e(t,n){var a=!1;return n==null&&(a=!0,n=zt(15+4*t.t.length)),n.write_shift(1,0),fo(t.t,n),a?n.slice(0,n.l):n}var J1e=Ok;function Q1e(t,n){var a=!1;return n==null&&(a=!0,n=zt(23+4*t.t.length)),n.write_shift(1,1),fo(t.t,n),n.write_shift(4,1),K1e({ich:0,ifnt:0},n),a?n.slice(0,n.l):n}function Bl(t){var n=t.read_shift(4),a=t.read_shift(2);return a+=t.read_shift(1)<<16,t.l++,{c:n,iStyleRef:a}}function cp(t,n){return n==null&&(n=zt(8)),n.write_shift(-4,t.c),n.write_shift(3,t.iStyleRef||t.s),n.write_shift(1,0),n}function up(t){var n=t.read_shift(2);return n+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:n}}function fp(t,n){return n==null&&(n=zt(4)),n.write_shift(3,t.iStyleRef||t.s),n.write_shift(1,0),n}var eye=qo,i9=fo;function cw(t){var n=t.read_shift(4);return n===0||n===4294967295?"":t.read_shift(n,"dbcs")}function K_(t,n){var a=!1;return n==null&&(a=!0,n=zt(127)),n.write_shift(4,t.length>0?t.length:4294967295),t.length>0&&n.write_shift(0,t,"dbcs"),a?n.slice(0,n.l):n}var tye=qo,OC=cw,Rk=K_;function uw(t){var n=t.slice(t.l,t.l+4),a=n[0]&1,s=n[0]&2;t.l+=4;var c=s===0?lb([0,0,0,0,n[0]&252,n[1],n[2],n[3]],0):Md(n,0)>>2;return a?c/100:c}function a9(t,n){n==null&&(n=zt(4));var a=0,s=0,c=t*100;if(t==(t|0)&&t>=-(1<<29)&&t<1<<29?s=1:c==(c|0)&&c>=-(1<<29)&&c<1<<29&&(s=1,a=1),s)n.write_shift(-4,((a?c:t)<<2)+(a+2));else throw new Error("unsupported RkNumber "+t)}function o9(t){var n={s:{},e:{}};return n.s.r=t.read_shift(4),n.e.r=t.read_shift(4),n.s.c=t.read_shift(4),n.e.c=t.read_shift(4),n}function rye(t,n){return n||(n=zt(16)),n.write_shift(4,t.s.r),n.write_shift(4,t.e.r),n.write_shift(4,t.s.c),n.write_shift(4,t.e.c),n}var hp=o9,wm=rye;function Vo(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function Jd(t,n){return(n||zt(8)).write_shift(8,t,"f")}function nye(t){var n={},a=t.read_shift(1),s=a>>>1,c=t.read_shift(1),f=t.read_shift(2,"i"),d=t.read_shift(1),p=t.read_shift(1),g=t.read_shift(1);switch(t.l++,s){case 0:n.auto=1;break;case 1:n.index=c;var y=Nd[c];y&&(n.rgb=J_(y));break;case 2:n.rgb=J_([d,p,g]);break;case 3:n.theme=c;break}return f!=0&&(n.tint=f>0?f/32767:f/32768),n}function cb(t,n){if(n||(n=zt(8)),!t||t.auto)return n.write_shift(4,0),n.write_shift(4,0),n;t.index!=null?(n.write_shift(1,2),n.write_shift(1,t.index)):t.theme!=null?(n.write_shift(1,6),n.write_shift(1,t.theme)):(n.write_shift(1,5),n.write_shift(1,0));var a=t.tint||0;if(a>0?a*=32767:a<0&&(a*=32768),n.write_shift(2,a),!t.rgb||t.theme!=null)n.write_shift(2,0),n.write_shift(1,0),n.write_shift(1,0);else{var s=t.rgb||"FFFFFF";typeof s=="number"&&(s=("000000"+s.toString(16)).slice(-6)),n.write_shift(1,parseInt(s.slice(0,2),16)),n.write_shift(1,parseInt(s.slice(2,4),16)),n.write_shift(1,parseInt(s.slice(4,6),16)),n.write_shift(1,255)}return n}function iye(t){var n=t.read_shift(1);t.l++;var a={fBold:n&1,fItalic:n&2,fUnderline:n&4,fStrikeout:n&8,fOutline:n&16,fShadow:n&32,fCondense:n&64,fExtend:n&128};return a}function aye(t,n){n||(n=zt(2));var a=(t.italic?2:0)|(t.strike?8:0)|(t.outline?16:0)|(t.shadow?32:0)|(t.condense?64:0)|(t.extend?128:0);return n.write_shift(1,a),n.write_shift(1,0),n}function s9(t,n){var a={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},s=t.read_shift(4);switch(s){case 0:return"";case 4294967295:case 4294967294:return a[t.read_shift(4)]||""}if(s>400)throw new Error("Unsupported Clipboard: "+s.toString(16));return t.l-=4,t.read_shift(0,n==1?"lpstr":"lpwstr")}function oye(t){return s9(t,1)}function sye(t){return s9(t,2)}var Lk=2,Os=3,ix=11,n6=12,ub=19,ax=64,lye=65,cye=71,uye=4108,fye=4126,_o=80,l9=81,hye=[_o,l9],RC={1:{n:"CodePage",t:Lk},2:{n:"Category",t:_o},3:{n:"PresentationFormat",t:_o},4:{n:"ByteCount",t:Os},5:{n:"LineCount",t:Os},6:{n:"ParagraphCount",t:Os},7:{n:"SlideCount",t:Os},8:{n:"NoteCount",t:Os},9:{n:"HiddenCount",t:Os},10:{n:"MultimediaClipCount",t:Os},11:{n:"ScaleCrop",t:ix},12:{n:"HeadingPairs",t:uye},13:{n:"TitlesOfParts",t:fye},14:{n:"Manager",t:_o},15:{n:"Company",t:_o},16:{n:"LinksUpToDate",t:ix},17:{n:"CharacterCount",t:Os},19:{n:"SharedDoc",t:ix},22:{n:"HyperlinksChanged",t:ix},23:{n:"AppVersion",t:Os,p:"version"},24:{n:"DigSig",t:lye},26:{n:"ContentType",t:_o},27:{n:"ContentStatus",t:_o},28:{n:"Language",t:_o},29:{n:"Version",t:_o},255:{},2147483648:{n:"Locale",t:ub},2147483651:{n:"Behavior",t:ub},1919054434:{}},LC={1:{n:"CodePage",t:Lk},2:{n:"Title",t:_o},3:{n:"Subject",t:_o},4:{n:"Author",t:_o},5:{n:"Keywords",t:_o},6:{n:"Comments",t:_o},7:{n:"Template",t:_o},8:{n:"LastAuthor",t:_o},9:{n:"RevNumber",t:_o},10:{n:"EditTime",t:ax},11:{n:"LastPrinted",t:ax},12:{n:"CreatedDate",t:ax},13:{n:"ModifiedDate",t:ax},14:{n:"PageCount",t:Os},15:{n:"WordCount",t:Os},16:{n:"CharCount",t:Os},17:{n:"Thumbnail",t:cye},18:{n:"Application",t:_o},19:{n:"DocSecurity",t:Os},255:{},2147483648:{n:"Locale",t:ub},2147483651:{n:"Behavior",t:ub},1919054434:{}},i6={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},dye=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function pye(t){return t.map(function(n){return[n>>16&255,n>>8&255,n&255]})}var mye=pye([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,0,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Nd=Qi(mye),uc={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},Dk={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Bk=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"],DC={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},ox={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function zk(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function gye(t){var n=zk();if(!t||!t.match)return n;var a={};if((t.match(ko)||[]).forEach(function(s){var c=Kr(s);switch(c[0].replace(C1e,"<")){case"<?xml":break;case"<Types":n.xmlns=c["xmlns"+(c[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":a[c.Extension.toLowerCase()]=c.ContentType;break;case"<Override":n[DC[c.ContentType]]!==void 0&&n[DC[c.ContentType]].push(c.PartName);break}}),n.xmlns!==uo.CT)throw new Error("Unknown Namespace: "+n.xmlns);return n.calcchain=n.calcchains.length>0?n.calcchains[0]:"",n.sst=n.strs.length>0?n.strs[0]:"",n.style=n.styles.length>0?n.styles[0]:"",n.defaults=a,delete n.calcchains,n}function c9(t,n,a){var s=c1e(DC),c=[],f;a||(c[c.length]=Wa,c[c.length]=Er("Types",null,{xmlns:uo.CT,"xmlns:xsd":uo.xsd,"xmlns:xsi":uo.xsi}),c=c.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(y){return Er("Default",null,{Extension:y[0],ContentType:y[1]})})));var d=function(y){t[y]&&t[y].length>0&&(f=t[y][0],c[c.length]=Er("Override",null,{PartName:(f[0]=="/"?"":"/")+f,ContentType:ox[y][n.bookType]||ox[y].xlsx}))},p=function(y){(t[y]||[]).forEach(function(b){c[c.length]=Er("Override",null,{PartName:(b[0]=="/"?"":"/")+b,ContentType:ox[y][n.bookType]||ox[y].xlsx})})},g=function(y){(t[y]||[]).forEach(function(b){c[c.length]=Er("Override",null,{PartName:(b[0]=="/"?"":"/")+b,ContentType:s[y][0]})})};return d("workbooks"),p("sheets"),p("charts"),g("themes"),["strs","styles"].forEach(d),["coreprops","extprops","custprops"].forEach(g),g("vba"),g("comments"),g("threadedcomments"),g("drawings"),p("metadata"),g("people"),!a&&c.length>2&&(c[c.length]="</Types>",c[1]=c[1].replace("/>",">")),c.join("")}var ni={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",CONN:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/connections",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Y_(t){var n=t.lastIndexOf("/");return t.slice(0,n+1)+"_rels/"+t.slice(n+1)+".rels"}function d_(t,n){var a={"!id":{}};if(!t)return a;n.charAt(0)!=="/"&&(n="/"+n);var s={};return(t.match(ko)||[]).forEach(function(c){var f=Kr(c);if(f[0]==="<Relationship"){var d={};d.Type=f.Type,d.Target=bi(f.Target),d.Id=f.Id,f.TargetMode&&(d.TargetMode=f.TargetMode);var p=f.TargetMode==="External"?f.Target:C0(f.Target,n);a[p]=d,s[f.Id]=d}}),a["!id"]=s,a}function O0(t){var n=[Wa,Er("Relationships",null,{xmlns:uo.RELS})];return Ma(t["!id"]).forEach(function(a){n[n.length]=Er("Relationship",null,t["!id"][a])}),n.length>2&&(n[n.length]="</Relationships>",n[1]=n[1].replace("/>",">")),n.join("")}function $i(t,n,a,s,c,f){if(c||(c={}),t["!id"]||(t["!id"]={}),t["!idx"]||(t["!idx"]=1),n<0)for(n=t["!idx"];t["!id"]["rId"+n];++n);if(t["!idx"]=n+1,c.Id="rId"+n,c.Type=s,c.Target=a,f?c.TargetMode=f:[ni.HLINK,ni.XPATH,ni.XMISS].indexOf(c.Type)>-1&&(c.TargetMode="External"),t["!id"][c.Id])throw new Error("Cannot rewrite rId "+n);return t["!id"][c.Id]=c,t[("/"+c.Target).replace("//","/")]=c,n}var _ye="application/vnd.oasis.opendocument.spreadsheet";function vye(t,n){for(var a=sw(t),s,c;s=Ja.exec(a);)switch(s[3]){case"manifest":break;case"file-entry":if(c=Kr(s[0],!1),c.path=="/"&&c.type!==_ye)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(n&&n.WTF)throw s}}function yye(t){var n=[Wa];n.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),n.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var a=0;a<t.length;++a)n.push('  <manifest:file-entry manifest:full-path="'+t[a][0]+'" manifest:media-type="'+t[a][1]+`"/>
`);return n.push("</manifest:manifest>"),n.join("")}function a6(t,n,a){return['  <rdf:Description rdf:about="'+t+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(a||"odf")+"#"+n+`"/>
`,`  </rdf:Description>
`].join("")}function xye(t,n){return['  <rdf:Description rdf:about="'+t+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+n+`"/>
`,`  </rdf:Description>
`].join("")}function bye(t){var n=[Wa];n.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var a=0;a!=t.length;++a)n.push(a6(t[a][0],t[a][1])),n.push(xye("",t[a][0]));return n.push(a6("","Document","pkg")),n.push("</rdf:RDF>"),n.join("")}function u9(t,n){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+eb.version+"</meta:generator></office:meta></office:document-meta>"}var Ml=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],wye=function(){for(var t=new Array(Ml.length),n=0;n<Ml.length;++n){var a=Ml[n],s="(?:"+a[0].slice(0,a[0].indexOf(":"))+":)"+a[0].slice(a[0].indexOf(":")+1);t[n]=new RegExp("<"+s+"[^>]*>([\\s\\S]*?)</"+s+">")}return t}();function f9(t){var n={};t=Ki(t);for(var a=0;a<Ml.length;++a){var s=Ml[a],c=t.match(wye[a]);c!=null&&c.length>0&&(n[s[1]]=bi(c[1])),s[2]==="date"&&n[s[1]]&&(n[s[1]]=Fa(n[s[1]]))}return n}function hS(t,n,a,s,c){c[t]!=null||n==null||n===""||(c[t]=n,n=Yn(n),s[s.length]=a?Er(t,n,a):Co(t,n))}function h9(t,n){var a=n||{},s=[Wa,Er("cp:coreProperties",null,{"xmlns:cp":uo.CORE_PROPS,"xmlns:dc":uo.dc,"xmlns:dcterms":uo.dcterms,"xmlns:dcmitype":uo.dcmitype,"xmlns:xsi":uo.xsi})],c={};if(!t&&!a.Props)return s.join("");t&&(t.CreatedDate!=null&&hS("dcterms:created",typeof t.CreatedDate=="string"?t.CreatedDate:PC(t.CreatedDate,a.WTF),{"xsi:type":"dcterms:W3CDTF"},s,c),t.ModifiedDate!=null&&hS("dcterms:modified",typeof t.ModifiedDate=="string"?t.ModifiedDate:PC(t.ModifiedDate,a.WTF),{"xsi:type":"dcterms:W3CDTF"},s,c));for(var f=0;f!=Ml.length;++f){var d=Ml[f],p=a.Props&&a.Props[d[1]]!=null?a.Props[d[1]]:t?t[d[1]]:null;p===!0?p="1":p===!1?p="0":typeof p=="number"&&(p=String(p)),p!=null&&hS(d[0],p,null,s,c)}return s.length>2&&(s[s.length]="</cp:coreProperties>",s[1]=s[1].replace("/>",">")),s.join("")}var Ud=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],d9=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function p9(t,n,a,s){var c=[];if(typeof t=="string")c=Z5(t,s);else for(var f=0;f<t.length;++f)c=c.concat(t[f].map(function(b){return{v:b}}));var d=typeof n=="string"?Z5(n,s).map(function(b){return b.v}):n,p=0,g=0;if(d.length>0)for(var y=0;y!==c.length;y+=2){switch(g=+c[y+1].v,c[y].v){case"Worksheets":case"工作表":case"Листы":case"أوراق العمل":case"ワークシート":case"גליונות עבודה":case"Arbeitsblätter":case"Çalışma Sayfaları":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de cálculo":case"Planilhas":case"Regneark":case"Hojas de cálculo":case"Werkbladen":a.Worksheets=g,a.SheetNames=d.slice(p,p+g);break;case"Named Ranges":case"Rangos con nombre":case"名前付き一覧":case"Benannte Bereiche":case"Navngivne områder":a.NamedRanges=g,a.DefinedNames=d.slice(p,p+g);break;case"Charts":case"Diagramme":a.Chartsheets=g,a.ChartNames=d.slice(p,p+g);break}p+=g}}function Eye(t,n,a){var s={};return n||(n={}),t=Ki(t),Ud.forEach(function(c){var f=(t.match(G_(c[0]))||[])[1];switch(c[2]){case"string":f&&(n[c[1]]=bi(f));break;case"bool":n[c[1]]=f==="true";break;case"raw":var d=t.match(new RegExp("<"+c[0]+"[^>]*>([\\s\\S]*?)</"+c[0]+">"));d&&d.length>0&&(s[c[1]]=d[1]);break}}),s.HeadingPairs&&s.TitlesOfParts&&p9(s.HeadingPairs,s.TitlesOfParts,n,a),n}function m9(t){var n=[],a=Er;return t||(t={}),t.Application="SheetJS",n[n.length]=Wa,n[n.length]=Er("Properties",null,{xmlns:uo.EXT_PROPS,"xmlns:vt":uo.vt}),Ud.forEach(function(s){if(t[s[1]]!==void 0){var c;switch(s[2]){case"string":c=Yn(String(t[s[1]]));break;case"bool":c=t[s[1]]?"true":"false";break}c!==void 0&&(n[n.length]=a(s[0],c))}}),n[n.length]=a("HeadingPairs",a("vt:vector",a("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+a("vt:variant",a("vt:i4",String(t.Worksheets))),{size:2,baseType:"variant"})),n[n.length]=a("TitlesOfParts",a("vt:vector",t.SheetNames.map(function(s){return"<vt:lpstr>"+Yn(s)+"</vt:lpstr>"}).join(""),{size:t.Worksheets,baseType:"lpstr"})),n.length>2&&(n[n.length]="</Properties>",n[1]=n[1].replace("/>",">")),n.join("")}var Tye=/<[^>]+>[^<]*/g;function Sye(t,n){var a={},s="",c=t.match(Tye);if(c)for(var f=0;f!=c.length;++f){var d=c[f],p=Kr(d);switch(Dl(p[0])){case"<?xml":break;case"<Properties":break;case"<property":s=bi(p.name);break;case"</property>":s=null;break;default:if(d.indexOf("<vt:")===0){var g=d.split(">"),y=g[0].slice(4),b=g[1];switch(y){case"lpstr":case"bstr":case"lpwstr":a[s]=bi(b);break;case"bool":a[s]=ji(b);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":a[s]=parseInt(b,10);break;case"r4":case"r8":case"decimal":a[s]=parseFloat(b);break;case"filetime":case"date":a[s]=Fa(b);break;case"cy":case"error":a[s]=bi(b);break;default:if(y.slice(-1)=="/")break;n.WTF&&typeof console<"u"&&console.warn("Unexpected",d,y,g)}}else if(d.slice(0,2)!=="</"){if(n.WTF)throw new Error(d)}}}return a}function g9(t){var n=[Wa,Er("Properties",null,{xmlns:uo.CUST_PROPS,"xmlns:vt":uo.vt})];if(!t)return n.join("");var a=1;return Ma(t).forEach(function(c){++a,n[n.length]=Er("property",R1e(t[c],!0),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:a,name:Yn(c)})}),n.length>2&&(n[n.length]="</Properties>",n[1]=n[1].replace("/>",">")),n.join("")}var BC={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},dS;function Cye(t,n,a){dS||(dS=iw(BC)),n=dS[n]||n,t[n]=a}function Aye(t,n){var a=[];return Ma(BC).map(function(s){for(var c=0;c<Ml.length;++c)if(Ml[c][1]==s)return Ml[c];for(c=0;c<Ud.length;++c)if(Ud[c][1]==s)return Ud[c];throw s}).forEach(function(s){if(t[s[1]]!=null){var c=n&&n.Props&&n.Props[s[1]]!=null?n.Props[s[1]]:t[s[1]];switch(s[2]){case"date":c=new Date(c).toISOString().replace(/\.\d*Z/,"Z");break}typeof c=="number"?c=String(c):c===!0||c===!1?c=c?"1":"0":c instanceof Date&&(c=new Date(c).toISOString().replace(/\.\d*Z/,"")),a.push(Co(BC[s[1]]||s[1],c))}}),Er("DocumentProperties",a.join(""),{xmlns:nl.o})}function kye(t,n){var a=["Worksheets","SheetNames"],s="CustomDocumentProperties",c=[];return t&&Ma(t).forEach(function(f){if(Object.prototype.hasOwnProperty.call(t,f)){for(var d=0;d<Ml.length;++d)if(f==Ml[d][1])return;for(d=0;d<Ud.length;++d)if(f==Ud[d][1])return;for(d=0;d<a.length;++d)if(f==a[d])return;var p=t[f],g="string";typeof p=="number"?(g="float",p=String(p)):p===!0||p===!1?(g="boolean",p=p?"1":"0"):p=String(p),c.push(Er(H5(f),p,{"dt:dt":g}))}}),n&&Ma(n).forEach(function(f){if(Object.prototype.hasOwnProperty.call(n,f)&&!(t&&Object.prototype.hasOwnProperty.call(t,f))){var d=n[f],p="string";typeof d=="number"?(p="float",d=String(d)):d===!0||d===!1?(p="boolean",d=d?"1":"0"):d instanceof Date?(p="dateTime.tz",d=d.toISOString()):d=String(d),c.push(Er(H5(f),d,{"dt:dt":p}))}}),"<"+s+' xmlns="'+nl.o+'">'+c.join("")+"</"+s+">"}function Nk(t){var n=t.read_shift(4),a=t.read_shift(4);return new Date((a/1e7*Math.pow(2,32)+n/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function Iye(t){var n=typeof t=="string"?new Date(Date.parse(t)):t,a=n.getTime()/1e3+11644473600,s=a%Math.pow(2,32),c=(a-s)/Math.pow(2,32);s*=1e7,c*=1e7;var f=s/Math.pow(2,32)|0;f>0&&(s=s%Math.pow(2,32),c+=f);var d=zt(8);return d.write_shift(4,s),d.write_shift(4,c),d}function _9(t,n,a){var s=t.l,c=t.read_shift(0,"lpstr-cp");if(a)for(;t.l-s&3;)++t.l;return c}function v9(t,n,a){var s=t.read_shift(0,"lpwstr");return a&&(t.l+=4-(s.length+1&3)&3),s}function y9(t,n,a){return n===31?v9(t):_9(t,n,a)}function zC(t,n,a){return y9(t,n,a===!1?0:4)}function Mye(t,n){if(!n)throw new Error("VtUnalignedString must have positive length");return y9(t,n,0)}function Fye(t){for(var n=t.read_shift(4),a=[],s=0;s!=n;++s){var c=t.l;a[s]=t.read_shift(0,"lpwstr").replace(Ho,""),t.l-c&2&&(t.l+=2)}return a}function Pye(t){for(var n=t.read_shift(4),a=[],s=0;s!=n;++s)a[s]=t.read_shift(0,"lpstr-cp").replace(Ho,"");return a}function Oye(t){var n=t.l,a=fb(t,l9);t[t.l]==0&&t[t.l+1]==0&&t.l-n&2&&(t.l+=2);var s=fb(t,Os);return[a,s]}function Rye(t){for(var n=t.read_shift(4),a=[],s=0;s<n/2;++s)a.push(Oye(t));return a}function o6(t,n){for(var a=t.read_shift(4),s={},c=0;c!=a;++c){var f=t.read_shift(4),d=t.read_shift(4);s[f]=t.read_shift(d,n===1200?"utf16le":"utf8").replace(Ho,"").replace(qg,"!"),n===1200&&d%2&&(t.l+=2)}return t.l&3&&(t.l=t.l>>2+1<<2),s}function x9(t){var n=t.read_shift(4),a=t.slice(t.l,t.l+n);return t.l+=n,(n&3)>0&&(t.l+=4-(n&3)&3),a}function Lye(t){var n={};return n.Size=t.read_shift(4),t.l+=n.Size+3-(n.Size-1)%4,n}function fb(t,n,a){var s=t.read_shift(2),c,f=a||{};if(t.l+=2,n!==n6&&s!==n&&hye.indexOf(n)===-1&&!((n&65534)==4126&&(s&65534)==4126))throw new Error("Expected type "+n+" saw "+s);switch(n===n6?s:n){case 2:return c=t.read_shift(2,"i"),f.raw||(t.l+=2),c;case 3:return c=t.read_shift(4,"i"),c;case 11:return t.read_shift(4)!==0;case 19:return c=t.read_shift(4),c;case 30:return _9(t,s,4).replace(Ho,"");case 31:return v9(t);case 64:return Nk(t);case 65:return x9(t);case 71:return Lye(t);case 80:return zC(t,s,!f.raw).replace(Ho,"");case 81:return Mye(t,s).replace(Ho,"");case 4108:return Rye(t);case 4126:case 4127:return s==4127?Fye(t):Pye(t);default:throw new Error("TypedPropertyValue unrecognized type "+n+" "+s)}}function s6(t,n){var a=zt(4),s=zt(4);switch(a.write_shift(4,t==80?31:t),t){case 3:s.write_shift(-4,n);break;case 5:s=zt(8),s.write_shift(8,n,"f");break;case 11:s.write_shift(4,n?1:0);break;case 64:s=Iye(n);break;case 31:case 80:for(s=zt(4+2*(n.length+1)+(n.length%2?0:2)),s.write_shift(4,n.length+1),s.write_shift(0,n,"dbcs");s.l!=s.length;)s.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}return Va([a,s])}function l6(t,n){var a=t.l,s=t.read_shift(4),c=t.read_shift(4),f=[],d=0,p=0,g=-1,y={};for(d=0;d!=c;++d){var b=t.read_shift(4),E=t.read_shift(4);f[d]=[b,E+a]}f.sort(function(L,O){return L[1]-O[1]});var T={};for(d=0;d!=c;++d){if(t.l!==f[d][1]){var S=!0;if(d>0&&n)switch(n[f[d-1][0]].t){case 2:t.l+2===f[d][1]&&(t.l+=2,S=!1);break;case 80:t.l<=f[d][1]&&(t.l=f[d][1],S=!1);break;case 4108:t.l<=f[d][1]&&(t.l=f[d][1],S=!1);break}if((!n||d==0)&&t.l<=f[d][1]&&(S=!1,t.l=f[d][1]),S)throw new Error("Read Error: Expected address "+f[d][1]+" at "+t.l+" :"+d)}if(n){if(f[d][0]==0&&f.length>d+1&&f[d][1]==f[d+1][1])continue;var I=n[f[d][0]];if(T[I.n]=fb(t,I.t,{raw:!0}),I.p==="version"&&(T[I.n]=String(T[I.n]>>16)+"."+("0000"+String(T[I.n]&65535)).slice(-4)),I.n=="CodePage")switch(T[I.n]){case 0:T[I.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Al(p=T[I.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+T[I.n])}}else if(f[d][0]===1){if(p=T.CodePage=fb(t,Lk),Al(p),g!==-1){var A=t.l;t.l=f[g][1],y=o6(t,p),t.l=A}}else if(f[d][0]===0){if(p===0){g=d,t.l=f[d+1][1];continue}y=o6(t,p)}else{var M=y[f[d][0]],F;switch(t[t.l]){case 65:t.l+=4,F=x9(t);break;case 30:t.l+=4,F=zC(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 31:t.l+=4,F=zC(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 3:t.l+=4,F=t.read_shift(4,"i");break;case 19:t.l+=4,F=t.read_shift(4);break;case 5:t.l+=4,F=t.read_shift(8,"f");break;case 11:t.l+=4,F=$a(t,4);break;case 64:t.l+=4,F=Fa(Nk(t));break;default:throw new Error("unparsed value: "+t[t.l])}T[M]=F}}return t.l=a+s,T}var b9=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function Dye(t){switch(typeof t){case"boolean":return 11;case"number":return(t|0)==t?3:5;case"string":return 31;case"object":if(t instanceof Date)return 64;break}return-1}function c6(t,n,a){var s=zt(8),c=[],f=[],d=8,p=0,g=zt(8),y=zt(8);if(g.write_shift(4,2),g.write_shift(4,1200),y.write_shift(4,1),f.push(g),c.push(y),d+=8+g.length,!n){y=zt(8),y.write_shift(4,0),c.unshift(y);var b=[zt(4)];for(b[0].write_shift(4,t.length),p=0;p<t.length;++p){var E=t[p][0];for(g=zt(4+4+2*(E.length+1)+(E.length%2?0:2)),g.write_shift(4,p+2),g.write_shift(4,E.length+1),g.write_shift(0,E,"dbcs");g.l!=g.length;)g.write_shift(1,0);b.push(g)}g=Va(b),f.unshift(g),d+=8+g.length}for(p=0;p<t.length;++p)if(!(n&&!n[t[p][0]])&&!(b9.indexOf(t[p][0])>-1||d9.indexOf(t[p][0])>-1)&&t[p][1]!=null){var T=t[p][1],S=0;if(n){S=+n[t[p][0]];var I=a[S];if(I.p=="version"&&typeof T=="string"){var A=T.split(".");T=(+A[0]<<16)+(+A[1]||0)}g=s6(I.t,T)}else{var M=Dye(T);M==-1&&(M=31,T=String(T)),g=s6(M,T)}f.push(g),y=zt(8),y.write_shift(4,n?S:2+p),c.push(y),d+=8+g.length}var F=8*(f.length+1);for(p=0;p<f.length;++p)c[p].write_shift(4,F),F+=f[p].length;return s.write_shift(4,d),s.write_shift(4,f.length),Va([s].concat(c).concat(f))}function u6(t,n,a){var s=t.content;if(!s)return{};so(s,0);var c,f,d,p,g=0;s.chk("feff","Byte Order: "),s.read_shift(2);var y=s.read_shift(4),b=s.read_shift(16);if(b!==_n.utils.consts.HEADER_CLSID&&b!==a)throw new Error("Bad PropertySet CLSID "+b);if(c=s.read_shift(4),c!==1&&c!==2)throw new Error("Unrecognized #Sets: "+c);if(f=s.read_shift(16),p=s.read_shift(4),c===1&&p!==s.l)throw new Error("Length mismatch: "+p+" !== "+s.l);c===2&&(d=s.read_shift(16),g=s.read_shift(4));var E=l6(s,n),T={SystemIdentifier:y};for(var S in E)T[S]=E[S];if(T.FMTID=f,c===1)return T;if(g-s.l==2&&(s.l+=2),s.l!==g)throw new Error("Length mismatch 2: "+s.l+" !== "+g);var I;try{I=l6(s,null)}catch{}for(S in I)T[S]=I[S];return T.FMTID=[f,d],T}function f6(t,n,a,s,c,f){var d=zt(c?68:48),p=[d];d.write_shift(2,65534),d.write_shift(2,0),d.write_shift(4,842412599),d.write_shift(16,_n.utils.consts.HEADER_CLSID,"hex"),d.write_shift(4,c?2:1),d.write_shift(16,n,"hex"),d.write_shift(4,c?68:48);var g=c6(t,a,s);if(p.push(g),c){var y=c6(c,null,null);d.write_shift(16,f,"hex"),d.write_shift(4,68+g.length),p.push(y)}return Va(p)}function ih(t,n){return t.read_shift(n),null}function Bye(t,n){n||(n=zt(t));for(var a=0;a<t;++a)n.write_shift(1,0);return n}function zye(t,n,a){for(var s=[],c=t.l+n;t.l<c;)s.push(a(t,c-t.l));if(c!==t.l)throw new Error("Slurp error");return s}function $a(t,n){return t.read_shift(n)===1}function Do(t,n){return n||(n=zt(2)),n.write_shift(2,+!!t),n}function Ba(t){return t.read_shift(2,"u")}function Sl(t,n){return n||(n=zt(2)),n.write_shift(2,t),n}function w9(t,n){return zye(t,n,Ba)}function E9(t){var n=t.read_shift(1),a=t.read_shift(1);return a===1?n:n===1}function T9(t,n,a){return a||(a=zt(2)),a.write_shift(1,n=="e"?+t:+!!t),a.write_shift(1,n=="e"?1:0),a}function am(t,n,a){var s=t.read_shift(a&&a.biff>=12?2:1),c="sbcs-cont",f=co;if(a&&a.biff>=8&&(co=1200),!a||a.biff==8){var d=t.read_shift(1);d&&(c="dbcs-cont")}else a.biff==12&&(c="wstr");a.biff>=2&&a.biff<=5&&(c="cpstr");var p=s?t.read_shift(s,c):"";return co=f,p}function Nye(t){var n=co;co=1200;var a=t.read_shift(2),s=t.read_shift(1),c=s&4,f=s&8,d=1+(s&1),p=0,g,y={};f&&(p=t.read_shift(2)),c&&(g=t.read_shift(4));var b=d==2?"dbcs-cont":"sbcs-cont",E=a===0?"":t.read_shift(a,b);return f&&(t.l+=4*p),c&&(t.l+=g),y.t=E,f||(y.raw="<t>"+y.t+"</t>",y.r=y.t),co=n,y}function Uye(t){var n=t.t||"",a=zt(3+0);a.write_shift(2,n.length),a.write_shift(1,1);var s=zt(2*n.length);s.write_shift(2*n.length,n,"utf16le");var c=[a,s];return Va(c)}function Qd(t,n,a){var s;if(a){if(a.biff>=2&&a.biff<=5)return t.read_shift(n,"cpstr");if(a.biff>=12)return t.read_shift(n,"dbcs-cont")}var c=t.read_shift(1);return c===0?s=t.read_shift(n,"sbcs-cont"):s=t.read_shift(n,"dbcs-cont"),s}function Tv(t,n,a){var s=t.read_shift(a&&a.biff==2?1:2);return s===0?(t.l++,""):Qd(t,s,a)}function dp(t,n,a){if(a.biff>5)return Tv(t,n,a);var s=t.read_shift(1);return s===0?(t.l++,""):t.read_shift(s,a.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function S9(t,n,a){return a||(a=zt(3+2*t.length)),a.write_shift(2,t.length),a.write_shift(1,1),a.write_shift(31,t,"utf16le"),a}function $ye(t){var n=t.read_shift(1);t.l++;var a=t.read_shift(2);return t.l+=2,[n,a]}function Vye(t){var n=t.read_shift(4),a=t.l,s=!1;n>24&&(t.l+=n-24,t.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(s=!0),t.l=a);var c=t.read_shift((s?n-24:n)>>1,"utf16le").replace(Ho,"");return s&&(t.l+=24),c}function jye(t){for(var n=t.read_shift(2),a="";n-- >0;)a+="../";var s=t.read_shift(0,"lpstr-ansi");if(t.l+=2,t.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var c=t.read_shift(4);if(c===0)return a+s.replace(/\\/g,"/");var f=t.read_shift(4);if(t.read_shift(2)!=3)throw new Error("Bad FileMoniker");var d=t.read_shift(f>>1,"utf16le").replace(Ho,"");return a+d}function Wye(t,n){var a=t.read_shift(16);switch(a){case"e0c9ea79f9bace118c8200aa004ba90b":return Vye(t);case"0303000000000000c000000000000046":return jye(t);default:throw new Error("Unsupported Moniker "+a)}}function sx(t){var n=t.read_shift(4),a=n>0?t.read_shift(n,"utf16le").replace(Ho,""):"";return a}function h6(t,n){n||(n=zt(6+t.length*2)),n.write_shift(4,1+t.length);for(var a=0;a<t.length;++a)n.write_shift(2,t.charCodeAt(a));return n.write_shift(2,0),n}function Hye(t,n){var a=t.l+n,s=t.read_shift(4);if(s!==2)throw new Error("Unrecognized streamVersion: "+s);var c=t.read_shift(2);t.l+=2;var f,d,p,g,y="",b,E;c&16&&(f=sx(t,a-t.l)),c&128&&(d=sx(t,a-t.l)),(c&257)===257&&(p=sx(t,a-t.l)),(c&257)===1&&(g=Wye(t,a-t.l)),c&8&&(y=sx(t,a-t.l)),c&32&&(b=t.read_shift(16)),c&64&&(E=Nk(t)),t.l=a;var T=d||p||g||"";T&&y&&(T+="#"+y),T||(T="#"+y),c&2&&T.charAt(0)=="/"&&T.charAt(1)!="/"&&(T="file://"+T);var S={Target:T};return b&&(S.guid=b),E&&(S.time=E),f&&(S.Tooltip=f),S}function Gye(t){var n=zt(512),a=0,s=t.Target;s.slice(0,7)=="file://"&&(s=s.slice(7));var c=s.indexOf("#"),f=c>-1?31:23;switch(s.charAt(0)){case"#":f=28;break;case".":f&=-3;break}n.write_shift(4,2),n.write_shift(4,f);var d=[8,6815827,6619237,4849780,83];for(a=0;a<d.length;++a)n.write_shift(4,d[a]);if(f==28)s=s.slice(1),h6(s,n);else if(f&2){for(d="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),a=0;a<d.length;++a)n.write_shift(1,parseInt(d[a],16));var p=c>-1?s.slice(0,c):s;for(n.write_shift(4,2*(p.length+1)),a=0;a<p.length;++a)n.write_shift(2,p.charCodeAt(a));n.write_shift(2,0),f&8&&h6(c>-1?s.slice(c+1):"",n)}else{for(d="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),a=0;a<d.length;++a)n.write_shift(1,parseInt(d[a],16));for(var g=0;s.slice(g*3,g*3+3)=="../"||s.slice(g*3,g*3+3)=="..\\";)++g;for(n.write_shift(2,g),n.write_shift(4,s.length-3*g+1),a=0;a<s.length-3*g;++a)n.write_shift(1,s.charCodeAt(a+3*g)&255);for(n.write_shift(1,0),n.write_shift(2,65535),n.write_shift(2,57005),a=0;a<6;++a)n.write_shift(4,0)}return n.slice(0,n.l)}function C9(t){var n=t.read_shift(1),a=t.read_shift(1),s=t.read_shift(1),c=t.read_shift(1);return[n,a,s,c]}function A9(t,n){var a=C9(t);return a[3]=0,a}function Tc(t,n,a){var s=t.read_shift(2),c=t.read_shift(2),f={r:s,c,ixfe:0};if(a&&a.biff==2||n==7){var d=t.read_shift(1);f.ixfe=d&63,t.l+=2}else f.ixfe=t.read_shift(2);return f}function ep(t,n,a,s){return s||(s=zt(6)),s.write_shift(2,t),s.write_shift(2,n),s.write_shift(2,a||0),s}function qye(t){var n=t.read_shift(2),a=t.read_shift(2);return t.l+=8,{type:n,flags:a}}function Xye(t,n,a){return n===0?"":dp(t,n,a)}function Zye(t,n,a){var s=a.biff>8?4:2,c=t.read_shift(s),f=t.read_shift(s,"i"),d=t.read_shift(s,"i");return[c,f,d]}function k9(t){var n=t.read_shift(2),a=uw(t);return[n,a]}function Kye(t,n,a){t.l+=4,n-=4;var s=t.l+n,c=am(t,n,a),f=t.read_shift(2);if(s-=t.l,f!==s)throw new Error("Malformed AddinUdf: padding = "+s+" != "+f);return t.l+=f,c}function fw(t){var n=t.read_shift(2),a=t.read_shift(2),s=t.read_shift(2),c=t.read_shift(2);return{s:{c:s,r:n},e:{c,r:a}}}function I9(t,n){return n||(n=zt(8)),n.write_shift(2,t.s.r),n.write_shift(2,t.e.r),n.write_shift(2,t.s.c),n.write_shift(2,t.e.c),n}function M9(t){var n=t.read_shift(2),a=t.read_shift(2),s=t.read_shift(1),c=t.read_shift(1);return{s:{c:s,r:n},e:{c,r:a}}}var Yye=M9;function F9(t){t.l+=4;var n=t.read_shift(2),a=t.read_shift(2),s=t.read_shift(2);return t.l+=12,[a,n,s]}function Jye(t){var n={};return t.l+=4,t.l+=16,n.fSharedNote=t.read_shift(2),t.l+=4,n}function Qye(t){var n={};return t.l+=4,t.cf=t.read_shift(2),n}function Oo(t){t.l+=2,t.l+=t.read_shift(2)}var exe={0:Oo,4:Oo,5:Oo,6:Oo,7:Qye,8:Oo,9:Oo,10:Oo,11:Oo,12:Oo,13:Jye,14:Oo,15:Oo,16:Oo,17:Oo,18:Oo,19:Oo,20:Oo,21:F9};function txe(t,n){for(var a=t.l+n,s=[];t.l<a;){var c=t.read_shift(2);t.l-=2;try{s[c]=exe[c](t,a-t.l)}catch{return t.l=a,s}}return t.l!=a&&(t.l=a),s}function lx(t,n){var a={BIFFVer:0,dt:0};switch(a.BIFFVer=t.read_shift(2),n-=2,n>=2&&(a.dt=t.read_shift(2),t.l-=2),a.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(n>6)throw new Error("Unexpected BIFF Ver "+a.BIFFVer)}return t.read_shift(n),a}function Uk(t,n,a){var s=1536,c=16;switch(a.bookType){case"biff8":break;case"biff5":s=1280,c=8;break;case"biff4":s=4,c=6;break;case"biff3":s=3,c=6;break;case"biff2":s=2,c=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var f=zt(c);return f.write_shift(2,s),f.write_shift(2,n),c>4&&f.write_shift(2,29282),c>6&&f.write_shift(2,1997),c>8&&(f.write_shift(2,49161),f.write_shift(2,1),f.write_shift(2,1798),f.write_shift(2,0)),f}function rxe(t,n){return n===0||t.read_shift(2),1200}function nxe(t,n,a){if(a.enc)return t.l+=n,"";var s=t.l,c=dp(t,0,a);return t.read_shift(n+s-t.l),c}function ixe(t,n){var a=!n||n.biff==8,s=zt(a?112:54);for(s.write_shift(n.biff==8?2:1,7),a&&s.write_shift(1,0),s.write_shift(4,859007059),s.write_shift(4,5458548|(a?0:536870912));s.l<s.length;)s.write_shift(1,a?0:32);return s}function axe(t,n,a){var s=a&&a.biff==8||n==2?t.read_shift(2):(t.l+=n,0);return{fDialog:s&16,fBelow:s&64,fRight:s&128}}function oxe(t,n,a){var s="";if(a.biff==4)return s=am(t,0,a),s.length===0&&(s="Sheet1"),{name:s};var c=t.read_shift(4),f=t.read_shift(1)&3,d=t.read_shift(1);switch(d){case 0:d="Worksheet";break;case 1:d="Macrosheet";break;case 2:d="Chartsheet";break;case 6:d="VBAModule";break}return s=am(t,0,a),s.length===0&&(s="Sheet1"),{pos:c,hs:f,dt:d,name:s}}function sxe(t,n){var a=!n||n.biff>=8?2:1,s=zt(8+a*t.name.length);s.write_shift(4,t.pos),s.write_shift(1,t.hs||0),s.write_shift(1,t.dt),s.write_shift(1,t.name.length),n.biff>=8&&s.write_shift(1,1),s.write_shift(a*t.name.length,t.name,n.biff<8?"sbcs":"utf16le");var c=s.slice(0,s.l);return c.l=s.l,c}function lxe(t,n){for(var a=t.l+n,s=t.read_shift(4),c=t.read_shift(4),f=[],d=0;d!=c&&t.l<a;++d)f.push(Nye(t));return f.Count=s,f.Unique=c,f}function cxe(t,n){var a=zt(8);a.write_shift(4,t.Count),a.write_shift(4,t.Unique);for(var s=[],c=0;c<t.length;++c)s[c]=Uye(t[c]);var f=Va([a].concat(s));return f.parts=[a.length].concat(s.map(function(d){return d.length})),f}function uxe(t,n){var a={};return a.dsst=t.read_shift(2),t.l+=n-2,a}function fxe(t){var n={};n.r=t.read_shift(2),n.c=t.read_shift(2),n.cnt=t.read_shift(2)-n.c;var a=t.read_shift(2);t.l+=4;var s=t.read_shift(1);return t.l+=3,s&7&&(n.level=s&7),s&32&&(n.hidden=!0),s&64&&(n.hpt=a/20),n}function hxe(t){var n=qye(t);if(n.type!=2211)throw new Error("Invalid Future Record "+n.type);var a=t.read_shift(4);return a!==0}function dxe(t){return t.read_shift(2),t.read_shift(4)}function d6(t,n,a){var s=0;a&&a.biff==2||(s=t.read_shift(2));var c=t.read_shift(2);a&&a.biff==2&&(s=1-(c>>15),c&=32767);var f={Unsynced:s&1,DyZero:(s&2)>>1,ExAsc:(s&4)>>2,ExDsc:(s&8)>>3};return[f,c]}function pxe(t){var n=t.read_shift(2),a=t.read_shift(2),s=t.read_shift(2),c=t.read_shift(2),f=t.read_shift(2),d=t.read_shift(2),p=t.read_shift(2),g=t.read_shift(2),y=t.read_shift(2);return{Pos:[n,a],Dim:[s,c],Flags:f,CurTab:d,FirstTab:p,Selected:g,TabRatio:y}}function mxe(){var t=zt(18);return t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,29280),t.write_shift(2,17600),t.write_shift(2,56),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,1),t.write_shift(2,500),t}function gxe(t,n,a){if(a&&a.biff>=2&&a.biff<5)return{};var s=t.read_shift(2);return{RTL:s&64}}function _xe(t){var n=zt(18),a=1718;return t&&t.RTL&&(a|=64),n.write_shift(2,a),n.write_shift(4,0),n.write_shift(4,64),n.write_shift(4,0),n.write_shift(4,0),n}function vxe(){}function yxe(t,n,a){var s={dyHeight:t.read_shift(2),fl:t.read_shift(2)};switch(a&&a.biff||8){case 2:break;case 3:case 4:t.l+=2;break;default:t.l+=10;break}return s.name=am(t,0,a),s}function xxe(t,n){var a=t.name||"Arial",s=n&&n.biff==5,c=s?15+a.length:16+2*a.length,f=zt(c);return f.write_shift(2,(t.sz||12)*20),f.write_shift(4,0),f.write_shift(2,400),f.write_shift(4,0),f.write_shift(2,0),f.write_shift(1,a.length),s||f.write_shift(1,1),f.write_shift((s?1:2)*a.length,a,s?"sbcs":"utf16le"),f}function bxe(t,n,a){var s=Tc(t,n,a);return s.isst=t.read_shift(4),s}function wxe(t,n,a,s){var c=zt(10);return ep(t,n,s,c),c.write_shift(4,a),c}function Exe(t,n,a){a.biffguess&&a.biff==2&&(a.biff=5);var s=t.l+n,c=Tc(t,n,a),f=Tv(t,s-t.l,a);return c.val=f,c}function Txe(t,n,a,s,c){var f=!c||c.biff==8,d=zt(6+2+ +f+(1+f)*a.length);return ep(t,n,s,d),d.write_shift(2,a.length),f&&d.write_shift(1,1),d.write_shift((1+f)*a.length,a,f?"utf16le":"sbcs"),d}function Sxe(t,n,a){var s=t.read_shift(2),c=dp(t,0,a);return[s,c]}function Cxe(t,n,a,s){var c=a&&a.biff==5;s||(s=zt(c?3+n.length:5+2*n.length)),s.write_shift(2,t),s.write_shift(c?1:2,n.length),c||s.write_shift(1,1),s.write_shift((c?1:2)*n.length,n,c?"sbcs":"utf16le");var f=s.length>s.l?s.slice(0,s.l):s;return f.l==null&&(f.l=f.length),f}var Axe=dp;function kxe(t){var n=zt(1+t.length);return n.write_shift(1,t.length),n.write_shift(t.length,t,"sbcs"),n}function Ixe(t){var n=zt(3+t.length);return n.l+=2,n.write_shift(1,t.length),n.write_shift(t.length,t,"sbcs"),n}function p6(t,n,a){var s=t.l+n,c=a.biff==8||!a.biff?4:2,f=t.read_shift(c),d=t.read_shift(c),p=t.read_shift(2),g=t.read_shift(2);return t.l=s,{s:{r:f,c:p},e:{r:d,c:g}}}function Mxe(t,n){var a=n.biff==8||!n.biff?4:2,s=zt(2*a+6);return s.write_shift(a,t.s.r),s.write_shift(a,t.e.r+1),s.write_shift(2,t.s.c),s.write_shift(2,t.e.c+1),s.write_shift(2,0),s}function Fxe(t){var n=t.read_shift(2),a=t.read_shift(2),s=k9(t);return{r:n,c:a,ixfe:s[0],rknum:s[1]}}function Pxe(t,n){for(var a=t.l+n-2,s=t.read_shift(2),c=t.read_shift(2),f=[];t.l<a;)f.push(k9(t));if(t.l!==a)throw new Error("MulRK read error");var d=t.read_shift(2);if(f.length!=d-c+1)throw new Error("MulRK length mismatch");return{r:s,c,C:d,rkrec:f}}function Oxe(t,n){for(var a=t.l+n-2,s=t.read_shift(2),c=t.read_shift(2),f=[];t.l<a;)f.push(t.read_shift(2));if(t.l!==a)throw new Error("MulBlank read error");var d=t.read_shift(2);if(f.length!=d-c+1)throw new Error("MulBlank length mismatch");return{r:s,c,C:d,ixfe:f}}function Rxe(t,n,a,s){var c={},f=t.read_shift(4),d=t.read_shift(4),p=t.read_shift(4),g=t.read_shift(2);return c.patternType=dye[p>>26],s.cellStyles&&(c.alc=f&7,c.fWrap=f>>3&1,c.alcV=f>>4&7,c.fJustLast=f>>7&1,c.trot=f>>8&255,c.cIndent=f>>16&15,c.fShrinkToFit=f>>20&1,c.iReadOrder=f>>22&2,c.fAtrNum=f>>26&1,c.fAtrFnt=f>>27&1,c.fAtrAlc=f>>28&1,c.fAtrBdr=f>>29&1,c.fAtrPat=f>>30&1,c.fAtrProt=f>>31&1,c.dgLeft=d&15,c.dgRight=d>>4&15,c.dgTop=d>>8&15,c.dgBottom=d>>12&15,c.icvLeft=d>>16&127,c.icvRight=d>>23&127,c.grbitDiag=d>>30&3,c.icvTop=p&127,c.icvBottom=p>>7&127,c.icvDiag=p>>14&127,c.dgDiag=p>>21&15,c.icvFore=g&127,c.icvBack=g>>7&127,c.fsxButton=g>>14&1),c}function Lxe(t,n,a){var s={};return s.ifnt=t.read_shift(2),s.numFmtId=t.read_shift(2),s.flags=t.read_shift(2),s.fStyle=s.flags>>2&1,n-=6,s.data=Rxe(t,n,s.fStyle,a),s}function m6(t,n,a,s){var c=a&&a.biff==5;s||(s=zt(c?16:20)),s.write_shift(2,0),t.style?(s.write_shift(2,t.numFmtId||0),s.write_shift(2,65524)):(s.write_shift(2,t.numFmtId||0),s.write_shift(2,n<<4));var f=0;return t.numFmtId>0&&c&&(f|=1024),s.write_shift(4,f),s.write_shift(4,0),c||s.write_shift(4,0),s.write_shift(2,0),s}function Dxe(t){var n={};return n.ifnt=t.read_shift(1),t.l++,n.flags=t.read_shift(1),n.numFmtId=n.flags&63,n.flags>>=6,n.fStyle=0,n.data={},n}function Bxe(t){var n=zt(4);return n.l+=2,n.write_shift(1,t.numFmtId),n.l++,n}function P9(t){var n=zt(12);return n.l++,n.write_shift(1,t.numFmtId),n.l+=10,n}var zxe=P9;function Nxe(t){var n={};return n.ifnt=t.read_shift(1),n.numFmtId=t.read_shift(1),n.flags=t.read_shift(2),n.fStyle=n.flags>>2&1,n.data={},n}function Uxe(t){var n={};return n.ifnt=t.read_shift(1),n.numFmtId=t.read_shift(1),n.flags=t.read_shift(2),n.fStyle=n.flags>>2&1,n.data={},n}function $xe(t){t.l+=4;var n=[t.read_shift(2),t.read_shift(2)];if(n[0]!==0&&n[0]--,n[1]!==0&&n[1]--,n[0]>7||n[1]>7)throw new Error("Bad Gutters: "+n.join("|"));return n}function Vxe(t){var n=zt(8);return n.write_shift(4,0),n.write_shift(2,t[0]?t[0]+1:0),n.write_shift(2,t[1]?t[1]+1:0),n}function jxe(t,n,a){var s=Tc(t,6,a),c=E9(t);return s.val=c,s.t=c===!0||c===!1?"b":"e",s}function pS(t,n,a,s,c,f){var d=zt(8);return ep(t,n,s,d),T9(a,f,d),d}function Wxe(t,n,a){a.biffguess&&a.biff==2&&(a.biff=5);var s=Tc(t,6,a),c=Vo(t);return s.val=c,s}function Hxe(t,n,a,s){var c=zt(14);return ep(t,n,s,c),Jd(a,c),c}var g6=Xye;function Gxe(t,n,a){var s=t.l+n,c=t.read_shift(2),f=t.read_shift(2);if(a.sbcch=f,f==1025||f==14849)return[f,c];if(f<1||f>255)throw new Error("Unexpected SupBook type: "+f);for(var d=Qd(t,f),p=[];s>t.l;)p.push(Tv(t));return[f,c,d,p]}function _6(t,n,a){var s=t.read_shift(2),c,f={fBuiltIn:s&1,fWantAdvise:s>>>1&1,fWantPict:s>>>2&1,fOle:s>>>3&1,fOleLink:s>>>4&1,cf:s>>>5&1023,fIcon:s>>>15&1};return a.sbcch===14849&&(c=Kye(t,n-2,a)),f.body=c||t.read_shift(n-2),typeof c=="string"&&(f.Name=c),f}function v6(t,n,a){var s=t.l+n,c=t.read_shift(2),f=t.read_shift(1),d=t.read_shift(1),p=t.read_shift(a&&a.biff==2?1:2),g=0;(!a||a.biff>=5)&&(a.biff!=5&&(t.l+=2),g=t.read_shift(2),a.biff==5&&(t.l+=2),t.l+=4);var y=Qd(t,d,a);c&32&&(y=Bk[y.charCodeAt(0)]);var b=s-t.l;a&&a.biff==2&&--b;var E=s==t.l||p===0||!(b>0)?[]:mTe(t,b,a,p);return{chKey:f,Name:y,itab:g,rgce:E}}function O9(t,n,a){if(a.biff<8||!(a.biff>8)&&n==t[t.l]+(t[t.l+1]==3?1:0)+1)return y6(t,n,a);for(var s=[],c=t.l+n,f=t.read_shift(a.biff>8?4:2);f--!==0;)s.push(Zye(t,a.biff>8?12:6,a));if(t.l!=c)throw new Error("Bad ExternSheet: "+t.l+" != "+c);return s}function y6(t,n,a){t[t.l+1]==3&&t[t.l]++;var s=am(t,n,a);return s.charCodeAt(0)==3?s.slice(1):s}function qxe(t,n,a){if(a.biff<8){t.l+=n;return}var s=t.read_shift(2),c=t.read_shift(2),f=Qd(t,s,a),d=Qd(t,c,a);return[f,d]}function Xxe(t,n,a){var s=M9(t);t.l++;var c=t.read_shift(1);return n-=8,[gTe(t,n,a),c,s]}function x6(t,n,a){var s=Yye(t);switch(a.biff){case 2:t.l++,n-=7;break;case 3:case 4:t.l+=2,n-=8;break;default:t.l+=6,n-=12}return[s,dTe(t,n,a)]}function Zxe(t){var n=t.read_shift(4)!==0,a=t.read_shift(4)!==0,s=t.read_shift(4);return[n,a,s]}function Kxe(t,n,a){var s=t.read_shift(2),c=t.read_shift(2),f=t.read_shift(2),d=t.read_shift(2),p=dp(t,0,a);return[{r:s,c},p,d,f]}function Yxe(t,n,a){if(a&&a.biff<8){var s=t.read_shift(2),c=t.read_shift(2);if(s==65535||s==-1)return;var f=t.read_shift(2),d=t.read_shift(Math.min(f,2048),"cpstr");return[{r:s,c},d]}return Kxe(t,n,a)}function mS(t,n,a,s){var c=zt(6+(s||t.length));return c.write_shift(2,n),c.write_shift(2,a),c.write_shift(2,s||t.length),c.write_shift(t.length,t,"sbcs"),c}function Jxe(t,n){for(var a=[],s=t.read_shift(2);s--;)a.push(fw(t));return a}function Qxe(t){var n=zt(2+t.length*8);n.write_shift(2,t.length);for(var a=0;a<t.length;++a)I9(t[a],n);return n}function ebe(t,n,a){if(a&&a.biff<8)return rbe(t,n,a);var s=F9(t),c=txe(t,n-22,s[1]);return{cmo:s,ft:c}}var tbe={8:function(t,n){var a=t.l+n;t.l+=10;var s=t.read_shift(2);t.l+=4,t.l+=2,t.l+=2,t.l+=2,t.l+=4;var c=t.read_shift(1);return t.l+=c,t.l=a,{fmt:s}}};function rbe(t,n,a){t.l+=4;var s=t.read_shift(2),c=t.read_shift(2),f=t.read_shift(2);t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=6,n-=36;var d=[];return d.push((tbe[s]||Zo)(t,n,a)),{cmo:[c,s,f],ft:d}}function nbe(t,n,a){var s=t.l,c="";try{t.l+=4;var f=(a.lastobj||{cmo:[0,0]}).cmo[1],d;[0,5,7,11,12,14].indexOf(f)==-1?t.l+=6:d=$ye(t,6,a);var p=t.read_shift(2);t.read_shift(2),Ba(t,2);var g=t.read_shift(2);t.l+=g;for(var y=1;y<t.lens.length-1;++y){if(t.l-s!=t.lens[y])throw new Error("TxO: bad continue record");var b=t[t.l],E=Qd(t,t.lens[y+1]-t.lens[y]-1);if(c+=E,c.length>=(b?p:2*p))break}if(c.length!==p&&c.length!==p*2)throw new Error("cchText: "+p+" != "+c.length);return t.l=s+n,{t:c}}catch{return t.l=s+n,{t:c}}}function ibe(t,n){var a=fw(t);t.l+=16;var s=Hye(t,n-24);return[a,s]}function abe(t){var n=zt(24),a=Yi(t[0]);n.write_shift(2,a.r),n.write_shift(2,a.r),n.write_shift(2,a.c),n.write_shift(2,a.c);for(var s="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),c=0;c<16;++c)n.write_shift(1,parseInt(s[c],16));return Va([n,Gye(t[1])])}function obe(t,n){t.read_shift(2);var a=fw(t),s=t.read_shift((n-10)/2,"dbcs-cont");return s=s.replace(Ho,""),[a,s]}function sbe(t){var n=t[1].Tooltip,a=zt(10+2*(n.length+1));a.write_shift(2,2048);var s=Yi(t[0]);a.write_shift(2,s.r),a.write_shift(2,s.r),a.write_shift(2,s.c),a.write_shift(2,s.c);for(var c=0;c<n.length;++c)a.write_shift(2,n.charCodeAt(c));return a.write_shift(2,0),a}function lbe(t){var n=[0,0],a;return a=t.read_shift(2),n[0]=i6[a]||a,a=t.read_shift(2),n[1]=i6[a]||a,n}function cbe(t){return t||(t=zt(4)),t.write_shift(2,1),t.write_shift(2,1),t}function ube(t){for(var n=t.read_shift(2),a=[];n-- >0;)a.push(A9(t));return a}function fbe(t){for(var n=t.read_shift(2),a=[];n-- >0;)a.push(A9(t));return a}function hbe(t){t.l+=2;var n={cxfs:0,crc:0};return n.cxfs=t.read_shift(2),n.crc=t.read_shift(4),n}function R9(t,n,a){if(!a.cellStyles)return Zo(t,n);var s=a&&a.biff>=12?4:2,c=t.read_shift(s),f=t.read_shift(s),d=t.read_shift(s),p=t.read_shift(s),g=t.read_shift(2);s==2&&(t.l+=2);var y={s:c,e:f,w:d,ixfe:p,flags:g};return(a.biff>=5||!a.biff)&&(y.level=g>>8&7),y}function dbe(t,n){var a=zt(12);a.write_shift(2,n),a.write_shift(2,n),a.write_shift(2,t.width*256),a.write_shift(2,0);var s=0;return t.hidden&&(s|=1),a.write_shift(1,s),s=t.level||0,a.write_shift(1,s),a.write_shift(2,0),a}function pbe(t,n){var a={};return n<32||(t.l+=16,a.header=Vo(t),a.footer=Vo(t),t.l+=2),a}function mbe(t,n,a){var s={area:!1};if(a.biff!=5)return t.l+=n,s;var c=t.read_shift(1);return t.l+=3,c&16&&(s.area=!0),s}function gbe(t){for(var n=zt(2*t),a=0;a<t;++a)n.write_shift(2,a+1);return n}var _be=Tc,vbe=w9,ybe=Tv;function xbe(t){var n=t.read_shift(2),a=t.read_shift(2),s=t.read_shift(4),c={fmt:n,env:a,len:s,data:t.slice(t.l,t.l+s)};return t.l+=s,c}function Sv(t,n,a,s,c){return t||(t=zt(7)),t.write_shift(2,n),t.write_shift(2,a),t.write_shift(1,s||0),t.write_shift(1,c||0),t.write_shift(1,0),t}function bbe(t,n,a){a.biffguess&&a.biff==5&&(a.biff=2);var s=Tc(t,7,a),c=dp(t,n-7,a);return s.t="str",s.val=c,s}function wbe(t,n,a){var s=Tc(t,7,a),c=Vo(t);return s.t="n",s.val=c,s}function Ebe(t,n,a,s,c){var f=zt(15);return Sv(f,t,n,s||0,c||0),f.write_shift(8,a,"f"),f}function Tbe(t,n,a){var s=Tc(t,7,a),c=t.read_shift(2);return s.t="n",s.val=c,s}function Sbe(t,n,a,s,c){var f=zt(9);return Sv(f,t,n,s||0,c||0),f.write_shift(2,a),f}function Cbe(t){var n=t.read_shift(1);return n===0?(t.l++,""):t.read_shift(n,"sbcs-cont")}function Abe(t,n,a){var s=t.l+7,c=Tc(t,6,a);t.l=s;var f=E9(t);return c.val=f,c.t=f===!0||f===!1?"b":"e",c}function kbe(t,n){t.l+=6,t.l+=2,t.l+=1,t.l+=3,t.l+=1,t.l+=n-13}function Ibe(t,n,a){var s=t.l+n,c=Tc(t,6,a),f=t.read_shift(2),d=Qd(t,f,a);return t.l=s,c.t="str",c.val=d,c}function Mbe(t){var n=t.read_shift(4),a=t.read_shift(1),s=t.read_shift(a,"sbcs");return s.length===0&&(s="Sheet1"),{flags:n,name:s}}var Fbe=[2,3,48,49,131,139,140,245],NC=function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},n=iw({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function a(p,g){var y=[],b=Ah(1);switch(g.type){case"base64":b=us(ll(p));break;case"binary":b=us(p);break;case"buffer":case"array":b=p;break}so(b,0);var E=b.read_shift(1),T=!!(E&136),S=!1,I=!1;switch(E){case 2:break;case 3:break;case 48:S=!0,T=!0;break;case 49:S=!0,T=!0;break;case 131:break;case 139:break;case 140:I=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+E.toString(16))}var A=0,M=521;E==2&&(A=b.read_shift(2)),b.l+=3,E!=2&&(A=b.read_shift(4)),A>1048576&&(A=1e6),E!=2&&(M=b.read_shift(2));var F=b.read_shift(2),L=g.codepage||1252;E!=2&&(b.l+=16,b.read_shift(1),b[b.l]!==0&&(L=t[b[b.l]]),b.l+=1,b.l+=2),I&&(b.l+=36);for(var O=[],N={},Q=Math.min(b.length,E==2?521:M-10-(S?264:0)),ie=I?32:11;b.l<Q&&b[b.l]!=13;)switch(N={},N.name=(typeof Jn<"u"?Jn.utils.decode(L,b.slice(b.l,b.l+ie)):su(b.slice(b.l,b.l+ie))).replace(/[\u0000\r\n].*$/g,""),b.l+=ie,N.type=String.fromCharCode(b.read_shift(1)),E!=2&&!I&&(N.offset=b.read_shift(4)),N.len=b.read_shift(1),E==2&&(N.offset=b.read_shift(2)),N.dec=b.read_shift(1),N.name.length&&O.push(N),E!=2&&(b.l+=I?13:14),N.type){case"B":(!S||N.len!=8)&&g.WTF&&console.log("Skipping "+N.name+":"+N.type);break;case"G":case"P":g.WTF&&console.log("Skipping "+N.name+":"+N.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+N.type)}if(b[b.l]!==13&&(b.l=M-1),b.read_shift(1)!==13)throw new Error("DBF Terminator not found "+b.l+" "+b[b.l]);b.l=M;var j=0,V=0;for(y[0]=[],V=0;V!=O.length;++V)y[0][V]=O[V].name;for(;A-- >0;){if(b[b.l]===42){b.l+=F;continue}for(++b.l,y[++j]=[],V=0,V=0;V!=O.length;++V){var D=b.slice(b.l,b.l+O[V].len);b.l+=O[V].len,so(D,0);var te=typeof Jn<"u"?Jn.utils.decode(L,D):su(D);switch(O[V].type){case"C":te.trim().length&&(y[j][V]=te.replace(/\s+$/,""));break;case"D":te.length===8?(y[j][V]=new Date(Date.UTC(+te.slice(0,4),+te.slice(4,6)-1,+te.slice(6,8),0,0,0,0)),g&&g.UTC||(y[j][V]=Yd(y[j][V]))):y[j][V]=te;break;case"F":y[j][V]=parseFloat(te.trim());break;case"+":case"I":y[j][V]=I?D.read_shift(-4,"i")^2147483648:D.read_shift(4,"i");break;case"L":switch(te.trim().toUpperCase()){case"Y":case"T":y[j][V]=!0;break;case"N":case"F":y[j][V]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+te+"|")}break;case"M":if(!T)throw new Error("DBF Unexpected MEMO for type "+E.toString(16));y[j][V]="##MEMO##"+(I?parseInt(te.trim(),10):D.read_shift(4));break;case"N":te=te.replace(/\u0000/g,"").trim(),te&&te!="."&&(y[j][V]=+te||0);break;case"@":y[j][V]=new Date(D.read_shift(-8,"f")-621356832e5);break;case"T":{var ue=D.read_shift(4),J=D.read_shift(4);if(ue==0&&J==0)break;y[j][V]=new Date((ue-2440588)*864e5+J),g&&g.UTC||(y[j][V]=Yd(y[j][V]))}break;case"Y":y[j][V]=D.read_shift(4,"i")/1e4+D.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":y[j][V]=-D.read_shift(-8,"f");break;case"B":if(S&&O[V].len==8){y[j][V]=D.read_shift(8,"f");break}case"G":case"P":D.l+=O[V].len;break;case"0":if(O[V].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+O[V].type)}}}if(E!=2&&b.l<b.length&&b[b.l++]!=26)throw new Error("DBF EOF Marker missing "+(b.l-1)+" of "+b.length+" "+b[b.l-1].toString(16));return g&&g.sheetRows&&(y=y.slice(0,g.sheetRows)),g.DBF=O,y}function s(p,g){var y=g||{};y.dateNF||(y.dateNF="yyyymmdd");var b=bm(a(p,y),y);return b["!cols"]=y.DBF.map(function(E){return{wch:E.len,DBF:E}}),delete y.DBF,b}function c(p,g){try{var y=Bh(s(p,g),g);return y.bookType="dbf",y}catch(b){if(g&&g.WTF)throw b}return{SheetNames:[],Sheets:{}}}var f={B:8,C:250,L:1,D:8,"?":0,"":0};function d(p,g){var y=g||{},b=co;if(+y.codepage>=0&&Al(+y.codepage),y.type=="string")throw new Error("Cannot write DBF to JS string");var E=Go(),T=WC(p,{header:1,raw:!0,cellDates:!0}),S=T[0],I=T.slice(1),A=p["!cols"]||[],M=0,F=0,L=0,O=1;for(M=0;M<S.length;++M){if(((A[M]||{}).DBF||{}).name){S[M]=A[M].DBF.name,++L;continue}if(S[M]!=null){if(++L,typeof S[M]=="number"&&(S[M]=S[M].toString(10)),typeof S[M]!="string")throw new Error("DBF Invalid column name "+S[M]+" |"+typeof S[M]+"|");if(S.indexOf(S[M])!==M){for(F=0;F<1024;++F)if(S.indexOf(S[M]+"_"+F)==-1){S[M]+="_"+F;break}}}}var N=Ei(p["!ref"]),Q=[],ie=[],j=[];for(M=0;M<=N.e.c-N.s.c;++M){var V="",D="",te=0,ue=[];for(F=0;F<I.length;++F)I[F][M]!=null&&ue.push(I[F][M]);if(ue.length==0||S[M]==null){Q[M]="?";continue}for(F=0;F<ue.length;++F){switch(typeof ue[F]){case"number":D="B";break;case"string":D="C";break;case"boolean":D="L";break;case"object":D=ue[F]instanceof Date?"D":"C";break;default:D="C"}te=Math.max(te,(typeof Jn<"u"&&typeof ue[F]=="string"?Jn.utils.encode(Xd,ue[F]):String(ue[F])).length),V=V&&V!=D?"C":D}te>250&&(te=250),D=((A[M]||{}).DBF||{}).type,D=="C"&&A[M].DBF.len>te&&(te=A[M].DBF.len),V=="B"&&D=="N"&&(V="N",j[M]=A[M].DBF.dec,te=A[M].DBF.len),ie[M]=V=="C"||D=="N"?te:f[V]||0,O+=ie[M],Q[M]=V}var J=E.next(32);for(J.write_shift(4,318902576),J.write_shift(4,I.length),J.write_shift(2,296+32*L),J.write_shift(2,O),M=0;M<4;++M)J.write_shift(4,0);var le=+n[co]||3;for(J.write_shift(4,0|le<<8),t[le]!=+y.codepage&&(y.codepage&&console.error("DBF Unsupported codepage "+co+", using 1252"),co=1252),M=0,F=0;M<S.length;++M)if(S[M]!=null){var re=E.next(32),Fe=(S[M].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);re.write_shift(1,Fe,"sbcs"),re.write_shift(1,Q[M]=="?"?"C":Q[M],"sbcs"),re.write_shift(4,F),re.write_shift(1,ie[M]||f[Q[M]]||0),re.write_shift(1,j[M]||0),re.write_shift(1,2),re.write_shift(4,0),re.write_shift(1,0),re.write_shift(4,0),re.write_shift(4,0),F+=ie[M]||f[Q[M]]||0}var Ye=E.next(264);for(Ye.write_shift(4,13),M=0;M<65;++M)Ye.write_shift(4,0);for(M=0;M<I.length;++M){var Ee=E.next(O);for(Ee.write_shift(1,0),F=0;F<S.length;++F)if(S[F]!=null)switch(Q[F]){case"L":Ee.write_shift(1,I[M][F]==null?63:I[M][F]?84:70);break;case"B":Ee.write_shift(8,I[M][F]||0,"f");break;case"N":var ut="0";for(typeof I[M][F]=="number"&&(ut=I[M][F].toFixed(j[F]||0)),ut.length>ie[F]&&(ut=ut.slice(0,ie[F])),L=0;L<ie[F]-ut.length;++L)Ee.write_shift(1,32);Ee.write_shift(1,ut,"sbcs");break;case"D":I[M][F]?(Ee.write_shift(4,("0000"+I[M][F].getFullYear()).slice(-4),"sbcs"),Ee.write_shift(2,("00"+(I[M][F].getMonth()+1)).slice(-2),"sbcs"),Ee.write_shift(2,("00"+I[M][F].getDate()).slice(-2),"sbcs")):Ee.write_shift(8,"00000000","sbcs");break;case"C":var Ne=Ee.l,He=String(I[M][F]!=null?I[M][F]:"").slice(0,ie[F]);for(Ee.write_shift(1,He,"cpstr"),Ne+=ie[F]-Ee.l,L=0;L<Ne;++L)Ee.write_shift(1,32);break}}return co=b,E.next(1).write_shift(1,26),E.end()}return{to_workbook:c,to_sheet:s,from_sheet:d}}(),L9=function(){var t={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},n=new RegExp("\x1BN("+Ma(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),a=function(S,I){var A=t[I];return typeof A=="number"?FC(A):A},s=function(S,I,A){var M=I.charCodeAt(0)-32<<4|A.charCodeAt(0)-48;return M==59?S:FC(M)};t["|"]=254;var c=function(S){return S.replace(/\n/g,"\x1B :").replace(/\r/g,"\x1B =")};function f(S,I){switch(I.type){case"base64":return d(ll(S),I);case"binary":return d(S,I);case"buffer":return d(oi&&Buffer.isBuffer(S)?S.toString("binary"):su(S),I);case"array":return d(Kd(S),I)}throw new Error("Unrecognized type "+I.type)}function d(S,I){var A=S.split(/[\n\r]+/),M=-1,F=-1,L=0,O=0,N=[],Q=[],ie=null,j={},V=[],D=[],te=[],ue=0,J,le={Workbook:{WBProps:{},Names:[]}};for(+I.codepage>=0&&Al(+I.codepage);L!==A.length;++L){ue=0;var re=A[L].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,s).replace(n,a),Fe=re.replace(/;;/g,"\0").split(";").map(function(ot){return ot.replace(/\u0000/g,";")}),Ye=Fe[0],Ee;if(re.length>0)switch(Ye){case"ID":break;case"E":break;case"B":break;case"O":for(O=1;O<Fe.length;++O)switch(Fe[O].charAt(0)){case"V":{var ut=parseInt(Fe[O].slice(1),10);ut>=1&&ut<=4&&(le.Workbook.WBProps.date1904=!0)}break}break;case"W":break;case"P":switch(Fe[1].charAt(0)){case"P":Q.push(re.slice(3).replace(/;;/g,";"));break}break;case"NN":{var Ne={Sheet:0};for(O=1;O<Fe.length;++O)switch(Fe[O].charAt(0)){case"N":Ne.Name=Fe[O].slice(1);break;case"E":Ne.Ref=(I&&I.sheet||"Sheet1")+"!"+Vd(Fe[O].slice(1));break}le.Workbook.Names.push(Ne)}break;case"C":var He=!1,Oe=!1,Pe=!1,rt=!1,et=-1,Ge=-1,ze="",oe="z",Me="";for(O=1;O<Fe.length;++O)switch(Fe[O].charAt(0)){case"A":Me=Fe[O].slice(1);break;case"X":F=parseInt(Fe[O].slice(1),10)-1,Oe=!0;break;case"Y":for(M=parseInt(Fe[O].slice(1),10)-1,Oe||(F=0),J=N.length;J<=M;++J)N[J]=[];break;case"K":Ee=Fe[O].slice(1),Ee.charAt(0)==='"'?(Ee=Ee.slice(1,Ee.length-1),oe="s"):Ee==="TRUE"||Ee==="FALSE"?(Ee=Ee==="TRUE",oe="b"):isNaN(sl(Ee))||(Ee=sl(Ee),oe="n",ie!==null&&cl(ie)&&I.cellDates&&(Ee=Zu(le.Workbook.WBProps.date1904?Ee+1462:Ee),oe=typeof Ee=="number"?"n":"d")),typeof Jn<"u"&&typeof Ee=="string"&&(I||{}).type!="string"&&(I||{}).codepage&&(Ee=Jn.utils.decode(I.codepage,Ee)),He=!0;break;case"E":rt=!0,ze=Vd(Fe[O].slice(1),{r:M,c:F});break;case"S":Pe=!0;break;case"G":break;case"R":et=parseInt(Fe[O].slice(1),10)-1;break;case"C":Ge=parseInt(Fe[O].slice(1),10)-1;break;default:if(I&&I.WTF)throw new Error("SYLK bad record "+re)}if(He&&(N[M][F]?(N[M][F].t=oe,N[M][F].v=Ee):N[M][F]={t:oe,v:Ee},ie&&(N[M][F].z=ie),I.cellText!==!1&&ie&&(N[M][F].w=$s(N[M][F].z,N[M][F].v,{date1904:le.Workbook.WBProps.date1904})),ie=null),Pe){if(rt)throw new Error("SYLK shared formula cannot have own formula");var fe=et>-1&&N[et][Ge];if(!fe||!fe[1])throw new Error("SYLK shared formula cannot find base");ze=Z9(fe[1],{r:M-et,c:F-Ge})}ze&&(N[M][F]?N[M][F].f=ze:N[M][F]={t:"n",f:ze}),Me&&(N[M][F]||(N[M][F]={t:"z"}),N[M][F].c=[{a:"SheetJSYLK",t:Me}]);break;case"F":var pe=0;for(O=1;O<Fe.length;++O)switch(Fe[O].charAt(0)){case"X":F=parseInt(Fe[O].slice(1),10)-1,++pe;break;case"Y":for(M=parseInt(Fe[O].slice(1),10)-1,J=N.length;J<=M;++J)N[J]=[];break;case"M":ue=parseInt(Fe[O].slice(1),10)/20;break;case"F":break;case"G":break;case"P":ie=Q[parseInt(Fe[O].slice(1),10)];break;case"S":break;case"D":break;case"N":break;case"W":for(te=Fe[O].slice(1).split(" "),J=parseInt(te[0],10);J<=parseInt(te[1],10);++J)ue=parseInt(te[2],10),D[J-1]=ue===0?{hidden:!0}:{wch:ue};break;case"C":F=parseInt(Fe[O].slice(1),10)-1,D[F]||(D[F]={});break;case"R":M=parseInt(Fe[O].slice(1),10)-1,V[M]||(V[M]={}),ue>0?(V[M].hpt=ue,V[M].hpx=sm(ue)):ue===0&&(V[M].hidden=!0);break;default:if(I&&I.WTF)throw new Error("SYLK bad record "+re)}pe<1&&(ie=null);break;default:if(I&&I.WTF)throw new Error("SYLK bad record "+re)}}return V.length>0&&(j["!rows"]=V),D.length>0&&(j["!cols"]=D),D.forEach(function(ot){kh(ot)}),I&&I.sheetRows&&(N=N.slice(0,I.sheetRows)),[N,j,le]}function p(S,I){var A=f(S,I),M=A[0],F=A[1],L=A[2],O=Qi(I);O.date1904=(((L||{}).Workbook||{}).WBProps||{}).date1904;var N=bm(M,O);Ma(F).forEach(function(ie){N[ie]=F[ie]});var Q=Bh(N,I);return Ma(L).forEach(function(ie){Q[ie]=L[ie]}),Q.bookType="sylk",Q}function g(S,I,A,M,F,L){var O="C;Y"+(A+1)+";X"+(M+1)+";K";switch(S.t){case"n":O+=S.v||0,S.f&&!S.F&&(O+=";E"+hw(S.f,{r:A,c:M}));break;case"b":O+=S.v?"TRUE":"FALSE";break;case"e":O+=S.w||S.v;break;case"d":O+=La(Fa(S.v,L),L);break;case"s":O+='"'+(S.v==null?"":String(S.v)).replace(/"/g,"").replace(/;/g,";;")+'"';break}return O}function y(S,I,A){var M="C;Y"+(I+1)+";X"+(A+1)+";A";return M+=c(S.map(function(F){return F.t}).join("")),M}function b(S,I){I.forEach(function(A,M){var F="F;W"+(M+1)+" "+(M+1)+" ";A.hidden?F+="0":(typeof A.width=="number"&&!A.wpx&&(A.wpx=Q_(A.width)),typeof A.wpx=="number"&&!A.wch&&(A.wch=ev(A.wpx)),typeof A.wch=="number"&&(F+=Math.round(A.wch))),F.charAt(F.length-1)!=" "&&S.push(F)})}function E(S,I){I.forEach(function(A,M){var F="F;";A.hidden?F+="M0;":A.hpt?F+="M"+20*A.hpt+";":A.hpx&&(F+="M"+20*tv(A.hpx)+";"),F.length>2&&S.push(F+"R"+(M+1))})}function T(S,I,A){I||(I={}),I._formats=["General"];var M=["ID;PSheetJS;N;E"],F=[],L=Ei(S["!ref"]),O,N=S["!data"]!=null,Q=`\r
`,ie=(((A||{}).Workbook||{}).WBProps||{}).date1904,j="General";M.push("P;PGeneral");var V=L.s.r,D=L.s.c,te=[];for(V=L.s.r;V<=L.e.r;++V)if(!(N&&!S["!data"][V])){for(te=[],D=L.s.c;D<=L.e.c;++D)O=N?S["!data"][V][D]:S[Qn(D)+vi(V)],!(!O||!O.c)&&te.push(y(O.c,V,D));te.length&&F.push(te.join(Q))}for(V=L.s.r;V<=L.e.r;++V)if(!(N&&!S["!data"][V])){for(te=[],D=L.s.c;D<=L.e.c;++D)if(O=N?S["!data"][V][D]:S[Qn(D)+vi(V)],!(!O||O.v==null&&(!O.f||O.F))){if((O.z||(O.t=="d"?pn[14]:"General"))!=j){var ue=I._formats.indexOf(O.z);ue==-1&&(I._formats.push(O.z),ue=I._formats.length-1,M.push("P;P"+O.z.replace(/;/g,";;"))),te.push("F;P"+ue+";Y"+(V+1)+";X"+(D+1))}te.push(g(O,S,V,D,I,ie))}F.push(te.join(Q))}return M.push("F;P0;DG0G8;M255"),S["!cols"]&&b(M,S["!cols"]),S["!rows"]&&E(M,S["!rows"]),M.push("B;Y"+(L.e.r-L.s.r+1)+";X"+(L.e.c-L.s.c+1)+";D"+[L.s.c,L.s.r,L.e.c,L.e.r].join(" ")),M.push("O;L;D;B"+(ie?";V4":"")+";K47;G100 0.001"),delete I._formats,M.join(Q)+Q+F.join(Q)+Q+"E"+Q}return{to_workbook:p,from_sheet:T}}(),D9=function(){function t(p,g){switch(g.type){case"base64":return n(ll(p),g);case"binary":return n(p,g);case"buffer":return n(oi&&Buffer.isBuffer(p)?p.toString("binary"):su(p),g);case"array":return n(Kd(p),g)}throw new Error("Unrecognized type "+g.type)}function n(p,g){for(var y=p.split(`
`),b=-1,E=-1,T=0,S=[];T!==y.length;++T){if(y[T].trim()==="BOT"){S[++b]=[],E=0;continue}if(!(b<0)){var I=y[T].trim().split(","),A=I[0],M=I[1];++T;for(var F=y[T]||"";(F.match(/["]/g)||[]).length&1&&T<y.length-1;)F+=`
`+y[++T];switch(F=F.trim(),+A){case-1:if(F==="BOT"){S[++b]=[],E=0;continue}else if(F!=="EOD")throw new Error("Unrecognized DIF special command "+F);break;case 0:F==="TRUE"?S[b][E]=!0:F==="FALSE"?S[b][E]=!1:isNaN(sl(M))?isNaN(H_(M).getDate())?S[b][E]=M:(S[b][E]=Fa(M),g&&g.UTC||(S[b][E]=Yd(S[b][E]))):S[b][E]=sl(M),++E;break;case 1:F=F.slice(1,F.length-1),F=F.replace(/""/g,'"'),F&&F.match(/^=".*"$/)&&(F=F.slice(2,-1)),S[b][E++]=F!==""?F:null;break}if(F==="EOD")break}}return g&&g.sheetRows&&(S=S.slice(0,g.sheetRows)),S}function a(p,g){return bm(t(p,g),g)}function s(p,g){var y=Bh(a(p,g),g);return y.bookType="dif",y}function c(p,g){return"0,"+String(p)+`\r
`+g}function f(p){return`1,0\r
"`+p.replace(/"/g,'""')+'"'}function d(p){for(var g=Ei(p["!ref"]),y=p["!data"]!=null,b=[`TABLE\r
0,1\r
"sheetjs"\r
`,`VECTORS\r
0,`+(g.e.r-g.s.r+1)+`\r
""\r
`,`TUPLES\r
0,`+(g.e.c-g.s.c+1)+`\r
""\r
`,`DATA\r
0,0\r
""\r
`],E=g.s.r;E<=g.e.r;++E){for(var T=y?p["!data"][E]:[],S=`-1,0\r
BOT\r
`,I=g.s.c;I<=g.e.c;++I){var A=y?T&&T[I]:p[ii({r:E,c:I})];if(A==null){S+=`1,0\r
""\r
`;continue}switch(A.t){case"n":A.w!=null?S+="0,"+A.w+`\r
V`:A.v!=null?S+=c(A.v,"V"):A.f!=null&&!A.F?S+=f("="+A.f):S+=`1,0\r
""`;break;case"b":S+=A.v?c(1,"TRUE"):c(0,"FALSE");break;case"s":S+=f(isNaN(+A.v)?A.v:'="'+A.v+'"');break;case"d":A.w||(A.w=$s(A.z||pn[14],La(Fa(A.v)))),S+=c(A.w,"V");break;default:S+=`1,0\r
""`}S+=`\r
`}b.push(S)}return b.join("")+`-1,0\r
EOD`}return{to_workbook:s,to_sheet:a,from_sheet:d}}(),B9=function(){function t(E){return E.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function n(E){return E.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function a(E,T){for(var S=E.split(`
`),I=-1,A=-1,M=0,F=[];M!==S.length;++M){var L=S[M].trim().split(":");if(L[0]==="cell"){var O=Yi(L[1]);if(F.length<=O.r)for(I=F.length;I<=O.r;++I)F[I]||(F[I]=[]);switch(I=O.r,A=O.c,L[2]){case"t":F[I][A]=t(L[3]);break;case"v":F[I][A]=+L[3];break;case"vtf":var N=L[L.length-1];case"vtc":switch(L[3]){case"nl":F[I][A]=!!+L[4];break;default:F[I][A]=+L[4];break}L[2]=="vtf"&&(F[I][A]=[F[I][A],N])}}}return T&&T.sheetRows&&(F=F.slice(0,T.sheetRows)),F}function s(E,T){return bm(a(E,T),T)}function c(E,T){return Bh(s(E,T),T)}var f=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),d=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,p=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),g="--SocialCalcSpreadsheetControlSave--";function y(E){if(!E||!E["!ref"])return"";for(var T=[],S=[],I,A="",M=ho(E["!ref"]),F=E["!data"]!=null,L=M.s.r;L<=M.e.r;++L)for(var O=M.s.c;O<=M.e.c;++O)if(A=ii({r:L,c:O}),I=F?(E["!data"][L]||[])[O]:E[A],!(!I||I.v==null||I.t==="z")){switch(S=["cell",A,"t"],I.t){case"s":case"str":S.push(n(I.v));break;case"n":I.f?(S[2]="vtf",S[3]="n",S[4]=I.v,S[5]=n(I.f)):(S[2]="v",S[3]=I.v);break;case"b":S[2]="vt"+(I.f?"f":"c"),S[3]="nl",S[4]=I.v?"1":"0",S[5]=n(I.f||(I.v?"TRUE":"FALSE"));break;case"d":var N=La(Fa(I.v));S[2]="vtc",S[3]="nd",S[4]=""+N,S[5]=I.w||$s(I.z||pn[14],N);break;case"e":continue}T.push(S.join(":"))}return T.push("sheet:c:"+(M.e.c-M.s.c+1)+":r:"+(M.e.r-M.s.r+1)+":tvf:1"),T.push("valueformat:1:text-wiki"),T.join(`
`)}function b(E){return[f,d,p,d,y(E),g].join(`
`)}return{to_workbook:c,to_sheet:s,from_sheet:b}}(),om=function(){function t(b,E,T,S,I){I.raw?E[T][S]=b:b===""||(b==="TRUE"?E[T][S]=!0:b==="FALSE"?E[T][S]=!1:isNaN(sl(b))?isNaN(H_(b).getDate())?E[T][S]=b:E[T][S]=Fa(b):E[T][S]=sl(b))}function n(b,E){var T=E||{},S=[];if(!b||b.length===0)return S;for(var I=b.split(/[\r\n]/),A=I.length-1;A>=0&&I[A].length===0;)--A;for(var M=10,F=0,L=0;L<=A;++L)F=I[L].indexOf(" "),F==-1?F=I[L].length:F++,M=Math.max(M,F);for(L=0;L<=A;++L){S[L]=[];var O=0;for(t(I[L].slice(0,M).trim(),S,L,O,T),O=1;O<=(I[L].length-M)/10+1;++O)t(I[L].slice(M+(O-1)*10,M+O*10).trim(),S,L,O,T)}return T.sheetRows&&(S=S.slice(0,T.sheetRows)),S}var a={44:",",9:"	",59:";",124:"|"},s={44:3,9:2,59:1,124:0};function c(b){for(var E={},T=!1,S=0,I=0;S<b.length;++S)(I=b.charCodeAt(S))==34?T=!T:!T&&I in a&&(E[I]=(E[I]||0)+1);I=[];for(S in E)Object.prototype.hasOwnProperty.call(E,S)&&I.push([E[S],S]);if(!I.length){E=s;for(S in E)Object.prototype.hasOwnProperty.call(E,S)&&I.push([E[S],S])}return I.sort(function(A,M){return A[0]-M[0]||s[A[1]]-s[M[1]]}),a[I.pop()[1]]||44}function f(b,E){var T=E||{},S="",I={};T.dense&&(I["!data"]=[]);var A={s:{c:0,r:0},e:{c:0,r:0}};b.slice(0,4)=="sep="?b.charCodeAt(5)==13&&b.charCodeAt(6)==10?(S=b.charAt(4),b=b.slice(7)):b.charCodeAt(5)==13||b.charCodeAt(5)==10?(S=b.charAt(4),b=b.slice(6)):S=c(b.slice(0,1024)):T&&T.FS?S=T.FS:S=c(b.slice(0,1024));var M=0,F=0,L=0,O=0,N=0,Q=S.charCodeAt(0),ie=!1,j=0,V=b.charCodeAt(0),D=T.dateNF!=null?i1e(T.dateNF):null;function te(){var ue=b.slice(O,N);ue.slice(-1)=="\r"&&(ue=ue.slice(0,-1));var J={};if(ue.charAt(0)=='"'&&ue.charAt(ue.length-1)=='"'&&(ue=ue.slice(1,-1).replace(/""/g,'"')),T.cellText!==!1&&(J.w=ue),ue.length===0)J.t="z";else if(T.raw)J.t="s",J.v=ue;else if(ue.trim().length===0)J.t="s",J.v=ue;else if(ue.charCodeAt(0)==61)ue.charCodeAt(1)==34&&ue.charCodeAt(ue.length-1)==34?(J.t="s",J.v=ue.slice(2,-1).replace(/""/g,'"')):Q2e(ue)?(J.t="n",J.f=ue.slice(1)):(J.t="s",J.v=ue);else if(ue=="TRUE")J.t="b",J.v=!0;else if(ue=="FALSE")J.t="b",J.v=!1;else if(!isNaN(L=sl(ue)))J.t="n",J.v=L;else if(!isNaN((L=H_(ue)).getDate())||D&&ue.match(D)){if(J.z=T.dateNF||pn[14],D&&ue.match(D)){var le=a1e(ue,T.dateNF,ue.match(D)||[]);L=Fa(le),T&&T.UTC===!1&&(L=Yd(L))}else T&&T.UTC===!1?L=Yd(L):T.cellText!==!1&&T.dateNF&&(J.w=$s(J.z,L));T.cellDates?(J.t="d",J.v=L):(J.t="n",J.v=La(L)),T.cellNF||delete J.z}else J.t="s",J.v=ue;if(J.t=="z"||(T.dense?(I["!data"][M]||(I["!data"][M]=[]),I["!data"][M][F]=J):I[ii({c:F,r:M})]=J),O=N+1,V=b.charCodeAt(O),A.e.c<F&&(A.e.c=F),A.e.r<M&&(A.e.r=M),j==Q)++F;else if(F=0,++M,T.sheetRows&&T.sheetRows<=M)return!0}e:for(;N<b.length;++N)switch(j=b.charCodeAt(N)){case 34:V===34&&(ie=!ie);break;case 13:if(ie)break;b.charCodeAt(N+1)==10&&++N;case Q:case 10:if(!ie&&te())break e;break}return N-O>0&&te(),I["!ref"]=Xn(A),I}function d(b,E){return!(E&&E.PRN)||E.FS||b.slice(0,4)=="sep="||b.indexOf("	")>=0||b.indexOf(",")>=0||b.indexOf(";")>=0?f(b,E):bm(n(b,E),E)}function p(b,E){var T="",S=E.type=="string"?[0,0,0,0]:Qk(b,E);switch(E.type){case"base64":T=ll(b);break;case"binary":T=b;break;case"buffer":E.codepage==65001?T=b.toString("utf8"):E.codepage&&typeof Jn<"u"?T=Jn.utils.decode(E.codepage,b):T=oi&&Buffer.isBuffer(b)?b.toString("binary"):su(b);break;case"array":T=Kd(b);break;case"string":T=b;break;default:throw new Error("Unrecognized type "+E.type)}return S[0]==239&&S[1]==187&&S[2]==191?T=Ki(T.slice(3)):E.type!="string"&&E.type!="buffer"&&E.codepage==65001?T=Ki(T):E.type=="binary"&&typeof Jn<"u"&&E.codepage&&(T=Jn.utils.decode(E.codepage,Jn.utils.encode(28591,T))),T.slice(0,19)=="socialcalc:version:"?B9.to_sheet(E.type=="string"?T:Ki(T),E):d(T,E)}function g(b,E){return Bh(p(b,E),E)}function y(b){for(var E=[],T=Ei(b["!ref"]),S,I=b["!data"]!=null,A=T.s.r;A<=T.e.r;++A){for(var M=[],F=T.s.c;F<=T.e.c;++F){var L=ii({r:A,c:F});if(S=I?(b["!data"][A]||[])[F]:b[L],!S||S.v==null){M.push("          ");continue}for(var O=(S.w||(lu(S),S.w)||"").slice(0,10);O.length<10;)O+=" ";M.push(O+(F===0?" ":""))}E.push(M.join(""))}return E.join(`
`)}return{to_workbook:g,to_sheet:p,from_sheet:y}}();function Pbe(t,n){var a=n||{},s=!!a.WTF;a.WTF=!0;try{var c=L9.to_workbook(t,a);return a.WTF=s,c}catch(f){if(a.WTF=s,!f.message.match(/SYLK bad record ID/)&&s)throw f;return om.to_workbook(t,n)}}var $d=function(){function t(oe,Me,fe){if(oe){so(oe,oe.l||0);for(var pe=fe.Enum||rt;oe.l<oe.length;){var ot=oe.read_shift(2),xe=pe[ot]||pe[65535],ae=oe.read_shift(2),X=oe.l+ae,Ce=xe.f&&xe.f(oe,ae,fe);if(oe.l=X,Me(Ce,xe,ot))return}}}function n(oe,Me){switch(Me.type){case"base64":return s(us(ll(oe)),Me);case"binary":return s(us(oe),Me);case"buffer":case"array":return s(oe,Me)}throw"Unsupported type "+Me.type}var a=["mmmm","dd-mmm-yyyy","dd-mmm","mmm-yyyy","@","mm/dd","hh:mm:ss AM/PM","hh:mm AM/PM","mm/dd/yyyy","mm/dd","hh:mm:ss","hh:mm"];function s(oe,Me){if(!oe)return oe;var fe=Me||{},pe={},ot="Sheet1",xe="",ae=0,X={},Ce=[],he=[],G=[];fe.dense&&(G=pe["!data"]=[]);var K={s:{r:0,c:0},e:{r:0,c:0}},se=fe.sheetRows||0,Ae={};if(oe[4]==81&&oe[5]==80&&oe[6]==87)return ze(oe,Me);if(oe[2]==0&&(oe[3]==8||oe[3]==9)&&oe.length>=16&&oe[14]==5&&oe[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(oe[2]==2)fe.Enum=rt,t(oe,function(be,Be,ct){switch(ct){case 0:fe.vers=be,be>=4096&&(fe.qpro=!0);break;case 255:fe.vers=be,fe.works=!0;break;case 6:K=be;break;case 204:be&&(xe=be);break;case 222:xe=be;break;case 15:case 51:(!fe.qpro&&!fe.works||ct==51)&&be[1].v.charCodeAt(0)<48&&(be[1].v=be[1].v.slice(1)),(fe.works||fe.works2)&&(be[1].v=be[1].v.replace(/\r\n/g,`
`));case 13:case 14:case 16:(be[2]&112)==112&&(be[2]&15)>1&&(be[2]&15)<15&&(be[1].z=fe.dateNF||a[(be[2]&15)-1]||pn[14],fe.cellDates&&(be[1].v=Zu(be[1].v),be[1].t=typeof be[1].v=="number"?"n":"d")),fe.qpro&&be[3]>ae&&(pe["!ref"]=Xn(K),X[ot]=pe,Ce.push(ot),pe={},fe.dense&&(G=pe["!data"]=[]),K={s:{r:0,c:0},e:{r:0,c:0}},ae=be[3],ot=xe||"Sheet"+(ae+1),xe="");var At=fe.dense?(G[be[0].r]||[])[be[0].c]:pe[ii(be[0])];if(At){At.t=be[1].t,At.v=be[1].v,be[1].z!=null&&(At.z=be[1].z),be[1].f!=null&&(At.f=be[1].f),Ae=At;break}fe.dense?(G[be[0].r]||(G[be[0].r]=[]),G[be[0].r][be[0].c]=be[1]):pe[ii(be[0])]=be[1],Ae=be[1];break;case 21509:fe.works2=!0;break;case 21506:be==5281&&(Ae.z="hh:mm:ss",fe.cellDates&&Ae.t=="n"&&(Ae.v=Zu(Ae.v),Ae.t=typeof Ae.v=="number"?"n":"d"));break}},fe);else if(oe[2]==26||oe[2]==14)fe.Enum=et,oe[2]==14&&(fe.qpro=!0,oe.l=0),t(oe,function(be,Be,ct){switch(ct){case 204:ot=be;break;case 22:be[1].v.charCodeAt(0)<48&&(be[1].v=be[1].v.slice(1)),be[1].v=be[1].v.replace(/\x0F./g,function(At){return String.fromCharCode(At.charCodeAt(1)-32)}).replace(/\r\n/g,`
`);case 23:case 24:case 25:case 37:case 39:case 40:if(be[3]>ae&&(pe["!ref"]=Xn(K),X[ot]=pe,Ce.push(ot),pe={},fe.dense&&(G=pe["!data"]=[]),K={s:{r:0,c:0},e:{r:0,c:0}},ae=be[3],ot="Sheet"+(ae+1)),se>0&&be[0].r>=se)break;fe.dense?(G[be[0].r]||(G[be[0].r]=[]),G[be[0].r][be[0].c]=be[1]):pe[ii(be[0])]=be[1],K.e.c<be[0].c&&(K.e.c=be[0].c),K.e.r<be[0].r&&(K.e.r=be[0].r);break;case 27:be[14e3]&&(he[be[14e3][0]]=be[14e3][1]);break;case 1537:he[be[0]]=be[1],be[0]==ae&&(ot=be[1]);break}},fe);else throw new Error("Unrecognized LOTUS BOF "+oe[2]);if(pe["!ref"]=Xn(K),X[xe||ot]=pe,Ce.push(xe||ot),!he.length)return{SheetNames:Ce,Sheets:X};for(var Se={},ye=[],Xe=0;Xe<he.length;++Xe)X[Ce[Xe]]?(ye.push(he[Xe]||Ce[Xe]),Se[he[Xe]]=X[he[Xe]]||X[Ce[Xe]]):(ye.push(he[Xe]),Se[he[Xe]]={"!ref":"A1"});return{SheetNames:ye,Sheets:Se}}function c(oe,Me){var fe=Me||{};if(+fe.codepage>=0&&Al(+fe.codepage),fe.type=="string")throw new Error("Cannot write WK1 to JS string");var pe=Go(),ot=Ei(oe["!ref"]),xe=oe["!data"]!=null,ae=[];lr(pe,0,d(1030)),lr(pe,6,y(ot));for(var X=Math.min(ot.e.r,8191),Ce=ot.s.c;Ce<=ot.e.c;++Ce)ae[Ce]=Qn(Ce);for(var he=ot.s.r;he<=X;++he){var G=vi(he);for(Ce=ot.s.c;Ce<=ot.e.c;++Ce){var K=xe?(oe["!data"][he]||[])[Ce]:oe[ae[Ce]+G];if(!(!K||K.t=="z"))switch(K.t){case"n":(K.v|0)==K.v&&K.v>=-32768&&K.v<=32767?lr(pe,13,M(he,Ce,K)):lr(pe,14,L(he,Ce,K));break;case"d":var se=La(K.v);(se|0)==se&&se>=-32768&&se<=32767?lr(pe,13,M(he,Ce,{t:"n",v:se,z:K.z||pn[14]})):lr(pe,14,L(he,Ce,{t:"n",v:se,z:K.z||pn[14]}));break;default:var Ae=lu(K);lr(pe,15,S(he,Ce,Ae.slice(0,239)))}}}return lr(pe,1),pe.end()}function f(oe,Me){var fe=Me||{};if(+fe.codepage>=0&&Al(+fe.codepage),fe.type=="string")throw new Error("Cannot write WK3 to JS string");var pe=Go();lr(pe,0,p(oe));for(var ot=0,xe=0;ot<oe.SheetNames.length;++ot)(oe.Sheets[oe.SheetNames[ot]]||{})["!ref"]&&lr(pe,27,Pe(oe.SheetNames[ot],xe++));var ae=0;for(ot=0;ot<oe.SheetNames.length;++ot){var X=oe.Sheets[oe.SheetNames[ot]];if(!(!X||!X["!ref"])){for(var Ce=Ei(X["!ref"]),he=X["!data"]!=null,G=[],K=Math.min(Ce.e.r,8191),se=Ce.s.r;se<=K;++se)for(var Ae=vi(se),Se=Ce.s.c;Se<=Ce.e.c;++Se){se===Ce.s.r&&(G[Se]=Qn(Se));var ye=G[Se]+Ae,Xe=he?(X["!data"][se]||[])[Se]:X[ye];if(!(!Xe||Xe.t=="z"))if(Xe.t=="n")lr(pe,23,le(se,Se,ae,Xe.v));else{var be=lu(Xe);lr(pe,22,te(se,Se,ae,be.slice(0,239)))}}++ae}}return lr(pe,1),pe.end()}function d(oe){var Me=zt(2);return Me.write_shift(2,oe),Me}function p(oe){var Me=zt(26);Me.write_shift(2,4096),Me.write_shift(2,4),Me.write_shift(4,0);for(var fe=0,pe=0,ot=0,xe=0;xe<oe.SheetNames.length;++xe){var ae=oe.SheetNames[xe],X=oe.Sheets[ae];if(!(!X||!X["!ref"])){++ot;var Ce=ho(X["!ref"]);fe<Ce.e.r&&(fe=Ce.e.r),pe<Ce.e.c&&(pe=Ce.e.c)}}return fe>8191&&(fe=8191),Me.write_shift(2,fe),Me.write_shift(1,ot),Me.write_shift(1,pe),Me.write_shift(2,0),Me.write_shift(2,0),Me.write_shift(1,1),Me.write_shift(1,2),Me.write_shift(4,0),Me.write_shift(4,0),Me}function g(oe,Me,fe){var pe={s:{c:0,r:0},e:{c:0,r:0}};return Me==8&&fe.qpro?(pe.s.c=oe.read_shift(1),oe.l++,pe.s.r=oe.read_shift(2),pe.e.c=oe.read_shift(1),oe.l++,pe.e.r=oe.read_shift(2),pe):(pe.s.c=oe.read_shift(2),pe.s.r=oe.read_shift(2),Me==12&&fe.qpro&&(oe.l+=2),pe.e.c=oe.read_shift(2),pe.e.r=oe.read_shift(2),Me==12&&fe.qpro&&(oe.l+=2),pe.s.c==65535&&(pe.s.c=pe.e.c=pe.s.r=pe.e.r=0),pe)}function y(oe){var Me=zt(8);return Me.write_shift(2,oe.s.c),Me.write_shift(2,oe.s.r),Me.write_shift(2,oe.e.c),Me.write_shift(2,oe.e.r),Me}function b(oe,Me,fe){var pe=[{c:0,r:0},{t:"n",v:0},0,0];return fe.qpro&&fe.vers!=20768?(pe[0].c=oe.read_shift(1),pe[3]=oe.read_shift(1),pe[0].r=oe.read_shift(2),oe.l+=2):fe.works?(pe[0].c=oe.read_shift(2),pe[0].r=oe.read_shift(2),pe[2]=oe.read_shift(2)):(pe[2]=oe.read_shift(1),pe[0].c=oe.read_shift(2),pe[0].r=oe.read_shift(2)),pe}function E(oe){return oe.z&&cl(oe.z)?240|(a.indexOf(oe.z)+1||2):255}function T(oe,Me,fe){var pe=oe.l+Me,ot=b(oe,Me,fe);if(ot[1].t="s",(fe.vers&65534)==20768){oe.l++;var xe=oe.read_shift(1);return ot[1].v=oe.read_shift(xe,"utf8"),ot}return fe.qpro&&oe.l++,ot[1].v=oe.read_shift(pe-oe.l,"cstr"),ot}function S(oe,Me,fe){var pe=zt(7+fe.length);pe.write_shift(1,255),pe.write_shift(2,Me),pe.write_shift(2,oe),pe.write_shift(1,39);for(var ot=0;ot<pe.length;++ot){var xe=fe.charCodeAt(ot);pe.write_shift(1,xe>=128?95:xe)}return pe.write_shift(1,0),pe}function I(oe,Me,fe){var pe=oe.l+Me,ot=b(oe,Me,fe);if(ot[1].t="s",fe.vers==20768){var xe=oe.read_shift(1);return ot[1].v=oe.read_shift(xe,"utf8"),ot}return ot[1].v=oe.read_shift(pe-oe.l,"cstr"),ot}function A(oe,Me,fe){var pe=b(oe,Me,fe);return pe[1].v=oe.read_shift(2,"i"),pe}function M(oe,Me,fe){var pe=zt(7);return pe.write_shift(1,E(fe)),pe.write_shift(2,Me),pe.write_shift(2,oe),pe.write_shift(2,fe.v,"i"),pe}function F(oe,Me,fe){var pe=b(oe,Me,fe);return pe[1].v=oe.read_shift(8,"f"),pe}function L(oe,Me,fe){var pe=zt(13);return pe.write_shift(1,E(fe)),pe.write_shift(2,Me),pe.write_shift(2,oe),pe.write_shift(8,fe.v,"f"),pe}function O(oe,Me,fe){var pe=oe.l+Me,ot=b(oe,Me,fe);if(ot[1].v=oe.read_shift(8,"f"),fe.qpro)oe.l=pe;else{var xe=oe.read_shift(2);j(oe.slice(oe.l,oe.l+xe),ot),oe.l+=xe}return ot}function N(oe,Me,fe){var pe=Me&32768;return Me&=-32769,Me=(pe?oe:0)+(Me>=8192?Me-16384:Me),(pe?"":"$")+(fe?Qn(Me):vi(Me))}var Q={31:["NA",0],33:["ABS",1],34:["TRUNC",1],35:["SQRT",1],36:["LOG",1],37:["LN",1],38:["PI",0],39:["SIN",1],40:["COS",1],41:["TAN",1],42:["ATAN2",2],43:["ATAN",1],44:["ASIN",1],45:["ACOS",1],46:["EXP",1],47:["MOD",2],49:["ISNA",1],50:["ISERR",1],51:["FALSE",0],52:["TRUE",0],53:["RAND",0],54:["DATE",3],63:["ROUND",2],64:["TIME",3],68:["ISNUMBER",1],69:["ISTEXT",1],70:["LEN",1],71:["VALUE",1],73:["MID",3],74:["CHAR",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],102:["UPPER",1],103:["LOWER",1],107:["PROPER",1],109:["TRIM",1],111:["T",1]},ie=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function j(oe,Me){so(oe,0);for(var fe=[],pe=0,ot="",xe="",ae="",X="";oe.l<oe.length;){var Ce=oe[oe.l++];switch(Ce){case 0:fe.push(oe.read_shift(8,"f"));break;case 1:xe=N(Me[0].c,oe.read_shift(2),!0),ot=N(Me[0].r,oe.read_shift(2),!1),fe.push(xe+ot);break;case 2:{var he=N(Me[0].c,oe.read_shift(2),!0),G=N(Me[0].r,oe.read_shift(2),!1);xe=N(Me[0].c,oe.read_shift(2),!0),ot=N(Me[0].r,oe.read_shift(2),!1),fe.push(he+G+":"+xe+ot)}break;case 3:if(oe.l<oe.length){console.error("WK1 premature formula end");return}break;case 4:fe.push("("+fe.pop()+")");break;case 5:fe.push(oe.read_shift(2));break;case 6:{for(var K="";Ce=oe[oe.l++];)K+=String.fromCharCode(Ce);fe.push('"'+K.replace(/"/g,'""')+'"')}break;case 8:fe.push("-"+fe.pop());break;case 23:fe.push("+"+fe.pop());break;case 22:fe.push("NOT("+fe.pop()+")");break;case 20:case 21:X=fe.pop(),ae=fe.pop(),fe.push(["AND","OR"][Ce-20]+"("+ae+","+X+")");break;default:if(Ce<32&&ie[Ce])X=fe.pop(),ae=fe.pop(),fe.push(ae+ie[Ce]+X);else if(Q[Ce]){if(pe=Q[Ce][1],pe==69&&(pe=oe[oe.l++]),pe>fe.length){console.error("WK1 bad formula parse 0x"+Ce.toString(16)+":|"+fe.join("|")+"|");return}var se=fe.slice(-pe);fe.length-=pe,fe.push(Q[Ce][0]+"("+se.join(",")+")")}else return Ce<=7?console.error("WK1 invalid opcode "+Ce.toString(16)):Ce<=24?console.error("WK1 unsupported op "+Ce.toString(16)):Ce<=30?console.error("WK1 invalid opcode "+Ce.toString(16)):Ce<=115?console.error("WK1 unsupported function opcode "+Ce.toString(16)):console.error("WK1 unrecognized opcode "+Ce.toString(16))}}fe.length==1?Me[1].f=""+fe[0]:console.error("WK1 bad formula parse |"+fe.join("|")+"|")}function V(oe){var Me=[{c:0,r:0},{t:"n",v:0},0];return Me[0].r=oe.read_shift(2),Me[3]=oe[oe.l++],Me[0].c=oe[oe.l++],Me}function D(oe,Me){var fe=V(oe);return fe[1].t="s",fe[1].v=oe.read_shift(Me-4,"cstr"),fe}function te(oe,Me,fe,pe){var ot=zt(6+pe.length);ot.write_shift(2,oe),ot.write_shift(1,fe),ot.write_shift(1,Me),ot.write_shift(1,39);for(var xe=0;xe<pe.length;++xe){var ae=pe.charCodeAt(xe);ot.write_shift(1,ae>=128?95:ae)}return ot.write_shift(1,0),ot}function ue(oe,Me){var fe=V(oe);fe[1].v=oe.read_shift(2);var pe=fe[1].v>>1;if(fe[1].v&1)switch(pe&7){case 0:pe=(pe>>3)*5e3;break;case 1:pe=(pe>>3)*500;break;case 2:pe=(pe>>3)/20;break;case 3:pe=(pe>>3)/200;break;case 4:pe=(pe>>3)/2e3;break;case 5:pe=(pe>>3)/2e4;break;case 6:pe=(pe>>3)/16;break;case 7:pe=(pe>>3)/64;break}return fe[1].v=pe,fe}function J(oe,Me){var fe=V(oe),pe=oe.read_shift(4),ot=oe.read_shift(4),xe=oe.read_shift(2);if(xe==65535)return pe===0&&ot===3221225472?(fe[1].t="e",fe[1].v=15):pe===0&&ot===3489660928?(fe[1].t="e",fe[1].v=42):fe[1].v=0,fe;var ae=xe&32768;return xe=(xe&32767)-16446,fe[1].v=(1-ae*2)*(ot*Math.pow(2,xe+32)+pe*Math.pow(2,xe)),fe}function le(oe,Me,fe,pe){var ot=zt(14);if(ot.write_shift(2,oe),ot.write_shift(1,fe),ot.write_shift(1,Me),pe==0)return ot.write_shift(4,0),ot.write_shift(4,0),ot.write_shift(2,65535),ot;var xe=0,ae=0,X=0,Ce=0;return pe<0&&(xe=1,pe=-pe),ae=Math.log2(pe)|0,pe/=Math.pow(2,ae-31),Ce=pe>>>0,Ce&2147483648||(pe/=2,++ae,Ce=pe>>>0),pe-=Ce,Ce|=2147483648,Ce>>>=0,pe*=Math.pow(2,32),X=pe>>>0,ot.write_shift(4,X),ot.write_shift(4,Ce),ae+=16383+(xe?32768:0),ot.write_shift(2,ae),ot}function re(oe,Me){var fe=J(oe);return oe.l+=Me-14,fe}function Fe(oe,Me){var fe=V(oe),pe=oe.read_shift(4);return fe[1].v=pe>>6,fe}function Ye(oe,Me){var fe=V(oe),pe=oe.read_shift(8,"f");return fe[1].v=pe,fe}function Ee(oe,Me){var fe=Ye(oe);return oe.l+=Me-12,fe}function ut(oe,Me){return oe[oe.l+Me-1]==0?oe.read_shift(Me,"cstr"):""}function Ne(oe,Me){var fe=oe[oe.l++];fe>Me-1&&(fe=Me-1);for(var pe="";pe.length<fe;)pe+=String.fromCharCode(oe[oe.l++]);return pe}function He(oe,Me,fe){if(!(!fe.qpro||Me<21)){var pe=oe.read_shift(1);oe.l+=17,oe.l+=1,oe.l+=2;var ot=oe.read_shift(Me-21,"cstr");return[pe,ot]}}function Oe(oe,Me){for(var fe={},pe=oe.l+Me;oe.l<pe;){var ot=oe.read_shift(2);if(ot==14e3){for(fe[ot]=[0,""],fe[ot][0]=oe.read_shift(2);oe[oe.l];)fe[ot][1]+=String.fromCharCode(oe[oe.l]),oe.l++;oe.l++}}return fe}function Pe(oe,Me){var fe=zt(5+oe.length);fe.write_shift(2,14e3),fe.write_shift(2,Me);for(var pe=0;pe<oe.length;++pe){var ot=oe.charCodeAt(pe);fe[fe.l++]=ot>127?95:ot}return fe[fe.l++]=0,fe}var rt={0:{n:"BOF",f:Ba},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:g},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:A},14:{n:"NUMBER",f:F},15:{n:"LABEL",f:T},16:{n:"FORMULA",f:O},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:I},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ut},222:{n:"SHEETNAMELP",f:Ne},255:{n:"BOF",f:Ba},21506:{n:"WKSNF",f:Ba},65535:{n:""}},et={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:D},23:{n:"NUMBER17",f:J},24:{n:"NUMBER18",f:ue},25:{n:"FORMULA19",f:re},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:Oe},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:Fe},38:{n:"??"},39:{n:"NUMBER27",f:Ye},40:{n:"FORMULA28",f:Ee},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ut},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:He},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}},Ge={5:"dd-mmm-yy",6:"dd-mmm",7:"mmm-yy",8:"mm/dd/yy",10:"hh:mm:ss AM/PM",11:"hh:mm AM/PM",14:"dd-mmm-yyyy",15:"mmm-yyyy",34:"0.00",50:"0.00;[Red]0.00",66:"0.00;(0.00)",82:"0.00;[Red](0.00)",162:'"$"#,##0;\\("$"#,##0\\)'};function ze(oe,Me){so(oe,0);var fe=Me||{},pe={};fe.dense&&(pe["!data"]=[]);var ot=[],xe="",ae={s:{r:-1,c:-1},e:{r:-1,c:-1}},X=0,Ce=0,he=0,G=0,K={SheetNames:[],Sheets:{}},se=[];e:for(;oe.l<oe.length;){var Ae=oe.read_shift(2),Se=oe.read_shift(2),ye=oe.slice(oe.l,oe.l+Se);switch(so(ye,0),Ae){case 1:if(ye.read_shift(4)!=962023505)throw"Bad QPW9 BOF!";break;case 2:break e;case 8:break;case 10:for(var Xe=ye.read_shift(4),be=(ye.length-ye.l)/Xe|0,Be=0;Be<Xe;++Be){var ct=ye.l+be,At={};ye.l+=2,At.numFmtId=ye.read_shift(2),Ge[At.numFmtId]&&(At.z=Ge[At.numFmtId]),ye.l=ct,se.push(At)}break;case 1025:break;case 1026:break;case 1031:for(ye.l+=12;ye.l<ye.length;)X=ye.read_shift(2),Ce=ye.read_shift(1),ot.push(ye.read_shift(X,"cstr"));break;case 1032:break;case 1537:{var $t=ye.read_shift(2);pe={},fe.dense&&(pe["!data"]=[]),ae.s.c=ye.read_shift(2),ae.e.c=ye.read_shift(2),ae.s.r=ye.read_shift(4),ae.e.r=ye.read_shift(4),ye.l+=4,ye.l+2<ye.length&&(X=ye.read_shift(2),Ce=ye.read_shift(1),xe=X==0?"":ye.read_shift(X,"cstr")),xe||(xe=Qn($t))}break;case 1538:{if(ae.s.c>255||ae.s.r>999999)break;ae.e.c<ae.s.c&&(ae.e.c=ae.s.c),ae.e.r<ae.s.r&&(ae.e.r=ae.s.r),pe["!ref"]=Xn(ae),_w(K,pe,xe)}break;case 2561:he=ye.read_shift(2),ae.e.c<he&&(ae.e.c=he),ae.s.c>he&&(ae.s.c=he),G=ye.read_shift(4),ae.s.r>G&&(ae.s.r=G),G=ye.read_shift(4),ae.e.r<G&&(ae.e.r=G);break;case 3073:{G=ye.read_shift(4),X=ye.read_shift(4),ae.s.r>G&&(ae.s.r=G),ae.e.r<G+X-1&&(ae.e.r=G+X-1);for(var mr=Qn(he);ye.l<ye.length;){var Nt={t:"z"},Lt=ye.read_shift(1),Qt=-1;Lt&128&&(Qt=ye.read_shift(2));var Gt=Lt&64?ye.read_shift(2)-1:0;switch(Lt&31){case 0:break;case 1:break;case 2:Nt={t:"n",v:ye.read_shift(2)};break;case 3:Nt={t:"n",v:ye.read_shift(2,"i")};break;case 4:Nt={t:"n",v:uw(ye)};break;case 5:Nt={t:"n",v:ye.read_shift(8,"f")};break;case 7:Nt={t:"s",v:ot[Ce=ye.read_shift(4)-1]};break;case 8:Nt={t:"n",v:ye.read_shift(8,"f")},ye.l+=2,ye.l+=4;break;default:throw"Unrecognized QPW cell type "+(Lt&31)}Qt!=-1&&(se[Qt-1]||{}).z&&(Nt.z=se[Qt-1].z);var dr=0;if(Lt&32)switch(Lt&31){case 2:dr=ye.read_shift(2);break;case 3:dr=ye.read_shift(2,"i");break;case 7:dr=ye.read_shift(2);break;default:throw"Unsupported delta for QPW cell type "+(Lt&31)}if(!(!fe.sheetStubs&&Nt.t=="z")){var Br=Qi(Nt);Nt.t=="n"&&Nt.z&&cl(Nt.z)&&fe.cellDates&&(Br.v=Zu(Nt.v),Br.t=typeof Br.v=="number"?"n":"d"),pe["!data"]!=null?(pe["!data"][G]||(pe["!data"][G]=[]),pe["!data"][G][he]=Br):pe[mr+vi(G)]=Br}for(++G,--X;Gt-- >0&&X>=0;){if(Lt&32)switch(Lt&31){case 2:Nt={t:"n",v:Nt.v+dr&65535};break;case 3:Nt={t:"n",v:Nt.v+dr&65535},Nt.v>32767&&(Nt.v-=65536);break;case 7:Nt={t:"s",v:ot[Ce=Ce+dr>>>0]};break;default:throw"Cannot apply delta for QPW cell type "+(Lt&31)}else switch(Lt&31){case 1:Nt={t:"z"};break;case 2:Nt={t:"n",v:ye.read_shift(2)};break;case 7:Nt={t:"s",v:ot[Ce=ye.read_shift(4)-1]};break;default:throw"Cannot apply repeat for QPW cell type "+(Lt&31)}!fe.sheetStubs&&Nt.t=="z"||(pe["!data"]!=null?(pe["!data"][G]||(pe["!data"][G]=[]),pe["!data"][G][he]=Nt):pe[mr+vi(G)]=Nt),++G,--X}}}break}oe.l+=Se}return K}return{sheet_to_wk1:c,book_to_wk3:f,to_workbook:n}}();function Obe(t){var n={},a=t.match(ko),s=0,c=!1;if(a)for(;s!=a.length;++s){var f=Kr(a[s]);switch(f[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!f.val)break;case"<shadow>":case"<shadow/>":n.shadow=1;break;case"</shadow>":break;case"<charset":if(f.val=="1")break;n.cp=gk[parseInt(f.val,10)];break;case"<outline":if(!f.val)break;case"<outline>":case"<outline/>":n.outline=1;break;case"</outline>":break;case"<rFont":n.name=f.val;break;case"<sz":n.sz=f.val;break;case"<strike":if(!f.val)break;case"<strike>":case"<strike/>":n.strike=1;break;case"</strike>":break;case"<u":if(!f.val)break;switch(f.val){case"double":n.uval="double";break;case"singleAccounting":n.uval="single-accounting";break;case"doubleAccounting":n.uval="double-accounting";break}case"<u>":case"<u/>":n.u=1;break;case"</u>":break;case"<b":if(f.val=="0")break;case"<b>":case"<b/>":n.b=1;break;case"</b>":break;case"<i":if(f.val=="0")break;case"<i>":case"<i/>":n.i=1;break;case"</i>":break;case"<color":f.rgb&&(n.color=f.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":n.family=f.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":n.valign=f.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":c=!0;break;case"</ext>":c=!1;break;default:if(f[0].charCodeAt(1)!==47&&!c)throw new Error("Unrecognized rich format "+f[0])}}return n}var Rbe=function(){var t=G_("t"),n=G_("rPr");function a(f){var d=f.match(t);if(!d)return{t:"s",v:""};var p={t:"s",v:bi(d[1])},g=f.match(n);return g&&(p.s=Obe(g[1])),p}var s=/<(?:\w+:)?r>/g,c=/<\/(?:\w+:)?r>/;return function(d){return d.replace(s,"").split(c).map(a).filter(function(p){return p.v})}}(),Lbe=function(){var n=/(\r\n|\n)/g;function a(c,f,d){var p=[];c.u&&p.push("text-decoration: underline;"),c.uval&&p.push("text-underline-style:"+c.uval+";"),c.sz&&p.push("font-size:"+c.sz+"pt;"),c.outline&&p.push("text-effect: outline;"),c.shadow&&p.push("text-shadow: auto;"),f.push('<span style="'+p.join("")+'">'),c.b&&(f.push("<b>"),d.push("</b>")),c.i&&(f.push("<i>"),d.push("</i>")),c.strike&&(f.push("<s>"),d.push("</s>"));var g=c.valign||"";return g=="superscript"||g=="super"?g="sup":g=="subscript"&&(g="sub"),g!=""&&(f.push("<"+g+">"),d.push("</"+g+">")),d.push("</span>"),c}function s(c){var f=[[],c.v,[]];return c.v?(c.s&&a(c.s,f[0],f[2]),f[0].join("")+f[1].replace(n,"<br/>")+f[2].join("")):""}return function(f){return f.map(s).join("")}}(),Dbe=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,Bbe=/<(?:\w+:)?r\b[^>]*>/,zbe=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function $k(t,n){var a=n?n.cellHTML:!0,s={};return t?(t.match(/^\s*<(?:\w+:)?t[^>]*>/)?(s.t=bi(Ki(t.slice(t.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||""),!0),s.r=Ki(t),a&&(s.h=sb(s.t))):t.match(Bbe)&&(s.r=Ki(t),s.t=bi(Ki((t.replace(zbe,"").match(Dbe)||[]).join("").replace(ko,"")),!0),a&&(s.h=Lbe(Rbe(s.r)))),s):{t:""}}var Nbe=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,Ube=/<(?:\w+:)?(?:si|sstItem)>/g,$be=/<\/(?:\w+:)?(?:si|sstItem)>/;function Vbe(t,n){var a=[],s="";if(!t)return a;var c=t.match(Nbe);if(c){s=c[2].replace(Ube,"").split($be);for(var f=0;f!=s.length;++f){var d=$k(s[f].trim(),n);d!=null&&(a[a.length]=d)}c=Kr(c[1]),a.Count=c.count,a.Unique=c.uniqueCount}return a}var jbe=/^\s|\s$|[\t\n\r]/;function Wbe(t,n){if(!n.bookSST)return"";var a=[Wa];a[a.length]=Er("sst",null,{xmlns:lp[0],count:t.Count,uniqueCount:t.Unique});for(var s=0;s!=t.length;++s)if(t[s]!=null){var c=t[s],f="<si>";c.r?f+=c.r:(f+="<t",c.t||(c.t=""),typeof c.t!="string"&&(c.t=String(c.t)),c.t.match(jbe)&&(f+=' xml:space="preserve"'),f+=">"+Yn(c.t)+"</t>"),f+="</si>",a[a.length]=f}return a.length>2&&(a[a.length]="</sst>",a[1]=a[1].replace("/>",">")),a.join("")}function Hbe(t){return[t.read_shift(4),t.read_shift(4)]}function Gbe(t,n){var a=[],s=!1;return ff(t,function(f,d,p){switch(p){case 159:a.Count=f[0],a.Unique=f[1];break;case 19:a.push(f);break;case 160:return!0;case 35:s=!0;break;case 36:s=!1;break;default:if(d.T,!s||n.WTF)throw new Error("Unexpected record 0x"+p.toString(16))}}),a}function qbe(t,n){return n||(n=zt(8)),n.write_shift(4,t.Count),n.write_shift(4,t.Unique),n}var Xbe=Y1e;function Zbe(t){var n=Go();rr(n,159,qbe(t));for(var a=0;a<t.length;++a)rr(n,19,Xbe(t[a]));return rr(n,160),n.end()}function z9(t){if(typeof Jn<"u")return Jn.utils.encode(Xd,t);for(var n=[],a=t.split(""),s=0;s<a.length;++s)n[s]=a[s].charCodeAt(0);return n}function Ku(t,n){var a={};return a.Major=t.read_shift(2),a.Minor=t.read_shift(2),n>=4&&(t.l+=n-4),a}function Kbe(t){var n={};return n.id=t.read_shift(0,"lpp4"),n.R=Ku(t,4),n.U=Ku(t,4),n.W=Ku(t,4),n}function Ybe(t){for(var n=t.read_shift(4),a=t.l+n-4,s={},c=t.read_shift(4),f=[];c-- >0;)f.push({t:t.read_shift(4),v:t.read_shift(0,"lpp4")});if(s.name=t.read_shift(0,"lpp4"),s.comps=f,t.l!=a)throw new Error("Bad DataSpaceMapEntry: "+t.l+" != "+a);return s}function Jbe(t){var n=[];t.l+=4;for(var a=t.read_shift(4);a-- >0;)n.push(Ybe(t));return n}function Qbe(t){var n=[];t.l+=4;for(var a=t.read_shift(4);a-- >0;)n.push(t.read_shift(0,"lpp4"));return n}function ewe(t){var n={};return t.read_shift(4),t.l+=4,n.id=t.read_shift(0,"lpp4"),n.name=t.read_shift(0,"lpp4"),n.R=Ku(t,4),n.U=Ku(t,4),n.W=Ku(t,4),n}function twe(t){var n=ewe(t);if(n.ename=t.read_shift(0,"8lpp4"),n.blksz=t.read_shift(4),n.cmode=t.read_shift(4),t.read_shift(4)!=4)throw new Error("Bad !Primary record");return n}function N9(t,n){var a=t.l+n,s={};s.Flags=t.read_shift(4)&63,t.l+=4,s.AlgID=t.read_shift(4);var c=!1;switch(s.AlgID){case 26126:case 26127:case 26128:c=s.Flags==36;break;case 26625:c=s.Flags==4;break;case 0:c=s.Flags==16||s.Flags==4||s.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+s.AlgID}if(!c)throw new Error("Encryption Flags/AlgID mismatch");return s.AlgIDHash=t.read_shift(4),s.KeySize=t.read_shift(4),s.ProviderType=t.read_shift(4),t.l+=8,s.CSPName=t.read_shift(a-t.l>>1,"utf16le"),t.l=a,s}function U9(t,n){var a={},s=t.l+n;return t.l+=4,a.Salt=t.slice(t.l,t.l+16),t.l+=16,a.Verifier=t.slice(t.l,t.l+16),t.l+=16,t.read_shift(4),a.VerifierHash=t.slice(t.l,s),t.l=s,a}function rwe(t){var n=Ku(t);switch(n.Minor){case 2:return[n.Minor,nwe(t)];case 3:return[n.Minor,iwe()];case 4:return[n.Minor,awe(t)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+n.Minor)}function nwe(t){var n=t.read_shift(4);if((n&63)!=36)throw new Error("EncryptionInfo mismatch");var a=t.read_shift(4),s=N9(t,a),c=U9(t,t.length-t.l);return{t:"Std",h:s,v:c}}function iwe(){throw new Error("File is password-protected: ECMA-376 Extensible")}function awe(t){var n=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];t.l+=4;var a=t.read_shift(t.length-t.l,"utf8"),s={};return a.replace(ko,function(f){var d=Kr(f);switch(Dl(d[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":n.forEach(function(p){s[p]=d[p]});break;case"<dataIntegrity":s.encryptedHmacKey=d.encryptedHmacKey,s.encryptedHmacValue=d.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":s.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":s.uri=d.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":s.encs.push(d);break;default:throw d[0]}}),s}function owe(t,n){var a={},s=a.EncryptionVersionInfo=Ku(t,4);if(n-=4,s.Minor!=2)throw new Error("unrecognized minor version code: "+s.Minor);if(s.Major>4||s.Major<2)throw new Error("unrecognized major version code: "+s.Major);a.Flags=t.read_shift(4),n-=4;var c=t.read_shift(4);return n-=4,a.EncryptionHeader=N9(t,c),n-=c,a.EncryptionVerifier=U9(t,n),a}function swe(t){var n={},a=n.EncryptionVersionInfo=Ku(t,4);if(a.Major!=1||a.Minor!=1)throw"unrecognized version code "+a.Major+" : "+a.Minor;return n.Salt=t.read_shift(16),n.EncryptedVerifier=t.read_shift(16),n.EncryptedVerifierHash=t.read_shift(16),n}function Vk(t){var n=0,a,s=z9(t),c=s.length+1,f,d,p,g,y;for(a=Ah(c),a[0]=s.length,f=1;f!=c;++f)a[f]=s[f-1];for(f=c-1;f>=0;--f)d=a[f],p=n&16384?1:0,g=n<<1&32767,y=p|g,n=y^d;return n^52811}var $9=function(){var t=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],n=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],a=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],s=function(d){return(d/2|d*128)&255},c=function(d,p){return s(d^p)},f=function(d){for(var p=n[d.length-1],g=104,y=d.length-1;y>=0;--y)for(var b=d[y],E=0;E!=7;++E)b&64&&(p^=a[g]),b*=2,--g;return p};return function(d){for(var p=z9(d),g=f(p),y=p.length,b=Ah(16),E=0;E!=16;++E)b[E]=0;var T,S,I;for((y&1)===1&&(T=g>>8,b[y]=c(t[0],T),--y,T=g&255,S=p[p.length-1],b[y]=c(S,T));y>0;)--y,T=g>>8,b[y]=c(p[y],T),--y,T=g&255,b[y]=c(p[y],T);for(y=15,I=15-p.length;I>0;)T=g>>8,b[y]=c(t[I],T),--y,--I,T=g&255,b[y]=c(p[y],T),--y,--I;return b}}(),lwe=function(t,n,a,s,c){c||(c=n),s||(s=$9(t));var f,d;for(f=0;f!=n.length;++f)d=n[f],d^=s[a],d=(d>>5|d<<3)&255,c[f]=d,++a;return[c,a,s]},cwe=function(t){var n=0,a=$9(t);return function(s){var c=lwe("",s,n,a);return n=c[1],c[0]}};function uwe(t,n,a,s){var c={key:Ba(t),verificationBytes:Ba(t)};return a.password&&(c.verifier=Vk(a.password)),s.valid=c.verificationBytes===c.verifier,s.valid&&(s.insitu=cwe(a.password)),c}function fwe(t,n,a){var s=a||{};return s.Info=t.read_shift(2),t.l-=2,s.Info===1?s.Data=swe(t):s.Data=owe(t,n),s}function hwe(t,n,a){var s={Type:a.biff>=8?t.read_shift(2):0};return s.Type?fwe(t,n-2,s):uwe(t,a.biff>=8?n:n-2,a,s),s}function dwe(t,n){switch(n.type){case"base64":return cx(ll(t),n);case"binary":return cx(t,n);case"buffer":return cx(oi&&Buffer.isBuffer(t)?t.toString("binary"):su(t),n);case"array":return cx(Kd(t),n)}throw new Error("Unrecognized type "+n.type)}function cx(t,n){var a=n||{},s={},c=a.dense;c&&(s["!data"]=[]);var f=t.match(/\\trowd[\s\S]*?\\row\b/g);if(!f)throw new Error("RTF missing table");var d={s:{c:0,r:0},e:{c:0,r:f.length-1}},p=[];return f.forEach(function(g,y){c&&(p=s["!data"][y]=[]);for(var b=/\\[\w\-]+\b/g,E=0,T,S=-1,I=[];(T=b.exec(g))!=null;){var A=g.slice(E,b.lastIndex-T[0].length);switch(A.charCodeAt(0)==32&&(A=A.slice(1)),A.length&&I.push(A),T[0]){case"\\cell":if(++S,I.length){var M={v:I.join(""),t:"s"};M.v=="TRUE"||M.v=="FALSE"?(M.v=M.v=="TRUE",M.t="b"):isNaN(sl(M.v))||(M.t="n",a.cellText!==!1&&(M.w=M.v),M.v=sl(M.v)),c?p[S]=M:s[ii({r:y,c:S})]=M}I=[];break;case"\\par":I.push(`
`);break}E=b.lastIndex}S>d.e.c&&(d.e.c=S)}),s["!ref"]=Xn(d),s}function pwe(t,n){var a=Bh(dwe(t,n),n);return a.bookType="rtf",a}function mwe(t,n){var a=["{\\rtf1\\ansi"];if(!t["!ref"])return a[0]+"}";for(var s=Ei(t["!ref"]),c,f=t["!data"]!=null,d=[],p=s.s.r;p<=s.e.r;++p){a.push("\\trowd\\trautofit1");for(var g=s.s.c;g<=s.e.c;++g)a.push("\\cellx"+(g+1));for(a.push("\\pard\\intbl"),f&&(d=t["!data"][p]||[]),g=s.s.c;g<=s.e.c;++g){var y=ii({r:p,c:g});if(c=f?d[g]:t[y],!c||c.v==null&&(!c.f||c.F)){a.push(" \\cell");continue}a.push(" "+(c.w||(lu(c),c.w)||"").replace(/[\r\n]/g,"\\par ")),a.push("\\cell")}a.push("\\pard\\intbl\\row")}return a.join("")+"}"}function gwe(t){var n=t.slice(t[0]==="#"?1:0).slice(0,6);return[parseInt(n.slice(0,2),16),parseInt(n.slice(2,4),16),parseInt(n.slice(4,6),16)]}function J_(t){for(var n=0,a=1;n!=3;++n)a=a*256+(t[n]>255?255:t[n]<0?0:t[n]);return a.toString(16).toUpperCase().slice(1)}function _we(t){var n=t[0]/255,a=t[1]/255,s=t[2]/255,c=Math.max(n,a,s),f=Math.min(n,a,s),d=c-f;if(d===0)return[0,0,n];var p=0,g=0,y=c+f;switch(g=d/(y>1?2-y:y),c){case n:p=((a-s)/d+6)%6;break;case a:p=(s-n)/d+2;break;case s:p=(n-a)/d+4;break}return[p/6,g,y/2]}function vwe(t){var n=t[0],a=t[1],s=t[2],c=a*2*(s<.5?s:1-s),f=s-c/2,d=[f,f,f],p=6*n,g;if(a!==0)switch(p|0){case 0:case 6:g=c*p,d[0]+=c,d[1]+=g;break;case 1:g=c*(2-p),d[0]+=g,d[1]+=c;break;case 2:g=c*(p-2),d[1]+=c,d[2]+=g;break;case 3:g=c*(4-p),d[1]+=g,d[2]+=c;break;case 4:g=c*(p-4),d[2]+=c,d[0]+=g;break;case 5:g=c*(6-p),d[2]+=g,d[0]+=c;break}for(var y=0;y!=3;++y)d[y]=Math.round(d[y]*255);return d}function hb(t,n){if(n===0)return t;var a=_we(gwe(t));return n<0?a[2]=a[2]*(1+n):a[2]=1-(1-a[2])*(1-n),J_(vwe(a))}var V9=6,ywe=15,xwe=1,No=V9;function Q_(t){return Math.floor((t+Math.round(128/No)/256)*No)}function ev(t){return Math.floor((t-5)/No*100+.5)/100}function db(t){return Math.round((t*No+5)/No*256)/256}function gS(t){return db(ev(Q_(t)))}function jk(t){var n=Math.abs(t-gS(t)),a=No;if(n>.005)for(No=xwe;No<ywe;++No)Math.abs(t-gS(t))<=n&&(n=Math.abs(t-gS(t)),a=No);No=a}function kh(t){t.width?(t.wpx=Q_(t.width),t.wch=ev(t.wpx),t.MDW=No):t.wpx?(t.wch=ev(t.wpx),t.width=db(t.wch),t.MDW=No):typeof t.wch=="number"&&(t.width=db(t.wch),t.wpx=Q_(t.width),t.MDW=No),t.customWidth&&delete t.customWidth}var bwe=96,j9=bwe;function tv(t){return t*96/j9}function sm(t){return t*j9/96}var wwe={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function Ewe(t,n,a,s){n.Borders=[];var c={},f=!1;(t[0].match(ko)||[]).forEach(function(d){var p=Kr(d);switch(Dl(p[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":c={},p.diagonalUp&&(c.diagonalUp=ji(p.diagonalUp)),p.diagonalDown&&(c.diagonalDown=ji(p.diagonalDown)),n.Borders.push(c);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":f=!0;break;case"</ext>":f=!1;break;default:if(s&&s.WTF&&!f)throw new Error("unrecognized "+p[0]+" in borders")}})}function Twe(t,n,a,s){n.Fills=[];var c={},f=!1;(t[0].match(ko)||[]).forEach(function(d){var p=Kr(d);switch(Dl(p[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":c={},n.Fills.push(c);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":n.Fills.push(c),c={};break;case"<patternFill":case"<patternFill>":p.patternType&&(c.patternType=p.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":c.bgColor||(c.bgColor={}),p.indexed&&(c.bgColor.indexed=parseInt(p.indexed,10)),p.theme&&(c.bgColor.theme=parseInt(p.theme,10)),p.tint&&(c.bgColor.tint=parseFloat(p.tint)),p.rgb&&(c.bgColor.rgb=p.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":c.fgColor||(c.fgColor={}),p.theme&&(c.fgColor.theme=parseInt(p.theme,10)),p.tint&&(c.fgColor.tint=parseFloat(p.tint)),p.rgb!=null&&(c.fgColor.rgb=p.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":f=!0;break;case"</ext>":f=!1;break;default:if(s&&s.WTF&&!f)throw new Error("unrecognized "+p[0]+" in fills")}})}function Swe(t,n,a,s){n.Fonts=[];var c={},f=!1;(t[0].match(ko)||[]).forEach(function(d){var p=Kr(d);switch(Dl(p[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":n.Fonts.push(c),c={};break;case"<name":p.val&&(c.name=Ki(p.val));break;case"<name/>":case"</name>":break;case"<b":c.bold=p.val?ji(p.val):1;break;case"<b/>":c.bold=1;break;case"<i":c.italic=p.val?ji(p.val):1;break;case"<i/>":c.italic=1;break;case"<u":switch(p.val){case"none":c.underline=0;break;case"single":c.underline=1;break;case"double":c.underline=2;break;case"singleAccounting":c.underline=33;break;case"doubleAccounting":c.underline=34;break}break;case"<u/>":c.underline=1;break;case"<strike":c.strike=p.val?ji(p.val):1;break;case"<strike/>":c.strike=1;break;case"<outline":c.outline=p.val?ji(p.val):1;break;case"<outline/>":c.outline=1;break;case"<shadow":c.shadow=p.val?ji(p.val):1;break;case"<shadow/>":c.shadow=1;break;case"<condense":c.condense=p.val?ji(p.val):1;break;case"<condense/>":c.condense=1;break;case"<extend":c.extend=p.val?ji(p.val):1;break;case"<extend/>":c.extend=1;break;case"<sz":p.val&&(c.sz=+p.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":p.val&&(c.vertAlign=p.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":p.val&&(c.family=parseInt(p.val,10));break;case"<family/>":case"</family>":break;case"<scheme":p.val&&(c.scheme=p.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(p.val=="1")break;p.codepage=gk[parseInt(p.val,10)];break;case"<color":if(c.color||(c.color={}),p.auto&&(c.color.auto=ji(p.auto)),p.rgb)c.color.rgb=p.rgb.slice(-6);else if(p.indexed){c.color.index=parseInt(p.indexed,10);var g=Nd[c.color.index];c.color.index==81&&(g=Nd[1]),g||(g=Nd[1]),c.color.rgb=g[0].toString(16)+g[1].toString(16)+g[2].toString(16)}else p.theme&&(c.color.theme=parseInt(p.theme,10),p.tint&&(c.color.tint=parseFloat(p.tint)),p.theme&&a.themeElements&&a.themeElements.clrScheme&&(c.color.rgb=hb(a.themeElements.clrScheme[c.color.theme].rgb,c.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":f=!0;break;case"</AlternateContent>":f=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":f=!0;break;case"</ext>":f=!1;break;default:if(s&&s.WTF&&!f)throw new Error("unrecognized "+p[0]+" in fonts")}})}function Cwe(t,n,a){n.NumberFmt=[];for(var s=Ma(pn),c=0;c<s.length;++c)n.NumberFmt[s[c]]=pn[s[c]];var f=t[0].match(ko);if(f)for(c=0;c<f.length;++c){var d=Kr(f[c]);switch(Dl(d[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var p=bi(Ki(d.formatCode)),g=parseInt(d.numFmtId,10);if(n.NumberFmt[g]=p,g>0){if(g>392){for(g=392;g>60&&n.NumberFmt[g]!=null;--g);n.NumberFmt[g]=p}Eh(p,g)}}break;case"</numFmt>":break;default:if(a.WTF)throw new Error("unrecognized "+d[0]+" in numFmts")}}}function Awe(t){var n=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var s=a[0];s<=a[1];++s)t[s]!=null&&(n[n.length]=Er("numFmt",null,{numFmtId:s,formatCode:Yn(t[s])}))}),n.length===1?"":(n[n.length]="</numFmts>",n[0]=Er("numFmts",null,{count:n.length-2}).replace("/>",">"),n.join(""))}var ux=["numFmtId","fillId","fontId","borderId","xfId"],fx=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function kwe(t,n,a){n.CellXf=[];var s,c=!1;(t[0].match(ko)||[]).forEach(function(f){var d=Kr(f),p=0;switch(Dl(d[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(s=d,delete s[0],p=0;p<ux.length;++p)s[ux[p]]&&(s[ux[p]]=parseInt(s[ux[p]],10));for(p=0;p<fx.length;++p)s[fx[p]]&&(s[fx[p]]=ji(s[fx[p]]));if(n.NumberFmt&&s.numFmtId>392){for(p=392;p>60;--p)if(n.NumberFmt[s.numFmtId]==n.NumberFmt[p]){s.numFmtId=p;break}}n.CellXf.push(s);break;case"</xf>":break;case"<alignment":case"<alignment/>":var g={};d.vertical&&(g.vertical=d.vertical),d.horizontal&&(g.horizontal=d.horizontal),d.textRotation!=null&&(g.textRotation=d.textRotation),d.indent&&(g.indent=d.indent),d.wrapText&&(g.wrapText=ji(d.wrapText)),s.alignment=g;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":c=!0;break;case"</AlternateContent>":c=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":c=!0;break;case"</ext>":c=!1;break;default:if(a&&a.WTF&&!c)throw new Error("unrecognized "+d[0]+" in cellXfs")}})}function Iwe(t){var n=[];return n[n.length]=Er("cellXfs",null),t.forEach(function(a){n[n.length]=Er("xf",null,a)}),n[n.length]="</cellXfs>",n.length===2?"":(n[0]=Er("cellXfs",null,{count:n.length-2}).replace("/>",">"),n.join(""))}var Mwe=function(){var n=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,a=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,s=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,c=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,f=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(p,g,y){var b={};if(!p)return b;p=p.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var E;return(E=p.match(n))&&Cwe(E,b,y),(E=p.match(c))&&Swe(E,b,g,y),(E=p.match(s))&&Twe(E,b,g,y),(E=p.match(f))&&Ewe(E,b,g,y),(E=p.match(a))&&kwe(E,b,y),b}}();function Fwe(t,n){var a=[Wa,Er("styleSheet",null,{xmlns:lp[0],"xmlns:vt":uo.vt})],s;return t.SSF&&(s=Awe(t.SSF))!=null&&(a[a.length]=s),a[a.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',a[a.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',a[a.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',a[a.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(s=Iwe(n.cellXfs))&&(a[a.length]=s),a[a.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',a[a.length]='<dxfs count="0"/>',a[a.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',a.length>2&&(a[a.length]="</styleSheet>",a[1]=a[1].replace("/>",">")),a.join("")}function Pwe(t,n){var a=t.read_shift(2),s=qo(t);return[a,s]}function Owe(t,n,a){a||(a=zt(6+4*n.length)),a.write_shift(2,t),fo(n,a);var s=a.length>a.l?a.slice(0,a.l):a;return a.l==null&&(a.l=a.length),s}function Rwe(t,n,a){var s={};s.sz=t.read_shift(2)/20;var c=iye(t);c.fItalic&&(s.italic=1),c.fCondense&&(s.condense=1),c.fExtend&&(s.extend=1),c.fShadow&&(s.shadow=1),c.fOutline&&(s.outline=1),c.fStrikeout&&(s.strike=1);var f=t.read_shift(2);switch(f===700&&(s.bold=1),t.read_shift(2)){case 1:s.vertAlign="superscript";break;case 2:s.vertAlign="subscript";break}var d=t.read_shift(1);d!=0&&(s.underline=d);var p=t.read_shift(1);p>0&&(s.family=p);var g=t.read_shift(1);switch(g>0&&(s.charset=g),t.l++,s.color=nye(t),t.read_shift(1)){case 1:s.scheme="major";break;case 2:s.scheme="minor";break}return s.name=qo(t),s}function Lwe(t,n){n||(n=zt(25+4*32)),n.write_shift(2,t.sz*20),aye(t,n),n.write_shift(2,t.bold?700:400);var a=0;t.vertAlign=="superscript"?a=1:t.vertAlign=="subscript"&&(a=2),n.write_shift(2,a),n.write_shift(1,t.underline||0),n.write_shift(1,t.family||0),n.write_shift(1,t.charset||0),n.write_shift(1,0),cb(t.color,n);var s=0;return t.scheme=="major"&&(s=1),t.scheme=="minor"&&(s=2),n.write_shift(1,s),fo(t.name,n),n.length>n.l?n.slice(0,n.l):n}var Dwe=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],_S,Bwe=Zo;function b6(t,n){n||(n=zt(4*3+8*7+16*1)),_S||(_S=iw(Dwe));var a=_S[t.patternType];a==null&&(a=40),n.write_shift(4,a);var s=0;if(a!=40)for(cb({auto:1},n),cb({auto:1},n);s<12;++s)n.write_shift(4,0);else{for(;s<4;++s)n.write_shift(4,0);for(;s<12;++s)n.write_shift(4,0)}return n.length>n.l?n.slice(0,n.l):n}function zwe(t,n){var a=t.l+n,s=t.read_shift(2),c=t.read_shift(2);return t.l=a,{ixfe:s,numFmtId:c}}function W9(t,n,a){a||(a=zt(16)),a.write_shift(2,n||0),a.write_shift(2,t.numFmtId||0),a.write_shift(2,0),a.write_shift(2,0),a.write_shift(2,0),a.write_shift(1,0),a.write_shift(1,0);var s=0;return a.write_shift(1,s),a.write_shift(1,0),a.write_shift(1,0),a.write_shift(1,0),a}function Ug(t,n){return n||(n=zt(10)),n.write_shift(1,0),n.write_shift(1,0),n.write_shift(4,0),n.write_shift(4,0),n}var Nwe=Zo;function Uwe(t,n){return n||(n=zt(51)),n.write_shift(1,0),Ug(null,n),Ug(null,n),Ug(null,n),Ug(null,n),Ug(null,n),n.length>n.l?n.slice(0,n.l):n}function $we(t,n){return n||(n=zt(12+4*10)),n.write_shift(4,t.xfId),n.write_shift(2,1),n.write_shift(1,+t.builtinId),n.write_shift(1,0),K_(t.name||"",n),n.length>n.l?n.slice(0,n.l):n}function Vwe(t,n,a){var s=zt(2052);return s.write_shift(4,t),K_(n,s),K_(a,s),s.length>s.l?s.slice(0,s.l):s}function jwe(t,n,a){var s={};s.NumberFmt=[];for(var c in pn)s.NumberFmt[c]=pn[c];s.CellXf=[],s.Fonts=[];var f=[],d=!1;return ff(t,function(g,y,b){switch(b){case 44:s.NumberFmt[g[0]]=g[1],Eh(g[1],g[0]);break;case 43:s.Fonts.push(g),g.color.theme!=null&&n&&n.themeElements&&n.themeElements.clrScheme&&(g.color.rgb=hb(n.themeElements.clrScheme[g.color.theme].rgb,g.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:f[f.length-1]==617&&s.CellXf.push(g);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:d=!0;break;case 36:d=!1;break;case 37:f.push(b),d=!0;break;case 38:f.pop(),d=!1;break;default:if(y.T>0)f.push(b);else if(y.T<0)f.pop();else if(!d||a.WTF&&f[f.length-1]!=37)throw new Error("Unexpected record 0x"+b.toString(16))}}),s}function Wwe(t,n){if(n){var a=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(s){for(var c=s[0];c<=s[1];++c)n[c]!=null&&++a}),a!=0&&(rr(t,615,cc(a)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(s){for(var c=s[0];c<=s[1];++c)n[c]!=null&&rr(t,44,Owe(c,n[c]))}),rr(t,616))}}function Hwe(t){var n=1;rr(t,611,cc(n)),rr(t,43,Lwe({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),rr(t,612)}function Gwe(t){var n=2;rr(t,603,cc(n)),rr(t,45,b6({patternType:"none"})),rr(t,45,b6({patternType:"gray125"})),rr(t,604)}function qwe(t){var n=1;rr(t,613,cc(n)),rr(t,46,Uwe()),rr(t,614)}function Xwe(t){var n=1;rr(t,626,cc(n)),rr(t,47,W9({numFmtId:0,fontId:0,fillId:0,borderId:0},65535)),rr(t,627)}function Zwe(t,n){rr(t,617,cc(n.length)),n.forEach(function(a){rr(t,47,W9(a,0))}),rr(t,618)}function Kwe(t){var n=1;rr(t,619,cc(n)),rr(t,48,$we({xfId:0,builtinId:0,name:"Normal"})),rr(t,620)}function Ywe(t){var n=0;rr(t,505,cc(n)),rr(t,506)}function Jwe(t){var n=0;rr(t,508,Vwe(n,"TableStyleMedium9","PivotStyleMedium4")),rr(t,509)}function Qwe(t,n){var a=Go();return rr(a,278),Wwe(a,t.SSF),Hwe(a),Gwe(a),qwe(a),Xwe(a),Zwe(a,n.cellXfs),Kwe(a),Ywe(a),Jwe(a),rr(a,279),a.end()}var e2e=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function t2e(t,n,a){n.themeElements.clrScheme=[];var s={};(t[0].match(ko)||[]).forEach(function(c){var f=Kr(c);switch(f[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":s.rgb=f.val;break;case"<a:sysClr":s.rgb=f.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":f[0].charAt(1)==="/"?(n.themeElements.clrScheme[e2e.indexOf(f[0])]=s,s={}):s.name=f[0].slice(3,f[0].length-1);break;default:if(a&&a.WTF)throw new Error("Unrecognized "+f[0]+" in clrScheme")}})}function r2e(){}function n2e(){}var i2e=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,a2e=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,o2e=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function s2e(t,n,a){n.themeElements={};var s;[["clrScheme",i2e,t2e],["fontScheme",a2e,r2e],["fmtScheme",o2e,n2e]].forEach(function(c){if(!(s=t.match(c[1])))throw new Error(c[0]+" not found in themeElements");c[2](s,n,a)})}var l2e=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function H9(t,n){(!t||t.length===0)&&(t=Wk());var a,s={};if(!(a=t.match(l2e)))throw new Error("themeElements not found in theme");return s2e(a[0],s,n),s.raw=t,s}function Wk(t,n){if(n&&n.themeXLSX)return n.themeXLSX;if(t&&typeof t.raw=="string")return t.raw;var a=[Wa];return a[a.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',a[a.length]="<a:themeElements>",a[a.length]='<a:clrScheme name="Office">',a[a.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',a[a.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',a[a.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',a[a.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',a[a.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',a[a.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',a[a.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',a[a.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',a[a.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',a[a.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',a[a.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',a[a.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',a[a.length]="</a:clrScheme>",a[a.length]='<a:fontScheme name="Office">',a[a.length]="<a:majorFont>",a[a.length]='<a:latin typeface="Cambria"/>',a[a.length]='<a:ea typeface=""/>',a[a.length]='<a:cs typeface=""/>',a[a.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',a[a.length]='<a:font script="Hang" typeface="맑은 고딕"/>',a[a.length]='<a:font script="Hans" typeface="宋体"/>',a[a.length]='<a:font script="Hant" typeface="新細明體"/>',a[a.length]='<a:font script="Arab" typeface="Times New Roman"/>',a[a.length]='<a:font script="Hebr" typeface="Times New Roman"/>',a[a.length]='<a:font script="Thai" typeface="Tahoma"/>',a[a.length]='<a:font script="Ethi" typeface="Nyala"/>',a[a.length]='<a:font script="Beng" typeface="Vrinda"/>',a[a.length]='<a:font script="Gujr" typeface="Shruti"/>',a[a.length]='<a:font script="Khmr" typeface="MoolBoran"/>',a[a.length]='<a:font script="Knda" typeface="Tunga"/>',a[a.length]='<a:font script="Guru" typeface="Raavi"/>',a[a.length]='<a:font script="Cans" typeface="Euphemia"/>',a[a.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',a[a.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',a[a.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',a[a.length]='<a:font script="Thaa" typeface="MV Boli"/>',a[a.length]='<a:font script="Deva" typeface="Mangal"/>',a[a.length]='<a:font script="Telu" typeface="Gautami"/>',a[a.length]='<a:font script="Taml" typeface="Latha"/>',a[a.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',a[a.length]='<a:font script="Orya" typeface="Kalinga"/>',a[a.length]='<a:font script="Mlym" typeface="Kartika"/>',a[a.length]='<a:font script="Laoo" typeface="DokChampa"/>',a[a.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',a[a.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',a[a.length]='<a:font script="Viet" typeface="Times New Roman"/>',a[a.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',a[a.length]='<a:font script="Geor" typeface="Sylfaen"/>',a[a.length]="</a:majorFont>",a[a.length]="<a:minorFont>",a[a.length]='<a:latin typeface="Calibri"/>',a[a.length]='<a:ea typeface=""/>',a[a.length]='<a:cs typeface=""/>',a[a.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',a[a.length]='<a:font script="Hang" typeface="맑은 고딕"/>',a[a.length]='<a:font script="Hans" typeface="宋体"/>',a[a.length]='<a:font script="Hant" typeface="新細明體"/>',a[a.length]='<a:font script="Arab" typeface="Arial"/>',a[a.length]='<a:font script="Hebr" typeface="Arial"/>',a[a.length]='<a:font script="Thai" typeface="Tahoma"/>',a[a.length]='<a:font script="Ethi" typeface="Nyala"/>',a[a.length]='<a:font script="Beng" typeface="Vrinda"/>',a[a.length]='<a:font script="Gujr" typeface="Shruti"/>',a[a.length]='<a:font script="Khmr" typeface="DaunPenh"/>',a[a.length]='<a:font script="Knda" typeface="Tunga"/>',a[a.length]='<a:font script="Guru" typeface="Raavi"/>',a[a.length]='<a:font script="Cans" typeface="Euphemia"/>',a[a.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',a[a.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',a[a.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',a[a.length]='<a:font script="Thaa" typeface="MV Boli"/>',a[a.length]='<a:font script="Deva" typeface="Mangal"/>',a[a.length]='<a:font script="Telu" typeface="Gautami"/>',a[a.length]='<a:font script="Taml" typeface="Latha"/>',a[a.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',a[a.length]='<a:font script="Orya" typeface="Kalinga"/>',a[a.length]='<a:font script="Mlym" typeface="Kartika"/>',a[a.length]='<a:font script="Laoo" typeface="DokChampa"/>',a[a.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',a[a.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',a[a.length]='<a:font script="Viet" typeface="Arial"/>',a[a.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',a[a.length]='<a:font script="Geor" typeface="Sylfaen"/>',a[a.length]="</a:minorFont>",a[a.length]="</a:fontScheme>",a[a.length]='<a:fmtScheme name="Office">',a[a.length]="<a:fillStyleLst>",a[a.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',a[a.length]='<a:gradFill rotWithShape="1">',a[a.length]="<a:gsLst>",a[a.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',a[a.length]="</a:gsLst>",a[a.length]='<a:lin ang="16200000" scaled="1"/>',a[a.length]="</a:gradFill>",a[a.length]='<a:gradFill rotWithShape="1">',a[a.length]="<a:gsLst>",a[a.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',a[a.length]="</a:gsLst>",a[a.length]='<a:lin ang="16200000" scaled="0"/>',a[a.length]="</a:gradFill>",a[a.length]="</a:fillStyleLst>",a[a.length]="<a:lnStyleLst>",a[a.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',a[a.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',a[a.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',a[a.length]="</a:lnStyleLst>",a[a.length]="<a:effectStyleLst>",a[a.length]="<a:effectStyle>",a[a.length]="<a:effectLst>",a[a.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',a[a.length]="</a:effectLst>",a[a.length]="</a:effectStyle>",a[a.length]="<a:effectStyle>",a[a.length]="<a:effectLst>",a[a.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',a[a.length]="</a:effectLst>",a[a.length]="</a:effectStyle>",a[a.length]="<a:effectStyle>",a[a.length]="<a:effectLst>",a[a.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',a[a.length]="</a:effectLst>",a[a.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',a[a.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',a[a.length]="</a:effectStyle>",a[a.length]="</a:effectStyleLst>",a[a.length]="<a:bgFillStyleLst>",a[a.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',a[a.length]='<a:gradFill rotWithShape="1">',a[a.length]="<a:gsLst>",a[a.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',a[a.length]="</a:gsLst>",a[a.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',a[a.length]="</a:gradFill>",a[a.length]='<a:gradFill rotWithShape="1">',a[a.length]="<a:gsLst>",a[a.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',a[a.length]="</a:gsLst>",a[a.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',a[a.length]="</a:gradFill>",a[a.length]="</a:bgFillStyleLst>",a[a.length]="</a:fmtScheme>",a[a.length]="</a:themeElements>",a[a.length]="<a:objectDefaults>",a[a.length]="<a:spDef>",a[a.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',a[a.length]="</a:spDef>",a[a.length]="<a:lnDef>",a[a.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',a[a.length]="</a:lnDef>",a[a.length]="</a:objectDefaults>",a[a.length]="<a:extraClrSchemeLst/>",a[a.length]="</a:theme>",a.join("")}function c2e(t,n,a){var s=t.l+n,c=t.read_shift(4);if(c!==124226){if(!a.cellStyles){t.l=s;return}var f=t.slice(t.l);t.l=s;var d;try{d=jU(f,{type:"array"})}catch{return}var p=hs(d,"theme/theme/theme1.xml",!0);if(p)return H9(p,a)}}function u2e(t){return t.read_shift(4)}function f2e(t){var n={};switch(n.xclrType=t.read_shift(2),n.nTintShade=t.read_shift(2),n.xclrType){case 0:t.l+=4;break;case 1:n.xclrValue=h2e(t,4);break;case 2:n.xclrValue=C9(t);break;case 3:n.xclrValue=u2e(t);break;case 4:t.l+=4;break}return t.l+=8,n}function h2e(t,n){return Zo(t,n)}function d2e(t,n){return Zo(t,n)}function p2e(t){var n=t.read_shift(2),a=t.read_shift(2)-4,s=[n];switch(n){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:s[1]=f2e(t);break;case 6:s[1]=d2e(t,a);break;case 14:case 15:s[1]=t.read_shift(a===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+n+" "+a)}return s}function m2e(t,n){var a=t.l+n;t.l+=2;var s=t.read_shift(2);t.l+=2;for(var c=t.read_shift(2),f=[];c-- >0;)f.push(p2e(t,a-t.l));return{ixfe:s,ext:f}}function g2e(t,n){n.forEach(function(a){switch(a[0]){}})}function _2e(t,n){return{flags:t.read_shift(4),version:t.read_shift(4),name:qo(t)}}function v2e(t){var n=zt(12+2*t.name.length);return n.write_shift(4,t.flags),n.write_shift(4,t.version),fo(t.name,n),n.slice(0,n.l)}function y2e(t){for(var n=[],a=t.read_shift(4);a-- >0;)n.push([t.read_shift(4),t.read_shift(4)]);return n}function x2e(t){var n=zt(4+8*t.length);n.write_shift(4,t.length);for(var a=0;a<t.length;++a)n.write_shift(4,t[a][0]),n.write_shift(4,t[a][1]);return n}function b2e(t,n){var a=zt(8+2*n.length);return a.write_shift(4,t),fo(n,a),a.slice(0,a.l)}function w2e(t){return t.l+=4,t.read_shift(4)!=0}function E2e(t,n){var a=zt(8);return a.write_shift(4,t),a.write_shift(4,n?1:0),a}function T2e(t,n,a){var s={Types:[],Cell:[],Value:[]},c=a||{},f=[],d=!1,p=2;return ff(t,function(g,y,b){switch(b){case 335:s.Types.push({name:g.name});break;case 51:g.forEach(function(E){p==1?s.Cell.push({type:s.Types[E[0]-1].name,index:E[1]}):p==0&&s.Value.push({type:s.Types[E[0]-1].name,index:E[1]})});break;case 337:p=g?1:0;break;case 338:p=2;break;case 35:f.push(b),d=!0;break;case 36:f.pop(),d=!1;break;default:if(!y.T){if(!d||c.WTF&&f[f.length-1]!=35)throw new Error("Unexpected record 0x"+b.toString(16))}}}),s}function S2e(){var t=Go();return rr(t,332),rr(t,334,cc(1)),rr(t,335,v2e({name:"XLDAPR",version:12e4,flags:3496657072})),rr(t,336),rr(t,339,b2e(1,"XLDAPR")),rr(t,52),rr(t,35,cc(514)),rr(t,4096,cc(0)),rr(t,4097,Sl(1)),rr(t,36),rr(t,53),rr(t,340),rr(t,337,E2e(1,!0)),rr(t,51,x2e([[1,0]])),rr(t,338),rr(t,333),t.end()}function C2e(t,n,a){var s={Types:[],Cell:[],Value:[]};if(!t)return s;var c=!1,f=2,d;return t.replace(ko,function(p){var g=Kr(p);switch(Dl(g[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":s.Types.push({name:g.name});break;case"</metadataType>":break;case"<futureMetadata":for(var y=0;y<s.Types.length;++y)s.Types[y].name==g.name&&(d=s.Types[y]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":f==1?s.Cell.push({type:s.Types[g.t-1].name,index:+g.v}):f==0&&s.Value.push({type:s.Types[g.t-1].name,index:+g.v});break;case"</rc>":break;case"<cellMetadata":f=1;break;case"</cellMetadata>":f=2;break;case"<valueMetadata":f=0;break;case"</valueMetadata>":f=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":c=!0;break;case"</ext>":c=!1;break;case"<rvb":if(!d)break;d.offsets||(d.offsets=[]),d.offsets.push(+g.i);break;default:if(!c&&(a!=null&&a.WTF))throw new Error("unrecognized "+g[0]+" in metadata")}return p}),s}function A2e(){var t=[Wa];return t.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),t.join("")}function k2e(t){var n=[];if(!t)return n;var a=1;return(t.match(ko)||[]).forEach(function(s){var c=Kr(s);switch(c[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete c[0],c.i?a=c.i:c.i=a,n.push(c);break}}),n}function I2e(t){var n={};n.i=t.read_shift(4);var a={};a.r=t.read_shift(4),a.c=t.read_shift(4),n.r=ii(a);var s=t.read_shift(1);return s&2&&(n.l="1"),s&8&&(n.a="1"),n}function M2e(t,n,a){var s=[];return ff(t,function(f,d,p){switch(p){case 63:s.push(f);break;default:if(!d.T)throw new Error("Unexpected record 0x"+p.toString(16))}}),s}function F2e(t,n,a,s){if(!t)return t;var c=s||{},f=!1;ff(t,function(p,g,y){switch(y){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:f=!0;break;case 36:f=!1;break;default:if(!g.T){if(!f||c.WTF)throw new Error("Unexpected record 0x"+y.toString(16))}}},c)}function P2e(t,n){if(!t)return"??";var a=(t.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return n["!id"][a].Target}var O2e=/<(?:\w+:)?shape(?:[^\w][^>]*)?>([\s\S]*?)<\/(?:\w+:)?shape>/g;function R2e(t,n,a){var s=0;(t.match(O2e)||[]).forEach(function(c){var f="",d=!0,p=-1,g=-1,y=-1;switch(c.replace(ko,function(E,T){var S=Kr(E);switch(Dl(S[0])){case"<ClientData":S.ObjectType&&(f=S.ObjectType);break;case"<Visible":case"<Visible/>":d=!1;break;case"<Row":case"<Row>":p=T+E.length;break;case"</Row>":g=+c.slice(p,T).trim();break;case"<Column":case"<Column>":p=T+E.length;break;case"</Column>":y=+c.slice(p,T).trim();break}return""}),f){case"Note":var b=ov(n,g>=0&&y>=0?ii({r:g,c:y}):a[s].ref);b.c&&(b.c.hidden=d),++s;break}})}function G9(t,n,a){var s=[21600,21600],c=["m0,0l0",s[1],s[0],s[1],s[0],"0xe"].join(","),f=[Er("xml",null,{"xmlns:v":nl.v,"xmlns:o":nl.o,"xmlns:x":nl.x,"xmlns:mv":nl.mv}).replace(/\/>/,">"),Er("o:shapelayout",Er("o:idmap",null,{"v:ext":"edit",data:t}),{"v:ext":"edit"})],d=65536*t,p=n||[];return p.length>0&&f.push(Er("v:shapetype",[Er("v:stroke",null,{joinstyle:"miter"}),Er("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202",coordsize:s.join(","),"o:spt":202,path:c})),p.forEach(function(g){++d,f.push(L2e(g,d))}),f.push("</xml>"),f.join("")}function L2e(t,n,a){var s=Yi(t[0]),c={color2:"#BEFF82",type:"gradient"};c.type=="gradient"&&(c.angle="-180");var f=c.type=="gradient"?Er("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,d=Er("v:fill",f,c),p={on:"t",obscured:"t"};return["<v:shape"+q_({id:"_x0000_s"+n,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(t[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",d,Er("v:shadow",null,p),Er("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Co("x:Anchor",[s.c+1,0,s.r+1,0,s.c+3,20,s.r+5,20].join(",")),Co("x:AutoFill","False"),Co("x:Row",String(s.r)),Co("x:Column",String(s.c)),t[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"].join("")}function w6(t,n,a,s){var c=t["!data"]!=null,f;n.forEach(function(d){var p=Yi(d.ref);if(!(p.r<0||p.c<0)){if(c?(t["!data"][p.r]||(t["!data"][p.r]=[]),f=t["!data"][p.r][p.c]):f=t[d.ref],!f){f={t:"z"},c?t["!data"][p.r][p.c]=f:t[d.ref]=f;var g=Ei(t["!ref"]||"BDWGO1000001:A1");g.s.r>p.r&&(g.s.r=p.r),g.e.r<p.r&&(g.e.r=p.r),g.s.c>p.c&&(g.s.c=p.c),g.e.c<p.c&&(g.e.c=p.c);var y=Xn(g);t["!ref"]=y}f.c||(f.c=[]);var b={a:d.author,t:d.t,r:d.r,T:a};d.h&&(b.h=d.h);for(var E=f.c.length-1;E>=0;--E){if(!a&&f.c[E].T)return;a&&!f.c[E].T&&f.c.splice(E,1)}if(a&&s){for(E=0;E<s.length;++E)if(b.a==s[E].id){b.a=s[E].name||b.a;break}}f.c.push(b)}})}function D2e(t,n){if(t.match(/<(?:\w+:)?comments *\/>/))return[];var a=[],s=[],c=t.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);c&&c[1]&&c[1].split(/<\/\w*:?author>/).forEach(function(d){if(!(d===""||d.trim()==="")){var p=d.match(/<(?:\w+:)?author[^>]*>(.*)/);p&&a.push(p[1])}});var f=t.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return f&&f[1]&&f[1].split(/<\/\w*:?comment>/).forEach(function(d){if(!(d===""||d.trim()==="")){var p=d.match(/<(?:\w+:)?comment[^>]*>/);if(p){var g=Kr(p[0]),y={author:g.authorId&&a[g.authorId]||"sheetjsghost",ref:g.ref,guid:g.guid},b=Yi(g.ref);if(!(n.sheetRows&&n.sheetRows<=b.r)){var E=d.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),T=!!E&&!!E[1]&&$k(E[1])||{r:"",t:"",h:""};y.r=T.r,T.r=="<t></t>"&&(T.t=T.h=""),y.t=(T.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),n.cellHTML&&(y.h=T.h),s.push(y)}}}}),s}function B2e(t){var n=[Wa,Er("comments",null,{xmlns:lp[0]})],a=[];return n.push("<authors>"),t.forEach(function(s){s[1].forEach(function(c){var f=Yn(c.a);a.indexOf(f)==-1&&(a.push(f),n.push("<author>"+f+"</author>")),c.T&&c.ID&&a.indexOf("tc="+c.ID)==-1&&(a.push("tc="+c.ID),n.push("<author>tc="+c.ID+"</author>"))})}),a.length==0&&(a.push("SheetJ5"),n.push("<author>SheetJ5</author>")),n.push("</authors>"),n.push("<commentList>"),t.forEach(function(s){var c=0,f=[],d=0;if(s[1][0]&&s[1][0].T&&s[1][0].ID&&(c=a.indexOf("tc="+s[1][0].ID)),s[1].forEach(function(y){y.a&&(c=a.indexOf(Yn(y.a))),y.T&&++d,f.push(y.t==null?"":Yn(y.t))}),d===0)s[1].forEach(function(y){n.push('<comment ref="'+s[0]+'" authorId="'+a.indexOf(Yn(y.a))+'"><text>'),n.push(Co("t",y.t==null?"":Yn(y.t))),n.push("</text></comment>")});else{s[1][0]&&s[1][0].T&&s[1][0].ID&&(c=a.indexOf("tc="+s[1][0].ID)),n.push('<comment ref="'+s[0]+'" authorId="'+c+'"><text>');for(var p=`Comment:
    `+f[0]+`
`,g=1;g<f.length;++g)p+=`Reply:
    `+f[g]+`
`;n.push(Co("t",Yn(p))),n.push("</text></comment>")}}),n.push("</commentList>"),n.length>2&&(n[n.length]="</comments>",n[1]=n[1].replace("/>",">")),n.join("")}function z2e(t,n){var a=[],s=!1,c={},f=0;return t.replace(ko,function(p,g){var y=Kr(p);switch(Dl(y[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":c={author:y.personId,guid:y.id,ref:y.ref,T:1};break;case"</threadedComment>":c.t!=null&&a.push(c);break;case"<text>":case"<text":f=g+p.length;break;case"</text>":c.t=t.slice(f,g).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":s=!0;break;case"</mentions>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(!s&&n.WTF)throw new Error("unrecognized "+y[0]+" in threaded comments")}return p}),a}function q9(t,n,a){var s=[Wa,Er("ThreadedComments",null,{xmlns:uo.TCMNT}).replace(/[\/]>/,">")];return t.forEach(function(c){var f="";(c[1]||[]).forEach(function(d,p){if(!d.T){delete d.ID;return}d.a&&n.indexOf(d.a)==-1&&n.push(d.a);var g={ref:c[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+a.tcid++).slice(-12)+"}"};p==0?f=g.id:g.parentId=f,d.ID=g.id,d.a&&(g.personId="{54EE7950-7262-4200-6969-"+("000000000000"+n.indexOf(d.a)).slice(-12)+"}"),s.push(Er("threadedComment",Co("text",d.t||""),g))})}),s.push("</ThreadedComments>"),s.join("")}function N2e(t,n){var a=[],s=!1;return t.replace(ko,function(f){var d=Kr(f);switch(Dl(d[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":a.push({name:d.displayname,id:d.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(!s&&n.WTF)throw new Error("unrecognized "+d[0]+" in threaded comments")}return f}),a}function X9(t){var n=[Wa,Er("personList",null,{xmlns:uo.TCMNT,"xmlns:x":lp[0]}).replace(/[\/]>/,">")];return t.forEach(function(a,s){n.push(Er("person",null,{displayName:a,id:"{54EE7950-7262-4200-6969-"+("000000000000"+s).slice(-12)+"}",userId:a,providerId:"None"}))}),n.push("</personList>"),n.join("")}function U2e(t){var n={};n.iauthor=t.read_shift(4);var a=hp(t);return n.rfx=a.s,n.ref=ii(a.s),t.l+=16,n}function $2e(t,n){return n==null&&(n=zt(36)),n.write_shift(4,t[1].iauthor),wm(t[0],n),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(4,0),n}var V2e=qo;function E6(t){return fo(t.slice(0,54))}function j2e(t,n){var a=[],s=[],c={},f=!1;return ff(t,function(p,g,y){switch(y){case 632:s.push(p);break;case 635:c=p;break;case 637:c.t=p.t,c.h=p.h,c.r=p.r;break;case 636:if(c.author=s[c.iauthor],delete c.iauthor,n.sheetRows&&c.rfx&&n.sheetRows<=c.rfx.r)break;c.t||(c.t=""),delete c.rfx,a.push(c);break;case 3072:break;case 35:f=!0;break;case 36:f=!1;break;case 37:break;case 38:break;default:if(!g.T){if(!f||n.WTF)throw new Error("Unexpected record 0x"+y.toString(16))}}}),a}function W2e(t){var n=Go(),a=[];return rr(n,628),rr(n,630),t.forEach(function(s){s[1].forEach(function(c){a.indexOf(c.a)>-1||(a.push(c.a.slice(0,54)),rr(n,632,E6(c.a)),c.T&&c.ID&&a.indexOf("tc="+c.ID)==-1&&(a.push("tc="+c.ID),rr(n,632,E6("tc="+c.ID))))})}),rr(n,631),rr(n,633),t.forEach(function(s){s[1].forEach(function(c){var f=-1;c.ID&&(f=a.indexOf("tc="+c.ID)),f==-1&&s[1][0].T&&s[1][0].ID&&(f=a.indexOf("tc="+s[1][0].ID)),f==-1&&(f=a.indexOf(c.a)),c.iauthor=f;var d={s:Yi(s[0]),e:Yi(s[0])};rr(n,635,$2e([d,c])),c.t&&c.t.length>0&&rr(n,637,Q1e(c)),rr(n,636),delete c.iauthor})}),rr(n,634),rr(n,629),n.end()}var H2e="application/vnd.ms-office.vbaProject";function G2e(t){var n=_n.utils.cfb_new({root:"R"});return t.FullPaths.forEach(function(a,s){if(!(a.slice(-1)==="/"||!a.match(/_VBA_PROJECT_CUR/))){var c=a.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");_n.utils.cfb_add(n,c,t.FileIndex[s].content)}}),_n.write(n)}function q2e(t,n){n.FullPaths.forEach(function(a,s){if(s!=0){var c=a.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");c.slice(-1)!=="/"&&_n.utils.cfb_add(t,c,n.FileIndex[s].content)}})}var X2e=["xlsb","xlsm","xlam","biff8","xla"];function Z2e(){return{"!type":"dialog"}}function K2e(){return{"!type":"dialog"}}function Y2e(){return{"!type":"macro"}}function J2e(){return{"!type":"macro"}}var Vd=function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,n={r:0,c:0};function a(s,c,f,d){var p=!1,g=!1;f.length==0?g=!0:f.charAt(0)=="["&&(g=!0,f=f.slice(1,-1)),d.length==0?p=!0:d.charAt(0)=="["&&(p=!0,d=d.slice(1,-1));var y=f.length>0?parseInt(f,10)|0:0,b=d.length>0?parseInt(d,10)|0:0;return p?b+=n.c:--b,g?y+=n.r:--y,c+(p?"":"$")+Qn(b)+(g?"":"$")+vi(y)}return function(c,f){return n=f,c.replace(t,a)}}(),Hk=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,hw=function(){return function(n,a){return n.replace(Hk,function(s,c,f,d,p,g){var y=Pk(d)-(f?0:a.c),b=Fk(g)-(p?0:a.r),E=p=="$"?b+1:b==0?"":"["+b+"]",T=f=="$"?y+1:y==0?"":"["+y+"]";return c+"R"+E+"C"+T})}}();function Z9(t,n){return t.replace(Hk,function(a,s,c,f,d,p){return s+(c=="$"?c+f:Qn(Pk(f)+n.c))+(d=="$"?d+p:vi(Fk(p)+n.r))})}function T6(t,n,a){var s=ho(n),c=s.s,f=Yi(a),d={r:f.r-c.r,c:f.c-c.c};return Z9(t,d)}function Q2e(t){return t.length!=1}function S6(t){return t.replace(/_xlfn\./g,"")}function Za(t){t.l+=1}function Ih(t,n){var a=t.read_shift(n==1?1:2);return[a&16383,a>>14&1,a>>15&1]}function K9(t,n,a){var s=2;if(a){if(a.biff>=2&&a.biff<=5)return Y9(t);a.biff==12&&(s=4)}var c=t.read_shift(s),f=t.read_shift(s),d=Ih(t,2),p=Ih(t,2);return{s:{r:c,c:d[0],cRel:d[1],rRel:d[2]},e:{r:f,c:p[0],cRel:p[1],rRel:p[2]}}}function Y9(t){var n=Ih(t,2),a=Ih(t,2),s=t.read_shift(1),c=t.read_shift(1);return{s:{r:n[0],c:s,cRel:n[1],rRel:n[2]},e:{r:a[0],c,cRel:a[1],rRel:a[2]}}}function eEe(t,n,a){if(a.biff<8)return Y9(t);var s=t.read_shift(a.biff==12?4:2),c=t.read_shift(a.biff==12?4:2),f=Ih(t,2),d=Ih(t,2);return{s:{r:s,c:f[0],cRel:f[1],rRel:f[2]},e:{r:c,c:d[0],cRel:d[1],rRel:d[2]}}}function J9(t,n,a){if(a&&a.biff>=2&&a.biff<=5)return tEe(t);var s=t.read_shift(a&&a.biff==12?4:2),c=Ih(t,2);return{r:s,c:c[0],cRel:c[1],rRel:c[2]}}function tEe(t){var n=Ih(t,2),a=t.read_shift(1);return{r:n[0],c:a,cRel:n[1],rRel:n[2]}}function rEe(t){var n=t.read_shift(2),a=t.read_shift(2);return{r:n,c:a&255,fQuoted:!!(a&16384),cRel:a>>15,rRel:a>>15}}function nEe(t,n,a){var s=a&&a.biff?a.biff:8;if(s>=2&&s<=5)return iEe(t);var c=t.read_shift(s>=12?4:2),f=t.read_shift(2),d=(f&16384)>>14,p=(f&32768)>>15;if(f&=16383,p==1)for(;c>524287;)c-=1048576;if(d==1)for(;f>8191;)f=f-16384;return{r:c,c:f,cRel:d,rRel:p}}function iEe(t){var n=t.read_shift(2),a=t.read_shift(1),s=(n&32768)>>15,c=(n&16384)>>14;return n&=16383,s==1&&n>=8192&&(n=n-16384),c==1&&a>=128&&(a=a-256),{r:n,c:a,cRel:c,rRel:s}}function aEe(t,n,a){var s=(t[t.l++]&96)>>5,c=K9(t,a.biff>=2&&a.biff<=5?6:8,a);return[s,c]}function oEe(t,n,a){var s=(t[t.l++]&96)>>5,c=t.read_shift(2,"i"),f=8;if(a)switch(a.biff){case 5:t.l+=12,f=6;break;case 12:f=12;break}var d=K9(t,f,a);return[s,c,d]}function sEe(t,n,a){var s=(t[t.l++]&96)>>5;return t.l+=a&&a.biff>8?12:a.biff<8?6:8,[s]}function lEe(t,n,a){var s=(t[t.l++]&96)>>5,c=t.read_shift(2),f=8;if(a)switch(a.biff){case 5:t.l+=12,f=6;break;case 12:f=12;break}return t.l+=f,[s,c]}function cEe(t,n,a){var s=(t[t.l++]&96)>>5,c=eEe(t,n-1,a);return[s,c]}function uEe(t,n,a){var s=(t[t.l++]&96)>>5;return t.l+=a.biff==2?6:a.biff==12?14:7,[s]}function C6(t){var n=t[t.l+1]&1,a=1;return t.l+=4,[n,a]}function fEe(t,n,a){t.l+=2;for(var s=t.read_shift(a&&a.biff==2?1:2),c=[],f=0;f<=s;++f)c.push(t.read_shift(a&&a.biff==2?1:2));return c}function hEe(t,n,a){var s=t[t.l+1]&255?1:0;return t.l+=2,[s,t.read_shift(a&&a.biff==2?1:2)]}function dEe(t,n,a){var s=t[t.l+1]&255?1:0;return t.l+=2,[s,t.read_shift(a&&a.biff==2?1:2)]}function pEe(t){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(2)]}function mEe(t,n,a){var s=t[t.l+1]&255?1:0;return t.l+=a&&a.biff==2?3:4,[s]}function Q9(t){var n=t.read_shift(1),a=t.read_shift(1);return[n,a]}function gEe(t){return t.read_shift(2),Q9(t)}function _Ee(t){return t.read_shift(2),Q9(t)}function vEe(t,n,a){var s=(t[t.l]&96)>>5;t.l+=1;var c=J9(t,0,a);return[s,c]}function yEe(t,n,a){var s=(t[t.l]&96)>>5;t.l+=1;var c=nEe(t,0,a);return[s,c]}function xEe(t,n,a){var s=(t[t.l]&96)>>5;t.l+=1;var c=t.read_shift(2);a&&a.biff==5&&(t.l+=12);var f=J9(t,0,a);return[s,c,f]}function bEe(t,n,a){var s=(t[t.l]&96)>>5;t.l+=1;var c=t.read_shift(a&&a.biff<=3?1:2);return[LTe[c],r7[c],s]}function wEe(t,n,a){var s=t[t.l++],c=t.read_shift(1),f=a&&a.biff<=3?[s==88?-1:0,t.read_shift(1)]:EEe(t);return[c,(f[0]===0?r7:RTe)[f[1]]]}function EEe(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function TEe(t,n,a){t.l+=a&&a.biff==2?3:4}function SEe(t,n,a){if(t.l++,a&&a.biff==12)return[t.read_shift(4,"i"),0];var s=t.read_shift(2),c=t.read_shift(a&&a.biff==2?1:2);return[s,c]}function CEe(t){return t.l++,uc[t.read_shift(1)]}function AEe(t){return t.l++,t.read_shift(2)}function kEe(t){return t.l++,t.read_shift(1)!==0}function IEe(t){return t.l++,Vo(t)}function MEe(t,n,a){return t.l++,am(t,n-1,a)}function FEe(t,n){var a=[t.read_shift(1)];if(n==12)switch(a[0]){case 2:a[0]=4;break;case 4:a[0]=16;break;case 0:a[0]=1;break;case 1:a[0]=2;break}switch(a[0]){case 4:a[1]=$a(t,1)?"TRUE":"FALSE",n!=12&&(t.l+=7);break;case 37:case 16:a[1]=uc[t[t.l]],t.l+=n==12?4:8;break;case 0:t.l+=8;break;case 1:a[1]=Vo(t);break;case 2:a[1]=dp(t,0,{biff:n>0&&n<8?2:n});break;default:throw new Error("Bad SerAr: "+a[0])}return a}function PEe(t,n,a){for(var s=t.read_shift(a.biff==12?4:2),c=[],f=0;f!=s;++f)c.push((a.biff==12?hp:fw)(t));return c}function OEe(t,n,a){var s=0,c=0;a.biff==12?(s=t.read_shift(4),c=t.read_shift(4)):(c=1+t.read_shift(1),s=1+t.read_shift(2)),a.biff>=2&&a.biff<8&&(--s,--c==0&&(c=256));for(var f=0,d=[];f!=s&&(d[f]=[]);++f)for(var p=0;p!=c;++p)d[f][p]=FEe(t,a.biff);return d}function REe(t,n,a){var s=t.read_shift(1)>>>5&3,c=!a||a.biff>=8?4:2,f=t.read_shift(c);switch(a.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[s,0,f]}function LEe(t,n,a){if(a.biff==5)return DEe(t);var s=t.read_shift(1)>>>5&3,c=t.read_shift(2),f=t.read_shift(4);return[s,c,f]}function DEe(t){var n=t.read_shift(1)>>>5&3,a=t.read_shift(2,"i");t.l+=8;var s=t.read_shift(2);return t.l+=12,[n,a,s]}function BEe(t,n,a){var s=t.read_shift(1)>>>5&3;t.l+=a&&a.biff==2?3:4;var c=t.read_shift(a&&a.biff==2?1:2);return[s,c]}function zEe(t,n,a){var s=t.read_shift(1)>>>5&3,c=t.read_shift(a&&a.biff==2?1:2);return[s,c]}function NEe(t,n,a){var s=t.read_shift(1)>>>5&3;return t.l+=4,a.biff<8&&t.l--,a.biff==12&&(t.l+=2),[s]}function UEe(t,n,a){var s=(t[t.l++]&96)>>5,c=t.read_shift(2),f=4;if(a)switch(a.biff){case 5:f=15;break;case 12:f=6;break}return t.l+=f,[s,c]}var $Ee=Zo,VEe=Zo,jEe=Zo;function Cv(t,n,a){return t.l+=2,[rEe(t)]}function Gk(t){return t.l+=6,[]}var WEe=Cv,HEe=Gk,GEe=Gk,qEe=Cv;function e7(t){return t.l+=2,[Ba(t),t.read_shift(2)&1]}var XEe=Cv,ZEe=e7,KEe=Gk,YEe=Cv,JEe=Cv,QEe=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function eTe(t){t.l+=2;var n=t.read_shift(2),a=t.read_shift(2),s=t.read_shift(4),c=t.read_shift(2),f=t.read_shift(2),d=QEe[a>>2&31];return{ixti:n,coltype:a&3,rt:d,idx:s,c,C:f}}function tTe(t){return t.l+=2,[t.read_shift(4)]}function rTe(t,n,a){return t.l+=5,t.l+=2,t.l+=a.biff==2?1:4,["PTGSHEET"]}function nTe(t,n,a){return t.l+=a.biff==2?4:5,["PTGENDSHEET"]}function iTe(t){var n=t.read_shift(1)>>>5&3,a=t.read_shift(2);return[n,a]}function aTe(t){var n=t.read_shift(1)>>>5&3,a=t.read_shift(2);return[n,a]}function oTe(t){return t.l+=4,[0,0]}var A6={1:{n:"PtgExp",f:SEe},2:{n:"PtgTbl",f:jEe},3:{n:"PtgAdd",f:Za},4:{n:"PtgSub",f:Za},5:{n:"PtgMul",f:Za},6:{n:"PtgDiv",f:Za},7:{n:"PtgPower",f:Za},8:{n:"PtgConcat",f:Za},9:{n:"PtgLt",f:Za},10:{n:"PtgLe",f:Za},11:{n:"PtgEq",f:Za},12:{n:"PtgGe",f:Za},13:{n:"PtgGt",f:Za},14:{n:"PtgNe",f:Za},15:{n:"PtgIsect",f:Za},16:{n:"PtgUnion",f:Za},17:{n:"PtgRange",f:Za},18:{n:"PtgUplus",f:Za},19:{n:"PtgUminus",f:Za},20:{n:"PtgPercent",f:Za},21:{n:"PtgParen",f:Za},22:{n:"PtgMissArg",f:Za},23:{n:"PtgStr",f:MEe},26:{n:"PtgSheet",f:rTe},27:{n:"PtgEndSheet",f:nTe},28:{n:"PtgErr",f:CEe},29:{n:"PtgBool",f:kEe},30:{n:"PtgInt",f:AEe},31:{n:"PtgNum",f:IEe},32:{n:"PtgArray",f:uEe},33:{n:"PtgFunc",f:bEe},34:{n:"PtgFuncVar",f:wEe},35:{n:"PtgName",f:REe},36:{n:"PtgRef",f:vEe},37:{n:"PtgArea",f:aEe},38:{n:"PtgMemArea",f:BEe},39:{n:"PtgMemErr",f:$Ee},40:{n:"PtgMemNoMem",f:VEe},41:{n:"PtgMemFunc",f:zEe},42:{n:"PtgRefErr",f:NEe},43:{n:"PtgAreaErr",f:sEe},44:{n:"PtgRefN",f:yEe},45:{n:"PtgAreaN",f:cEe},46:{n:"PtgMemAreaN",f:iTe},47:{n:"PtgMemNoMemN",f:aTe},57:{n:"PtgNameX",f:LEe},58:{n:"PtgRef3d",f:xEe},59:{n:"PtgArea3d",f:oEe},60:{n:"PtgRefErr3d",f:UEe},61:{n:"PtgAreaErr3d",f:lEe},255:{}},sTe={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},lTe={1:{n:"PtgElfLel",f:e7},2:{n:"PtgElfRw",f:YEe},3:{n:"PtgElfCol",f:WEe},6:{n:"PtgElfRwV",f:JEe},7:{n:"PtgElfColV",f:qEe},10:{n:"PtgElfRadical",f:XEe},11:{n:"PtgElfRadicalS",f:KEe},13:{n:"PtgElfColS",f:HEe},15:{n:"PtgElfColSV",f:GEe},16:{n:"PtgElfRadicalLel",f:ZEe},25:{n:"PtgList",f:eTe},29:{n:"PtgSxName",f:tTe},255:{}},cTe={0:{n:"PtgAttrNoop",f:oTe},1:{n:"PtgAttrSemi",f:mEe},2:{n:"PtgAttrIf",f:dEe},4:{n:"PtgAttrChoose",f:fEe},8:{n:"PtgAttrGoto",f:hEe},16:{n:"PtgAttrSum",f:TEe},32:{n:"PtgAttrBaxcel",f:C6},33:{n:"PtgAttrBaxcel",f:C6},64:{n:"PtgAttrSpace",f:gEe},65:{n:"PtgAttrSpaceSemi",f:_Ee},128:{n:"PtgAttrIfError",f:pEe},255:{}};function Av(t,n,a,s){if(s.biff<8)return Zo(t,n);for(var c=t.l+n,f=[],d=0;d!==a.length;++d)switch(a[d][0]){case"PtgArray":a[d][1]=OEe(t,0,s),f.push(a[d][1]);break;case"PtgMemArea":a[d][2]=PEe(t,a[d][1],s),f.push(a[d][2]);break;case"PtgExp":s&&s.biff==12&&(a[d][1][1]=t.read_shift(4),f.push(a[d][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+a[d][0]}return n=c-t.l,n!==0&&f.push(Zo(t,n)),f}function kv(t,n,a){for(var s=t.l+n,c,f,d=[];s!=t.l;)n=s-t.l,f=t[t.l],c=A6[f]||A6[sTe[f]],(f===24||f===25)&&(c=(f===24?lTe:cTe)[t[t.l+1]]),!c||!c.f?Zo(t,n):d.push([c.n,c.f(t,n,a)]);return d}function uTe(t){for(var n=[],a=0;a<t.length;++a){for(var s=t[a],c=[],f=0;f<s.length;++f){var d=s[f];if(d)switch(d[0]){case 2:c.push('"'+d[1].replace(/"/g,'""')+'"');break;default:c.push(d[1])}else c.push("")}n.push(c.join(","))}return n.join(";")}var fTe={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function hTe(t,n){var a=t.lastIndexOf("!"),s=n.lastIndexOf("!");return a==-1&&s==-1?t+":"+n:a>0&&s>0&&t.slice(0,a).toLowerCase()==n.slice(0,s).toLowerCase()?t+":"+n.slice(s+1):(console.error("Cannot hydrate range",t,n),t+":"+n)}function t7(t,n,a){if(!t)return"SH33TJSERR0";if(a.biff>8&&(!t.XTI||!t.XTI[n]))return t.SheetNames[n];if(!t.XTI)return"SH33TJSERR6";var s=t.XTI[n];if(a.biff<8)return n>1e4&&(n-=65536),n<0&&(n=-n),n==0?"":t.XTI[n-1];if(!s)return"SH33TJSERR1";var c="";if(a.biff>8)switch(t[s[0]][0]){case 357:return c=s[1]==-1?"#REF":t.SheetNames[s[1]],s[1]==s[2]?c:c+":"+t.SheetNames[s[2]];case 358:return a.SID!=null?t.SheetNames[a.SID]:"SH33TJSSAME"+t[s[0]][0];case 355:default:return"SH33TJSSRC"+t[s[0]][0]}switch(t[s[0]][0][0]){case 1025:return c=s[1]==-1?"#REF":t.SheetNames[s[1]]||"SH33TJSERR3",s[1]==s[2]?c:c+":"+t.SheetNames[s[2]];case 14849:return t[s[0]].slice(1).map(function(f){return f.Name}).join(";;");default:return t[s[0]][0][3]?(c=s[1]==-1?"#REF":t[s[0]][0][3][s[1]]||"SH33TJSERR4",s[1]==s[2]?c:c+":"+t[s[0]][0][3][s[2]]):"SH33TJSERR2"}}function k6(t,n,a){var s=t7(t,n,a);return s=="#REF"?s:Z_(s,a)}function zo(t,n,a,s,c){var f=c&&c.biff||8,d={s:{c:0,r:0},e:{c:0,r:0}},p=[],g,y,b,E=0,T=0,S,I="";if(!t[0]||!t[0][0])return"";for(var A=-1,M="",F=0,L=t[0].length;F<L;++F){var O=t[0][F];switch(O[0]){case"PtgUminus":p.push("-"+p.pop());break;case"PtgUplus":p.push("+"+p.pop());break;case"PtgPercent":p.push(p.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(g=p.pop(),y=p.pop(),A>=0){switch(t[0][A][1][0]){case 0:M=Mi(" ",t[0][A][1][1]);break;case 1:M=Mi("\r",t[0][A][1][1]);break;default:if(M="",c.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][A][1][0])}y=y+M,A=-1}p.push(y+fTe[O[0]]+g);break;case"PtgIsect":g=p.pop(),y=p.pop(),p.push(y+" "+g);break;case"PtgUnion":g=p.pop(),y=p.pop(),p.push(y+","+g);break;case"PtgRange":g=p.pop(),y=p.pop(),p.push(hTe(y,g));break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":b=f_(O[1][1],d,c),p.push(h_(b,f));break;case"PtgRefN":b=a?f_(O[1][1],a,c):O[1][1],p.push(h_(b,f));break;case"PtgRef3d":E=O[1][1],b=f_(O[1][2],d,c),I=k6(s,E,c),p.push(I+"!"+h_(b,f));break;case"PtgFunc":case"PtgFuncVar":var N=O[1][0],Q=O[1][1];N||(N=0),N&=127;var ie=N==0?[]:p.slice(-N);p.length-=N,Q==="User"&&(Q=ie.shift()),p.push(Q+"("+ie.join(",")+")");break;case"PtgBool":p.push(O[1]?"TRUE":"FALSE");break;case"PtgInt":p.push(O[1]);break;case"PtgNum":p.push(String(O[1]));break;case"PtgStr":p.push('"'+O[1].replace(/"/g,'""')+'"');break;case"PtgErr":p.push(O[1]);break;case"PtgAreaN":S=t6(O[1][1],a?{s:a}:d,c),p.push(fS(S,c));break;case"PtgArea":S=t6(O[1][1],d,c),p.push(fS(S,c));break;case"PtgArea3d":E=O[1][1],S=O[1][2],I=k6(s,E,c),p.push(I+"!"+fS(S,c));break;case"PtgAttrSum":p.push("SUM("+p.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":T=O[1][2];var j=(s.names||[])[T-1]||(s[0]||[])[T],V=j?j.Name:"SH33TJSNAME"+String(T);V&&V.slice(0,6)=="_xlfn."&&!c.xlfn&&(V=V.slice(6)),p.push(V);break;case"PtgNameX":var D=O[1][1];T=O[1][2];var te;if(c.biff<=5)D<0&&(D=-D),s[D]&&(te=s[D][T]);else{var ue="";if(((s[D]||[])[0]||[])[0]==14849||(((s[D]||[])[0]||[])[0]==1025?s[D][T]&&s[D][T].itab>0&&(ue=s.SheetNames[s[D][T].itab-1]+"!"):ue=s.SheetNames[T-1]+"!"),s[D]&&s[D][T])ue+=s[D][T].Name;else if(s[0]&&s[0][T])ue+=s[0][T].Name;else{var J=(t7(s,D,c)||"").split(";;");J[T-1]?ue=J[T-1]:ue+="SH33TJSERRX"}p.push(ue);break}te||(te={Name:"SH33TJSERRY"}),p.push(te.Name);break;case"PtgParen":var le="(",re=")";if(A>=0){switch(M="",t[0][A][1][0]){case 2:le=Mi(" ",t[0][A][1][1])+le;break;case 3:le=Mi("\r",t[0][A][1][1])+le;break;case 4:re=Mi(" ",t[0][A][1][1])+re;break;case 5:re=Mi("\r",t[0][A][1][1])+re;break;default:if(c.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][A][1][0])}A=-1}p.push(le+p.pop()+re);break;case"PtgRefErr":p.push("#REF!");break;case"PtgRefErr3d":p.push("#REF!");break;case"PtgExp":b={c:O[1][1],r:O[1][0]};var Fe={c:a.c,r:a.r};if(s.sharedf[ii(b)]){var Ye=s.sharedf[ii(b)];p.push(zo(Ye,d,Fe,s,c))}else{var Ee=!1;for(g=0;g!=s.arrayf.length;++g)if(y=s.arrayf[g],!(b.c<y[0].s.c||b.c>y[0].e.c)&&!(b.r<y[0].s.r||b.r>y[0].e.r)){p.push(zo(y[1],d,Fe,s,c)),Ee=!0;break}Ee||p.push(O[1])}break;case"PtgArray":p.push("{"+uTe(O[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":A=F;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":p.push("");break;case"PtgAreaErr":p.push("#REF!");break;case"PtgAreaErr3d":p.push("#REF!");break;case"PtgList":p.push("Table"+O[1].idx+"[#"+O[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(O));default:throw new Error("Unrecognized Formula Token: "+String(O))}var ut=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(c.biff!=3&&A>=0&&ut.indexOf(t[0][F][0])==-1){O=t[0][A];var Ne=!0;switch(O[1][0]){case 4:Ne=!1;case 0:M=Mi(" ",O[1][1]);break;case 5:Ne=!1;case 1:M=Mi("\r",O[1][1]);break;default:if(M="",c.WTF)throw new Error("Unexpected PtgAttrSpaceType "+O[1][0])}p.push((Ne?M:"")+p.pop()+(Ne?"":M)),A=-1}}if(p.length>1&&c.WTF)throw new Error("bad formula stack");return p[0]=="TRUE"?!0:p[0]=="FALSE"?!1:p[0]}function dTe(t,n,a){var s=t.l+n,c=a.biff==2?1:2,f,d=t.read_shift(c);if(d==65535)return[[],Zo(t,n-2)];var p=kv(t,d,a);return n!==d+c&&(f=Av(t,n-d-c,p,a)),t.l=s,[p,f]}function pTe(t,n,a){var s=t.l+n,c=a.biff==2?1:2,f,d=t.read_shift(c);if(d==65535)return[[],Zo(t,n-2)];var p=kv(t,d,a);return n!==d+c&&(f=Av(t,n-d-c,p,a)),t.l=s,[p,f]}function mTe(t,n,a,s){var c=t.l+n,f=kv(t,s,a),d;return c!==t.l&&(d=Av(t,c-t.l,f,a)),[f,d]}function gTe(t,n,a){var s=t.l+n,c,f=t.read_shift(2),d=kv(t,f,a);return f==65535?[[],Zo(t,n-2)]:(n!==f+2&&(c=Av(t,s-f-2,d,a)),[d,c])}function _Te(t){var n;if(Hu(t,t.l+6)!==65535)return[Vo(t),"n"];switch(t[t.l]){case 0:return t.l+=8,["String","s"];case 1:return n=t[t.l+2]===1,t.l+=8,[n,"b"];case 2:return n=t[t.l+2],t.l+=8,[n,"e"];case 3:return t.l+=8,["","s"]}return[]}function vTe(t){if(t==null){var n=zt(8);return n.write_shift(1,3),n.write_shift(1,0),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,65535),n}else if(typeof t=="number")return Jd(t);return Jd(0)}function vS(t,n,a){var s=t.l+n,c=Tc(t,6,a),f=_Te(t),d=t.read_shift(1);a.biff!=2&&(t.read_shift(1),a.biff>=5&&t.read_shift(4));var p=pTe(t,s-t.l,a);return{cell:c,val:f[0],formula:p,shared:d>>3&1,tt:f[1]}}function yTe(t,n,a,s,c){var f=ep(n,a,c),d=vTe(t.v),p=zt(6),g=33;p.write_shift(2,g),p.write_shift(4,0);for(var y=zt(t.bf.length),b=0;b<t.bf.length;++b)y[b]=t.bf[b];var E=Va([f,d,p,y]);return E}function dw(t,n,a){var s=t.read_shift(4),c=kv(t,s,a),f=t.read_shift(4),d=f>0?Av(t,f,c,a):null;return[c,d]}var xTe=dw,pw=dw,bTe=dw,wTe=dw;function I6(t){if((t|0)==t&&t<Math.pow(2,16)&&t>=0){var n=zt(11);return n.write_shift(4,3),n.write_shift(1,30),n.write_shift(2,t),n.write_shift(4,0),n}var a=zt(17);return a.write_shift(4,11),a.write_shift(1,31),a.write_shift(8,t),a.write_shift(4,0),a}function ETe(t){var n=zt(10);return n.write_shift(4,2),n.write_shift(1,28),n.write_shift(1,t),n.write_shift(4,0),n}function TTe(t){var n=zt(10);return n.write_shift(4,2),n.write_shift(1,29),n.write_shift(1,t?1:0),n.write_shift(4,0),n}function STe(t){var n=zt(7);n.write_shift(4,3+2*t.length),n.write_shift(1,23),n.write_shift(2,t.length);var a=zt(2*t.length);a.write_shift(2*t.length,t,"utf16le");var s=zt(4);return s.write_shift(4,0),Va([n,a,s])}function CTe(t){var n=Yi(t),a=zt(15);return a.write_shift(4,7),a.write_shift(1,36),a.write_shift(4,n.r),a.write_shift(2,n.c|(t.charAt(0)=="$"?0:1)<<14|(t.match(/\$\d/)?0:1)<<15),a.write_shift(4,0),a}function ATe(t,n){var a=t.lastIndexOf("!"),s=t.slice(0,a);t=t.slice(a+1);var c=Yi(t);s.charAt(0)=="'"&&(s=s.slice(1,-1).replace(/''/g,"'"));var f=zt(17);return f.write_shift(4,9),f.write_shift(1,58),f.write_shift(2,2+n.SheetNames.map(function(d){return d.toLowerCase()}).indexOf(s.toLowerCase())),f.write_shift(4,c.r),f.write_shift(2,c.c|(t.charAt(0)=="$"?0:1)<<14|(t.match(/\$\d/)?0:1)<<15),f.write_shift(4,0),f}function kTe(t,n){var a=t.lastIndexOf("!"),s=t.slice(0,a);t=t.slice(a+1),s.charAt(0)=="'"&&(s=s.slice(1,-1).replace(/''/g,"'"));var c=zt(17);return c.write_shift(4,9),c.write_shift(1,60),c.write_shift(2,2+n.SheetNames.map(function(f){return f.toLowerCase()}).indexOf(s.toLowerCase())),c.write_shift(4,0),c.write_shift(2,0),c.write_shift(4,0),c}function ITe(t){var n=t.split(":"),a=n[0],s=zt(23);s.write_shift(4,15),a=n[0];var c=Yi(a);return s.write_shift(1,36),s.write_shift(4,c.r),s.write_shift(2,c.c|(a.charAt(0)=="$"?0:1)<<14|(a.match(/\$\d/)?0:1)<<15),s.write_shift(4,0),a=n[1],c=Yi(a),s.write_shift(1,36),s.write_shift(4,c.r),s.write_shift(2,c.c|(a.charAt(0)=="$"?0:1)<<14|(a.match(/\$\d/)?0:1)<<15),s.write_shift(4,0),s.write_shift(1,17),s.write_shift(4,0),s}function MTe(t,n){var a=t.lastIndexOf("!"),s=t.slice(0,a);t=t.slice(a+1),s.charAt(0)=="'"&&(s=s.slice(1,-1).replace(/''/g,"'"));var c=t.split(":"),f=zt(27);f.write_shift(4,19);var d=c[0],p=Yi(d);return f.write_shift(1,58),f.write_shift(2,2+n.SheetNames.map(function(g){return g.toLowerCase()}).indexOf(s.toLowerCase())),f.write_shift(4,p.r),f.write_shift(2,p.c|(d.charAt(0)=="$"?0:1)<<14|(d.match(/\$\d/)?0:1)<<15),d=c[1],p=Yi(d),f.write_shift(1,58),f.write_shift(2,2+n.SheetNames.map(function(g){return g.toLowerCase()}).indexOf(s.toLowerCase())),f.write_shift(4,p.r),f.write_shift(2,p.c|(d.charAt(0)=="$"?0:1)<<14|(d.match(/\$\d/)?0:1)<<15),f.write_shift(1,17),f.write_shift(4,0),f}function FTe(t,n){var a=t.lastIndexOf("!"),s=t.slice(0,a);t=t.slice(a+1),s.charAt(0)=="'"&&(s=s.slice(1,-1).replace(/''/g,"'"));var c=ho(t),f=zt(23);return f.write_shift(4,15),f.write_shift(1,59),f.write_shift(2,2+n.SheetNames.map(function(d){return d.toLowerCase()}).indexOf(s.toLowerCase())),f.write_shift(4,c.s.r),f.write_shift(4,c.e.r),f.write_shift(2,c.s.c),f.write_shift(2,c.e.c),f.write_shift(4,0),f}function PTe(t,n){if(typeof t=="number")return I6(t);if(typeof t=="boolean")return TTe(t);if(/^#(DIV\/0!|GETTING_DATA|N\/A|NAME\?|NULL!|NUM!|REF!|VALUE!)$/.test(t))return ETe(+Dk[t]);if(t.match(/^\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})$/))return CTe(t);if(t.match(/^\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5}):\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})$/))return ITe(t);if(t.match(/^#REF!\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5}):\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})$/))return FTe(t,n);if(t.match(/^(?:'[^\\\/?*\[\]:]*'|[^'][^\\\/?*\[\]:'`~!@#$%^()\-=+{}|;,<.>]*)!\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})$/))return ATe(t,n);if(t.match(/^(?:'[^\\\/?*\[\]:]*'|[^'][^\\\/?*\[\]:'`~!@#$%^()\-=+{}|;,<.>]*)!\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5}):\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})$/))return MTe(t,n);if(/^(?:'[^\\\/?*\[\]:]*'|[^'][^\\\/?*\[\]:'`~!@#$%^()\-=+{}|;,<.>]*)!#REF!$/.test(t))return kTe(t,n);if(/^".*"$/.test(t))return STe(t);if(/^[+-]\d+$/.test(t))return I6(parseInt(t,10));throw"Formula |"+t+"| not supported for XLSB"}var OTe=PTe,RTe={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},r7={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},LTe={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function M6(t){return t.slice(0,3)=="of:"&&(t=t.slice(3)),t.charCodeAt(0)==61&&(t=t.slice(1),t.charCodeAt(0)==61&&(t=t.slice(1))),t=t.replace(/COM\.MICROSOFT\./g,""),t=t.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(n,a){return a.replace(/\./g,"")}),t=t.replace(/\$'([^']|'')+'/g,function(n){return n.slice(1)}),t=t.replace(/\$([^\]\. #$]+)/g,function(n,a){return a.match(/^([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])?(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})?$/)?n:a}),t=t.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),t.replace(/[;~]/g,",").replace(/\|/g,";")}function DTe(t){var n="of:="+t.replace(Hk,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return n.replace(/;/g,"|").replace(/,/g,";")}function yS(t){t=t.replace(/\$'([^']|'')+'/g,function(s){return s.slice(1)}),t=t.replace(/\$([^\]\. #$]+)/g,function(s,c){return c.match(/^([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])?(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})?$/)?s:c});var n=t.split(":"),a=n[0].split(".")[0];return[a,n[0].split(".")[1]+(n.length>1?":"+(n[1].split(".")[1]||n[1].split(".")[0]):"")]}function n7(t){return t.replace(/!/,".").replace(/:/,":.")}var p_={},R0={},m_=typeof Map<"u";function qk(t,n,a){var s=0,c=t.length;if(a){if(m_?a.has(n):Object.prototype.hasOwnProperty.call(a,n)){for(var f=m_?a.get(n):a[n];s<f.length;++s)if(t[f[s]].t===n)return t.Count++,f[s]}}else for(;s<c;++s)if(t[s].t===n)return t.Count++,s;return t[c]={t:n},t.Count++,t.Unique++,a&&(m_?(a.has(n)||a.set(n,[]),a.get(n).push(c)):(Object.prototype.hasOwnProperty.call(a,n)||(a[n]=[]),a[n].push(c))),c}function mw(t,n){var a={min:t+1,max:t+1},s=-1;return n.MDW&&(No=n.MDW),n.width!=null?a.customWidth=1:n.wpx!=null?s=ev(n.wpx):n.wch!=null&&(s=n.wch),s>-1?(a.width=db(s),a.customWidth=1):n.width!=null&&(a.width=n.width),n.hidden&&(a.hidden=!0),n.level!=null&&(a.outlineLevel=a.level=n.level),a}function jd(t,n){if(t){var a=[.7,.7,.75,.75,.3,.3];n=="xlml"&&(a=[1,1,1,1,.5,.5]),t.left==null&&(t.left=a[0]),t.right==null&&(t.right=a[1]),t.top==null&&(t.top=a[2]),t.bottom==null&&(t.bottom=a[3]),t.header==null&&(t.header=a[4]),t.footer==null&&(t.footer=a[5])}}function zh(t,n,a){var s=a.revssf[n.z!=null?n.z:"General"],c=60,f=t.length;if(s==null&&a.ssf){for(;c<392;++c)if(a.ssf[c]==null){Eh(n.z,c),a.ssf[c]=n.z,a.revssf[n.z]=s=c;break}}for(c=0;c!=f;++c)if(t[c].numFmtId===s)return c;return t[f]={numFmtId:s,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},f}function i7(t,n,a,s,c,f,d){try{s.cellNF&&(t.z=pn[n])}catch(g){if(s.WTF)throw g}if(!(t.t==="z"&&!s.cellStyles)){if(t.t==="d"&&typeof t.v=="string"&&(t.v=Fa(t.v)),(!s||s.cellText!==!1)&&t.t!=="z")try{if(pn[n]==null&&Eh(n1e[n]||"General",n),t.t==="e")t.w=t.w||uc[t.v];else if(n===0)if(t.t==="n")(t.v|0)===t.v?t.w=t.v.toString(10):t.w=W_(t.v);else if(t.t==="d"){var p=La(t.v,!!d);(p|0)===p?t.w=p.toString(10):t.w=W_(p)}else{if(t.v===void 0)return"";t.w=Zd(t.v,R0)}else t.t==="d"?t.w=$s(n,La(t.v,!!d),R0):t.w=$s(n,t.v,R0)}catch(g){if(s.WTF)throw g}if(s.cellStyles&&a!=null)try{t.s=f.Fills[a],t.s.fgColor&&t.s.fgColor.theme&&!t.s.fgColor.rgb&&(t.s.fgColor.rgb=hb(c.themeElements.clrScheme[t.s.fgColor.theme].rgb,t.s.fgColor.tint||0),s.WTF&&(t.s.fgColor.raw_rgb=c.themeElements.clrScheme[t.s.fgColor.theme].rgb)),t.s.bgColor&&t.s.bgColor.theme&&(t.s.bgColor.rgb=hb(c.themeElements.clrScheme[t.s.bgColor.theme].rgb,t.s.bgColor.tint||0),s.WTF&&(t.s.bgColor.raw_rgb=c.themeElements.clrScheme[t.s.bgColor.theme].rgb))}catch(g){if(s.WTF&&f.Fills)throw g}}}function BTe(t,n,a){if(t&&t["!ref"]){var s=Ei(t["!ref"]);if(s.e.c<s.s.c||s.e.r<s.s.r)throw new Error("Bad range ("+a+"): "+t["!ref"])}}function zTe(t,n){var a=Ei(n);a.s.r<=a.e.r&&a.s.c<=a.e.c&&a.s.r>=0&&a.s.c>=0&&(t["!ref"]=Xn(a))}var NTe=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,UTe=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,$Te=/<(?:\w:)?hyperlink [^>]*>/mg,VTe=/"(\w*:\w*)"/,jTe=/<(?:\w:)?col\b[^>]*[\/]?>/g,WTe=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,HTe=/<(?:\w:)?pageMargins[^>]*\/>/g,a7=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,GTe=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,qTe=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function XTe(t,n,a,s,c,f,d){if(!t)return t;s||(s={"!id":{}});var p={};n.dense&&(p["!data"]=[]);var g={s:{r:2e6,c:2e6},e:{r:0,c:0}},y="",b="",E=t.match(UTe);E?(y=t.slice(0,E.index),b=t.slice(E.index+E[0].length)):y=b=t;var T=y.match(a7);T?Xk(T[0],p,c,a):(T=y.match(GTe))&&KTe(T[0],T[1]||"",p,c,a);var S=(y.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(S>0){var I=y.slice(S,S+50).match(VTe);I&&!(n&&n.nodim)&&zTe(p,I[1])}var A=y.match(qTe);A&&A[1]&&cSe(A[1],c);var M=[];if(n.cellStyles){var F=y.match(jTe);F&&iSe(M,F)}E&&hSe(E[1],p,n,g,f,d,c);var L=b.match(WTe);L&&(p["!autofilter"]=oSe(L[0]));var O=[],N=b.match(NTe);if(N)for(S=0;S!=N.length;++S)O[S]=Ei(N[S].slice(N[S].indexOf('"')+1));var Q=b.match($Te);Q&&tSe(p,Q,s);var ie=b.match(HTe);ie&&(p["!margins"]=rSe(Kr(ie[0])));var j;if((j=b.match(/legacyDrawing r:id="(.*?)"/))&&(p["!legrel"]=j[1]),n&&n.nodim&&(g.s.c=g.s.r=0),!p["!ref"]&&g.e.c>=g.s.c&&g.e.r>=g.s.r&&(p["!ref"]=Xn(g)),n.sheetRows>0&&p["!ref"]){var V=Ei(p["!ref"]);n.sheetRows<=+V.e.r&&(V.e.r=n.sheetRows-1,V.e.r>g.e.r&&(V.e.r=g.e.r),V.e.r<V.s.r&&(V.s.r=V.e.r),V.e.c>g.e.c&&(V.e.c=g.e.c),V.e.c<V.s.c&&(V.s.c=V.e.c),p["!fullref"]=p["!ref"],p["!ref"]=Xn(V))}return M.length>0&&(p["!cols"]=M),O.length>0&&(p["!merges"]=O),s["!id"][p["!legrel"]]&&(p["!legdrawel"]=s["!id"][p["!legrel"]]),p}function ZTe(t){if(t.length===0)return"";for(var n='<mergeCells count="'+t.length+'">',a=0;a!=t.length;++a)n+='<mergeCell ref="'+Xn(t[a])+'"/>';return n+"</mergeCells>"}function Xk(t,n,a,s){var c=Kr(t);a.Sheets[s]||(a.Sheets[s]={}),c.codeName&&(a.Sheets[s].CodeName=bi(Ki(c.codeName)))}function KTe(t,n,a,s,c){Xk(t.slice(0,t.indexOf(">")),a,s,c)}function YTe(t,n,a,s,c){var f=!1,d={},p=null;if(s.bookType!=="xlsx"&&n.vbaraw){var g=n.SheetNames[a];try{n.Workbook&&(g=n.Workbook.Sheets[a].CodeName||g)}catch{}f=!0,d.codeName=tu(Yn(g))}if(t&&t["!outline"]){var y={summaryBelow:1,summaryRight:1};t["!outline"].above&&(y.summaryBelow=0),t["!outline"].left&&(y.summaryRight=0),p=(p||"")+Er("outlinePr",null,y)}!f&&!p||(c[c.length]=Er("sheetPr",p,d))}var JTe=["objects","scenarios","selectLockedCells","selectUnlockedCells"],QTe=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function eSe(t){var n={sheet:1};return JTe.forEach(function(a){t[a]!=null&&t[a]&&(n[a]="1")}),QTe.forEach(function(a){t[a]!=null&&!t[a]&&(n[a]="0")}),t.password&&(n.password=Vk(t.password).toString(16).toUpperCase()),Er("sheetProtection",null,n)}function tSe(t,n,a){for(var s=t["!data"]!=null,c=0;c!=n.length;++c){var f=Kr(Ki(n[c]),!0);if(!f.ref)return;var d=((a||{})["!id"]||[])[f.id];d?(f.Target=d.Target,f.location&&(f.Target+="#"+bi(f.location))):(f.Target="#"+bi(f.location),d={Target:f.Target,TargetMode:"Internal"}),f.Rel=d,f.tooltip&&(f.Tooltip=f.tooltip,delete f.tooltip);for(var p=Ei(f.ref),g=p.s.r;g<=p.e.r;++g)for(var y=p.s.c;y<=p.e.c;++y){var b=Qn(y)+vi(g);s?(t["!data"][g]||(t["!data"][g]=[]),t["!data"][g][y]||(t["!data"][g][y]={t:"z",v:void 0}),t["!data"][g][y].l=f):(t[b]||(t[b]={t:"z",v:void 0}),t[b].l=f)}}}function rSe(t){var n={};return["left","right","top","bottom","header","footer"].forEach(function(a){t[a]&&(n[a]=parseFloat(t[a]))}),n}function nSe(t){return jd(t),Er("pageMargins",null,t)}function iSe(t,n){for(var a=!1,s=0;s!=n.length;++s){var c=Kr(n[s],!0);c.hidden&&(c.hidden=ji(c.hidden));var f=parseInt(c.min,10)-1,d=parseInt(c.max,10)-1;for(c.outlineLevel&&(c.level=+c.outlineLevel||0),delete c.min,delete c.max,c.width=+c.width,!a&&c.width&&(a=!0,jk(c.width)),kh(c);f<=d;)t[f++]=Qi(c)}}function aSe(t,n){for(var a=["<cols>"],s,c=0;c!=n.length;++c)(s=n[c])&&(a[a.length]=Er("col",null,mw(c,s)));return a[a.length]="</cols>",a.join("")}function oSe(t){var n={ref:(t.match(/ref="([^"]*)"/)||[])[1]};return n}function sSe(t,n,a,s){var c=typeof t.ref=="string"?t.ref:Xn(t.ref);a.Workbook||(a.Workbook={Sheets:[]}),a.Workbook.Names||(a.Workbook.Names=[]);var f=a.Workbook.Names,d=ho(c);d.s.r==d.e.r&&(d.e.r=ho(n["!ref"]).e.r,c=Xn(d));for(var p=0;p<f.length;++p){var g=f[p];if(g.Name=="_xlnm._FilterDatabase"&&g.Sheet==s){g.Ref=Z_(a.SheetNames[s])+"!"+X_(c);break}}return p==f.length&&f.push({Name:"_xlnm._FilterDatabase",Sheet:s,Ref:"'"+a.SheetNames[s]+"'!"+c}),Er("autoFilter",null,{ref:c})}var lSe=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/g;function cSe(t,n){n.Views||(n.Views=[{}]),(t.match(lSe)||[]).forEach(function(a,s){var c=Kr(a);n.Views[s]||(n.Views[s]={}),+c.zoomScale&&(n.Views[s].zoom=+c.zoomScale),c.rightToLeft&&ji(c.rightToLeft)&&(n.Views[s].RTL=!0)})}function uSe(t,n,a,s){var c={workbookViewId:"0"};return(((s||{}).Workbook||{}).Views||[])[0]&&(c.rightToLeft=s.Workbook.Views[0].RTL?"1":"0"),Er("sheetViews",Er("sheetView",null,c),{})}function fSe(t,n,a,s,c,f,d){if(t.c&&a["!comments"].push([n,t.c]),(t.v===void 0||t.t==="z"&&!(s||{}).sheetStubs)&&typeof t.f!="string"&&typeof t.z>"u")return"";var p="",g=t.t,y=t.v;if(t.t!=="z")switch(t.t){case"b":p=t.v?"1":"0";break;case"n":isNaN(t.v)?(t.t="e",p=uc[t.v=36]):isFinite(t.v)?p=""+t.v:(t.t="e",p=uc[t.v=7]);break;case"e":p=uc[t.v];break;case"d":if(s&&s.cellDates){var b=Fa(t.v,d);p=b.toISOString(),b.getUTCFullYear()<1900&&(p=p.slice(p.indexOf("T")+1).replace("Z",""))}else t=Qi(t),t.t="n",p=""+(t.v=La(Fa(t.v,d),d));typeof t.z>"u"&&(t.z=pn[14]);break;default:p=t.v;break}var E=t.t=="z"||t.v==null?"":Co("v",Yn(p)),T={r:n},S=zh(s.cellXfs,t,s);switch(S!==0&&(T.s=S),t.t){case"n":break;case"d":T.t="d";break;case"b":T.t="b";break;case"e":T.t="e";break;case"z":break;default:if(t.v==null){delete t.t;break}if(t.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(s&&s.bookSST){E=Co("v",""+qk(s.Strings,t.v,s.revStrings)),T.t="s";break}else T.t="str";break}if(t.t!=g&&(t.t=g,t.v=y),typeof t.f=="string"&&t.f){var I=t.F&&t.F.slice(0,n.length)==n?{t:"array",ref:t.F}:null;E=Er("f",Yn(t.f),I)+(t.v!=null?E:"")}return t.l&&(t.l.display=Yn(p),a["!links"].push([n,t.l])),t.D&&(T.cm=1),Er("c",E,T)}var hSe=function(){var t=/<(?:\w+:)?c[ \/>]/,n=/<\/(?:\w+:)?row>/,a=/r=["']([^"']*)["']/,s=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,c=/ref=["']([^"']*)["']/,f=G_("v"),d=G_("f");return function(g,y,b,E,T,S,I){for(var A=0,M="",F=[],L=[],O=0,N=0,Q=0,ie="",j,V,D=0,te=0,ue,J,le=0,re=0,Fe=Array.isArray(S.CellXf),Ye,Ee=[],ut=[],Ne=y["!data"]!=null,He=[],Oe={},Pe=!1,rt=!!b.sheetStubs,et=!!((I||{}).WBProps||{}).date1904,Ge=g.split(n),ze=0,oe=Ge.length;ze!=oe;++ze){M=Ge[ze].trim();var Me=M.length;if(Me!==0){var fe=0;e:for(A=0;A<Me;++A)switch(M[A]){case">":if(M[A-1]!="/"){++A;break e}if(b&&b.cellStyles){if(V=Kr(M.slice(fe,A),!0),D=V.r!=null?parseInt(V.r,10):D+1,te=-1,b.sheetRows&&b.sheetRows<D)continue;Oe={},Pe=!1,V.ht&&(Pe=!0,Oe.hpt=parseFloat(V.ht),Oe.hpx=sm(Oe.hpt)),V.hidden&&ji(V.hidden)&&(Pe=!0,Oe.hidden=!0),V.outlineLevel!=null&&(Pe=!0,Oe.level=+V.outlineLevel),Pe&&(He[D-1]=Oe)}break;case"<":fe=A;break}if(fe>=A)break;if(V=Kr(M.slice(fe,A),!0),D=V.r!=null?parseInt(V.r,10):D+1,te=-1,!(b.sheetRows&&b.sheetRows<D)){b.nodim||(E.s.r>D-1&&(E.s.r=D-1),E.e.r<D-1&&(E.e.r=D-1)),b&&b.cellStyles&&(Oe={},Pe=!1,V.ht&&(Pe=!0,Oe.hpt=parseFloat(V.ht),Oe.hpx=sm(Oe.hpt)),V.hidden&&ji(V.hidden)&&(Pe=!0,Oe.hidden=!0),V.outlineLevel!=null&&(Pe=!0,Oe.level=+V.outlineLevel),Pe&&(He[D-1]=Oe)),F=M.slice(A).split(t);for(var pe=0;pe!=F.length&&F[pe].trim().charAt(0)=="<";++pe);for(F=F.slice(pe),A=0;A!=F.length;++A)if(M=F[A].trim(),M.length!==0){if(L=M.match(a),O=A,N=0,Q=0,M="<c "+(M.slice(0,1)=="<"?">":"")+M,L!=null&&L.length===2){for(O=0,ie=L[1],N=0;N!=ie.length&&!((Q=ie.charCodeAt(N)-64)<1||Q>26);++N)O=26*O+Q;--O,te=O}else++te;for(N=0;N!=M.length&&M.charCodeAt(N)!==62;++N);if(++N,V=Kr(M.slice(0,N),!0),V.r||(V.r=ii({r:D-1,c:te})),ie=M.slice(N),j={t:""},(L=ie.match(f))!=null&&L[1]!==""&&(j.v=bi(L[1])),b.cellFormula){if((L=ie.match(d))!=null){if(L[1]=="")L[0].indexOf('t="shared"')>-1&&(J=Kr(L[0]),ut[J.si]&&(j.f=T6(ut[J.si][1],ut[J.si][2],V.r)));else if(j.f=bi(Ki(L[1]),!0),b.xlfn||(j.f=S6(j.f)),L[0].indexOf('t="array"')>-1)j.F=(ie.match(c)||[])[1],j.F.indexOf(":")>-1&&Ee.push([Ei(j.F),j.F]);else if(L[0].indexOf('t="shared"')>-1){J=Kr(L[0]);var ot=bi(Ki(L[1]));b.xlfn||(ot=S6(ot)),ut[parseInt(J.si,10)]=[J,ot,V.r]}}else(L=ie.match(/<f[^>]*\/>/))&&(J=Kr(L[0]),ut[J.si]&&(j.f=T6(ut[J.si][1],ut[J.si][2],V.r)));var xe=Yi(V.r);for(N=0;N<Ee.length;++N)xe.r>=Ee[N][0].s.r&&xe.r<=Ee[N][0].e.r&&xe.c>=Ee[N][0].s.c&&xe.c<=Ee[N][0].e.c&&(j.F=Ee[N][1])}if(V.t==null&&j.v===void 0)if(j.f||j.F)j.v=0,j.t="n";else if(rt)j.t="z";else continue;else j.t=V.t||"n";switch(E.s.c>te&&(E.s.c=te),E.e.c<te&&(E.e.c=te),j.t){case"n":if(j.v==""||j.v==null){if(!rt)continue;j.t="z"}else j.v=parseFloat(j.v);break;case"s":if(typeof j.v>"u"){if(!rt)continue;j.t="z"}else ue=p_[parseInt(j.v,10)],j.v=ue.t,j.r=ue.r,b.cellHTML&&(j.h=ue.h);break;case"str":j.t="s",j.v=j.v!=null?bi(Ki(j.v),!0):"",b.cellHTML&&(j.h=sb(j.v));break;case"inlineStr":L=ie.match(s),j.t="s",L!=null&&(ue=$k(L[1]))?(j.v=ue.t,b.cellHTML&&(j.h=ue.h)):j.v="";break;case"b":j.v=ji(j.v);break;case"d":b.cellDates?j.v=Fa(j.v,et):(j.v=La(Fa(j.v,et),et),j.t="n");break;case"e":(!b||b.cellText!==!1)&&(j.w=j.v),j.v=Dk[j.v];break}if(le=re=0,Ye=null,Fe&&V.s!==void 0&&(Ye=S.CellXf[V.s],Ye!=null&&(Ye.numFmtId!=null&&(le=Ye.numFmtId),b.cellStyles&&Ye.fillId!=null&&(re=Ye.fillId))),i7(j,le,re,b,T,S,et),b.cellDates&&Fe&&j.t=="n"&&cl(pn[le])&&(j.v=Zu(j.v+(et?1462:0)),j.t=typeof j.v=="number"?"n":"d"),V.cm&&b.xlmeta){var ae=(b.xlmeta.Cell||[])[+V.cm-1];ae&&ae.type=="XLDAPR"&&(j.D=!0)}var X;b.nodim&&(X=Yi(V.r),E.s.r>X.r&&(E.s.r=X.r),E.e.r<X.r&&(E.e.r=X.r)),Ne?(X=Yi(V.r),y["!data"][X.r]||(y["!data"][X.r]=[]),y["!data"][X.r][X.c]=j):y[V.r]=j}}}}He.length>0&&(y["!rows"]=He)}}();function dSe(t,n,a,s){var c=[],f=[],d=Ei(t["!ref"]),p="",g,y="",b=[],E=0,T=0,S=t["!rows"],I=t["!data"]!=null,A={r:y},M,F=-1,L=(((s||{}).Workbook||{}).WBProps||{}).date1904;for(T=d.s.c;T<=d.e.c;++T)b[T]=Qn(T);for(E=d.s.r;E<=d.e.r;++E){for(f=[],y=vi(E),T=d.s.c;T<=d.e.c;++T){g=b[T]+y;var O=I?(t["!data"][E]||[])[T]:t[g];O!==void 0&&(p=fSe(O,g,t,n,a,s,L))!=null&&f.push(p)}(f.length>0||S&&S[E])&&(A={r:y},S&&S[E]&&(M=S[E],M.hidden&&(A.hidden=1),F=-1,M.hpx?F=tv(M.hpx):M.hpt&&(F=M.hpt),F>-1&&(A.ht=F,A.customHeight=1),M.level&&(A.outlineLevel=M.level)),c[c.length]=Er("row",f.join(""),A))}if(S)for(;E<S.length;++E)S&&S[E]&&(A={r:E+1},M=S[E],M.hidden&&(A.hidden=1),F=-1,M.hpx?F=tv(M.hpx):M.hpt&&(F=M.hpt),F>-1&&(A.ht=F,A.customHeight=1),M.level&&(A.outlineLevel=M.level),c[c.length]=Er("row","",A));return c.join("")}function pSe(t,n,a,s){var c=[Wa,Er("worksheet",null,{xmlns:lp[0],"xmlns:r":uo.r})],f=a.SheetNames[t],d=0,p="",g=a.Sheets[f];g==null&&(g={});var y=g["!ref"]||"A1",b=Ei(y);if(b.e.c>16383||b.e.r>1048575){if(n.WTF)throw new Error("Range "+y+" exceeds format limit A1:XFD1048576");b.e.c=Math.min(b.e.c,16383),b.e.r=Math.min(b.e.c,1048575),y=Xn(b)}s||(s={}),g["!comments"]=[];var E=[];YTe(g,a,t,n,c),c[c.length]=Er("dimension",null,{ref:y}),c[c.length]=uSe(g,n,t,a),n.sheetFormat&&(c[c.length]=Er("sheetFormatPr",null,{defaultRowHeight:n.sheetFormat.defaultRowHeight||"16",baseColWidth:n.sheetFormat.baseColWidth||"10",outlineLevelRow:n.sheetFormat.outlineLevelRow||"7"})),g["!cols"]!=null&&g["!cols"].length>0&&(c[c.length]=aSe(g,g["!cols"])),c[d=c.length]="<sheetData/>",g["!links"]=[],g["!ref"]!=null&&(p=dSe(g,n,t,a),p.length>0&&(c[c.length]=p)),c.length>d+1&&(c[c.length]="</sheetData>",c[d]=c[d].replace("/>",">")),g["!protect"]&&(c[c.length]=eSe(g["!protect"])),g["!autofilter"]!=null&&(c[c.length]=sSe(g["!autofilter"],g,a,t)),g["!merges"]!=null&&g["!merges"].length>0&&(c[c.length]=ZTe(g["!merges"]));var T=-1,S,I=-1;return g["!links"].length>0&&(c[c.length]="<hyperlinks>",g["!links"].forEach(function(A){A[1].Target&&(S={ref:A[0]},A[1].Target.charAt(0)!="#"&&(I=$i(s,-1,Yn(A[1].Target).replace(/#.*$/,""),ni.HLINK),S["r:id"]="rId"+I),(T=A[1].Target.indexOf("#"))>-1&&(S.location=Yn(A[1].Target.slice(T+1))),A[1].Tooltip&&(S.tooltip=Yn(A[1].Tooltip)),S.display=A[1].display,c[c.length]=Er("hyperlink",null,S))}),c[c.length]="</hyperlinks>"),delete g["!links"],g["!margins"]!=null&&(c[c.length]=nSe(g["!margins"])),(!n||n.ignoreEC||n.ignoreEC==null)&&(c[c.length]=Co("ignoredErrors",Er("ignoredError",null,{numberStoredAsText:1,sqref:y}))),E.length>0&&(I=$i(s,-1,"../drawings/drawing"+(t+1)+".xml",ni.DRAW),c[c.length]=Er("drawing",null,{"r:id":"rId"+I}),g["!drawing"]=E),g["!comments"].length>0&&(I=$i(s,-1,"../drawings/vmlDrawing"+(t+1)+".vml",ni.VML),c[c.length]=Er("legacyDrawing",null,{"r:id":"rId"+I}),g["!legacy"]=I),c.length>1&&(c[c.length]="</worksheet>",c[1]=c[1].replace("/>",">")),c.join("")}function mSe(t,n){var a={},s=t.l+n;a.r=t.read_shift(4),t.l+=4;var c=t.read_shift(2);t.l+=1;var f=t.read_shift(1);return t.l=s,f&7&&(a.level=f&7),f&16&&(a.hidden=!0),f&32&&(a.hpt=c/20),a}function gSe(t,n,a){var s=zt(145),c=(a["!rows"]||[])[t]||{};s.write_shift(4,t),s.write_shift(4,0);var f=320;c.hpx?f=tv(c.hpx)*20:c.hpt&&(f=c.hpt*20),s.write_shift(2,f),s.write_shift(1,0);var d=0;c.level&&(d|=c.level),c.hidden&&(d|=16),(c.hpx||c.hpt)&&(d|=32),s.write_shift(1,d),s.write_shift(1,0);var p=0,g=s.l;s.l+=4;for(var y={r:t,c:0},b=a["!data"]!=null,E=0;E<16;++E)if(!(n.s.c>E+1<<10||n.e.c<E<<10)){for(var T=-1,S=-1,I=E<<10;I<E+1<<10;++I){y.c=I;var A=b?(a["!data"][y.r]||[])[y.c]:a[ii(y)];A&&(T<0&&(T=I),S=I)}T<0||(++p,s.write_shift(4,T),s.write_shift(4,S))}var M=s.l;return s.l=g,s.write_shift(4,p),s.l=M,s.length>s.l?s.slice(0,s.l):s}function _Se(t,n,a,s){var c=gSe(s,a,n);(c.length>17||(n["!rows"]||[])[s])&&rr(t,0,c)}var vSe=hp,ySe=wm;function xSe(){}function bSe(t,n){var a={},s=t[t.l];return++t.l,a.above=!(s&64),a.left=!(s&128),t.l+=18,a.name=eye(t),a}function wSe(t,n,a){a==null&&(a=zt(84+4*t.length));var s=192;n&&(n.above&&(s&=-65),n.left&&(s&=-129)),a.write_shift(1,s);for(var c=1;c<3;++c)a.write_shift(1,0);return cb({auto:1},a),a.write_shift(-4,-1),a.write_shift(-4,-1),i9(t,a),a.slice(0,a.l)}function ESe(t){var n=Bl(t);return[n]}function TSe(t,n,a){return a==null&&(a=zt(8)),cp(n,a)}function SSe(t){var n=up(t);return[n]}function CSe(t,n,a){return a==null&&(a=zt(4)),fp(n,a)}function ASe(t){var n=Bl(t),a=t.read_shift(1);return[n,a,"b"]}function kSe(t,n,a){return a==null&&(a=zt(9)),cp(n,a),a.write_shift(1,t.v?1:0),a}function ISe(t){var n=up(t),a=t.read_shift(1);return[n,a,"b"]}function MSe(t,n,a){return a==null&&(a=zt(5)),fp(n,a),a.write_shift(1,t.v?1:0),a}function FSe(t){var n=Bl(t),a=t.read_shift(1);return[n,a,"e"]}function xS(t,n,a){return a==null&&(a=zt(9)),cp(n,a),a.write_shift(1,t.v),a}function PSe(t){var n=up(t),a=t.read_shift(1);return[n,a,"e"]}function bS(t,n,a){return a==null&&(a=zt(8)),fp(n,a),a.write_shift(1,t.v),a.write_shift(2,0),a.write_shift(1,0),a}function OSe(t){var n=Bl(t),a=t.read_shift(4);return[n,a,"s"]}function RSe(t,n,a){return a==null&&(a=zt(12)),cp(n,a),a.write_shift(4,n.v),a}function LSe(t){var n=up(t),a=t.read_shift(4);return[n,a,"s"]}function DSe(t,n,a){return a==null&&(a=zt(8)),fp(n,a),a.write_shift(4,n.v),a}function BSe(t){var n=Bl(t),a=Vo(t);return[n,a,"n"]}function zSe(t,n,a){return a==null&&(a=zt(16)),cp(n,a),Jd(t.v,a),a}function o7(t){var n=up(t),a=Vo(t);return[n,a,"n"]}function NSe(t,n,a){return a==null&&(a=zt(12)),fp(n,a),Jd(t.v,a),a}function USe(t){var n=Bl(t),a=uw(t);return[n,a,"n"]}function $Se(t,n,a){return a==null&&(a=zt(12)),cp(n,a),a9(t.v,a),a}function VSe(t){var n=up(t),a=uw(t);return[n,a,"n"]}function jSe(t,n,a){return a==null&&(a=zt(8)),fp(n,a),a9(t.v,a),a}function WSe(t){var n=Bl(t),a=Ok(t);return[n,a,"is"]}function HSe(t){var n=Bl(t),a=qo(t);return[n,a,"str"]}function GSe(t,n,a){var s=t.v==null?"":String(t.v);return a==null&&(a=zt(12+4*t.v.length)),cp(n,a),fo(s,a),a.length>a.l?a.slice(0,a.l):a}function qSe(t){var n=up(t),a=qo(t);return[n,a,"str"]}function XSe(t,n,a){var s=t.v==null?"":String(t.v);return a==null&&(a=zt(8+4*s.length)),fp(n,a),fo(s,a),a.length>a.l?a.slice(0,a.l):a}function ZSe(t,n,a){var s=t.l+n,c=Bl(t);c.r=a["!row"];var f=t.read_shift(1),d=[c,f,"b"];if(a.cellFormula){t.l+=2;var p=pw(t,s-t.l,a);d[3]=zo(p,null,c,a.supbooks,a)}else t.l=s;return d}function KSe(t,n,a){var s=t.l+n,c=Bl(t);c.r=a["!row"];var f=t.read_shift(1),d=[c,f,"e"];if(a.cellFormula){t.l+=2;var p=pw(t,s-t.l,a);d[3]=zo(p,null,c,a.supbooks,a)}else t.l=s;return d}function YSe(t,n,a){var s=t.l+n,c=Bl(t);c.r=a["!row"];var f=Vo(t),d=[c,f,"n"];if(a.cellFormula){t.l+=2;var p=pw(t,s-t.l,a);d[3]=zo(p,null,c,a.supbooks,a)}else t.l=s;return d}function JSe(t,n,a){var s=t.l+n,c=Bl(t);c.r=a["!row"];var f=qo(t),d=[c,f,"str"];if(a.cellFormula){t.l+=2;var p=pw(t,s-t.l,a);d[3]=zo(p,null,c,a.supbooks,a)}else t.l=s;return d}var QSe=hp,eCe=wm;function tCe(t,n){return n==null&&(n=zt(4)),n.write_shift(4,t),n}function rCe(t,n){var a=t.l+n,s=hp(t),c=cw(t),f=qo(t),d=qo(t),p=qo(t);t.l=a;var g={rfx:s,relId:c,loc:f,display:p};return d&&(g.Tooltip=d),g}function nCe(t,n){var a=zt(50+4*(t[1].Target.length+(t[1].Tooltip||"").length));wm({s:Yi(t[0]),e:Yi(t[0])},a),Rk("rId"+n,a);var s=t[1].Target.indexOf("#"),c=s==-1?"":t[1].Target.slice(s+1);return fo(c||"",a),fo(t[1].Tooltip||"",a),fo("",a),a.slice(0,a.l)}function iCe(){}function aCe(t,n,a){var s=t.l+n,c=o9(t),f=t.read_shift(1),d=[c];if(d[2]=f,a.cellFormula){var p=xTe(t,s-t.l,a);d[1]=p}else t.l=s;return d}function oCe(t,n,a){var s=t.l+n,c=hp(t),f=[c];if(a.cellFormula){var d=wTe(t,s-t.l,a);f[1]=d,t.l=s}else t.l=s;return f}function sCe(t,n,a){a==null&&(a=zt(18));var s=mw(t,n);a.write_shift(-4,t),a.write_shift(-4,t),a.write_shift(4,(s.width||10)*256),a.write_shift(4,0);var c=0;return n.hidden&&(c|=1),typeof s.width=="number"&&(c|=2),n.level&&(c|=n.level<<8),a.write_shift(2,c),a}var s7=["left","right","top","bottom","header","footer"];function lCe(t){var n={};return s7.forEach(function(a){n[a]=Vo(t)}),n}function cCe(t,n){return n==null&&(n=zt(6*8)),jd(t),s7.forEach(function(a){Jd(t[a],n)}),n}function uCe(t){var n=t.read_shift(2);return t.l+=28,{RTL:n&32}}function fCe(t,n,a){a==null&&(a=zt(30));var s=924;return(((n||{}).Views||[])[0]||{}).RTL&&(s|=32),a.write_shift(2,s),a.write_shift(4,0),a.write_shift(4,0),a.write_shift(4,0),a.write_shift(1,0),a.write_shift(1,0),a.write_shift(2,0),a.write_shift(2,100),a.write_shift(2,0),a.write_shift(2,0),a.write_shift(2,0),a.write_shift(4,0),a}function hCe(t){var n=zt(24);return n.write_shift(4,4),n.write_shift(4,1),wm(t,n),n}function dCe(t,n){return n==null&&(n=zt(16*4+2)),n.write_shift(2,t.password?Vk(t.password):0),n.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(a){a[1]?n.write_shift(4,t[a[0]]!=null&&!t[a[0]]?1:0):n.write_shift(4,t[a[0]]!=null&&t[a[0]]?0:1)}),n}function pCe(){}function mCe(){}function gCe(t,n,a,s,c,f,d){if(!t)return t;var p=n||{};s||(s={"!id":{}});var g={};p.dense&&(g["!data"]=[]);var y,b={s:{r:2e6,c:2e6},e:{r:0,c:0}},E=!1,T=!1,S,I,A,M,F,L,O,N,Q,ie=[];p.biff=12,p["!row"]=0;var j=0,V=!1,D=[],te={},ue=p.supbooks||c.supbooks||[[]];if(ue.sharedf=te,ue.arrayf=D,ue.SheetNames=c.SheetNames||c.Sheets.map(function(Ne){return Ne.name}),!p.supbooks&&(p.supbooks=ue,c.Names))for(var J=0;J<c.Names.length;++J)ue[0][J+1]=c.Names[J];var le=[],re=[],Fe=!1;rv[16]={n:"BrtShortReal",f:o7};var Ye,Ee=1462*+!!((c||{}).WBProps||{}).date1904;if(ff(t,function(He,Oe,Pe){if(!T)switch(Pe){case 148:y=He;break;case 0:S=He,p.sheetRows&&p.sheetRows<=S.r&&(T=!0),N=vi(M=S.r),p["!row"]=S.r,(He.hidden||He.hpt||He.level!=null)&&(He.hpt&&(He.hpx=sm(He.hpt)),re[He.r]=He);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(I={t:He[2]},He[2]){case"n":I.v=He[1];break;case"s":O=p_[He[1]],I.v=O.t,I.r=O.r;break;case"b":I.v=!!He[1];break;case"e":I.v=He[1],p.cellText!==!1&&(I.w=uc[I.v]);break;case"str":I.t="s",I.v=He[1];break;case"is":I.t="s",I.v=He[1].t;break}if((A=d.CellXf[He[0].iStyleRef])&&i7(I,A.numFmtId,null,p,f,d,Ee>0),F=He[0].c==-1?F+1:He[0].c,p.dense?(g["!data"][M]||(g["!data"][M]=[]),g["!data"][M][F]=I):g[Qn(F)+N]=I,p.cellFormula){for(V=!1,j=0;j<D.length;++j){var rt=D[j];S.r>=rt[0].s.r&&S.r<=rt[0].e.r&&F>=rt[0].s.c&&F<=rt[0].e.c&&(I.F=Xn(rt[0]),V=!0)}!V&&He.length>3&&(I.f=He[3])}if(b.s.r>S.r&&(b.s.r=S.r),b.s.c>F&&(b.s.c=F),b.e.r<S.r&&(b.e.r=S.r),b.e.c<F&&(b.e.c=F),p.cellDates&&A&&I.t=="n"&&cl(pn[A.numFmtId])){var et=vh(I.v+Ee);et&&(I.t="d",I.v=new Date(Date.UTC(et.y,et.m-1,et.d,et.H,et.M,et.S,et.u)))}Ye&&(Ye.type=="XLDAPR"&&(I.D=!0),Ye=void 0);break;case 1:case 12:if(!p.sheetStubs||E)break;I={t:"z",v:void 0},F=He[0].c==-1?F+1:He[0].c,p.dense?(g["!data"][M]||(g["!data"][M]=[]),g["!data"][M][F]=I):g[Qn(F)+N]=I,b.s.r>S.r&&(b.s.r=S.r),b.s.c>F&&(b.s.c=F),b.e.r<S.r&&(b.e.r=S.r),b.e.c<F&&(b.e.c=F),Ye&&(Ye.type=="XLDAPR"&&(I.D=!0),Ye=void 0);break;case 176:ie.push(He);break;case 49:Ye=((p.xlmeta||{}).Cell||[])[He-1];break;case 494:var Ge=s["!id"][He.relId];for(Ge?(He.Target=Ge.Target,He.loc&&(He.Target+="#"+He.loc),He.Rel=Ge):He.relId==""&&(He.Target="#"+He.loc),M=He.rfx.s.r;M<=He.rfx.e.r;++M)for(F=He.rfx.s.c;F<=He.rfx.e.c;++F)p.dense?(g["!data"][M]||(g["!data"][M]=[]),g["!data"][M][F]||(g["!data"][M][F]={t:"z",v:void 0}),g["!data"][M][F].l=He):(L=Qn(F)+vi(M),g[L]||(g[L]={t:"z",v:void 0}),g[L].l=He);break;case 426:if(!p.cellFormula)break;D.push(He),Q=p.dense?g["!data"][M][F]:g[Qn(F)+N],Q.f=zo(He[1],b,{r:S.r,c:F},ue,p),Q.F=Xn(He[0]);break;case 427:if(!p.cellFormula)break;te[ii(He[0].s)]=He[1],Q=p.dense?g["!data"][M][F]:g[Qn(F)+N],Q.f=zo(He[1],b,{r:S.r,c:F},ue,p);break;case 60:if(!p.cellStyles)break;for(;He.e>=He.s;)le[He.e--]={width:He.w/256,hidden:!!(He.flags&1),level:He.level},Fe||(Fe=!0,jk(He.w/256)),kh(le[He.e+1]);break;case 551:He&&(g["!legrel"]=He);break;case 161:g["!autofilter"]={ref:Xn(He)};break;case 476:g["!margins"]=He;break;case 147:c.Sheets[a]||(c.Sheets[a]={}),He.name&&(c.Sheets[a].CodeName=He.name),(He.above||He.left)&&(g["!outline"]={above:He.above,left:He.left});break;case 137:c.Views||(c.Views=[{}]),c.Views[0]||(c.Views[0]={}),He.RTL&&(c.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:E=!0;break;case 36:E=!1;break;case 37:E=!0;break;case 38:E=!1;break;default:if(!Oe.T){if(!E||p.WTF)throw new Error("Unexpected record 0x"+Pe.toString(16))}}},p),delete p.supbooks,delete p["!row"],!g["!ref"]&&(b.s.r<2e6||y&&(y.e.r>0||y.e.c>0||y.s.r>0||y.s.c>0))&&(g["!ref"]=Xn(y||b)),p.sheetRows&&g["!ref"]){var ut=Ei(g["!ref"]);p.sheetRows<=+ut.e.r&&(ut.e.r=p.sheetRows-1,ut.e.r>b.e.r&&(ut.e.r=b.e.r),ut.e.r<ut.s.r&&(ut.s.r=ut.e.r),ut.e.c>b.e.c&&(ut.e.c=b.e.c),ut.e.c<ut.s.c&&(ut.s.c=ut.e.c),g["!fullref"]=g["!ref"],g["!ref"]=Xn(ut))}return ie.length>0&&(g["!merges"]=ie),le.length>0&&(g["!cols"]=le),re.length>0&&(g["!rows"]=re),s["!id"][g["!legrel"]]&&(g["!legdrawel"]=s["!id"][g["!legrel"]]),g}function _Ce(t,n,a,s,c,f,d,p){var g={r:a,c:s};if(n.c&&f["!comments"].push([ii(g),n.c]),n.v===void 0)return!1;var y="";switch(n.t){case"b":y=n.v?"1":"0";break;case"d":n=Qi(n),n.z=n.z||pn[14],n.v=La(Fa(n.v,p),p),n.t="n";break;case"n":case"e":y=""+n.v;break;default:y=n.v;break}switch(g.s=zh(c.cellXfs,n,c),n.l&&f["!links"].push([ii(g),n.l]),n.t){case"s":case"str":return c.bookSST?(y=qk(c.Strings,n.v==null?"":String(n.v),c.revStrings),g.t="s",g.v=y,d?rr(t,18,DSe(n,g)):rr(t,7,RSe(n,g))):(g.t="str",d?rr(t,17,XSe(n,g)):rr(t,6,GSe(n,g))),!0;case"n":return n.v==(n.v|0)&&n.v>-1e3&&n.v<1e3?d?rr(t,13,jSe(n,g)):rr(t,2,$Se(n,g)):isNaN(n.v)?d?rr(t,14,bS({t:"e",v:36},g)):rr(t,3,xS({t:"e",v:36},g)):isFinite(n.v)?d?rr(t,16,NSe(n,g)):rr(t,5,zSe(n,g)):d?rr(t,14,bS({t:"e",v:7},g)):rr(t,3,xS({t:"e",v:7},g)),!0;case"b":return g.t="b",d?rr(t,15,MSe(n,g)):rr(t,4,kSe(n,g)),!0;case"e":return g.t="e",d?rr(t,14,bS(n,g)):rr(t,3,xS(n,g)),!0}return d?rr(t,12,CSe(n,g)):rr(t,1,TSe(n,g)),!0}function vCe(t,n,a,s,c){var f=Ei(n["!ref"]||"A1"),d,p="",g=[],y=(((c||{}).Workbook||{}).WBProps||{}).date1904;rr(t,145);var b=n["!data"]!=null,E=f.e.r;n["!rows"]&&(E=Math.max(f.e.r,n["!rows"].length-1));for(var T=f.s.r;T<=E;++T){p=vi(T),_Se(t,n,f,T);var S=!1;if(T<=f.e.r)for(var I=f.s.c;I<=f.e.c;++I){T===f.s.r&&(g[I]=Qn(I)),d=g[I]+p;var A=b?(n["!data"][T]||[])[I]:n[d];if(!A){S=!1;continue}S=_Ce(t,A,T,I,s,n,S,y)}}rr(t,146)}function yCe(t,n){!n||!n["!merges"]||(rr(t,177,tCe(n["!merges"].length)),n["!merges"].forEach(function(a){rr(t,176,eCe(a))}),rr(t,178))}function xCe(t,n){!n||!n["!cols"]||(rr(t,390),n["!cols"].forEach(function(a,s){a&&rr(t,60,sCe(s,a))}),rr(t,391))}function bCe(t,n){!n||!n["!ref"]||(rr(t,648),rr(t,649,hCe(Ei(n["!ref"]))),rr(t,650))}function wCe(t,n,a){n["!links"].forEach(function(s){if(s[1].Target){var c=$i(a,-1,s[1].Target.replace(/#.*$/,""),ni.HLINK);rr(t,494,nCe(s,c))}}),delete n["!links"]}function ECe(t,n,a,s){if(n["!comments"].length>0){var c=$i(s,-1,"../drawings/vmlDrawing"+(a+1)+".vml",ni.VML);rr(t,551,Rk("rId"+c)),n["!legacy"]=c}}function TCe(t,n,a,s){if(n["!autofilter"]){var c=n["!autofilter"],f=typeof c.ref=="string"?c.ref:Xn(c.ref);a.Workbook||(a.Workbook={Sheets:[]}),a.Workbook.Names||(a.Workbook.Names=[]);var d=a.Workbook.Names,p=ho(f);p.s.r==p.e.r&&(p.e.r=ho(n["!ref"]).e.r,f=Xn(p));for(var g=0;g<d.length;++g){var y=d[g];if(y.Name=="_xlnm._FilterDatabase"&&y.Sheet==s){y.Ref=Z_(a.SheetNames[s])+"!"+X_(f);break}}g==d.length&&d.push({Name:"_xlnm._FilterDatabase",Sheet:s,Ref:Z_(a.SheetNames[s])+"!"+X_(f)}),rr(t,161,wm(Ei(f))),rr(t,162)}}function SCe(t,n,a){rr(t,133),rr(t,137,fCe(n,a)),rr(t,138),rr(t,134)}function CCe(t,n){n["!protect"]&&rr(t,535,dCe(n["!protect"]))}function ACe(t,n,a,s){var c=Go(),f=a.SheetNames[t],d=a.Sheets[f]||{},p=f;try{a&&a.Workbook&&(p=a.Workbook.Sheets[t].CodeName||p)}catch{}var g=Ei(d["!ref"]||"A1");if(g.e.c>16383||g.e.r>1048575){if(n.WTF)throw new Error("Range "+(d["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");g.e.c=Math.min(g.e.c,16383),g.e.r=Math.min(g.e.c,1048575)}return d["!links"]=[],d["!comments"]=[],rr(c,129),(a.vbaraw||d["!outline"])&&rr(c,147,wSe(p,d["!outline"])),rr(c,148,ySe(g)),SCe(c,d,a.Workbook),xCe(c,d),vCe(c,d,t,n,a),CCe(c,d),TCe(c,d,a,t),yCe(c,d),wCe(c,d,s),d["!margins"]&&rr(c,476,cCe(d["!margins"])),(!n||n.ignoreEC||n.ignoreEC==null)&&bCe(c,d),ECe(c,d,t,s),rr(c,130),c.end()}function kCe(t){var n=[],a=t.match(/^<c:numCache>/),s;(t.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(f){var d=f.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);d&&(n[+d[1]]=a?+d[2]:d[2])});var c=bi((t.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(t.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(f){s=f.replace(/<.*?>/g,"")}),[n,c,s]}function ICe(t,n,a,s,c,f){var d=f||{"!type":"chart"};if(!t)return f;var p=0,g=0,y="A",b={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(t.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(E){var T=kCe(E);b.s.r=b.s.c=0,b.e.c=p,y=Qn(p),T[0].forEach(function(S,I){d["!data"]?(d["!data"][I]||(d["!data"][I]=[]),d["!data"][I][p]={t:"n",v:S,z:T[1]}):d[y+vi(I)]={t:"n",v:S,z:T[1]},g=I}),b.e.r<g&&(b.e.r=g),++p}),p>0&&(d["!ref"]=Xn(b)),d}function MCe(t,n,a,s,c){if(!t)return t;s||(s={"!id":{}});var f={"!type":"chart","!drawel":null,"!rel":""},d,p=t.match(a7);return p&&Xk(p[0],f,c,a),(d=t.match(/drawing r:id="(.*?)"/))&&(f["!rel"]=d[1]),s["!id"][f["!rel"]]&&(f["!drawel"]=s["!id"][f["!rel"]]),f}function FCe(t,n){t.l+=10;var a=qo(t);return{name:a}}function PCe(t,n,a,s,c){if(!t)return t;s||(s={"!id":{}});var f={"!type":"chart","!drawel":null,"!rel":""},d=!1;return ff(t,function(g,y,b){switch(b){case 550:f["!rel"]=g;break;case 651:c.Sheets[a]||(c.Sheets[a]={}),g.name&&(c.Sheets[a].CodeName=g.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:d=!0;break;case 36:d=!1;break;case 37:break;case 38:break;default:if(!(y.T>0)){if(!(y.T<0)){if(!d||n.WTF)throw new Error("Unexpected record 0x"+b.toString(16))}}}},n),s["!id"][f["!rel"]]&&(f["!drawel"]=s["!id"][f["!rel"]]),f}var Zk=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],OCe=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],RCe=[],LCe=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function F6(t,n){for(var a=0;a!=t.length;++a)for(var s=t[a],c=0;c!=n.length;++c){var f=n[c];if(s[f[0]]==null)s[f[0]]=f[1];else switch(f[2]){case"bool":typeof s[f[0]]=="string"&&(s[f[0]]=ji(s[f[0]]));break;case"int":typeof s[f[0]]=="string"&&(s[f[0]]=parseInt(s[f[0]],10));break}}}function P6(t,n){for(var a=0;a!=n.length;++a){var s=n[a];if(t[s[0]]==null)t[s[0]]=s[1];else switch(s[2]){case"bool":typeof t[s[0]]=="string"&&(t[s[0]]=ji(t[s[0]]));break;case"int":typeof t[s[0]]=="string"&&(t[s[0]]=parseInt(t[s[0]],10));break}}}function l7(t){P6(t.WBProps,Zk),P6(t.CalcPr,LCe),F6(t.WBView,OCe),F6(t.Sheets,RCe),R0.date1904=ji(t.WBProps.date1904)}function DCe(t){return!t.Workbook||!t.Workbook.WBProps?"false":ji(t.Workbook.WBProps.date1904)?"true":"false"}var BCe=":][*?/\\".split("");function c7(t,n){try{if(t=="")throw new Error("Sheet name cannot be blank");if(t.length>31)throw new Error("Sheet name cannot exceed 31 chars");if(t.charCodeAt(0)==39||t.charCodeAt(t.length-1)==39)throw new Error("Sheet name cannot start or end with apostrophe (')");if(t.toLowerCase()=="history")throw new Error("Sheet name cannot be 'History'");BCe.forEach(function(a){if(t.indexOf(a)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")})}catch(a){if(n)return!1;throw a}return!0}function zCe(t,n,a){t.forEach(function(s,c){c7(s);for(var f=0;f<c;++f)if(s==t[f])throw new Error("Duplicate Sheet Name: "+s);if(a){var d=n&&n[c]&&n[c].CodeName||s;if(d.charCodeAt(0)==95&&d.length>22)throw new Error("Bad Code Name: Worksheet"+d)}})}function u7(t){if(!t||!t.SheetNames||!t.Sheets)throw new Error("Invalid Workbook");if(!t.SheetNames.length)throw new Error("Workbook is empty");var n=t.Workbook&&t.Workbook.Sheets||[];zCe(t.SheetNames,n,!!t.vbaraw);for(var a=0;a<t.SheetNames.length;++a)BTe(t.Sheets[t.SheetNames[a]],t.SheetNames[a],a);t.SheetNames.forEach(function(s,c){var f=t.Sheets[s];if(!(!f||!f["!autofilter"])){var d;t.Workbook||(t.Workbook={}),t.Workbook.Names||(t.Workbook.Names=[]),t.Workbook.Names.forEach(function(g){g.Name=="_xlnm._FilterDatabase"&&g.Sheet==c&&(d=g)});var p=Z_(s)+"!"+X_(f["!autofilter"].ref);d?d.Ref=p:t.Workbook.Names.push({Name:"_xlnm._FilterDatabase",Sheet:c,Ref:p})}})}var NCe=/<\w+:workbook/;function UCe(t,n){if(!t)throw new Error("Could not find file");var a={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},s=!1,c="xmlns",f={},d=0;if(t.replace(ko,function(g,y){var b=Kr(g);switch(Dl(b[0])){case"<?xml":break;case"<workbook":g.match(NCe)&&(c="xmlns"+g.match(/<(\w+):/)[1]),a.xmlns=b[c];break;case"</workbook>":break;case"<fileVersion":delete b[0],a.AppVersion=b;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":Zk.forEach(function(E){if(b[E[0]]!=null)switch(E[2]){case"bool":a.WBProps[E[0]]=ji(b[E[0]]);break;case"int":a.WBProps[E[0]]=parseInt(b[E[0]],10);break;default:a.WBProps[E[0]]=b[E[0]]}}),b.codeName&&(a.WBProps.CodeName=Ki(b.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete b[0],a.WBView.push(b);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(b.state){case"hidden":b.Hidden=1;break;case"veryHidden":b.Hidden=2;break;default:b.Hidden=0}delete b.state,b.name=bi(Ki(b.name)),delete b[0],a.Sheets.push(b);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":s=!0;break;case"</definedNames>":s=!1;break;case"<definedName":f={},f.Name=Ki(b.name),b.comment&&(f.Comment=b.comment),b.localSheetId&&(f.Sheet=+b.localSheetId),ji(b.hidden||"0")&&(f.Hidden=!0),d=y+g.length;break;case"</definedName>":f.Ref=bi(Ki(t.slice(d,y))),a.Names.push(f);break;case"<definedName/>":break;case"<calcPr":delete b[0],a.CalcPr=b;break;case"<calcPr/>":delete b[0],a.CalcPr=b;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":s=!0;break;case"</AlternateContent>":s=!1;break;case"<revisionPtr":break;default:if(!s&&n.WTF)throw new Error("unrecognized "+b[0]+" in workbook")}return g}),lp.indexOf(a.xmlns)===-1)throw new Error("Unknown Namespace: "+a.xmlns);return l7(a),a}function $Ce(t){var n=[Wa];n[n.length]=Er("workbook",null,{xmlns:lp[0],"xmlns:r":uo.r});var a=t.Workbook&&(t.Workbook.Names||[]).length>0,s={codeName:"ThisWorkbook"};t.Workbook&&t.Workbook.WBProps&&(Zk.forEach(function(p){t.Workbook.WBProps[p[0]]!=null&&t.Workbook.WBProps[p[0]]!=p[1]&&(s[p[0]]=t.Workbook.WBProps[p[0]])}),t.Workbook.WBProps.CodeName&&(s.codeName=t.Workbook.WBProps.CodeName,delete s.CodeName)),n[n.length]=Er("workbookPr",null,s);var c=t.Workbook&&t.Workbook.Sheets||[],f=0;if(c&&c[0]&&c[0].Hidden){for(n[n.length]="<bookViews>",f=0;f!=t.SheetNames.length&&!(!c[f]||!c[f].Hidden);++f);f==t.SheetNames.length&&(f=0),n[n.length]='<workbookView firstSheet="'+f+'" activeTab="'+f+'"/>',n[n.length]="</bookViews>"}for(n[n.length]="<sheets>",f=0;f!=t.SheetNames.length;++f){var d={name:Yn(t.SheetNames[f].slice(0,31))};if(d.sheetId=""+(f+1),d["r:id"]="rId"+(f+1),c[f])switch(c[f].Hidden){case 1:d.state="hidden";break;case 2:d.state="veryHidden";break}n[n.length]=Er("sheet",null,d)}return n[n.length]="</sheets>",a&&(n[n.length]="<definedNames>",t.Workbook&&t.Workbook.Names&&t.Workbook.Names.forEach(function(p){var g={name:p.Name};p.Comment&&(g.comment=p.Comment),p.Sheet!=null&&(g.localSheetId=""+p.Sheet),p.Hidden&&(g.hidden="1"),p.Ref&&(n[n.length]=Er("definedName",Yn(p.Ref),g))}),n[n.length]="</definedNames>"),n.length>2&&(n[n.length]="</workbook>",n[1]=n[1].replace("/>",">")),n.join("")}function VCe(t,n){var a={};return a.Hidden=t.read_shift(4),a.iTabID=t.read_shift(4),a.strRelID=OC(t),a.name=qo(t),a}function jCe(t,n){return n||(n=zt(127)),n.write_shift(4,t.Hidden),n.write_shift(4,t.iTabID),Rk(t.strRelID,n),fo(t.name.slice(0,31),n),n.length>n.l?n.slice(0,n.l):n}function WCe(t,n){var a={},s=t.read_shift(4);a.defaultThemeVersion=t.read_shift(4);var c=n>8?qo(t):"";return c.length>0&&(a.CodeName=c),a.autoCompressPictures=!!(s&65536),a.backupFile=!!(s&64),a.checkCompatibility=!!(s&4096),a.date1904=!!(s&1),a.filterPrivacy=!!(s&8),a.hidePivotFieldList=!!(s&1024),a.promptedSolutions=!!(s&16),a.publishItems=!!(s&2048),a.refreshAllConnections=!!(s&262144),a.saveExternalLinkValues=!!(s&128),a.showBorderUnselectedTables=!!(s&4),a.showInkAnnotation=!!(s&32),a.showObjects=["all","placeholders","none"][s>>13&3],a.showPivotChartFilter=!!(s&32768),a.updateLinks=["userSet","never","always"][s>>8&3],a}function HCe(t,n){n||(n=zt(72));var a=0;return t&&(t.date1904&&(a|=1),t.filterPrivacy&&(a|=8)),n.write_shift(4,a),n.write_shift(4,0),i9(t&&t.CodeName||"ThisWorkbook",n),n.slice(0,n.l)}function GCe(t,n){var a={};return t.read_shift(4),a.ArchID=t.read_shift(4),t.l+=n-8,a}function qCe(t,n,a){var s=t.l+n,c=t.read_shift(4);t.l+=1;var f=t.read_shift(4),d=tye(t),p=bTe(t,0,a),g=cw(t);c&32&&(d="_xlnm."+d),t.l=s;var y={Name:d,Ptg:p,Flags:c};return f<268435455&&(y.Sheet=f),g&&(y.Comment=g),y}function XCe(t,n){var a=zt(9),s=0,c=t.Name;Bk.indexOf(c)>-1&&(s|=32,c=c.slice(6)),a.write_shift(4,s),a.write_shift(1,0),a.write_shift(4,t.Sheet==null?4294967295:t.Sheet);var f=[a,fo(c),OTe(t.Ref,n)];if(t.Comment)f.push(K_(t.Comment));else{var d=zt(4);d.write_shift(4,4294967295),f.push(d)}return Va(f)}function ZCe(t,n){var a={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},s=[],c=!1;n||(n={}),n.biff=12;var f=[],d=[[]];return d.SheetNames=[],d.XTI=[],rv[16]={n:"BrtFRTArchID$",f:GCe},ff(t,function(g,y,b){switch(b){case 156:d.SheetNames.push(g.name),a.Sheets.push(g);break;case 153:a.WBProps=g;break;case 39:g.Sheet!=null&&(n.SID=g.Sheet),g.Ref=zo(g.Ptg,null,null,d,n),delete n.SID,delete g.Ptg,f.push(g);break;case 1036:break;case 357:case 358:case 355:case 667:d[0].length?d.push([b,g]):d[0]=[b,g],d[d.length-1].XTI=[];break;case 362:d.length===0&&(d[0]=[],d[0].XTI=[]),d[d.length-1].XTI=d[d.length-1].XTI.concat(g),d.XTI=d.XTI.concat(g);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:s.push(b),c=!0;break;case 36:s.pop(),c=!1;break;case 37:s.push(b),c=!0;break;case 38:s.pop(),c=!1;break;case 16:break;default:if(!y.T){if(!c||n.WTF&&s[s.length-1]!=37&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+b.toString(16))}}},n),l7(a),a.Names=f,a.supbooks=d,a}function KCe(t,n){rr(t,143);for(var a=0;a!=n.SheetNames.length;++a){var s=n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[a]&&n.Workbook.Sheets[a].Hidden||0,c={Hidden:s,iTabID:a+1,strRelID:"rId"+(a+1),name:n.SheetNames[a]};rr(t,156,jCe(c))}rr(t,144)}function YCe(t,n){n||(n=zt(127));for(var a=0;a!=4;++a)n.write_shift(4,0);return fo("SheetJS",n),fo(eb.version,n),fo(eb.version,n),fo("7262",n),n.length>n.l?n.slice(0,n.l):n}function JCe(t,n){n||(n=zt(29)),n.write_shift(-4,0),n.write_shift(-4,460),n.write_shift(4,28800),n.write_shift(4,17600),n.write_shift(4,500),n.write_shift(4,t),n.write_shift(4,t);var a=120;return n.write_shift(1,a),n.length>n.l?n.slice(0,n.l):n}function QCe(t,n){if(!(!n.Workbook||!n.Workbook.Sheets)){for(var a=n.Workbook.Sheets,s=0,c=-1,f=-1;s<a.length;++s)!a[s]||!a[s].Hidden&&c==-1?c=s:a[s].Hidden==1&&f==-1&&(f=s);f>c||(rr(t,135),rr(t,158,JCe(c)),rr(t,136))}}function eAe(t,n){!n.Workbook||!n.Workbook.Names||n.Workbook.Names.forEach(function(a){try{if(a.Flags&14)return;rr(t,39,XCe(a,n))}catch{console.error("Could not serialize defined name "+JSON.stringify(a))}})}function tAe(t){var n=t.SheetNames.length,a=zt(12*n+28);a.write_shift(4,n+2),a.write_shift(4,0),a.write_shift(4,-2),a.write_shift(4,-2),a.write_shift(4,0),a.write_shift(4,-1),a.write_shift(4,-1);for(var s=0;s<n;++s)a.write_shift(4,0),a.write_shift(4,s),a.write_shift(4,s);return a}function rAe(t,n){rr(t,353),rr(t,357),rr(t,362,tAe(n)),rr(t,354)}function nAe(t,n){var a=Go();return rr(a,131),rr(a,128,YCe()),rr(a,153,HCe(t.Workbook&&t.Workbook.WBProps||null)),QCe(a,t),KCe(a,t),rAe(a,t),(t.Workbook||{}).Names&&eAe(a,t),rr(a,132),a.end()}function iAe(t,n,a){return n.slice(-4)===".bin"?ZCe(t,a):UCe(t,a)}function aAe(t,n,a,s,c,f,d,p){return n.slice(-4)===".bin"?gCe(t,s,a,c,f,d,p):XTe(t,s,a,c,f,d,p)}function oAe(t,n,a,s,c,f,d,p){return n.slice(-4)===".bin"?PCe(t,s,a,c,f):MCe(t,s,a,c,f)}function sAe(t,n,a,s,c,f,d,p){return n.slice(-4)===".bin"?Y2e():J2e()}function lAe(t,n,a,s,c,f,d,p){return n.slice(-4)===".bin"?Z2e():K2e()}function cAe(t,n,a,s){return n.slice(-4)===".bin"?jwe(t,a,s):Mwe(t,a,s)}function uAe(t,n,a){return n.slice(-4)===".bin"?Gbe(t,a):Vbe(t,a)}function fAe(t,n,a){return n.slice(-4)===".bin"?j2e(t,a):D2e(t,a)}function hAe(t,n,a){return n.slice(-4)===".bin"?M2e(t):k2e(t)}function dAe(t,n,a,s){return a.slice(-4)===".bin"?F2e(t,n,a,s):void 0}function pAe(t,n,a){return n.slice(-4)===".bin"?T2e(t,n,a):C2e(t,n,a)}var f7=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,h7=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function tc(t,n){var a=t.split(/\s+/),s=[];if(n||(s[0]=a[0]),a.length===1)return s;var c=t.match(f7),f,d,p,g;if(c)for(g=0;g!=c.length;++g)f=c[g].match(h7),(d=f[1].indexOf(":"))===-1?s[f[1]]=f[2].slice(1,f[2].length-1):(f[1].slice(0,6)==="xmlns:"?p="xmlns"+f[1].slice(6):p=f[1].slice(d+1),s[p]=f[2].slice(1,f[2].length-1));return s}function mAe(t){var n=t.split(/\s+/),a={};if(n.length===1)return a;var s=t.match(f7),c,f,d,p;if(s)for(p=0;p!=s.length;++p)c=s[p].match(h7),(f=c[1].indexOf(":"))===-1?a[c[1]]=c[2].slice(1,c[2].length-1):(c[1].slice(0,6)==="xmlns:"?d="xmlns"+c[1].slice(6):d=c[1].slice(f+1),a[d]=c[2].slice(1,c[2].length-1));return a}var g_;function gAe(t,n,a){var s=g_[t]||bi(t);return s==="General"?Zd(n):$s(s,n,{date1904:!!a})}function _Ae(t,n,a,s){var c=s;switch((a[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":c=ji(s);break;case"i2":case"int":c=parseInt(s,10);break;case"r4":case"float":c=parseFloat(s);break;case"date":case"dateTime.tz":c=Fa(s);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+a[0])}t[bi(n)]=c}function vAe(t,n,a,s){if(t.t!=="z"){if(!a||a.cellText!==!1)try{t.t==="e"?t.w=t.w||uc[t.v]:n==="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=W_(t.v):t.w=Zd(t.v):t.w=gAe(n||"General",t.v,s)}catch(d){if(a.WTF)throw d}try{var c=g_[n]||n||"General";if(a.cellNF&&(t.z=c),a.cellDates&&t.t=="n"&&cl(c)){var f=vh(t.v+(s?1462:0));f&&(t.t="d",t.v=new Date(Date.UTC(f.y,f.m-1,f.d,f.H,f.M,f.S,f.u)))}}catch(d){if(a.WTF)throw d}}}function yAe(t,n,a){if(a.cellStyles&&n.Interior){var s=n.Interior;s.Pattern&&(s.patternType=wwe[s.Pattern]||s.Pattern)}t[n.ID]=n}function xAe(t,n,a,s,c,f,d,p,g,y,b){var E="General",T=s.StyleID,S={};y=y||{};var I=[],A=0;for(T===void 0&&p&&(T=p.StyleID),T===void 0&&d&&(T=d.StyleID);f[T]!==void 0&&(f[T].nf&&(E=f[T].nf),f[T].Interior&&I.push(f[T].Interior),!!f[T].Parent);)T=f[T].Parent;switch(a.Type){case"Boolean":s.t="b",s.v=ji(t);break;case"String":s.t="s",s.r=G5(bi(t)),s.v=t.indexOf("<")>-1?bi(n||t).replace(/<.*?>/g,""):s.r;break;case"DateTime":t.slice(-1)!="Z"&&(t+="Z"),s.v=La(Fa(t,b),b),s.v!==s.v&&(s.v=bi(t)),(!E||E=="General")&&(E="yyyy-mm-dd");case"Number":s.v===void 0&&(s.v=+t),s.t||(s.t="n");break;case"Error":s.t="e",s.v=Dk[t],y.cellText!==!1&&(s.w=t);break;default:t==""&&n==""?s.t="z":(s.t="s",s.v=G5(n||t));break}if(vAe(s,E,y,b),y.cellFormula!==!1)if(s.Formula){var M=bi(s.Formula);M.charCodeAt(0)==61&&(M=M.slice(1)),s.f=Vd(M,c),delete s.Formula,s.ArrayRange=="RC"?s.F=Vd("RC:RC",c):s.ArrayRange&&(s.F=Vd(s.ArrayRange,c),g.push([Ei(s.F),s.F]))}else for(A=0;A<g.length;++A)c.r>=g[A][0].s.r&&c.r<=g[A][0].e.r&&c.c>=g[A][0].s.c&&c.c<=g[A][0].e.c&&(s.F=g[A][1]);y.cellStyles&&(I.forEach(function(F){!S.patternType&&F.patternType&&(S.patternType=F.patternType)}),s.s=S),s.StyleID!==void 0&&(s.ixfe=s.StyleID)}function bAe(t){return Bk.indexOf("_xlnm."+t)>-1?"_xlnm."+t:t}function wAe(t){t.t=t.v||"",t.t=t.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.v=t.w=t.ixfe=void 0}function wS(t,n){var a=n||{};ym();var s=S0(sw(t));(a.type=="binary"||a.type=="array"||a.type=="base64")&&(typeof Jn<"u"?s=Jn.utils.decode(65001,tb(s)):s=Ki(s));var c=s.slice(0,1024).toLowerCase(),f=!1;if(c=c.replace(/".*?"/g,""),(c.indexOf(">")&1023)>Math.min(c.indexOf(",")&1023,c.indexOf(";")&1023)){var d=Qi(a);return d.type="string",om.to_workbook(s,d)}if(c.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(K){c.indexOf("<"+K)>=0&&(f=!0)}),f)return ake(s,a);g_={"General Number":"General","General Date":pn[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":pn[15],"Short Date":pn[14],"Long Time":pn[19],"Medium Time":pn[18],"Short Time":pn[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:pn[2],Standard:pn[4],Percent:pn[10],Scientific:pn[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var p,g=[],y,b={},E=[],T={},S="";a.dense&&(T["!data"]=[]);var I={},A={},M=tc('<Data ss:Type="String">'),F=0,L=0,O=0,N={s:{r:2e6,c:2e6},e:{r:0,c:0}},Q={},ie={},j="",V=0,D=[],te={},ue={},J=0,le=[],re=[],Fe={},Ye=[],Ee,ut=!1,Ne=[],He=[],Oe={},Pe=0,rt=0,et={Sheets:[],WBProps:{date1904:!1}},Ge={};Ja.lastIndex=0,s=s.replace(/<!--([\s\S]*?)-->/mg,"");for(var ze="";p=Ja.exec(s);)switch(p[3]=(ze=p[3]).toLowerCase()){case"data":if(ze=="data"){if(p[1]==="/"){if((y=g.pop())[0]!==p[3])throw new Error("Bad state: "+y.join("|"))}else p[0].charAt(p[0].length-2)!=="/"&&g.push([p[3],!0]);break}if(g[g.length-1][1])break;p[1]==="/"?xAe(s.slice(F,p.index),j,M,g[g.length-1][0]=="comment"?Fe:I,{c:L,r:O},Q,Ye[L],A,Ne,a,et.WBProps.date1904):(j="",M=tc(p[0]),F=p.index+p[0].length);break;case"cell":if(p[1]==="/")if(re.length>0&&(I.c=re),(!a.sheetRows||a.sheetRows>O)&&I.v!==void 0&&(a.dense?(T["!data"][O]||(T["!data"][O]=[]),T["!data"][O][L]=I):T[Qn(L)+vi(O)]=I),I.HRef&&(I.l={Target:bi(I.HRef)},I.HRefScreenTip&&(I.l.Tooltip=I.HRefScreenTip),delete I.HRef,delete I.HRefScreenTip),(I.MergeAcross||I.MergeDown)&&(Pe=L+(parseInt(I.MergeAcross,10)|0),rt=O+(parseInt(I.MergeDown,10)|0),(Pe>L||rt>O)&&D.push({s:{c:L,r:O},e:{c:Pe,r:rt}})),!a.sheetStubs)I.MergeAcross?L=Pe+1:++L;else if(I.MergeAcross||I.MergeDown){for(var oe=L;oe<=Pe;++oe)for(var Me=O;Me<=rt;++Me)(oe>L||Me>O)&&(a.dense?(T["!data"][Me]||(T["!data"][Me]=[]),T["!data"][Me][oe]={t:"z"}):T[Qn(oe)+vi(Me)]={t:"z"});L=Pe+1}else++L;else I=mAe(p[0]),I.Index&&(L=+I.Index-1),L<N.s.c&&(N.s.c=L),L>N.e.c&&(N.e.c=L),p[0].slice(-2)==="/>"&&++L,re=[];break;case"row":p[1]==="/"||p[0].slice(-2)==="/>"?(O<N.s.r&&(N.s.r=O),O>N.e.r&&(N.e.r=O),p[0].slice(-2)==="/>"&&(A=tc(p[0]),A.Index&&(O=+A.Index-1)),L=0,++O):(A=tc(p[0]),A.Index&&(O=+A.Index-1),Oe={},(A.AutoFitHeight=="0"||A.Height)&&(Oe.hpx=parseInt(A.Height,10),Oe.hpt=tv(Oe.hpx),He[O]=Oe),A.Hidden=="1"&&(Oe.hidden=!0,He[O]=Oe));break;case"worksheet":if(p[1]==="/"){if((y=g.pop())[0]!==p[3])throw new Error("Bad state: "+y.join("|"));E.push(S),N.s.r<=N.e.r&&N.s.c<=N.e.c&&(T["!ref"]=Xn(N),a.sheetRows&&a.sheetRows<=N.e.r&&(T["!fullref"]=T["!ref"],N.e.r=a.sheetRows-1,T["!ref"]=Xn(N))),D.length&&(T["!merges"]=D),Ye.length>0&&(T["!cols"]=Ye),He.length>0&&(T["!rows"]=He),b[S]=T}else N={s:{r:2e6,c:2e6},e:{r:0,c:0}},O=L=0,g.push([p[3],!1]),y=tc(p[0]),S=bi(y.Name),T={},a.dense&&(T["!data"]=[]),D=[],Ne=[],He=[],Ge={name:S,Hidden:0},et.Sheets.push(Ge);break;case"table":if(p[1]==="/"){if((y=g.pop())[0]!==p[3])throw new Error("Bad state: "+y.join("|"))}else{if(p[0].slice(-2)=="/>")break;g.push([p[3],!1]),Ye=[],ut=!1}break;case"style":p[1]==="/"?yAe(Q,ie,a):ie=tc(p[0]);break;case"numberformat":ie.nf=bi(tc(p[0]).Format||"General"),g_[ie.nf]&&(ie.nf=g_[ie.nf]);for(var fe=0;fe!=392&&pn[fe]!=ie.nf;++fe);if(fe==392){for(fe=57;fe!=392;++fe)if(pn[fe]==null){Eh(ie.nf,fe);break}}break;case"column":if(g[g.length-1][0]!=="table"||p[1]==="/")break;if(Ee=tc(p[0]),Ee.Hidden&&(Ee.hidden=!0,delete Ee.Hidden),Ee.Width&&(Ee.wpx=parseInt(Ee.Width,10)),!ut&&Ee.wpx>10){ut=!0,No=V9;for(var pe=0;pe<Ye.length;++pe)Ye[pe]&&kh(Ye[pe])}ut&&kh(Ee),Ye[Ee.Index-1||Ye.length]=Ee;for(var ot=0;ot<+Ee.Span;++ot)Ye[Ye.length]=Qi(Ee);break;case"namedrange":if(p[1]==="/")break;et.Names||(et.Names=[]);var xe=Kr(p[0]),ae={Name:bAe(xe.Name),Ref:Vd(xe.RefersTo.slice(1),{r:0,c:0})};et.Sheets.length>0&&(ae.Sheet=et.Sheets.length-1),et.Names.push(ae);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(p[0].slice(-2)==="/>")break;p[1]==="/"?j+=s.slice(V,p.index):V=p.index+p[0].length;break;case"interior":if(!a.cellStyles)break;ie.Interior=tc(p[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(p[0].slice(-2)==="/>")break;p[1]==="/"?Cye(te,ze,s.slice(J,p.index)):J=p.index+p[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(p[1]==="/"){if((y=g.pop())[0]!==p[3])throw new Error("Bad state: "+y.join("|"))}else g.push([p[3],!1]);break;case"comment":if(p[1]==="/"){if((y=g.pop())[0]!==p[3])throw new Error("Bad state: "+y.join("|"));wAe(Fe),re.push(Fe)}else g.push([p[3],!1]),y=tc(p[0]),ji(y.ShowAlways||"0")||(re.hidden=!0),Fe={a:y.Author};break;case"autofilter":if(p[1]==="/"){if((y=g.pop())[0]!==p[3])throw new Error("Bad state: "+y.join("|"))}else if(p[0].charAt(p[0].length-2)!=="/"){var X=tc(p[0]);T["!autofilter"]={ref:Vd(X.Range).replace(/\$/g,"")},g.push([p[3],!0])}break;case"name":break;case"datavalidation":if(p[1]==="/"){if((y=g.pop())[0]!==p[3])throw new Error("Bad state: "+y.join("|"))}else p[0].charAt(p[0].length-2)!=="/"&&g.push([p[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(p[1]==="/"){if((y=g.pop())[0]!==p[3])throw new Error("Bad state: "+y.join("|"))}else p[0].charAt(p[0].length-2)!=="/"&&g.push([p[3],!0]);break;case"null":break;default:if(g.length==0&&p[3]=="document"||g.length==0&&p[3]=="uof")return D6(s,a);var Ce=!0;switch(g[g.length-1][0]){case"officedocumentsettings":switch(p[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Ce=!1}break;case"componentoptions":switch(p[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Ce=!1}break;case"excelworkbook":switch(p[3]){case"date1904":et.WBProps.date1904=!0;break;case"hidehorizontalscrollbar":break;case"hideverticalscrollbar":break;case"hideworkbooktabs":break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Ce=!1}break;case"workbookoptions":switch(p[3]){case"owcversion":break;case"height":break;case"width":break;default:Ce=!1}break;case"worksheetoptions":switch(p[3]){case"visible":if(p[0].slice(-2)!=="/>")if(p[1]==="/")switch(s.slice(J,p.index)){case"SheetHidden":Ge.Hidden=1;break;case"SheetVeryHidden":Ge.Hidden=2;break}else J=p.index+p[0].length;break;case"header":T["!margins"]||jd(T["!margins"]={},"xlml"),isNaN(+Kr(p[0]).Margin)||(T["!margins"].header=+Kr(p[0]).Margin);break;case"footer":T["!margins"]||jd(T["!margins"]={},"xlml"),isNaN(+Kr(p[0]).Margin)||(T["!margins"].footer=+Kr(p[0]).Margin);break;case"pagemargins":var he=Kr(p[0]);T["!margins"]||jd(T["!margins"]={},"xlml"),isNaN(+he.Top)||(T["!margins"].top=+he.Top),isNaN(+he.Left)||(T["!margins"].left=+he.Left),isNaN(+he.Right)||(T["!margins"].right=+he.Right),isNaN(+he.Bottom)||(T["!margins"].bottom=+he.Bottom);break;case"displayrighttoleft":et.Views||(et.Views=[]),et.Views[0]||(et.Views[0]={}),et.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":T["!outline"]||(T["!outline"]={}),T["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":T["!outline"]||(T["!outline"]={}),T["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Ce=!1}break;case"pivottable":case"pivotcache":switch(p[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Ce=!1}break;case"pagebreaks":switch(p[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Ce=!1}break;case"autofilter":switch(p[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Ce=!1}break;case"querytable":switch(p[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Ce=!1}break;case"datavalidation":switch(p[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Ce=!1}break;case"sorting":case"conditionalformatting":switch(p[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Ce=!1}break;case"mapinfo":case"schema":case"data":switch(p[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Ce=!1}break;case"smarttags":break;default:Ce=!1;break}if(Ce||p[3].match(/!\[CDATA/))break;if(!g[g.length-1][1])throw"Unrecognized tag: "+p[3]+"|"+g.join("|");if(g[g.length-1][0]==="customdocumentproperties"){if(p[0].slice(-2)==="/>")break;p[1]==="/"?_Ae(ue,ze,le,s.slice(J,p.index)):(le=p,J=p.index+p[0].length);break}if(a.WTF)throw"Unrecognized tag: "+p[3]+"|"+g.join("|")}var G={};return!a.bookSheets&&!a.bookProps&&(G.Sheets=b),G.SheetNames=E,G.Workbook=et,G.SSF=Qi(pn),G.Props=te,G.Custprops=ue,G.bookType="xlml",G}function UC(t,n){switch(Yk(n=n||{}),n.type||"base64"){case"base64":return wS(ll(t),n);case"binary":case"buffer":case"file":return wS(t,n);case"array":return wS(su(t),n)}}function EAe(t,n){var a=[];return t.Props&&a.push(Aye(t.Props,n)),t.Custprops&&a.push(kye(t.Props,t.Custprops)),a.join("")}function TAe(t){return(((t||{}).Workbook||{}).WBProps||{}).date1904?'<ExcelWorkbook xmlns="urn:schemas-microsoft-com:office:excel"><Date1904/></ExcelWorkbook>':""}function SAe(t,n){var a=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return n.cellXfs.forEach(function(s,c){var f=[];f.push(Er("NumberFormat",null,{"ss:Format":Yn(pn[s.numFmtId])}));var d={"ss:ID":"s"+(21+c)};a.push(Er("Style",f.join(""),d))}),Er("Styles",a.join(""))}function d7(t){return Er("NamedRange",null,{"ss:Name":t.Name.slice(0,6)=="_xlnm."?t.Name.slice(6):t.Name,"ss:RefersTo":"="+hw(t.Ref,{r:0,c:0})})}function CAe(t){if(!((t||{}).Workbook||{}).Names)return"";for(var n=t.Workbook.Names,a=[],s=0;s<n.length;++s){var c=n[s];c.Sheet==null&&(c.Name.match(/^_xlfn\./)||a.push(d7(c)))}return Er("Names",a.join(""))}function AAe(t,n,a,s){if(!t||!((s||{}).Workbook||{}).Names)return"";for(var c=s.Workbook.Names,f=[],d=0;d<c.length;++d){var p=c[d];p.Sheet==a&&(p.Name.match(/^_xlfn\./)||f.push(d7(p)))}return f.join("")}function kAe(t,n,a,s){if(!t)return"";var c=[];if(t["!margins"]&&(c.push("<PageSetup>"),t["!margins"].header&&c.push(Er("Header",null,{"x:Margin":t["!margins"].header})),t["!margins"].footer&&c.push(Er("Footer",null,{"x:Margin":t["!margins"].footer})),c.push(Er("PageMargins",null,{"x:Bottom":t["!margins"].bottom||"0.75","x:Left":t["!margins"].left||"0.7","x:Right":t["!margins"].right||"0.7","x:Top":t["!margins"].top||"0.75"})),c.push("</PageSetup>")),s&&s.Workbook&&s.Workbook.Sheets&&s.Workbook.Sheets[a])if(s.Workbook.Sheets[a].Hidden)c.push(Er("Visible",s.Workbook.Sheets[a].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var f=0;f<a&&!(s.Workbook.Sheets[f]&&!s.Workbook.Sheets[f].Hidden);++f);f==a&&c.push("<Selected/>")}return((((s||{}).Workbook||{}).Views||[])[0]||{}).RTL&&c.push("<DisplayRightToLeft/>"),t["!protect"]&&(c.push(Co("ProtectContents","True")),t["!protect"].objects&&c.push(Co("ProtectObjects","True")),t["!protect"].scenarios&&c.push(Co("ProtectScenarios","True")),t["!protect"].selectLockedCells!=null&&!t["!protect"].selectLockedCells?c.push(Co("EnableSelection","NoSelection")):t["!protect"].selectUnlockedCells!=null&&!t["!protect"].selectUnlockedCells&&c.push(Co("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(d){t["!protect"][d[0]]&&c.push("<"+d[1]+"/>")})),c.length==0?"":Er("WorksheetOptions",c.join(""),{xmlns:nl.x})}function IAe(t){return t.map(function(n){var a=M1e(n.t||""),s=Er("ss:Data",a,{xmlns:"http://www.w3.org/TR/REC-html40"}),c={};return n.a&&(c["ss:Author"]=n.a),t.hidden||(c["ss:ShowAlways"]="1"),Er("Comment",s,c)}).join("")}function MAe(t,n,a,s,c,f,d){if(!t||t.v==null&&t.f==null)return"";var p={};if(t.f&&(p["ss:Formula"]="="+Yn(hw(t.f,d))),t.F&&t.F.slice(0,n.length)==n){var g=Yi(t.F.slice(n.length+1));p["ss:ArrayRange"]="RC:R"+(g.r==d.r?"":"["+(g.r-d.r)+"]")+"C"+(g.c==d.c?"":"["+(g.c-d.c)+"]")}if(t.l&&t.l.Target&&(p["ss:HRef"]=Yn(t.l.Target),t.l.Tooltip&&(p["x:HRefScreenTip"]=Yn(t.l.Tooltip))),a["!merges"])for(var y=a["!merges"],b=0;b!=y.length;++b)y[b].s.c!=d.c||y[b].s.r!=d.r||(y[b].e.c>y[b].s.c&&(p["ss:MergeAcross"]=y[b].e.c-y[b].s.c),y[b].e.r>y[b].s.r&&(p["ss:MergeDown"]=y[b].e.r-y[b].s.r));var E="",T="";switch(t.t){case"z":if(!s.sheetStubs)return"";break;case"n":E="Number",T=String(t.v);break;case"b":E="Boolean",T=t.v?"1":"0";break;case"e":E="Error",T=uc[t.v];break;case"d":E="DateTime",T=new Date(t.v).toISOString(),t.z==null&&(t.z=t.z||pn[14]);break;case"s":E="String",T=I1e(t.v||"");break}var S=zh(s.cellXfs,t,s);p["ss:StyleID"]="s"+(21+S),p["ss:Index"]=d.c+1;var I=t.v!=null?T:"",A=t.t=="z"?"":'<Data ss:Type="'+E+'">'+I+"</Data>";return(t.c||[]).length>0&&(A+=IAe(t.c)),Er("Cell",A,p)}function FAe(t,n){var a='<Row ss:Index="'+(t+1)+'"';return n&&(n.hpt&&!n.hpx&&(n.hpx=sm(n.hpt)),n.hpx&&(a+=' ss:AutoFitHeight="0" ss:Height="'+n.hpx+'"'),n.hidden&&(a+=' ss:Hidden="1"')),a+">"}function PAe(t,n,a,s){if(!t["!ref"])return"";var c=Ei(t["!ref"]),f=t["!merges"]||[],d=0,p=[];t["!cols"]&&t["!cols"].forEach(function(M,F){kh(M);var L=!!M.width,O=mw(F,M),N={"ss:Index":F+1};L&&(N["ss:Width"]=Q_(O.width)),M.hidden&&(N["ss:Hidden"]="1"),p.push(Er("Column",null,N))});for(var g=t["!data"]!=null,y=c.s.r;y<=c.e.r;++y){for(var b=[FAe(y,(t["!rows"]||[])[y])],E=c.s.c;E<=c.e.c;++E){var T=!1;for(d=0;d!=f.length;++d)if(!(f[d].s.c>E)&&!(f[d].s.r>y)&&!(f[d].e.c<E)&&!(f[d].e.r<y)){(f[d].s.c!=E||f[d].s.r!=y)&&(T=!0);break}if(!T){var S={r:y,c:E},I=Qn(E)+vi(y),A=g?(t["!data"][y]||[])[E]:t[I];b.push(MAe(A,I,t,n,a,s,S))}}b.push("</Row>"),b.length>2&&p.push(b.join(""))}return p.join("")}function OAe(t,n,a){var s=[],c=a.SheetNames[t],f=a.Sheets[c],d=f?AAe(f,n,t,a):"";return d.length>0&&s.push("<Names>"+d+"</Names>"),d=f?PAe(f,n,t,a):"",d.length>0&&s.push("<Table>"+d+"</Table>"),s.push(kAe(f,n,t,a)),f["!autofilter"]&&s.push('<AutoFilter x:Range="'+hw(X_(f["!autofilter"].ref),{r:0,c:0})+'" xmlns="urn:schemas-microsoft-com:office:excel"></AutoFilter>'),s.join("")}function RAe(t,n){n||(n={}),t.SSF||(t.SSF=Qi(pn)),t.SSF&&(ym(),wv(t.SSF),n.revssf=aw(t.SSF),n.revssf[t.SSF[65535]]=0,n.ssf=t.SSF,n.cellXfs=[],zh(n.cellXfs,{},{revssf:{General:0}}));var a=[];a.push(EAe(t,n)),a.push(TAe(t)),a.push(""),a.push("");for(var s=0;s<t.SheetNames.length;++s)a.push(Er("Worksheet",OAe(s,n,t),{"ss:Name":Yn(t.SheetNames[s])}));return a[2]=SAe(t,n),a[3]=CAe(t),Wa+Er("Workbook",a.join(""),{xmlns:nl.ss,"xmlns:o":nl.o,"xmlns:x":nl.x,"xmlns:ss":nl.ss,"xmlns:dt":nl.dt,"xmlns:html":nl.html})}function LAe(t){var n={},a=t.content;if(a.l=28,n.AnsiUserType=a.read_shift(0,"lpstr-ansi"),n.AnsiClipboardFormat=oye(a),a.length-a.l<=4)return n;var s=a.read_shift(4);if(s==0||s>40||(a.l-=4,n.Reserved1=a.read_shift(0,"lpstr-ansi"),a.length-a.l<=4)||(s=a.read_shift(4),s!==1907505652)||(n.UnicodeClipboardFormat=sye(a),s=a.read_shift(4),s==0||s>40))return n;a.l-=4,n.Reserved2=a.read_shift(0,"lpwstr")}var DAe=[60,1084,2066,2165,2175];function BAe(t,n,a,s,c){var f=s,d=[],p=a.slice(a.l,a.l+f);if(c&&c.enc&&c.enc.insitu&&p.length>0)switch(t){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:c.enc.insitu(p)}d.push(p),a.l+=f;for(var g=Hu(a,a.l),y=$C[g],b=0;y!=null&&DAe.indexOf(g)>-1;)f=Hu(a,a.l+2),b=a.l+4,g==2066?b+=4:(g==2165||g==2175)&&(b+=12),p=a.slice(b,a.l+4+f),d.push(p),a.l+=4+f,y=$C[g=Hu(a,a.l)];var E=Va(d);so(E,0);var T=0;E.lens=[];for(var S=0;S<d.length;++S)E.lens.push(T),T+=d[S].length;if(E.length<s)throw"XLS Record 0x"+t.toString(16)+" Truncated: "+E.length+" < "+s;return n.f(E,E.length,c)}function Xc(t,n,a){if(t.t!=="z"&&t.XF){var s=0;try{s=t.z||t.XF.numFmtId||0,n.cellNF&&t.z==null&&(t.z=pn[s])}catch(f){if(n.WTF)throw f}if(!n||n.cellText!==!1)try{t.t==="e"?t.w=t.w||uc[t.v]:s===0||s=="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=W_(t.v):t.w=Zd(t.v):t.w=$s(s,t.v,{date1904:!!a,dateNF:n&&n.dateNF})}catch(f){if(n.WTF)throw f}if(n.cellDates&&s&&t.t=="n"&&cl(pn[s]||String(s))){var c=vh(t.v+(a?1462:0));c&&(t.t="d",t.v=new Date(Date.UTC(c.y,c.m-1,c.d,c.H,c.M,c.S,c.u)))}}}function hx(t,n,a){return{v:t,ixfe:n,t:a}}function zAe(t,n){var a={opts:{}},s={},c={};n.dense&&(c["!data"]=[]);var f={},d={},p=null,g=[],y="",b={},E,T="",S,I,A,M,F={},L=[],O,N,Q=[],ie=[],j={Sheets:[],WBProps:{date1904:!1},Views:[{}]},V={},D=!1,te=function(Lt){return Lt<8?Nd[Lt]:Lt<64&&ie[Lt-8]||Nd[Lt]},ue=function(Lt,Qt,Gt){var dr=Qt.XF.data;if(!(!dr||!dr.patternType||!Gt||!Gt.cellStyles)){Qt.s={},Qt.s.patternType=dr.patternType;var Br;(Br=J_(te(dr.icvFore)))&&(Qt.s.fgColor={rgb:Br}),(Br=J_(te(dr.icvBack)))&&(Qt.s.bgColor={rgb:Br})}},J=function(Lt,Qt,Gt){if(!(!D&&Pe>1)&&!(Gt.sheetRows&&Lt.r>=Gt.sheetRows)){if(Gt.cellStyles&&Qt.XF&&Qt.XF.data&&ue(Lt,Qt,Gt),delete Qt.ixfe,delete Qt.XF,E=Lt,T=ii(Lt),(!d||!d.s||!d.e)&&(d={s:{r:0,c:0},e:{r:0,c:0}}),Lt.r<d.s.r&&(d.s.r=Lt.r),Lt.c<d.s.c&&(d.s.c=Lt.c),Lt.r+1>d.e.r&&(d.e.r=Lt.r+1),Lt.c+1>d.e.c&&(d.e.c=Lt.c+1),Gt.cellFormula&&Qt.f){for(var dr=0;dr<L.length;++dr)if(!(L[dr][0].s.c>Lt.c||L[dr][0].s.r>Lt.r)&&!(L[dr][0].e.c<Lt.c||L[dr][0].e.r<Lt.r)){Qt.F=Xn(L[dr][0]),(L[dr][0].s.c!=Lt.c||L[dr][0].s.r!=Lt.r)&&delete Qt.f,Qt.f&&(Qt.f=""+zo(L[dr][1],d,Lt,He,le));break}}Gt.dense?(c["!data"][Lt.r]||(c["!data"][Lt.r]=[]),c["!data"][Lt.r][Lt.c]=Qt):c[T]=Qt}},le={enc:!1,sbcch:0,snames:[],sharedf:F,arrayf:L,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!n&&!!n.cellStyles,WTF:!!n&&!!n.wtf};n.password&&(le.password=n.password);var re,Fe=[],Ye=[],Ee=[],ut=[],Ne=!1,He=[];He.SheetNames=le.snames,He.sharedf=le.sharedf,He.arrayf=le.arrayf,He.names=[],He.XTI=[];var Oe=0,Pe=0,rt=0,et=[],Ge=[],ze;le.codepage=1200,Al(1200);for(var oe=!1;t.l<t.length-1;){var Me=t.l,fe=t.read_shift(2);if(fe===0&&Oe===10)break;var pe=t.l===t.length?0:t.read_shift(2),ot=$C[fe];if(Pe==0&&[9,521,1033,2057].indexOf(fe)==-1)break;if(ot&&ot.f){if(n.bookSheets&&Oe===133&&fe!==133)break;if(Oe=fe,ot.r===2||ot.r==12){var xe=t.read_shift(2);if(pe-=2,!le.enc&&xe!==fe&&((xe&255)<<8|xe>>8)!==fe)throw new Error("rt mismatch: "+xe+"!="+fe);ot.r==12&&(t.l+=10,pe-=10)}var ae={};if(fe===10?ae=ot.f(t,pe,le):ae=BAe(fe,ot,t,pe,le),Pe==0&&[9,521,1033,2057].indexOf(Oe)===-1)continue;switch(fe){case 34:a.opts.Date1904=j.WBProps.date1904=ae;break;case 134:a.opts.WriteProtect=!0;break;case 47:if(le.enc||(t.l=0),le.enc=ae,!n.password)throw new Error("File is password-protected");if(ae.valid==null)throw new Error("Encryption scheme unsupported");if(!ae.valid)throw new Error("Password is incorrect");break;case 92:le.lastuser=ae;break;case 66:var X=Number(ae);switch(X){case 21010:X=1200;break;case 32768:X=1e4;break;case 32769:X=1252;break}Al(le.codepage=X),oe=!0;break;case 317:le.rrtabid=ae;break;case 25:le.winlocked=ae;break;case 439:a.opts.RefreshAll=ae;break;case 12:a.opts.CalcCount=ae;break;case 16:a.opts.CalcDelta=ae;break;case 17:a.opts.CalcIter=ae;break;case 13:a.opts.CalcMode=ae;break;case 14:a.opts.CalcPrecision=ae;break;case 95:a.opts.CalcSaveRecalc=ae;break;case 15:le.CalcRefMode=ae;break;case 2211:a.opts.FullCalc=ae;break;case 129:ae.fDialog&&(c["!type"]="dialog"),ae.fBelow||((c["!outline"]||(c["!outline"]={})).above=!0),ae.fRight||((c["!outline"]||(c["!outline"]={})).left=!0);break;case 67:case 579:case 1091:case 224:Q.push(ae);break;case 430:He.push([ae]),He[He.length-1].XTI=[];break;case 35:case 547:He[He.length-1].push(ae);break;case 24:case 536:ze={Name:ae.Name,Ref:zo(ae.rgce,d,null,He,le)},ae.itab>0&&(ze.Sheet=ae.itab-1),He.names.push(ze),He[0]||(He[0]=[],He[0].XTI=[]),He[He.length-1].push(ae),ae.Name=="_xlnm._FilterDatabase"&&ae.itab>0&&ae.rgce&&ae.rgce[0]&&ae.rgce[0][0]&&ae.rgce[0][0][0]=="PtgArea3d"&&(Ge[ae.itab-1]={ref:Xn(ae.rgce[0][0][1][2])});break;case 22:le.ExternCount=ae;break;case 23:He.length==0&&(He[0]=[],He[0].XTI=[]),He[He.length-1].XTI=He[He.length-1].XTI.concat(ae),He.XTI=He.XTI.concat(ae);break;case 2196:if(le.biff<8)break;ze!=null&&(ze.Comment=ae[1]);break;case 18:c["!protect"]=ae;break;case 19:ae!==0&&le.WTF&&console.error("Password verifier: "+ae);break;case 133:f[le.biff==4?le.snames.length:ae.pos]=ae,le.snames.push(ae.name);break;case 10:{if(--Pe?!D:D)break;if(d.e){if(d.e.r>0&&d.e.c>0){if(d.e.r--,d.e.c--,c["!ref"]=Xn(d),n.sheetRows&&n.sheetRows<=d.e.r){var Ce=d.e.r;d.e.r=n.sheetRows-1,c["!fullref"]=c["!ref"],c["!ref"]=Xn(d),d.e.r=Ce}d.e.r++,d.e.c++}Fe.length>0&&(c["!merges"]=Fe),Ye.length>0&&(c["!objects"]=Ye),Ee.length>0&&(c["!cols"]=Ee),ut.length>0&&(c["!rows"]=ut),j.Sheets.push(V)}y===""?b=c:s[y]=c,c={},n.dense&&(c["!data"]=[])}break;case 9:case 521:case 1033:case 2057:{if(le.biff===8&&(le.biff={9:2,521:3,1033:4}[fe]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[ae.BIFFVer]||8),le.biffguess=ae.BIFFVer==0,ae.BIFFVer==0&&ae.dt==4096&&(le.biff=5,oe=!0,Al(le.codepage=28591)),le.biff==4&&ae.dt&256&&(D=!0),le.biff==8&&ae.BIFFVer==0&&ae.dt==16&&(le.biff=2),Pe++&&!D)break;if(c={},n.dense&&(c["!data"]=[]),le.biff<8&&!oe&&(oe=!0,Al(le.codepage=n.codepage||1252)),le.biff==4&&D)y=(f[le.snames.indexOf(y)+1]||{name:""}).name;else if(le.biff<5||ae.BIFFVer==0&&ae.dt==4096){y===""&&(y="Sheet1"),d={s:{r:0,c:0},e:{r:0,c:0}};var he={pos:t.l-pe,name:y};f[he.pos]=he,le.snames.push(y)}else y=(f[Me]||{name:""}).name;ae.dt==32&&(c["!type"]="chart"),ae.dt==64&&(c["!type"]="macro"),Fe=[],Ye=[],le.arrayf=L=[],Ee=[],ut=[],Ne=!1,V={Hidden:(f[Me]||{hs:0}).hs,name:y}}break;case 515:case 3:case 2:c["!type"]=="chart"&&(n.dense?(c["!data"][ae.r]||[])[ae.c]:c[Qn(ae.c)+vi(ae.r)])&&++ae.c,O={ixfe:ae.ixfe,XF:Q[ae.ixfe]||{},v:ae.val,t:"n"},rt>0&&(O.z=O.XF&&O.XF.numFmtId&&et[O.XF.numFmtId]||et[O.ixfe>>8&63]),Xc(O,n,a.opts.Date1904),J({c:ae.c,r:ae.r},O,n);break;case 5:case 517:O={ixfe:ae.ixfe,XF:Q[ae.ixfe],v:ae.val,t:ae.t},rt>0&&(O.z=O.XF&&O.XF.numFmtId&&et[O.XF.numFmtId]||et[O.ixfe>>8&63]),Xc(O,n,a.opts.Date1904),J({c:ae.c,r:ae.r},O,n);break;case 638:O={ixfe:ae.ixfe,XF:Q[ae.ixfe],v:ae.rknum,t:"n"},rt>0&&(O.z=O.XF&&O.XF.numFmtId&&et[O.XF.numFmtId]||et[O.ixfe>>8&63]),Xc(O,n,a.opts.Date1904),J({c:ae.c,r:ae.r},O,n);break;case 189:for(var G=ae.c;G<=ae.C;++G){var K=ae.rkrec[G-ae.c][0];O={ixfe:K,XF:Q[K],v:ae.rkrec[G-ae.c][1],t:"n"},rt>0&&(O.z=O.XF&&O.XF.numFmtId&&et[O.XF.numFmtId]||et[O.ixfe>>8&63]),Xc(O,n,a.opts.Date1904),J({c:G,r:ae.r},O,n)}break;case 6:case 518:case 1030:{if(ae.val=="String"){p=ae;break}if(O=hx(ae.val,ae.cell.ixfe,ae.tt),O.XF=Q[O.ixfe],n.cellFormula){var se=ae.formula;if(se&&se[0]&&se[0][0]&&se[0][0][0]=="PtgExp"){var Ae=se[0][0][1][0],Se=se[0][0][1][1],ye=ii({r:Ae,c:Se});F[ye]?O.f=""+zo(ae.formula,d,ae.cell,He,le):O.F=((n.dense?(c["!data"][Ae]||[])[Se]:c[ye])||{}).F}else O.f=""+zo(ae.formula,d,ae.cell,He,le)}rt>0&&(O.z=O.XF&&O.XF.numFmtId&&et[O.XF.numFmtId]||et[O.ixfe>>8&63]),Xc(O,n,a.opts.Date1904),J(ae.cell,O,n),p=ae}break;case 7:case 519:if(p)p.val=ae,O=hx(ae,p.cell.ixfe,"s"),O.XF=Q[O.ixfe],n.cellFormula&&(O.f=""+zo(p.formula,d,p.cell,He,le)),rt>0&&(O.z=O.XF&&O.XF.numFmtId&&et[O.XF.numFmtId]||et[O.ixfe>>8&63]),Xc(O,n,a.opts.Date1904),J(p.cell,O,n),p=null;else throw new Error("String record expects Formula");break;case 33:case 545:{L.push(ae);var Xe=ii(ae[0].s);if(S=n.dense?(c["!data"][ae[0].s.r]||[])[ae[0].s.c]:c[Xe],n.cellFormula&&S){if(!p||!Xe||!S)break;S.f=""+zo(ae[1],d,ae[0],He,le),S.F=Xn(ae[0])}}break;case 1212:{if(!n.cellFormula)break;if(T){if(!p)break;F[ii(p.cell)]=ae[0],S=n.dense?(c["!data"][p.cell.r]||[])[p.cell.c]:c[ii(p.cell)],(S||{}).f=""+zo(ae[0],d,E,He,le)}}break;case 253:O=hx(g[ae.isst].t,ae.ixfe,"s"),g[ae.isst].h&&(O.h=g[ae.isst].h),O.XF=Q[O.ixfe],rt>0&&(O.z=O.XF&&O.XF.numFmtId&&et[O.XF.numFmtId]||et[O.ixfe>>8&63]),Xc(O,n,a.opts.Date1904),J({c:ae.c,r:ae.r},O,n);break;case 513:n.sheetStubs&&(O={ixfe:ae.ixfe,XF:Q[ae.ixfe],t:"z"},rt>0&&(O.z=O.XF&&O.XF.numFmtId&&et[O.XF.numFmtId]||et[O.ixfe>>8&63]),Xc(O,n,a.opts.Date1904),J({c:ae.c,r:ae.r},O,n));break;case 190:if(n.sheetStubs)for(var be=ae.c;be<=ae.C;++be){var Be=ae.ixfe[be-ae.c];O={ixfe:Be,XF:Q[Be],t:"z"},rt>0&&(O.z=O.XF&&O.XF.numFmtId&&et[O.XF.numFmtId]||et[O.ixfe>>8&63]),Xc(O,n,a.opts.Date1904),J({c:be,r:ae.r},O,n)}break;case 214:case 516:case 4:O=hx(ae.val,ae.ixfe,"s"),O.XF=Q[O.ixfe],rt>0&&(O.z=O.XF&&O.XF.numFmtId&&et[O.XF.numFmtId]||et[O.ixfe>>8&63]),Xc(O,n,a.opts.Date1904),J({c:ae.c,r:ae.r},O,n);break;case 0:case 512:Pe===1&&(d=ae);break;case 252:g=ae;break;case 1054:if(le.biff>=3&&le.biff<=4){et[rt++]=ae[1];for(var ct=0;ct<rt+163&&pn[ct]!=ae[1];++ct);ct>=163&&Eh(ae[1],rt+163)}else Eh(ae[1],ae[0]);break;case 30:{et[rt++]=ae;for(var At=0;At<rt+163&&pn[At]!=ae;++At);At>=163&&Eh(ae,rt+163)}break;case 229:Fe=Fe.concat(ae);break;case 93:Ye[ae.cmo[0]]=le.lastobj=ae;break;case 438:le.lastobj.TxO=ae;break;case 127:le.lastobj.ImData=ae;break;case 440:for(M=ae[0].s.r;M<=ae[0].e.r;++M)for(A=ae[0].s.c;A<=ae[0].e.c;++A)S=n.dense?(c["!data"][M]||[])[A]:c[ii({c:A,r:M})],S&&(S.l=ae[1]);break;case 2048:for(M=ae[0].s.r;M<=ae[0].e.r;++M)for(A=ae[0].s.c;A<=ae[0].e.c;++A)S=n.dense?(c["!data"][M]||[])[A]:c[ii({c:A,r:M})],S&&S.l&&(S.l.Tooltip=ae[1]);break;case 28:{if(S=n.dense?(c["!data"][ae[0].r]||[])[ae[0].c]:c[ii(ae[0])],S||(n.dense?(c["!data"][ae[0].r]||(c["!data"][ae[0].r]=[]),S=c["!data"][ae[0].r][ae[0].c]={t:"z"}):S=c[ii(ae[0])]={t:"z"},d.e.r=Math.max(d.e.r,ae[0].r),d.s.r=Math.min(d.s.r,ae[0].r),d.e.c=Math.max(d.e.c,ae[0].c),d.s.c=Math.min(d.s.c,ae[0].c)),S.c||(S.c=[]),le.biff<=5&&le.biff>=2)I={a:"SheetJ5",t:ae[1]};else{var $t=Ye[ae[2]];I={a:ae[1],t:$t.TxO.t},ae[3]!=null&&!(ae[3]&2)&&(S.c.hidden=!0)}S.c.push(I)}break;case 2173:g2e(Q[ae.ixfe],ae.ext);break;case 125:{if(!le.cellStyles)break;for(;ae.e>=ae.s;)Ee[ae.e--]={width:ae.w/256,level:ae.level||0,hidden:!!(ae.flags&1)},Ne||(Ne=!0,jk(ae.w/256)),kh(Ee[ae.e+1])}break;case 520:{var mr={};ae.level!=null&&(ut[ae.r]=mr,mr.level=ae.level),ae.hidden&&(ut[ae.r]=mr,mr.hidden=!0),ae.hpt&&(ut[ae.r]=mr,mr.hpt=ae.hpt,mr.hpx=sm(ae.hpt))}break;case 38:case 39:case 40:case 41:c["!margins"]||jd(c["!margins"]={}),c["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[fe]]=ae;break;case 161:c["!margins"]||jd(c["!margins"]={}),c["!margins"].header=ae.header,c["!margins"].footer=ae.footer;break;case 574:ae.RTL&&(j.Views[0].RTL=!0);break;case 146:ie=ae;break;case 2198:re=ae;break;case 140:N=ae;break;case 442:y?V.CodeName=ae||V.name:j.WBProps.CodeName=ae||"ThisWorkbook";break}}else ot||console.error("Missing Info for XLS Record 0x"+fe.toString(16)),t.l+=pe}return a.SheetNames=Ma(f).sort(function(Nt,Lt){return Number(Nt)-Number(Lt)}).map(function(Nt){return f[Nt].name}),n.bookSheets||(a.Sheets=s),!a.SheetNames.length&&b["!ref"]?(a.SheetNames.push("Sheet1"),a.Sheets&&(a.Sheets.Sheet1=b)):a.Preamble=b,a.Sheets&&Ge.forEach(function(Nt,Lt){a.Sheets[a.SheetNames[Lt]]["!autofilter"]=Nt}),a.Strings=g,a.SSF=Qi(pn),le.enc&&(a.Encryption=le.enc),re&&(a.Themes=re),a.Metadata={},N!==void 0&&(a.Metadata.Country=N),He.names.length>0&&(j.Names=He.names),a.Workbook=j,a}var __={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function NAe(t,n,a){var s=_n.find(t,"/!DocumentSummaryInformation");if(s&&s.size>0)try{var c=u6(s,RC,__.DSI);for(var f in c)n[f]=c[f]}catch(y){if(a.WTF)throw y}var d=_n.find(t,"/!SummaryInformation");if(d&&d.size>0)try{var p=u6(d,LC,__.SI);for(var g in p)n[g]==null&&(n[g]=p[g])}catch(y){if(a.WTF)throw y}n.HeadingPairs&&n.TitlesOfParts&&(p9(n.HeadingPairs,n.TitlesOfParts,n,a),delete n.HeadingPairs,delete n.TitlesOfParts)}function UAe(t,n){var a=[],s=[],c=[],f=0,d,p=V5(RC,"n"),g=V5(LC,"n");if(t.Props)for(d=Ma(t.Props),f=0;f<d.length;++f)(Object.prototype.hasOwnProperty.call(p,d[f])?a:Object.prototype.hasOwnProperty.call(g,d[f])?s:c).push([d[f],t.Props[d[f]]]);if(t.Custprops)for(d=Ma(t.Custprops),f=0;f<d.length;++f)Object.prototype.hasOwnProperty.call(t.Props||{},d[f])||(Object.prototype.hasOwnProperty.call(p,d[f])?a:Object.prototype.hasOwnProperty.call(g,d[f])?s:c).push([d[f],t.Custprops[d[f]]]);var y=[];for(f=0;f<c.length;++f)b9.indexOf(c[f][0])>-1||d9.indexOf(c[f][0])>-1||c[f][1]!=null&&y.push(c[f]);s.length&&_n.utils.cfb_add(n,"/SummaryInformation",f6(s,__.SI,g,LC)),(a.length||y.length)&&_n.utils.cfb_add(n,"/DocumentSummaryInformation",f6(a,__.DSI,p,RC,y.length?y:null,__.UDI))}function Kk(t,n){n||(n={}),Yk(n),nw(),n.codepage&&rw(n.codepage);var a,s;if(t.FullPaths){if(_n.find(t,"/encryption"))throw new Error("File is password-protected");a=_n.find(t,"!CompObj"),s=_n.find(t,"/Workbook")||_n.find(t,"/Book")}else{switch(n.type){case"base64":t=us(ll(t));break;case"binary":t=us(t);break;case"buffer":break;case"array":Array.isArray(t)||(t=Array.prototype.slice.call(t));break}so(t,0),s={content:t}}var c,f;if(a&&LAe(a),n.bookProps&&!n.bookSheets)c={};else{var d=oi?"buffer":"array";if(s&&s.content)c=zAe(s.content,n);else if((f=_n.find(t,"PerfectOffice_MAIN"))&&f.content)c=$d.to_workbook(f.content,(n.type=d,n));else if((f=_n.find(t,"NativeContent_MAIN"))&&f.content)c=$d.to_workbook(f.content,(n.type=d,n));else throw(f=_n.find(t,"MN0"))&&f.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");n.bookVBA&&t.FullPaths&&_n.find(t,"/_VBA_PROJECT_CUR/VBA/dir")&&(c.vbaraw=G2e(t))}var p={};return t.FullPaths&&NAe(t,p,n),c.Props=c.Custprops=p,n.bookFiles&&(c.cfb=t),c}function $Ae(t,n){var a=n||{},s=_n.utils.cfb_new({root:"R"}),c="/Workbook";switch(a.bookType||"xls"){case"xls":a.bookType="biff8";case"xla":a.bookType||(a.bookType="xla");case"biff8":c="/Workbook",a.biff=8;break;case"biff5":c="/Book",a.biff=5;break;default:throw new Error("invalid type "+a.bookType+" for XLS CFB")}return _n.utils.cfb_add(s,c,m7(t,a)),a.biff==8&&(t.Props||t.Custprops)&&UAe(t,s),a.biff==8&&t.vbaraw&&q2e(s,_n.read(t.vbaraw,{type:typeof t.vbaraw=="string"?"binary":"buffer"})),s}var rv={0:{f:mSe},1:{f:ESe},2:{f:USe},3:{f:FSe},4:{f:ASe},5:{f:BSe},6:{f:HSe},7:{f:OSe},8:{f:JSe},9:{f:YSe},10:{f:ZSe},11:{f:KSe},12:{f:SSe},13:{f:VSe},14:{f:PSe},15:{f:ISe},16:{f:o7},17:{f:qSe},18:{f:LSe},19:{f:Ok},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:qCe},40:{},42:{},43:{f:Rwe},44:{f:Pwe},45:{f:Bwe},46:{f:Nwe},47:{f:zwe},48:{},49:{f:X1e},50:{},51:{f:y2e},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:R9},62:{f:WSe},63:{f:I2e},64:{f:pCe},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Zo,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:uCe},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:bSe},148:{f:vSe,p:16},151:{f:iCe},152:{},153:{f:WCe},154:{},155:{},156:{f:VCe},157:{},158:{},159:{T:1,f:Hbe},160:{T:-1},161:{T:1,f:hp},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:QSe},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:_2e},336:{T:-1},337:{f:w2e,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:OC},357:{},358:{},359:{},360:{T:1},361:{},362:{f:O9},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:aCe},427:{f:oCe},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:lCe},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:xSe},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:rCe},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:OC},551:{f:cw},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:V2e},633:{T:1},634:{T:-1},635:{T:1,f:U2e},636:{T:-1},637:{f:J1e},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:FCe},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:mCe},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},$C={6:{f:vS},10:{f:ih},12:{f:Ba},13:{f:Ba},14:{f:$a},15:{f:$a},16:{f:Vo},17:{f:$a},18:{f:$a},19:{f:Ba},20:{f:g6},21:{f:g6},23:{f:O9},24:{f:v6},25:{f:$a},26:{},27:{},28:{f:Yxe},29:{},34:{f:$a},35:{f:_6},38:{f:Vo},39:{f:Vo},40:{f:Vo},41:{f:Vo},42:{f:$a},43:{f:$a},47:{f:hwe},49:{f:yxe},51:{f:Ba},60:{},61:{f:pxe},64:{f:$a},65:{f:vxe},66:{f:Ba},77:{},80:{},81:{},82:{},85:{f:Ba},89:{},90:{},91:{},92:{f:nxe},93:{f:ebe},94:{},95:{f:$a},96:{},97:{},99:{f:$a},125:{f:R9},128:{f:$xe},129:{f:axe},130:{f:Ba},131:{f:$a},132:{f:$a},133:{f:oxe},134:{},140:{f:lbe},141:{f:Ba},144:{},146:{f:fbe},151:{},152:{},153:{},154:{},155:{},156:{f:Ba},157:{},158:{},160:{f:vbe},161:{f:pbe},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:Pxe},190:{f:Oxe},193:{f:ih},197:{},198:{},199:{},200:{},201:{},202:{f:$a},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Ba},220:{},221:{f:$a},222:{},224:{f:Lxe},225:{f:rxe},226:{f:ih},227:{},229:{f:Jxe},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:lxe},253:{f:bxe},255:{f:uxe},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:w9},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:$a},353:{f:ih},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:Gxe},431:{f:$a},432:{},433:{},434:{},437:{},438:{f:nbe},439:{f:$a},440:{f:ibe},441:{},442:{f:Tv},443:{},444:{f:Ba},445:{},446:{},448:{f:ih},449:{f:dxe,r:2},450:{f:ih},512:{f:p6},513:{f:_be},515:{f:Wxe},516:{f:Exe},517:{f:jxe},519:{f:ybe},520:{f:fxe},523:{},545:{f:x6},549:{f:d6},566:{},574:{f:gxe},638:{f:Fxe},659:{},1048:{},1054:{f:Sxe},1084:{},1212:{f:Xxe},2048:{f:obe},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:lx},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:ih},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:hbe,r:12},2173:{f:m2e,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:$a,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:qxe,r:12},2197:{},2198:{f:c2e,r:12},2199:{},2200:{},2201:{},2202:{f:Zxe,r:12},2203:{f:ih},2204:{},2205:{},2206:{},2207:{},2211:{f:hxe},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Ba},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:mbe},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:ube},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:p6},1:{},2:{f:Tbe},3:{f:wbe},4:{f:bbe},5:{f:Abe},7:{f:Cbe},8:{},9:{f:lx},11:{},22:{f:Ba},30:{f:Axe},31:{},32:{},33:{f:x6},36:{},37:{f:d6},50:{f:kbe},62:{},52:{},67:{f:Dxe},68:{f:Ba},69:{},86:{},126:{},127:{f:xbe},135:{},136:{},137:{},143:{f:Mbe},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:Ibe},223:{},234:{},354:{},421:{},518:{f:vS},521:{f:lx},536:{f:v6},547:{f:_6},561:{},579:{f:Nxe},1030:{f:vS},1033:{f:lx},1091:{f:Uxe},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},101:{},102:{},105:{},106:{},107:{},109:{},112:{},114:{},29282:{}};function lr(t,n,a,s){var c=n;if(!isNaN(c)){var f=s||(a||[]).length||0,d=t.next(4);d.write_shift(2,c),d.write_shift(2,f),f>0&&Mk(a)&&t.push(a)}}function VAe(t,n,a,s){var c=s||(a||[]).length||0;if(c<=8224)return lr(t,n,a,c);var f=n;if(!isNaN(f)){for(var d=a.parts||[],p=0,g=0,y=0;y+(d[p]||8224)<=8224;)y+=d[p]||8224,p++;var b=t.next(4);for(b.write_shift(2,f),b.write_shift(2,y),t.push(a.slice(g,g+y)),g+=y;g<c;){for(b=t.next(4),b.write_shift(2,60),y=0;y+(d[p]||8224)<=8224;)y+=d[p]||8224,p++;b.write_shift(2,y),t.push(a.slice(g,g+y)),g+=y}}}function ES(t,n,a,s){var c=zt(9);return Sv(c,t,n),T9(a,s||"b",c),c}function jAe(t,n,a){var s=zt(8+2*a.length);return Sv(s,t,n),s.write_shift(1,a.length),s.write_shift(a.length,a,"sbcs"),s.l<s.length?s.slice(0,s.l):s}function p7(t,n){n.forEach(function(a){var s=a[0].map(function(f){return f.t}).join("");if(s.length<=2048)return lr(t,28,mS(s,a[1],a[2]));lr(t,28,mS(s.slice(0,2048),a[1],a[2],s.length));for(var c=2048;c<s.length;c+=2048)lr(t,28,mS(s.slice(c,Math.min(c+2048,s.length)),-1,-1,Math.min(2048,s.length-c)))})}function WAe(t,n,a,s,c,f){var d=0;n.z!=null&&(d=c._BIFF2FmtTable.indexOf(n.z),d==-1&&(c._BIFF2FmtTable.push(n.z),d=c._BIFF2FmtTable.length-1));var p=0;if(n.z!=null){for(;p<c.cellXfs.length&&c.cellXfs[p].numFmtId!=d;++p);p==c.cellXfs.length&&c.cellXfs.push({numFmtId:d})}if(n.v!=null)switch(n.t){case"d":case"n":var g=n.t=="d"?La(Fa(n.v,f),f):n.v;c.biff==2&&g==(g|0)&&g>=0&&g<65536?lr(t,2,Sbe(a,s,g,p,d)):isNaN(g)?lr(t,5,ES(a,s,36,"e")):isFinite(g)?lr(t,3,Ebe(a,s,g,p,d)):lr(t,5,ES(a,s,7,"e"));return;case"b":case"e":lr(t,5,ES(a,s,n.v,n.t));return;case"s":case"str":lr(t,4,jAe(a,s,n.v==null?"":String(n.v).slice(0,255)));return}lr(t,1,Sv(null,a,s))}function HAe(t,n,a,s,c){var f=n["!data"]!=null,d=Ei(n["!ref"]||"A1"),p="",g=[];if(d.e.c>255||d.e.r>16383){if(s.WTF)throw new Error("Range "+(n["!ref"]||"A1")+" exceeds format limit A1:IV16384");d.e.c=Math.min(d.e.c,255),d.e.r=Math.min(d.e.c,16383)}for(var y=(((c||{}).Workbook||{}).WBProps||{}).date1904,b=[],E=[],T=d.s.c;T<=d.e.c;++T)g[T]=Qn(T);for(var S=d.s.r;S<=d.e.r;++S)for(f&&(b=n["!data"][S]||[]),p=vi(S),T=d.s.c;T<=d.e.c;++T){var I=f?b[T]:n[g[T]+p];I&&(WAe(t,I,S,T,s,y),I.c&&E.push([I.c,S,T]))}p7(t,E)}function GAe(t,n){for(var a=n||{},s=Go(),c=0,f=0;f<t.SheetNames.length;++f)t.SheetNames[f]==a.sheet&&(c=f);if(c==0&&a.sheet&&t.SheetNames[0]!=a.sheet)throw new Error("Sheet not found: "+a.sheet);lr(s,a.biff==4?1033:a.biff==3?521:9,Uk(t,16,a)),((t.Workbook||{}).WBProps||{}).date1904&&lr(s,34,Do(!0)),a.cellXfs=[{numFmtId:0}],a._BIFF2FmtTable=["General"],a._Fonts=[];var d=Go();return HAe(d,t.Sheets[t.SheetNames[c]],c,a,t),a._BIFF2FmtTable.forEach(function(p){a.biff<=3?lr(s,30,kxe(p)):lr(s,1054,Ixe(p))}),a.cellXfs.forEach(function(p){switch(a.biff){case 2:lr(s,67,Bxe(p));break;case 3:lr(s,579,P9(p));break;case 4:lr(s,1091,zxe(p));break}}),delete a._BIFF2FmtTable,delete a.cellXfs,delete a._Fonts,s.push(d.end()),lr(s,10),s.end()}var nc=1,Tl=[];function qAe(){var t=zt(82+8*Tl.length);t.write_shift(2,15),t.write_shift(2,61440),t.write_shift(4,74+8*Tl.length);{t.write_shift(2,0),t.write_shift(2,61446),t.write_shift(4,16+8*Tl.length);{t.write_shift(4,nc),t.write_shift(4,Tl.length+1);for(var n=0,a=0;a<Tl.length;++a)n+=Tl[a]&&Tl[a][1]||0;t.write_shift(4,n),t.write_shift(4,Tl.length)}Tl.forEach(function(s){t.write_shift(4,s[0]),t.write_shift(4,s[2])})}return t.write_shift(2,51),t.write_shift(2,61451),t.write_shift(4,18),t.write_shift(2,191),t.write_shift(4,524296),t.write_shift(2,385),t.write_shift(4,134217793),t.write_shift(2,448),t.write_shift(4,134217792),t.write_shift(2,64),t.write_shift(2,61726),t.write_shift(4,16),t.write_shift(4,134217741),t.write_shift(4,134217740),t.write_shift(4,134217751),t.write_shift(4,268435703),t}function XAe(t,n){var a=[],s=0,c=Go(),f=nc,d;n.forEach(function(g,y){var b="",E=g[0].map(function(O){return O.a&&!b&&(b=O.a),O.t}).join("");++nc;{var T=zt(150);T.write_shift(2,15),T.write_shift(2,61444),T.write_shift(4,150),T.write_shift(2,3234),T.write_shift(2,61450),T.write_shift(4,8),T.write_shift(4,nc),T.write_shift(4,2560),T.write_shift(2,227),T.write_shift(2,61451),T.write_shift(4,84),T.write_shift(2,128),T.write_shift(4,0),T.write_shift(2,139),T.write_shift(4,2),T.write_shift(2,191),T.write_shift(4,524296),T.write_shift(2,344),T.l+=4,T.write_shift(2,385),T.write_shift(4,134217808),T.write_shift(2,387),T.write_shift(4,134217808),T.write_shift(2,389),T.write_shift(4,268435700),T.write_shift(2,447),T.write_shift(4,1048592),T.write_shift(2,448),T.write_shift(4,134217809),T.write_shift(2,451),T.write_shift(4,268435700),T.write_shift(2,513),T.write_shift(4,134217809),T.write_shift(2,515),T.write_shift(4,268435700),T.write_shift(2,575),T.write_shift(4,196609),T.write_shift(2,959),T.write_shift(4,131072|(g[0].hidden?2:0)),T.l+=2,T.write_shift(2,61456),T.write_shift(4,18),T.write_shift(2,3),T.write_shift(2,g[2]+2),T.l+=2,T.write_shift(2,g[1]+1),T.l+=2,T.write_shift(2,g[2]+4),T.l+=2,T.write_shift(2,g[1]+5),T.l+=2,T.l+=2,T.write_shift(2,61457),T.l+=4,T.l=150,y==0?d=T:lr(c,236,T)}s+=150;{var S=zt(52);S.write_shift(2,21),S.write_shift(2,18),S.write_shift(2,25),S.write_shift(2,nc),S.write_shift(2,0),S.l=22,S.write_shift(2,13),S.write_shift(2,22),S.write_shift(4,1651663474),S.write_shift(4,2503426821),S.write_shift(4,2150634280),S.write_shift(4,1768515844+nc*256),S.write_shift(2,0),S.write_shift(4,0),S.l+=4,lr(c,93,S)}{var I=zt(8);I.l+=2,I.write_shift(2,61453),I.l+=4,lr(c,236,I)}s+=8;{var A=zt(18);A.write_shift(2,18),A.l+=8,A.write_shift(2,E.length),A.write_shift(2,16),A.l+=4,lr(c,438,A);{var M=zt(1+E.length);M.write_shift(1,0),M.write_shift(E.length,E,"sbcs"),lr(c,60,M)}{var F=zt(16);F.l+=8,F.write_shift(2,E.length),F.l+=6,lr(c,60,F)}}{var L=zt(12+b.length);L.write_shift(2,g[1]),L.write_shift(2,g[2]),L.write_shift(2,0|(g[0].hidden?0:2)),L.write_shift(2,nc),L.write_shift(2,b.length),L.write_shift(1,0),L.write_shift(b.length,b,"sbcs"),L.l++,a.push(L)}});{var p=zt(80);p.write_shift(2,15),p.write_shift(2,61442),p.write_shift(4,s+p.length-8),p.write_shift(2,16),p.write_shift(2,61448),p.write_shift(4,8),p.write_shift(4,n.length+1),p.write_shift(4,nc),p.write_shift(2,15),p.write_shift(2,61443),p.write_shift(4,s+48),p.write_shift(2,15),p.write_shift(2,61444),p.write_shift(4,40),p.write_shift(2,1),p.write_shift(2,61449),p.write_shift(4,16),p.l+=16,p.write_shift(2,2),p.write_shift(2,61450),p.write_shift(4,8),p.write_shift(4,f),p.write_shift(4,5),lr(t,236,d?Va([p,d]):p)}t.push(c.end()),a.forEach(function(g){lr(t,28,g)}),Tl.push([f,n.length+1,nc]),++nc}function ZAe(t,n,a){lr(t,49,xxe({sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"},a))}function KAe(t,n,a){n&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(s){for(var c=s[0];c<=s[1];++c)n[c]!=null&&lr(t,1054,Cxe(c,n[c],a))})}function YAe(t,n){var a=zt(19);a.write_shift(4,2151),a.write_shift(4,0),a.write_shift(4,0),a.write_shift(2,3),a.write_shift(1,1),a.write_shift(4,0),lr(t,2151,a),a=zt(39),a.write_shift(4,2152),a.write_shift(4,0),a.write_shift(4,0),a.write_shift(2,3),a.write_shift(1,0),a.write_shift(4,0),a.write_shift(2,1),a.write_shift(4,4),a.write_shift(2,0),I9(Ei(n["!ref"]||"A1"),a),a.write_shift(4,4),lr(t,2152,a)}function JAe(t,n){for(var a=0;a<16;++a)lr(t,224,m6({numFmtId:0,style:!0},0,n));n.cellXfs.forEach(function(s){lr(t,224,m6(s,0,n))})}function QAe(t,n){for(var a=0;a<n["!links"].length;++a){var s=n["!links"][a];lr(t,440,abe(s)),s[1].Tooltip&&lr(t,2048,sbe(s))}delete n["!links"]}function eke(t,n){if(n){var a=0;n.forEach(function(s,c){++a<=256&&s&&lr(t,125,dbe(mw(c,s),c))})}}function tke(t,n,a,s,c,f){var d=16+zh(c.cellXfs,n,c);if(n.v==null&&!n.bf){lr(t,513,ep(a,s,d));return}if(n.bf)lr(t,6,yTe(n,a,s,c,d));else switch(n.t){case"d":case"n":var p=n.t=="d"?La(Fa(n.v,f),f):n.v;isNaN(p)?lr(t,517,pS(a,s,36,d,c,"e")):isFinite(p)?lr(t,515,Hxe(a,s,p,d)):lr(t,517,pS(a,s,7,d,c,"e"));break;case"b":case"e":lr(t,517,pS(a,s,n.v,d,c,n.t));break;case"s":case"str":if(c.bookSST){var g=qk(c.Strings,n.v==null?"":String(n.v),c.revStrings);lr(t,253,wxe(a,s,g,d))}else lr(t,516,Txe(a,s,(n.v==null?"":String(n.v)).slice(0,255),d,c));break;default:lr(t,513,ep(a,s,d))}}function rke(t,n,a){var s=Go(),c=a.SheetNames[t],f=a.Sheets[c]||{},d=(a||{}).Workbook||{},p=(d.Sheets||[])[t]||{},g=f["!data"]!=null,y=n.biff==8,b,E="",T=[],S=Ei(f["!ref"]||"A1"),I=y?65536:16384;if(S.e.c>255||S.e.r>=I){if(n.WTF)throw new Error("Range "+(f["!ref"]||"A1")+" exceeds format limit A1:IV16384");S.e.c=Math.min(S.e.c,255),S.e.r=Math.min(S.e.c,I-1)}lr(s,2057,Uk(a,16,n)),lr(s,13,Sl(1)),lr(s,12,Sl(100)),lr(s,15,Do(!0)),lr(s,17,Do(!1)),lr(s,16,Jd(.001)),lr(s,95,Do(!0)),lr(s,42,Do(!1)),lr(s,43,Do(!1)),lr(s,130,Sl(1)),lr(s,128,Vxe([0,0])),lr(s,131,Do(!1)),lr(s,132,Do(!1)),y&&eke(s,f["!cols"]),lr(s,512,Mxe(S,n));var A=(((a||{}).Workbook||{}).WBProps||{}).date1904;y&&(f["!links"]=[]);for(var M=[],F=[],L=S.s.c;L<=S.e.c;++L)T[L]=Qn(L);for(var O=S.s.r;O<=S.e.r;++O)for(g&&(F=f["!data"][O]||[]),E=vi(O),L=S.s.c;L<=S.e.c;++L){b=T[L]+E;var N=g?F[L]:f[b];N&&(tke(s,N,O,L,n,A),y&&N.l&&f["!links"].push([b,N.l]),N.c&&M.push([N.c,O,L]))}var Q=p.CodeName||p.name||c;return y?XAe(s,M):p7(s,M),y&&lr(s,574,_xe((d.Views||[])[0])),y&&(f["!merges"]||[]).length&&lr(s,229,Qxe(f["!merges"])),y&&QAe(s,f),lr(s,442,S9(Q)),y&&YAe(s,f),lr(s,10),s.end()}function nke(t,n,a){var s=Go(),c=(t||{}).Workbook||{},f=c.Sheets||[],d=c.WBProps||{},p=a.biff==8,g=a.biff==5;if(lr(s,2057,Uk(t,5,a)),a.bookType=="xla"&&lr(s,135),lr(s,225,p?Sl(1200):null),lr(s,193,Bye(2)),g&&lr(s,191),g&&lr(s,192),lr(s,226),lr(s,92,ixe("SheetJS",a)),lr(s,66,Sl(p?1200:1252)),p&&lr(s,353,Sl(0)),p&&lr(s,448),lr(s,317,gbe(t.SheetNames.length)),p&&t.vbaraw&&lr(s,211),p&&t.vbaraw){var y=d.CodeName||"ThisWorkbook";lr(s,442,S9(y))}lr(s,156,Sl(17)),lr(s,25,Do(!1)),lr(s,18,Do(!1)),lr(s,19,Sl(0)),p&&lr(s,431,Do(!1)),p&&lr(s,444,Sl(0)),lr(s,61,mxe()),lr(s,64,Do(!1)),lr(s,141,Sl(0)),lr(s,34,Do(DCe(t)=="true")),lr(s,14,Do(!0)),p&&lr(s,439,Do(!1)),lr(s,218,Sl(0)),ZAe(s,t,a),KAe(s,t.SSF,a),JAe(s,a),p&&lr(s,352,Do(!1));var b=s.end(),E=Go();p&&lr(E,140,cbe()),p&&Tl.length&&lr(E,235,qAe()),p&&a.Strings&&VAe(E,252,cxe(a.Strings)),lr(E,10);var T=E.end(),S=Go(),I=0,A=0;for(A=0;A<t.SheetNames.length;++A)I+=(p?12:11)+(p?2:1)*t.SheetNames[A].length;var M=b.length+I+T.length;for(A=0;A<t.SheetNames.length;++A){var F=f[A]||{};lr(S,133,sxe({pos:M,hs:F.Hidden||0,dt:0,name:t.SheetNames[A]},a)),M+=n[A].length}var L=S.end();if(I!=L.length)throw new Error("BS8 "+I+" != "+L.length);var O=[];return b.length&&O.push(b),L.length&&O.push(L),T.length&&O.push(T),Va(O)}function ike(t,n){var a=n||{},s=[];t&&!t.SSF&&(t.SSF=Qi(pn)),t&&t.SSF&&(ym(),wv(t.SSF),a.revssf=aw(t.SSF),a.revssf[t.SSF[65535]]=0,a.ssf=t.SSF),nc=1,Tl=[],a.Strings=[],a.Strings.Count=0,a.Strings.Unique=0,Jk(a),a.cellXfs=[],zh(a.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={});for(var c=0;c<t.SheetNames.length;++c)s[s.length]=rke(c,a,t);return s.unshift(nke(t,s,a)),Va(s)}function m7(t,n){for(var a=0;a<=t.SheetNames.length;++a){var s=t.Sheets[t.SheetNames[a]];if(!(!s||!s["!ref"])){var c=ho(s["!ref"]);c.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+t.SheetNames[a]+"' extends beyond column IV (255).  Data may be lost.")}}var f=n||{};switch(f.biff||2){case 8:case 5:return ike(t,n);case 4:case 3:case 2:return GAe(t,n)}throw new Error("invalid type "+f.bookType+" for BIFF")}function O6(t,n){var a=n||{},s=a.dense!=null?a.dense:Pve,c={};s&&(c["!data"]=[]),t=t.replace(/<!--.*?-->/g,"");var f=t.match(/<table/i);if(!f)throw new Error("Invalid HTML: could not find <table>");var d=t.match(/<\/table/i),p=f.index,g=d&&d.index||t.length,y=w1e(t.slice(p,g),/(:?<tr[^>]*>)/i,"<tr>"),b=-1,E=0,T=0,S=0,I={s:{r:1e7,c:1e7},e:{r:0,c:0}},A=[];for(p=0;p<y.length;++p){var M=y[p].trim(),F=M.slice(0,3).toLowerCase();if(F=="<tr"){if(++b,a.sheetRows&&a.sheetRows<=b){--b;break}E=0;continue}if(!(F!="<td"&&F!="<th")){var L=M.split(/<\/t[dh]>/i);for(g=0;g<L.length;++g){var O=L[g].trim();if(O.match(/<t[dh]/i)){for(var N=O,Q=0;N.charAt(0)=="<"&&(Q=N.indexOf(">"))>-1;)N=N.slice(Q+1);for(var ie=0;ie<A.length;++ie){var j=A[ie];j.s.c==E&&j.s.r<b&&b<=j.e.r&&(E=j.e.c+1,ie=-1)}var V=Kr(O.slice(0,O.indexOf(">")));S=V.colspan?+V.colspan:1,((T=+V.rowspan)>1||S>1)&&A.push({s:{r:b,c:E},e:{r:b+(T||1)-1,c:E+S-1}});var D=V.t||V["data-t"]||"";if(!N.length){E+=S;continue}if(N=GU(N),I.s.r>b&&(I.s.r=b),I.e.r<b&&(I.e.r=b),I.s.c>E&&(I.s.c=E),I.e.c<E&&(I.e.c=E),!N.length){E+=S;continue}var te={t:"s",v:N};a.raw||!N.trim().length||D=="s"||(N==="TRUE"?te={t:"b",v:!0}:N==="FALSE"?te={t:"b",v:!1}:isNaN(sl(N))?isNaN(H_(N).getDate())||(te={t:"d",v:Fa(N)},a.UTC===!1&&(te.v=Yd(te.v)),a.cellDates||(te={t:"n",v:La(te.v)}),te.z=a.dateNF||pn[14]):te={t:"n",v:sl(N)}),te.cellText!==!1&&(te.w=N),s?(c["!data"][b]||(c["!data"][b]=[]),c["!data"][b][E]=te):c[ii({r:b,c:E})]=te,E+=S}}}}return c["!ref"]=Xn(I),A.length&&(c["!merges"]=A),c}function g7(t,n,a,s){for(var c=t["!merges"]||[],f=[],d={},p=t["!data"]!=null,g=n.s.c;g<=n.e.c;++g){for(var y=0,b=0,E=0;E<c.length;++E)if(!(c[E].s.r>a||c[E].s.c>g)&&!(c[E].e.r<a||c[E].e.c<g)){if(c[E].s.r<a||c[E].s.c<g){y=-1;break}y=c[E].e.r-c[E].s.r+1,b=c[E].e.c-c[E].s.c+1;break}if(!(y<0)){var T=Qn(g)+vi(a),S=p?(t["!data"][a]||[])[g]:t[T],I=S&&S.v!=null&&(S.h||sb(S.w||(lu(S),S.w)||""))||"";d={},y>1&&(d.rowspan=y),b>1&&(d.colspan=b),s.editable?I='<span contenteditable="true">'+I+"</span>":S&&(d["data-t"]=S&&S.t||"z",S.v!=null&&(d["data-v"]=S.v instanceof Date?S.v.toISOString():S.v),S.z!=null&&(d["data-z"]=S.z),S.l&&(S.l.Target||"#").charAt(0)!="#"&&(I='<a href="'+sb(S.l.Target)+'">'+I+"</a>")),d.id=(s.id||"sjs")+"-"+T,f.push(Er("td",I,d))}}var A="<tr>";return A+f.join("")+"</tr>"}var _7='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',v7="</body></html>";function ake(t,n){var a=t.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!a||a.length==0)throw new Error("Invalid HTML: could not find <table>");if(a.length==1){var s=Bh(O6(a[0],n),n);return s.bookType="html",s}var c=n3();return a.forEach(function(f,d){_w(c,O6(f,n),"Sheet"+(d+1))}),c.bookType="html",c}function y7(t,n,a){var s=[];return s.join("")+"<table"+(a&&a.id?' id="'+a.id+'"':"")+">"}function x7(t,n){var a=n||{},s=a.header!=null?a.header:_7,c=a.footer!=null?a.footer:v7,f=[s],d=ho(t["!ref"]);f.push(y7(t,d,a));for(var p=d.s.r;p<=d.e.r;++p)f.push(g7(t,d,p,a));return f.push("</table>"+c),f.join("")}function b7(t,n,a){var s=n.rows;if(!s)throw"Unsupported origin when "+n.tagName+" is not a TABLE";var c=a||{},f=t["!data"]!=null,d=0,p=0;if(c.origin!=null)if(typeof c.origin=="number")d=c.origin;else{var g=typeof c.origin=="string"?Yi(c.origin):c.origin;d=g.r,p=g.c}var y=Math.min(c.sheetRows||1e7,s.length),b={s:{r:0,c:0},e:{r:d,c:p}};if(t["!ref"]){var E=ho(t["!ref"]);b.s.r=Math.min(b.s.r,E.s.r),b.s.c=Math.min(b.s.c,E.s.c),b.e.r=Math.max(b.e.r,E.e.r),b.e.c=Math.max(b.e.c,E.e.c),d==-1&&(b.e.r=d=E.e.r+1)}var T=[],S=0,I=t["!rows"]||(t["!rows"]=[]),A=0,M=0,F=0,L=0,O=0,N=0;for(t["!cols"]||(t["!cols"]=[]);A<s.length&&M<y;++A){var Q=s[A];if(R6(Q)){if(c.display)continue;I[M]={hidden:!0}}var ie=Q.cells;for(F=L=0;F<ie.length;++F){var j=ie[F];if(!(c.display&&R6(j))){var V=j.hasAttribute("data-v")?j.getAttribute("data-v"):j.hasAttribute("v")?j.getAttribute("v"):GU(j.innerHTML),D=j.getAttribute("data-z")||j.getAttribute("z");for(S=0;S<T.length;++S){var te=T[S];te.s.c==L+p&&te.s.r<M+d&&M+d<=te.e.r&&(L=te.e.c+1-p,S=-1)}N=+j.getAttribute("colspan")||1,((O=+j.getAttribute("rowspan")||1)>1||N>1)&&T.push({s:{r:M+d,c:L+p},e:{r:M+d+(O||1)-1,c:L+p+(N||1)-1}});var ue={t:"s",v:V},J=j.getAttribute("data-t")||j.getAttribute("t")||"";V!=null&&(V.length==0?ue.t=J||"z":c.raw||V.trim().length==0||J=="s"||(V==="TRUE"?ue={t:"b",v:!0}:V==="FALSE"?ue={t:"b",v:!1}:isNaN(sl(V))?isNaN(H_(V).getDate())||(ue={t:"d",v:Fa(V)},c.UTC&&(ue.v=ow(ue.v)),c.cellDates||(ue={t:"n",v:La(ue.v)}),ue.z=c.dateNF||pn[14]):ue={t:"n",v:sl(V)})),ue.z===void 0&&D!=null&&(ue.z=D);var le="",re=j.getElementsByTagName("A");if(re&&re.length)for(var Fe=0;Fe<re.length&&!(re[Fe].hasAttribute("href")&&(le=re[Fe].getAttribute("href"),le.charAt(0)!="#"));++Fe);le&&le.charAt(0)!="#"&&le.slice(0,11).toLowerCase()!="javascript:"&&(ue.l={Target:le}),f?(t["!data"][M+d]||(t["!data"][M+d]=[]),t["!data"][M+d][L+p]=ue):t[ii({c:L+p,r:M+d})]=ue,b.e.c<L+p&&(b.e.c=L+p),L+=N}}++M}return T.length&&(t["!merges"]=(t["!merges"]||[]).concat(T)),b.e.r=Math.max(b.e.r,M-1+d),t["!ref"]=Xn(b),M>=y&&(t["!fullref"]=Xn((b.e.r=s.length-A+M-1+d,b))),t}function w7(t,n){var a=n||{},s={};return a.dense&&(s["!data"]=[]),b7(s,t,n)}function oke(t,n){var a=Bh(w7(t,n),n);return a}function R6(t){var n="",a=ske(t);return a&&(n=a(t).getPropertyValue("display")),n||(n=t.style&&t.style.display),n==="none"}function ske(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function lke(t){var n=t.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(s,c){return Array(parseInt(c,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),a=bi(n.replace(/<[^>]*>/g,""));return[a]}function E7(t,n,a){var s=a||{},c=sw(t);Ja.lastIndex=0,c=c.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");for(var f,d,p="",g="",y,b=0,E=-1,T="";f=Ja.exec(c);)switch(f[3]=f[3].replace(/_.*$/,"")){case"number-style":case"currency-style":case"percentage-style":case"date-style":case"time-style":case"text-style":f[1]==="/"?(d["truncate-on-overflow"]=="false"&&(p.match(/h/)?p=p.replace(/h+/,"[$&]"):p.match(/m/)?p=p.replace(/m+/,"[$&]"):p.match(/s/)&&(p=p.replace(/s+/,"[$&]"))),s[d.name]=p,p=""):f[0].charAt(f[0].length-2)!=="/"&&(p="",d=Kr(f[0],!1));break;case"boolean-style":f[1]==="/"?(s[d.name]="General",p=""):f[0].charAt(f[0].length-2)!=="/"&&(p="",d=Kr(f[0],!1));break;case"boolean":p+="General";break;case"text":f[1]==="/"?(T=c.slice(E,Ja.lastIndex-f[0].length),T=="%"&&d[0]=="<number:percentage-style"?p+="%":p+='"'+T.replace(/"/g,'""')+'"'):f[0].charAt(f[0].length-2)!=="/"&&(E=Ja.lastIndex);break;case"day":switch(y=Kr(f[0],!1),y.style){case"short":p+="d";break;case"long":p+="dd";break;default:p+="dd";break}break;case"day-of-week":switch(y=Kr(f[0],!1),y.style){case"short":p+="ddd";break;case"long":p+="dddd";break;default:p+="ddd";break}break;case"era":switch(y=Kr(f[0],!1),y.style){case"short":p+="ee";break;case"long":p+="eeee";break;default:p+="eeee";break}break;case"hours":switch(y=Kr(f[0],!1),y.style){case"short":p+="h";break;case"long":p+="hh";break;default:p+="hh";break}break;case"minutes":switch(y=Kr(f[0],!1),y.style){case"short":p+="m";break;case"long":p+="mm";break;default:p+="mm";break}break;case"month":switch(y=Kr(f[0],!1),y.textual&&(p+="mm"),y.style){case"short":p+="m";break;case"long":p+="mm";break;default:p+="m";break}break;case"seconds":{switch(y=Kr(f[0],!1),y.style){case"short":p+="s";break;case"long":p+="ss";break;default:p+="ss";break}y["decimal-places"]&&(p+="."+Mi("0",+y["decimal-places"]))}break;case"year":switch(y=Kr(f[0],!1),y.style){case"short":p+="yy";break;case"long":p+="yyyy";break;default:p+="yy";break}break;case"am-pm":p+="AM/PM";break;case"week-of-year":case"quarter":console.error("Excel does not support ODS format token "+f[3]);break;case"fill-character":f[1]==="/"?(T=c.slice(E,Ja.lastIndex-f[0].length),p+='"'+T.replace(/"/g,'""')+'"*'):f[0].charAt(f[0].length-2)!=="/"&&(E=Ja.lastIndex);break;case"scientific-number":y=Kr(f[0],!1),p+="0."+Mi("0",+y["min-decimal-places"]||+y["decimal-places"]||2)+Mi("?",+y["decimal-places"]-+y["min-decimal-places"]||0)+"E"+(ji(y["forced-exponent-sign"])?"+":"")+Mi("0",+y["min-exponent-digits"]||2);break;case"fraction":y=Kr(f[0],!1),+y["min-integer-digits"]?p+=Mi("0",+y["min-integer-digits"]):p+="#",p+=" ",p+=Mi("?",+y["min-numerator-digits"]||1),p+="/",+y["denominator-value"]?p+=y["denominator-value"]:p+=Mi("?",+y["min-denominator-digits"]||1);break;case"currency-symbol":f[1]==="/"?p+='"'+c.slice(E,Ja.lastIndex-f[0].length).replace(/"/g,'""')+'"':f[0].charAt(f[0].length-2)!=="/"?E=Ja.lastIndex:p+="$";break;case"text-properties":switch(y=Kr(f[0],!1),(y.color||"").toLowerCase().replace("#","")){case"ff0000":case"red":p="[Red]"+p;break}break;case"text-content":p+="@";break;case"map":y=Kr(f[0],!1),bi(y.condition)=="value()>=0"?p=s[y["apply-style-name"]]+";"+p:console.error("ODS number format may be incorrect: "+y.condition);break;case"number":if(f[1]==="/")break;y=Kr(f[0],!1),g="",g+=Mi("0",+y["min-integer-digits"]||1),ji(y.grouping)&&(g=ju(Mi("#",Math.max(0,4-g.length))+g)),(+y["min-decimal-places"]||+y["decimal-places"])&&(g+="."),+y["min-decimal-places"]&&(g+=Mi("0",+y["min-decimal-places"]||1)),+y["decimal-places"]-(+y["min-decimal-places"]||0)&&(g+=Mi("0",+y["decimal-places"]-(+y["min-decimal-places"]||0))),p+=g;break;case"embedded-text":f[1]==="/"?b==0?p+='"'+c.slice(E,Ja.lastIndex-f[0].length).replace(/"/g,'""')+'"':p=p.slice(0,b)+'"'+c.slice(E,Ja.lastIndex-f[0].length).replace(/"/g,'""')+'"'+p.slice(b):f[0].charAt(f[0].length-2)!=="/"&&(E=Ja.lastIndex,b=-+Kr(f[0],!1).position||0);break}return s}function T7(t,n,a){var s=n||{},c=sw(t),f=[],d,p,g,y="",b=0,E,T,S={},I=[],A={};s.dense&&(A["!data"]=[]);var M,F,L={value:""},O="",N=0,Q="",ie=0,j=[],V=[],D=-1,te=-1,ue={s:{r:1e6,c:1e7},e:{r:0,c:0}},J=0,le=a||{},re={},Fe=[],Ye={},Ee=0,ut=0,Ne=[],He=1,Oe=1,Pe=[],rt={Names:[],WBProps:{}},et={},Ge=["",""],ze=[],oe={},Me="",fe=0,pe=!1,ot=!1,xe=0;for(Ja.lastIndex=0,c=c.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");M=Ja.exec(c);)switch(M[3]=M[3].replace(/_.*$/,"")){case"table":case"工作表":M[1]==="/"?(ue.e.c>=ue.s.c&&ue.e.r>=ue.s.r?A["!ref"]=Xn(ue):A["!ref"]="A1:A1",s.sheetRows>0&&s.sheetRows<=ue.e.r&&(A["!fullref"]=A["!ref"],ue.e.r=s.sheetRows-1,A["!ref"]=Xn(ue)),Fe.length&&(A["!merges"]=Fe),Ne.length&&(A["!rows"]=Ne),E.name=E.名称||E.name,typeof JSON<"u"&&JSON.stringify(E),I.push(E.name),S[E.name]=A,ot=!1):M[0].charAt(M[0].length-2)!=="/"&&(E=Kr(M[0],!1),D=te=-1,ue.s.r=ue.s.c=1e7,ue.e.r=ue.e.c=0,A={},s.dense&&(A["!data"]=[]),Fe=[],Ne=[],ot=!0);break;case"table-row-group":M[1]==="/"?--J:++J;break;case"table-row":case"行":if(M[1]==="/"){D+=He,He=1;break}if(T=Kr(M[0],!1),T.行号?D=T.行号-1:D==-1&&(D=0),He=+T["number-rows-repeated"]||1,He<10)for(xe=0;xe<He;++xe)J>0&&(Ne[D+xe]={level:J});te=-1;break;case"covered-table-cell":M[1]!=="/"&&++te,s.sheetStubs&&(s.dense?(A["!data"][D]||(A["!data"][D]=[]),A["!data"][D][te]={t:"z"}):A[ii({r:D,c:te})]={t:"z"}),O="",j=[];break;case"table-cell":case"数据":if(M[0].charAt(M[0].length-2)==="/")++te,L=Kr(M[0],!1),Oe=parseInt(L["number-columns-repeated"]||"1",10),F={t:"z",v:null},L.formula&&s.cellFormula!=!1&&(F.f=M6(bi(L.formula))),L["style-name"]&&re[L["style-name"]]&&(F.z=re[L["style-name"]]),(L.数据类型||L["value-type"])=="string"&&(F.t="s",F.v=bi(L["string-value"]||""),s.dense?(A["!data"][D]||(A["!data"][D]=[]),A["!data"][D][te]=F):A[Qn(te)+vi(D)]=F),te+=Oe-1;else if(M[1]!=="/"){++te,O=Q="",N=ie=0,j=[],V=[],Oe=1;var ae=He?D+He-1:D;if(te>ue.e.c&&(ue.e.c=te),te<ue.s.c&&(ue.s.c=te),D<ue.s.r&&(ue.s.r=D),ae>ue.e.r&&(ue.e.r=ae),L=Kr(M[0],!1),ze=[],oe={},F={t:L.数据类型||L["value-type"],v:null},L["style-name"]&&re[L["style-name"]]&&(F.z=re[L["style-name"]]),s.cellFormula)if(L.formula&&(L.formula=bi(L.formula)),L["number-matrix-columns-spanned"]&&L["number-matrix-rows-spanned"]&&(Ee=parseInt(L["number-matrix-rows-spanned"],10)||0,ut=parseInt(L["number-matrix-columns-spanned"],10)||0,Ye={s:{r:D,c:te},e:{r:D+Ee-1,c:te+ut-1}},F.F=Xn(Ye),Pe.push([Ye,F.F])),L.formula)F.f=M6(L.formula);else for(xe=0;xe<Pe.length;++xe)D>=Pe[xe][0].s.r&&D<=Pe[xe][0].e.r&&te>=Pe[xe][0].s.c&&te<=Pe[xe][0].e.c&&(F.F=Pe[xe][1]);switch((L["number-columns-spanned"]||L["number-rows-spanned"])&&(Ee=parseInt(L["number-rows-spanned"],10)||0,ut=parseInt(L["number-columns-spanned"],10)||0,Ye={s:{r:D,c:te},e:{r:D+Ee-1,c:te+ut-1}},Fe.push(Ye)),L["number-columns-repeated"]&&(Oe=parseInt(L["number-columns-repeated"],10)),F.t){case"boolean":F.t="b",F.v=ji(L["boolean-value"])||+L["boolean-value"]>=1;break;case"float":F.t="n",F.v=parseFloat(L.value),s.cellDates&&F.z&&cl(F.z)&&(F.v=Zu(F.v+(rt.WBProps.date1904?1462:0)),F.t=typeof F.v=="number"?"n":"d");break;case"percentage":F.t="n",F.v=parseFloat(L.value);break;case"currency":F.t="n",F.v=parseFloat(L.value);break;case"date":F.t="d",F.v=Fa(L["date-value"],rt.WBProps.date1904),s.cellDates||(F.t="n",F.v=La(F.v,rt.WBProps.date1904)),F.z||(F.z="m/d/yy");break;case"time":F.t="n",F.v=h1e(L["time-value"])/86400,s.cellDates&&(F.v=Zu(F.v),F.t=typeof F.v=="number"?"n":"d"),F.z||(F.z="HH:MM:SS");break;case"number":F.t="n",F.v=parseFloat(L.数据数值);break;default:if(F.t==="string"||F.t==="text"||!F.t)F.t="s",L["string-value"]!=null&&(O=bi(L["string-value"]),j=[]);else throw new Error("Unsupported value type "+F.t)}}else{if(pe=!1,F.t==="s"&&(F.v=O||"",j.length&&(F.R=j),pe=N==0),et.Target&&(F.l=et),ze.length>0&&(F.c=ze,ze=[]),O&&s.cellText!==!1&&(F.w=O),pe&&(F.t="z",delete F.v),(!pe||s.sheetStubs)&&!(s.sheetRows&&s.sheetRows<=D))for(var X=0;X<He;++X){if(Oe=parseInt(L["number-columns-repeated"]||"1",10),s.dense)for(A["!data"][D+X]||(A["!data"][D+X]=[]),A["!data"][D+X][te]=X==0?F:Qi(F);--Oe>0;)A["!data"][D+X][te+Oe]=Qi(F);else for(A[ii({r:D+X,c:te})]=F;--Oe>0;)A[ii({r:D+X,c:te+Oe})]=Qi(F);ue.e.c<=te&&(ue.e.c=te)}Oe=parseInt(L["number-columns-repeated"]||"1",10),te+=Oe-1,Oe=0,F={},O="",j=[]}et={};break;case"document":case"document-content":case"电子表格文档":case"spreadsheet":case"主体":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(M[1]==="/"){if((d=f.pop())[0]!==M[3])throw"Bad state: "+d}else M[0].charAt(M[0].length-2)!=="/"&&f.push([M[3],!0]);break;case"annotation":if(M[1]==="/"){if((d=f.pop())[0]!==M[3])throw"Bad state: "+d;oe.t=O,j.length&&(oe.R=j),oe.a=Me,ze.push(oe),O=Q,N=ie,j=V}else if(M[0].charAt(M[0].length-2)!=="/"){f.push([M[3],!1]);var Ce=Kr(M[0],!0);Ce.display&&ji(Ce.display)||(ze.hidden=!0),Q=O,ie=N,V=j,O="",N=0,j=[]}Me="",fe=0;break;case"creator":M[1]==="/"?Me=c.slice(fe,M.index):fe=M.index+M[0].length;break;case"meta":case"元数据":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(M[1]==="/"){if((d=f.pop())[0]!==M[3])throw"Bad state: "+d}else M[0].charAt(M[0].length-2)!=="/"&&f.push([M[3],!1]);O="",N=0,j=[];break;case"scientific-number":case"currency-symbol":case"fill-character":break;case"text-style":case"boolean-style":case"number-style":case"currency-style":case"percentage-style":case"date-style":case"time-style":if(M[1]==="/"){var he=Ja.lastIndex;E7(c.slice(g,Ja.lastIndex),n,le),Ja.lastIndex=he}else M[0].charAt(M[0].length-2)!=="/"&&(g=Ja.lastIndex-M[0].length);break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":{var G=Kr(M[0],!1);G.family=="table-cell"&&le[G["data-style-name"]]&&(re[G.name]=le[G["data-style-name"]])}break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":break;case"boolean":break;case"text":if(M[0].slice(-2)==="/>")break;if(M[1]==="/")switch(f[f.length-1][0]){case"number-style":case"date-style":case"time-style":y+=c.slice(b,M.index);break}else b=M.index+M[0].length;break;case"named-range":p=Kr(M[0],!1),Ge=yS(p["cell-range-address"]);var K={Name:p.name,Ref:Ge[0]+"!"+Ge[1]};ot&&(K.Sheet=I.length),rt.Names.push(K);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"电子表格":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":switch(p=Kr(M[0],!1),p["date-value"]){case"1904-01-01":rt.WBProps.date1904=!0;break}break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"文本串":if(["master-styles"].indexOf(f[f.length-1][0])>-1)break;if(M[1]==="/"&&(!L||!L["string-value"])){var se=lke(c.slice(N,M.index));O=(O.length>0?O+`
`:"")+se[0]}else M[0].slice(-2)=="/>"?O+=`
`:(Kr(M[0],!1),N=M.index+M[0].length);break;case"s":break;case"database-range":if(M[1]==="/")break;try{Ge=yS(Kr(M[0])["target-range-address"]),S[Ge[0]]["!autofilter"]={ref:Ge[1]}}catch{}break;case"date":break;case"object":break;case"title":case"标题":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(M[1]!=="/"){if(et=Kr(M[0],!1),!et.href)break;et.Target=bi(et.href),delete et.href,et.Target.charAt(0)=="#"&&et.Target.indexOf(".")>-1?(Ge=yS(et.Target.slice(1)),et.Target="#"+Ge[0]+"!"+Ge[1]):et.Target.match(/^\.\.[\\\/]/)&&(et.Target=et.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(M[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"表:":case"字:":break;default:if(s.WTF)throw new Error(M)}}var Ae={Sheets:S,SheetNames:I,Workbook:rt};return s.bookSheets&&delete Ae.Sheets,Ae}function L6(t,n){n=n||{},El(t,"META-INF/manifest.xml")&&vye(Ka(t,"META-INF/manifest.xml"),n);var a=hs(t,"styles.xml"),s=a&&E7(Ki(a)),c=hs(t,"content.xml");if(!c)throw new Error("Missing content.xml in ODS / UOF file");var f=T7(Ki(c),n,s);return El(t,"meta.xml")&&(f.Props=f9(Ka(t,"meta.xml"))),f.bookType="ods",f}function D6(t,n){var a=T7(t,n);return a.bookType="fods",a}var cke=function(){var t=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),n="<office:document-styles "+q_({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+t+"</office:document-styles>";return function(){return Wa+n}}();function uke(t,n){var a="number",s="",c={"style:name":n},f="",d=0;t=t.replace(/"[$]"/g,"$");e:{if(t.indexOf(";")>-1&&(console.error("Unsupported ODS Style Map exported.  Using first branch of "+t),t=t.slice(0,t.indexOf(";"))),t=="@"){a="text",s="<number:text-content/>";break e}if(t.indexOf(/\$/)>-1&&(a="currency"),t[d]=='"'){for(f="";t[++d]!='"'||t[++d]=='"';)f+=t[d];--d,t[d+1]=="*"?(d++,s+="<number:fill-character>"+Yn(f.replace(/""/g,'"'))+"</number:fill-character>"):s+="<number:text>"+Yn(f.replace(/""/g,'"'))+"</number:text>",t=t.slice(d+1),d=0}var p=t.match(/# (\?+)\/(\?+)/);if(p){s+=Er("number:fraction",null,{"number:min-integer-digits":0,"number:min-numerator-digits":p[1].length,"number:max-denominator-value":Math.max(+p[1].replace(/./g,"9"),+p[2].replace(/./g,"9"))});break e}if(p=t.match(/# (\?+)\/(\d+)/)){s+=Er("number:fraction",null,{"number:min-integer-digits":0,"number:min-numerator-digits":p[1].length,"number:denominator-value":+p[2]});break e}if(p=t.match(/(\d+)(|\.\d+)%/)){a="percentage",s+=Er("number:number",null,{"number:decimal-places":p[2]&&p.length-1||0,"number:min-decimal-places":p[2]&&p.length-1||0,"number:min-integer-digits":p[1].length})+"<number:text>%</number:text>";break e}var g=!1;if(["y","m","d"].indexOf(t[0])>-1){a="date";t:for(;d<t.length;++d)switch(f=t[d].toLowerCase()){case"h":case"s":g=!0,--d;break t;case"m":r:for(var y=d+1;y<t.length;++y)switch(t[y]){case"y":case"d":break r;case"h":case"s":g=!0,--d;break t}case"y":case"d":for(;(t[++d]||"").toLowerCase()==f[0];)f+=f[0];switch(--d,f){case"y":case"yy":s+="<number:year/>";break;case"yyy":case"yyyy":s+='<number:year number:style="long"/>';break;case"mmmmm":console.error("ODS has no equivalent of format |mmmmm|");case"m":case"mm":case"mmm":case"mmmm":s+='<number:month number:style="'+(f.length%2?"short":"long")+'" number:textual="'+(f.length>=3?"true":"false")+'"/>';break;case"d":case"dd":s+='<number:day number:style="'+(f.length%2?"short":"long")+'"/>';break;case"ddd":case"dddd":s+='<number:day-of-week number:style="'+(f.length%2?"short":"long")+'"/>';break}break;case'"':for(;t[++d]!='"'||t[++d]=='"';)f+=t[d];--d,s+="<number:text>"+Yn(f.slice(1).replace(/""/g,'"'))+"</number:text>";break;case"\\":f=t[++d],s+="<number:text>"+Yn(f)+"</number:text>";break;case"/":case":":s+="<number:text>"+Yn(f)+"</number:text>";break;default:console.error("unrecognized character "+f+" in ODF format "+t)}if(!g)break e;t=t.slice(d+1),d=0}if(t.match(/^\[?[hms]/)){for(a=="number"&&(a="time"),t.match(/\[/)&&(t=t.replace(/[\[\]]/g,""),c["number:truncate-on-overflow"]="false");d<t.length;++d)switch(f=t[d].toLowerCase()){case"h":case"m":case"s":for(;(t[++d]||"").toLowerCase()==f[0];)f+=f[0];switch(--d,f){case"h":case"hh":s+='<number:hours number:style="'+(f.length%2?"short":"long")+'"/>';break;case"m":case"mm":s+='<number:minutes number:style="'+(f.length%2?"short":"long")+'"/>';break;case"s":case"ss":if(t[d+1]==".")do f+=t[d+1],++d;while(t[d+1]=="0");s+='<number:seconds number:style="'+(f.match("ss")?"long":"short")+'"'+(f.match(/\./)?' number:decimal-places="'+(f.match(/0+/)||[""])[0].length+'"':"")+"/>";break}break;case'"':for(;t[++d]!='"'||t[++d]=='"';)f+=t[d];--d,s+="<number:text>"+Yn(f.slice(1).replace(/""/g,'"'))+"</number:text>";break;case"/":case":":s+="<number:text>"+Yn(f)+"</number:text>";break;case"a":if(t.slice(d,d+3).toLowerCase()=="a/p"){s+="<number:am-pm/>",d+=2;break}if(t.slice(d,d+5).toLowerCase()=="am/pm"){s+="<number:am-pm/>",d+=4;break}default:console.error("unrecognized character "+f+" in ODF format "+t)}break e}if(t.indexOf(/\$/)>-1&&(a="currency"),t[0]=="$"&&(s+='<number:currency-symbol number:language="en" number:country="US">$</number:currency-symbol>',t=t.slice(1),d=0),d=0,t[d]=='"'){for(;t[++d]!='"'||t[++d]=='"';)f+=t[d];--d,t[d+1]=="*"?(d++,s+="<number:fill-character>"+Yn(f.replace(/""/g,'"'))+"</number:fill-character>"):s+="<number:text>"+Yn(f.replace(/""/g,'"'))+"</number:text>",t=t.slice(d+1),d=0}var b=t.match(/([#0][0#,]*)(\.[0#]*|)(E[+]?0*|)/i);if(!b||!b[0])console.error("Could not find numeric part of "+t);else{var E=b[1].replace(/,/g,"");s+="<number:"+(b[3]?"scientific-":"")+'number number:min-integer-digits="'+(E.indexOf("0")==-1?"0":E.length-E.indexOf("0"))+'"'+(b[0].indexOf(",")>-1?' number:grouping="true"':"")+(b[2]&&' number:decimal-places="'+(b[2].length-1)+'"'||' number:decimal-places="0"')+(b[3]&&b[3].indexOf("+")>-1?' number:forced-exponent-sign="true"':"")+(b[3]?' number:min-exponent-digits="'+b[3].match(/0+/)[0].length+'"':"")+"></number:"+(b[3]?"scientific-":"")+"number>",d=b.index+b[0].length}if(t[d]=='"'){for(f="";t[++d]!='"'||t[++d]=='"';)f+=t[d];--d,s+="<number:text>"+Yn(f.replace(/""/g,'"'))+"</number:text>"}}return s?Er("number:"+a+"-style",s,c):(console.error("Could not generate ODS number format for |"+t+"|"),"")}function B6(t,n,a){for(var s=[],c=0;c<t.length;++c){var f=t[c];f&&f.Sheet==(a==-1?null:a)&&s.push(f)}return s.length?`      <table:named-expressions>
`+s.map(function(d){var p=(a==-1?"$":"")+n7(d.Ref);return"        "+Er("table:named-range",null,{"table:name":d.Name,"table:cell-range-address":p,"table:base-cell-address":p.replace(/[\.]?[^\.]*$/,".$A$1")})}).join(`
`)+`
      </table:named-expressions>
`:""}var z6=function(){var t=function(c){return Yn(c).replace(/  +/g,function(f){return'<text:s text:c="'+f.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},n=`          <table:table-cell />
`,a=function(c,f,d,p,g,y){var b=[];b.push('      <table:table table:name="'+Yn(f.SheetNames[d])+`" table:style-name="ta1">
`);var E=0,T=0,S=ho(c["!ref"]||"A1"),I=c["!merges"]||[],A=0,M=c["!data"]!=null;if(c["!cols"])for(T=0;T<=S.e.c;++T)b.push("        <table:table-column"+(c["!cols"][T]?' table:style-name="co'+c["!cols"][T].ods+'"':"")+`></table:table-column>
`);var F="",L=c["!rows"]||[];for(E=0;E<S.s.r;++E)F=L[E]?' table:style-name="ro'+L[E].ods+'"':"",b.push("        <table:table-row"+F+`></table:table-row>
`);for(;E<=S.e.r;++E){for(F=L[E]?' table:style-name="ro'+L[E].ods+'"':"",b.push("        <table:table-row"+F+`>
`),T=0;T<S.s.c;++T)b.push(n);for(;T<=S.e.c;++T){var O=!1,N={},Q="";for(A=0;A!=I.length;++A)if(!(I[A].s.c>T)&&!(I[A].s.r>E)&&!(I[A].e.c<T)&&!(I[A].e.r<E)){(I[A].s.c!=T||I[A].s.r!=E)&&(O=!0),N["table:number-columns-spanned"]=I[A].e.c-I[A].s.c+1,N["table:number-rows-spanned"]=I[A].e.r-I[A].s.r+1;break}if(O){b.push(`          <table:covered-table-cell/>
`);continue}var ie=ii({r:E,c:T}),j=M?(c["!data"][E]||[])[T]:c[ie];if(j&&j.f&&(N["table:formula"]=Yn(DTe(j.f)),j.F&&j.F.slice(0,ie.length)==ie)){var V=ho(j.F);N["table:number-matrix-columns-spanned"]=V.e.c-V.s.c+1,N["table:number-matrix-rows-spanned"]=V.e.r-V.s.r+1}if(!j){b.push(n);continue}switch(j.t){case"b":Q=j.v?"TRUE":"FALSE",N["office:value-type"]="boolean",N["office:boolean-value"]=j.v?"true":"false";break;case"n":Q=j.w||String(j.v||0),N["office:value-type"]="float",N["office:value"]=j.v||0;break;case"s":case"str":Q=j.v==null?"":j.v,N["office:value-type"]="string";break;case"d":Q=j.w||Fa(j.v,y).toISOString(),N["office:value-type"]="date",N["office:date-value"]=Fa(j.v,y).toISOString(),N["table:style-name"]="ce1";break;default:b.push(n);continue}var D=t(Q);if(j.l&&j.l.Target){var te=j.l.Target;te=te.charAt(0)=="#"?"#"+n7(te.slice(1)):te,te.charAt(0)!="#"&&!te.match(/^\w+:/)&&(te="../"+te),D=Er("text:a",D,{"xlink:href":te.replace(/&/g,"&amp;")})}g[j.z]&&(N["table:style-name"]="ce"+g[j.z].slice(1));var ue=Er("text:p",D,{});if(j.c){for(var J="",le="",re={},Fe=0;Fe<j.c.length;++Fe)!J&&j.c[Fe].a&&(J=j.c[Fe].a),le+="<text:p>"+t(j.c[Fe].t)+"</text:p>";j.c.hidden||(re["office:display"]=!0),ue=Er("office:annotation",le,re)+ue}b.push("          "+Er("table:table-cell",ue,N)+`
`)}b.push(`        </table:table-row>
`)}return(f.Workbook||{}).Names&&b.push(B6(f.Workbook.Names,f.SheetNames,d)),b.push(`      </table:table>
`),b.join("")},s=function(c,f){c.push(` <office:automatic-styles>
`);var d=0;f.SheetNames.map(function(b){return f.Sheets[b]}).forEach(function(b){if(b&&b["!cols"]){for(var E=0;E<b["!cols"].length;++E)if(b["!cols"][E]){var T=b["!cols"][E];if(T.width==null&&T.wpx==null&&T.wch==null)continue;kh(T),T.ods=d;var S=b["!cols"][E].wpx+"px";c.push('  <style:style style:name="co'+d+`" style:family="table-column">
`),c.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+S+`"/>
`),c.push(`  </style:style>
`),++d}}});var p=0;f.SheetNames.map(function(b){return f.Sheets[b]}).forEach(function(b){if(b&&b["!rows"]){for(var E=0;E<b["!rows"].length;++E)if(b["!rows"][E]){b["!rows"][E].ods=p;var T=b["!rows"][E].hpx+"px";c.push('  <style:style style:name="ro'+p+`" style:family="table-row">
`),c.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+T+`"/>
`),c.push(`  </style:style>
`),++p}}}),c.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),c.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),c.push(`  </style:style>
`),c.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),c.push(`   <number:month number:style="long"/>
`),c.push(`   <number:text>/</number:text>
`),c.push(`   <number:day number:style="long"/>
`),c.push(`   <number:text>/</number:text>
`),c.push(`   <number:year/>
`),c.push(`  </number:date-style>
`);var g={},y=69;return f.SheetNames.map(function(b){return f.Sheets[b]}).forEach(function(b){if(b)for(var E=b["!data"]!=null,T=ho(b["!ref"]),S=0;S<=T.e.r;++S)for(var I=0;I<=T.e.c;++I){var A=E?(b["!data"][S]||[])[I]:b[ii({r:S,c:I})];if(!(!A||!A.z||A.z.toLowerCase()=="general")&&!g[A.z]){var M=uke(A.z,"N"+y);M&&(g[A.z]="N"+y,++y,c.push(M+`
`))}}}),c.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),Ma(g).forEach(function(b){c.push('<style:style style:name="ce'+g[b].slice(1)+'" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="'+g[b]+`"/>
`)}),c.push(` </office:automatic-styles>
`),g};return function(f,d){var p=[Wa],g=q_({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),y=q_({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});d.bookType=="fods"?(p.push("<office:document"+g+y+`>
`),p.push(u9().replace(/<office:document-meta.*?>/,"").replace(/<\/office:document-meta>/,"")+`
`)):p.push("<office:document-content"+g+`>
`);var b=s(p,f);p.push(`  <office:body>
`),p.push(`    <office:spreadsheet>
`),((f.Workbook||{}).WBProps||{}).date1904&&p.push(`      <table:calculation-settings table:case-sensitive="false" table:search-criteria-must-apply-to-whole-cell="true" table:use-wildcards="true" table:use-regular-expressions="false" table:automatic-find-labels="false">
        <table:null-date table:date-value="1904-01-01"/>
      </table:calculation-settings>
`);for(var E=0;E!=f.SheetNames.length;++E)p.push(a(f.Sheets[f.SheetNames[E]],f,E,d,b,((f.Workbook||{}).WBProps||{}).date1904));return(f.Workbook||{}).Names&&p.push(B6(f.Workbook.Names,f.SheetNames,-1)),p.push(`    </office:spreadsheet>
`),p.push(`  </office:body>
`),d.bookType=="fods"?p.push("</office:document>"):p.push("</office:document-content>"),p.join("")}}();function S7(t,n){if(n.bookType=="fods")return z6(t,n);var a=wk(),s="",c=[],f=[];return s="mimetype",qn(a,s,"application/vnd.oasis.opendocument.spreadsheet"),s="content.xml",qn(a,s,z6(t,n)),c.push([s,"text/xml"]),f.push([s,"ContentFile"]),s="styles.xml",qn(a,s,cke(t,n)),c.push([s,"text/xml"]),f.push([s,"StylesFile"]),s="meta.xml",qn(a,s,Wa+u9()),c.push([s,"text/xml"]),f.push([s,"MetadataFile"]),s="manifest.rdf",qn(a,s,bye(f)),c.push([s,"application/rdf+xml"]),s="META-INF/manifest.xml",qn(a,s,yye(c)),a}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */var ja=function(){try{return typeof Uint8Array>"u"||typeof Uint8Array.prototype.subarray>"u"?"slice":typeof Buffer<"u"?typeof Buffer.prototype.subarray>"u"?"slice":(typeof Buffer.from=="function"?Buffer.from([72,62]):new Buffer([72,62]))instanceof Uint8Array?"subarray":"slice":"subarray"}catch{return"slice"}}();function tf(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function fc(t){return typeof TextDecoder<"u"?new TextDecoder().decode(t):Ki(su(t))}function ss(t){return typeof TextEncoder<"u"?new TextEncoder().encode(t):us(tu(t))}function Mh(t){for(var n=0,a=0;a<t.length;++a)n+=t[a].length;var s=new Uint8Array(n),c=0;for(a=0;a<t.length;++a){var f=t[a],d=f.length;if(d<250)for(var p=0;p<d;++p)s[c++]=f[p];else s.set(f,c),c+=d}return s}function v_(t){return t-=t>>1&1431655765,t=(t&858993459)+(t>>2&858993459),(t+(t>>4)&252645135)*16843009>>>24}function fke(t,n){for(var a=(t[n+15]&127)<<7|t[n+14]>>1,s=t[n+14]&1,c=n+13;c>=n;--c)s=s*256+t[c];return(t[n+15]&128?-s:s)*Math.pow(10,a-6176)}function hke(t,n,a){var s=Math.floor(a==0?0:Math.LOG10E*Math.log(Math.abs(a)))+6176-16,c=a/Math.pow(10,s-6176);t[n+15]|=s>>7,t[n+14]|=(s&127)<<1;for(var f=0;c>=1;++f,c/=256)t[n+f]=c&255;t[n+15]|=a>=0?0:128}function nv(t,n){var a=n.l,s=t[a]&127;e:if(t[a++]>=128&&(s|=(t[a]&127)<<7,t[a++]<128||(s|=(t[a]&127)<<14,t[a++]<128)||(s|=(t[a]&127)<<21,t[a++]<128)||(s+=(t[a]&127)*Math.pow(2,28),++a,t[a++]<128)||(s+=(t[a]&127)*Math.pow(2,35),++a,t[a++]<128)||(s+=(t[a]&127)*Math.pow(2,42),++a,t[a++]<128)))break e;return n.l=a,s}function en(t){var n=new Uint8Array(7);n[0]=t&127;var a=1;e:if(t>127){if(n[a-1]|=128,n[a]=t>>7&127,++a,t<=16383||(n[a-1]|=128,n[a]=t>>14&127,++a,t<=2097151)||(n[a-1]|=128,n[a]=t>>21&127,++a,t<=268435455)||(n[a-1]|=128,n[a]=t/256>>>21&127,++a,t<=34359738367)||(n[a-1]|=128,n[a]=t/65536>>>21&127,++a,t<=4398046511103))break e;n[a-1]|=128,n[a]=t/16777216>>>21&127,++a}return n[ja](0,a)}function C7(t){for(var n={l:0},a=[];n.l<t.length;)a.push(nv(t,n));return a}function A7(t){return Mh(t.map(function(n){return en(n)}))}function wi(t){var n=0,a=t[n]&127;return t[n++]<128||(a|=(t[n]&127)<<7,t[n++]<128)||(a|=(t[n]&127)<<14,t[n++]<128)||(a|=(t[n]&127)<<21,t[n++]<128)||(a|=(t[n]&15)<<28),a}function Or(t){for(var n=[],a={l:0};a.l<t.length;){var s=a.l,c=nv(t,a),f=c&7;c=c/8|0;var d,p=a.l;switch(f){case 0:{for(;t[p++]>=128;);d=t[ja](a.l,p),a.l=p}break;case 1:d=t[ja](p,p+8),a.l=p+8;break;case 2:{var g=nv(t,a);d=t[ja](a.l,a.l+g),a.l+=g}break;case 5:d=t[ja](p,p+4),a.l=p+4;break;default:throw new Error("PB Type ".concat(f," for Field ").concat(c," at offset ").concat(s))}var y={data:d,type:f};n[c]==null&&(n[c]=[]),n[c].push(y)}return n}function cn(t){var n=[];return t.forEach(function(a,s){s!=0&&a.forEach(function(c){c.data&&(n.push(en(s*8+c.type)),c.type==2&&n.push(en(c.data.length)),n.push(c.data))})}),Mh(n)}function tp(t,n){return(t==null?void 0:t.map(function(a){return n(a.data)}))||[]}function iv(t){for(var n,a=[],s={l:0};s.l<t.length;){var c=nv(t,s),f=Or(t[ja](s.l,s.l+c));s.l+=c;var d={id:wi(f[1][0].data),messages:[]};f[2].forEach(function(p){var g=Or(p.data),y=wi(g[3][0].data);d.messages.push({meta:g,data:t[ja](s.l,s.l+y)}),s.l+=y}),(n=f[3])!=null&&n[0]&&(d.merge=wi(f[3][0].data)>>>0>0),a.push(d)}return a}function L0(t){var n=[];return t.forEach(function(a){var s=[[],[{data:en(a.id),type:0}],[]];a.merge!=null&&(s[3]=[{data:en(+!!a.merge),type:0}]);var c=[];a.messages.forEach(function(d){c.push(d.data),d.meta[3]=[{type:0,data:en(d.data.length)}],s[2].push({data:cn(d.meta),type:2})});var f=cn(s);n.push(en(f.length)),n.push(f),c.forEach(function(d){return n.push(d)})}),Mh(n)}function dke(t,n){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var a={l:0},s=nv(n,a),c=[],f=a.l;f<n.length;){var d=n[f]&3;if(d==0){var p=n[f++]>>2;if(p<60)++p;else{var g=p-59;p=n[f],g>1&&(p|=n[f+1]<<8),g>2&&(p|=n[f+2]<<16),g>3&&(p|=n[f+3]<<24),p>>>=0,p++,f+=g}c.push(n[ja](f,f+p)),f+=p;continue}else{var y=0,b=0;if(d==1?(b=(n[f]>>2&7)+4,y=(n[f++]&224)<<3,y|=n[f++]):(b=(n[f++]>>2)+1,d==2?(y=n[f]|n[f+1]<<8,f+=2):(y=(n[f]|n[f+1]<<8|n[f+2]<<16|n[f+3]<<24)>>>0,f+=4)),y==0)throw new Error("Invalid offset 0");for(var E=c.length-1,T=y;E>=0&&T>=c[E].length;)T-=c[E].length,--E;if(E<0)if(T==0)T=c[E=0].length;else throw new Error("Invalid offset beyond length");if(b<T)c.push(c[E][ja](c[E].length-T,c[E].length-T+b));else{for(T>0&&(c.push(c[E][ja](c[E].length-T)),b-=T),++E;b>=c[E].length;)c.push(c[E]),b-=c[E].length,++E;b&&c.push(c[E][ja](0,b))}c.length>25&&(c=[Mh(c)])}}for(var S=0,I=0;I<c.length;++I)S+=c[I].length;if(S!=s)throw new Error("Unexpected length: ".concat(S," != ").concat(s));return c}function av(t){Array.isArray(t)&&(t=new Uint8Array(t));for(var n=[],a=0;a<t.length;){var s=t[a++],c=t[a]|t[a+1]<<8|t[a+2]<<16;a+=3,n.push.apply(n,dke(s,t[ja](a,a+c))),a+=c}if(a!==t.length)throw new Error("data is not a valid framed stream!");return n.length==1?n[0]:Mh(n)}function D0(t){for(var n=[],a=0;a<t.length;){var s=Math.min(t.length-a,268435455),c=new Uint8Array(4);n.push(c);var f=en(s),d=f.length;n.push(f),s<=60?(d++,n.push(new Uint8Array([s-1<<2]))):s<=256?(d+=2,n.push(new Uint8Array([240,s-1&255]))):s<=65536?(d+=3,n.push(new Uint8Array([244,s-1&255,s-1>>8&255]))):s<=16777216?(d+=4,n.push(new Uint8Array([248,s-1&255,s-1>>8&255,s-1>>16&255]))):s<=4294967296&&(d+=5,n.push(new Uint8Array([252,s-1&255,s-1>>8&255,s-1>>16&255,s-1>>>24&255]))),n.push(t[ja](a,a+s)),d+=s,c[0]=0,c[1]=d&255,c[2]=d>>8&255,c[3]=d>>16&255,a+=s}return Mh(n)}var pke=function(){return{sst:[],rsst:[],ofmt:[],nfmt:[],fmla:[],ferr:[],cmnt:[]}};function k7(t,n,a,s,c){var f,d,p,g,y=n&255,b=n>>8,E=b>=5?c:s;e:if(a&(b>4?8:4)&&t.t=="n"&&y==7){var T=(f=E[7])!=null&&f[0]?wi(E[7][0].data):-1;if(T==-1)break e;var S=(d=E[15])!=null&&d[0]?wi(E[15][0].data):-1,I=(p=E[16])!=null&&p[0]?wi(E[16][0].data):-1,A=(g=E[40])!=null&&g[0]?wi(E[40][0].data):-1,M=t.v,F=M;t:if(A){if(M==0){S=I=2;break t}M>=604800?S=1:M>=86400?S=2:M>=3600?S=4:M>=60?S=8:M>=1?S=16:S=32,Math.floor(M)!=M?I=32:M%60?I=16:M%3600?I=8:M%86400?I=4:M%604800&&(I=2),I<S&&(I=S)}if(S==-1||I==-1)break e;var L=[],O=[];S==1&&(F=M/604800,I==1?O.push('d"d"'):(F|=0,M-=604800*F),L.push(F+(T==2?" week"+(F==1?"":"s"):T==1?"w":""))),S<=2&&I>=2&&(F=M/86400,I>2&&(F|=0,M-=86400*F),O.push('d"d"'),L.push(F+(T==2?" day"+(F==1?"":"s"):T==1?"d":""))),S<=4&&I>=4&&(F=M/3600,I>4&&(F|=0,M-=3600*F),O.push((S>=4?"[h]":"h")+'"h"'),L.push(F+(T==2?" hour"+(F==1?"":"s"):T==1?"h":""))),S<=8&&I>=8&&(F=M/60,I>8&&(F|=0,M-=60*F),O.push((S>=8?"[m]":"m")+'"m"'),T==0?L.push((S==8&&I==8||F>=10?"":"0")+F):L.push(F+(T==2?" minute"+(F==1?"":"s"):T==1?"m":""))),S<=16&&I>=16&&(F=M,I>16&&(F|=0,M-=F),O.push((S>=16?"[s]":"s")+'"s"'),T==0?L.push((I==16&&S==16||F>=10?"":"0")+F):L.push(F+(T==2?" second"+(F==1?"":"s"):T==1?"s":""))),I>=32&&(F=Math.round(1e3*M),S<32&&O.push('.000"ms"'),T==0?L.push((F>=100?"":F>=10?"0":"00")+F):L.push(F+(T==2?" millisecond"+(F==1?"":"s"):T==1?"ms":""))),t.w=L.join(T==0?":":" "),t.z=O.join(T==0?'":"':" "),T==0&&(t.w=t.w.replace(/:(\d\d\d)$/,".$1"))}}function mke(t,n,a,s){var c=tf(t),f=c.getUint32(4,!0),d=-1,p=-1,g=-1,y=NaN,b=0,E=new Date(Date.UTC(2001,0,1)),T=a>1?12:8;f&2&&(g=c.getUint32(T,!0),T+=4),T+=v_(f&(a>1?3468:396))*4,f&512&&(d=c.getUint32(T,!0),T+=4),T+=v_(f&(a>1?12288:4096))*4,f&16&&(p=c.getUint32(T,!0),T+=4),f&32&&(y=c.getFloat64(T,!0),T+=8),f&64&&(E.setTime(E.getTime()+(b=c.getFloat64(T,!0))*1e3),T+=8),a>1&&(f=c.getUint32(8,!0)>>>16,f&255&&(g==-1&&(g=c.getUint32(T,!0)),T+=4));var S,I=t[a>=4?1:2];switch(I){case 0:return;case 2:S={t:"n",v:y};break;case 3:S={t:"s",v:n.sst[p]};break;case 5:s!=null&&s.cellDates?S={t:"d",v:E}:S={t:"n",v:b/86400+35430,z:pn[14]};break;case 6:S={t:"b",v:y>0};break;case 7:S={t:"n",v:y};break;case 8:S={t:"e",v:0};break;case 9:if(d>-1){var A=n.rsst[d];S={t:"s",v:A.v},A.l&&(S.l={Target:A.l})}else throw new Error("Unsupported cell type ".concat(t[ja](0,4)));break;default:throw new Error("Unsupported cell type ".concat(t[ja](0,4)))}return g>-1&&k7(S,I|a<<8,f,n.ofmt[g],n.nfmt[g]),I==7&&(S.v/=86400),S}function gke(t,n,a){var s=tf(t);s.getUint32(4,!0);var c=s.getUint32(8,!0),f=12,d=-1,p=-1,g=-1,y=NaN,b=NaN,E=0,T=new Date(Date.UTC(2001,0,1));c&1&&(y=fke(t,f),f+=16),c&2&&(b=s.getFloat64(f,!0),f+=8),c&4&&(T.setTime(T.getTime()+(E=s.getFloat64(f,!0))*1e3),f+=8),c&8&&(p=s.getUint32(f,!0),f+=4),c&16&&(d=s.getUint32(f,!0),f+=4),f+=v_(c&480)*4,c&512&&(s.getUint32(f,!0),f+=4),f+=v_(c&1024)*4,c&2048&&(s.getUint32(f,!0),f+=4);var S,I=t[1];switch(I){case 0:S={t:"z"};break;case 2:S={t:"n",v:y};break;case 3:S={t:"s",v:n.sst[p]};break;case 5:a!=null&&a.cellDates?S={t:"d",v:T}:S={t:"n",v:E/86400+35430,z:pn[14]};break;case 6:S={t:"b",v:b>0};break;case 7:S={t:"n",v:b};break;case 8:S={t:"e",v:0};break;case 9:if(d>-1){var A=n.rsst[d];S={t:"s",v:A.v},A.l&&(S.l={Target:A.l})}else throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(c&31," : ").concat(t[ja](0,4)));break;case 10:S={t:"n",v:y};break;default:throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(c&31," : ").concat(t[ja](0,4)))}if(f+=v_(c&4096)*4,c&516096&&(g==-1&&(g=s.getUint32(f,!0)),f+=4),c&524288){var M=s.getUint32(f,!0);f+=4,n.cmnt[M]&&(S.c=xke(n.cmnt[M]))}return g>-1&&k7(S,I|1280,c>>13,n.ofmt[g],n.nfmt[g]),I==7&&(S.v/=86400),S}function TS(t,n){var a=new Uint8Array(32),s=tf(a),c=12,f=0;switch(a[0]=5,t.t){case"n":if(t.z&&cl(t.z)){a[1]=5,s.setFloat64(c,(Zu(t.v+1462).getTime()-Date.UTC(2001,0,1))/1e3,!0),f|=4,c+=8;break}else a[1]=2,hke(a,c,t.v),f|=1,c+=16;break;case"b":a[1]=6,s.setFloat64(c,t.v?1:0,!0),f|=2,c+=8;break;case"s":{var d=t.v==null?"":String(t.v);if(t.l){var p=n.rsst.findIndex(function(y){var b;return y.v==d&&y.l==((b=t.l)==null?void 0:b.Target)});p==-1&&(n.rsst[p=n.rsst.length]={v:d,l:t.l.Target}),a[1]=9,s.setUint32(c,p,!0),f|=16,c+=4}else{var g=n.sst.indexOf(d);g==-1&&(n.sst[g=n.sst.length]=d),a[1]=3,s.setUint32(c,g,!0),f|=8,c+=4}}break;case"d":a[1]=5,s.setFloat64(c,(t.v.getTime()-Date.UTC(2001,0,1))/1e3,!0),f|=4,c+=8;break;case"z":a[1]=0;break;default:throw"unsupported cell type "+t.t}return t.c&&(n.cmnt.push(bke(t.c)),s.setUint32(c,n.cmnt.length-1,!0),f|=524288,c+=4),s.setUint32(8,f,!0),a[ja](0,c)}function SS(t,n){var a=new Uint8Array(32),s=tf(a),c=12,f=0,d="";switch(a[0]=4,t.t){case"n":break;case"b":break;case"s":if(d=t.v==null?"":String(t.v),t.l){var p=n.rsst.findIndex(function(y){var b;return y.v==d&&y.l==((b=t.l)==null?void 0:b.Target)});p==-1&&(n.rsst[p=n.rsst.length]={v:d,l:t.l.Target}),a[1]=9,s.setUint32(c,p,!0),f|=512,c+=4}break;case"d":break;case"e":break;case"z":break;default:throw"unsupported cell type "+t.t}switch(t.c&&(s.setUint32(c,n.cmnt.length-1,!0),f|=4096,c+=4),t.t){case"n":a[1]=2,s.setFloat64(c,t.v,!0),f|=32,c+=8;break;case"b":a[1]=6,s.setFloat64(c,t.v?1:0,!0),f|=32,c+=8;break;case"s":if(d=t.v==null?"":String(t.v),!t.l){var g=n.sst.indexOf(d);g==-1&&(n.sst[g=n.sst.length]=d),a[1]=3,s.setUint32(c,g,!0),f|=16,c+=4}break;case"d":a[1]=5,s.setFloat64(c,(t.v.getTime()-Date.UTC(2001,0,1))/1e3,!0),f|=64,c+=8;break;case"z":a[1]=0;break;default:throw"unsupported cell type "+t.t}return s.setUint32(8,f,!0),a[ja](0,c)}function _ke(t,n,a){switch(t[0]){case 0:case 1:case 2:case 3:case 4:return mke(t,n,t[0],a);case 5:return gke(t,n,a);default:throw new Error("Unsupported payload version ".concat(t[0]))}}function hi(t){var n=Or(t);return wi(n[1][0].data)}function Lo(t){return cn([[],[{type:0,data:en(t)}]])}function Ro(t,n){var a,s=(a=t.messages[0].meta[5])!=null&&a[0]?C7(t.messages[0].meta[5][0].data):[],c=s.indexOf(n);c==-1&&(s.push(n),t.messages[0].meta[5]=[{type:2,data:A7(s)}])}function Nu(t,n){var a,s=(a=t.messages[0].meta[5])!=null&&a[0]?C7(t.messages[0].meta[5][0].data):[];t.messages[0].meta[5]=[{type:2,data:A7(s.filter(function(c){return c!=n}))}]}function Ed(t,n){var a=Or(n.data),s=wi(a[1][0].data),c=a[3],f=[];return(c||[]).forEach(function(d){var p,g,y=Or(d.data);if(y[1]){var b=wi(y[1][0].data)>>>0;switch(s){case 1:f[b]=fc(y[3][0].data);break;case 8:{var E=t[hi(y[9][0].data)][0],T=Or(E.data),S=t[hi(T[1][0].data)][0],I=wi(S.meta[1][0].data);if(I!=2001)throw new Error("2000 unexpected reference to ".concat(I));var A=Or(S.data),M={v:A[3].map(function(O){return fc(O.data)}).join("")};f[b]=M;e:if((p=A==null?void 0:A[11])!=null&&p[0]){var F=(g=Or(A[11][0].data))==null?void 0:g[1];if(!F)break e;F.forEach(function(O){var N,Q,ie,j=Or(O.data);if((N=j[2])!=null&&N[0]){var V=t[hi((Q=j[2])==null?void 0:Q[0].data)][0],D=wi(V.meta[1][0].data);switch(D){case 2032:var te=Or(V.data);(ie=te==null?void 0:te[2])!=null&&ie[0]&&!M.l&&(M.l=fc(te[2][0].data));break;case 2039:break;default:console.log("unrecognized ObjectAttribute type ".concat(D))}}})}}break;case 2:f[b]=Or(y[6][0].data);break;case 3:f[b]=Or(y[5][0].data);break;case 10:{var L=t[hi(y[10][0].data)][0];f[b]=I7(t,L.data)}break;default:throw s}}}),f}function vke(t,n){var a,s,c,f,d,p,g,y,b,E,T,S,I,A,M=Or(t),F=wi(M[1][0].data)>>>0,L=wi(M[2][0].data)>>>0,O=((s=(a=M[8])==null?void 0:a[0])==null?void 0:s.data)&&wi(M[8][0].data)>0||!1,N,Q;if((f=(c=M[7])==null?void 0:c[0])!=null&&f.data&&n!=0)N=(p=(d=M[7])==null?void 0:d[0])==null?void 0:p.data,Q=(y=(g=M[6])==null?void 0:g[0])==null?void 0:y.data;else if((E=(b=M[4])==null?void 0:b[0])!=null&&E.data&&n!=1)N=(S=(T=M[4])==null?void 0:T[0])==null?void 0:S.data,Q=(A=(I=M[3])==null?void 0:I[0])==null?void 0:A.data;else throw"NUMBERS Tile missing ".concat(n," cell storage");for(var ie=O?4:1,j=tf(N),V=[],D=0;D<N.length/2;++D){var te=j.getUint16(D*2,!0);te<65535&&V.push([D,te])}if(V.length!=L)throw"Expected ".concat(L," cells, found ").concat(V.length);var ue=[];for(D=0;D<V.length-1;++D)ue[V[D][0]]=Q[ja](V[D][1]*ie,V[D+1][1]*ie);return V.length>=1&&(ue[V[V.length-1][0]]=Q[ja](V[V.length-1][1]*ie)),{R:F,cells:ue}}function yke(t,n){var a,s=Or(n.data),c=-1;(a=s==null?void 0:s[7])!=null&&a[0]&&(wi(s[7][0].data)>>>0?c=1:c=0);var f=tp(s[5],function(d){return vke(d,c)});return{nrows:wi(s[4][0].data)>>>0,data:f.reduce(function(d,p){return d[p.R]||(d[p.R]=[]),p.cells.forEach(function(g,y){if(d[p.R][y])throw new Error("Duplicate cell r=".concat(p.R," c=").concat(y));d[p.R][y]=g}),d},[])}}function I7(t,n){var a,s,c,f,d,p,g,y,b,E,T={t:"",a:""},S=Or(n);if((s=(a=S==null?void 0:S[1])==null?void 0:a[0])!=null&&s.data&&(T.t=fc((f=(c=S==null?void 0:S[1])==null?void 0:c[0])==null?void 0:f.data)||""),(p=(d=S==null?void 0:S[3])==null?void 0:d[0])!=null&&p.data){var I=t[hi((y=(g=S==null?void 0:S[3])==null?void 0:g[0])==null?void 0:y.data)][0],A=Or(I.data);(E=(b=A[1])==null?void 0:b[0])!=null&&E.data&&(T.a=fc(A[1][0].data))}return S!=null&&S[4]&&(T.replies=[],S[4].forEach(function(M){var F=t[hi(M.data)][0];T.replies.push(I7(t,F.data))})),T}function xke(t){var n=[];return n.push({t:t.t||"",a:t.a,T:t.replies&&t.replies.length>0}),t.replies&&t.replies.forEach(function(a){n.push({t:a.t||"",a:a.a,T:!0})}),n}function bke(t){for(var n={a:"",t:"",replies:[]},a=0;a<t.length;++a)a==0?(n.a=t[a].a,n.t=t[a].t):n.replies.push({a:t[a].a,t:t[a].t});return n}function wke(t,n,a,s){var c,f,d,p,g,y,b,E,T,S=Or(n.data),I={s:{r:0,c:0},e:{r:0,c:0}};if(I.e.r=(wi(S[6][0].data)>>>0)-1,I.e.r<0)throw new Error("Invalid row varint ".concat(S[6][0].data));if(I.e.c=(wi(S[7][0].data)>>>0)-1,I.e.c<0)throw new Error("Invalid col varint ".concat(S[7][0].data));a["!ref"]=Xn(I);var A=a["!data"]!=null,M=a,F=Or(S[4][0].data),L=pke();(c=F[4])!=null&&c[0]&&(L.sst=Ed(t,t[hi(F[4][0].data)][0])),(f=F[6])!=null&&f[0]&&(L.fmla=Ed(t,t[hi(F[6][0].data)][0])),(d=F[11])!=null&&d[0]&&(L.ofmt=Ed(t,t[hi(F[11][0].data)][0])),(p=F[12])!=null&&p[0]&&(L.ferr=Ed(t,t[hi(F[12][0].data)][0])),(g=F[17])!=null&&g[0]&&(L.rsst=Ed(t,t[hi(F[17][0].data)][0])),(y=F[19])!=null&&y[0]&&(L.cmnt=Ed(t,t[hi(F[19][0].data)][0])),(b=F[22])!=null&&b[0]&&(L.nfmt=Ed(t,t[hi(F[22][0].data)][0]));var O=Or(F[3][0].data),N=0;if(O[1].forEach(function(j){var V=Or(j.data),D=t[hi(V[2][0].data)][0],te=wi(D.meta[1][0].data);if(te!=6002)throw new Error("6001 unexpected reference to ".concat(te));var ue=yke(t,D);ue.data.forEach(function(J,le){J.forEach(function(re,Fe){var Ye=_ke(re,L,s);Ye&&(A?(M["!data"][N+le]||(M["!data"][N+le]=[]),M["!data"][N+le][Fe]=Ye):a[Qn(Fe)+vi(N+le)]=Ye)})}),N+=ue.nrows}),(E=F[13])!=null&&E[0]){var Q=t[hi(F[13][0].data)][0],ie=wi(Q.meta[1][0].data);if(ie!=6144)throw new Error("Expected merge type 6144, found ".concat(ie));a["!merges"]=(T=Or(Q.data))==null?void 0:T[1].map(function(j){var V=Or(j.data),D=tf(Or(V[1][0].data)[1][0].data),te=tf(Or(V[2][0].data)[1][0].data);return{s:{r:D.getUint16(0,!0),c:D.getUint16(2,!0)},e:{r:D.getUint16(0,!0)+te.getUint16(0,!0)-1,c:D.getUint16(2,!0)+te.getUint16(2,!0)-1}}})}}function Eke(t,n,a){var s=Or(n.data),c={"!ref":"A1"};a!=null&&a.dense&&(c["!data"]=[]);var f=t[hi(s[2][0].data)],d=wi(f[0].meta[1][0].data);if(d!=6001)throw new Error("6000 unexpected reference to ".concat(d));return wke(t,f[0],c,a),c}function Tke(t,n,a){var s,c=Or(n.data),f={name:(s=c[1])!=null&&s[0]?fc(c[1][0].data):"",sheets:[]},d=tp(c[2],hi);return d.forEach(function(p){t[p].forEach(function(g){var y=wi(g.meta[1][0].data);y==6e3&&f.sheets.push(Eke(t,g,a))})}),f}function Ske(t,n,a){var s,c=n3();c.Workbook={WBProps:{date1904:!0}};var f=Or(n.data);if((s=f[2])!=null&&s[0])throw new Error("Keynote presentations are not supported");var d=tp(f[1],hi);if(d.forEach(function(p){t[p].forEach(function(g){var y=wi(g.meta[1][0].data);if(y==2){var b=Tke(t,g,a);b.sheets.forEach(function(E,T){_w(c,E,T==0?b.name:b.name+"_"+T,!0)})}})}),c.SheetNames.length==0)throw new Error("Empty NUMBERS file");return c.bookType="numbers",c}function CS(t,n){var a,s,c,f,d,p,g,y={},b=[];if(t.FullPaths.forEach(function(T){if(T.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),t.FileIndex.forEach(function(T){if(T.name.match(/\.iwa$/)&&T.content[0]==0){var S;try{S=av(T.content)}catch(A){return console.log("?? "+T.content.length+" "+(A.message||A))}var I;try{I=iv(S)}catch(A){return console.log("## "+(A.message||A))}I.forEach(function(A){y[A.id]=A.messages,b.push(A.id)})}}),!b.length)throw new Error("File has no messages");if((c=(s=(a=y==null?void 0:y[1])==null?void 0:a[0].meta)==null?void 0:s[1])!=null&&c[0].data&&wi(y[1][0].meta[1][0].data)==1e4)throw new Error("Pages documents are not supported");var E=((g=(p=(d=(f=y==null?void 0:y[1])==null?void 0:f[0])==null?void 0:d.meta)==null?void 0:p[1])==null?void 0:g[0].data)&&wi(y[1][0].meta[1][0].data)==1&&y[1][0];if(E||b.forEach(function(T){y[T].forEach(function(S){var I=wi(S.meta[1][0].data)>>>0;if(I==1)if(!E)E=S;else throw new Error("Document has multiple roots")})}),!E)throw new Error("Cannot find Document root");return Ske(y,E,n)}function Cke(t,n,a){var s,c,f,d=[[],[{type:0,data:en(0)}],[{type:0,data:en(0)}],[{type:2,data:new Uint8Array([])}],[{type:2,data:new Uint8Array(Array.from({length:510},function(){return 255}))}],[{type:0,data:en(5)}],[{type:2,data:new Uint8Array([])}],[{type:2,data:new Uint8Array(Array.from({length:510},function(){return 255}))}],[{type:0,data:en(1)}]];if(!((s=d[6])!=null&&s[0])||!((c=d[7])!=null&&c[0]))throw"Mutation only works on post-BNC storages!";var p=0;if(d[7][0].data.length<2*t.length){var g=new Uint8Array(2*t.length);g.set(d[7][0].data),d[7][0].data=g}if(d[4][0].data.length<2*t.length){var y=new Uint8Array(2*t.length);y.set(d[4][0].data),d[4][0].data=y}for(var b=tf(d[7][0].data),E=0,T=[],S=tf(d[4][0].data),I=0,A=[],M=a?4:1,F=0;F<t.length;++F){if(t[F]==null||t[F].t=="z"&&!((f=t[F].c)!=null&&f.length)||t[F].t=="e"){b.setUint16(F*2,65535,!0),S.setUint16(F*2,65535);continue}b.setUint16(F*2,E/M,!0),S.setUint16(F*2,I/M,!0);var L,O;switch(t[F].t){case"d":if(t[F].v instanceof Date){L=TS(t[F],n),O=SS(t[F],n);break}L=TS(t[F],n),O=SS(t[F],n);break;case"s":case"n":case"b":case"z":L=TS(t[F],n),O=SS(t[F],n);break;default:throw new Error("Unsupported value "+t[F])}T.push(L),E+=L.length,A.push(O),I+=O.length,++p}for(d[2][0].data=en(p),d[5][0].data=en(5);F<d[7][0].data.length/2;++F)b.setUint16(F*2,65535,!0),S.setUint16(F*2,65535,!0);return d[6][0].data=Mh(T),d[3][0].data=Mh(A),d[8]=[{type:0,data:en(a?1:0)}],d}function VC(t,n){return{meta:[[],[{type:0,data:en(t)}]],data:n}}function Jc(t,n){n.last||(n.last=927262);for(var a=n.last;a<2e6;++a)if(!n[a])return n[n.last=a]=t,a;throw new Error("Too many messages")}function Ake(t){var n={},a=[];return t.FileIndex.map(function(s,c){return[s,t.FullPaths[c]]}).forEach(function(s){var c=s[0],f=s[1];c.type==2&&c.name.match(/\.iwa/)&&c.content[0]==0&&iv(av(c.content)).forEach(function(d){a.push(d.id),n[d.id]={deps:[],location:f,type:wi(d.messages[0].meta[1][0].data)}})}),t.FileIndex.forEach(function(s){s.name.match(/\.iwa/)&&s.content[0]==0&&iv(av(s.content)).forEach(function(c){c.messages.forEach(function(f){[5,6].forEach(function(d){f.meta[d]&&f.meta[d].forEach(function(p){n[c.id].deps.push(wi(p.data))})})})})}),n}function dx(t,n,a){return cn([[],[{type:0,data:en(1)}],[],[{type:5,data:new Uint8Array(Float32Array.from([t/255]).buffer)}],[{type:5,data:new Uint8Array(Float32Array.from([n/255]).buffer)}],[{type:5,data:new Uint8Array(Float32Array.from([a/255]).buffer)}],[{type:5,data:new Uint8Array(Float32Array.from([1]).buffer)}],[],[],[],[],[],[{type:0,data:en(1)}]])}function N6(t){switch(t){case 0:return dx(99,222,171);case 1:return dx(162,197,240);case 2:return dx(255,189,189)}return dx(Math.random()*255,Math.random()*255,Math.random()*255)}function kke(t,n){if(!n||!n.numbers)throw new Error("Must pass a `numbers` option -- check the README");var a=_n.read(n.numbers,{type:"base64"}),s=Ake(a),c=Qc(a,s,1);if(c==null)throw"Could not find message ".concat(1," in Numbers template");var f=tp(Or(c.messages[0].data)[1],hi);if(f.length>1)throw new Error("Template NUMBERS file must have exactly one sheet");return t.SheetNames.forEach(function(d,p){p>=1&&(Mke(a,s,p+1),c=Qc(a,s,1),f=tp(Or(c.messages[0].data)[1],hi)),Fke(a,s,t.Sheets[d],d,p,f[p])}),a}function ia(t,n,a,s){var c=_n.find(t,n[a].location);if(!c)throw"Could not find ".concat(n[a].location," in Numbers template");var f=iv(av(c.content)),d=f.find(function(p){return p.id==a});s(d,f),c.content=D0(L0(f)),c.size=c.content.length}function Qc(t,n,a){var s=_n.find(t,n[a].location);if(!s)throw"Could not find ".concat(n[a].location," in Numbers template");var c=iv(av(s.content)),f=c.find(function(d){return d.id==a});return f}function jC(t,n,a){t[3].push({type:2,data:cn([[],[{type:0,data:en(n)}],[{type:2,data:ss(a.replace(/-.*$/,""))}],[{type:2,data:ss(a)}],[{type:2,data:new Uint8Array([2,0,0])}],[{type:2,data:new Uint8Array([2,0,0])}],[],[],[],[],[{type:0,data:en(0)}],[],[{type:0,data:en(0)}]])}),t[1]=[{type:0,data:en(Math.max(n+1,wi(t[1][0].data)))}]}function Td(t,n,a,s,c,f){f||(f=Jc({deps:[],location:"",type:n},c));var d="".concat(s,"-").concat(f,".iwa");c[f].location="Root Entry"+d,_n.utils.cfb_add(t,d,D0(L0([{id:f,messages:[VC(n,cn(a))]}])));var p=d.replace(/^[\/]/,"").replace(/^Index\//,"").replace(/\.iwa$/,"");return ia(t,c,2,function(g){var y=Or(g.messages[0].data);jC(y,f||0,p),g.messages[0].data=cn(y)}),f}function Ps(t,n,a,s){var c=n[a].location.replace(/^Root Entry\//,"").replace(/^Index\//,"").replace(/\.iwa$/,""),f=t[3].findIndex(function(p){var g,y,b=Or(p.data);return(g=b[3])!=null&&g[0]?fc(b[3][0].data)==c:!!((y=b[2])!=null&&y[0]&&fc(b[2][0].data)==c)}),d=Or(t[3][f].data);d[6]||(d[6]=[]),(Array.isArray(s)?s:[s]).forEach(function(p){d[6].push({type:2,data:cn([[],[{type:0,data:en(p)}]])})}),t[3][f].data=cn(d)}function Ike(t,n,a,s){var c=n[a].location.replace(/^Root Entry\//,"").replace(/^Index\//,"").replace(/\.iwa$/,""),f=t[3].findIndex(function(p){var g,y,b=Or(p.data);return(g=b[3])!=null&&g[0]?fc(b[3][0].data)==c:!!((y=b[2])!=null&&y[0]&&fc(b[2][0].data)==c)}),d=Or(t[3][f].data);d[6]||(d[6]=[]),d[6]=d[6].filter(function(p){return wi(Or(p.data)[1][0].data)!=s}),t[3][f].data=cn(d)}function Mke(t,n,a){var s=-1,c=-1,f={};ia(t,n,1,function(g,y){var b=Or(g.messages[0].data);s=hi(Or(g.messages[0].data)[1][0].data),c=Jc({deps:[1],location:n[s].location,type:2},n),f[s]=c,Ro(g,c),b[1].push({type:2,data:Lo(c)});var E=Qc(t,n,s);E.id=c,n[1].location==n[c].location?y.push(E):ia(t,n,c,function(T,S){return S.push(E)}),g.messages[0].data=cn(b)});var d=-1;ia(t,n,c,function(g,y){for(var b=Or(g.messages[0].data),E=3;E<=69;++E)delete b[E];var T=tp(b[2],hi);T.forEach(function(I){return Nu(g,I)}),d=Jc({deps:[c],location:n[T[0]].location,type:n[T[0]].type},n),Ro(g,d),f[T[0]]=d,b[2]=[{type:2,data:Lo(d)}];var S=Qc(t,n,T[0]);S.id=d,n[T[0]].location==n[c].location?y.push(S):(ia(t,n,2,function(I){var A=Or(I.messages[0].data);Ps(A,n,c,d),I.messages[0].data=cn(A)}),ia(t,n,d,function(I,A){return A.push(S)})),g.messages[0].data=cn(b)});var p=-1;ia(t,n,d,function(g,y){for(var b=Or(g.messages[0].data),E=Or(b[1][0].data),T=3;T<=69;++T)delete E[T];var S=hi(E[2][0].data);E[2][0].data=Lo(f[S]),b[1][0].data=cn(E);var I=hi(b[2][0].data);Nu(g,I),p=Jc({deps:[d],location:n[I].location,type:n[I].type},n),Ro(g,p),f[I]=p,b[2][0].data=Lo(p);var A=Qc(t,n,I);A.id=p,n[d].location==n[p].location?y.push(A):ia(t,n,p,function(M,F){return F.push(A)}),g.messages[0].data=cn(b)}),ia(t,n,p,function(g,y){var b,E,T=Or(g.messages[0].data),S=fc(T[1][0].data),I=S.replace(/-[A-Z0-9]*/,"-".concat(("0000"+a.toString(16)).slice(-4)));if(T[1][0].data=ss(I),[12,13,29,31,32,33,39,44,47,81,82,84].forEach(function(Q){return delete T[Q]}),T[45]){var A=Or(T[45][0].data),M=hi(A[1][0].data);Nu(g,M),delete T[45]}if(T[70]){var F=Or(T[70][0].data);(b=F[2])==null||b.forEach(function(Q){var ie=Or(Q.data);[2,3].map(function(j){return ie[j][0]}).forEach(function(j){var V=Or(j.data);if(V[8]){var D=hi(V[8][0].data);Nu(g,D)}})}),delete T[70]}[46,30,34,35,36,38,48,49,60,61,62,63,64,71,72,73,74,75,85,86,87,88,89].forEach(function(Q){if(T[Q]){var ie=hi(T[Q][0].data);delete T[Q],Nu(g,ie)}});var L=Or(T[4][0].data);{[2,4,5,6,11,12,13,15,16,17,18,19,20,21,22].forEach(function(Q){var ie;if((ie=L[Q])!=null&&ie[0]){var j=hi(L[Q][0].data),V=Jc({deps:[p],location:n[j].location,type:n[j].type},n);Nu(g,j),Ro(g,V),f[j]=V;var D=Qc(t,n,j);if(D.id=V,n[j].location==n[p].location)y.push(D);else{n[V].location=n[j].location.replace(j.toString(),V.toString()),n[V].location==n[j].location&&(n[V].location=n[V].location.replace(/\.iwa/,"-".concat(V,".iwa"))),_n.utils.cfb_add(t,n[V].location,D0(L0([D])));var te=n[V].location.replace(/^Root Entry\//,"").replace(/^Index\//,"").replace(/\.iwa$/,"");ia(t,n,2,function(ue){var J=Or(ue.messages[0].data);jC(J,V,te),Ps(J,n,p,V),ue.messages[0].data=cn(J)})}L[Q][0].data=Lo(V)}});var O=Or(L[1][0].data);(E=O[2])==null||E.forEach(function(Q){var ie=hi(Q.data),j=Jc({deps:[p],location:n[ie].location,type:n[ie].type},n);Nu(g,ie),Ro(g,j),f[ie]=j;var V=Qc(t,n,ie);if(V.id=j,n[ie].location==n[p].location)y.push(V);else{n[j].location=n[ie].location.replace(ie.toString(),j.toString()),n[j].location==n[ie].location&&(n[j].location=n[j].location.replace(/\.iwa/,"-".concat(j,".iwa"))),_n.utils.cfb_add(t,n[j].location,D0(L0([V])));var D=n[j].location.replace(/^Root Entry\//,"").replace(/^Index\//,"").replace(/\.iwa$/,"");ia(t,n,2,function(te){var ue=Or(te.messages[0].data);jC(ue,j,D),Ps(ue,n,p,j),te.messages[0].data=cn(ue)})}Q.data=Lo(j)}),L[1][0].data=cn(O);var N=Or(L[3][0].data);N[1].forEach(function(Q){var ie=Or(Q.data),j=hi(ie[2][0].data),V=f[j];if(!f[j]){V=Jc({deps:[p],location:"",type:n[j].type},n),n[V].location="Root Entry/Index/Tables/Tile-".concat(V,".iwa"),f[j]=V;var D=Qc(t,n,j);D.id=V,Nu(g,j),Ro(g,V),_n.utils.cfb_add(t,"/Index/Tables/Tile-".concat(V,".iwa"),D0(L0([D]))),ia(t,n,2,function(te){var ue=Or(te.messages[0].data);ue[3].push({type:2,data:cn([[],[{type:0,data:en(V)}],[{type:2,data:ss("Tables/Tile")}],[{type:2,data:ss("Tables/Tile-".concat(V))}],[{type:2,data:new Uint8Array([2,0,0])}],[{type:2,data:new Uint8Array([2,0,0])}],[],[],[],[],[{type:0,data:en(0)}],[],[{type:0,data:en(0)}]])}),ue[1]=[{type:0,data:en(Math.max(V+1,wi(ue[1][0].data)))}],Ps(ue,n,p,V),te.messages[0].data=cn(ue)})}ie[2][0].data=Lo(V),Q.data=cn(ie)}),L[3][0].data=cn(N)}T[4][0].data=cn(L),g.messages[0].data=cn(T)})}function Fke(t,n,a,s,c,f){var d=[];ia(t,n,f,function(y){var b=Or(y.messages[0].data);b[1]=[{type:2,data:ss(s)}],d=tp(b[2],hi),y.messages[0].data=cn(b)});var p=Qc(t,n,d[0]),g=hi(Or(p.messages[0].data)[2][0].data);ia(t,n,g,function(y,b){return Oke(t,n,a,y,b,g)})}var Pke=!0;function Oke(t,n,a,s,c,f){var d=ho(a["!ref"]);d.s.r=d.s.c=0;var p=!1;d.e.c>999&&(p=!0,d.e.c=999),d.e.r>999999&&(p=!0,d.e.r=999999),p&&console.error("Truncating to ".concat(Xn(d)));var g=[];if(a["!data"])g=a["!data"];else{for(var y=[],b=0;b<=d.e.c;++b)y[b]=Qn(b);for(var E=0;E<=d.e.r;++E){g[E]=[];var T=""+(E+1);for(b=0;b<=d.e.c;++b){var S=a[y[b]+T];S&&(g[E][b]=S)}}}var I={cmnt:[{a:"~54ee77S~",t:"... the people who are crazy enough to think they can change the world, are the ones who do."}],ferr:[],fmla:[],nfmt:[],ofmt:[],rsst:[{v:"~54ee77S~",l:"https://sheetjs.com/"}],sst:["~Sh33tJ5~"]},A=Or(s.messages[0].data);{A[6][0].data=en(d.e.r+1),A[7][0].data=en(d.e.c+1),delete A[46];var M=Or(A[4][0].data);{var F=hi(Or(M[1][0].data)[2][0].data);ia(t,n,F,function(Pe,rt){var et,Ge=Or(Pe.messages[0].data);if((et=Ge==null?void 0:Ge[2])!=null&&et[0])for(var ze=0;ze<g.length;++ze){var oe=Or(Ge[2][0].data);oe[1][0].data=en(ze),oe[4][0].data=en(g[ze].length),Ge[2][ze]={type:Ge[2][0].type,data:cn(oe)}}Pe.messages[0].data=cn(Ge)});var L=hi(M[2][0].data);ia(t,n,L,function(Pe,rt){for(var et=Or(Pe.messages[0].data),Ge=0;Ge<=d.e.c;++Ge){var ze=Or(et[2][0].data);ze[1][0].data=en(Ge),ze[4][0].data=en(d.e.r+1),et[2][Ge]={type:et[2][0].type,data:cn(ze)}}Pe.messages[0].data=cn(et)});var O=Or(M[9][0].data);O[1]=[];var N=Or(M[3][0].data);{var Q=256;N[2]=[{type:0,data:en(Q)}];var ie=hi(Or(N[1][0].data)[2][0].data),j=function(){var Pe=Qc(t,n,2),rt=Or(Pe.messages[0].data),et=rt[3].filter(function(Ge){return wi(Or(Ge.data)[1][0].data)==ie});return et!=null&&et.length?wi(Or(et[0].data)[12][0].data):0}();_n.utils.cfb_del(t,n[ie].location),ia(t,n,2,function(Pe){var rt=Or(Pe.messages[0].data);rt[3]=rt[3].filter(function(et){return wi(Or(et.data)[1][0].data)!=ie}),Ike(rt,n,f,ie),Pe.messages[0].data=cn(rt)}),Nu(s,ie),N[1]=[];for(var V=Math.ceil((d.e.r+1)/Q),D=0;D<V;++D){var te=Jc({deps:[],location:"",type:6002},n);n[te].location="Root Entry/Index/Tables/Tile-".concat(te,".iwa");for(var ue=[[],[{type:0,data:en(0)}],[{type:0,data:en(Math.min(d.e.r+1,(D+1)*Q))}],[{type:0,data:en(0)}],[{type:0,data:en(Math.min((D+1)*Q,d.e.r+1)-D*Q)}],[],[{type:0,data:en(5)}],[{type:0,data:en(1)}],[{type:0,data:en(1)}]],J=D*Q;J<=Math.min(d.e.r,(D+1)*Q-1);++J){var le=Cke(g[J],I,Pke);le[1][0].data=en(J-D*Q),ue[5].push({data:cn(le),type:2})}N[1].push({type:2,data:cn([[],[{type:0,data:en(D)}],[{type:2,data:Lo(te)}]])});var re={id:te,messages:[VC(6002,cn(ue))]},Fe=D0(L0([re]));_n.utils.cfb_add(t,"/Index/Tables/Tile-".concat(te,".iwa"),Fe),ia(t,n,2,function(Pe){var rt=Or(Pe.messages[0].data);rt[3].push({type:2,data:cn([[],[{type:0,data:en(te)}],[{type:2,data:ss("Tables/Tile")}],[{type:2,data:ss("Tables/Tile-".concat(te))}],[{type:2,data:new Uint8Array([2,0,0])}],[{type:2,data:new Uint8Array([2,0,0])}],[],[],[],[],[{type:0,data:en(0)}],[],[{type:0,data:en(j)}]])}),rt[1]=[{type:0,data:en(Math.max(te+1,wi(rt[1][0].data)))}],Ps(rt,n,f,te),Pe.messages[0].data=cn(rt)}),Ro(s,te),O[1].push({type:2,data:cn([[],[{type:0,data:en(D*Q)}],[{type:0,data:en(D)}]])})}}if(M[3][0].data=cn(N),M[9][0].data=cn(O),M[10]=[{type:2,data:new Uint8Array([])}],a["!merges"]){var Ye=Jc({type:6144,deps:[f],location:n[f].location},n);c.push({id:Ye,messages:[VC(6144,cn([[],a["!merges"].map(function(Pe){return{type:2,data:cn([[],[{type:2,data:cn([[],[{type:5,data:new Uint8Array(new Uint16Array([Pe.s.r,Pe.s.c]).buffer)}]])}],[{type:2,data:cn([[],[{type:5,data:new Uint8Array(new Uint16Array([Pe.e.r-Pe.s.r+1,Pe.e.c-Pe.s.c+1]).buffer)}]])}]])}})]))]}),M[13]=[{type:2,data:Lo(Ye)}],ia(t,n,2,function(Pe){var rt=Or(Pe.messages[0].data);Ps(rt,n,f,Ye),Pe.messages[0].data=cn(rt)}),Ro(s,Ye)}else delete M[13];var Ee=hi(M[4][0].data);ia(t,n,Ee,function(Pe){var rt=Or(Pe.messages[0].data);rt[3]=[],I.sst.forEach(function(et,Ge){Ge!=0&&rt[3].push({type:2,data:cn([[],[{type:0,data:en(Ge)}],[{type:0,data:en(1)}],[{type:2,data:ss(et)}]])})}),Pe.messages[0].data=cn(rt)});var ut=hi(M[17][0].data);if(ia(t,n,ut,function(Pe){var rt=Or(Pe.messages[0].data);rt[3]=[];var et=[904980,903835,903815,903845];I.rsst.forEach(function(Ge,ze){if(ze!=0){var oe=[[],[{type:0,data:new Uint8Array([5])}],[],[{type:2,data:ss(Ge.v)}]];oe[10]=[{type:0,data:new Uint8Array([1])}],oe[19]=[{type:2,data:new Uint8Array([10,6,8,0,18,2,101,110])}],oe[5]=[{type:2,data:new Uint8Array([10,8,8,0,18,4,8,155,149,55])}],oe[2]=[{type:2,data:new Uint8Array([8,148,158,55])}],oe[6]=[{type:2,data:new Uint8Array([10,6,8,0,16,0,24,0])}],oe[7]=[{type:2,data:new Uint8Array([10,8,8,0,18,4,8,135,149,55])}],oe[8]=[{type:2,data:new Uint8Array([10,8,8,0,18,4,8,165,149,55])}],oe[14]=[{type:2,data:new Uint8Array([10,6,8,0,16,0,24,0])}],oe[24]=[{type:2,data:new Uint8Array([10,6,8,0,16,0,24,0])}];var Me=Jc({deps:[],location:"",type:2001},n),fe=[];if(Ge.l){var pe=Td(t,2032,[[],[],[{type:2,data:ss(Ge.l)}]],"/Index/Tables/DataList",n);oe[11]=[];var ot=[[],[]];ot[1]||(ot[1]=[]),ot[1].push({type:2,data:cn([[],[{type:0,data:en(0)}],[{type:2,data:Lo(pe)}]])}),oe[11][0]={type:2,data:cn(ot)},fe.push(pe)}Td(t,2001,oe,"/Index/Tables/DataList",n,Me),ia(t,n,Me,function(ae){et.forEach(function(X){return Ro(ae,X)}),fe.forEach(function(X){return Ro(ae,X)})});var xe=Td(t,6218,[[],[{type:2,data:Lo(Me)}],[],[{type:2,data:new Uint8Array([13,255,255,255,0,18,10,16,255,255,1,24,255,255,255,255,7])}]],"/Index/Tables/DataList",n);ia(t,n,xe,function(ae){return Ro(ae,Me)}),rt[3].push({type:2,data:cn([[],[{type:0,data:en(ze)}],[{type:0,data:en(1)}],[],[],[],[],[],[],[{type:2,data:Lo(xe)}]])}),Ro(Pe,xe),ia(t,n,2,function(ae){var X=Or(ae.messages[0].data);Ps(X,n,ut,xe),Ps(X,n,xe,Me),Ps(X,n,Me,fe),Ps(X,n,Me,et),ae.messages[0].data=cn(X)})}}),Pe.messages[0].data=cn(rt)}),I.cmnt.length>1){var Ne=hi(M[19][0].data),He={},Oe=0;ia(t,n,Ne,function(Pe){var rt=Or(Pe.messages[0].data);rt[3]=[],I.cmnt.forEach(function(et,Ge){if(Ge!=0){var ze=[];et.replies&&et.replies.forEach(function(fe){He[fe.a||""]||(He[fe.a||""]=Td(t,212,[[],[{type:2,data:ss(fe.a||"")}],[{type:2,data:N6(++Oe)}],[],[{type:0,data:en(0)}]],"/Index/Tables/DataList",n));var pe=He[fe.a||""],ot=Td(t,3056,[[],[{type:2,data:ss(fe.t||"")}],[{type:2,data:cn([[],[{type:1,data:new Uint8Array([0,0,0,128,116,109,182,65])}]])}],[{type:2,data:Lo(pe)}]],"/Index/Tables/DataList",n);ia(t,n,ot,function(xe){return Ro(xe,pe)}),ze.push(ot),ia(t,n,2,function(xe){var ae=Or(xe.messages[0].data);Ps(ae,n,ot,pe),xe.messages[0].data=cn(ae)})}),He[et.a||""]||(He[et.a||""]=Td(t,212,[[],[{type:2,data:ss(et.a||"")}],[{type:2,data:N6(++Oe)}],[],[{type:0,data:en(0)}]],"/Index/Tables/DataList",n));var oe=He[et.a||""],Me=Td(t,3056,[[],[{type:2,data:ss(et.t||"")}],[{type:2,data:cn([[],[{type:1,data:new Uint8Array([0,0,0,128,116,109,182,65])}]])}],[{type:2,data:Lo(oe)}],ze.map(function(fe){return{type:2,data:Lo(fe)}}),[{type:2,data:cn([[],[{type:0,data:en(Ge)}],[{type:0,data:en(0)}]])}]],"/Index/Tables/DataList",n);ia(t,n,Me,function(fe){Ro(fe,oe),ze.forEach(function(pe){return Ro(fe,pe)})}),rt[3].push({type:2,data:cn([[],[{type:0,data:en(Ge)}],[{type:0,data:en(1)}],[],[],[],[],[],[],[],[{type:2,data:Lo(Me)}]])}),Ro(Pe,Me),ia(t,n,2,function(fe){var pe=Or(fe.messages[0].data);Ps(pe,n,Ne,Me),Ps(pe,n,Me,oe),ze.length&&Ps(pe,n,Me,ze),fe.messages[0].data=cn(pe)})}}),rt[2][0].data=en(I.cmnt.length+1),Pe.messages[0].data=cn(rt)})}}A[4][0].data=cn(M)}s.messages[0].data=cn(A)}function M7(t){return function(a){for(var s=0;s!=t.length;++s){var c=t[s];a[c[0]]===void 0&&(a[c[0]]=c[1]),c[2]==="n"&&(a[c[0]]=Number(a[c[0]]))}}}function Yk(t){M7([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(t)}function Jk(t){M7([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(t)}function Rke(t){return ni.WS.indexOf(t)>-1?"sheet":t==ni.CS?"chart":t==ni.DS?"dialog":t==ni.MS?"macro":t&&t.length?t:"sheet"}function Lke(t,n){if(!t)return 0;try{t=n.map(function(s){return s.id||(s.id=s.strRelID),[s.name,t["!id"][s.id].Target,Rke(t["!id"][s.id].Type)]})}catch{return null}return!t||t.length===0?null:t}function Dke(t,n,a,s,c,f,d,p){if(!(!t||!t["!legdrawel"])){var g=C0(t["!legdrawel"].Target,s),y=hs(a,g,!0);y&&R2e(Ki(y),t,p||[])}}function Bke(t,n,a,s,c,f,d,p,g,y,b,E){try{f[s]=d_(hs(t,a,!0),n);var T=Ka(t,n),S;switch(p){case"sheet":S=aAe(T,n,c,g,f[s],y,b,E);break;case"chart":if(S=oAe(T,n,c,g,f[s],y,b,E),!S||!S["!drawel"])break;var I=C0(S["!drawel"].Target,n),A=Y_(I),M=P2e(hs(t,I,!0),d_(hs(t,A,!0),I)),F=C0(M,I),L=Y_(F);S=ICe(hs(t,F,!0),F,g,d_(hs(t,L,!0),F),y,S);break;case"macro":S=sAe(T,n,c,g,f[s],y,b,E);break;case"dialog":S=lAe(T,n,c,g,f[s],y,b,E);break;default:throw new Error("Unrecognized sheet type "+p)}d[s]=S;var O=[],N=[];f&&f[s]&&Ma(f[s]).forEach(function(Q){var ie="";if(f[s][Q].Type==ni.CMNT){if(ie=C0(f[s][Q].Target,n),O=fAe(Ka(t,ie,!0),ie,g),!O||!O.length)return;w6(S,O,!1)}f[s][Q].Type==ni.TCMNT&&(ie=C0(f[s][Q].Target,n),N=N.concat(z2e(Ka(t,ie,!0),g)))}),N&&N.length&&w6(S,N,!0,g.people||[]),Dke(S,p,t,n,c,g,y,O)}catch(Q){if(g.WTF)throw Q}}function bl(t){return t.charAt(0)=="/"?t.slice(1):t}function F7(t,n){if(ym(),n=n||{},Yk(n),El(t,"META-INF/manifest.xml")||El(t,"objectdata.xml"))return L6(t,n);if(El(t,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof CS<"u"){if(t.FileIndex)return CS(t,n);var a=_n.utils.cfb_new();return j5(t).forEach(function(Fe){qn(a,Fe,VU(t,Fe))}),CS(a,n)}throw new Error("Unsupported NUMBERS file")}if(!El(t,"[Content_Types].xml")){if(El(t,"index.xml.gz"))throw new Error("Unsupported NUMBERS 08 file");if(El(t,"index.xml"))throw new Error("Unsupported NUMBERS 09 file");var s=_n.find(t,"Index.zip");if(s)return n=Qi(n),delete n.type,typeof s.content=="string"&&(n.type="binary"),typeof Bun<"u"&&Buffer.isBuffer(s.content)?lm(new Uint8Array(s.content),n):lm(s.content,n);throw new Error("Unsupported ZIP file")}var c=j5(t),f=gye(hs(t,"[Content_Types].xml")),d=!1,p,g;if(f.workbooks.length===0&&(g="xl/workbook.xml",Ka(t,g,!0)&&f.workbooks.push(g)),f.workbooks.length===0){if(g="xl/workbook.bin",!Ka(t,g,!0))throw new Error("Could not find workbook");f.workbooks.push(g),d=!0}f.workbooks[0].slice(-3)=="bin"&&(d=!0);var y={},b={};if(!n.bookSheets&&!n.bookProps){if(p_=[],f.sst)try{p_=uAe(Ka(t,bl(f.sst)),f.sst,n)}catch(Fe){if(n.WTF)throw Fe}n.cellStyles&&f.themes.length&&(y=H9(hs(t,f.themes[0].replace(/^\//,""),!0)||"",n)),f.style&&(b=cAe(Ka(t,bl(f.style)),f.style,y,n))}f.links.map(function(Fe){try{var Ye=d_(hs(t,Y_(bl(Fe))),Fe);return dAe(Ka(t,bl(Fe)),Ye,Fe,n)}catch{}});var E=iAe(Ka(t,bl(f.workbooks[0])),f.workbooks[0],n),T={},S="";f.coreprops.length&&(S=Ka(t,bl(f.coreprops[0]),!0),S&&(T=f9(S)),f.extprops.length!==0&&(S=Ka(t,bl(f.extprops[0]),!0),S&&Eye(S,T,n)));var I={};(!n.bookSheets||n.bookProps)&&f.custprops.length!==0&&(S=hs(t,bl(f.custprops[0]),!0),S&&(I=Sye(S,n)));var A={};if((n.bookSheets||n.bookProps)&&(E.Sheets?p=E.Sheets.map(function(Ye){return Ye.name}):T.Worksheets&&T.SheetNames.length>0&&(p=T.SheetNames),n.bookProps&&(A.Props=T,A.Custprops=I),n.bookSheets&&typeof p<"u"&&(A.SheetNames=p),n.bookSheets?A.SheetNames:n.bookProps))return A;p={};var M={};n.bookDeps&&f.calcchain&&(M=hAe(Ka(t,bl(f.calcchain)),f.calcchain));var F=0,L={},O,N;{var Q=E.Sheets;T.Worksheets=Q.length,T.SheetNames=[];for(var ie=0;ie!=Q.length;++ie)T.SheetNames[ie]=Q[ie].name}var j=d?"bin":"xml",V=f.workbooks[0].lastIndexOf("/"),D=(f.workbooks[0].slice(0,V+1)+"_rels/"+f.workbooks[0].slice(V+1)+".rels").replace(/^\//,"");El(t,D)||(D="xl/_rels/workbook."+j+".rels");var te=d_(hs(t,D,!0),D.replace(/_rels.*/,"s5s"));(f.metadata||[]).length>=1&&(n.xlmeta=pAe(Ka(t,bl(f.metadata[0])),f.metadata[0],n)),(f.people||[]).length>=1&&(n.people=N2e(Ka(t,bl(f.people[0])),n)),te&&(te=Lke(te,E.Sheets));var ue=Ka(t,"xl/worksheets/sheet.xml",!0)?1:0;e:for(F=0;F!=T.Worksheets;++F){var J="sheet";if(te&&te[F]?(O="xl/"+te[F][1].replace(/[\/]?xl\//,""),El(t,O)||(O=te[F][1]),El(t,O)||(O=D.replace(/_rels\/.*$/,"")+te[F][1]),J=te[F][2]):(O="xl/worksheets/sheet"+(F+1-ue)+"."+j,O=O.replace(/sheet0\./,"sheet.")),N=O.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),n&&n.sheets!=null)switch(typeof n.sheets){case"number":if(F!=n.sheets)continue e;break;case"string":if(T.SheetNames[F].toLowerCase()!=n.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(n.sheets)){for(var le=!1,re=0;re!=n.sheets.length;++re)typeof n.sheets[re]=="number"&&n.sheets[re]==F&&(le=1),typeof n.sheets[re]=="string"&&n.sheets[re].toLowerCase()==T.SheetNames[F].toLowerCase()&&(le=1);if(!le)continue e}}Bke(t,O,N,T.SheetNames[F],F,L,p,J,n,E,y,b)}return A={Directory:f,Workbook:E,Props:T,Custprops:I,Deps:M,Sheets:p,SheetNames:T.SheetNames,Strings:p_,Styles:b,Themes:y,SSF:Qi(pn)},n&&n.bookFiles&&(t.files?(A.keys=c,A.files=t.files):(A.keys=[],A.files={},t.FullPaths.forEach(function(Fe,Ye){Fe=Fe.replace(/^Root Entry[\/]/,""),A.keys.push(Fe),A.files[Fe]=t.FileIndex[Ye]}))),n&&n.bookVBA&&(f.vba.length>0?A.vbaraw=Ka(t,bl(f.vba[0]),!0):f.defaults&&f.defaults.bin===H2e&&(A.vbaraw=Ka(t,"xl/vbaProject.bin",!0))),A.bookType=d?"xlsb":"xlsx",A}function zke(t,n){var a=n||{},s="Workbook",c=_n.find(t,s);try{if(s="/!DataSpaces/Version",c=_n.find(t,s),!c||!c.content)throw new Error("ECMA-376 Encrypted file missing "+s);if(Kbe(c.content),s="/!DataSpaces/DataSpaceMap",c=_n.find(t,s),!c||!c.content)throw new Error("ECMA-376 Encrypted file missing "+s);var f=Jbe(c.content);if(f.length!==1||f[0].comps.length!==1||f[0].comps[0].t!==0||f[0].name!=="StrongEncryptionDataSpace"||f[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+s);if(s="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",c=_n.find(t,s),!c||!c.content)throw new Error("ECMA-376 Encrypted file missing "+s);var d=Qbe(c.content);if(d.length!=1||d[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+s);if(s="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",c=_n.find(t,s),!c||!c.content)throw new Error("ECMA-376 Encrypted file missing "+s);twe(c.content)}catch{}if(s="/EncryptionInfo",c=_n.find(t,s),!c||!c.content)throw new Error("ECMA-376 Encrypted file missing "+s);var p=rwe(c.content);if(s="/EncryptedPackage",c=_n.find(t,s),!c||!c.content)throw new Error("ECMA-376 Encrypted file missing "+s);if(p[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(p[1],c.content,a.password||"",a);if(p[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(p[1],c.content,a.password||"",a);throw new Error("File is password-protected")}function Nke(t,n){t&&!t.SSF&&(t.SSF=Qi(pn)),t&&t.SSF&&(ym(),wv(t.SSF),n.revssf=aw(t.SSF),n.revssf[t.SSF[65535]]=0,n.ssf=t.SSF),n.rels={},n.wbrels={},n.Strings=[],n.Strings.Count=0,n.Strings.Unique=0,m_?n.revStrings=new Map:(n.revStrings={},n.revStrings.foo=[],delete n.revStrings.foo);var a="bin",s=!0,c=zk();Jk(n=n||{});var f=wk(),d="",p=0;if(n.cellXfs=[],zh(n.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),d="docProps/core.xml",qn(f,d,h9(t.Props,n)),c.coreprops.push(d),$i(n.rels,2,d,ni.CORE_PROPS),d="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var g=[],y=0;y<t.SheetNames.length;++y)(t.Workbook.Sheets[y]||{}).Hidden!=2&&g.push(t.SheetNames[y]);t.Props.SheetNames=g}t.Props.Worksheets=t.Props.SheetNames.length,qn(f,d,m9(t.Props)),c.extprops.push(d),$i(n.rels,3,d,ni.EXT_PROPS),t.Custprops!==t.Props&&Ma(t.Custprops||{}).length>0&&(d="docProps/custom.xml",qn(f,d,g9(t.Custprops)),c.custprops.push(d),$i(n.rels,4,d,ni.CUST_PROPS));var b=["SheetJ5"];for(n.tcid=0,p=1;p<=t.SheetNames.length;++p){var E={"!id":{}},T=t.Sheets[t.SheetNames[p-1]],S=(T||{})["!type"]||"sheet";switch(S){case"chart":default:d="xl/worksheets/sheet"+p+"."+a,qn(f,d,ACe(p-1,n,t,E)),c.sheets.push(d),$i(n.wbrels,-1,"worksheets/sheet"+p+"."+a,ni.WS[0])}if(T){var I=T["!comments"],A=!1,M="";if(I&&I.length>0){var F=!1;I.forEach(function(O){O[1].forEach(function(N){N.T==!0&&(F=!0)})}),F&&(M="xl/threadedComments/threadedComment"+p+".xml",qn(f,M,q9(I,b,n)),c.threadedcomments.push(M),$i(E,-1,"../threadedComments/threadedComment"+p+".xml",ni.TCMNT)),M="xl/comments"+p+"."+a,qn(f,M,W2e(I)),c.comments.push(M),$i(E,-1,"../comments"+p+"."+a,ni.CMNT),A=!0}T["!legacy"]&&A&&qn(f,"xl/drawings/vmlDrawing"+p+".vml",G9(p,T["!comments"])),delete T["!comments"],delete T["!legacy"]}E["!id"].rId1&&qn(f,Y_(d),O0(E))}n.Strings!=null&&n.Strings.length>0&&(d="xl/sharedStrings."+a,qn(f,d,Zbe(n.Strings)),c.strs.push(d),$i(n.wbrels,-1,"sharedStrings."+a,ni.SST)),d="xl/workbook."+a,qn(f,d,nAe(t)),c.workbooks.push(d),$i(n.rels,1,d,ni.WB),d="xl/theme/theme1.xml";var L=Wk(t.Themes,n);return qn(f,d,L),c.themes.push(d),$i(n.wbrels,-1,"theme/theme1.xml",ni.THEME),d="xl/styles."+a,qn(f,d,Qwe(t,n)),c.styles.push(d),$i(n.wbrels,-1,"styles."+a,ni.STY),t.vbaraw&&s&&(d="xl/vbaProject.bin",qn(f,d,t.vbaraw),c.vba.push(d),$i(n.wbrels,-1,"vbaProject.bin",ni.VBA)),d="xl/metadata."+a,qn(f,d,S2e()),c.metadata.push(d),$i(n.wbrels,-1,"metadata."+a,ni.XLMETA),b.length>1&&(d="xl/persons/person.xml",qn(f,d,X9(b)),c.people.push(d),$i(n.wbrels,-1,"persons/person.xml",ni.PEOPLE)),qn(f,"[Content_Types].xml",c9(c,n)),qn(f,"_rels/.rels",O0(n.rels)),qn(f,"xl/_rels/workbook."+a+".rels",O0(n.wbrels)),delete n.revssf,delete n.ssf,f}function P7(t,n){t&&!t.SSF&&(t.SSF=Qi(pn)),t&&t.SSF&&(ym(),wv(t.SSF),n.revssf=aw(t.SSF),n.revssf[t.SSF[65535]]=0,n.ssf=t.SSF),n.rels={},n.wbrels={},n.Strings=[],n.Strings.Count=0,n.Strings.Unique=0,m_?n.revStrings=new Map:(n.revStrings={},n.revStrings.foo=[],delete n.revStrings.foo);var a="xml",s=X2e.indexOf(n.bookType)>-1,c=zk();Jk(n=n||{});var f=wk(),d="",p=0;if(n.cellXfs=[],zh(n.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),d="docProps/core.xml",qn(f,d,h9(t.Props,n)),c.coreprops.push(d),$i(n.rels,2,d,ni.CORE_PROPS),d="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var g=[],y=0;y<t.SheetNames.length;++y)(t.Workbook.Sheets[y]||{}).Hidden!=2&&g.push(t.SheetNames[y]);t.Props.SheetNames=g}t.Props.Worksheets=t.Props.SheetNames.length,qn(f,d,m9(t.Props)),c.extprops.push(d),$i(n.rels,3,d,ni.EXT_PROPS),t.Custprops!==t.Props&&Ma(t.Custprops||{}).length>0&&(d="docProps/custom.xml",qn(f,d,g9(t.Custprops)),c.custprops.push(d),$i(n.rels,4,d,ni.CUST_PROPS));var b=["SheetJ5"];for(n.tcid=0,p=1;p<=t.SheetNames.length;++p){var E={"!id":{}},T=t.Sheets[t.SheetNames[p-1]],S=(T||{})["!type"]||"sheet";switch(S){case"chart":default:d="xl/worksheets/sheet"+p+"."+a,qn(f,d,pSe(p-1,n,t,E)),c.sheets.push(d),$i(n.wbrels,-1,"worksheets/sheet"+p+"."+a,ni.WS[0])}if(T){var I=T["!comments"],A=!1,M="";if(I&&I.length>0){var F=!1;I.forEach(function(L){L[1].forEach(function(O){O.T==!0&&(F=!0)})}),F&&(M="xl/threadedComments/threadedComment"+p+".xml",qn(f,M,q9(I,b,n)),c.threadedcomments.push(M),$i(E,-1,"../threadedComments/threadedComment"+p+".xml",ni.TCMNT)),M="xl/comments"+p+"."+a,qn(f,M,B2e(I)),c.comments.push(M),$i(E,-1,"../comments"+p+"."+a,ni.CMNT),A=!0}T["!legacy"]&&A&&qn(f,"xl/drawings/vmlDrawing"+p+".vml",G9(p,T["!comments"])),delete T["!comments"],delete T["!legacy"]}E["!id"].rId1&&qn(f,Y_(d),O0(E))}return n.Strings!=null&&n.Strings.length>0&&(d="xl/sharedStrings."+a,qn(f,d,Wbe(n.Strings,n)),c.strs.push(d),$i(n.wbrels,-1,"sharedStrings."+a,ni.SST)),d="xl/workbook."+a,qn(f,d,$Ce(t)),c.workbooks.push(d),$i(n.rels,1,d,ni.WB),d="xl/theme/theme1.xml",qn(f,d,Wk(t.Themes,n)),c.themes.push(d),$i(n.wbrels,-1,"theme/theme1.xml",ni.THEME),d="xl/styles."+a,qn(f,d,Fwe(t,n)),c.styles.push(d),$i(n.wbrels,-1,"styles."+a,ni.STY),t.vbaraw&&s&&(d="xl/vbaProject.bin",qn(f,d,t.vbaraw),c.vba.push(d),$i(n.wbrels,-1,"vbaProject.bin",ni.VBA)),d="xl/metadata."+a,qn(f,d,A2e()),c.metadata.push(d),$i(n.wbrels,-1,"metadata."+a,ni.XLMETA),b.length>1&&(d="xl/persons/person.xml",qn(f,d,X9(b)),c.people.push(d),$i(n.wbrels,-1,"persons/person.xml",ni.PEOPLE)),qn(f,"[Content_Types].xml",c9(c,n)),qn(f,"_rels/.rels",O0(n.rels)),qn(f,"xl/_rels/workbook."+a+".rels",O0(n.wbrels)),delete n.revssf,delete n.ssf,f}function Qk(t,n){var a="";switch((n||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":a=ll(t.slice(0,12));break;case"binary":a=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(n&&n.type||"undefined"))}return[a.charCodeAt(0),a.charCodeAt(1),a.charCodeAt(2),a.charCodeAt(3),a.charCodeAt(4),a.charCodeAt(5),a.charCodeAt(6),a.charCodeAt(7)]}function Uke(t,n){return _n.find(t,"EncryptedPackage")?zke(t,n):Kk(t,n)}function $ke(t,n){var a,s=t,c=n||{};return c.type||(c.type=oi&&Buffer.isBuffer(t)?"buffer":"base64"),a=jU(s,c),F7(a,c)}function O7(t,n){var a=0;e:for(;a<t.length;)switch(t.charCodeAt(a)){case 10:case 13:case 32:++a;break;case 60:return UC(t.slice(a),n);default:break e}return om.to_workbook(t,n)}function Vke(t,n){var a="",s=Qk(t,n);switch(n.type){case"base64":a=ll(t);break;case"binary":a=t;break;case"buffer":a=t.toString("binary");break;case"array":a=Kd(t);break;default:throw new Error("Unrecognized type "+n.type)}return s[0]==239&&s[1]==187&&s[2]==191&&(a=Ki(a)),n.type="binary",O7(a,n)}function jke(t,n){var a=t;return n.type=="base64"&&(a=ll(a)),typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer&&(a=new Uint8Array(t)),a=typeof Jn<"u"?Jn.utils.decode(1200,a.slice(2),"str"):oi&&Buffer.isBuffer(t)?t.slice(2).toString("utf16le"):typeof Uint8Array<"u"&&a instanceof Uint8Array?typeof TextDecoder<"u"?new TextDecoder("utf-16le").decode(a.slice(2)):Mve(a.slice(2)):AU(a.slice(2)),n.type="binary",O7(a,n)}function Wke(t){return t.match(/[^\x00-\x7F]/)?tu(t):t}function AS(t,n,a,s){return s?(a.type="string",om.to_workbook(t,a)):om.to_workbook(n,a)}function lm(t,n){nw();var a=n||{};if(a.codepage&&typeof Jn>"u"&&console.error("Codepage tables are not loaded.  Non-ASCII characters may not give expected results"),typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer)return lm(new Uint8Array(t),(a=Qi(a),a.type="array",a));typeof Uint8Array<"u"&&t instanceof Uint8Array&&!a.type&&(a.type=typeof Deno<"u"?"buffer":"array");var s=t,c=[0,0,0,0],f=!1;if(a.cellStyles&&(a.cellNF=!0,a.sheetStubs=!0),R0={},a.dateNF&&(R0.dateNF=a.dateNF),a.type||(a.type=oi&&Buffer.isBuffer(t)?"buffer":"base64"),a.type=="file"&&(a.type=oi?"buffer":"binary",s=l1e(t),typeof Uint8Array<"u"&&!oi&&(a.type="array")),a.type=="string"&&(f=!0,a.type="binary",a.codepage=65001,s=Wke(t)),a.type=="array"&&typeof Uint8Array<"u"&&t instanceof Uint8Array&&typeof ArrayBuffer<"u"){var d=new ArrayBuffer(3),p=new Uint8Array(d);if(p.foo="bar",!p.foo)return a=Qi(a),a.type="array",lm(_k(s),a)}switch((c=Qk(s,a))[0]){case 208:if(c[1]===207&&c[2]===17&&c[3]===224&&c[4]===161&&c[5]===177&&c[6]===26&&c[7]===225)return Uke(_n.read(s,a),a);break;case 9:if(c[1]<=8)return Kk(s,a);break;case 60:return UC(s,a);case 73:if(c[1]===73&&c[2]===42&&c[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(c[1]===68)return Pbe(s,a);break;case 84:if(c[1]===65&&c[2]===66&&c[3]===76)return D9.to_workbook(s,a);break;case 80:return c[1]===75&&c[2]<9&&c[3]<9?$ke(s,a):AS(t,s,a,f);case 239:return c[3]===60?UC(s,a):AS(t,s,a,f);case 255:if(c[1]===254)return jke(s,a);if(c[1]===0&&c[2]===2&&c[3]===0)return $d.to_workbook(s,a);break;case 0:if(c[1]===0&&(c[2]>=2&&c[3]===0||c[2]===0&&(c[3]===8||c[3]===9)))return $d.to_workbook(s,a);break;case 3:case 131:case 139:case 140:return NC.to_workbook(s,a);case 123:if(c[1]===92&&c[2]===114&&c[3]===116)return pwe(s,a);break;case 10:case 13:case 32:return Vke(s,a);case 137:if(c[1]===80&&c[2]===78&&c[3]===71)throw new Error("PNG Image File is not a spreadsheet");break;case 8:if(c[1]===231)throw new Error("Unsupported Multiplan 1.x file!");break;case 12:if(c[1]===236)throw new Error("Unsupported Multiplan 2.x file!");if(c[1]===237)throw new Error("Unsupported Multiplan 3.x file!");break}return Fbe.indexOf(c[0])>-1&&c[2]<=12&&c[3]<=31?NC.to_workbook(s,a):AS(t,s,a,f)}function U6(t,n){var a=n||{};return a.type="file",lm(t,a)}function R7(t,n){switch(n.type){case"base64":case"binary":break;case"buffer":case"array":n.type="";break;case"file":return Ev(n.file,_n.write(t,{type:oi?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+n.bookType+"' files");default:throw new Error("Unrecognized type "+n.type)}return _n.write(t,n)}function Hke(t,n){switch(n.bookType){case"ods":return S7(t,n);case"numbers":return kke(t,n);case"xlsb":return Nke(t,n);default:return P7(t,n)}}function Gke(t,n){var a=Qi(n||{}),s=Hke(t,a);return L7(s,a)}function qke(t,n){var a=Qi(n||{}),s=P7(t,a);return L7(s,a)}function L7(t,n){var a={},s=oi?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(n.compression&&(a.compression="DEFLATE"),n.password)a.type=s;else switch(n.type){case"base64":a.type="base64";break;case"binary":a.type="string";break;case"string":throw new Error("'string' output type invalid for '"+n.bookType+"' files");case"buffer":case"file":a.type=s;break;default:throw new Error("Unrecognized type "+n.type)}var c=t.FullPaths?_n.write(t,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[a.type]||a.type,compression:!!n.compression}):t.generate(a);if(typeof Deno<"u"&&typeof c=="string"){if(n.type=="binary"||n.type=="base64")return c;c=new Uint8Array(bv(c))}return n.password&&typeof encrypt_agile<"u"?R7(encrypt_agile(c,n.password),n):n.type==="file"?Ev(n.file,c):n.type=="string"?Ki(c):c}function Xke(t,n){var a=n||{},s=$Ae(t,a);return R7(s,a)}function Kc(t,n,a){a||(a="");var s=a+t;switch(n.type){case"base64":return rb(tu(s));case"binary":return tu(s);case"string":return t;case"file":return Ev(n.file,s,"utf8");case"buffer":return oi?hu(s,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(s):Kc(s,{type:"binary"}).split("").map(function(c){return c.charCodeAt(0)})}throw new Error("Unrecognized type "+n.type)}function Zke(t,n){switch(n.type){case"base64":return Ove(t);case"binary":return t;case"string":return t;case"file":return Ev(n.file,t,"binary");case"buffer":return oi?hu(t,"binary"):t.split("").map(function(a){return a.charCodeAt(0)})}throw new Error("Unrecognized type "+n.type)}function px(t,n){switch(n.type){case"string":case"base64":case"binary":for(var a="",s=0;s<t.length;++s)a+=String.fromCharCode(t[s]);return n.type=="base64"?rb(a):n.type=="string"?Ki(a):a;case"file":return Ev(n.file,t);case"buffer":return t;default:throw new Error("Unrecognized type "+n.type)}}function e3(t,n){nw(),u7(t);var a=Qi(n||{});if(a.cellStyles&&(a.cellNF=!0,a.sheetStubs=!0),a.type=="array"){a.type="binary";var s=e3(t,a);return a.type="array",bv(s)}return qke(t,a)}function gw(t,n){nw(),u7(t);var a=Qi(n||{});if(a.cellStyles&&(a.cellNF=!0,a.sheetStubs=!0),a.type=="array"){a.type="binary";var s=gw(t,a);return a.type="array",bv(s)}var c=0;if(a.sheet&&(typeof a.sheet=="number"?c=a.sheet:c=t.SheetNames.indexOf(a.sheet),!t.SheetNames[c]))throw new Error("Sheet not found: "+a.sheet+" : "+typeof a.sheet);switch(a.bookType||"xlsb"){case"xml":case"xlml":return Kc(RAe(t,a),a);case"slk":case"sylk":return Kc(L9.from_sheet(t.Sheets[t.SheetNames[c]],a,t),a);case"htm":case"html":return Kc(x7(t.Sheets[t.SheetNames[c]],a),a);case"txt":return Zke(z7(t.Sheets[t.SheetNames[c]],a),a);case"csv":return Kc(r3(t.Sheets[t.SheetNames[c]],a),a,"\uFEFF");case"dif":return Kc(D9.from_sheet(t.Sheets[t.SheetNames[c]],a),a);case"dbf":return px(NC.from_sheet(t.Sheets[t.SheetNames[c]],a),a);case"prn":return Kc(om.from_sheet(t.Sheets[t.SheetNames[c]],a),a);case"rtf":return Kc(mwe(t.Sheets[t.SheetNames[c]]),a);case"eth":return Kc(B9.from_sheet(t.Sheets[t.SheetNames[c]],a),a);case"fods":return Kc(S7(t,a),a);case"wk1":return px($d.sheet_to_wk1(t.Sheets[t.SheetNames[c]],a),a);case"wk3":return px($d.book_to_wk3(t,a),a);case"biff2":a.biff||(a.biff=2);case"biff3":a.biff||(a.biff=3);case"biff4":return a.biff||(a.biff=4),px(m7(t,a),a);case"biff5":a.biff||(a.biff=5);case"biff8":case"xla":case"xls":return a.biff||(a.biff=8),Xke(t,a);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return Gke(t,a);default:throw new Error("Unrecognized bookType |"+a.bookType+"|")}}function t3(t){if(!t.bookType){var n={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},a=t.file.slice(t.file.lastIndexOf(".")).toLowerCase();a.match(/^\.[a-z]+$/)&&(t.bookType=a.slice(1)),t.bookType=n[t.bookType]||t.bookType}}function $6(t,n,a){var s=a||{};return s.type="file",s.file=n,t3(s),gw(t,s)}function Kke(t,n,a){var s=a||{};return s.type="file",s.file=n,t3(s),e3(t,s)}function Yke(t,n,a,s){var c=a||{};c.type="file",c.file=t,t3(c),c.type="buffer";var f=s;return f instanceof Function||(f=a),Wu.writeFile(t,gw(n,c),f)}function D7(t,n,a,s,c,f,d){var p=vi(a),g=d.defval,y=d.raw||!Object.prototype.hasOwnProperty.call(d,"raw"),b=!0,E=t["!data"]!=null,T=c===1?[]:{};if(c!==1)if(Object.defineProperty)try{Object.defineProperty(T,"__rowNum__",{value:a,enumerable:!1})}catch{T.__rowNum__=a}else T.__rowNum__=a;if(!E||t["!data"][a])for(var S=n.s.c;S<=n.e.c;++S){var I=E?(t["!data"][a]||[])[S]:t[s[S]+p];if(I==null||I.t===void 0){if(g===void 0)continue;f[S]!=null&&(T[f[S]]=g);continue}var A=I.v;switch(I.t){case"z":if(A==null)break;continue;case"e":A=A==0?null:void 0;break;case"s":case"b":case"n":if(!I.z||!cl(I.z)||(A=Zu(A),typeof A=="number"))break;case"d":d&&d.UTC||(A=Yd(A));break;default:throw new Error("unrecognized type "+I.t)}if(f[S]!=null){if(A==null)if(I.t=="e"&&A===null)T[f[S]]=null;else if(g!==void 0)T[f[S]]=g;else if(y&&A===null)T[f[S]]=null;else continue;else T[f[S]]=y&&(I.t!=="n"||I.t==="n"&&d.rawNumbers!==!1)?A:lu(I,A,d);A!=null&&(b=!1)}}return{row:T,isempty:b}}function WC(t,n){if(t==null||t["!ref"]==null)return[];var a={t:"n",v:0},s=0,c=1,f=[],d=0,p="",g={s:{r:0,c:0},e:{r:0,c:0}},y=n||{},b=y.range!=null?y.range:t["!ref"];switch(y.header===1?s=1:y.header==="A"?s=2:Array.isArray(y.header)?s=3:y.header==null&&(s=0),typeof b){case"string":g=Ei(b);break;case"number":g=Ei(t["!ref"]),g.s.r=b;break;default:g=b}s>0&&(c=0);var E=vi(g.s.r),T=[],S=[],I=0,A=0,M=t["!data"]!=null,F=g.s.r,L=0,O={};M&&!t["!data"][F]&&(t["!data"][F]=[]);var N=y.skipHidden&&t["!cols"]||[],Q=y.skipHidden&&t["!rows"]||[];for(L=g.s.c;L<=g.e.c;++L)if(!(N[L]||{}).hidden)switch(T[L]=Qn(L),a=M?t["!data"][F][L]:t[T[L]+E],s){case 1:f[L]=L-g.s.c;break;case 2:f[L]=T[L];break;case 3:f[L]=y.header[L-g.s.c];break;default:if(a==null&&(a={w:"__EMPTY",t:"s"}),p=d=lu(a,null,y),A=O[d]||0,!A)O[d]=1;else{do p=d+"_"+A++;while(O[p]);O[d]=A,O[p]=1}f[L]=p}for(F=g.s.r+c;F<=g.e.r;++F)if(!(Q[F]||{}).hidden){var ie=D7(t,g,F,T,s,f,y);(ie.isempty===!1||(s===1?y.blankrows!==!1:y.blankrows))&&(S[I++]=ie.row)}return S.length=I,S}var V6=/"/g;function B7(t,n,a,s,c,f,d,p){for(var g=!0,y=[],b="",E=vi(a),T=t["!data"]!=null,S=T&&t["!data"][a]||[],I=n.s.c;I<=n.e.c;++I)if(s[I]){var A=T?S[I]:t[s[I]+E];if(A==null)b="";else if(A.v!=null){g=!1,b=""+(p.rawNumbers&&A.t=="n"?A.v:lu(A,null,p));for(var M=0,F=0;M!==b.length;++M)if((F=b.charCodeAt(M))===c||F===f||F===34||p.forceQuotes){b='"'+b.replace(V6,'""')+'"';break}b=="ID"&&(b='"ID"')}else A.f!=null&&!A.F?(g=!1,b="="+A.f,b.indexOf(",")>=0&&(b='"'+b.replace(V6,'""')+'"')):b="";y.push(b)}return p.blankrows===!1&&g?null:y.join(d)}function r3(t,n){var a=[],s=n??{};if(t==null||t["!ref"]==null)return"";for(var c=Ei(t["!ref"]),f=s.FS!==void 0?s.FS:",",d=f.charCodeAt(0),p=s.RS!==void 0?s.RS:`
`,g=p.charCodeAt(0),y=new RegExp((f=="|"?"\\|":f)+"+$"),b="",E=[],T=s.skipHidden&&t["!cols"]||[],S=s.skipHidden&&t["!rows"]||[],I=c.s.c;I<=c.e.c;++I)(T[I]||{}).hidden||(E[I]=Qn(I));for(var A=0,M=c.s.r;M<=c.e.r;++M)(S[M]||{}).hidden||(b=B7(t,c,M,E,d,g,f,s),b!=null&&(s.strip&&(b=b.replace(y,"")),(b||s.blankrows!==!1)&&a.push((A++?p:"")+b)));return a.join("")}function z7(t,n){n||(n={}),n.FS="	",n.RS=`
`;var a=r3(t,n);if(typeof Jn>"u"||n.type=="string")return a;var s=Jn.utils.encode(1200,a,"str");return String.fromCharCode(255)+String.fromCharCode(254)+s}function Jke(t){var n="",a,s="";if(t==null||t["!ref"]==null)return[];var c=Ei(t["!ref"]),f="",d=[],p,g=[],y=t["!data"]!=null;for(p=c.s.c;p<=c.e.c;++p)d[p]=Qn(p);for(var b=c.s.r;b<=c.e.r;++b)for(f=vi(b),p=c.s.c;p<=c.e.c;++p)if(n=d[p]+f,a=y?(t["!data"][b]||[])[p]:t[n],s="",a!==void 0){if(a.F!=null){if(n=a.F,!a.f)continue;s=a.f,n.indexOf(":")==-1&&(n=n+":"+n)}if(a.f!=null)s=a.f;else{if(a.t=="z")continue;if(a.t=="n"&&a.v!=null)s=""+a.v;else if(a.t=="b")s=a.v?"TRUE":"FALSE";else if(a.w!==void 0)s="'"+a.w;else{if(a.v===void 0)continue;a.t=="s"?s="'"+a.v:s=""+a.v}}g[g.length]=n+"="+s}return g}function N7(t,n,a){var s=a||{},c=t?t["!data"]!=null:s.dense,f=+!s.skipHeader,d=t||{};!t&&c&&(d["!data"]=[]);var p=0,g=0;if(d&&s.origin!=null)if(typeof s.origin=="number")p=s.origin;else{var y=typeof s.origin=="string"?Yi(s.origin):s.origin;p=y.r,g=y.c}var b={s:{c:0,r:0},e:{c:g,r:p+n.length-1+f}};if(d["!ref"]){var E=Ei(d["!ref"]);b.e.c=Math.max(b.e.c,E.e.c),b.e.r=Math.max(b.e.r,E.e.r),p==-1&&(p=E.e.r+1,b.e.r=p+n.length-1+f)}else p==-1&&(p=0,b.e.r=n.length-1+f);var T=s.header||[],S=0,I=[];n.forEach(function(M,F){c&&!d["!data"][p+F+f]&&(d["!data"][p+F+f]=[]),c&&(I=d["!data"][p+F+f]),Ma(M).forEach(function(L){(S=T.indexOf(L))==-1&&(T[S=T.length]=L);var O=M[L],N="z",Q="",ie=c?"":Qn(g+S)+vi(p+F+f),j=c?I[g+S]:d[ie];O&&typeof O=="object"&&!(O instanceof Date)?c?I[g+S]=O:d[ie]=O:(typeof O=="number"?N="n":typeof O=="boolean"?N="b":typeof O=="string"?N="s":O instanceof Date?(N="d",s.UTC||(O=ow(O)),s.cellDates||(N="n",O=La(O)),Q=j!=null&&j.z&&cl(j.z)?j.z:s.dateNF||pn[14]):O===null&&s.nullError&&(N="e",O=0),j?(j.t=N,j.v=O,delete j.w,delete j.R,Q&&(j.z=Q)):c?I[g+S]=j={t:N,v:O}:d[ie]=j={t:N,v:O},Q&&(j.z=Q))})}),b.e.c=Math.max(b.e.c,g+T.length-1);var A=vi(p);if(c&&!d["!data"][p]&&(d["!data"][p]=[]),f)for(S=0;S<T.length;++S)c?d["!data"][p][S+g]={t:"s",v:T[S]}:d[Qn(S+g)+A]={t:"s",v:T[S]};return d["!ref"]=Xn(b),d}function Qke(t,n){return N7(null,t,n)}function ov(t,n,a){if(typeof n=="string"){if(t["!data"]!=null){var s=Yi(n);return t["!data"][s.r]||(t["!data"][s.r]=[]),t["!data"][s.r][s.c]||(t["!data"][s.r][s.c]={t:"z"})}return t[n]||(t[n]={t:"z"})}return typeof n!="number"?ov(t,ii(n)):ov(t,Qn(a||0)+vi(n))}function e3e(t,n){if(typeof n=="number"){if(n>=0&&t.SheetNames.length>n)return n;throw new Error("Cannot find sheet # "+n)}else if(typeof n=="string"){var a=t.SheetNames.indexOf(n);if(a>-1)return a;throw new Error("Cannot find sheet name |"+n+"|")}else throw new Error("Cannot find sheet |"+n+"|")}function n3(){return{SheetNames:[],Sheets:{}}}function _w(t,n,a,s){var c=1;if(!a)for(;c<=65535&&t.SheetNames.indexOf(a="Sheet"+c)!=-1;++c,a=void 0);if(!a||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(s&&t.SheetNames.indexOf(a)>=0){var f=a.match(/(^.*?)(\d+)$/);c=f&&+f[2]||0;var d=f&&f[1]||a;for(++c;c<=65535&&t.SheetNames.indexOf(a=d+c)!=-1;++c);}if(c7(a),t.SheetNames.indexOf(a)>=0)throw new Error("Worksheet with name |"+a+"| already exists!");return t.SheetNames.push(a),t.Sheets[a]=n,a}function t3e(t,n,a){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var s=e3e(t,n);switch(t.Workbook.Sheets[s]||(t.Workbook.Sheets[s]={}),a){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+a)}t.Workbook.Sheets[s].Hidden=a}function r3e(t,n){return t.z=n,t}function U7(t,n,a){return n?(t.l={Target:n},a&&(t.l.Tooltip=a)):delete t.l,t}function n3e(t,n,a){return U7(t,"#"+n,a)}function i3e(t,n,a){t.c||(t.c=[]),t.c.push({t:n,a:a||"SheetJS"})}function a3e(t,n,a,s){for(var c=typeof n!="string"?n:Ei(n),f=typeof n=="string"?n:Xn(n),d=c.s.r;d<=c.e.r;++d)for(var p=c.s.c;p<=c.e.c;++p){var g=ov(t,d,p);g.t="n",g.F=f,delete g.v,d==c.s.r&&p==c.s.c&&(g.f=a,s&&(g.D=!0))}var y=ho(t["!ref"]);return y.s.r>c.s.r&&(y.s.r=c.s.r),y.s.c>c.s.c&&(y.s.c=c.s.c),y.e.r<c.e.r&&(y.e.r=c.e.r),y.e.c<c.e.c&&(y.e.c=c.e.c),t["!ref"]=Xn(y),t}var o3e={encode_col:Qn,encode_row:vi,encode_cell:ii,encode_range:Xn,decode_col:Pk,decode_row:Fk,split_cell:q1e,decode_cell:Yi,decode_range:ho,format_cell:lu,sheet_add_aoa:n9,sheet_add_json:N7,sheet_add_dom:b7,aoa_to_sheet:bm,json_to_sheet:Qke,table_to_sheet:w7,table_to_book:oke,sheet_to_csv:r3,sheet_to_txt:z7,sheet_to_json:WC,sheet_to_html:x7,sheet_to_formulae:Jke,sheet_to_row_object_array:WC,sheet_get_cell:ov,book_new:n3,book_append_sheet:_w,book_set_sheet_visibility:t3e,cell_set_number_format:r3e,cell_set_hyperlink:U7,cell_set_internal_link:n3e,cell_add_comment:i3e,sheet_set_array_formula:a3e,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}},vw;function s3e(t){vw=t}function l3e(t,n){var a=vw(),s=n??{};if(t==null||t["!ref"]==null)return a.push(null),a;for(var c=Ei(t["!ref"]),f=s.FS!==void 0?s.FS:",",d=f.charCodeAt(0),p=s.RS!==void 0?s.RS:`
`,g=p.charCodeAt(0),y=new RegExp((f=="|"?"\\|":f)+"+$"),b="",E=[],T=s.skipHidden&&t["!cols"]||[],S=s.skipHidden&&t["!rows"]||[],I=c.s.c;I<=c.e.c;++I)(T[I]||{}).hidden||(E[I]=Qn(I));var A=c.s.r,M=!1,F=0;return a._read=function(){if(!M)return M=!0,a.push("\uFEFF");for(;A<=c.e.r;)if(++A,!(S[A-1]||{}).hidden&&(b=B7(t,c,A-1,E,d,g,f,s),b!=null&&(s.strip&&(b=b.replace(y,"")),b||s.blankrows!==!1)))return a.push((F++?p:"")+b);return a.push(null)},a}function c3e(t,n){var a=vw(),s=n||{},c=s.header!=null?s.header:_7,f=s.footer!=null?s.footer:v7;a.push(c);var d=ho(t["!ref"]);a.push(y7(t,d,s));var p=d.s.r,g=!1;return a._read=function(){if(p>d.e.r)return g||(g=!0,a.push("</table>"+f)),a.push(null);for(;p<=d.e.r;){a.push(g7(t,d,p,s)),++p;break}},a}function u3e(t,n){var a=vw({objectMode:!0});if(t==null||t["!ref"]==null)return a.push(null),a;var s={t:"n",v:0},c=0,f=1,d=[],p=0,g="",y={s:{r:0,c:0},e:{r:0,c:0}},b=n||{},E=b.range!=null?b.range:t["!ref"];switch(b.header===1?c=1:b.header==="A"?c=2:Array.isArray(b.header)&&(c=3),typeof E){case"string":y=Ei(E);break;case"number":y=Ei(t["!ref"]),y.s.r=E;break;default:y=E}c>0&&(f=0);var T=vi(y.s.r),S=[],I=0,A=t["!data"]!=null,M=y.s.r,F=0,L={};A&&!t["!data"][M]&&(t["!data"][M]=[]);var O=b.skipHidden&&t["!cols"]||[],N=b.skipHidden&&t["!rows"]||[];for(F=y.s.c;F<=y.e.c;++F)if(!(O[F]||{}).hidden)switch(S[F]=Qn(F),s=A?t["!data"][M][F]:t[S[F]+T],c){case 1:d[F]=F-y.s.c;break;case 2:d[F]=S[F];break;case 3:d[F]=b.header[F-y.s.c];break;default:if(s==null&&(s={w:"__EMPTY",t:"s"}),g=p=lu(s,null,b),I=L[p]||0,!I)L[p]=1;else{do g=p+"_"+I++;while(L[g]);L[p]=I,L[g]=1}d[F]=g}return M=y.s.r+f,a._read=function(){for(;M<=y.e.r;)if(!(N[M-1]||{}).hidden){var Q=D7(t,y,M,S,c,d,b);if(++M,Q.isempty===!1||(c===1?b.blankrows!==!1:b.blankrows)){a.push(Q.row);return}}return a.push(null)},a}var f3e={to_json:u3e,to_html:c3e,to_csv:l3e,set_readable:s3e};const A0={parse_xlscfb:Kk,parse_zip:F7,read:lm,readFile:U6,readFileSync:U6,write:gw,writeFile:$6,writeFileSync:$6,writeFileAsync:Yke,writeXLSX:e3,writeFileXLSX:Kke,utils:o3e,set_fs:s1e,set_cptable:Fve,stream:f3e,SSF:BU,CFB:_n},h3e={class:"content"},d3e={key:0,class:"box-area"},p3e=Ft({name:"importModule",components:{}}),m3e=Object.assign(p3e,{setup(t){const{proxy:n}=Tn(),a=Ze("type1"),s=Ze("opt1");Ze("");const c=Ze(),f=Ze(null);var d=null;const p=Ze({survey3_id:"",name:"",type:"",age:"",address:""});var g=null;const y=S=>{c.value.clearFiles();const I=S[0];I.uid=Kx(),c.value.handleStart(I),b()},b=()=>{c.value.submit()};function E({file:S}){if(a.value=="type1"){let I=new FileReader;I.readAsBinaryString(S),I.onload=A=>{try{const M=A0.read(A.target.result,{type:"binary",cellDates:!0});let F=M.SheetNames[0],L=M.Sheets[F],O=A0.utils.sheet_to_json(L,{header:1,range:0});const N=[];O.forEach((Q,ie)=>{const j={};ie>0&&(O[0].forEach((V,D)=>{j[V]=Q[D]||""}),N.push(j))}),f.value=N,f.value.length>0&&(d=Object.keys(f.value[0])),cs({title:"成功",message:`文件 ${S.name} 上传成功！`,position:"bottom-right",type:"success"})}catch{cs({title:"失败",message:`文件${S.name}上传失败`,position:"bottom-right",type:"error"})}}}else a.value=="type2"&&CU.parse(S,{header:!0,encoding:"gb2312",complete:I=>{let A=I.data;A.pop(),f.value=A,f.value.length>0&&(d=Object.keys(f.value[0])),cs({title:"成功",message:`文件 ${S.name} 上传成功！`,position:"bottom-right",type:"success"})},error:I=>{cs({title:"失败",message:`文件 ${S.name} 上传失败`,position:"bottom-right",type:"error"})}})}function T(){g=f.value.map(S=>{const I={};for(const A in p.value)Object.prototype.hasOwnProperty.call(p.value,A)&&(I[A]=S[p.value[A]]||"");return I}),n.$axios.post("/units/info/batch",g).then(S=>{cs({title:"成功",message:"数据导入成功！",position:"bottom-right",type:"success"})}).catch(S=>{console.error("API Error:",S.response.data),cs({title:"失败",message:"数据导入失败",position:"bottom-right",type:"error"})})}return(S,I)=>{const A=Ll,M=Ec,F=lk,L=xv,O=uu,N=Lme,Q=Jb,ie=Yb,j=Dh;return De(),yt(mn,null,[gt("div",h3e,[me(j,null,{default:we(()=>[me(A,{class:"bold-text"},{default:we(()=>[Sr("导入文保单位信息：")]),_:1}),me(A,null,{default:we(()=>[me(M,{span:6},{default:we(()=>[Sr("请选择导入格式：")]),_:1}),me(M,{span:18},{default:we(()=>[me(L,{modelValue:a.value,"onUpdate:modelValue":I[0]||(I[0]=V=>a.value=V)},{default:we(()=>[me(F,{label:"type1"},{default:we(()=>[Sr("Excel")]),_:1}),me(F,{label:"type2"},{default:we(()=>[Sr("文本数据格式（.txt/.csv）")]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1}),me(A,null,{default:we(()=>[me(N,{ref_key:"upload",ref:c,class:"upload-demo",action:"#",limit:1,"on-exceed":y,"show-file-list":!1,"http-request":E,accept:a.value==="type1"?".xlsx,.xls":".txt,.csv"},{default:we(()=>[me(O,{class:"btn-upload"},{default:we(()=>[Sr(" 上传文件 ")]),_:1})]),_:1},8,["accept"])]),_:1}),f.value?(De(),yt("div",d3e,[me(A,{class:"bold-text"},{default:we(()=>[Sr("字段匹配：")]),_:1}),me(A,{align:"middle"},{default:we(()=>[me(M,{span:5},{default:we(()=>[Sr("文物名称字段")]),_:1}),me(M,{span:5},{default:we(()=>[me(ie,{modelValue:p.value.name,"onUpdate:modelValue":I[1]||(I[1]=V=>p.value.name=V),class:"m-2",size:"small",placeholder:"选择字段"},{default:we(()=>[(De(!0),yt(mn,null,pa(W(d),V=>(De(),Ht(Q,{value:V},null,8,["value"]))),256))]),_:1},8,["modelValue"])]),_:1}),me(M,{span:2}),me(M,{span:5},{default:we(()=>[Sr("文物编号字段")]),_:1}),me(M,{span:5},{default:we(()=>[me(ie,{modelValue:p.value.survey3_id,"onUpdate:modelValue":I[2]||(I[2]=V=>p.value.survey3_id=V),class:"m-2",size:"small",placeholder:"选择字段"},{default:we(()=>[(De(!0),yt(mn,null,pa(W(d),V=>(De(),Ht(Q,{value:V},null,8,["value"]))),256))]),_:1},8,["modelValue"])]),_:1})]),_:1}),me(A,{align:"middle"},{default:we(()=>[me(M,{span:5},{default:we(()=>[Sr("类型字段")]),_:1}),me(M,{span:5},{default:we(()=>[me(ie,{modelValue:p.value.type,"onUpdate:modelValue":I[3]||(I[3]=V=>p.value.type=V),class:"m-2",size:"small",placeholder:"选择字段"},{default:we(()=>[(De(!0),yt(mn,null,pa(W(d),V=>(De(),Ht(Q,{value:V},null,8,["value"]))),256))]),_:1},8,["modelValue"])]),_:1}),me(M,{span:2}),me(M,{span:5},{default:we(()=>[Sr("年代字段")]),_:1}),me(M,{span:5},{default:we(()=>[me(ie,{modelValue:p.value.age,"onUpdate:modelValue":I[4]||(I[4]=V=>p.value.age=V),class:"m-2",size:"small",placeholder:"选择字段"},{default:we(()=>[(De(!0),yt(mn,null,pa(W(d),V=>(De(),Ht(Q,{value:V},null,8,["value"]))),256))]),_:1},8,["modelValue"])]),_:1})]),_:1}),me(A,{align:"middle"},{default:we(()=>[me(M,{span:5},{default:we(()=>[Sr("地址字段")]),_:1}),me(M,{span:5},{default:we(()=>[me(ie,{modelValue:p.value.address,"onUpdate:modelValue":I[5]||(I[5]=V=>p.value.address=V),class:"m-2",size:"small",placeholder:"选择字段"},{default:we(()=>[(De(!0),yt(mn,null,pa(W(d),V=>(De(),Ht(Q,{value:V},null,8,["value"]))),256))]),_:1},8,["modelValue"])]),_:1})]),_:1}),me(A,{style:{height:"1vh"}}),me(A,null,{default:we(()=>[me(M,{span:5,class:"bold-text"},{default:we(()=>[Sr("导入选项：")]),_:1}),me(M,{span:19},{default:we(()=>[me(L,{modelValue:s.value,"onUpdate:modelValue":I[6]||(I[6]=V=>s.value=V)},{default:we(()=>[me(F,{label:"opt1"},{default:we(()=>[Sr("追加到原数据")]),_:1}),me(F,{label:"opt2"},{default:we(()=>[Sr("覆盖原数据")]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})])):Wt("",!0)]),_:1})]),me(A,{class:"btn-row",justify:"end",align:"middle"},{default:we(()=>[me(O,{class:"btn-add",onClick:T,disabled:!f.value},{default:we(()=>[Sr("导入")]),_:1},8,["disabled"])]),_:1})],64)}}}),$7=Vs(m3e,[["__scopeId","data-v-d07405ec"]]);var B0={},i3={};i3.geometries={NULL:0,POINT:1,POLYLINE:3,POLYGON:5,MULTIPOINT:8,POINTZ:11,POLYLINEZ:13,POLYGONZ:15,MULTIPOINTZ:18,POINTM:21,POLYLINEM:23,POLYGONM:25,MULTIPOINTM:28,MULTIPATCH:31};var V7={},g3e={C:254,L:1,D:8,N:18,M:18,F:18,B:8},yw={};yw.lpad=function(n,a,s){for(;n.length<a;)n=s+n;return n};yw.rpad=function(n,a,s){for(;n.length<a;)n=n+s;return n};yw.writeField=function(n,a,s,c){for(var f=0;f<a;f++)n.setUint8(c,s.charCodeAt(f)),c++;return c};var xw={},_3e=g3e,v3e={string:"C",number:"N",boolean:"L",null:"C"};xw.multi=y3e;xw.bytesPer=b3e;xw.obj=j7;function y3e(t){var n={};t.forEach(a);function a(s){x3e(n,s)}return j7(n)}function x3e(t,n){for(var a in n){var s=typeof n[a]<"u"&&n[a]!==null;(typeof t[a]>"u"||s)&&(t[a]=n[a])}return t}function j7(t){var n={},a=[];for(var s in t)n[s]=t[s]===null?"null":typeof t[s];for(var c in n){var f=v3e[n[c]];f&&a.push({name:c,type:f,size:_3e[f]})}return a}function b3e(t){return t.reduce(function(n,a){return n+a.size},1)}var y0=yw,j6=xw,w3e=function(n,a){var s=a||j6.multi(n),c=32*s.length+1,f=j6.bytesPer(s),d=new ArrayBuffer(c+32+f*n.length+1),p=new Date,g=new DataView(d);g.setUint8(0,3),g.setUint8(1,p.getFullYear()-1900),g.setUint8(2,p.getMonth()+1),g.setUint8(3,p.getDate()),g.setUint32(4,n.length,!0);var y=c+32;g.setUint16(8,y,!0),g.setUint16(10,f,!0),g.setInt8(32+c-1,13),s.forEach(function(E,T){E.name.split("").slice(0,10).forEach(function(S,I){g.setInt8(32+T*32+I,S.charCodeAt(0))}),g.setInt8(32+T*32+11,E.type.charCodeAt(0)),g.setInt8(32+T*32+16,E.size),E.type=="N"&&g.setInt8(32+T*32+17,3)});var b=c+32;return n.forEach(function(E,T){g.setUint8(b,32),b++,s.forEach(function(S){var I=E[S.name];switch((I===null||typeof I>"u")&&(I=""),S.type){case"L":g.setUint8(b,I?84:70),b++;break;case"D":b=y0.writeField(g,8,y0.lpad(I.toString(),8," "),b);break;case"N":b=y0.writeField(g,S.size,y0.lpad(I.toString(),S.size," ").substr(0,18),b);break;case"C":b=y0.writeField(g,S.size,y0.rpad(I.toString(),S.size," "),b);break;default:throw new Error("Unknown field type")}})}),g.setUint8(b,26),g};V7.structure=w3e;var W7='GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137,298.257223563]],PRIMEM["Greenwich",0],UNIT["Degree",0.017453292519943295]]',Em={},Iv={};Iv.enlarge=function(n,a){return a[0]<n.xmin&&(n.xmin=a[0]),a[0]>n.xmax&&(n.xmax=a[0]),a[1]<n.ymin&&(n.ymin=a[1]),a[1]>n.ymax&&(n.ymax=a[1]),n};Iv.enlargeExtent=function(n,a){return a.xmax>n.xmax&&(n.xmax=a.xmax),a.xmin<n.xmin&&(n.xmin=a.xmin),a.ymax>n.ymax&&(n.ymax=a.ymax),a.ymin<n.ymin&&(n.ymin=a.ymin),n};Iv.blank=function(){return{xmin:Number.MAX_VALUE,ymin:Number.MAX_VALUE,xmax:-Number.MAX_VALUE,ymax:-Number.MAX_VALUE}};var W6=Iv;Em.write=function(n,a,s,c){var f=28,d=100,p=0,g=0;n.forEach(function(b,E){s.setInt32(p,E+1),s.setInt32(p+4,10),s.setInt32(p+8,1,!0),s.setFloat64(p+12,b[0],!0),s.setFloat64(p+20,b[1],!0),c.setInt32(g,d/2),c.setInt32(g+4,10),g+=8,p+=f,d+=f})};Em.extent=function(t){return t.reduce(function(n,a){return W6.enlarge(n,a)},W6.blank())};Em.parts=function(n,a){return n.length};Em.shxLength=function(t){return t.length*8};Em.shpLength=function(t){return t.length*28};var Tm={},pb=Iv,H6=i3;Tm.write=function(n,a,s,c,f){var d=0,p=0,g=100;n.forEach(y);function y(b,E){var T=bw(b),S=H7([b],f),I=T.length*16+48+(S-1)*4,A=T.reduce(function(L,O){return pb.enlarge(L,O)},pb.blank());c.setInt32(p,g/2),c.setInt32(p+4,I/2),p+=8,g+=I+8,s.setInt32(d,E+1),s.setInt32(d+4,I/2),s.setInt32(d+8,f,!0),s.setFloat64(d+12,A.xmin,!0),s.setFloat64(d+20,A.ymin,!0),s.setFloat64(d+28,A.xmax,!0),s.setFloat64(d+36,A.ymax,!0),s.setInt32(d+44,S,!0),s.setInt32(d+48,T.length,!0),s.setInt32(d+52,0,!0);for(var M=b.reduce(function(L,O){return Array.isArray(O[0][0])?L=L.concat(O):L.push(O),L},[]),F=1;F<S;F++)s.setInt32(d+52+F*4,M.reduce(function(L,O,N){return N<F?L+O.length:L},0),!0);T.forEach(function(O,N){s.setFloat64(d+56+N*16+(S-1)*4,O[0],!0),s.setFloat64(d+56+N*16+(S-1)*4+8,O[1],!0)}),d+=I+8}};Tm.shpLength=function(t){return t.length*56+bw(t).length*16};Tm.shxLength=function(t){return t.length*8};Tm.extent=function(t){return bw(t).reduce(function(n,a){return pb.enlarge(n,a)},pb.blank())};function H7(t,n){var a=1;return(n===H6.geometries.POLYGON||n===H6.geometries.POLYLINE)&&(a=t.reduce(function(s,c){return s+=c.length,Array.isArray(c[0][0][0])&&(s+=c.reduce(function(f,d){return f+d.length-1},0)),s},0)),a}Tm.parts=H7;function bw(t,n){return n===void 0&&(n=[]),typeof t[0][0]=="object"?t.reduce(function(a,s){return a.concat(bw(s))},n):t}var E3e=i3,T3e=V7,S3e=W7,C3e=Em,G6=Tm,A3e={1:C3e,5:G6,3:G6},G7=k3e;function k3e(t,n,a,s){var c=E3e.geometries[n],f=A3e[c],d=f.parts(a,c),p=100+(d-a.length)*4+f.shpLength(a),g=100+f.shxLength(a),y=new ArrayBuffer(p),b=new DataView(y),E=new ArrayBuffer(g),T=new DataView(E),S=f.extent(a);q6(b,c),q6(T,c),X6(S,b),X6(S,T),f.write(a,S,new DataView(y,100),new DataView(E,100),c),b.setInt32(24,p/2),T.setInt32(24,50+a.length*4);var I=T3e.structure(t);s(null,{shp:b,shx:T,dbf:I,prj:S3e})}function q6(t,n){t.setInt32(0,9994),t.setInt32(28,1e3,!0),t.setInt32(32,n,!0)}function X6(t,n){n.setFloat64(36,t.xmin,!0),n.setFloat64(44,t.ymin,!0),n.setFloat64(52,t.xmax,!0),n.setFloat64(60,t.ymax,!0)}var Sm={};Sm.point=Mv("Point","POINT");Sm.line=Mv("LineString","POLYLINE");Sm.multiline=Mv("MultiLineString","POLYLINE");Sm.polygon=Mv("Polygon","POLYGON");Sm.multipolygon=Mv("MultiPolygon","POLYGON");function Mv(t,n){return function(a){var s=a.features.filter(M3e(t));return{geometries:n==="POLYLINE"?[s.map(Z6)]:s.map(Z6),properties:s.map(I3e),type:n}}}function Z6(t){return t.geometry.coordinates}function I3e(t){return t.properties}function M3e(t){return Array.isArray(t)?function(n){return t.includes(n.geometry.type)}:function(n){return n.geometry.type===t}}function mx(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var q7={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/(function(t,n){(function(a){t.exports=a()})(function(){return function a(s,c,f){function d(y,b){if(!c[y]){if(!s[y]){var E=typeof mx=="function"&&mx;if(!b&&E)return E(y,!0);if(p)return p(y,!0);var T=new Error("Cannot find module '"+y+"'");throw T.code="MODULE_NOT_FOUND",T}var S=c[y]={exports:{}};s[y][0].call(S.exports,function(I){var A=s[y][1][I];return d(A||I)},S,S.exports,a,s,c,f)}return c[y].exports}for(var p=typeof mx=="function"&&mx,g=0;g<f.length;g++)d(f[g]);return d}({1:[function(a,s,c){var f=a("./utils"),d=a("./support"),p="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";c.encode=function(g){for(var y,b,E,T,S,I,A,M=[],F=0,L=g.length,O=L,N=f.getTypeOf(g)!=="string";F<g.length;)O=L-F,E=N?(y=g[F++],b=F<L?g[F++]:0,F<L?g[F++]:0):(y=g.charCodeAt(F++),b=F<L?g.charCodeAt(F++):0,F<L?g.charCodeAt(F++):0),T=y>>2,S=(3&y)<<4|b>>4,I=1<O?(15&b)<<2|E>>6:64,A=2<O?63&E:64,M.push(p.charAt(T)+p.charAt(S)+p.charAt(I)+p.charAt(A));return M.join("")},c.decode=function(g){var y,b,E,T,S,I,A=0,M=0,F="data:";if(g.substr(0,F.length)===F)throw new Error("Invalid base64 input, it looks like a data url.");var L,O=3*(g=g.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(g.charAt(g.length-1)===p.charAt(64)&&O--,g.charAt(g.length-2)===p.charAt(64)&&O--,O%1!=0)throw new Error("Invalid base64 input, bad content length.");for(L=d.uint8array?new Uint8Array(0|O):new Array(0|O);A<g.length;)y=p.indexOf(g.charAt(A++))<<2|(T=p.indexOf(g.charAt(A++)))>>4,b=(15&T)<<4|(S=p.indexOf(g.charAt(A++)))>>2,E=(3&S)<<6|(I=p.indexOf(g.charAt(A++))),L[M++]=y,S!==64&&(L[M++]=b),I!==64&&(L[M++]=E);return L}},{"./support":30,"./utils":32}],2:[function(a,s,c){var f=a("./external"),d=a("./stream/DataWorker"),p=a("./stream/Crc32Probe"),g=a("./stream/DataLengthProbe");function y(b,E,T,S,I){this.compressedSize=b,this.uncompressedSize=E,this.crc32=T,this.compression=S,this.compressedContent=I}y.prototype={getContentWorker:function(){var b=new d(f.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new g("data_length")),E=this;return b.on("end",function(){if(this.streamInfo.data_length!==E.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),b},getCompressedWorker:function(){return new d(f.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},y.createWorkerFrom=function(b,E,T){return b.pipe(new p).pipe(new g("uncompressedSize")).pipe(E.compressWorker(T)).pipe(new g("compressedSize")).withStreamInfo("compression",E)},s.exports=y},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(a,s,c){var f=a("./stream/GenericWorker");c.STORE={magic:"\0\0",compressWorker:function(){return new f("STORE compression")},uncompressWorker:function(){return new f("STORE decompression")}},c.DEFLATE=a("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(a,s,c){var f=a("./utils"),d=function(){for(var p,g=[],y=0;y<256;y++){p=y;for(var b=0;b<8;b++)p=1&p?3988292384^p>>>1:p>>>1;g[y]=p}return g}();s.exports=function(p,g){return p!==void 0&&p.length?f.getTypeOf(p)!=="string"?function(y,b,E,T){var S=d,I=T+E;y^=-1;for(var A=T;A<I;A++)y=y>>>8^S[255&(y^b[A])];return-1^y}(0|g,p,p.length,0):function(y,b,E,T){var S=d,I=T+E;y^=-1;for(var A=T;A<I;A++)y=y>>>8^S[255&(y^b.charCodeAt(A))];return-1^y}(0|g,p,p.length,0):0}},{"./utils":32}],5:[function(a,s,c){c.base64=!1,c.binary=!1,c.dir=!1,c.createFolders=!0,c.date=null,c.compression=null,c.compressionOptions=null,c.comment=null,c.unixPermissions=null,c.dosPermissions=null},{}],6:[function(a,s,c){var f=null;f=typeof Promise<"u"?Promise:a("lie"),s.exports={Promise:f}},{lie:37}],7:[function(a,s,c){var f=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",d=a("pako"),p=a("./utils"),g=a("./stream/GenericWorker"),y=f?"uint8array":"array";function b(E,T){g.call(this,"FlateWorker/"+E),this._pako=null,this._pakoAction=E,this._pakoOptions=T,this.meta={}}c.magic="\b\0",p.inherits(b,g),b.prototype.processChunk=function(E){this.meta=E.meta,this._pako===null&&this._createPako(),this._pako.push(p.transformTo(y,E.data),!1)},b.prototype.flush=function(){g.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},b.prototype.cleanUp=function(){g.prototype.cleanUp.call(this),this._pako=null},b.prototype._createPako=function(){this._pako=new d[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var E=this;this._pako.onData=function(T){E.push({data:T,meta:E.meta})}},c.compressWorker=function(E){return new b("Deflate",E)},c.uncompressWorker=function(){return new b("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(a,s,c){function f(S,I){var A,M="";for(A=0;A<I;A++)M+=String.fromCharCode(255&S),S>>>=8;return M}function d(S,I,A,M,F,L){var O,N,Q=S.file,ie=S.compression,j=L!==y.utf8encode,V=p.transformTo("string",L(Q.name)),D=p.transformTo("string",y.utf8encode(Q.name)),te=Q.comment,ue=p.transformTo("string",L(te)),J=p.transformTo("string",y.utf8encode(te)),le=D.length!==Q.name.length,re=J.length!==te.length,Fe="",Ye="",Ee="",ut=Q.dir,Ne=Q.date,He={crc32:0,compressedSize:0,uncompressedSize:0};I&&!A||(He.crc32=S.crc32,He.compressedSize=S.compressedSize,He.uncompressedSize=S.uncompressedSize);var Oe=0;I&&(Oe|=8),j||!le&&!re||(Oe|=2048);var Pe=0,rt=0;ut&&(Pe|=16),F==="UNIX"?(rt=798,Pe|=function(Ge,ze){var oe=Ge;return Ge||(oe=ze?16893:33204),(65535&oe)<<16}(Q.unixPermissions,ut)):(rt=20,Pe|=function(Ge){return 63&(Ge||0)}(Q.dosPermissions)),O=Ne.getUTCHours(),O<<=6,O|=Ne.getUTCMinutes(),O<<=5,O|=Ne.getUTCSeconds()/2,N=Ne.getUTCFullYear()-1980,N<<=4,N|=Ne.getUTCMonth()+1,N<<=5,N|=Ne.getUTCDate(),le&&(Ye=f(1,1)+f(b(V),4)+D,Fe+="up"+f(Ye.length,2)+Ye),re&&(Ee=f(1,1)+f(b(ue),4)+J,Fe+="uc"+f(Ee.length,2)+Ee);var et="";return et+=`
\0`,et+=f(Oe,2),et+=ie.magic,et+=f(O,2),et+=f(N,2),et+=f(He.crc32,4),et+=f(He.compressedSize,4),et+=f(He.uncompressedSize,4),et+=f(V.length,2),et+=f(Fe.length,2),{fileRecord:E.LOCAL_FILE_HEADER+et+V+Fe,dirRecord:E.CENTRAL_FILE_HEADER+f(rt,2)+et+f(ue.length,2)+"\0\0\0\0"+f(Pe,4)+f(M,4)+V+Fe+ue}}var p=a("../utils"),g=a("../stream/GenericWorker"),y=a("../utf8"),b=a("../crc32"),E=a("../signature");function T(S,I,A,M){g.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=I,this.zipPlatform=A,this.encodeFileName=M,this.streamFiles=S,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}p.inherits(T,g),T.prototype.push=function(S){var I=S.meta.percent||0,A=this.entriesCount,M=this._sources.length;this.accumulate?this.contentBuffer.push(S):(this.bytesWritten+=S.data.length,g.prototype.push.call(this,{data:S.data,meta:{currentFile:this.currentFile,percent:A?(I+100*(A-M-1))/A:100}}))},T.prototype.openedSource=function(S){this.currentSourceOffset=this.bytesWritten,this.currentFile=S.file.name;var I=this.streamFiles&&!S.file.dir;if(I){var A=d(S,I,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:A.fileRecord,meta:{percent:0}})}else this.accumulate=!0},T.prototype.closedSource=function(S){this.accumulate=!1;var I=this.streamFiles&&!S.file.dir,A=d(S,I,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(A.dirRecord),I)this.push({data:function(M){return E.DATA_DESCRIPTOR+f(M.crc32,4)+f(M.compressedSize,4)+f(M.uncompressedSize,4)}(S),meta:{percent:100}});else for(this.push({data:A.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},T.prototype.flush=function(){for(var S=this.bytesWritten,I=0;I<this.dirRecords.length;I++)this.push({data:this.dirRecords[I],meta:{percent:100}});var A=this.bytesWritten-S,M=function(F,L,O,N,Q){var ie=p.transformTo("string",Q(N));return E.CENTRAL_DIRECTORY_END+"\0\0\0\0"+f(F,2)+f(F,2)+f(L,4)+f(O,4)+f(ie.length,2)+ie}(this.dirRecords.length,A,S,this.zipComment,this.encodeFileName);this.push({data:M,meta:{percent:100}})},T.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},T.prototype.registerPrevious=function(S){this._sources.push(S);var I=this;return S.on("data",function(A){I.processChunk(A)}),S.on("end",function(){I.closedSource(I.previous.streamInfo),I._sources.length?I.prepareNextSource():I.end()}),S.on("error",function(A){I.error(A)}),this},T.prototype.resume=function(){return!!g.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},T.prototype.error=function(S){var I=this._sources;if(!g.prototype.error.call(this,S))return!1;for(var A=0;A<I.length;A++)try{I[A].error(S)}catch{}return!0},T.prototype.lock=function(){g.prototype.lock.call(this);for(var S=this._sources,I=0;I<S.length;I++)S[I].lock()},s.exports=T},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(a,s,c){var f=a("../compressions"),d=a("./ZipFileWorker");c.generateWorker=function(p,g,y){var b=new d(g.streamFiles,y,g.platform,g.encodeFileName),E=0;try{p.forEach(function(T,S){E++;var I=function(L,O){var N=L||O,Q=f[N];if(!Q)throw new Error(N+" is not a valid compression method !");return Q}(S.options.compression,g.compression),A=S.options.compressionOptions||g.compressionOptions||{},M=S.dir,F=S.date;S._compressWorker(I,A).withStreamInfo("file",{name:T,dir:M,date:F,comment:S.comment||"",unixPermissions:S.unixPermissions,dosPermissions:S.dosPermissions}).pipe(b)}),b.entriesCount=E}catch(T){b.error(T)}return b}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(a,s,c){function f(){if(!(this instanceof f))return new f;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var d=new f;for(var p in this)typeof this[p]!="function"&&(d[p]=this[p]);return d}}(f.prototype=a("./object")).loadAsync=a("./load"),f.support=a("./support"),f.defaults=a("./defaults"),f.version="3.10.1",f.loadAsync=function(d,p){return new f().loadAsync(d,p)},f.external=a("./external"),s.exports=f},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(a,s,c){var f=a("./utils"),d=a("./external"),p=a("./utf8"),g=a("./zipEntries"),y=a("./stream/Crc32Probe"),b=a("./nodejsUtils");function E(T){return new d.Promise(function(S,I){var A=T.decompressed.getContentWorker().pipe(new y);A.on("error",function(M){I(M)}).on("end",function(){A.streamInfo.crc32!==T.decompressed.crc32?I(new Error("Corrupted zip : CRC32 mismatch")):S()}).resume()})}s.exports=function(T,S){var I=this;return S=f.extend(S||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:p.utf8decode}),b.isNode&&b.isStream(T)?d.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):f.prepareContent("the loaded zip file",T,!0,S.optimizedBinaryString,S.base64).then(function(A){var M=new g(S);return M.load(A),M}).then(function(A){var M=[d.Promise.resolve(A)],F=A.files;if(S.checkCRC32)for(var L=0;L<F.length;L++)M.push(E(F[L]));return d.Promise.all(M)}).then(function(A){for(var M=A.shift(),F=M.files,L=0;L<F.length;L++){var O=F[L],N=O.fileNameStr,Q=f.resolve(O.fileNameStr);I.file(Q,O.decompressed,{binary:!0,optimizedBinaryString:!0,date:O.date,dir:O.dir,comment:O.fileCommentStr.length?O.fileCommentStr:null,unixPermissions:O.unixPermissions,dosPermissions:O.dosPermissions,createFolders:S.createFolders}),O.dir||(I.file(Q).unsafeOriginalName=N)}return M.zipComment.length&&(I.comment=M.zipComment),I})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(a,s,c){var f=a("../utils"),d=a("../stream/GenericWorker");function p(g,y){d.call(this,"Nodejs stream input adapter for "+g),this._upstreamEnded=!1,this._bindStream(y)}f.inherits(p,d),p.prototype._bindStream=function(g){var y=this;(this._stream=g).pause(),g.on("data",function(b){y.push({data:b,meta:{percent:0}})}).on("error",function(b){y.isPaused?this.generatedError=b:y.error(b)}).on("end",function(){y.isPaused?y._upstreamEnded=!0:y.end()})},p.prototype.pause=function(){return!!d.prototype.pause.call(this)&&(this._stream.pause(),!0)},p.prototype.resume=function(){return!!d.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},s.exports=p},{"../stream/GenericWorker":28,"../utils":32}],13:[function(a,s,c){var f=a("readable-stream").Readable;function d(p,g,y){f.call(this,g),this._helper=p;var b=this;p.on("data",function(E,T){b.push(E)||b._helper.pause(),y&&y(T)}).on("error",function(E){b.emit("error",E)}).on("end",function(){b.push(null)})}a("../utils").inherits(d,f),d.prototype._read=function(){this._helper.resume()},s.exports=d},{"../utils":32,"readable-stream":16}],14:[function(a,s,c){s.exports={isNode:typeof Buffer<"u",newBufferFrom:function(f,d){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(f,d);if(typeof f=="number")throw new Error('The "data" argument must not be a number');return new Buffer(f,d)},allocBuffer:function(f){if(Buffer.alloc)return Buffer.alloc(f);var d=new Buffer(f);return d.fill(0),d},isBuffer:function(f){return Buffer.isBuffer(f)},isStream:function(f){return f&&typeof f.on=="function"&&typeof f.pause=="function"&&typeof f.resume=="function"}}},{}],15:[function(a,s,c){function f(Q,ie,j){var V,D=p.getTypeOf(ie),te=p.extend(j||{},b);te.date=te.date||new Date,te.compression!==null&&(te.compression=te.compression.toUpperCase()),typeof te.unixPermissions=="string"&&(te.unixPermissions=parseInt(te.unixPermissions,8)),te.unixPermissions&&16384&te.unixPermissions&&(te.dir=!0),te.dosPermissions&&16&te.dosPermissions&&(te.dir=!0),te.dir&&(Q=F(Q)),te.createFolders&&(V=M(Q))&&L.call(this,V,!0);var ue=D==="string"&&te.binary===!1&&te.base64===!1;j&&j.binary!==void 0||(te.binary=!ue),(ie instanceof E&&ie.uncompressedSize===0||te.dir||!ie||ie.length===0)&&(te.base64=!1,te.binary=!0,ie="",te.compression="STORE",D="string");var J=null;J=ie instanceof E||ie instanceof g?ie:I.isNode&&I.isStream(ie)?new A(Q,ie):p.prepareContent(Q,ie,te.binary,te.optimizedBinaryString,te.base64);var le=new T(Q,J,te);this.files[Q]=le}var d=a("./utf8"),p=a("./utils"),g=a("./stream/GenericWorker"),y=a("./stream/StreamHelper"),b=a("./defaults"),E=a("./compressedObject"),T=a("./zipObject"),S=a("./generate"),I=a("./nodejsUtils"),A=a("./nodejs/NodejsStreamInputAdapter"),M=function(Q){Q.slice(-1)==="/"&&(Q=Q.substring(0,Q.length-1));var ie=Q.lastIndexOf("/");return 0<ie?Q.substring(0,ie):""},F=function(Q){return Q.slice(-1)!=="/"&&(Q+="/"),Q},L=function(Q,ie){return ie=ie!==void 0?ie:b.createFolders,Q=F(Q),this.files[Q]||f.call(this,Q,null,{dir:!0,createFolders:ie}),this.files[Q]};function O(Q){return Object.prototype.toString.call(Q)==="[object RegExp]"}var N={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(Q){var ie,j,V;for(ie in this.files)V=this.files[ie],(j=ie.slice(this.root.length,ie.length))&&ie.slice(0,this.root.length)===this.root&&Q(j,V)},filter:function(Q){var ie=[];return this.forEach(function(j,V){Q(j,V)&&ie.push(V)}),ie},file:function(Q,ie,j){if(arguments.length!==1)return Q=this.root+Q,f.call(this,Q,ie,j),this;if(O(Q)){var V=Q;return this.filter(function(te,ue){return!ue.dir&&V.test(te)})}var D=this.files[this.root+Q];return D&&!D.dir?D:null},folder:function(Q){if(!Q)return this;if(O(Q))return this.filter(function(D,te){return te.dir&&Q.test(D)});var ie=this.root+Q,j=L.call(this,ie),V=this.clone();return V.root=j.name,V},remove:function(Q){Q=this.root+Q;var ie=this.files[Q];if(ie||(Q.slice(-1)!=="/"&&(Q+="/"),ie=this.files[Q]),ie&&!ie.dir)delete this.files[Q];else for(var j=this.filter(function(D,te){return te.name.slice(0,Q.length)===Q}),V=0;V<j.length;V++)delete this.files[j[V].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(Q){var ie,j={};try{if((j=p.extend(Q||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:d.utf8encode})).type=j.type.toLowerCase(),j.compression=j.compression.toUpperCase(),j.type==="binarystring"&&(j.type="string"),!j.type)throw new Error("No output type specified.");p.checkSupport(j.type),j.platform!=="darwin"&&j.platform!=="freebsd"&&j.platform!=="linux"&&j.platform!=="sunos"||(j.platform="UNIX"),j.platform==="win32"&&(j.platform="DOS");var V=j.comment||this.comment||"";ie=S.generateWorker(this,j,V)}catch(D){(ie=new g("error")).error(D)}return new y(ie,j.type||"string",j.mimeType)},generateAsync:function(Q,ie){return this.generateInternalStream(Q).accumulate(ie)},generateNodeStream:function(Q,ie){return(Q=Q||{}).type||(Q.type="nodebuffer"),this.generateInternalStream(Q).toNodejsStream(ie)}};s.exports=N},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(a,s,c){s.exports=a("stream")},{stream:void 0}],17:[function(a,s,c){var f=a("./DataReader");function d(p){f.call(this,p);for(var g=0;g<this.data.length;g++)p[g]=255&p[g]}a("../utils").inherits(d,f),d.prototype.byteAt=function(p){return this.data[this.zero+p]},d.prototype.lastIndexOfSignature=function(p){for(var g=p.charCodeAt(0),y=p.charCodeAt(1),b=p.charCodeAt(2),E=p.charCodeAt(3),T=this.length-4;0<=T;--T)if(this.data[T]===g&&this.data[T+1]===y&&this.data[T+2]===b&&this.data[T+3]===E)return T-this.zero;return-1},d.prototype.readAndCheckSignature=function(p){var g=p.charCodeAt(0),y=p.charCodeAt(1),b=p.charCodeAt(2),E=p.charCodeAt(3),T=this.readData(4);return g===T[0]&&y===T[1]&&b===T[2]&&E===T[3]},d.prototype.readData=function(p){if(this.checkOffset(p),p===0)return[];var g=this.data.slice(this.zero+this.index,this.zero+this.index+p);return this.index+=p,g},s.exports=d},{"../utils":32,"./DataReader":18}],18:[function(a,s,c){var f=a("../utils");function d(p){this.data=p,this.length=p.length,this.index=0,this.zero=0}d.prototype={checkOffset:function(p){this.checkIndex(this.index+p)},checkIndex:function(p){if(this.length<this.zero+p||p<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+p+"). Corrupted zip ?")},setIndex:function(p){this.checkIndex(p),this.index=p},skip:function(p){this.setIndex(this.index+p)},byteAt:function(){},readInt:function(p){var g,y=0;for(this.checkOffset(p),g=this.index+p-1;g>=this.index;g--)y=(y<<8)+this.byteAt(g);return this.index+=p,y},readString:function(p){return f.transformTo("string",this.readData(p))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var p=this.readInt(4);return new Date(Date.UTC(1980+(p>>25&127),(p>>21&15)-1,p>>16&31,p>>11&31,p>>5&63,(31&p)<<1))}},s.exports=d},{"../utils":32}],19:[function(a,s,c){var f=a("./Uint8ArrayReader");function d(p){f.call(this,p)}a("../utils").inherits(d,f),d.prototype.readData=function(p){this.checkOffset(p);var g=this.data.slice(this.zero+this.index,this.zero+this.index+p);return this.index+=p,g},s.exports=d},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(a,s,c){var f=a("./DataReader");function d(p){f.call(this,p)}a("../utils").inherits(d,f),d.prototype.byteAt=function(p){return this.data.charCodeAt(this.zero+p)},d.prototype.lastIndexOfSignature=function(p){return this.data.lastIndexOf(p)-this.zero},d.prototype.readAndCheckSignature=function(p){return p===this.readData(4)},d.prototype.readData=function(p){this.checkOffset(p);var g=this.data.slice(this.zero+this.index,this.zero+this.index+p);return this.index+=p,g},s.exports=d},{"../utils":32,"./DataReader":18}],21:[function(a,s,c){var f=a("./ArrayReader");function d(p){f.call(this,p)}a("../utils").inherits(d,f),d.prototype.readData=function(p){if(this.checkOffset(p),p===0)return new Uint8Array(0);var g=this.data.subarray(this.zero+this.index,this.zero+this.index+p);return this.index+=p,g},s.exports=d},{"../utils":32,"./ArrayReader":17}],22:[function(a,s,c){var f=a("../utils"),d=a("../support"),p=a("./ArrayReader"),g=a("./StringReader"),y=a("./NodeBufferReader"),b=a("./Uint8ArrayReader");s.exports=function(E){var T=f.getTypeOf(E);return f.checkSupport(T),T!=="string"||d.uint8array?T==="nodebuffer"?new y(E):d.uint8array?new b(f.transformTo("uint8array",E)):new p(f.transformTo("array",E)):new g(E)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(a,s,c){c.LOCAL_FILE_HEADER="PK",c.CENTRAL_FILE_HEADER="PK",c.CENTRAL_DIRECTORY_END="PK",c.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",c.ZIP64_CENTRAL_DIRECTORY_END="PK",c.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(a,s,c){var f=a("./GenericWorker"),d=a("../utils");function p(g){f.call(this,"ConvertWorker to "+g),this.destType=g}d.inherits(p,f),p.prototype.processChunk=function(g){this.push({data:d.transformTo(this.destType,g.data),meta:g.meta})},s.exports=p},{"../utils":32,"./GenericWorker":28}],25:[function(a,s,c){var f=a("./GenericWorker"),d=a("../crc32");function p(){f.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}a("../utils").inherits(p,f),p.prototype.processChunk=function(g){this.streamInfo.crc32=d(g.data,this.streamInfo.crc32||0),this.push(g)},s.exports=p},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(a,s,c){var f=a("../utils"),d=a("./GenericWorker");function p(g){d.call(this,"DataLengthProbe for "+g),this.propName=g,this.withStreamInfo(g,0)}f.inherits(p,d),p.prototype.processChunk=function(g){if(g){var y=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=y+g.data.length}d.prototype.processChunk.call(this,g)},s.exports=p},{"../utils":32,"./GenericWorker":28}],27:[function(a,s,c){var f=a("../utils"),d=a("./GenericWorker");function p(g){d.call(this,"DataWorker");var y=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,g.then(function(b){y.dataIsReady=!0,y.data=b,y.max=b&&b.length||0,y.type=f.getTypeOf(b),y.isPaused||y._tickAndRepeat()},function(b){y.error(b)})}f.inherits(p,d),p.prototype.cleanUp=function(){d.prototype.cleanUp.call(this),this.data=null},p.prototype.resume=function(){return!!d.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,f.delay(this._tickAndRepeat,[],this)),!0)},p.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(f.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},p.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var g=null,y=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":g=this.data.substring(this.index,y);break;case"uint8array":g=this.data.subarray(this.index,y);break;case"array":case"nodebuffer":g=this.data.slice(this.index,y)}return this.index=y,this.push({data:g,meta:{percent:this.max?this.index/this.max*100:0}})},s.exports=p},{"../utils":32,"./GenericWorker":28}],28:[function(a,s,c){function f(d){this.name=d||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}f.prototype={push:function(d){this.emit("data",d)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(d){this.emit("error",d)}return!0},error:function(d){return!this.isFinished&&(this.isPaused?this.generatedError=d:(this.isFinished=!0,this.emit("error",d),this.previous&&this.previous.error(d),this.cleanUp()),!0)},on:function(d,p){return this._listeners[d].push(p),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(d,p){if(this._listeners[d])for(var g=0;g<this._listeners[d].length;g++)this._listeners[d][g].call(this,p)},pipe:function(d){return d.registerPrevious(this)},registerPrevious:function(d){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=d.streamInfo,this.mergeStreamInfo(),this.previous=d;var p=this;return d.on("data",function(g){p.processChunk(g)}),d.on("end",function(){p.end()}),d.on("error",function(g){p.error(g)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var d=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),d=!0),this.previous&&this.previous.resume(),!d},flush:function(){},processChunk:function(d){this.push(d)},withStreamInfo:function(d,p){return this.extraStreamInfo[d]=p,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var d in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,d)&&(this.streamInfo[d]=this.extraStreamInfo[d])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var d="Worker "+this.name;return this.previous?this.previous+" -> "+d:d}},s.exports=f},{}],29:[function(a,s,c){var f=a("../utils"),d=a("./ConvertWorker"),p=a("./GenericWorker"),g=a("../base64"),y=a("../support"),b=a("../external"),E=null;if(y.nodestream)try{E=a("../nodejs/NodejsStreamOutputAdapter")}catch{}function T(I,A){return new b.Promise(function(M,F){var L=[],O=I._internalType,N=I._outputType,Q=I._mimeType;I.on("data",function(ie,j){L.push(ie),A&&A(j)}).on("error",function(ie){L=[],F(ie)}).on("end",function(){try{var ie=function(j,V,D){switch(j){case"blob":return f.newBlob(f.transformTo("arraybuffer",V),D);case"base64":return g.encode(V);default:return f.transformTo(j,V)}}(N,function(j,V){var D,te=0,ue=null,J=0;for(D=0;D<V.length;D++)J+=V[D].length;switch(j){case"string":return V.join("");case"array":return Array.prototype.concat.apply([],V);case"uint8array":for(ue=new Uint8Array(J),D=0;D<V.length;D++)ue.set(V[D],te),te+=V[D].length;return ue;case"nodebuffer":return Buffer.concat(V);default:throw new Error("concat : unsupported type '"+j+"'")}}(O,L),Q);M(ie)}catch(j){F(j)}L=[]}).resume()})}function S(I,A,M){var F=A;switch(A){case"blob":case"arraybuffer":F="uint8array";break;case"base64":F="string"}try{this._internalType=F,this._outputType=A,this._mimeType=M,f.checkSupport(F),this._worker=I.pipe(new d(F)),I.lock()}catch(L){this._worker=new p("error"),this._worker.error(L)}}S.prototype={accumulate:function(I){return T(this,I)},on:function(I,A){var M=this;return I==="data"?this._worker.on(I,function(F){A.call(M,F.data,F.meta)}):this._worker.on(I,function(){f.delay(A,arguments,M)}),this},resume:function(){return f.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(I){if(f.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new E(this,{objectMode:this._outputType!=="nodebuffer"},I)}},s.exports=S},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(a,s,c){if(c.base64=!0,c.array=!0,c.string=!0,c.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",c.nodebuffer=typeof Buffer<"u",c.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")c.blob=!1;else{var f=new ArrayBuffer(0);try{c.blob=new Blob([f],{type:"application/zip"}).size===0}catch{try{var d=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);d.append(f),c.blob=d.getBlob("application/zip").size===0}catch{c.blob=!1}}}try{c.nodestream=!!a("readable-stream").Readable}catch{c.nodestream=!1}},{"readable-stream":16}],31:[function(a,s,c){for(var f=a("./utils"),d=a("./support"),p=a("./nodejsUtils"),g=a("./stream/GenericWorker"),y=new Array(256),b=0;b<256;b++)y[b]=252<=b?6:248<=b?5:240<=b?4:224<=b?3:192<=b?2:1;y[254]=y[254]=1;function E(){g.call(this,"utf-8 decode"),this.leftOver=null}function T(){g.call(this,"utf-8 encode")}c.utf8encode=function(S){return d.nodebuffer?p.newBufferFrom(S,"utf-8"):function(I){var A,M,F,L,O,N=I.length,Q=0;for(L=0;L<N;L++)(64512&(M=I.charCodeAt(L)))==55296&&L+1<N&&(64512&(F=I.charCodeAt(L+1)))==56320&&(M=65536+(M-55296<<10)+(F-56320),L++),Q+=M<128?1:M<2048?2:M<65536?3:4;for(A=d.uint8array?new Uint8Array(Q):new Array(Q),L=O=0;O<Q;L++)(64512&(M=I.charCodeAt(L)))==55296&&L+1<N&&(64512&(F=I.charCodeAt(L+1)))==56320&&(M=65536+(M-55296<<10)+(F-56320),L++),M<128?A[O++]=M:(M<2048?A[O++]=192|M>>>6:(M<65536?A[O++]=224|M>>>12:(A[O++]=240|M>>>18,A[O++]=128|M>>>12&63),A[O++]=128|M>>>6&63),A[O++]=128|63&M);return A}(S)},c.utf8decode=function(S){return d.nodebuffer?f.transformTo("nodebuffer",S).toString("utf-8"):function(I){var A,M,F,L,O=I.length,N=new Array(2*O);for(A=M=0;A<O;)if((F=I[A++])<128)N[M++]=F;else if(4<(L=y[F]))N[M++]=65533,A+=L-1;else{for(F&=L===2?31:L===3?15:7;1<L&&A<O;)F=F<<6|63&I[A++],L--;1<L?N[M++]=65533:F<65536?N[M++]=F:(F-=65536,N[M++]=55296|F>>10&1023,N[M++]=56320|1023&F)}return N.length!==M&&(N.subarray?N=N.subarray(0,M):N.length=M),f.applyFromCharCode(N)}(S=f.transformTo(d.uint8array?"uint8array":"array",S))},f.inherits(E,g),E.prototype.processChunk=function(S){var I=f.transformTo(d.uint8array?"uint8array":"array",S.data);if(this.leftOver&&this.leftOver.length){if(d.uint8array){var A=I;(I=new Uint8Array(A.length+this.leftOver.length)).set(this.leftOver,0),I.set(A,this.leftOver.length)}else I=this.leftOver.concat(I);this.leftOver=null}var M=function(L,O){var N;for((O=O||L.length)>L.length&&(O=L.length),N=O-1;0<=N&&(192&L[N])==128;)N--;return N<0||N===0?O:N+y[L[N]]>O?N:O}(I),F=I;M!==I.length&&(d.uint8array?(F=I.subarray(0,M),this.leftOver=I.subarray(M,I.length)):(F=I.slice(0,M),this.leftOver=I.slice(M,I.length))),this.push({data:c.utf8decode(F),meta:S.meta})},E.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:c.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},c.Utf8DecodeWorker=E,f.inherits(T,g),T.prototype.processChunk=function(S){this.push({data:c.utf8encode(S.data),meta:S.meta})},c.Utf8EncodeWorker=T},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(a,s,c){var f=a("./support"),d=a("./base64"),p=a("./nodejsUtils"),g=a("./external");function y(A){return A}function b(A,M){for(var F=0;F<A.length;++F)M[F]=255&A.charCodeAt(F);return M}a("setimmediate"),c.newBlob=function(A,M){c.checkSupport("blob");try{return new Blob([A],{type:M})}catch{try{var F=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return F.append(A),F.getBlob(M)}catch{throw new Error("Bug : can't construct the Blob.")}}};var E={stringifyByChunk:function(A,M,F){var L=[],O=0,N=A.length;if(N<=F)return String.fromCharCode.apply(null,A);for(;O<N;)M==="array"||M==="nodebuffer"?L.push(String.fromCharCode.apply(null,A.slice(O,Math.min(O+F,N)))):L.push(String.fromCharCode.apply(null,A.subarray(O,Math.min(O+F,N)))),O+=F;return L.join("")},stringifyByChar:function(A){for(var M="",F=0;F<A.length;F++)M+=String.fromCharCode(A[F]);return M},applyCanBeUsed:{uint8array:function(){try{return f.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return f.nodebuffer&&String.fromCharCode.apply(null,p.allocBuffer(1)).length===1}catch{return!1}}()}};function T(A){var M=65536,F=c.getTypeOf(A),L=!0;if(F==="uint8array"?L=E.applyCanBeUsed.uint8array:F==="nodebuffer"&&(L=E.applyCanBeUsed.nodebuffer),L)for(;1<M;)try{return E.stringifyByChunk(A,F,M)}catch{M=Math.floor(M/2)}return E.stringifyByChar(A)}function S(A,M){for(var F=0;F<A.length;F++)M[F]=A[F];return M}c.applyFromCharCode=T;var I={};I.string={string:y,array:function(A){return b(A,new Array(A.length))},arraybuffer:function(A){return I.string.uint8array(A).buffer},uint8array:function(A){return b(A,new Uint8Array(A.length))},nodebuffer:function(A){return b(A,p.allocBuffer(A.length))}},I.array={string:T,array:y,arraybuffer:function(A){return new Uint8Array(A).buffer},uint8array:function(A){return new Uint8Array(A)},nodebuffer:function(A){return p.newBufferFrom(A)}},I.arraybuffer={string:function(A){return T(new Uint8Array(A))},array:function(A){return S(new Uint8Array(A),new Array(A.byteLength))},arraybuffer:y,uint8array:function(A){return new Uint8Array(A)},nodebuffer:function(A){return p.newBufferFrom(new Uint8Array(A))}},I.uint8array={string:T,array:function(A){return S(A,new Array(A.length))},arraybuffer:function(A){return A.buffer},uint8array:y,nodebuffer:function(A){return p.newBufferFrom(A)}},I.nodebuffer={string:T,array:function(A){return S(A,new Array(A.length))},arraybuffer:function(A){return I.nodebuffer.uint8array(A).buffer},uint8array:function(A){return S(A,new Uint8Array(A.length))},nodebuffer:y},c.transformTo=function(A,M){if(M=M||"",!A)return M;c.checkSupport(A);var F=c.getTypeOf(M);return I[F][A](M)},c.resolve=function(A){for(var M=A.split("/"),F=[],L=0;L<M.length;L++){var O=M[L];O==="."||O===""&&L!==0&&L!==M.length-1||(O===".."?F.pop():F.push(O))}return F.join("/")},c.getTypeOf=function(A){return typeof A=="string"?"string":Object.prototype.toString.call(A)==="[object Array]"?"array":f.nodebuffer&&p.isBuffer(A)?"nodebuffer":f.uint8array&&A instanceof Uint8Array?"uint8array":f.arraybuffer&&A instanceof ArrayBuffer?"arraybuffer":void 0},c.checkSupport=function(A){if(!f[A.toLowerCase()])throw new Error(A+" is not supported by this platform")},c.MAX_VALUE_16BITS=65535,c.MAX_VALUE_32BITS=-1,c.pretty=function(A){var M,F,L="";for(F=0;F<(A||"").length;F++)L+="\\x"+((M=A.charCodeAt(F))<16?"0":"")+M.toString(16).toUpperCase();return L},c.delay=function(A,M,F){setImmediate(function(){A.apply(F||null,M||[])})},c.inherits=function(A,M){function F(){}F.prototype=M.prototype,A.prototype=new F},c.extend=function(){var A,M,F={};for(A=0;A<arguments.length;A++)for(M in arguments[A])Object.prototype.hasOwnProperty.call(arguments[A],M)&&F[M]===void 0&&(F[M]=arguments[A][M]);return F},c.prepareContent=function(A,M,F,L,O){return g.Promise.resolve(M).then(function(N){return f.blob&&(N instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(N))!==-1)&&typeof FileReader<"u"?new g.Promise(function(Q,ie){var j=new FileReader;j.onload=function(V){Q(V.target.result)},j.onerror=function(V){ie(V.target.error)},j.readAsArrayBuffer(N)}):N}).then(function(N){var Q=c.getTypeOf(N);return Q?(Q==="arraybuffer"?N=c.transformTo("uint8array",N):Q==="string"&&(O?N=d.decode(N):F&&L!==!0&&(N=function(ie){return b(ie,f.uint8array?new Uint8Array(ie.length):new Array(ie.length))}(N))),N):g.Promise.reject(new Error("Can't read the data of '"+A+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(a,s,c){var f=a("./reader/readerFor"),d=a("./utils"),p=a("./signature"),g=a("./zipEntry"),y=a("./support");function b(E){this.files=[],this.loadOptions=E}b.prototype={checkSignature:function(E){if(!this.reader.readAndCheckSignature(E)){this.reader.index-=4;var T=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+d.pretty(T)+", expected "+d.pretty(E)+")")}},isSignature:function(E,T){var S=this.reader.index;this.reader.setIndex(E);var I=this.reader.readString(4)===T;return this.reader.setIndex(S),I},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var E=this.reader.readData(this.zipCommentLength),T=y.uint8array?"uint8array":"array",S=d.transformTo(T,E);this.zipComment=this.loadOptions.decodeFileName(S)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var E,T,S,I=this.zip64EndOfCentralSize-44;0<I;)E=this.reader.readInt(2),T=this.reader.readInt(4),S=this.reader.readData(T),this.zip64ExtensibleData[E]={id:E,length:T,value:S}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var E,T;for(E=0;E<this.files.length;E++)T=this.files[E],this.reader.setIndex(T.localHeaderOffset),this.checkSignature(p.LOCAL_FILE_HEADER),T.readLocalPart(this.reader),T.handleUTF8(),T.processAttributes()},readCentralDir:function(){var E;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(p.CENTRAL_FILE_HEADER);)(E=new g({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(E);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var E=this.reader.lastIndexOfSignature(p.CENTRAL_DIRECTORY_END);if(E<0)throw this.isSignature(0,p.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(E);var T=E;if(this.checkSignature(p.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===d.MAX_VALUE_16BITS||this.diskWithCentralDirStart===d.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===d.MAX_VALUE_16BITS||this.centralDirRecords===d.MAX_VALUE_16BITS||this.centralDirSize===d.MAX_VALUE_32BITS||this.centralDirOffset===d.MAX_VALUE_32BITS){if(this.zip64=!0,(E=this.reader.lastIndexOfSignature(p.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(E),this.checkSignature(p.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,p.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(p.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(p.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var S=this.centralDirOffset+this.centralDirSize;this.zip64&&(S+=20,S+=12+this.zip64EndOfCentralSize);var I=T-S;if(0<I)this.isSignature(T,p.CENTRAL_FILE_HEADER)||(this.reader.zero=I);else if(I<0)throw new Error("Corrupted zip: missing "+Math.abs(I)+" bytes.")},prepareReader:function(E){this.reader=f(E)},load:function(E){this.prepareReader(E),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},s.exports=b},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(a,s,c){var f=a("./reader/readerFor"),d=a("./utils"),p=a("./compressedObject"),g=a("./crc32"),y=a("./utf8"),b=a("./compressions"),E=a("./support");function T(S,I){this.options=S,this.loadOptions=I}T.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(S){var I,A;if(S.skip(22),this.fileNameLength=S.readInt(2),A=S.readInt(2),this.fileName=S.readData(this.fileNameLength),S.skip(A),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((I=function(M){for(var F in b)if(Object.prototype.hasOwnProperty.call(b,F)&&b[F].magic===M)return b[F];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+d.pretty(this.compressionMethod)+" unknown (inner file : "+d.transformTo("string",this.fileName)+")");this.decompressed=new p(this.compressedSize,this.uncompressedSize,this.crc32,I,S.readData(this.compressedSize))},readCentralPart:function(S){this.versionMadeBy=S.readInt(2),S.skip(2),this.bitFlag=S.readInt(2),this.compressionMethod=S.readString(2),this.date=S.readDate(),this.crc32=S.readInt(4),this.compressedSize=S.readInt(4),this.uncompressedSize=S.readInt(4);var I=S.readInt(2);if(this.extraFieldsLength=S.readInt(2),this.fileCommentLength=S.readInt(2),this.diskNumberStart=S.readInt(2),this.internalFileAttributes=S.readInt(2),this.externalFileAttributes=S.readInt(4),this.localHeaderOffset=S.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");S.skip(I),this.readExtraFields(S),this.parseZIP64ExtraField(S),this.fileComment=S.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var S=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),S==0&&(this.dosPermissions=63&this.externalFileAttributes),S==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var S=f(this.extraFields[1].value);this.uncompressedSize===d.MAX_VALUE_32BITS&&(this.uncompressedSize=S.readInt(8)),this.compressedSize===d.MAX_VALUE_32BITS&&(this.compressedSize=S.readInt(8)),this.localHeaderOffset===d.MAX_VALUE_32BITS&&(this.localHeaderOffset=S.readInt(8)),this.diskNumberStart===d.MAX_VALUE_32BITS&&(this.diskNumberStart=S.readInt(4))}},readExtraFields:function(S){var I,A,M,F=S.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});S.index+4<F;)I=S.readInt(2),A=S.readInt(2),M=S.readData(A),this.extraFields[I]={id:I,length:A,value:M};S.setIndex(F)},handleUTF8:function(){var S=E.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=y.utf8decode(this.fileName),this.fileCommentStr=y.utf8decode(this.fileComment);else{var I=this.findExtraFieldUnicodePath();if(I!==null)this.fileNameStr=I;else{var A=d.transformTo(S,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(A)}var M=this.findExtraFieldUnicodeComment();if(M!==null)this.fileCommentStr=M;else{var F=d.transformTo(S,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(F)}}},findExtraFieldUnicodePath:function(){var S=this.extraFields[28789];if(S){var I=f(S.value);return I.readInt(1)!==1||g(this.fileName)!==I.readInt(4)?null:y.utf8decode(I.readData(S.length-5))}return null},findExtraFieldUnicodeComment:function(){var S=this.extraFields[25461];if(S){var I=f(S.value);return I.readInt(1)!==1||g(this.fileComment)!==I.readInt(4)?null:y.utf8decode(I.readData(S.length-5))}return null}},s.exports=T},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(a,s,c){function f(I,A,M){this.name=I,this.dir=M.dir,this.date=M.date,this.comment=M.comment,this.unixPermissions=M.unixPermissions,this.dosPermissions=M.dosPermissions,this._data=A,this._dataBinary=M.binary,this.options={compression:M.compression,compressionOptions:M.compressionOptions}}var d=a("./stream/StreamHelper"),p=a("./stream/DataWorker"),g=a("./utf8"),y=a("./compressedObject"),b=a("./stream/GenericWorker");f.prototype={internalStream:function(I){var A=null,M="string";try{if(!I)throw new Error("No output type specified.");var F=(M=I.toLowerCase())==="string"||M==="text";M!=="binarystring"&&M!=="text"||(M="string"),A=this._decompressWorker();var L=!this._dataBinary;L&&!F&&(A=A.pipe(new g.Utf8EncodeWorker)),!L&&F&&(A=A.pipe(new g.Utf8DecodeWorker))}catch(O){(A=new b("error")).error(O)}return new d(A,M,"")},async:function(I,A){return this.internalStream(I).accumulate(A)},nodeStream:function(I,A){return this.internalStream(I||"nodebuffer").toNodejsStream(A)},_compressWorker:function(I,A){if(this._data instanceof y&&this._data.compression.magic===I.magic)return this._data.getCompressedWorker();var M=this._decompressWorker();return this._dataBinary||(M=M.pipe(new g.Utf8EncodeWorker)),y.createWorkerFrom(M,I,A)},_decompressWorker:function(){return this._data instanceof y?this._data.getContentWorker():this._data instanceof b?this._data:new p(this._data)}};for(var E=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],T=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},S=0;S<E.length;S++)f.prototype[E[S]]=T;s.exports=f},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(a,s,c){(function(f){var d,p,g=f.MutationObserver||f.WebKitMutationObserver;if(g){var y=0,b=new g(I),E=f.document.createTextNode("");b.observe(E,{characterData:!0}),d=function(){E.data=y=++y%2}}else if(f.setImmediate||f.MessageChannel===void 0)d="document"in f&&"onreadystatechange"in f.document.createElement("script")?function(){var A=f.document.createElement("script");A.onreadystatechange=function(){I(),A.onreadystatechange=null,A.parentNode.removeChild(A),A=null},f.document.documentElement.appendChild(A)}:function(){setTimeout(I,0)};else{var T=new f.MessageChannel;T.port1.onmessage=I,d=function(){T.port2.postMessage(0)}}var S=[];function I(){var A,M;p=!0;for(var F=S.length;F;){for(M=S,S=[],A=-1;++A<F;)M[A]();F=S.length}p=!1}s.exports=function(A){S.push(A)!==1||p||d()}}).call(this,typeof $o<"u"?$o:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(a,s,c){var f=a("immediate");function d(){}var p={},g=["REJECTED"],y=["FULFILLED"],b=["PENDING"];function E(F){if(typeof F!="function")throw new TypeError("resolver must be a function");this.state=b,this.queue=[],this.outcome=void 0,F!==d&&A(this,F)}function T(F,L,O){this.promise=F,typeof L=="function"&&(this.onFulfilled=L,this.callFulfilled=this.otherCallFulfilled),typeof O=="function"&&(this.onRejected=O,this.callRejected=this.otherCallRejected)}function S(F,L,O){f(function(){var N;try{N=L(O)}catch(Q){return p.reject(F,Q)}N===F?p.reject(F,new TypeError("Cannot resolve promise with itself")):p.resolve(F,N)})}function I(F){var L=F&&F.then;if(F&&(typeof F=="object"||typeof F=="function")&&typeof L=="function")return function(){L.apply(F,arguments)}}function A(F,L){var O=!1;function N(j){O||(O=!0,p.reject(F,j))}function Q(j){O||(O=!0,p.resolve(F,j))}var ie=M(function(){L(Q,N)});ie.status==="error"&&N(ie.value)}function M(F,L){var O={};try{O.value=F(L),O.status="success"}catch(N){O.status="error",O.value=N}return O}(s.exports=E).prototype.finally=function(F){if(typeof F!="function")return this;var L=this.constructor;return this.then(function(O){return L.resolve(F()).then(function(){return O})},function(O){return L.resolve(F()).then(function(){throw O})})},E.prototype.catch=function(F){return this.then(null,F)},E.prototype.then=function(F,L){if(typeof F!="function"&&this.state===y||typeof L!="function"&&this.state===g)return this;var O=new this.constructor(d);return this.state!==b?S(O,this.state===y?F:L,this.outcome):this.queue.push(new T(O,F,L)),O},T.prototype.callFulfilled=function(F){p.resolve(this.promise,F)},T.prototype.otherCallFulfilled=function(F){S(this.promise,this.onFulfilled,F)},T.prototype.callRejected=function(F){p.reject(this.promise,F)},T.prototype.otherCallRejected=function(F){S(this.promise,this.onRejected,F)},p.resolve=function(F,L){var O=M(I,L);if(O.status==="error")return p.reject(F,O.value);var N=O.value;if(N)A(F,N);else{F.state=y,F.outcome=L;for(var Q=-1,ie=F.queue.length;++Q<ie;)F.queue[Q].callFulfilled(L)}return F},p.reject=function(F,L){F.state=g,F.outcome=L;for(var O=-1,N=F.queue.length;++O<N;)F.queue[O].callRejected(L);return F},E.resolve=function(F){return F instanceof this?F:p.resolve(new this(d),F)},E.reject=function(F){var L=new this(d);return p.reject(L,F)},E.all=function(F){var L=this;if(Object.prototype.toString.call(F)!=="[object Array]")return this.reject(new TypeError("must be an array"));var O=F.length,N=!1;if(!O)return this.resolve([]);for(var Q=new Array(O),ie=0,j=-1,V=new this(d);++j<O;)D(F[j],j);return V;function D(te,ue){L.resolve(te).then(function(J){Q[ue]=J,++ie!==O||N||(N=!0,p.resolve(V,Q))},function(J){N||(N=!0,p.reject(V,J))})}},E.race=function(F){var L=this;if(Object.prototype.toString.call(F)!=="[object Array]")return this.reject(new TypeError("must be an array"));var O=F.length,N=!1;if(!O)return this.resolve([]);for(var Q=-1,ie=new this(d);++Q<O;)j=F[Q],L.resolve(j).then(function(V){N||(N=!0,p.resolve(ie,V))},function(V){N||(N=!0,p.reject(ie,V))});var j;return ie}},{immediate:36}],38:[function(a,s,c){var f={};(0,a("./lib/utils/common").assign)(f,a("./lib/deflate"),a("./lib/inflate"),a("./lib/zlib/constants")),s.exports=f},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(a,s,c){var f=a("./zlib/deflate"),d=a("./utils/common"),p=a("./utils/strings"),g=a("./zlib/messages"),y=a("./zlib/zstream"),b=Object.prototype.toString,E=0,T=-1,S=0,I=8;function A(F){if(!(this instanceof A))return new A(F);this.options=d.assign({level:T,method:I,chunkSize:16384,windowBits:15,memLevel:8,strategy:S,to:""},F||{});var L=this.options;L.raw&&0<L.windowBits?L.windowBits=-L.windowBits:L.gzip&&0<L.windowBits&&L.windowBits<16&&(L.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new y,this.strm.avail_out=0;var O=f.deflateInit2(this.strm,L.level,L.method,L.windowBits,L.memLevel,L.strategy);if(O!==E)throw new Error(g[O]);if(L.header&&f.deflateSetHeader(this.strm,L.header),L.dictionary){var N;if(N=typeof L.dictionary=="string"?p.string2buf(L.dictionary):b.call(L.dictionary)==="[object ArrayBuffer]"?new Uint8Array(L.dictionary):L.dictionary,(O=f.deflateSetDictionary(this.strm,N))!==E)throw new Error(g[O]);this._dict_set=!0}}function M(F,L){var O=new A(L);if(O.push(F,!0),O.err)throw O.msg||g[O.err];return O.result}A.prototype.push=function(F,L){var O,N,Q=this.strm,ie=this.options.chunkSize;if(this.ended)return!1;N=L===~~L?L:L===!0?4:0,typeof F=="string"?Q.input=p.string2buf(F):b.call(F)==="[object ArrayBuffer]"?Q.input=new Uint8Array(F):Q.input=F,Q.next_in=0,Q.avail_in=Q.input.length;do{if(Q.avail_out===0&&(Q.output=new d.Buf8(ie),Q.next_out=0,Q.avail_out=ie),(O=f.deflate(Q,N))!==1&&O!==E)return this.onEnd(O),!(this.ended=!0);Q.avail_out!==0&&(Q.avail_in!==0||N!==4&&N!==2)||(this.options.to==="string"?this.onData(p.buf2binstring(d.shrinkBuf(Q.output,Q.next_out))):this.onData(d.shrinkBuf(Q.output,Q.next_out)))}while((0<Q.avail_in||Q.avail_out===0)&&O!==1);return N===4?(O=f.deflateEnd(this.strm),this.onEnd(O),this.ended=!0,O===E):N!==2||(this.onEnd(E),!(Q.avail_out=0))},A.prototype.onData=function(F){this.chunks.push(F)},A.prototype.onEnd=function(F){F===E&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=d.flattenChunks(this.chunks)),this.chunks=[],this.err=F,this.msg=this.strm.msg},c.Deflate=A,c.deflate=M,c.deflateRaw=function(F,L){return(L=L||{}).raw=!0,M(F,L)},c.gzip=function(F,L){return(L=L||{}).gzip=!0,M(F,L)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(a,s,c){var f=a("./zlib/inflate"),d=a("./utils/common"),p=a("./utils/strings"),g=a("./zlib/constants"),y=a("./zlib/messages"),b=a("./zlib/zstream"),E=a("./zlib/gzheader"),T=Object.prototype.toString;function S(A){if(!(this instanceof S))return new S(A);this.options=d.assign({chunkSize:16384,windowBits:0,to:""},A||{});var M=this.options;M.raw&&0<=M.windowBits&&M.windowBits<16&&(M.windowBits=-M.windowBits,M.windowBits===0&&(M.windowBits=-15)),!(0<=M.windowBits&&M.windowBits<16)||A&&A.windowBits||(M.windowBits+=32),15<M.windowBits&&M.windowBits<48&&!(15&M.windowBits)&&(M.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new b,this.strm.avail_out=0;var F=f.inflateInit2(this.strm,M.windowBits);if(F!==g.Z_OK)throw new Error(y[F]);this.header=new E,f.inflateGetHeader(this.strm,this.header)}function I(A,M){var F=new S(M);if(F.push(A,!0),F.err)throw F.msg||y[F.err];return F.result}S.prototype.push=function(A,M){var F,L,O,N,Q,ie,j=this.strm,V=this.options.chunkSize,D=this.options.dictionary,te=!1;if(this.ended)return!1;L=M===~~M?M:M===!0?g.Z_FINISH:g.Z_NO_FLUSH,typeof A=="string"?j.input=p.binstring2buf(A):T.call(A)==="[object ArrayBuffer]"?j.input=new Uint8Array(A):j.input=A,j.next_in=0,j.avail_in=j.input.length;do{if(j.avail_out===0&&(j.output=new d.Buf8(V),j.next_out=0,j.avail_out=V),(F=f.inflate(j,g.Z_NO_FLUSH))===g.Z_NEED_DICT&&D&&(ie=typeof D=="string"?p.string2buf(D):T.call(D)==="[object ArrayBuffer]"?new Uint8Array(D):D,F=f.inflateSetDictionary(this.strm,ie)),F===g.Z_BUF_ERROR&&te===!0&&(F=g.Z_OK,te=!1),F!==g.Z_STREAM_END&&F!==g.Z_OK)return this.onEnd(F),!(this.ended=!0);j.next_out&&(j.avail_out!==0&&F!==g.Z_STREAM_END&&(j.avail_in!==0||L!==g.Z_FINISH&&L!==g.Z_SYNC_FLUSH)||(this.options.to==="string"?(O=p.utf8border(j.output,j.next_out),N=j.next_out-O,Q=p.buf2string(j.output,O),j.next_out=N,j.avail_out=V-N,N&&d.arraySet(j.output,j.output,O,N,0),this.onData(Q)):this.onData(d.shrinkBuf(j.output,j.next_out)))),j.avail_in===0&&j.avail_out===0&&(te=!0)}while((0<j.avail_in||j.avail_out===0)&&F!==g.Z_STREAM_END);return F===g.Z_STREAM_END&&(L=g.Z_FINISH),L===g.Z_FINISH?(F=f.inflateEnd(this.strm),this.onEnd(F),this.ended=!0,F===g.Z_OK):L!==g.Z_SYNC_FLUSH||(this.onEnd(g.Z_OK),!(j.avail_out=0))},S.prototype.onData=function(A){this.chunks.push(A)},S.prototype.onEnd=function(A){A===g.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=d.flattenChunks(this.chunks)),this.chunks=[],this.err=A,this.msg=this.strm.msg},c.Inflate=S,c.inflate=I,c.inflateRaw=function(A,M){return(M=M||{}).raw=!0,I(A,M)},c.ungzip=I},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(a,s,c){var f=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";c.assign=function(g){for(var y=Array.prototype.slice.call(arguments,1);y.length;){var b=y.shift();if(b){if(typeof b!="object")throw new TypeError(b+"must be non-object");for(var E in b)b.hasOwnProperty(E)&&(g[E]=b[E])}}return g},c.shrinkBuf=function(g,y){return g.length===y?g:g.subarray?g.subarray(0,y):(g.length=y,g)};var d={arraySet:function(g,y,b,E,T){if(y.subarray&&g.subarray)g.set(y.subarray(b,b+E),T);else for(var S=0;S<E;S++)g[T+S]=y[b+S]},flattenChunks:function(g){var y,b,E,T,S,I;for(y=E=0,b=g.length;y<b;y++)E+=g[y].length;for(I=new Uint8Array(E),y=T=0,b=g.length;y<b;y++)S=g[y],I.set(S,T),T+=S.length;return I}},p={arraySet:function(g,y,b,E,T){for(var S=0;S<E;S++)g[T+S]=y[b+S]},flattenChunks:function(g){return[].concat.apply([],g)}};c.setTyped=function(g){g?(c.Buf8=Uint8Array,c.Buf16=Uint16Array,c.Buf32=Int32Array,c.assign(c,d)):(c.Buf8=Array,c.Buf16=Array,c.Buf32=Array,c.assign(c,p))},c.setTyped(f)},{}],42:[function(a,s,c){var f=a("./common"),d=!0,p=!0;try{String.fromCharCode.apply(null,[0])}catch{d=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{p=!1}for(var g=new f.Buf8(256),y=0;y<256;y++)g[y]=252<=y?6:248<=y?5:240<=y?4:224<=y?3:192<=y?2:1;function b(E,T){if(T<65537&&(E.subarray&&p||!E.subarray&&d))return String.fromCharCode.apply(null,f.shrinkBuf(E,T));for(var S="",I=0;I<T;I++)S+=String.fromCharCode(E[I]);return S}g[254]=g[254]=1,c.string2buf=function(E){var T,S,I,A,M,F=E.length,L=0;for(A=0;A<F;A++)(64512&(S=E.charCodeAt(A)))==55296&&A+1<F&&(64512&(I=E.charCodeAt(A+1)))==56320&&(S=65536+(S-55296<<10)+(I-56320),A++),L+=S<128?1:S<2048?2:S<65536?3:4;for(T=new f.Buf8(L),A=M=0;M<L;A++)(64512&(S=E.charCodeAt(A)))==55296&&A+1<F&&(64512&(I=E.charCodeAt(A+1)))==56320&&(S=65536+(S-55296<<10)+(I-56320),A++),S<128?T[M++]=S:(S<2048?T[M++]=192|S>>>6:(S<65536?T[M++]=224|S>>>12:(T[M++]=240|S>>>18,T[M++]=128|S>>>12&63),T[M++]=128|S>>>6&63),T[M++]=128|63&S);return T},c.buf2binstring=function(E){return b(E,E.length)},c.binstring2buf=function(E){for(var T=new f.Buf8(E.length),S=0,I=T.length;S<I;S++)T[S]=E.charCodeAt(S);return T},c.buf2string=function(E,T){var S,I,A,M,F=T||E.length,L=new Array(2*F);for(S=I=0;S<F;)if((A=E[S++])<128)L[I++]=A;else if(4<(M=g[A]))L[I++]=65533,S+=M-1;else{for(A&=M===2?31:M===3?15:7;1<M&&S<F;)A=A<<6|63&E[S++],M--;1<M?L[I++]=65533:A<65536?L[I++]=A:(A-=65536,L[I++]=55296|A>>10&1023,L[I++]=56320|1023&A)}return b(L,I)},c.utf8border=function(E,T){var S;for((T=T||E.length)>E.length&&(T=E.length),S=T-1;0<=S&&(192&E[S])==128;)S--;return S<0||S===0?T:S+g[E[S]]>T?S:T}},{"./common":41}],43:[function(a,s,c){s.exports=function(f,d,p,g){for(var y=65535&f|0,b=f>>>16&65535|0,E=0;p!==0;){for(p-=E=2e3<p?2e3:p;b=b+(y=y+d[g++]|0)|0,--E;);y%=65521,b%=65521}return y|b<<16|0}},{}],44:[function(a,s,c){s.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(a,s,c){var f=function(){for(var d,p=[],g=0;g<256;g++){d=g;for(var y=0;y<8;y++)d=1&d?3988292384^d>>>1:d>>>1;p[g]=d}return p}();s.exports=function(d,p,g,y){var b=f,E=y+g;d^=-1;for(var T=y;T<E;T++)d=d>>>8^b[255&(d^p[T])];return-1^d}},{}],46:[function(a,s,c){var f,d=a("../utils/common"),p=a("./trees"),g=a("./adler32"),y=a("./crc32"),b=a("./messages"),E=0,T=4,S=0,I=-2,A=-1,M=4,F=2,L=8,O=9,N=286,Q=30,ie=19,j=2*N+1,V=15,D=3,te=258,ue=te+D+1,J=42,le=113,re=1,Fe=2,Ye=3,Ee=4;function ut(X,Ce){return X.msg=b[Ce],Ce}function Ne(X){return(X<<1)-(4<X?9:0)}function He(X){for(var Ce=X.length;0<=--Ce;)X[Ce]=0}function Oe(X){var Ce=X.state,he=Ce.pending;he>X.avail_out&&(he=X.avail_out),he!==0&&(d.arraySet(X.output,Ce.pending_buf,Ce.pending_out,he,X.next_out),X.next_out+=he,Ce.pending_out+=he,X.total_out+=he,X.avail_out-=he,Ce.pending-=he,Ce.pending===0&&(Ce.pending_out=0))}function Pe(X,Ce){p._tr_flush_block(X,0<=X.block_start?X.block_start:-1,X.strstart-X.block_start,Ce),X.block_start=X.strstart,Oe(X.strm)}function rt(X,Ce){X.pending_buf[X.pending++]=Ce}function et(X,Ce){X.pending_buf[X.pending++]=Ce>>>8&255,X.pending_buf[X.pending++]=255&Ce}function Ge(X,Ce){var he,G,K=X.max_chain_length,se=X.strstart,Ae=X.prev_length,Se=X.nice_match,ye=X.strstart>X.w_size-ue?X.strstart-(X.w_size-ue):0,Xe=X.window,be=X.w_mask,Be=X.prev,ct=X.strstart+te,At=Xe[se+Ae-1],$t=Xe[se+Ae];X.prev_length>=X.good_match&&(K>>=2),Se>X.lookahead&&(Se=X.lookahead);do if(Xe[(he=Ce)+Ae]===$t&&Xe[he+Ae-1]===At&&Xe[he]===Xe[se]&&Xe[++he]===Xe[se+1]){se+=2,he++;do;while(Xe[++se]===Xe[++he]&&Xe[++se]===Xe[++he]&&Xe[++se]===Xe[++he]&&Xe[++se]===Xe[++he]&&Xe[++se]===Xe[++he]&&Xe[++se]===Xe[++he]&&Xe[++se]===Xe[++he]&&Xe[++se]===Xe[++he]&&se<ct);if(G=te-(ct-se),se=ct-te,Ae<G){if(X.match_start=Ce,Se<=(Ae=G))break;At=Xe[se+Ae-1],$t=Xe[se+Ae]}}while((Ce=Be[Ce&be])>ye&&--K!=0);return Ae<=X.lookahead?Ae:X.lookahead}function ze(X){var Ce,he,G,K,se,Ae,Se,ye,Xe,be,Be=X.w_size;do{if(K=X.window_size-X.lookahead-X.strstart,X.strstart>=Be+(Be-ue)){for(d.arraySet(X.window,X.window,Be,Be,0),X.match_start-=Be,X.strstart-=Be,X.block_start-=Be,Ce=he=X.hash_size;G=X.head[--Ce],X.head[Ce]=Be<=G?G-Be:0,--he;);for(Ce=he=Be;G=X.prev[--Ce],X.prev[Ce]=Be<=G?G-Be:0,--he;);K+=Be}if(X.strm.avail_in===0)break;if(Ae=X.strm,Se=X.window,ye=X.strstart+X.lookahead,Xe=K,be=void 0,be=Ae.avail_in,Xe<be&&(be=Xe),he=be===0?0:(Ae.avail_in-=be,d.arraySet(Se,Ae.input,Ae.next_in,be,ye),Ae.state.wrap===1?Ae.adler=g(Ae.adler,Se,be,ye):Ae.state.wrap===2&&(Ae.adler=y(Ae.adler,Se,be,ye)),Ae.next_in+=be,Ae.total_in+=be,be),X.lookahead+=he,X.lookahead+X.insert>=D)for(se=X.strstart-X.insert,X.ins_h=X.window[se],X.ins_h=(X.ins_h<<X.hash_shift^X.window[se+1])&X.hash_mask;X.insert&&(X.ins_h=(X.ins_h<<X.hash_shift^X.window[se+D-1])&X.hash_mask,X.prev[se&X.w_mask]=X.head[X.ins_h],X.head[X.ins_h]=se,se++,X.insert--,!(X.lookahead+X.insert<D)););}while(X.lookahead<ue&&X.strm.avail_in!==0)}function oe(X,Ce){for(var he,G;;){if(X.lookahead<ue){if(ze(X),X.lookahead<ue&&Ce===E)return re;if(X.lookahead===0)break}if(he=0,X.lookahead>=D&&(X.ins_h=(X.ins_h<<X.hash_shift^X.window[X.strstart+D-1])&X.hash_mask,he=X.prev[X.strstart&X.w_mask]=X.head[X.ins_h],X.head[X.ins_h]=X.strstart),he!==0&&X.strstart-he<=X.w_size-ue&&(X.match_length=Ge(X,he)),X.match_length>=D)if(G=p._tr_tally(X,X.strstart-X.match_start,X.match_length-D),X.lookahead-=X.match_length,X.match_length<=X.max_lazy_match&&X.lookahead>=D){for(X.match_length--;X.strstart++,X.ins_h=(X.ins_h<<X.hash_shift^X.window[X.strstart+D-1])&X.hash_mask,he=X.prev[X.strstart&X.w_mask]=X.head[X.ins_h],X.head[X.ins_h]=X.strstart,--X.match_length!=0;);X.strstart++}else X.strstart+=X.match_length,X.match_length=0,X.ins_h=X.window[X.strstart],X.ins_h=(X.ins_h<<X.hash_shift^X.window[X.strstart+1])&X.hash_mask;else G=p._tr_tally(X,0,X.window[X.strstart]),X.lookahead--,X.strstart++;if(G&&(Pe(X,!1),X.strm.avail_out===0))return re}return X.insert=X.strstart<D-1?X.strstart:D-1,Ce===T?(Pe(X,!0),X.strm.avail_out===0?Ye:Ee):X.last_lit&&(Pe(X,!1),X.strm.avail_out===0)?re:Fe}function Me(X,Ce){for(var he,G,K;;){if(X.lookahead<ue){if(ze(X),X.lookahead<ue&&Ce===E)return re;if(X.lookahead===0)break}if(he=0,X.lookahead>=D&&(X.ins_h=(X.ins_h<<X.hash_shift^X.window[X.strstart+D-1])&X.hash_mask,he=X.prev[X.strstart&X.w_mask]=X.head[X.ins_h],X.head[X.ins_h]=X.strstart),X.prev_length=X.match_length,X.prev_match=X.match_start,X.match_length=D-1,he!==0&&X.prev_length<X.max_lazy_match&&X.strstart-he<=X.w_size-ue&&(X.match_length=Ge(X,he),X.match_length<=5&&(X.strategy===1||X.match_length===D&&4096<X.strstart-X.match_start)&&(X.match_length=D-1)),X.prev_length>=D&&X.match_length<=X.prev_length){for(K=X.strstart+X.lookahead-D,G=p._tr_tally(X,X.strstart-1-X.prev_match,X.prev_length-D),X.lookahead-=X.prev_length-1,X.prev_length-=2;++X.strstart<=K&&(X.ins_h=(X.ins_h<<X.hash_shift^X.window[X.strstart+D-1])&X.hash_mask,he=X.prev[X.strstart&X.w_mask]=X.head[X.ins_h],X.head[X.ins_h]=X.strstart),--X.prev_length!=0;);if(X.match_available=0,X.match_length=D-1,X.strstart++,G&&(Pe(X,!1),X.strm.avail_out===0))return re}else if(X.match_available){if((G=p._tr_tally(X,0,X.window[X.strstart-1]))&&Pe(X,!1),X.strstart++,X.lookahead--,X.strm.avail_out===0)return re}else X.match_available=1,X.strstart++,X.lookahead--}return X.match_available&&(G=p._tr_tally(X,0,X.window[X.strstart-1]),X.match_available=0),X.insert=X.strstart<D-1?X.strstart:D-1,Ce===T?(Pe(X,!0),X.strm.avail_out===0?Ye:Ee):X.last_lit&&(Pe(X,!1),X.strm.avail_out===0)?re:Fe}function fe(X,Ce,he,G,K){this.good_length=X,this.max_lazy=Ce,this.nice_length=he,this.max_chain=G,this.func=K}function pe(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=L,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new d.Buf16(2*j),this.dyn_dtree=new d.Buf16(2*(2*Q+1)),this.bl_tree=new d.Buf16(2*(2*ie+1)),He(this.dyn_ltree),He(this.dyn_dtree),He(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new d.Buf16(V+1),this.heap=new d.Buf16(2*N+1),He(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new d.Buf16(2*N+1),He(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function ot(X){var Ce;return X&&X.state?(X.total_in=X.total_out=0,X.data_type=F,(Ce=X.state).pending=0,Ce.pending_out=0,Ce.wrap<0&&(Ce.wrap=-Ce.wrap),Ce.status=Ce.wrap?J:le,X.adler=Ce.wrap===2?0:1,Ce.last_flush=E,p._tr_init(Ce),S):ut(X,I)}function xe(X){var Ce=ot(X);return Ce===S&&function(he){he.window_size=2*he.w_size,He(he.head),he.max_lazy_match=f[he.level].max_lazy,he.good_match=f[he.level].good_length,he.nice_match=f[he.level].nice_length,he.max_chain_length=f[he.level].max_chain,he.strstart=0,he.block_start=0,he.lookahead=0,he.insert=0,he.match_length=he.prev_length=D-1,he.match_available=0,he.ins_h=0}(X.state),Ce}function ae(X,Ce,he,G,K,se){if(!X)return I;var Ae=1;if(Ce===A&&(Ce=6),G<0?(Ae=0,G=-G):15<G&&(Ae=2,G-=16),K<1||O<K||he!==L||G<8||15<G||Ce<0||9<Ce||se<0||M<se)return ut(X,I);G===8&&(G=9);var Se=new pe;return(X.state=Se).strm=X,Se.wrap=Ae,Se.gzhead=null,Se.w_bits=G,Se.w_size=1<<Se.w_bits,Se.w_mask=Se.w_size-1,Se.hash_bits=K+7,Se.hash_size=1<<Se.hash_bits,Se.hash_mask=Se.hash_size-1,Se.hash_shift=~~((Se.hash_bits+D-1)/D),Se.window=new d.Buf8(2*Se.w_size),Se.head=new d.Buf16(Se.hash_size),Se.prev=new d.Buf16(Se.w_size),Se.lit_bufsize=1<<K+6,Se.pending_buf_size=4*Se.lit_bufsize,Se.pending_buf=new d.Buf8(Se.pending_buf_size),Se.d_buf=1*Se.lit_bufsize,Se.l_buf=3*Se.lit_bufsize,Se.level=Ce,Se.strategy=se,Se.method=he,xe(X)}f=[new fe(0,0,0,0,function(X,Ce){var he=65535;for(he>X.pending_buf_size-5&&(he=X.pending_buf_size-5);;){if(X.lookahead<=1){if(ze(X),X.lookahead===0&&Ce===E)return re;if(X.lookahead===0)break}X.strstart+=X.lookahead,X.lookahead=0;var G=X.block_start+he;if((X.strstart===0||X.strstart>=G)&&(X.lookahead=X.strstart-G,X.strstart=G,Pe(X,!1),X.strm.avail_out===0)||X.strstart-X.block_start>=X.w_size-ue&&(Pe(X,!1),X.strm.avail_out===0))return re}return X.insert=0,Ce===T?(Pe(X,!0),X.strm.avail_out===0?Ye:Ee):(X.strstart>X.block_start&&(Pe(X,!1),X.strm.avail_out),re)}),new fe(4,4,8,4,oe),new fe(4,5,16,8,oe),new fe(4,6,32,32,oe),new fe(4,4,16,16,Me),new fe(8,16,32,32,Me),new fe(8,16,128,128,Me),new fe(8,32,128,256,Me),new fe(32,128,258,1024,Me),new fe(32,258,258,4096,Me)],c.deflateInit=function(X,Ce){return ae(X,Ce,L,15,8,0)},c.deflateInit2=ae,c.deflateReset=xe,c.deflateResetKeep=ot,c.deflateSetHeader=function(X,Ce){return X&&X.state?X.state.wrap!==2?I:(X.state.gzhead=Ce,S):I},c.deflate=function(X,Ce){var he,G,K,se;if(!X||!X.state||5<Ce||Ce<0)return X?ut(X,I):I;if(G=X.state,!X.output||!X.input&&X.avail_in!==0||G.status===666&&Ce!==T)return ut(X,X.avail_out===0?-5:I);if(G.strm=X,he=G.last_flush,G.last_flush=Ce,G.status===J)if(G.wrap===2)X.adler=0,rt(G,31),rt(G,139),rt(G,8),G.gzhead?(rt(G,(G.gzhead.text?1:0)+(G.gzhead.hcrc?2:0)+(G.gzhead.extra?4:0)+(G.gzhead.name?8:0)+(G.gzhead.comment?16:0)),rt(G,255&G.gzhead.time),rt(G,G.gzhead.time>>8&255),rt(G,G.gzhead.time>>16&255),rt(G,G.gzhead.time>>24&255),rt(G,G.level===9?2:2<=G.strategy||G.level<2?4:0),rt(G,255&G.gzhead.os),G.gzhead.extra&&G.gzhead.extra.length&&(rt(G,255&G.gzhead.extra.length),rt(G,G.gzhead.extra.length>>8&255)),G.gzhead.hcrc&&(X.adler=y(X.adler,G.pending_buf,G.pending,0)),G.gzindex=0,G.status=69):(rt(G,0),rt(G,0),rt(G,0),rt(G,0),rt(G,0),rt(G,G.level===9?2:2<=G.strategy||G.level<2?4:0),rt(G,3),G.status=le);else{var Ae=L+(G.w_bits-8<<4)<<8;Ae|=(2<=G.strategy||G.level<2?0:G.level<6?1:G.level===6?2:3)<<6,G.strstart!==0&&(Ae|=32),Ae+=31-Ae%31,G.status=le,et(G,Ae),G.strstart!==0&&(et(G,X.adler>>>16),et(G,65535&X.adler)),X.adler=1}if(G.status===69)if(G.gzhead.extra){for(K=G.pending;G.gzindex<(65535&G.gzhead.extra.length)&&(G.pending!==G.pending_buf_size||(G.gzhead.hcrc&&G.pending>K&&(X.adler=y(X.adler,G.pending_buf,G.pending-K,K)),Oe(X),K=G.pending,G.pending!==G.pending_buf_size));)rt(G,255&G.gzhead.extra[G.gzindex]),G.gzindex++;G.gzhead.hcrc&&G.pending>K&&(X.adler=y(X.adler,G.pending_buf,G.pending-K,K)),G.gzindex===G.gzhead.extra.length&&(G.gzindex=0,G.status=73)}else G.status=73;if(G.status===73)if(G.gzhead.name){K=G.pending;do{if(G.pending===G.pending_buf_size&&(G.gzhead.hcrc&&G.pending>K&&(X.adler=y(X.adler,G.pending_buf,G.pending-K,K)),Oe(X),K=G.pending,G.pending===G.pending_buf_size)){se=1;break}se=G.gzindex<G.gzhead.name.length?255&G.gzhead.name.charCodeAt(G.gzindex++):0,rt(G,se)}while(se!==0);G.gzhead.hcrc&&G.pending>K&&(X.adler=y(X.adler,G.pending_buf,G.pending-K,K)),se===0&&(G.gzindex=0,G.status=91)}else G.status=91;if(G.status===91)if(G.gzhead.comment){K=G.pending;do{if(G.pending===G.pending_buf_size&&(G.gzhead.hcrc&&G.pending>K&&(X.adler=y(X.adler,G.pending_buf,G.pending-K,K)),Oe(X),K=G.pending,G.pending===G.pending_buf_size)){se=1;break}se=G.gzindex<G.gzhead.comment.length?255&G.gzhead.comment.charCodeAt(G.gzindex++):0,rt(G,se)}while(se!==0);G.gzhead.hcrc&&G.pending>K&&(X.adler=y(X.adler,G.pending_buf,G.pending-K,K)),se===0&&(G.status=103)}else G.status=103;if(G.status===103&&(G.gzhead.hcrc?(G.pending+2>G.pending_buf_size&&Oe(X),G.pending+2<=G.pending_buf_size&&(rt(G,255&X.adler),rt(G,X.adler>>8&255),X.adler=0,G.status=le)):G.status=le),G.pending!==0){if(Oe(X),X.avail_out===0)return G.last_flush=-1,S}else if(X.avail_in===0&&Ne(Ce)<=Ne(he)&&Ce!==T)return ut(X,-5);if(G.status===666&&X.avail_in!==0)return ut(X,-5);if(X.avail_in!==0||G.lookahead!==0||Ce!==E&&G.status!==666){var Se=G.strategy===2?function(ye,Xe){for(var be;;){if(ye.lookahead===0&&(ze(ye),ye.lookahead===0)){if(Xe===E)return re;break}if(ye.match_length=0,be=p._tr_tally(ye,0,ye.window[ye.strstart]),ye.lookahead--,ye.strstart++,be&&(Pe(ye,!1),ye.strm.avail_out===0))return re}return ye.insert=0,Xe===T?(Pe(ye,!0),ye.strm.avail_out===0?Ye:Ee):ye.last_lit&&(Pe(ye,!1),ye.strm.avail_out===0)?re:Fe}(G,Ce):G.strategy===3?function(ye,Xe){for(var be,Be,ct,At,$t=ye.window;;){if(ye.lookahead<=te){if(ze(ye),ye.lookahead<=te&&Xe===E)return re;if(ye.lookahead===0)break}if(ye.match_length=0,ye.lookahead>=D&&0<ye.strstart&&(Be=$t[ct=ye.strstart-1])===$t[++ct]&&Be===$t[++ct]&&Be===$t[++ct]){At=ye.strstart+te;do;while(Be===$t[++ct]&&Be===$t[++ct]&&Be===$t[++ct]&&Be===$t[++ct]&&Be===$t[++ct]&&Be===$t[++ct]&&Be===$t[++ct]&&Be===$t[++ct]&&ct<At);ye.match_length=te-(At-ct),ye.match_length>ye.lookahead&&(ye.match_length=ye.lookahead)}if(ye.match_length>=D?(be=p._tr_tally(ye,1,ye.match_length-D),ye.lookahead-=ye.match_length,ye.strstart+=ye.match_length,ye.match_length=0):(be=p._tr_tally(ye,0,ye.window[ye.strstart]),ye.lookahead--,ye.strstart++),be&&(Pe(ye,!1),ye.strm.avail_out===0))return re}return ye.insert=0,Xe===T?(Pe(ye,!0),ye.strm.avail_out===0?Ye:Ee):ye.last_lit&&(Pe(ye,!1),ye.strm.avail_out===0)?re:Fe}(G,Ce):f[G.level].func(G,Ce);if(Se!==Ye&&Se!==Ee||(G.status=666),Se===re||Se===Ye)return X.avail_out===0&&(G.last_flush=-1),S;if(Se===Fe&&(Ce===1?p._tr_align(G):Ce!==5&&(p._tr_stored_block(G,0,0,!1),Ce===3&&(He(G.head),G.lookahead===0&&(G.strstart=0,G.block_start=0,G.insert=0))),Oe(X),X.avail_out===0))return G.last_flush=-1,S}return Ce!==T?S:G.wrap<=0?1:(G.wrap===2?(rt(G,255&X.adler),rt(G,X.adler>>8&255),rt(G,X.adler>>16&255),rt(G,X.adler>>24&255),rt(G,255&X.total_in),rt(G,X.total_in>>8&255),rt(G,X.total_in>>16&255),rt(G,X.total_in>>24&255)):(et(G,X.adler>>>16),et(G,65535&X.adler)),Oe(X),0<G.wrap&&(G.wrap=-G.wrap),G.pending!==0?S:1)},c.deflateEnd=function(X){var Ce;return X&&X.state?(Ce=X.state.status)!==J&&Ce!==69&&Ce!==73&&Ce!==91&&Ce!==103&&Ce!==le&&Ce!==666?ut(X,I):(X.state=null,Ce===le?ut(X,-3):S):I},c.deflateSetDictionary=function(X,Ce){var he,G,K,se,Ae,Se,ye,Xe,be=Ce.length;if(!X||!X.state||(se=(he=X.state).wrap)===2||se===1&&he.status!==J||he.lookahead)return I;for(se===1&&(X.adler=g(X.adler,Ce,be,0)),he.wrap=0,be>=he.w_size&&(se===0&&(He(he.head),he.strstart=0,he.block_start=0,he.insert=0),Xe=new d.Buf8(he.w_size),d.arraySet(Xe,Ce,be-he.w_size,he.w_size,0),Ce=Xe,be=he.w_size),Ae=X.avail_in,Se=X.next_in,ye=X.input,X.avail_in=be,X.next_in=0,X.input=Ce,ze(he);he.lookahead>=D;){for(G=he.strstart,K=he.lookahead-(D-1);he.ins_h=(he.ins_h<<he.hash_shift^he.window[G+D-1])&he.hash_mask,he.prev[G&he.w_mask]=he.head[he.ins_h],he.head[he.ins_h]=G,G++,--K;);he.strstart=G,he.lookahead=D-1,ze(he)}return he.strstart+=he.lookahead,he.block_start=he.strstart,he.insert=he.lookahead,he.lookahead=0,he.match_length=he.prev_length=D-1,he.match_available=0,X.next_in=Se,X.input=ye,X.avail_in=Ae,he.wrap=se,S},c.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(a,s,c){s.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(a,s,c){s.exports=function(f,d){var p,g,y,b,E,T,S,I,A,M,F,L,O,N,Q,ie,j,V,D,te,ue,J,le,re,Fe;p=f.state,g=f.next_in,re=f.input,y=g+(f.avail_in-5),b=f.next_out,Fe=f.output,E=b-(d-f.avail_out),T=b+(f.avail_out-257),S=p.dmax,I=p.wsize,A=p.whave,M=p.wnext,F=p.window,L=p.hold,O=p.bits,N=p.lencode,Q=p.distcode,ie=(1<<p.lenbits)-1,j=(1<<p.distbits)-1;e:do{O<15&&(L+=re[g++]<<O,O+=8,L+=re[g++]<<O,O+=8),V=N[L&ie];t:for(;;){if(L>>>=D=V>>>24,O-=D,(D=V>>>16&255)===0)Fe[b++]=65535&V;else{if(!(16&D)){if(!(64&D)){V=N[(65535&V)+(L&(1<<D)-1)];continue t}if(32&D){p.mode=12;break e}f.msg="invalid literal/length code",p.mode=30;break e}te=65535&V,(D&=15)&&(O<D&&(L+=re[g++]<<O,O+=8),te+=L&(1<<D)-1,L>>>=D,O-=D),O<15&&(L+=re[g++]<<O,O+=8,L+=re[g++]<<O,O+=8),V=Q[L&j];r:for(;;){if(L>>>=D=V>>>24,O-=D,!(16&(D=V>>>16&255))){if(!(64&D)){V=Q[(65535&V)+(L&(1<<D)-1)];continue r}f.msg="invalid distance code",p.mode=30;break e}if(ue=65535&V,O<(D&=15)&&(L+=re[g++]<<O,(O+=8)<D&&(L+=re[g++]<<O,O+=8)),S<(ue+=L&(1<<D)-1)){f.msg="invalid distance too far back",p.mode=30;break e}if(L>>>=D,O-=D,(D=b-E)<ue){if(A<(D=ue-D)&&p.sane){f.msg="invalid distance too far back",p.mode=30;break e}if(le=F,(J=0)===M){if(J+=I-D,D<te){for(te-=D;Fe[b++]=F[J++],--D;);J=b-ue,le=Fe}}else if(M<D){if(J+=I+M-D,(D-=M)<te){for(te-=D;Fe[b++]=F[J++],--D;);if(J=0,M<te){for(te-=D=M;Fe[b++]=F[J++],--D;);J=b-ue,le=Fe}}}else if(J+=M-D,D<te){for(te-=D;Fe[b++]=F[J++],--D;);J=b-ue,le=Fe}for(;2<te;)Fe[b++]=le[J++],Fe[b++]=le[J++],Fe[b++]=le[J++],te-=3;te&&(Fe[b++]=le[J++],1<te&&(Fe[b++]=le[J++]))}else{for(J=b-ue;Fe[b++]=Fe[J++],Fe[b++]=Fe[J++],Fe[b++]=Fe[J++],2<(te-=3););te&&(Fe[b++]=Fe[J++],1<te&&(Fe[b++]=Fe[J++]))}break}}break}}while(g<y&&b<T);g-=te=O>>3,L&=(1<<(O-=te<<3))-1,f.next_in=g,f.next_out=b,f.avail_in=g<y?y-g+5:5-(g-y),f.avail_out=b<T?T-b+257:257-(b-T),p.hold=L,p.bits=O}},{}],49:[function(a,s,c){var f=a("../utils/common"),d=a("./adler32"),p=a("./crc32"),g=a("./inffast"),y=a("./inftrees"),b=1,E=2,T=0,S=-2,I=1,A=852,M=592;function F(J){return(J>>>24&255)+(J>>>8&65280)+((65280&J)<<8)+((255&J)<<24)}function L(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new f.Buf16(320),this.work=new f.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function O(J){var le;return J&&J.state?(le=J.state,J.total_in=J.total_out=le.total=0,J.msg="",le.wrap&&(J.adler=1&le.wrap),le.mode=I,le.last=0,le.havedict=0,le.dmax=32768,le.head=null,le.hold=0,le.bits=0,le.lencode=le.lendyn=new f.Buf32(A),le.distcode=le.distdyn=new f.Buf32(M),le.sane=1,le.back=-1,T):S}function N(J){var le;return J&&J.state?((le=J.state).wsize=0,le.whave=0,le.wnext=0,O(J)):S}function Q(J,le){var re,Fe;return J&&J.state?(Fe=J.state,le<0?(re=0,le=-le):(re=1+(le>>4),le<48&&(le&=15)),le&&(le<8||15<le)?S:(Fe.window!==null&&Fe.wbits!==le&&(Fe.window=null),Fe.wrap=re,Fe.wbits=le,N(J))):S}function ie(J,le){var re,Fe;return J?(Fe=new L,(J.state=Fe).window=null,(re=Q(J,le))!==T&&(J.state=null),re):S}var j,V,D=!0;function te(J){if(D){var le;for(j=new f.Buf32(512),V=new f.Buf32(32),le=0;le<144;)J.lens[le++]=8;for(;le<256;)J.lens[le++]=9;for(;le<280;)J.lens[le++]=7;for(;le<288;)J.lens[le++]=8;for(y(b,J.lens,0,288,j,0,J.work,{bits:9}),le=0;le<32;)J.lens[le++]=5;y(E,J.lens,0,32,V,0,J.work,{bits:5}),D=!1}J.lencode=j,J.lenbits=9,J.distcode=V,J.distbits=5}function ue(J,le,re,Fe){var Ye,Ee=J.state;return Ee.window===null&&(Ee.wsize=1<<Ee.wbits,Ee.wnext=0,Ee.whave=0,Ee.window=new f.Buf8(Ee.wsize)),Fe>=Ee.wsize?(f.arraySet(Ee.window,le,re-Ee.wsize,Ee.wsize,0),Ee.wnext=0,Ee.whave=Ee.wsize):(Fe<(Ye=Ee.wsize-Ee.wnext)&&(Ye=Fe),f.arraySet(Ee.window,le,re-Fe,Ye,Ee.wnext),(Fe-=Ye)?(f.arraySet(Ee.window,le,re-Fe,Fe,0),Ee.wnext=Fe,Ee.whave=Ee.wsize):(Ee.wnext+=Ye,Ee.wnext===Ee.wsize&&(Ee.wnext=0),Ee.whave<Ee.wsize&&(Ee.whave+=Ye))),0}c.inflateReset=N,c.inflateReset2=Q,c.inflateResetKeep=O,c.inflateInit=function(J){return ie(J,15)},c.inflateInit2=ie,c.inflate=function(J,le){var re,Fe,Ye,Ee,ut,Ne,He,Oe,Pe,rt,et,Ge,ze,oe,Me,fe,pe,ot,xe,ae,X,Ce,he,G,K=0,se=new f.Buf8(4),Ae=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!J||!J.state||!J.output||!J.input&&J.avail_in!==0)return S;(re=J.state).mode===12&&(re.mode=13),ut=J.next_out,Ye=J.output,He=J.avail_out,Ee=J.next_in,Fe=J.input,Ne=J.avail_in,Oe=re.hold,Pe=re.bits,rt=Ne,et=He,Ce=T;e:for(;;)switch(re.mode){case I:if(re.wrap===0){re.mode=13;break}for(;Pe<16;){if(Ne===0)break e;Ne--,Oe+=Fe[Ee++]<<Pe,Pe+=8}if(2&re.wrap&&Oe===35615){se[re.check=0]=255&Oe,se[1]=Oe>>>8&255,re.check=p(re.check,se,2,0),Pe=Oe=0,re.mode=2;break}if(re.flags=0,re.head&&(re.head.done=!1),!(1&re.wrap)||(((255&Oe)<<8)+(Oe>>8))%31){J.msg="incorrect header check",re.mode=30;break}if((15&Oe)!=8){J.msg="unknown compression method",re.mode=30;break}if(Pe-=4,X=8+(15&(Oe>>>=4)),re.wbits===0)re.wbits=X;else if(X>re.wbits){J.msg="invalid window size",re.mode=30;break}re.dmax=1<<X,J.adler=re.check=1,re.mode=512&Oe?10:12,Pe=Oe=0;break;case 2:for(;Pe<16;){if(Ne===0)break e;Ne--,Oe+=Fe[Ee++]<<Pe,Pe+=8}if(re.flags=Oe,(255&re.flags)!=8){J.msg="unknown compression method",re.mode=30;break}if(57344&re.flags){J.msg="unknown header flags set",re.mode=30;break}re.head&&(re.head.text=Oe>>8&1),512&re.flags&&(se[0]=255&Oe,se[1]=Oe>>>8&255,re.check=p(re.check,se,2,0)),Pe=Oe=0,re.mode=3;case 3:for(;Pe<32;){if(Ne===0)break e;Ne--,Oe+=Fe[Ee++]<<Pe,Pe+=8}re.head&&(re.head.time=Oe),512&re.flags&&(se[0]=255&Oe,se[1]=Oe>>>8&255,se[2]=Oe>>>16&255,se[3]=Oe>>>24&255,re.check=p(re.check,se,4,0)),Pe=Oe=0,re.mode=4;case 4:for(;Pe<16;){if(Ne===0)break e;Ne--,Oe+=Fe[Ee++]<<Pe,Pe+=8}re.head&&(re.head.xflags=255&Oe,re.head.os=Oe>>8),512&re.flags&&(se[0]=255&Oe,se[1]=Oe>>>8&255,re.check=p(re.check,se,2,0)),Pe=Oe=0,re.mode=5;case 5:if(1024&re.flags){for(;Pe<16;){if(Ne===0)break e;Ne--,Oe+=Fe[Ee++]<<Pe,Pe+=8}re.length=Oe,re.head&&(re.head.extra_len=Oe),512&re.flags&&(se[0]=255&Oe,se[1]=Oe>>>8&255,re.check=p(re.check,se,2,0)),Pe=Oe=0}else re.head&&(re.head.extra=null);re.mode=6;case 6:if(1024&re.flags&&(Ne<(Ge=re.length)&&(Ge=Ne),Ge&&(re.head&&(X=re.head.extra_len-re.length,re.head.extra||(re.head.extra=new Array(re.head.extra_len)),f.arraySet(re.head.extra,Fe,Ee,Ge,X)),512&re.flags&&(re.check=p(re.check,Fe,Ge,Ee)),Ne-=Ge,Ee+=Ge,re.length-=Ge),re.length))break e;re.length=0,re.mode=7;case 7:if(2048&re.flags){if(Ne===0)break e;for(Ge=0;X=Fe[Ee+Ge++],re.head&&X&&re.length<65536&&(re.head.name+=String.fromCharCode(X)),X&&Ge<Ne;);if(512&re.flags&&(re.check=p(re.check,Fe,Ge,Ee)),Ne-=Ge,Ee+=Ge,X)break e}else re.head&&(re.head.name=null);re.length=0,re.mode=8;case 8:if(4096&re.flags){if(Ne===0)break e;for(Ge=0;X=Fe[Ee+Ge++],re.head&&X&&re.length<65536&&(re.head.comment+=String.fromCharCode(X)),X&&Ge<Ne;);if(512&re.flags&&(re.check=p(re.check,Fe,Ge,Ee)),Ne-=Ge,Ee+=Ge,X)break e}else re.head&&(re.head.comment=null);re.mode=9;case 9:if(512&re.flags){for(;Pe<16;){if(Ne===0)break e;Ne--,Oe+=Fe[Ee++]<<Pe,Pe+=8}if(Oe!==(65535&re.check)){J.msg="header crc mismatch",re.mode=30;break}Pe=Oe=0}re.head&&(re.head.hcrc=re.flags>>9&1,re.head.done=!0),J.adler=re.check=0,re.mode=12;break;case 10:for(;Pe<32;){if(Ne===0)break e;Ne--,Oe+=Fe[Ee++]<<Pe,Pe+=8}J.adler=re.check=F(Oe),Pe=Oe=0,re.mode=11;case 11:if(re.havedict===0)return J.next_out=ut,J.avail_out=He,J.next_in=Ee,J.avail_in=Ne,re.hold=Oe,re.bits=Pe,2;J.adler=re.check=1,re.mode=12;case 12:if(le===5||le===6)break e;case 13:if(re.last){Oe>>>=7&Pe,Pe-=7&Pe,re.mode=27;break}for(;Pe<3;){if(Ne===0)break e;Ne--,Oe+=Fe[Ee++]<<Pe,Pe+=8}switch(re.last=1&Oe,Pe-=1,3&(Oe>>>=1)){case 0:re.mode=14;break;case 1:if(te(re),re.mode=20,le!==6)break;Oe>>>=2,Pe-=2;break e;case 2:re.mode=17;break;case 3:J.msg="invalid block type",re.mode=30}Oe>>>=2,Pe-=2;break;case 14:for(Oe>>>=7&Pe,Pe-=7&Pe;Pe<32;){if(Ne===0)break e;Ne--,Oe+=Fe[Ee++]<<Pe,Pe+=8}if((65535&Oe)!=(Oe>>>16^65535)){J.msg="invalid stored block lengths",re.mode=30;break}if(re.length=65535&Oe,Pe=Oe=0,re.mode=15,le===6)break e;case 15:re.mode=16;case 16:if(Ge=re.length){if(Ne<Ge&&(Ge=Ne),He<Ge&&(Ge=He),Ge===0)break e;f.arraySet(Ye,Fe,Ee,Ge,ut),Ne-=Ge,Ee+=Ge,He-=Ge,ut+=Ge,re.length-=Ge;break}re.mode=12;break;case 17:for(;Pe<14;){if(Ne===0)break e;Ne--,Oe+=Fe[Ee++]<<Pe,Pe+=8}if(re.nlen=257+(31&Oe),Oe>>>=5,Pe-=5,re.ndist=1+(31&Oe),Oe>>>=5,Pe-=5,re.ncode=4+(15&Oe),Oe>>>=4,Pe-=4,286<re.nlen||30<re.ndist){J.msg="too many length or distance symbols",re.mode=30;break}re.have=0,re.mode=18;case 18:for(;re.have<re.ncode;){for(;Pe<3;){if(Ne===0)break e;Ne--,Oe+=Fe[Ee++]<<Pe,Pe+=8}re.lens[Ae[re.have++]]=7&Oe,Oe>>>=3,Pe-=3}for(;re.have<19;)re.lens[Ae[re.have++]]=0;if(re.lencode=re.lendyn,re.lenbits=7,he={bits:re.lenbits},Ce=y(0,re.lens,0,19,re.lencode,0,re.work,he),re.lenbits=he.bits,Ce){J.msg="invalid code lengths set",re.mode=30;break}re.have=0,re.mode=19;case 19:for(;re.have<re.nlen+re.ndist;){for(;fe=(K=re.lencode[Oe&(1<<re.lenbits)-1])>>>16&255,pe=65535&K,!((Me=K>>>24)<=Pe);){if(Ne===0)break e;Ne--,Oe+=Fe[Ee++]<<Pe,Pe+=8}if(pe<16)Oe>>>=Me,Pe-=Me,re.lens[re.have++]=pe;else{if(pe===16){for(G=Me+2;Pe<G;){if(Ne===0)break e;Ne--,Oe+=Fe[Ee++]<<Pe,Pe+=8}if(Oe>>>=Me,Pe-=Me,re.have===0){J.msg="invalid bit length repeat",re.mode=30;break}X=re.lens[re.have-1],Ge=3+(3&Oe),Oe>>>=2,Pe-=2}else if(pe===17){for(G=Me+3;Pe<G;){if(Ne===0)break e;Ne--,Oe+=Fe[Ee++]<<Pe,Pe+=8}Pe-=Me,X=0,Ge=3+(7&(Oe>>>=Me)),Oe>>>=3,Pe-=3}else{for(G=Me+7;Pe<G;){if(Ne===0)break e;Ne--,Oe+=Fe[Ee++]<<Pe,Pe+=8}Pe-=Me,X=0,Ge=11+(127&(Oe>>>=Me)),Oe>>>=7,Pe-=7}if(re.have+Ge>re.nlen+re.ndist){J.msg="invalid bit length repeat",re.mode=30;break}for(;Ge--;)re.lens[re.have++]=X}}if(re.mode===30)break;if(re.lens[256]===0){J.msg="invalid code -- missing end-of-block",re.mode=30;break}if(re.lenbits=9,he={bits:re.lenbits},Ce=y(b,re.lens,0,re.nlen,re.lencode,0,re.work,he),re.lenbits=he.bits,Ce){J.msg="invalid literal/lengths set",re.mode=30;break}if(re.distbits=6,re.distcode=re.distdyn,he={bits:re.distbits},Ce=y(E,re.lens,re.nlen,re.ndist,re.distcode,0,re.work,he),re.distbits=he.bits,Ce){J.msg="invalid distances set",re.mode=30;break}if(re.mode=20,le===6)break e;case 20:re.mode=21;case 21:if(6<=Ne&&258<=He){J.next_out=ut,J.avail_out=He,J.next_in=Ee,J.avail_in=Ne,re.hold=Oe,re.bits=Pe,g(J,et),ut=J.next_out,Ye=J.output,He=J.avail_out,Ee=J.next_in,Fe=J.input,Ne=J.avail_in,Oe=re.hold,Pe=re.bits,re.mode===12&&(re.back=-1);break}for(re.back=0;fe=(K=re.lencode[Oe&(1<<re.lenbits)-1])>>>16&255,pe=65535&K,!((Me=K>>>24)<=Pe);){if(Ne===0)break e;Ne--,Oe+=Fe[Ee++]<<Pe,Pe+=8}if(fe&&!(240&fe)){for(ot=Me,xe=fe,ae=pe;fe=(K=re.lencode[ae+((Oe&(1<<ot+xe)-1)>>ot)])>>>16&255,pe=65535&K,!(ot+(Me=K>>>24)<=Pe);){if(Ne===0)break e;Ne--,Oe+=Fe[Ee++]<<Pe,Pe+=8}Oe>>>=ot,Pe-=ot,re.back+=ot}if(Oe>>>=Me,Pe-=Me,re.back+=Me,re.length=pe,fe===0){re.mode=26;break}if(32&fe){re.back=-1,re.mode=12;break}if(64&fe){J.msg="invalid literal/length code",re.mode=30;break}re.extra=15&fe,re.mode=22;case 22:if(re.extra){for(G=re.extra;Pe<G;){if(Ne===0)break e;Ne--,Oe+=Fe[Ee++]<<Pe,Pe+=8}re.length+=Oe&(1<<re.extra)-1,Oe>>>=re.extra,Pe-=re.extra,re.back+=re.extra}re.was=re.length,re.mode=23;case 23:for(;fe=(K=re.distcode[Oe&(1<<re.distbits)-1])>>>16&255,pe=65535&K,!((Me=K>>>24)<=Pe);){if(Ne===0)break e;Ne--,Oe+=Fe[Ee++]<<Pe,Pe+=8}if(!(240&fe)){for(ot=Me,xe=fe,ae=pe;fe=(K=re.distcode[ae+((Oe&(1<<ot+xe)-1)>>ot)])>>>16&255,pe=65535&K,!(ot+(Me=K>>>24)<=Pe);){if(Ne===0)break e;Ne--,Oe+=Fe[Ee++]<<Pe,Pe+=8}Oe>>>=ot,Pe-=ot,re.back+=ot}if(Oe>>>=Me,Pe-=Me,re.back+=Me,64&fe){J.msg="invalid distance code",re.mode=30;break}re.offset=pe,re.extra=15&fe,re.mode=24;case 24:if(re.extra){for(G=re.extra;Pe<G;){if(Ne===0)break e;Ne--,Oe+=Fe[Ee++]<<Pe,Pe+=8}re.offset+=Oe&(1<<re.extra)-1,Oe>>>=re.extra,Pe-=re.extra,re.back+=re.extra}if(re.offset>re.dmax){J.msg="invalid distance too far back",re.mode=30;break}re.mode=25;case 25:if(He===0)break e;if(Ge=et-He,re.offset>Ge){if((Ge=re.offset-Ge)>re.whave&&re.sane){J.msg="invalid distance too far back",re.mode=30;break}ze=Ge>re.wnext?(Ge-=re.wnext,re.wsize-Ge):re.wnext-Ge,Ge>re.length&&(Ge=re.length),oe=re.window}else oe=Ye,ze=ut-re.offset,Ge=re.length;for(He<Ge&&(Ge=He),He-=Ge,re.length-=Ge;Ye[ut++]=oe[ze++],--Ge;);re.length===0&&(re.mode=21);break;case 26:if(He===0)break e;Ye[ut++]=re.length,He--,re.mode=21;break;case 27:if(re.wrap){for(;Pe<32;){if(Ne===0)break e;Ne--,Oe|=Fe[Ee++]<<Pe,Pe+=8}if(et-=He,J.total_out+=et,re.total+=et,et&&(J.adler=re.check=re.flags?p(re.check,Ye,et,ut-et):d(re.check,Ye,et,ut-et)),et=He,(re.flags?Oe:F(Oe))!==re.check){J.msg="incorrect data check",re.mode=30;break}Pe=Oe=0}re.mode=28;case 28:if(re.wrap&&re.flags){for(;Pe<32;){if(Ne===0)break e;Ne--,Oe+=Fe[Ee++]<<Pe,Pe+=8}if(Oe!==(4294967295&re.total)){J.msg="incorrect length check",re.mode=30;break}Pe=Oe=0}re.mode=29;case 29:Ce=1;break e;case 30:Ce=-3;break e;case 31:return-4;case 32:default:return S}return J.next_out=ut,J.avail_out=He,J.next_in=Ee,J.avail_in=Ne,re.hold=Oe,re.bits=Pe,(re.wsize||et!==J.avail_out&&re.mode<30&&(re.mode<27||le!==4))&&ue(J,J.output,J.next_out,et-J.avail_out)?(re.mode=31,-4):(rt-=J.avail_in,et-=J.avail_out,J.total_in+=rt,J.total_out+=et,re.total+=et,re.wrap&&et&&(J.adler=re.check=re.flags?p(re.check,Ye,et,J.next_out-et):d(re.check,Ye,et,J.next_out-et)),J.data_type=re.bits+(re.last?64:0)+(re.mode===12?128:0)+(re.mode===20||re.mode===15?256:0),(rt==0&&et===0||le===4)&&Ce===T&&(Ce=-5),Ce)},c.inflateEnd=function(J){if(!J||!J.state)return S;var le=J.state;return le.window&&(le.window=null),J.state=null,T},c.inflateGetHeader=function(J,le){var re;return J&&J.state&&2&(re=J.state).wrap?((re.head=le).done=!1,T):S},c.inflateSetDictionary=function(J,le){var re,Fe=le.length;return J&&J.state?(re=J.state).wrap!==0&&re.mode!==11?S:re.mode===11&&d(1,le,Fe,0)!==re.check?-3:ue(J,le,Fe,Fe)?(re.mode=31,-4):(re.havedict=1,T):S},c.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(a,s,c){var f=a("../utils/common"),d=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],p=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],g=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],y=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];s.exports=function(b,E,T,S,I,A,M,F){var L,O,N,Q,ie,j,V,D,te,ue=F.bits,J=0,le=0,re=0,Fe=0,Ye=0,Ee=0,ut=0,Ne=0,He=0,Oe=0,Pe=null,rt=0,et=new f.Buf16(16),Ge=new f.Buf16(16),ze=null,oe=0;for(J=0;J<=15;J++)et[J]=0;for(le=0;le<S;le++)et[E[T+le]]++;for(Ye=ue,Fe=15;1<=Fe&&et[Fe]===0;Fe--);if(Fe<Ye&&(Ye=Fe),Fe===0)return I[A++]=20971520,I[A++]=20971520,F.bits=1,0;for(re=1;re<Fe&&et[re]===0;re++);for(Ye<re&&(Ye=re),J=Ne=1;J<=15;J++)if(Ne<<=1,(Ne-=et[J])<0)return-1;if(0<Ne&&(b===0||Fe!==1))return-1;for(Ge[1]=0,J=1;J<15;J++)Ge[J+1]=Ge[J]+et[J];for(le=0;le<S;le++)E[T+le]!==0&&(M[Ge[E[T+le]]++]=le);if(j=b===0?(Pe=ze=M,19):b===1?(Pe=d,rt-=257,ze=p,oe-=257,256):(Pe=g,ze=y,-1),J=re,ie=A,ut=le=Oe=0,N=-1,Q=(He=1<<(Ee=Ye))-1,b===1&&852<He||b===2&&592<He)return 1;for(;;){for(V=J-ut,te=M[le]<j?(D=0,M[le]):M[le]>j?(D=ze[oe+M[le]],Pe[rt+M[le]]):(D=96,0),L=1<<J-ut,re=O=1<<Ee;I[ie+(Oe>>ut)+(O-=L)]=V<<24|D<<16|te|0,O!==0;);for(L=1<<J-1;Oe&L;)L>>=1;if(L!==0?(Oe&=L-1,Oe+=L):Oe=0,le++,--et[J]==0){if(J===Fe)break;J=E[T+M[le]]}if(Ye<J&&(Oe&Q)!==N){for(ut===0&&(ut=Ye),ie+=re,Ne=1<<(Ee=J-ut);Ee+ut<Fe&&!((Ne-=et[Ee+ut])<=0);)Ee++,Ne<<=1;if(He+=1<<Ee,b===1&&852<He||b===2&&592<He)return 1;I[N=Oe&Q]=Ye<<24|Ee<<16|ie-A|0}}return Oe!==0&&(I[ie+Oe]=J-ut<<24|64<<16|0),F.bits=Ye,0}},{"../utils/common":41}],51:[function(a,s,c){s.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(a,s,c){var f=a("../utils/common"),d=0,p=1;function g(K){for(var se=K.length;0<=--se;)K[se]=0}var y=0,b=29,E=256,T=E+1+b,S=30,I=19,A=2*T+1,M=15,F=16,L=7,O=256,N=16,Q=17,ie=18,j=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],V=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],D=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],te=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ue=new Array(2*(T+2));g(ue);var J=new Array(2*S);g(J);var le=new Array(512);g(le);var re=new Array(256);g(re);var Fe=new Array(b);g(Fe);var Ye,Ee,ut,Ne=new Array(S);function He(K,se,Ae,Se,ye){this.static_tree=K,this.extra_bits=se,this.extra_base=Ae,this.elems=Se,this.max_length=ye,this.has_stree=K&&K.length}function Oe(K,se){this.dyn_tree=K,this.max_code=0,this.stat_desc=se}function Pe(K){return K<256?le[K]:le[256+(K>>>7)]}function rt(K,se){K.pending_buf[K.pending++]=255&se,K.pending_buf[K.pending++]=se>>>8&255}function et(K,se,Ae){K.bi_valid>F-Ae?(K.bi_buf|=se<<K.bi_valid&65535,rt(K,K.bi_buf),K.bi_buf=se>>F-K.bi_valid,K.bi_valid+=Ae-F):(K.bi_buf|=se<<K.bi_valid&65535,K.bi_valid+=Ae)}function Ge(K,se,Ae){et(K,Ae[2*se],Ae[2*se+1])}function ze(K,se){for(var Ae=0;Ae|=1&K,K>>>=1,Ae<<=1,0<--se;);return Ae>>>1}function oe(K,se,Ae){var Se,ye,Xe=new Array(M+1),be=0;for(Se=1;Se<=M;Se++)Xe[Se]=be=be+Ae[Se-1]<<1;for(ye=0;ye<=se;ye++){var Be=K[2*ye+1];Be!==0&&(K[2*ye]=ze(Xe[Be]++,Be))}}function Me(K){var se;for(se=0;se<T;se++)K.dyn_ltree[2*se]=0;for(se=0;se<S;se++)K.dyn_dtree[2*se]=0;for(se=0;se<I;se++)K.bl_tree[2*se]=0;K.dyn_ltree[2*O]=1,K.opt_len=K.static_len=0,K.last_lit=K.matches=0}function fe(K){8<K.bi_valid?rt(K,K.bi_buf):0<K.bi_valid&&(K.pending_buf[K.pending++]=K.bi_buf),K.bi_buf=0,K.bi_valid=0}function pe(K,se,Ae,Se){var ye=2*se,Xe=2*Ae;return K[ye]<K[Xe]||K[ye]===K[Xe]&&Se[se]<=Se[Ae]}function ot(K,se,Ae){for(var Se=K.heap[Ae],ye=Ae<<1;ye<=K.heap_len&&(ye<K.heap_len&&pe(se,K.heap[ye+1],K.heap[ye],K.depth)&&ye++,!pe(se,Se,K.heap[ye],K.depth));)K.heap[Ae]=K.heap[ye],Ae=ye,ye<<=1;K.heap[Ae]=Se}function xe(K,se,Ae){var Se,ye,Xe,be,Be=0;if(K.last_lit!==0)for(;Se=K.pending_buf[K.d_buf+2*Be]<<8|K.pending_buf[K.d_buf+2*Be+1],ye=K.pending_buf[K.l_buf+Be],Be++,Se===0?Ge(K,ye,se):(Ge(K,(Xe=re[ye])+E+1,se),(be=j[Xe])!==0&&et(K,ye-=Fe[Xe],be),Ge(K,Xe=Pe(--Se),Ae),(be=V[Xe])!==0&&et(K,Se-=Ne[Xe],be)),Be<K.last_lit;);Ge(K,O,se)}function ae(K,se){var Ae,Se,ye,Xe=se.dyn_tree,be=se.stat_desc.static_tree,Be=se.stat_desc.has_stree,ct=se.stat_desc.elems,At=-1;for(K.heap_len=0,K.heap_max=A,Ae=0;Ae<ct;Ae++)Xe[2*Ae]!==0?(K.heap[++K.heap_len]=At=Ae,K.depth[Ae]=0):Xe[2*Ae+1]=0;for(;K.heap_len<2;)Xe[2*(ye=K.heap[++K.heap_len]=At<2?++At:0)]=1,K.depth[ye]=0,K.opt_len--,Be&&(K.static_len-=be[2*ye+1]);for(se.max_code=At,Ae=K.heap_len>>1;1<=Ae;Ae--)ot(K,Xe,Ae);for(ye=ct;Ae=K.heap[1],K.heap[1]=K.heap[K.heap_len--],ot(K,Xe,1),Se=K.heap[1],K.heap[--K.heap_max]=Ae,K.heap[--K.heap_max]=Se,Xe[2*ye]=Xe[2*Ae]+Xe[2*Se],K.depth[ye]=(K.depth[Ae]>=K.depth[Se]?K.depth[Ae]:K.depth[Se])+1,Xe[2*Ae+1]=Xe[2*Se+1]=ye,K.heap[1]=ye++,ot(K,Xe,1),2<=K.heap_len;);K.heap[--K.heap_max]=K.heap[1],function($t,mr){var Nt,Lt,Qt,Gt,dr,Br,qr=mr.dyn_tree,Ci=mr.max_code,Wi=mr.stat_desc.static_tree,Fi=mr.stat_desc.has_stree,Ta=mr.stat_desc.extra_bits,Sa=mr.stat_desc.extra_base,Ai=mr.stat_desc.max_length,Le=0;for(Gt=0;Gt<=M;Gt++)$t.bl_count[Gt]=0;for(qr[2*$t.heap[$t.heap_max]+1]=0,Nt=$t.heap_max+1;Nt<A;Nt++)Ai<(Gt=qr[2*qr[2*(Lt=$t.heap[Nt])+1]+1]+1)&&(Gt=Ai,Le++),qr[2*Lt+1]=Gt,Ci<Lt||($t.bl_count[Gt]++,dr=0,Sa<=Lt&&(dr=Ta[Lt-Sa]),Br=qr[2*Lt],$t.opt_len+=Br*(Gt+dr),Fi&&($t.static_len+=Br*(Wi[2*Lt+1]+dr)));if(Le!==0){do{for(Gt=Ai-1;$t.bl_count[Gt]===0;)Gt--;$t.bl_count[Gt]--,$t.bl_count[Gt+1]+=2,$t.bl_count[Ai]--,Le-=2}while(0<Le);for(Gt=Ai;Gt!==0;Gt--)for(Lt=$t.bl_count[Gt];Lt!==0;)Ci<(Qt=$t.heap[--Nt])||(qr[2*Qt+1]!==Gt&&($t.opt_len+=(Gt-qr[2*Qt+1])*qr[2*Qt],qr[2*Qt+1]=Gt),Lt--)}}(K,se),oe(Xe,At,K.bl_count)}function X(K,se,Ae){var Se,ye,Xe=-1,be=se[1],Be=0,ct=7,At=4;for(be===0&&(ct=138,At=3),se[2*(Ae+1)+1]=65535,Se=0;Se<=Ae;Se++)ye=be,be=se[2*(Se+1)+1],++Be<ct&&ye===be||(Be<At?K.bl_tree[2*ye]+=Be:ye!==0?(ye!==Xe&&K.bl_tree[2*ye]++,K.bl_tree[2*N]++):Be<=10?K.bl_tree[2*Q]++:K.bl_tree[2*ie]++,Xe=ye,At=(Be=0)===be?(ct=138,3):ye===be?(ct=6,3):(ct=7,4))}function Ce(K,se,Ae){var Se,ye,Xe=-1,be=se[1],Be=0,ct=7,At=4;for(be===0&&(ct=138,At=3),Se=0;Se<=Ae;Se++)if(ye=be,be=se[2*(Se+1)+1],!(++Be<ct&&ye===be)){if(Be<At)for(;Ge(K,ye,K.bl_tree),--Be!=0;);else ye!==0?(ye!==Xe&&(Ge(K,ye,K.bl_tree),Be--),Ge(K,N,K.bl_tree),et(K,Be-3,2)):Be<=10?(Ge(K,Q,K.bl_tree),et(K,Be-3,3)):(Ge(K,ie,K.bl_tree),et(K,Be-11,7));Xe=ye,At=(Be=0)===be?(ct=138,3):ye===be?(ct=6,3):(ct=7,4)}}g(Ne);var he=!1;function G(K,se,Ae,Se){et(K,(y<<1)+(Se?1:0),3),function(ye,Xe,be,Be){fe(ye),Be&&(rt(ye,be),rt(ye,~be)),f.arraySet(ye.pending_buf,ye.window,Xe,be,ye.pending),ye.pending+=be}(K,se,Ae,!0)}c._tr_init=function(K){he||(function(){var se,Ae,Se,ye,Xe,be=new Array(M+1);for(ye=Se=0;ye<b-1;ye++)for(Fe[ye]=Se,se=0;se<1<<j[ye];se++)re[Se++]=ye;for(re[Se-1]=ye,ye=Xe=0;ye<16;ye++)for(Ne[ye]=Xe,se=0;se<1<<V[ye];se++)le[Xe++]=ye;for(Xe>>=7;ye<S;ye++)for(Ne[ye]=Xe<<7,se=0;se<1<<V[ye]-7;se++)le[256+Xe++]=ye;for(Ae=0;Ae<=M;Ae++)be[Ae]=0;for(se=0;se<=143;)ue[2*se+1]=8,se++,be[8]++;for(;se<=255;)ue[2*se+1]=9,se++,be[9]++;for(;se<=279;)ue[2*se+1]=7,se++,be[7]++;for(;se<=287;)ue[2*se+1]=8,se++,be[8]++;for(oe(ue,T+1,be),se=0;se<S;se++)J[2*se+1]=5,J[2*se]=ze(se,5);Ye=new He(ue,j,E+1,T,M),Ee=new He(J,V,0,S,M),ut=new He(new Array(0),D,0,I,L)}(),he=!0),K.l_desc=new Oe(K.dyn_ltree,Ye),K.d_desc=new Oe(K.dyn_dtree,Ee),K.bl_desc=new Oe(K.bl_tree,ut),K.bi_buf=0,K.bi_valid=0,Me(K)},c._tr_stored_block=G,c._tr_flush_block=function(K,se,Ae,Se){var ye,Xe,be=0;0<K.level?(K.strm.data_type===2&&(K.strm.data_type=function(Be){var ct,At=4093624447;for(ct=0;ct<=31;ct++,At>>>=1)if(1&At&&Be.dyn_ltree[2*ct]!==0)return d;if(Be.dyn_ltree[18]!==0||Be.dyn_ltree[20]!==0||Be.dyn_ltree[26]!==0)return p;for(ct=32;ct<E;ct++)if(Be.dyn_ltree[2*ct]!==0)return p;return d}(K)),ae(K,K.l_desc),ae(K,K.d_desc),be=function(Be){var ct;for(X(Be,Be.dyn_ltree,Be.l_desc.max_code),X(Be,Be.dyn_dtree,Be.d_desc.max_code),ae(Be,Be.bl_desc),ct=I-1;3<=ct&&Be.bl_tree[2*te[ct]+1]===0;ct--);return Be.opt_len+=3*(ct+1)+5+5+4,ct}(K),ye=K.opt_len+3+7>>>3,(Xe=K.static_len+3+7>>>3)<=ye&&(ye=Xe)):ye=Xe=Ae+5,Ae+4<=ye&&se!==-1?G(K,se,Ae,Se):K.strategy===4||Xe===ye?(et(K,2+(Se?1:0),3),xe(K,ue,J)):(et(K,4+(Se?1:0),3),function(Be,ct,At,$t){var mr;for(et(Be,ct-257,5),et(Be,At-1,5),et(Be,$t-4,4),mr=0;mr<$t;mr++)et(Be,Be.bl_tree[2*te[mr]+1],3);Ce(Be,Be.dyn_ltree,ct-1),Ce(Be,Be.dyn_dtree,At-1)}(K,K.l_desc.max_code+1,K.d_desc.max_code+1,be+1),xe(K,K.dyn_ltree,K.dyn_dtree)),Me(K),Se&&fe(K)},c._tr_tally=function(K,se,Ae){return K.pending_buf[K.d_buf+2*K.last_lit]=se>>>8&255,K.pending_buf[K.d_buf+2*K.last_lit+1]=255&se,K.pending_buf[K.l_buf+K.last_lit]=255&Ae,K.last_lit++,se===0?K.dyn_ltree[2*Ae]++:(K.matches++,se--,K.dyn_ltree[2*(re[Ae]+E+1)]++,K.dyn_dtree[2*Pe(se)]++),K.last_lit===K.lit_bufsize-1},c._tr_align=function(K){et(K,2,3),Ge(K,O,ue),function(se){se.bi_valid===16?(rt(se,se.bi_buf),se.bi_buf=0,se.bi_valid=0):8<=se.bi_valid&&(se.pending_buf[se.pending++]=255&se.bi_buf,se.bi_buf>>=8,se.bi_valid-=8)}(K)}},{"../utils/common":41}],53:[function(a,s,c){s.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(a,s,c){(function(f){(function(d,p){if(!d.setImmediate){var g,y,b,E,T=1,S={},I=!1,A=d.document,M=Object.getPrototypeOf&&Object.getPrototypeOf(d);M=M&&M.setTimeout?M:d,g={}.toString.call(d.process)==="[object process]"?function(N){process.nextTick(function(){L(N)})}:function(){if(d.postMessage&&!d.importScripts){var N=!0,Q=d.onmessage;return d.onmessage=function(){N=!1},d.postMessage("","*"),d.onmessage=Q,N}}()?(E="setImmediate$"+Math.random()+"$",d.addEventListener?d.addEventListener("message",O,!1):d.attachEvent("onmessage",O),function(N){d.postMessage(E+N,"*")}):d.MessageChannel?((b=new MessageChannel).port1.onmessage=function(N){L(N.data)},function(N){b.port2.postMessage(N)}):A&&"onreadystatechange"in A.createElement("script")?(y=A.documentElement,function(N){var Q=A.createElement("script");Q.onreadystatechange=function(){L(N),Q.onreadystatechange=null,y.removeChild(Q),Q=null},y.appendChild(Q)}):function(N){setTimeout(L,0,N)},M.setImmediate=function(N){typeof N!="function"&&(N=new Function(""+N));for(var Q=new Array(arguments.length-1),ie=0;ie<Q.length;ie++)Q[ie]=arguments[ie+1];var j={callback:N,args:Q};return S[T]=j,g(T),T++},M.clearImmediate=F}function F(N){delete S[N]}function L(N){if(I)setTimeout(L,0,N);else{var Q=S[N];if(Q){I=!0;try{(function(ie){var j=ie.callback,V=ie.args;switch(V.length){case 0:j();break;case 1:j(V[0]);break;case 2:j(V[0],V[1]);break;case 3:j(V[0],V[1],V[2]);break;default:j.apply(p,V)}})(Q)}finally{F(N),I=!1}}}}function O(N){N.source===d&&typeof N.data=="string"&&N.data.indexOf(E)===0&&L(+N.data.slice(E.length))}})(typeof self>"u"?f===void 0?this:f:self)}).call(this,typeof $o<"u"?$o:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(q7);var F3e=q7.exports,P3e=G7,$g=Sm,O3e=W7,R3e=F3e,X7=function(t,n,a=!1){let s=new R3e,c=s;n&&n.folder&&(c=s.folder(n.folder));var f=n&&n.prj?n.prj:O3e;[$g.point(t),$g.line(t),$g.polygon(t),$g.multipolygon(t),$g.multiline(t)].forEach(function(p){p.geometries.length&&p.geometries[0].length&&P3e(p.properties,p.type,p.geometries,function(g,y){var b=n&&n.types&&n.types[p.type.toLowerCase()]?n.types[p.type.toLowerCase()]:p.type;c.file(b+".shp",y.shp.buffer,{binary:!0}),c.file(b+".shx",y.shx.buffer,{binary:!0}),c.file(b+".dbf",y.dbf.buffer,{binary:!0}),c.file(b+".prj",f)})});var d={};return!n||!n.outputType?d.type="base64":d.type=n.outputType,!n||!n.compression?d.compression="DEFLATE":d.compression=n.compression,a?s.generateNodeStream({...d,streamFiles:!0}):s.generateAsync(d)},Z7={exports:{}};(function(t,n){(function(a,s){s()})($o,function(){function a(y,b){return typeof b>"u"?b={autoBom:!1}:typeof b!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),b={autoBom:!b}),b.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(y.type)?new Blob(["\uFEFF",y],{type:y.type}):y}function s(y,b,E){var T=new XMLHttpRequest;T.open("GET",y),T.responseType="blob",T.onload=function(){g(T.response,b,E)},T.onerror=function(){console.error("could not download file")},T.send()}function c(y){var b=new XMLHttpRequest;b.open("HEAD",y,!1);try{b.send()}catch{}return 200<=b.status&&299>=b.status}function f(y){try{y.dispatchEvent(new MouseEvent("click"))}catch{var b=document.createEvent("MouseEvents");b.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),y.dispatchEvent(b)}}var d=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof $o=="object"&&$o.global===$o?$o:void 0,p=d.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),g=d.saveAs||(typeof window!="object"||window!==d?function(){}:"download"in HTMLAnchorElement.prototype&&!p?function(y,b,E){var T=d.URL||d.webkitURL,S=document.createElement("a");b=b||y.name||"download",S.download=b,S.rel="noopener",typeof y=="string"?(S.href=y,S.origin===location.origin?f(S):c(S.href)?s(y,b,E):f(S,S.target="_blank")):(S.href=T.createObjectURL(y),setTimeout(function(){T.revokeObjectURL(S.href)},4e4),setTimeout(function(){f(S)},0))}:"msSaveOrOpenBlob"in navigator?function(y,b,E){if(b=b||y.name||"download",typeof y!="string")navigator.msSaveOrOpenBlob(a(y,E),b);else if(c(y))s(y,b,E);else{var T=document.createElement("a");T.href=y,T.target="_blank",setTimeout(function(){f(T)})}}:function(y,b,E,T){if(T=T||open("","_blank"),T&&(T.document.title=T.document.body.innerText="downloading..."),typeof y=="string")return s(y,b,E);var S=y.type==="application/octet-stream",I=/constructor/i.test(d.HTMLElement)||d.safari,A=/CriOS\/[\d]+/.test(navigator.userAgent);if((A||S&&I||p)&&typeof FileReader<"u"){var M=new FileReader;M.onloadend=function(){var O=M.result;O=A?O:O.replace(/^data:[^;]*;/,"data:attachment/file;"),T?T.location.href=O:location=O,T=null},M.readAsDataURL(y)}else{var F=d.URL||d.webkitURL,L=F.createObjectURL(y);T?T.location=L:location.href=L,T=null,setTimeout(function(){F.revokeObjectURL(L)},4e4)}});d.saveAs=g.saveAs=g,t.exports=g})})(Z7);var L3e=Z7.exports,D3e=X7,B3e=L3e.saveAs,z3e=function(t,n){let a="download";n&&(n.filename||n.folder)&&(a=n.filename||n.folder),D3e(t,n).then(function(s){B3e(s,a+".zip")})};B0.download=z3e;B0.write=G7;B0.zip=X7;const N3e={class:"content"},U3e={class:"box-area"},$3e={class:"box-area"},V3e=Ft({name:"exportModule",components:{}}),j3e=Object.assign(V3e,{setup(t){const{proxy:n}=Tn(),a=Ze("type1"),s=Ze("type1");Ze("");var c=null;function f(){n.$axios.get("/api/units/info",{responseType:"json"}).then(g=>{if(c=g.data.data,a.value==="type1"){const y=A0.utils.json_to_sheet(c),b=A0.utils.book_new();A0.utils.book_append_sheet(b,y,"Sheet1"),A0.writeFile(b,"文保单位信息.xlsx")}else if(a.value==="type2"){const y=CU.unparse(c,{quotes:!0,encoding:"utf-8"}),b=new Blob(["\uFEFF"+y],{type:"text/csv;charset=utf-8;"}),E=document.createElement("a");if(E.download!==void 0){const T=URL.createObjectURL(b);E.setAttribute("href",T),E.setAttribute("download","文保单位信息.csv"),E.style.visibility="hidden",document.body.appendChild(E),E.click(),document.body.removeChild(E)}}}).catch(g=>{console.error("API Error:",g.response.data),cs({title:"失败",message:"导出失败",position:"bottom-right",type:"error"})})}async function d(){try{if(s.value=="type1"){const E=await n.$axios.get("/units/features/export/geojson/point"),T=await n.$axios.get("/units/features/export/geojson/line"),S=await n.$axios.get("/units/features/export/geojson/polygon");var g={filename:"地图标绘_点",outputType:"blob",types:{point:"points",polygon:"polygons",polyline:"lines"}},y={filename:"地图标绘_线",outputType:"blob",types:{point:"points",polygon:"polygons",polyline:"lines"}},b={filename:"地图标绘_面",outputType:"blob",types:{point:"points",polygon:"polygons",polyline:"lines"}};B0.download(E.data,g),B0.download(T.data,y),B0.download(S.data,b)}else if(s.value=="type2"){const E=await n.$axios.get("/units/features/export/geojson");p(E.data,"地图标绘.geojson")}}catch(E){console.error("Error exporting data:",E),cs({title:"失败",message:"导出失败",position:"bottom-right",type:"error"})}}function p(g,y){const b=new Blob([JSON.stringify(g)],{type:"application/json"}),E=window.URL.createObjectURL(b),T=document.createElement("a");T.href=E,T.setAttribute("download",y),document.body.appendChild(T),T.click(),document.body.removeChild(T),window.URL.revokeObjectURL(E)}return(g,y)=>{const b=Ll,E=Ec,T=lk,S=xv,I=uu,A=Dh;return De(),yt("div",N3e,[me(A,null,{default:we(()=>[gt("div",U3e,[me(b,{class:"bold-text"},{default:we(()=>[Sr("导出文保单位信息：")]),_:1}),me(b,{align:"middle"},{default:we(()=>[me(E,{span:6},{default:we(()=>[Sr("请选择导出格式：")]),_:1}),me(E,{span:14},{default:we(()=>[me(S,{modelValue:a.value,"onUpdate:modelValue":y[0]||(y[0]=M=>a.value=M)},{default:we(()=>[me(T,{label:"type1"},{default:we(()=>[Sr("Excel")]),_:1}),me(T,{label:"type2"},{default:we(()=>[Sr("CSV")]),_:1})]),_:1},8,["modelValue"])]),_:1}),me(E,{span:4},{default:we(()=>[me(I,{class:"btn-export",onClick:f},{default:we(()=>[Sr("导出")]),_:1})]),_:1})]),_:1})]),gt("div",$3e,[me(b,{class:"bold-text"},{default:we(()=>[Sr("导出地图标绘：")]),_:1}),me(b,{align:"middle"},{default:we(()=>[me(E,{span:6},{default:we(()=>[Sr("请选择导出格式：")]),_:1}),me(E,{span:14},{default:we(()=>[me(S,{modelValue:s.value,"onUpdate:modelValue":y[1]||(y[1]=M=>s.value=M)},{default:we(()=>[me(T,{label:"type1"},{default:we(()=>[Sr("ESRI Shapefile")]),_:1}),me(T,{label:"type2"},{default:we(()=>[Sr("GeoJson")]),_:1})]),_:1},8,["modelValue"])]),_:1}),me(E,{span:4},{default:we(()=>[me(I,{class:"btn-export",onClick:d},{default:we(()=>[Sr("导出")]),_:1})]),_:1})]),_:1})])]),_:1})])}}}),K7=Vs(j3e,[["__scopeId","data-v-6e76e536"]]),W3e={class:"content"},H3e=Ft({name:"addModule",components:{}}),G3e=Object.assign(H3e,{setup(t){const{proxy:n}=Tn(),a=Ze(),s=Ze({survey3_id:"",name:"",type:"",age:"",address:""}),c=Ze({survey3_id:[{required:!0,message:"文物编号不能为空！",trigger:"blur"}],name:[{required:!0,message:"文物名称不能为空！",trigger:"blur"}]});async function f(){a&&await a.value.validate((d,p)=>{d?n.$axios.post("/units/info",s.value).then(g=>{console.log("submit!"),cs({title:"成功",message:"已成功添加一条记录",position:"bottom-right",type:"success"})}).catch(g=>{console.error("API Error:",g.response.data),cs({title:"失败",message:"添加失败",position:"bottom-right",type:"error"})}):console.log("error submit!",p)})}return(d,p)=>{const g=uf,y=tk,b=Dh,E=ek,T=uu,S=Ll;return De(),yt(mn,null,[gt("div",W3e,[me(E,{model:s.value,rules:c.value,"label-width":"6vw",class:"form",ref_key:"formRef",ref:a,"status-icon":""},{default:we(()=>[me(b,null,{default:we(()=>[me(y,{label:"文物名称",prop:"name"},{default:we(()=>[me(g,{modelValue:s.value.name,"onUpdate:modelValue":p[0]||(p[0]=I=>s.value.name=I)},null,8,["modelValue"])]),_:1}),me(y,{label:"编号",prop:"id"},{default:we(()=>[me(g,{modelValue:s.value.survey3_id,"onUpdate:modelValue":p[1]||(p[1]=I=>s.value.survey3_id=I)},null,8,["modelValue"])]),_:1}),me(y,{label:"类型",prop:"type"},{default:we(()=>[me(g,{modelValue:s.value.type,"onUpdate:modelValue":p[2]||(p[2]=I=>s.value.type=I)},null,8,["modelValue"])]),_:1}),me(y,{label:"年代",prop:"age"},{default:we(()=>[me(g,{modelValue:s.value.age,"onUpdate:modelValue":p[3]||(p[3]=I=>s.value.age=I)},null,8,["modelValue"])]),_:1}),me(y,{label:"地址",prop:"address"},{default:we(()=>[me(g,{modelValue:s.value.address,"onUpdate:modelValue":p[4]||(p[4]=I=>s.value.address=I)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["model","rules"])]),me(S,{class:"btn-row",justify:"end",align:"middle"},{default:we(()=>[me(T,{class:"btn-add",onClick:f},{default:we(()=>[Sr("添加")]),_:1})]),_:1})],64)}}}),Y7=Vs(G3e,[["__scopeId","data-v-ac121d60"]]),q3e=t=>(rf("data-v-22ac240f"),t=t(),nf(),t),X3e=q3e(()=>gt("span",{id:"title"},"   信息管理",-1)),Z3e=Ft({name:"dataManagement",components:{importModule:$7,exportModule:K7,addModule:Y7}}),K3e=Object.assign(Z3e,{emits:["closeManagement"],setup(t,{emit:n}){const a=n,s=Ze("add");return(c,f)=>{const d=Ec,p=Hn,g=Ll,y=nme,b=rme,E=Zb,T=Xb;return De(),Ht(T,{class:"container map-overlay"},{default:we(()=>[me(E,null,{default:we(()=>[me(g,null,{default:we(()=>[me(d,{span:23},{default:we(()=>[X3e]),_:1}),me(d,{span:1},{default:we(()=>[me(p,{size:20,style:{color:"#757575",cursor:"pointer"},onClick:f[0]||(f[0]=S=>a("closeManagement"))},{default:we(()=>[me(W(Qu))]),_:1})]),_:1})]),_:1}),me(b,{modelValue:s.value,"onUpdate:modelValue":f[1]||(f[1]=S=>s.value=S),class:"tabs",style:{margin:"1vh"}},{default:we(()=>[me(y,{label:"添加记录",name:"add"},{default:we(()=>[me(Y7)]),_:1}),me(y,{label:"导入数据",name:"import"},{default:we(()=>[me($7)]),_:1}),me(y,{label:"导出数据",name:"export"},{default:we(()=>[me(K7)]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})}}}),J7=Vs(K3e,[["__scopeId","data-v-22ac240f"]]);function Q7(t,n){return function(){return t.apply(n,arguments)}}const{toString:Y3e}=Object.prototype,{getPrototypeOf:a3}=Object,ww=(t=>n=>{const a=Y3e.call(n);return t[a]||(t[a]=a.slice(8,-1).toLowerCase())})(Object.create(null)),du=t=>(t=t.toLowerCase(),n=>ww(n)===t),Ew=t=>n=>typeof n===t,{isArray:Cm}=Array,sv=Ew("undefined");function J3e(t){return t!==null&&!sv(t)&&t.constructor!==null&&!sv(t.constructor)&&Fl(t.constructor.isBuffer)&&t.constructor.isBuffer(t)}const e$=du("ArrayBuffer");function Q3e(t){let n;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?n=ArrayBuffer.isView(t):n=t&&t.buffer&&e$(t.buffer),n}const e4e=Ew("string"),Fl=Ew("function"),t$=Ew("number"),Tw=t=>t!==null&&typeof t=="object",t4e=t=>t===!0||t===!1,Mx=t=>{if(ww(t)!=="object")return!1;const n=a3(t);return(n===null||n===Object.prototype||Object.getPrototypeOf(n)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},r4e=du("Date"),n4e=du("File"),i4e=du("Blob"),a4e=du("FileList"),o4e=t=>Tw(t)&&Fl(t.pipe),s4e=t=>{let n;return t&&(typeof FormData=="function"&&t instanceof FormData||Fl(t.append)&&((n=ww(t))==="formdata"||n==="object"&&Fl(t.toString)&&t.toString()==="[object FormData]"))},l4e=du("URLSearchParams"),c4e=t=>t.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Fv(t,n,{allOwnKeys:a=!1}={}){if(t===null||typeof t>"u")return;let s,c;if(typeof t!="object"&&(t=[t]),Cm(t))for(s=0,c=t.length;s<c;s++)n.call(null,t[s],s,t);else{const f=a?Object.getOwnPropertyNames(t):Object.keys(t),d=f.length;let p;for(s=0;s<d;s++)p=f[s],n.call(null,t[p],p,t)}}function r$(t,n){n=n.toLowerCase();const a=Object.keys(t);let s=a.length,c;for(;s-- >0;)if(c=a[s],n===c.toLowerCase())return c;return null}const n$=(()=>typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global)(),i$=t=>!sv(t)&&t!==n$;function HC(){const{caseless:t}=i$(this)&&this||{},n={},a=(s,c)=>{const f=t&&r$(n,c)||c;Mx(n[f])&&Mx(s)?n[f]=HC(n[f],s):Mx(s)?n[f]=HC({},s):Cm(s)?n[f]=s.slice():n[f]=s};for(let s=0,c=arguments.length;s<c;s++)arguments[s]&&Fv(arguments[s],a);return n}const u4e=(t,n,a,{allOwnKeys:s}={})=>(Fv(n,(c,f)=>{a&&Fl(c)?t[f]=Q7(c,a):t[f]=c},{allOwnKeys:s}),t),f4e=t=>(t.charCodeAt(0)===65279&&(t=t.slice(1)),t),h4e=(t,n,a,s)=>{t.prototype=Object.create(n.prototype,s),t.prototype.constructor=t,Object.defineProperty(t,"super",{value:n.prototype}),a&&Object.assign(t.prototype,a)},d4e=(t,n,a,s)=>{let c,f,d;const p={};if(n=n||{},t==null)return n;do{for(c=Object.getOwnPropertyNames(t),f=c.length;f-- >0;)d=c[f],(!s||s(d,t,n))&&!p[d]&&(n[d]=t[d],p[d]=!0);t=a!==!1&&a3(t)}while(t&&(!a||a(t,n))&&t!==Object.prototype);return n},p4e=(t,n,a)=>{t=String(t),(a===void 0||a>t.length)&&(a=t.length),a-=n.length;const s=t.indexOf(n,a);return s!==-1&&s===a},m4e=t=>{if(!t)return null;if(Cm(t))return t;let n=t.length;if(!t$(n))return null;const a=new Array(n);for(;n-- >0;)a[n]=t[n];return a},g4e=(t=>n=>t&&n instanceof t)(typeof Uint8Array<"u"&&a3(Uint8Array)),_4e=(t,n)=>{const s=(t&&t[Symbol.iterator]).call(t);let c;for(;(c=s.next())&&!c.done;){const f=c.value;n.call(t,f[0],f[1])}},v4e=(t,n)=>{let a;const s=[];for(;(a=t.exec(n))!==null;)s.push(a);return s},y4e=du("HTMLFormElement"),x4e=t=>t.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(a,s,c){return s.toUpperCase()+c}),K6=(({hasOwnProperty:t})=>(n,a)=>t.call(n,a))(Object.prototype),b4e=du("RegExp"),a$=(t,n)=>{const a=Object.getOwnPropertyDescriptors(t),s={};Fv(a,(c,f)=>{let d;(d=n(c,f,t))!==!1&&(s[f]=d||c)}),Object.defineProperties(t,s)},w4e=t=>{a$(t,(n,a)=>{if(Fl(t)&&["arguments","caller","callee"].indexOf(a)!==-1)return!1;const s=t[a];if(Fl(s)){if(n.enumerable=!1,"writable"in n){n.writable=!1;return}n.set||(n.set=()=>{throw Error("Can not rewrite read-only method '"+a+"'")})}})},E4e=(t,n)=>{const a={},s=c=>{c.forEach(f=>{a[f]=!0})};return Cm(t)?s(t):s(String(t).split(n)),a},T4e=()=>{},S4e=(t,n)=>(t=+t,Number.isFinite(t)?t:n),kS="abcdefghijklmnopqrstuvwxyz",Y6="0123456789",o$={DIGIT:Y6,ALPHA:kS,ALPHA_DIGIT:kS+kS.toUpperCase()+Y6},C4e=(t=16,n=o$.ALPHA_DIGIT)=>{let a="";const{length:s}=n;for(;t--;)a+=n[Math.random()*s|0];return a};function A4e(t){return!!(t&&Fl(t.append)&&t[Symbol.toStringTag]==="FormData"&&t[Symbol.iterator])}const k4e=t=>{const n=new Array(10),a=(s,c)=>{if(Tw(s)){if(n.indexOf(s)>=0)return;if(!("toJSON"in s)){n[c]=s;const f=Cm(s)?[]:{};return Fv(s,(d,p)=>{const g=a(d,c+1);!sv(g)&&(f[p]=g)}),n[c]=void 0,f}}return s};return a(t,0)},I4e=du("AsyncFunction"),M4e=t=>t&&(Tw(t)||Fl(t))&&Fl(t.then)&&Fl(t.catch),ir={isArray:Cm,isArrayBuffer:e$,isBuffer:J3e,isFormData:s4e,isArrayBufferView:Q3e,isString:e4e,isNumber:t$,isBoolean:t4e,isObject:Tw,isPlainObject:Mx,isUndefined:sv,isDate:r4e,isFile:n4e,isBlob:i4e,isRegExp:b4e,isFunction:Fl,isStream:o4e,isURLSearchParams:l4e,isTypedArray:g4e,isFileList:a4e,forEach:Fv,merge:HC,extend:u4e,trim:c4e,stripBOM:f4e,inherits:h4e,toFlatObject:d4e,kindOf:ww,kindOfTest:du,endsWith:p4e,toArray:m4e,forEachEntry:_4e,matchAll:v4e,isHTMLForm:y4e,hasOwnProperty:K6,hasOwnProp:K6,reduceDescriptors:a$,freezeMethods:w4e,toObjectSet:E4e,toCamelCase:x4e,noop:T4e,toFiniteNumber:S4e,findKey:r$,global:n$,isContextDefined:i$,ALPHABET:o$,generateString:C4e,isSpecCompliantForm:A4e,toJSONObject:k4e,isAsyncFn:I4e,isThenable:M4e};function ki(t,n,a,s,c){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=t,this.name="AxiosError",n&&(this.code=n),a&&(this.config=a),s&&(this.request=s),c&&(this.response=c)}ir.inherits(ki,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:ir.toJSONObject(this.config),code:this.code,status:this.response&&this.response.status?this.response.status:null}}});const s$=ki.prototype,l$={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(t=>{l$[t]={value:t}});Object.defineProperties(ki,l$);Object.defineProperty(s$,"isAxiosError",{value:!0});ki.from=(t,n,a,s,c,f)=>{const d=Object.create(s$);return ir.toFlatObject(t,d,function(g){return g!==Error.prototype},p=>p!=="isAxiosError"),ki.call(d,t.message,n,a,s,c),d.cause=t,d.name=t.name,f&&Object.assign(d,f),d};const F4e=null;function GC(t){return ir.isPlainObject(t)||ir.isArray(t)}function c$(t){return ir.endsWith(t,"[]")?t.slice(0,-2):t}function J6(t,n,a){return t?t.concat(n).map(function(c,f){return c=c$(c),!a&&f?"["+c+"]":c}).join(a?".":""):n}function P4e(t){return ir.isArray(t)&&!t.some(GC)}const O4e=ir.toFlatObject(ir,{},null,function(n){return/^is[A-Z]/.test(n)});function Sw(t,n,a){if(!ir.isObject(t))throw new TypeError("target must be an object");n=n||new FormData,a=ir.toFlatObject(a,{metaTokens:!0,dots:!1,indexes:!1},!1,function(A,M){return!ir.isUndefined(M[A])});const s=a.metaTokens,c=a.visitor||b,f=a.dots,d=a.indexes,g=(a.Blob||typeof Blob<"u"&&Blob)&&ir.isSpecCompliantForm(n);if(!ir.isFunction(c))throw new TypeError("visitor must be a function");function y(I){if(I===null)return"";if(ir.isDate(I))return I.toISOString();if(!g&&ir.isBlob(I))throw new ki("Blob is not supported. Use a Buffer instead.");return ir.isArrayBuffer(I)||ir.isTypedArray(I)?g&&typeof Blob=="function"?new Blob([I]):Buffer.from(I):I}function b(I,A,M){let F=I;if(I&&!M&&typeof I=="object"){if(ir.endsWith(A,"{}"))A=s?A:A.slice(0,-2),I=JSON.stringify(I);else if(ir.isArray(I)&&P4e(I)||(ir.isFileList(I)||ir.endsWith(A,"[]"))&&(F=ir.toArray(I)))return A=c$(A),F.forEach(function(O,N){!(ir.isUndefined(O)||O===null)&&n.append(d===!0?J6([A],N,f):d===null?A:A+"[]",y(O))}),!1}return GC(I)?!0:(n.append(J6(M,A,f),y(I)),!1)}const E=[],T=Object.assign(O4e,{defaultVisitor:b,convertValue:y,isVisitable:GC});function S(I,A){if(!ir.isUndefined(I)){if(E.indexOf(I)!==-1)throw Error("Circular reference detected in "+A.join("."));E.push(I),ir.forEach(I,function(F,L){(!(ir.isUndefined(F)||F===null)&&c.call(n,F,ir.isString(L)?L.trim():L,A,T))===!0&&S(F,A?A.concat(L):[L])}),E.pop()}}if(!ir.isObject(t))throw new TypeError("data must be an object");return S(t),n}function Q6(t){const n={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(t).replace(/[!'()~]|%20|%00/g,function(s){return n[s]})}function o3(t,n){this._pairs=[],t&&Sw(t,this,n)}const u$=o3.prototype;u$.append=function(n,a){this._pairs.push([n,a])};u$.toString=function(n){const a=n?function(s){return n.call(this,s,Q6)}:Q6;return this._pairs.map(function(c){return a(c[0])+"="+a(c[1])},"").join("&")};function R4e(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function f$(t,n,a){if(!n)return t;const s=a&&a.encode||R4e,c=a&&a.serialize;let f;if(c?f=c(n,a):f=ir.isURLSearchParams(n)?n.toString():new o3(n,a).toString(s),f){const d=t.indexOf("#");d!==-1&&(t=t.slice(0,d)),t+=(t.indexOf("?")===-1?"?":"&")+f}return t}class L4e{constructor(){this.handlers=[]}use(n,a,s){return this.handlers.push({fulfilled:n,rejected:a,synchronous:s?s.synchronous:!1,runWhen:s?s.runWhen:null}),this.handlers.length-1}eject(n){this.handlers[n]&&(this.handlers[n]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(n){ir.forEach(this.handlers,function(s){s!==null&&n(s)})}}const eB=L4e,h$={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},D4e=typeof URLSearchParams<"u"?URLSearchParams:o3,B4e=typeof FormData<"u"?FormData:null,z4e=typeof Blob<"u"?Blob:null,N4e={isBrowser:!0,classes:{URLSearchParams:D4e,FormData:B4e,Blob:z4e},protocols:["http","https","file","blob","url","data"]},d$=typeof window<"u"&&typeof document<"u",U4e=(t=>d$&&["ReactNative","NativeScript","NS"].indexOf(t)<0)(typeof navigator<"u"&&navigator.product),$4e=(()=>typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function")(),V4e=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:d$,hasStandardBrowserEnv:U4e,hasStandardBrowserWebWorkerEnv:$4e},Symbol.toStringTag,{value:"Module"})),ru={...V4e,...N4e};function j4e(t,n){return Sw(t,new ru.classes.URLSearchParams,Object.assign({visitor:function(a,s,c,f){return ru.isNode&&ir.isBuffer(a)?(this.append(s,a.toString("base64")),!1):f.defaultVisitor.apply(this,arguments)}},n))}function W4e(t){return ir.matchAll(/\w+|\[(\w*)]/g,t).map(n=>n[0]==="[]"?"":n[1]||n[0])}function H4e(t){const n={},a=Object.keys(t);let s;const c=a.length;let f;for(s=0;s<c;s++)f=a[s],n[f]=t[f];return n}function p$(t){function n(a,s,c,f){let d=a[f++];const p=Number.isFinite(+d),g=f>=a.length;return d=!d&&ir.isArray(c)?c.length:d,g?(ir.hasOwnProp(c,d)?c[d]=[c[d],s]:c[d]=s,!p):((!c[d]||!ir.isObject(c[d]))&&(c[d]=[]),n(a,s,c[d],f)&&ir.isArray(c[d])&&(c[d]=H4e(c[d])),!p)}if(ir.isFormData(t)&&ir.isFunction(t.entries)){const a={};return ir.forEachEntry(t,(s,c)=>{n(W4e(s),c,a,0)}),a}return null}function G4e(t,n,a){if(ir.isString(t))try{return(n||JSON.parse)(t),ir.trim(t)}catch(s){if(s.name!=="SyntaxError")throw s}return(a||JSON.stringify)(t)}const s3={transitional:h$,adapter:["xhr","http"],transformRequest:[function(n,a){const s=a.getContentType()||"",c=s.indexOf("application/json")>-1,f=ir.isObject(n);if(f&&ir.isHTMLForm(n)&&(n=new FormData(n)),ir.isFormData(n))return c&&c?JSON.stringify(p$(n)):n;if(ir.isArrayBuffer(n)||ir.isBuffer(n)||ir.isStream(n)||ir.isFile(n)||ir.isBlob(n))return n;if(ir.isArrayBufferView(n))return n.buffer;if(ir.isURLSearchParams(n))return a.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),n.toString();let p;if(f){if(s.indexOf("application/x-www-form-urlencoded")>-1)return j4e(n,this.formSerializer).toString();if((p=ir.isFileList(n))||s.indexOf("multipart/form-data")>-1){const g=this.env&&this.env.FormData;return Sw(p?{"files[]":n}:n,g&&new g,this.formSerializer)}}return f||c?(a.setContentType("application/json",!1),G4e(n)):n}],transformResponse:[function(n){const a=this.transitional||s3.transitional,s=a&&a.forcedJSONParsing,c=this.responseType==="json";if(n&&ir.isString(n)&&(s&&!this.responseType||c)){const d=!(a&&a.silentJSONParsing)&&c;try{return JSON.parse(n)}catch(p){if(d)throw p.name==="SyntaxError"?ki.from(p,ki.ERR_BAD_RESPONSE,this,null,this.response):p}}return n}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:ru.classes.FormData,Blob:ru.classes.Blob},validateStatus:function(n){return n>=200&&n<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};ir.forEach(["delete","get","head","post","put","patch"],t=>{s3.headers[t]={}});const l3=s3,q4e=ir.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),X4e=t=>{const n={};let a,s,c;return t&&t.split(`
`).forEach(function(d){c=d.indexOf(":"),a=d.substring(0,c).trim().toLowerCase(),s=d.substring(c+1).trim(),!(!a||n[a]&&q4e[a])&&(a==="set-cookie"?n[a]?n[a].push(s):n[a]=[s]:n[a]=n[a]?n[a]+", "+s:s)}),n},tB=Symbol("internals");function Vg(t){return t&&String(t).trim().toLowerCase()}function Fx(t){return t===!1||t==null?t:ir.isArray(t)?t.map(Fx):String(t)}function Z4e(t){const n=Object.create(null),a=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let s;for(;s=a.exec(t);)n[s[1]]=s[2];return n}const K4e=t=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(t.trim());function IS(t,n,a,s,c){if(ir.isFunction(s))return s.call(this,n,a);if(c&&(n=a),!!ir.isString(n)){if(ir.isString(s))return n.indexOf(s)!==-1;if(ir.isRegExp(s))return s.test(n)}}function Y4e(t){return t.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(n,a,s)=>a.toUpperCase()+s)}function J4e(t,n){const a=ir.toCamelCase(" "+n);["get","set","has"].forEach(s=>{Object.defineProperty(t,s+a,{value:function(c,f,d){return this[s].call(this,n,c,f,d)},configurable:!0})})}class Cw{constructor(n){n&&this.set(n)}set(n,a,s){const c=this;function f(p,g,y){const b=Vg(g);if(!b)throw new Error("header name must be a non-empty string");const E=ir.findKey(c,b);(!E||c[E]===void 0||y===!0||y===void 0&&c[E]!==!1)&&(c[E||g]=Fx(p))}const d=(p,g)=>ir.forEach(p,(y,b)=>f(y,b,g));return ir.isPlainObject(n)||n instanceof this.constructor?d(n,a):ir.isString(n)&&(n=n.trim())&&!K4e(n)?d(X4e(n),a):n!=null&&f(a,n,s),this}get(n,a){if(n=Vg(n),n){const s=ir.findKey(this,n);if(s){const c=this[s];if(!a)return c;if(a===!0)return Z4e(c);if(ir.isFunction(a))return a.call(this,c,s);if(ir.isRegExp(a))return a.exec(c);throw new TypeError("parser must be boolean|regexp|function")}}}has(n,a){if(n=Vg(n),n){const s=ir.findKey(this,n);return!!(s&&this[s]!==void 0&&(!a||IS(this,this[s],s,a)))}return!1}delete(n,a){const s=this;let c=!1;function f(d){if(d=Vg(d),d){const p=ir.findKey(s,d);p&&(!a||IS(s,s[p],p,a))&&(delete s[p],c=!0)}}return ir.isArray(n)?n.forEach(f):f(n),c}clear(n){const a=Object.keys(this);let s=a.length,c=!1;for(;s--;){const f=a[s];(!n||IS(this,this[f],f,n,!0))&&(delete this[f],c=!0)}return c}normalize(n){const a=this,s={};return ir.forEach(this,(c,f)=>{const d=ir.findKey(s,f);if(d){a[d]=Fx(c),delete a[f];return}const p=n?Y4e(f):String(f).trim();p!==f&&delete a[f],a[p]=Fx(c),s[p]=!0}),this}concat(...n){return this.constructor.concat(this,...n)}toJSON(n){const a=Object.create(null);return ir.forEach(this,(s,c)=>{s!=null&&s!==!1&&(a[c]=n&&ir.isArray(s)?s.join(", "):s)}),a}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([n,a])=>n+": "+a).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(n){return n instanceof this?n:new this(n)}static concat(n,...a){const s=new this(n);return a.forEach(c=>s.set(c)),s}static accessor(n){const s=(this[tB]=this[tB]={accessors:{}}).accessors,c=this.prototype;function f(d){const p=Vg(d);s[p]||(J4e(c,d),s[p]=!0)}return ir.isArray(n)?n.forEach(f):f(n),this}}Cw.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);ir.reduceDescriptors(Cw.prototype,({value:t},n)=>{let a=n[0].toUpperCase()+n.slice(1);return{get:()=>t,set(s){this[a]=s}}});ir.freezeMethods(Cw);const Yu=Cw;function MS(t,n){const a=this||l3,s=n||a,c=Yu.from(s.headers);let f=s.data;return ir.forEach(t,function(p){f=p.call(a,f,c.normalize(),n?n.status:void 0)}),c.normalize(),f}function m$(t){return!!(t&&t.__CANCEL__)}function Pv(t,n,a){ki.call(this,t??"canceled",ki.ERR_CANCELED,n,a),this.name="CanceledError"}ir.inherits(Pv,ki,{__CANCEL__:!0});function Q4e(t,n,a){const s=a.config.validateStatus;!a.status||!s||s(a.status)?t(a):n(new ki("Request failed with status code "+a.status,[ki.ERR_BAD_REQUEST,ki.ERR_BAD_RESPONSE][Math.floor(a.status/100)-4],a.config,a.request,a))}const eIe=ru.hasStandardBrowserEnv?{write(t,n,a,s,c,f){const d=[t+"="+encodeURIComponent(n)];ir.isNumber(a)&&d.push("expires="+new Date(a).toGMTString()),ir.isString(s)&&d.push("path="+s),ir.isString(c)&&d.push("domain="+c),f===!0&&d.push("secure"),document.cookie=d.join("; ")},read(t){const n=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return n?decodeURIComponent(n[3]):null},remove(t){this.write(t,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function tIe(t){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)}function rIe(t,n){return n?t.replace(/\/+$/,"")+"/"+n.replace(/^\/+/,""):t}function g$(t,n){return t&&!tIe(n)?rIe(t,n):n}const nIe=ru.hasStandardBrowserEnv?function(){const n=/(msie|trident)/i.test(navigator.userAgent),a=document.createElement("a");let s;function c(f){let d=f;return n&&(a.setAttribute("href",d),d=a.href),a.setAttribute("href",d),{href:a.href,protocol:a.protocol?a.protocol.replace(/:$/,""):"",host:a.host,search:a.search?a.search.replace(/^\?/,""):"",hash:a.hash?a.hash.replace(/^#/,""):"",hostname:a.hostname,port:a.port,pathname:a.pathname.charAt(0)==="/"?a.pathname:"/"+a.pathname}}return s=c(window.location.href),function(d){const p=ir.isString(d)?c(d):d;return p.protocol===s.protocol&&p.host===s.host}}():function(){return function(){return!0}}();function iIe(t){const n=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return n&&n[1]||""}function aIe(t,n){t=t||10;const a=new Array(t),s=new Array(t);let c=0,f=0,d;return n=n!==void 0?n:1e3,function(g){const y=Date.now(),b=s[f];d||(d=y),a[c]=g,s[c]=y;let E=f,T=0;for(;E!==c;)T+=a[E++],E=E%t;if(c=(c+1)%t,c===f&&(f=(f+1)%t),y-d<n)return;const S=b&&y-b;return S?Math.round(T*1e3/S):void 0}}function rB(t,n){let a=0;const s=aIe(50,250);return c=>{const f=c.loaded,d=c.lengthComputable?c.total:void 0,p=f-a,g=s(p),y=f<=d;a=f;const b={loaded:f,total:d,progress:d?f/d:void 0,bytes:p,rate:g||void 0,estimated:g&&d&&y?(d-f)/g:void 0,event:c};b[n?"download":"upload"]=!0,t(b)}}const oIe=typeof XMLHttpRequest<"u",sIe=oIe&&function(t){return new Promise(function(a,s){let c=t.data;const f=Yu.from(t.headers).normalize();let{responseType:d,withXSRFToken:p}=t,g;function y(){t.cancelToken&&t.cancelToken.unsubscribe(g),t.signal&&t.signal.removeEventListener("abort",g)}let b;if(ir.isFormData(c)){if(ru.hasStandardBrowserEnv||ru.hasStandardBrowserWebWorkerEnv)f.setContentType(!1);else if((b=f.getContentType())!==!1){const[A,...M]=b?b.split(";").map(F=>F.trim()).filter(Boolean):[];f.setContentType([A||"multipart/form-data",...M].join("; "))}}let E=new XMLHttpRequest;if(t.auth){const A=t.auth.username||"",M=t.auth.password?unescape(encodeURIComponent(t.auth.password)):"";f.set("Authorization","Basic "+btoa(A+":"+M))}const T=g$(t.baseURL,t.url);E.open(t.method.toUpperCase(),f$(T,t.params,t.paramsSerializer),!0),E.timeout=t.timeout;function S(){if(!E)return;const A=Yu.from("getAllResponseHeaders"in E&&E.getAllResponseHeaders()),F={data:!d||d==="text"||d==="json"?E.responseText:E.response,status:E.status,statusText:E.statusText,headers:A,config:t,request:E};Q4e(function(O){a(O),y()},function(O){s(O),y()},F),E=null}if("onloadend"in E?E.onloadend=S:E.onreadystatechange=function(){!E||E.readyState!==4||E.status===0&&!(E.responseURL&&E.responseURL.indexOf("file:")===0)||setTimeout(S)},E.onabort=function(){E&&(s(new ki("Request aborted",ki.ECONNABORTED,t,E)),E=null)},E.onerror=function(){s(new ki("Network Error",ki.ERR_NETWORK,t,E)),E=null},E.ontimeout=function(){let M=t.timeout?"timeout of "+t.timeout+"ms exceeded":"timeout exceeded";const F=t.transitional||h$;t.timeoutErrorMessage&&(M=t.timeoutErrorMessage),s(new ki(M,F.clarifyTimeoutError?ki.ETIMEDOUT:ki.ECONNABORTED,t,E)),E=null},ru.hasStandardBrowserEnv&&(p&&ir.isFunction(p)&&(p=p(t)),p||p!==!1&&nIe(T))){const A=t.xsrfHeaderName&&t.xsrfCookieName&&eIe.read(t.xsrfCookieName);A&&f.set(t.xsrfHeaderName,A)}c===void 0&&f.setContentType(null),"setRequestHeader"in E&&ir.forEach(f.toJSON(),function(M,F){E.setRequestHeader(F,M)}),ir.isUndefined(t.withCredentials)||(E.withCredentials=!!t.withCredentials),d&&d!=="json"&&(E.responseType=t.responseType),typeof t.onDownloadProgress=="function"&&E.addEventListener("progress",rB(t.onDownloadProgress,!0)),typeof t.onUploadProgress=="function"&&E.upload&&E.upload.addEventListener("progress",rB(t.onUploadProgress)),(t.cancelToken||t.signal)&&(g=A=>{E&&(s(!A||A.type?new Pv(null,t,E):A),E.abort(),E=null)},t.cancelToken&&t.cancelToken.subscribe(g),t.signal&&(t.signal.aborted?g():t.signal.addEventListener("abort",g)));const I=iIe(T);if(I&&ru.protocols.indexOf(I)===-1){s(new ki("Unsupported protocol "+I+":",ki.ERR_BAD_REQUEST,t));return}E.send(c||null)})},qC={http:F4e,xhr:sIe};ir.forEach(qC,(t,n)=>{if(t){try{Object.defineProperty(t,"name",{value:n})}catch{}Object.defineProperty(t,"adapterName",{value:n})}});const nB=t=>`- ${t}`,lIe=t=>ir.isFunction(t)||t===null||t===!1,_$={getAdapter:t=>{t=ir.isArray(t)?t:[t];const{length:n}=t;let a,s;const c={};for(let f=0;f<n;f++){a=t[f];let d;if(s=a,!lIe(a)&&(s=qC[(d=String(a)).toLowerCase()],s===void 0))throw new ki(`Unknown adapter '${d}'`);if(s)break;c[d||"#"+f]=s}if(!s){const f=Object.entries(c).map(([p,g])=>`adapter ${p} `+(g===!1?"is not supported by the environment":"is not available in the build"));let d=n?f.length>1?`since :
`+f.map(nB).join(`
`):" "+nB(f[0]):"as no adapter specified";throw new ki("There is no suitable adapter to dispatch the request "+d,"ERR_NOT_SUPPORT")}return s},adapters:qC};function FS(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new Pv(null,t)}function iB(t){return FS(t),t.headers=Yu.from(t.headers),t.data=MS.call(t,t.transformRequest),["post","put","patch"].indexOf(t.method)!==-1&&t.headers.setContentType("application/x-www-form-urlencoded",!1),_$.getAdapter(t.adapter||l3.adapter)(t).then(function(s){return FS(t),s.data=MS.call(t,t.transformResponse,s),s.headers=Yu.from(s.headers),s},function(s){return m$(s)||(FS(t),s&&s.response&&(s.response.data=MS.call(t,t.transformResponse,s.response),s.response.headers=Yu.from(s.response.headers))),Promise.reject(s)})}const aB=t=>t instanceof Yu?t.toJSON():t;function cm(t,n){n=n||{};const a={};function s(y,b,E){return ir.isPlainObject(y)&&ir.isPlainObject(b)?ir.merge.call({caseless:E},y,b):ir.isPlainObject(b)?ir.merge({},b):ir.isArray(b)?b.slice():b}function c(y,b,E){if(ir.isUndefined(b)){if(!ir.isUndefined(y))return s(void 0,y,E)}else return s(y,b,E)}function f(y,b){if(!ir.isUndefined(b))return s(void 0,b)}function d(y,b){if(ir.isUndefined(b)){if(!ir.isUndefined(y))return s(void 0,y)}else return s(void 0,b)}function p(y,b,E){if(E in n)return s(y,b);if(E in t)return s(void 0,y)}const g={url:f,method:f,data:f,baseURL:d,transformRequest:d,transformResponse:d,paramsSerializer:d,timeout:d,timeoutMessage:d,withCredentials:d,withXSRFToken:d,adapter:d,responseType:d,xsrfCookieName:d,xsrfHeaderName:d,onUploadProgress:d,onDownloadProgress:d,decompress:d,maxContentLength:d,maxBodyLength:d,beforeRedirect:d,transport:d,httpAgent:d,httpsAgent:d,cancelToken:d,socketPath:d,responseEncoding:d,validateStatus:p,headers:(y,b)=>c(aB(y),aB(b),!0)};return ir.forEach(Object.keys(Object.assign({},t,n)),function(b){const E=g[b]||c,T=E(t[b],n[b],b);ir.isUndefined(T)&&E!==p||(a[b]=T)}),a}const v$="1.6.2",c3={};["object","boolean","number","function","string","symbol"].forEach((t,n)=>{c3[t]=function(s){return typeof s===t||"a"+(n<1?"n ":" ")+t}});const oB={};c3.transitional=function(n,a,s){function c(f,d){return"[Axios v"+v$+"] Transitional option '"+f+"'"+d+(s?". "+s:"")}return(f,d,p)=>{if(n===!1)throw new ki(c(d," has been removed"+(a?" in "+a:"")),ki.ERR_DEPRECATED);return a&&!oB[d]&&(oB[d]=!0,console.warn(c(d," has been deprecated since v"+a+" and will be removed in the near future"))),n?n(f,d,p):!0}};function cIe(t,n,a){if(typeof t!="object")throw new ki("options must be an object",ki.ERR_BAD_OPTION_VALUE);const s=Object.keys(t);let c=s.length;for(;c-- >0;){const f=s[c],d=n[f];if(d){const p=t[f],g=p===void 0||d(p,f,t);if(g!==!0)throw new ki("option "+f+" must be "+g,ki.ERR_BAD_OPTION_VALUE);continue}if(a!==!0)throw new ki("Unknown option "+f,ki.ERR_BAD_OPTION)}}const XC={assertOptions:cIe,validators:c3},ah=XC.validators;class mb{constructor(n){this.defaults=n,this.interceptors={request:new eB,response:new eB}}request(n,a){typeof n=="string"?(a=a||{},a.url=n):a=n||{},a=cm(this.defaults,a);const{transitional:s,paramsSerializer:c,headers:f}=a;s!==void 0&&XC.assertOptions(s,{silentJSONParsing:ah.transitional(ah.boolean),forcedJSONParsing:ah.transitional(ah.boolean),clarifyTimeoutError:ah.transitional(ah.boolean)},!1),c!=null&&(ir.isFunction(c)?a.paramsSerializer={serialize:c}:XC.assertOptions(c,{encode:ah.function,serialize:ah.function},!0)),a.method=(a.method||this.defaults.method||"get").toLowerCase();let d=f&&ir.merge(f.common,f[a.method]);f&&ir.forEach(["delete","get","head","post","put","patch","common"],I=>{delete f[I]}),a.headers=Yu.concat(d,f);const p=[];let g=!0;this.interceptors.request.forEach(function(A){typeof A.runWhen=="function"&&A.runWhen(a)===!1||(g=g&&A.synchronous,p.unshift(A.fulfilled,A.rejected))});const y=[];this.interceptors.response.forEach(function(A){y.push(A.fulfilled,A.rejected)});let b,E=0,T;if(!g){const I=[iB.bind(this),void 0];for(I.unshift.apply(I,p),I.push.apply(I,y),T=I.length,b=Promise.resolve(a);E<T;)b=b.then(I[E++],I[E++]);return b}T=p.length;let S=a;for(E=0;E<T;){const I=p[E++],A=p[E++];try{S=I(S)}catch(M){A.call(this,M);break}}try{b=iB.call(this,S)}catch(I){return Promise.reject(I)}for(E=0,T=y.length;E<T;)b=b.then(y[E++],y[E++]);return b}getUri(n){n=cm(this.defaults,n);const a=g$(n.baseURL,n.url);return f$(a,n.params,n.paramsSerializer)}}ir.forEach(["delete","get","head","options"],function(n){mb.prototype[n]=function(a,s){return this.request(cm(s||{},{method:n,url:a,data:(s||{}).data}))}});ir.forEach(["post","put","patch"],function(n){function a(s){return function(f,d,p){return this.request(cm(p||{},{method:n,headers:s?{"Content-Type":"multipart/form-data"}:{},url:f,data:d}))}}mb.prototype[n]=a(),mb.prototype[n+"Form"]=a(!0)});const Px=mb;class u3{constructor(n){if(typeof n!="function")throw new TypeError("executor must be a function.");let a;this.promise=new Promise(function(f){a=f});const s=this;this.promise.then(c=>{if(!s._listeners)return;let f=s._listeners.length;for(;f-- >0;)s._listeners[f](c);s._listeners=null}),this.promise.then=c=>{let f;const d=new Promise(p=>{s.subscribe(p),f=p}).then(c);return d.cancel=function(){s.unsubscribe(f)},d},n(function(f,d,p){s.reason||(s.reason=new Pv(f,d,p),a(s.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(n){if(this.reason){n(this.reason);return}this._listeners?this._listeners.push(n):this._listeners=[n]}unsubscribe(n){if(!this._listeners)return;const a=this._listeners.indexOf(n);a!==-1&&this._listeners.splice(a,1)}static source(){let n;return{token:new u3(function(c){n=c}),cancel:n}}}const uIe=u3;function fIe(t){return function(a){return t.apply(null,a)}}function hIe(t){return ir.isObject(t)&&t.isAxiosError===!0}const ZC={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(ZC).forEach(([t,n])=>{ZC[n]=t});const dIe=ZC;function y$(t){const n=new Px(t),a=Q7(Px.prototype.request,n);return ir.extend(a,Px.prototype,n,{allOwnKeys:!0}),ir.extend(a,n,null,{allOwnKeys:!0}),a.create=function(c){return y$(cm(t,c))},a}const eo=y$(l3);eo.Axios=Px;eo.CanceledError=Pv;eo.CancelToken=uIe;eo.isCancel=m$;eo.VERSION=v$;eo.toFormData=Sw;eo.AxiosError=ki;eo.Cancel=eo.CanceledError;eo.all=function(n){return Promise.all(n)};eo.spread=fIe;eo.isAxiosError=hIe;eo.mergeConfig=cm;eo.AxiosHeaders=Yu;eo.formToJSON=t=>p$(ir.isHTMLForm(t)?new FormData(t):t);eo.getAdapter=_$.getAdapter;eo.HttpStatusCode=dIe;eo.default=eo;const Aw=eo,pp=t=>(rf("data-v-d72866b7"),t=t(),nf(),t),pIe={class:"box-area"},mIe=pp(()=>gt("span",{class:"subtitle"},"   文物信息",-1)),gIe=pp(()=>gt("span",{class:"key"},"名称：",-1)),_Ie=pp(()=>gt("span",{class:"key"},"编号：",-1)),vIe=pp(()=>gt("span",{class:"key"},"类型：",-1)),yIe=pp(()=>gt("span",null,null,-1)),xIe=pp(()=>gt("span",{class:"key"},"年代：",-1)),bIe=pp(()=>gt("span",{class:"key"},"地址：",-1)),wIe={__name:"mapPopup",props:["unitId"],setup(t){Tn();const n=t,a=Ze({name:"暂无",survey3_id:"暂无",type:"暂无",age:"暂无",address:"暂无"}),s="http://47.103.20.189/server";return Aw.get(`${s}/api/units/info/${n.unitId}`,{responseType:"json"}).then(c=>{let f=c.data.data;for(let d in f)(f[d]===null||f[d]===void 0||f[d]==="")&&(f[d]="暂无");a.value=f}),(c,f)=>{const d=Ll,p=Ec;return De(),yt("div",pIe,[me(d,null,{default:we(()=>[mIe]),_:1}),me(d,{class:"row"},{default:we(()=>[me(p,{span:5},{default:we(()=>[gIe]),_:1}),me(p,{span:19},{default:we(()=>[gt("span",null,Lr(a.value.name),1)]),_:1})]),_:1}),me(d,{class:"row"},{default:we(()=>[me(p,{span:5},{default:we(()=>[_Ie]),_:1}),me(p,{span:19},{default:we(()=>[gt("span",null,Lr(a.value.survey3_id),1)]),_:1})]),_:1}),me(d,{class:"row"},{default:we(()=>[me(p,{span:5},{default:we(()=>[vIe]),_:1}),me(p,{span:19},{default:we(()=>[yIe,Sr(Lr(a.value.type),1)]),_:1})]),_:1}),me(d,{class:"row"},{default:we(()=>[me(p,{span:5},{default:we(()=>[xIe]),_:1}),me(p,{span:19},{default:we(()=>[gt("span",null,Lr(a.value.age),1)]),_:1})]),_:1}),me(d,{class:"row"},{default:we(()=>[me(p,{span:5},{default:we(()=>[bIe]),_:1}),me(p,{span:19},{default:we(()=>[gt("span",null,Lr(a.value.address),1)]),_:1})]),_:1})])}}},EIe=Vs(wIe,[["__scopeId","data-v-d72866b7"]]),Am=t=>(rf("data-v-e9836bd2"),t=t(),nf(),t),TIe=Am(()=>gt("div",{id:"map"},null,-1)),SIe={id:"legend"},CIe=Am(()=>gt("span",{style:{"font-weight":"bold",margin:"1vh"}},"图层",-1)),AIe=Am(()=>gt("img",{src:F_e,alt:"SVG Logo",width:"10",height:"10"},null,-1)),kIe=Am(()=>gt("span",null,"三普文物",-1)),IIe=Am(()=>gt("img",{src:P_e,width:"15",height:"15"},null,-1)),MIe=Am(()=>gt("span",null,"测绘数据",-1)),FIe=Ft({name:"mapView",components:{leftBar:xU,mapDraw:TU,dataManagement:J7}}),PIe=Object.assign(FIe,{setup(t){const{proxy:n}=Tn();var a=null,s=null,c=null;const f=Ze({units:{show:!0,layers:["point-vector","line-vector","polygon-vector","point-label","line-label","polygon-label"]},buildings:{show:!0,layers:["building-line-vector","building-point","building-label"]}}),d={latitude:28.540177,longitude:118.611821,zoom:9,pitch:0,bearing:0},p={pointStyle:{style1:{name:"circle-radius",label:"大小",default:0,options:[{value:4,label:"小"},{value:8,label:"中"},{value:12,label:"大"}]},style2:{name:"circle-color",label:"颜色",default:2,options:[{value:"#636363",label:"灰色"},{value:"#F50000",label:"红色"},{value:"#86B7C2",label:"蓝色"},{value:"#108013",label:"绿色"}]},style3:{name:"circle-stroke-width",label:"轮廓",default:1,options:[{value:0,label:"无"},{value:1,label:"有"}]}},lineStyle:{style1:{name:"line-width",label:"线宽",default:1,options:[{value:2,label:"细"},{value:3,label:"中"},{value:5,label:"粗"}]},style2:{name:"line-color",label:"颜色",default:0,options:[{value:"#636363",label:"灰色"},{value:"#F50000",label:"红色"},{value:"#0008B6",label:"蓝色"},{value:"#108013",label:"绿色"}]},style3:{name:"line-dasharray",label:"线型",default:0,options:[{value:[1,0],label:"实线"},{value:[5,3],label:"虚线"}]}},polygonStyle:{style1:{name:"fill-color",label:"填充颜色",default:0,options:[{value:"#636363",label:"灰色"},{value:"#F50000",label:"红色"},{value:"#0008B6",label:"蓝色"},{value:"#108013",label:"绿色"}]},style2:{name:"fill-opacity",label:"透明度",default:2,options:[{value:.2,label:.2},{value:.4,label:.4},{value:.6,label:.6},{value:.8,label:.8},{value:1,label:1}]}}};Ji("styleConfig",p);const g=Ze(null),y=Ze(!1),b=Ze("矢量底图"),E=[{name:"矢量底图",layerId:"tian-vector",anoLayerId:"tian-vector-ano"},{name:"影像底图",layerId:"tian-raster",anoLayerId:"tian-raster-ano"}];var T=Ze("");const S=Ve(function(){return g.value.find(j=>j.id===T.value).name});function I(j){f.value[j].show=!f.value[j].show;for(let V in f.value)for(let D of f.value[V].layers)a.setLayoutProperty(D,"visibility",f.value[V].show?"visible":"none")}function A(j,V){c=new rx.Popup({className:"popup",closeButton:!1,closeOnClick:!1,closeOnMove:!1,focusAfterOpen:!1,maxWidth:"100%",offset:5});const D=document.createElement("div");return EA(EIe,{unitId:j}).mount(D),c.setLngLat(V).setDOMContent(D).addTo(a),c}function M(j){T.value=j}function F(){T.value=""}function L(j){n.$axios.get(`/api/buildings/${j}`,{responseType:"json"}).then(V=>{let{center_x:D,center_y:te}=V.data.data;a.easeTo({zoom:16,center:[D,te],pitch:0,bearing:0})})}function O(){n.$axios.get("/api/units/info",{responseType:"json"}).then(j=>{g.value=j.data.data})}function N(j){E.forEach((V,D)=>{const te=V.name===j?"visible":"none";a.setLayoutProperty(V.layerId,"visibility",te),a.setLayoutProperty(V.anoLayerId,"visibility",te)})}function Q(){a.easeTo({zoom:d.zoom,center:[d.longitude,d.latitude],pitch:d.pitch,bearing:d.bearing})}function ie(j,V,D){const te=["match",["get",D]];var ue=p[j][V];return ue.options.forEach((J,le)=>{te.push(le),te.push(J.value)}),te.push(ue.options[ue.default].value),te}return di(async()=>{a=new rx.Map({accessToken:"pk.eyJ1IjoiZmxpY2tlcjA1NiIsImEiOiJjbGVwZTdoZ3EwNDZyM3NwN21zeXltYmQ0In0.X2048MURPAfoPoDx0OkGQQ",container:"map",style:{version:8,glyphs:"mapbox://fonts/mapbox/{fontstack}/{range}.pbf",sources:{"tian-vector":{type:"raster",tiles:["https://t0.tianditu.gov.cn/DataServer?T=vec_w&x={x}&y={y}&l={z}&tk=eeebdd438672a3da17f056e0e90ea330"],tileSize:256},"tian-vector-ano":{type:"raster",tiles:["https://t0.tianditu.gov.cn/DataServer?T=cva_w&x={x}&y={y}&l={z}&tk=eeebdd438672a3da17f056e0e90ea330"],tileSize:256},"tian-raster":{type:"raster",tiles:["https://t0.tianditu.gov.cn/DataServer?T=img_w&x={x}&y={y}&l={z}&tk=eeebdd438672a3da17f056e0e90ea330"],tileSize:256},"tian-raster-ano":{type:"raster",tiles:["https://t0.tianditu.gov.cn/DataServer?T=cia_w&x={x}&y={y}&l={z}&tk=eeebdd438672a3da17f056e0e90ea330"],tileSize:256}},layers:[{id:"tian-vector",type:"raster",source:"tian-vector"},{id:"tian-vector-ano",type:"raster",source:"tian-vector-ano"},{id:"tian-raster",type:"raster",source:"tian-raster",layout:{visibility:"none"}},{id:"tian-raster-ano",type:"raster",source:"tian-raster-ano",layout:{visibility:"none"}}]},zoom:d.zoom,center:[d.longitude,d.latitude],pitch:d.pitch,bearing:d.bearing}),a.addControl(new rx.NavigationControl,"top-left"),a.addControl(new rx.ScaleControl({maxWidth:80,unit:"metric"}),"bottom-left"),a.on("load",async function(){await n.$axios.get("/api/units/info",{responseType:"json"}).then(te=>{g.value=te.data.data,D(),j(),V(),s=new L_e({displayControlsDefault:!1,controls:{}}),a.addControl(s)})});async function j(){a.addSource("vector-source",{type:"vector",scheme:"xyz",tiles:["http://47.103.20.189/server/api/map/mvt/units/{z}/{x}/{y}"]}),a.addLayer({id:"polygon-vector",type:"fill",source:"vector-source","source-layer":"polygon",paint:{"fill-color":ie("polygonStyle","style1","color"),"fill-opacity":ie("polygonStyle","style2","opacity")}}),a.addLayer({id:"line-vector",type:"line",source:"vector-source","source-layer":"line",paint:{"line-color":ie("lineStyle","style2","color"),"line-width":ie("lineStyle","style1","width"),"line-dasharray":ie("lineStyle","style3","line_type")}}),a.addLayer({id:"point-vector",type:"circle",source:"vector-source","source-layer":"point",paint:{"circle-radius":ie("pointStyle","style1","radius"),"circle-color":ie("pointStyle","style2","color"),"circle-stroke-width":ie("pointStyle","style3","stroke_width"),"circle-stroke-color":"#FEFEFE"}}),a.addLayer({id:"polygon-label",type:"symbol",source:"vector-source","source-layer":"polygon",layout:{"text-field":["get","label"],"text-font":["Open Sans Bold","Arial Unicode MS Bold"],"text-size":["interpolate",["linear"],["zoom"],2,0,5,5,15,10,22,25],"text-offset":[0,1.5],"text-letter-spacing":.1,"text-max-width":10,"symbol-sort-key":999},paint:{"text-color":"#630080","text-halo-color":"#fff","text-opacity":["step",["zoom"],0,10,1],"text-halo-width":["interpolate",["linear"],["zoom"],1,0,5,.2,9,.1,10,.5,22,1]},filter:["==",["get","use_label"],!0]}),a.addLayer({id:"line-label",type:"symbol",source:"vector-source","source-layer":"line",layout:{"text-field":["get","label"],"text-font":["Open Sans Bold","Arial Unicode MS Bold"],"text-size":["interpolate",["linear"],["zoom"],2,0,5,5,10,10,22,20],"text-offset":[0,1.5],"text-letter-spacing":.1,"text-max-width":10,"symbol-placement":"line-center","symbol-sort-key":999},paint:{"text-color":"#22227E","text-halo-color":"#fff","text-opacity":["step",["zoom"],0,10,1],"text-halo-width":["interpolate",["linear"],["zoom"],1,0,5,.2,9,.1,10,.5,22,1]},filter:["==",["get","use_label"],!0]}),a.addLayer({id:"point-label",type:"symbol",source:"vector-source","source-layer":"point",layout:{"text-field":["get","label"],"text-font":["Open Sans Bold","Arial Unicode MS Bold"],"text-size":["interpolate",["linear"],["zoom"],2,0,5,4,10,7,22,16],"text-offset":[0,1.5],"text-letter-spacing":.1,"text-max-width":10,"symbol-sort-key":999},paint:{"text-color":"#7CAAB0","text-halo-color":"#fff","text-halo-width":["interpolate",["linear"],["zoom"],1,0,5,.2,9,.1,10,.5,22,1]},filter:["==",["get","use_label"],!0]})}async function V(){a.addSource("building-vector-source",{type:"vector",scheme:"xyz",tiles:["http://47.103.20.189/server/api/map/mvt/buildings/{z}/{x}/{y}"]}),a.addLayer({id:"building-line-vector",type:"line",source:"building-vector-source","source-layer":"building_line",paint:{"line-color":["get","color"],"line-width":["step",["zoom"],0,13,1],"line-opacity":["match",["get","highlight"],0,.2,1,1,.2]}},"buildingLocation"),n.$axios.get("/api/buildings/geojson/centers",{responseType:"json"}).then(te=>{let ue=te.data;a.addSource("building-centers",{type:"geojson",data:ue}),a.loadImage("/building.png",(J,le)=>{a.addImage("icon-building",le),a.addLayer({id:"building-point",type:"symbol",source:"building-centers",layout:{"icon-image":"icon-building","icon-padding":0,"icon-size":.8},paint:{"icon-color":"#E5B374"}})}),a.addLayer({id:"building-label",type:"symbol",source:"building-centers",layout:{"text-field":["get","name"],"text-font":["Open Sans Bold","Arial Unicode MS Bold"],"text-size":["interpolate",["linear"],["zoom"],2,0,5,4,10,8,22,18],"text-offset":[0,2],"text-letter-spacing":.1,"text-max-width":15,"symbol-sort-key":999},paint:{"text-color":"#DB6316","text-halo-color":"#fff","text-opacity":["step",["zoom"],0,10,1],"text-halo-width":["interpolate",["linear"],["zoom"],1,0,5,.2,9,.1,10,.5,22,1]}})})}function D(){a.addLayer({id:"buildingLocation",type:"fill",source:{type:"geojson",data:null},paint:{},layout:{visibility:"visible"}}),a.addLayer({id:"fillLocation",type:"fill",source:{type:"geojson",data:null},paint:{},layout:{visibility:"visible"}}),a.addLayer({id:"lineLocation",type:"line",source:{type:"geojson",data:null},paint:{},layout:{visibility:"visible"}}),a.addLayer({id:"pointLocation",type:"circle",source:{type:"geojson",data:null},paint:{},layout:{visibility:"visible"}})}a.on("click",function(te){const ue=a.queryRenderedFeatures(te.point,{layers:["point-vector","line-vector","polygon-vector"]});if(ue.length)try{M(ue[0].properties.unit_id)}catch(J){console.error("Error choosing unit",J)}}),a.on("mouseenter","point-vector",te=>{a.getCanvas().style.cursor="pointer",A(te.features[0].properties.unit_id,te.lngLat)}),a.on("mouseenter","line-vector",te=>{a.getCanvas().style.cursor="pointer"}),a.on("mouseenter","polygon-vector",te=>{a.getCanvas().style.cursor="pointer"}),a.on("mouseleave","point-vector",()=>{a.getCanvas().style.cursor="",c.remove()}),a.on("mouseleave","line-vector",()=>{a.getCanvas().style.cursor=""}),a.on("mouseleave","polygon-vector",()=>{a.getCanvas().style.cursor=""})}),(j,V)=>{const D=Hn,te=uu,ue=wN,J=xv,le=Ll,re=Ec;return De(),yt(mn,null,[TIe,g.value!=null?(De(),Ht(xU,{key:0,listData:g.value,map:W(a),onOpenManagement:V[0]||(V[0]=Fe=>y.value=!0),onRefreshData:O,onChangeCurrentUnit:M,onClearCurrentUnit:F,onShowBuilding:L},null,8,["listData","map"])):Wt("",!0),W(T)!=""?(De(),Ht(TU,{unitId:W(T),unitName:S.value,map:W(a),draw:W(s),key:W(T)},null,8,["unitId","unitName","map","draw"])):Wt("",!0),y.value?(De(),Ht(J7,{key:2,onCloseManagement:V[1]||(V[1]=Fe=>y.value=!1)})):Wt("",!0),gt("div",null,[me(te,{class:"map-btn",id:"btn-fullExtent",onClick:Q,size:"small"},{default:we(()=>[me(D,{class:"icon",size:12},{default:we(()=>[me(W(Zie))]),_:1}),Sr("全图")]),_:1})]),me(J,{modelValue:b.value,"onUpdate:modelValue":V[2]||(V[2]=Fe=>b.value=Fe),class:"basemap-selector",size:"small",fill:"#758a99",onChange:N},{default:we(()=>[me(ue,{class:"radio-btn",label:"矢量底图"}),me(ue,{class:"radio-btn",label:"影像底图"})]),_:1},8,["modelValue"]),gt("div",SIe,[me(le,null,{default:we(()=>[CIe]),_:1}),me(le,{style:xn({opacity:f.value.units.show?1:.5,margin:"0.5vh"}),align:"middle"},{default:we(()=>[me(re,{span:6,class:"legend-icon"},{default:we(()=>[AIe]),_:1}),me(re,{span:14},{default:we(()=>[kIe]),_:1}),me(re,{span:4,class:"legend-icon",style:{cursor:"pointer"},onClick:V[3]||(V[3]=Fe=>I("units"))},{default:we(()=>[me(D,{color:"#838383",size:"15"},{default:we(()=>[me(W(tC))]),_:1})]),_:1})]),_:1},8,["style"]),me(le,{style:xn({opacity:f.value.buildings.show?1:.5,margin:"0.5vh"})},{default:we(()=>[me(re,{span:6,class:"legend-icon"},{default:we(()=>[IIe]),_:1}),me(re,{span:14},{default:we(()=>[MIe]),_:1}),me(re,{span:4,class:"legend-icon",style:{cursor:"pointer"},onClick:V[4]||(V[4]=Fe=>I("buildings"))},{default:we(()=>[me(D,{color:"#838383",size:"15"},{default:we(()=>[me(W(tC))]),_:1})]),_:1})]),_:1},8,["style"])])],64)}}}),x$=Vs(PIe,[["__scopeId","data-v-e9836bd2"]]),kw=t=>(rf("data-v-cadd1cf8"),t=t(),nf(),t),OIe={class:"home"},RIe=kw(()=>gt("img",{src:gU,width:"22",height:"22"},null,-1)),LIe=kw(()=>gt("span",{id:"title"},"江山市文物保护单位信息管理平台",-1)),DIe={key:0,class:"header-text",style:{display:"flex","justify-content":"flex-end"}},BIe={key:0},zIe=kw(()=>gt("span",{class:"header-text"},"操作日志",-1)),NIe={key:1},UIe=kw(()=>gt("span",{class:"header-text"},"登录",-1)),$Ie={class:"map-container"},VIe={name:"HomeView",components:{mapView:x$}},jIe=Object.assign(VIe,{setup(t){const n=Ph(),a=()=>{Vu.confirm("是否退出登录？","提示",{confirmButtonText:"是",cancelButtonText:"否",type:"info"}).then(()=>{n.logout()}).catch(s=>{})};return(s,c)=>{const f=Ec,d=Hn,p=Vi("RouterLink"),g=Ll;return De(),yt("div",OIe,[me(g,{align:"middle",class:"header"},{default:we(()=>[me(f,{span:15,style:{display:"flex","align-items":"center"}},{default:we(()=>[RIe,Sr("   "),LIe]),_:1}),me(f,{span:4},{default:we(()=>[W(n).isLoggedIn?(De(),yt("span",DIe,"您好，"+Lr(W(n).username),1)):Wt("",!0)]),_:1}),me(f,{span:5,style:{display:"flex","justify-content":"center","align-items":"center"}},{default:we(()=>[me(d,{color:"#474b4d"},{default:we(()=>[me(W(uae))]),_:1}),Sr("  "),W(n).isLoggedIn?(De(),yt("div",BIe,[me(p,{to:"/user"},{default:we(()=>[zIe]),_:1}),Sr("  |  "),gt("span",{class:"header-text",onClick:c[0]||(c[0]=y=>a()),style:{cursor:"pointer"}},"退出登录")])):Wt("",!0),W(n).isLoggedIn?Wt("",!0):(De(),yt("div",NIe,[me(p,{to:"/login",style:{display:"flex","justify-content":"flex-end"}},{default:we(()=>[UIe]),_:1})]))]),_:1})]),_:1}),gt("div",$Ie,[me(x$)])])}}}),WIe=Vs(jIe,[["__scopeId","data-v-cadd1cf8"]]),Iw=t=>(rf("data-v-a9a00809"),t=t(),nf(),t),HIe={class:"register"},GIe=Iw(()=>gt("div",{class:"title"},"江山市文物保护单位信息管理平台",-1)),qIe=Iw(()=>gt("h3",{class:"registerTitle"},"用户注册",-1)),XIe={style:{display:"flex","justify-content":"space-between"}},ZIe=Iw(()=>gt("p",{style:{color:"#474b4d"}},"返回首页",-1)),KIe=Iw(()=>gt("p",{style:{color:"#474b4d"}},"登录",-1)),YIe={name:"register"},JIe=Object.assign(YIe,{setup(t){const{proxy:n}=Tn();Ph();const a=mU(),s=Ze(),c=Ze({username:"",password:"",password2:""});var f=(g,y,b)=>{y!==c.value.password?b(new Error("两次输入密码不一致!")):b()};const d=Ze({username:[{required:!0,message:"用户名不能为空",trigger:"change"},{min:2,max:30,message:"长度在 2 到 30 个字符",trigger:"blur"}],password:[{required:!0,message:"密码不能为空",trigger:"blur"},{min:6,max:30,message:"长度在 6 到 30 个字符",trigger:"blur"}],password2:[{required:!0,message:"确认密码不能为空",trigger:"blur"},{min:6,max:30,message:"长度在 6 到 30 个字符",trigger:"blur"},{validator:f,trigger:"blur"}]});async function p(){await s.value.validate((g,y)=>{g?n.$axios.post("/api/user/register",c.value).then(b=>{Yx({message:"注册成功!",type:"success"}),a.push("/login")}).catch(b=>{console.error("API Error:",b.response.data),Yx({message:"注册失败",type:"error"})}):console.log("error submit!",y)})}return(g,y)=>{const b=uf,E=tk,T=uu,S=Vi("RouterLink"),I=ek;return De(),yt("div",HIe,[GIe,me(I,{model:c.value,rules:d.value,class:"registerForm",ref_key:"registerForm",ref:s,size:"large"},{default:we(()=>[qIe,me(E,{prop:"username"},{default:we(()=>[me(b,{modelValue:c.value.username,"onUpdate:modelValue":y[0]||(y[0]=A=>c.value.username=A),placeholder:"请输入用户名"},null,8,["modelValue"])]),_:1}),me(E,{prop:"password"},{default:we(()=>[me(b,{modelValue:c.value.password,"onUpdate:modelValue":y[1]||(y[1]=A=>c.value.password=A),placeholder:"请输入密码",type:"password"},null,8,["modelValue"])]),_:1}),me(E,{prop:"password2"},{default:we(()=>[me(b,{modelValue:c.value.password2,"onUpdate:modelValue":y[2]||(y[2]=A=>c.value.password2=A),placeholder:"请确认密码",type:"password"},null,8,["modelValue"])]),_:1}),me(E,null,{default:we(()=>[me(T,{type:"primary",style:{width:"100%"},onClick:y[3]||(y[3]=A=>p())},{default:we(()=>[Sr("注 册")]),_:1})]),_:1}),gt("div",XIe,[me(S,{to:"/"},{default:we(()=>[ZIe]),_:1}),me(S,{to:"/login"},{default:we(()=>[KIe]),_:1})])]),_:1},8,["model","rules"])])}}}),QIe=Vs(JIe,[["__scopeId","data-v-a9a00809"]]),Mw=t=>(rf("data-v-155af920"),t=t(),nf(),t),eMe={class:"login"},tMe=Mw(()=>gt("div",{class:"title"},"江山市文物保护单位信息管理平台",-1)),rMe=Mw(()=>gt("h3",{class:"loginTitle"},"用户登录",-1)),nMe={style:{display:"flex","justify-content":"space-between"}},iMe=Mw(()=>gt("p",{style:{color:"#474b4d"}},"返回首页",-1)),aMe=Mw(()=>gt("p",{style:{color:"#474b4d"}},"注册账号",-1)),oMe={name:"login"},sMe=Object.assign(oMe,{setup(t){const{proxy:n}=Tn(),a=Ph(),s=mU(),c=Ze(),f=Ze({username:"",password:""}),d=Ze({username:[{required:!0,message:"用户名不能为空",trigger:"blur"}],password:[{required:!0,message:"密码不能为空",trigger:"blur"},{min:6,max:30,message:"长度在 6 到 30 个字符",trigger:"blur"}]});async function p(){await c.value.validate((g,y)=>{g?n.$axios.post("/api/user/login",f.value).then(b=>{const{id:E,username:T,role_id:S}=b.data.data,I=b.data.token;a.login(E,T,S,I),Yx({message:"登录成功!",type:"success"}),s.push("/")}).catch(b=>{console.error("API Error:",b.response.data),Yx({message:"登录失败",type:"error"})}):console.log("error submit!",y)})}return(g,y)=>{const b=uf,E=tk,T=uu,S=Vi("RouterLink"),I=ek;return De(),yt("div",eMe,[tMe,me(I,{model:f.value,rules:d.value,ref_key:"loginForm",ref:c,class:"loginForm",size:"large"},{default:we(()=>[rMe,me(E,{prop:"username"},{default:we(()=>[me(b,{modelValue:f.value.username,"onUpdate:modelValue":y[0]||(y[0]=A=>f.value.username=A),placeholder:"请输入用户名"},null,8,["modelValue"])]),_:1}),me(E,{prop:"password"},{default:we(()=>[me(b,{modelValue:f.value.password,"onUpdate:modelValue":y[1]||(y[1]=A=>f.value.password=A),placeholder:"请输入密码",type:"password"},null,8,["modelValue"])]),_:1}),me(E,null,{default:we(()=>[me(T,{style:{width:"100%"},type:"primary",onClick:y[2]||(y[2]=A=>p()),class:"submit_btn"},{default:we(()=>[Sr("登 录")]),_:1})]),_:1}),gt("div",nMe,[me(S,{to:"/"},{default:we(()=>[iMe]),_:1}),me(S,{to:"/register"},{default:we(()=>[aMe]),_:1})])]),_:1},8,["model","rules"])])}}}),lMe=Vs(sMe,[["__scopeId","data-v-155af920"]]),Fw=t=>(rf("data-v-8309144f"),t=t(),nf(),t),cMe=Fw(()=>gt("img",{src:gU,width:"22",height:"22"},null,-1)),uMe=Fw(()=>gt("span",{id:"title"},"江山市文物保护单位信息管理平台",-1)),fMe={key:0,class:"header-text",style:{display:"flex","justify-content":"flex-end"}},hMe=Fw(()=>gt("span",{class:"header-text"},"返回首页",-1)),dMe={class:"user-action"},pMe=Fw(()=>gt("span",{class:"text"},"查看范围:    ",-1)),mMe={name:"user"},gMe=Object.assign(mMe,{setup(t){const{proxy:n}=Tn(),a=Ph(),s=Ze(null),c=Ze("me"),f=Ze(null),d=Ze(1),p=10,g=E=>E+p*(d.value-1)+1,y=E=>{E=="me"?n.$axios.get(`/user/actions/${a.id}`).then(T=>{b(T.data.data)}).catch(T=>{}):n.$axios.get("/user/actions").then(T=>{b(T.data.data)}).catch(T=>{})},b=E=>{s.value=E,f.value=s.value.map(T=>{let S=`${T.action}了文物 ${T.name} `;return T.action=="更新"&&(S+=`的${T.info_type}`),{time:T.time,person:T.username,role:T.role_id,action:S}})};return n.$axios.get(`/user/actions/${a.id}`).then(E=>{b(E.data.data)}).catch(E=>{}),(E,T)=>{const S=Ec,I=Vi("RouterLink"),A=Ll,M=Ufe,F=lk,L=xv,O=$0e,N=U0e,Q=BN,ie=Zb,j=Xb;return De(),Ht(j,{class:"user"},{default:we(()=>[me(M,null,{default:we(()=>[me(A,{align:"middle",class:"header"},{default:we(()=>[me(S,{span:17,style:{display:"flex","align-items":"center"}},{default:we(()=>[cMe,Sr("   "),uMe]),_:1}),me(S,{span:4},{default:we(()=>[W(a).isLoggedIn?(De(),yt("span",fMe,"您好，"+Lr(W(a).username),1)):Wt("",!0)]),_:1}),me(S,{span:1}),me(S,{span:2,style:{display:"flex","align-items":"center"}},{default:we(()=>[Sr("  "),me(I,{to:"/"},{default:we(()=>[hMe]),_:1})]),_:1})]),_:1})]),_:1}),me(ie,{class:"main"},{default:we(()=>[gt("div",dMe,[me(A,{align:"middle"},{default:we(()=>[me(S,{span:16,class:"subtitle"},{default:we(()=>[Sr("操作日志")]),_:1}),me(S,{span:8,style:{display:"flex","align-items":"center"}},{default:we(()=>[pMe,me(L,{modelValue:c.value,"onUpdate:modelValue":T[0]||(T[0]=V=>c.value=V),onChange:y},{default:we(()=>[me(F,{label:"me",size:"large"},{default:we(()=>[Sr("自己")]),_:1}),me(F,{label:"all",size:"large",disabled:W(a).role==0},{default:we(()=>[Sr("所有人")]),_:1},8,["disabled"])]),_:1},8,["modelValue"])]),_:1})]),_:1}),f.value!=null?(De(),Ht(N,{key:0,data:f.value.slice((d.value-1)*p,d.value*p),"empty-text":"无操作记录",border:"",style:{width:"100%",height:"82%"}},{default:we(()=>[me(O,{type:"index",width:"50",index:g}),me(O,{prop:"time",label:"操作时间",width:"180"}),me(O,{prop:"person",label:"操作人",width:"140"}),me(O,{prop:"action",label:"具体操作"})]),_:1},8,["data"])):Wt("",!0),me(A,{style:{margin:"3vh 0"},justify:"center"},{default:we(()=>[f.value!=null?(De(),Ht(Q,{key:0,"current-page":d.value,"onUpdate:currentPage":T[1]||(T[1]=V=>d.value=V),"page-size":p,"onUpdate:pageSize":T[2]||(T[2]=V=>p=V),small:"small",layout:"prev, pager, next, jumper",total:f.value.length},null,8,["current-page","total"])):Wt("",!0)]),_:1})])]),_:1})]),_:1})}}}),_Me=Vs(gMe,[["__scopeId","data-v-8309144f"]]),vMe=[{path:"/",name:"home",component:WIe},{path:"/register",name:"register",component:QIe},{path:"/login",name:"login",component:lMe},{path:"/user",name:"user",component:_Me}],yMe=I_e({history:Hge(),routes:vMe}),Pw=EA(Cge);Pw.use(LY());Pw.use(yMe);Aw.defaults.baseURL="http://47.103.20.189/server";console.log("http://47.103.20.189/server");Pw.config.globalProperties.$axios=Aw;Aw.interceptors.request.use(t=>(t.headers.Authorization=window.sessionStorage.getItem("token"),t));Pw.mount("#app")});export default xMe();
